{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./app/node_modules/react/index.js","webpack:///external \"path\"","webpack:///./app/src/lib/fatal-error.ts","webpack:///./app/src/ui/lib/button.tsx","webpack:///./app/node_modules/babel-runtime/helpers/extends.js","webpack:///./app/node_modules/classnames/index.js","webpack:///./app/node_modules/babel-runtime/helpers/classCallCheck.js","webpack:///./app/src/ui/octicons/index.ts","webpack:///./app/node_modules/babel-runtime/helpers/createClass.js","webpack:///./app/src/ui/dialog/index.ts","webpack:///./app/node_modules/babel-runtime/helpers/possibleConstructorReturn.js","webpack:///./app/src/lib/git/core.ts","webpack:///./app/src/ui/lib/button-group.tsx","webpack:///./app/node_modules/babel-runtime/helpers/inherits.js","webpack:///./app/node_modules/babel-runtime/core-js/object/get-prototype-of.js","webpack:///./app/src/lib/api.ts","webpack:///./app/node_modules/prop-types/index.js","webpack:///./app/src/lib/app-state.ts","webpack:///./app/src/ui/lib/link-button.tsx","webpack:///./app/src/ui/lib/row.tsx","webpack:///./app/node_modules/fs-extra/lib/index.js","webpack:///external \"fs\"","webpack:///./app/src/ui/lib/text-box.tsx","webpack:///./app/src/models/status.ts","webpack:///./app/src/lib/git/index.ts","webpack:///external \"electron\"","webpack:///./app/node_modules/graceful-fs/graceful-fs.js","webpack:///./app/src/models/diff/index.ts","webpack:///./app/src/ui/main-process-proxy.ts","webpack:///./app/node_modules/core-js/library/modules/$.js","webpack:///./app/node_modules/universalify/index.js","webpack:///./app/src/lib/app-shell.ts","webpack:///./app/node_modules/fs-extra/lib/mkdirs/index.js","webpack:///./app/src/ui/lib/ref.tsx","webpack:///./app/src/lib/path.ts","webpack:///./app/src/lib/compare.ts","webpack:///./app/node_modules/core-js/library/modules/$.core.js","webpack:///./app/src/models/tip.ts","webpack:///./app/node_modules/react-dom/index.js","webpack:///./app/src/models/repository.ts","webpack:///./app/src/lib/feature-flag.ts","webpack:///./app/node_modules/fs-extra/lib/path-exists/index.js","webpack:///./app/node_modules/dugite/build/lib/index.js","webpack:///external \"child_process\"","webpack:///./app/node_modules/babel-runtime/helpers/objectWithoutProperties.js","webpack:///./app/src/lib/stores/base-store.ts","webpack:///./app/src/ui/tab-bar.tsx","webpack:///./app/src/ui/lib/checkbox.tsx","webpack:///./app/node_modules/react-virtualized/dist/es/Grid/types.js","webpack:///./app/node_modules/core-js/library/modules/$.wks.js","webpack:///./app/src/lib/git/authentication.ts","webpack:///./app/src/lib/stores/index.ts","webpack:///./app/node_modules/codemirror/lib/codemirror.js","webpack:///./app/src/ui/lib/loading.tsx","webpack:///./app/src/lib/progress/git.ts","webpack:///./app/src/models/branch.ts","webpack:///external \"os\"","webpack:///external \"url\"","webpack:///./app/node_modules/event-kit/lib/event-kit.js","webpack:///./app/node_modules/react-transition-group/index.js","webpack:///./app/node_modules/babel-runtime/core-js/object/keys.js","webpack:///./app/src/ui/welcome/welcome.tsx","webpack:///./app/src/ui/diff/image-diffs/image-container.tsx","webpack:///./app/src/ui/lib/id-pool.ts","webpack:///./app/src/ui/lib/list/index.ts","webpack:///./app/src/models/merge.ts","webpack:///./app/src/lib/merge.ts","webpack:///./app/src/ui/lib/app-proxy.ts","webpack:///./app/src/ui/lib/form.tsx","webpack:///./app/src/ui/lib/application-theme.ts","webpack:///./app/src/ui/ui-view.tsx","webpack:///./app/src/lib/equality.ts","webpack:///./app/node_modules/core-js/library/modules/$.to-iobject.js","webpack:///./app/node_modules/core-js/library/modules/$.iterators.js","webpack:///./app/node_modules/core-js/library/modules/$.export.js","webpack:///./app/src/ui/lib/filter-list.tsx","webpack:///./app/src/ui/lib/highlight-text.tsx","webpack:///./app/src/lib/progress/index.ts","webpack:///./app/src/lib/git/config.ts","webpack:///./app/src/lib/git/interpret-trailers.ts","webpack:///./app/src/lib/git/spawn.ts","webpack:///./app/src/models/cloning-repository.ts","webpack:///./app/src/lib/remote-parsing.ts","webpack:///./app/src/lib/gravatar.ts","webpack:///./app/node_modules/moment/moment.js","webpack:///./app/node_modules/source-map/lib/util.js","webpack:///./app/node_modules/dom-helpers/util/scrollbarSize.js","webpack:///./app/node_modules/babel-runtime/helpers/defineProperty.js","webpack:///./app/src/lib/databases/base-database.ts","webpack:///./app/src/ui/lib/call-to-action.tsx","webpack:///./app/src/lib/stats/index.ts","webpack:///./app/src/lib/shells/index.ts","webpack:///./app/src/lib/retry-actions.ts","webpack:///./app/src/lib/editors/shared.ts","webpack:///./app/src/models/fetch.ts","webpack:///./app/src/ui/toolbar/button.tsx","webpack:///./app/src/ui/branches/index.ts","webpack:///./app/src/ui/diff/diff-explorer.ts","webpack:///./app/src/ui/relative-time.tsx","webpack:///./app/src/ui/lib/rich-text.tsx","webpack:///./app/src/ui/lib/context-menu.ts","webpack:///./app/node_modules/fuzzaldrin-plus/lib/scorer.js","webpack:///./app/node_modules/core-js/library/modules/$.fails.js","webpack:///./app/node_modules/core-js/library/modules/$.global.js","webpack:///./app/src/models/app-menu.ts","webpack:///./app/src/models/commit-identity.ts","webpack:///./app/node_modules/fs-extra/lib/remove/index.js","webpack:///./app/src/lib/file-system.ts","webpack:///./app/src/lib/email.ts","webpack:///./app/src/lib/uuid.ts","webpack:///./app/src/models/account.ts","webpack:///./app/src/lib/repository-matching.ts","webpack:///./app/src/lib/error-with-metadata.ts","webpack:///./app/src/ui/lib/update-store.ts","webpack:///./app/node_modules/babel-runtime/core-js/object/assign.js","webpack:///./app/src/ui/lib/select.tsx","webpack:///./app/src/ui/lib/errors.tsx","webpack:///./app/src/models/clone-repository-tab.ts","webpack:///./app/src/ui/lib/monospaced.tsx","webpack:///./app/src/lib/open-file.ts","webpack:///./app/src/ui/lib/path-text.tsx","webpack:///./app/src/ui/lib/path-label.tsx","webpack:///./app/src/ui/lib/avatar.tsx","webpack:///./app/src/ui/lib/throttled-scheduler.ts","webpack:///./app/node_modules/fuzzaldrin-plus/lib/pathScorer.js","webpack:///./app/src/lib/range.ts","webpack:///./app/src/ui/lib/focus-container.tsx","webpack:///./app/node_modules/core-js/library/modules/$.an-object.js","webpack:///./app/node_modules/core-js/library/modules/$.cof.js","webpack:///./app/node_modules/core-js/library/modules/web.dom.iterable.js","webpack:///./app/node_modules/core-js/library/modules/$.set-to-string-tag.js","webpack:///./app/node_modules/core-js/library/modules/$.has.js","webpack:///./app/node_modules/core-js/library/modules/$.property-desc.js","webpack:///./app/node_modules/core-js/library/modules/$.hide.js","webpack:///./app/node_modules/core-js/library/modules/es6.string.iterator.js","webpack:///./app/node_modules/core-js/library/modules/$.object-sap.js","webpack:///./app/node_modules/core-js/library/modules/$.defined.js","webpack:///./app/node_modules/core-js/library/modules/$.to-object.js","webpack:///./app/src/models/remote.ts","webpack:///./app/src/models/commit.ts","webpack:///./app/node_modules/fs-extra/lib/json/jsonfile.js","webpack:///./app/src/ui/lib/git-perf.ts","webpack:///./app/src/lib/stores/helpers/validated-repository-path.ts","webpack:///./app/src/lib/get-os.ts","webpack:///external \"util\"","webpack:///external \"crypto\"","webpack:///./app/src/lib/2fa.ts","webpack:///(webpack)/buildin/module.js","webpack:///./app/node_modules/event-kit/lib/disposable.js","webpack:///./app/node_modules/dom-helpers/util/inDOM.js","webpack:///./app/node_modules/fbjs/lib/emptyFunction.js","webpack:///./app/node_modules/fbjs/lib/invariant.js","webpack:///./app/node_modules/object-assign/index.js","webpack:///./app/src/lib/databases/index.ts","webpack:///./app/src/ui/lib/install-cli.ts","webpack:///./app/src/ui/lib/default-dir.ts","webpack:///./app/src/ui/lib/vertical-segmented-control/index.ts","webpack:///./app/src/ui/app-menu/menu-list-item.tsx","webpack:///./app/src/ui/app-menu/menu-pane.tsx","webpack:///./app/src/ui/app-menu/app-menu.tsx","webpack:///./app/src/lib/stats/get-guid.ts","webpack:///./app/node_modules/dexie/dist/dexie.es.js","webpack:///./app/src/ui/lib/sign-in.tsx","webpack:///./app/src/lib/oauth.ts","webpack:///./app/src/lib/stores/helpers/find-upstream-remote.ts","webpack:///./app/src/lib/stores/upstream-already-exists-error.ts","webpack:///./app/src/lib/promise.ts","webpack:///./app/src/lib/comparison-cache.ts","webpack:///./app/src/lib/welcome.ts","webpack:///./app/src/lib/shells/error.ts","webpack:///./app/src/lib/get-account-for-repository.ts","webpack:///./app/src/lib/stores/token-store.ts","webpack:///./app/src/lib/generic-git-auth.ts","webpack:///./app/src/lib/format-commit-message.ts","webpack:///./app/src/lib/find-account.ts","webpack:///./app/src/lib/editors/linux.ts","webpack:///./app/node_modules/registry-js/dist/lib/index.js","webpack:///./app/src/lib/editors/win32.ts","webpack:///./app/node_modules/app-path/index.js","webpack:///./app/src/lib/editors/darwin.ts","webpack:///./app/src/lib/editors/lookup.ts","webpack:///./app/src/lib/editors/index.ts","webpack:///./app/src/models/owner.ts","webpack:///./app/src/models/github-repository.ts","webpack:///./app/src/lib/auth.ts","webpack:///./app/src/ui/toolbar/dropdown.tsx","webpack:///./app/src/ui/toolbar/index.tsx","webpack:///./app/src/ui/lib/branch-name-warnings.tsx","webpack:///./app/src/lib/sanitize-branch.ts","webpack:///./app/src/ui/history/merge-status-header.tsx","webpack:///./app/src/ui/branches/branch-list-item.tsx","webpack:///./app/src/ui/branches/branch-renderer.tsx","webpack:///./app/src/models/pull-request.ts","webpack:///./app/src/ui/branches/ci-status.tsx","webpack:///./app/src/ui/branches/pull-request-list-item.tsx","webpack:///./app/src/ui/branches/pull-request-list.tsx","webpack:///./app/src/models/branches-tab.ts","webpack:///./app/src/ui/branches/group-branches.ts","webpack:///./app/src/ui/branches/branch-list.tsx","webpack:///./app/src/ui/dialog/header.tsx","webpack:///./app/src/ui/history/commit-list-item.tsx","webpack:///./app/src/ui/resizable/index.ts","webpack:///./app/src/ui/lib/commit-attribution.tsx","webpack:///./app/src/ui/lib/avatar-stack.tsx","webpack:///./app/src/models/avatar.ts","webpack:///./app/src/ui/diff/edge-detection.ts","webpack:///./app/src/ui/diff/diff-syntax-mode.ts","webpack:///./app/src/ui/diff/index.tsx","webpack:///./app/src/lib/clamp.ts","webpack:///./app/src/ui/autocompletion/index.ts","webpack:///./app/node_modules/fuzzaldrin-plus/lib/query.js","webpack:///./app/src/ui/lib/list/selection.ts","webpack:///./app/node_modules/core-js/library/modules/$.classof.js","webpack:///./app/node_modules/core-js/library/modules/$.is-object.js","webpack:///./app/node_modules/core-js/library/modules/$.iobject.js","webpack:///./app/node_modules/core-js/library/modules/$.uid.js","webpack:///./app/node_modules/core-js/library/modules/$.shared.js","webpack:///./app/node_modules/core-js/library/modules/$.descriptors.js","webpack:///./app/node_modules/core-js/library/modules/$.redefine.js","webpack:///./app/node_modules/core-js/library/modules/$.library.js","webpack:///./app/node_modules/core-js/library/modules/$.iter-define.js","webpack:///./app/node_modules/babel-runtime/helpers/typeof.js","webpack:///./app/node_modules/babel-runtime/core-js/object/define-property.js","webpack:///./app/node_modules/core-js/library/modules/$.ctx.js","webpack:///./app/src/lib/window-state.ts","webpack:///./app/src/models/preferences.ts","webpack:///./app/src/lib/git/description.ts","webpack:///./app/src/lib/git/reset.ts","webpack:///./app/src/lib/progress/from-process.ts","webpack:///./app/src/models/git-author.ts","webpack:///./app/src/lib/git/for-each-ref.ts","webpack:///./app/src/lib/git/show.ts","webpack:///./app/node_modules/byline/lib/byline.js","webpack:///./app/node_modules/fs-extra/lib/copy/index.js","webpack:///./app/node_modules/fs-extra/lib/util/buffer.js","webpack:///./app/node_modules/fs-extra/lib/util/utimes.js","webpack:///./app/node_modules/fs-extra/lib/mkdirs/win32.js","webpack:///./app/node_modules/fs-extra/lib/copy-sync/index.js","webpack:///external \"assert\"","webpack:///external \"stream\"","webpack:///./app/node_modules/graceful-fs/fs.js","webpack:///./app/node_modules/fs-extra/lib/fs/index.js","webpack:///./app/src/lib/git/diff.ts","webpack:///./app/src/ui/octicons/octicons.generated.ts","webpack:///./app/node_modules/dugite/build/lib/errors.js","webpack:///./app/src/lib/git/apply.ts","webpack:///./app/node_modules/path-key/index.js","webpack:///./app/node_modules/yallist/yallist.js","webpack:///./app/node_modules/lru-cache/index.js","webpack:///./app/node_modules/execa/index.js","webpack:///./app/node_modules/react-transition-group/utils/PropTypes.js","webpack:///./app/node_modules/react-transition-group/TransitionGroup.js","webpack:///./app/src/ui/app.tsx","webpack:///./app/node_modules/fbjs/lib/emptyObject.js","webpack:///./app/node_modules/source-map/lib/array-set.js","webpack:///./app/node_modules/source-map/lib/base64-vlq.js","webpack:///./app/node_modules/source-map/lib/source-map-generator.js","webpack:///./app/src/lib/source-map-support.ts","webpack:///./app/node_modules/babel-runtime/helpers/slicedToArray.js","webpack:///./app/node_modules/babel-runtime/core-js/object/get-own-property-descriptor.js","webpack:///./app/node_modules/react-lifecycles-compat/react-lifecycles-compat.es.js","webpack:///./app/node_modules/react-virtualized/dist/es/vendor/detectElementResize.js","webpack:///./app/node_modules/react-virtualized/dist/es/AutoSizer/AutoSizer.js","webpack:///./app/node_modules/react-virtualized/dist/es/CellMeasurer/CellMeasurerCache.js","webpack:///./app/node_modules/react-virtualized/dist/es/CellMeasurer/index.js","webpack:///./app/node_modules/react-virtualized/dist/es/utils/createCallbackMemoizer.js","webpack:///./app/node_modules/react-virtualized/dist/es/Collection/utils/calculateSizeAndPositionData.js","webpack:///./app/node_modules/react-virtualized/dist/es/utils/getUpdatedOffsetForIndex.js","webpack:///./app/node_modules/react-virtualized/dist/es/Collection/Collection.js","webpack:///./app/node_modules/react-virtualized/dist/es/Grid/utils/calculateSizeAndPositionDataAndUpdateScrollOffset.js","webpack:///./app/node_modules/react-virtualized/dist/es/Grid/utils/CellSizeAndPositionManager.js","webpack:///./app/node_modules/react-virtualized/dist/es/Grid/defaultOverscanIndicesGetter.js","webpack:///./app/node_modules/react-virtualized/dist/es/Grid/utils/updateScrollIndexHelper.js","webpack:///./app/node_modules/react-virtualized/dist/es/Grid/defaultCellRangeRenderer.js","webpack:///./app/node_modules/react-virtualized/dist/es/utils/animationFrame.js","webpack:///./app/node_modules/react-virtualized/dist/es/Grid/accessibilityOverscanIndicesGetter.js","webpack:///./app/node_modules/react-virtualized/dist/es/InfiniteLoader/InfiniteLoader.js","webpack:///./app/node_modules/react-virtualized/dist/es/InfiniteLoader/index.js","webpack:///./app/node_modules/react-virtualized/dist/es/Masonry/createCellPositioner.js","webpack:///./app/node_modules/react-virtualized/dist/es/vendor/binarySearchBounds.js","webpack:///./app/node_modules/react-virtualized/dist/es/vendor/intervalTree.js","webpack:///./app/node_modules/react-virtualized/dist/es/Masonry/PositionCache.js","webpack:///./app/node_modules/react-virtualized/dist/es/Masonry/Masonry.js","webpack:///./app/node_modules/react-virtualized/dist/es/Table/createMultiSort.js","webpack:///./app/node_modules/react-virtualized/dist/es/Table/defaultCellDataGetter.js","webpack:///./app/node_modules/react-virtualized/dist/es/Table/defaultCellRenderer.js","webpack:///./app/node_modules/react-virtualized/dist/es/Table/defaultHeaderRowRenderer.js","webpack:///./app/node_modules/react-virtualized/dist/es/Table/SortIndicator.js","webpack:///./app/node_modules/react-virtualized/dist/es/Table/defaultHeaderRenderer.js","webpack:///./app/node_modules/react-virtualized/dist/es/Table/defaultRowRenderer.js","webpack:///./app/node_modules/react-virtualized/dist/es/WindowScroller/utils/onScroll.js","webpack:///./app/node_modules/react-virtualized/dist/es/WindowScroller/utils/dimensions.js","webpack:///./app/node_modules/react-virtualized/dist/es/WindowScroller/WindowScroller.js","webpack:///./app/node_modules/react-virtualized/dist/es/ArrowKeyStepper/ArrowKeyStepper.js","webpack:///./app/node_modules/react-virtualized/dist/es/ArrowKeyStepper/index.js","webpack:///./app/node_modules/react-virtualized/dist/es/AutoSizer/index.js","webpack:///./app/node_modules/react-virtualized/dist/es/CellMeasurer/CellMeasurer.js","webpack:///./app/node_modules/react-virtualized/dist/es/Collection/CollectionView.js","webpack:///./app/node_modules/react-virtualized/dist/es/Collection/Section.js","webpack:///./app/node_modules/react-virtualized/dist/es/Collection/SectionManager.js","webpack:///./app/node_modules/react-virtualized/dist/es/ColumnSizer/ColumnSizer.js","webpack:///./app/node_modules/react-virtualized/dist/es/ColumnSizer/index.js","webpack:///./app/node_modules/react-virtualized/dist/es/Grid/utils/maxElementSize.js","webpack:///./app/node_modules/react-virtualized/dist/es/Grid/utils/ScalingCellSizeAndPositionManager.js","webpack:///./app/node_modules/react-virtualized/dist/es/utils/requestAnimationTimeout.js","webpack:///./app/node_modules/react-virtualized/dist/es/Grid/Grid.js","webpack:///./app/node_modules/react-virtualized/dist/es/List/List.js","webpack:///./app/node_modules/react-virtualized/dist/es/List/index.js","webpack:///./app/node_modules/react-virtualized/dist/es/MultiGrid/CellMeasurerCacheDecorator.js","webpack:///./app/node_modules/react-virtualized/dist/es/MultiGrid/MultiGrid.js","webpack:///./app/node_modules/react-virtualized/dist/es/ScrollSync/ScrollSync.js","webpack:///./app/node_modules/react-virtualized/dist/es/ScrollSync/index.js","webpack:///./app/node_modules/react-virtualized/dist/es/Table/SortDirection.js","webpack:///./app/node_modules/react-virtualized/dist/es/Table/Column.js","webpack:///./app/node_modules/react-virtualized/dist/es/Table/Table.js","webpack:///./app/node_modules/react-virtualized/dist/es/Table/index.js","webpack:///./app/node_modules/react-virtualized/dist/es/WindowScroller/index.js","webpack:///./app/node_modules/react-virtualized/dist/es/index.js","webpack:///./app/styles/desktop.scss?c3ab","webpack:///./app/node_modules/wicg-focus-ring/dist/focus-ring.js","webpack:///./app/src/lib/stores/repository-state-cache.ts","webpack:///./app/src/ui/lib/ui-activity-monitor.ts","webpack:///./app/src/ui/install-globals.ts","webpack:///./app/src/lib/shell.ts","webpack:///./app/src/lib/databases/pull-request-database.ts","webpack:///./app/src/lib/databases/repositories-database.ts","webpack:///./app/src/lib/databases/issues-database.ts","webpack:///./app/src/lib/databases/github-user-database.ts","webpack:///./app/src/lib/dispatcher/error-handlers.ts","webpack:///./app/src/lib/is-git-on-path.ts","webpack:///./app/src/lib/dispatcher/dispatcher.ts","webpack:///./app/src/lib/dispatcher/index.ts","webpack:///./app/src/ui/app-theme.tsx","webpack:///./app/src/ui/merge-conflicts/merge-conflicts-warning.tsx","webpack:///./app/src/ui/merge-conflicts/index.ts","webpack:///./app/src/ui/delete-branch/delete-pull-request-dialog.tsx","webpack:///./app/src/ui/release-notes/release-notes-dialog.tsx","webpack:///./app/src/ui/release-notes/index.ts","webpack:///./app/src/ui/upstream-already-exists/upstream-already-exists.tsx","webpack:///./app/src/ui/upstream-already-exists/index.ts","webpack:///./app/src/ui/lfs/attribute-mismatch.tsx","webpack:///./app/src/ui/lfs/initialize-lfs.tsx","webpack:///./app/src/ui/lfs/index.ts","webpack:///./app/src/ui/shell/shell-error.tsx","webpack:///./app/src/ui/shell/index.ts","webpack:///./app/src/ui/generic-git-auth/generic-git-auth.tsx","webpack:///./app/src/ui/generic-git-auth/index.ts","webpack:///./app/node_modules/runas/build/Release/runas.node","webpack:///./app/node_modules/runas/lib/runas.js","webpack:///./app/src/ui/cli-installed/cli-installed.tsx","webpack:///./app/src/ui/cli-installed/index.ts","webpack:///./app/src/ui/terms-and-conditions/terms-and-conditions.tsx","webpack:///./app/src/ui/terms-and-conditions/index.ts","webpack:///./app/src/ui/remove-repository/confirm-remove-repository.tsx","webpack:///./app/src/ui/remove-repository/index.ts","webpack:///./app/src/ui/blank-slate/blank-slate.tsx","webpack:///./app/src/ui/blank-slate/index.ts","webpack:///./app/src/ui/untrusted-certificate/untrusted-certificate.tsx","webpack:///./app/src/ui/untrusted-certificate/index.ts","webpack:///./app/src/ui/acknowledgements/acknowledgements.tsx","webpack:///./app/src/ui/acknowledgements/index.ts","webpack:///./app/src/ui/publish-repository/publish-repository.tsx","webpack:///./app/src/ui/publish-repository/publish.tsx","webpack:///./app/src/ui/publish-repository/index.ts","webpack:///./app/src/ui/about/about.tsx","webpack:///./app/src/ui/about/index.ts","webpack:///./app/src/ui/editor/editor-error.tsx","webpack:///./app/src/ui/editor/index.ts","webpack:///./app/src/ui/install-git/install.tsx","webpack:///./app/src/ui/install-git/index.ts","webpack:///./app/src/ui/sign-in/sign-in.tsx","webpack:///./app/src/ui/sign-in/index.ts","webpack:///./app/src/ui/create-branch/create-branch-dialog.tsx","webpack:///./app/src/ui/create-branch/index.ts","webpack:///./app/src/ui/clone-repository/group-repositories.ts","webpack:///./app/src/ui/clone-repository/clone-github-repository.tsx","webpack:///./app/src/ui/clone-repository/clone-generic-repository.tsx","webpack:///./app/src/ui/clone-repository/clone-repository.tsx","webpack:///./app/src/ui/clone-repository/index.tsx","webpack:///./app/src/ui/add-repository/git-attributes.ts","webpack:///./app/src/ui/add-repository/licenses.ts","webpack:///./app/src/ui/add-repository/gitignores.ts","webpack:///./app/src/ui/add-repository/write-default-readme.ts","webpack:///./app/src/ui/add-repository/sanitized-repository-name.ts","webpack:///./app/src/ui/add-repository/create-repository.tsx","webpack:///./app/node_modules/untildify/index.js","webpack:///./app/src/ui/add-repository/add-existing-repository.tsx","webpack:///./app/src/ui/add-repository/index.tsx","webpack:///./app/src/ui/missing-repository.tsx","webpack:///./app/src/ui/app-error.tsx","webpack:///./app/src/ui/repository-settings/no-remote.tsx","webpack:///./app/src/ui/lib/text-area.tsx","webpack:///./app/src/ui/repository-settings/git-ignore.tsx","webpack:///./app/src/ui/repository-settings/remote.tsx","webpack:///./app/src/ui/repository-settings/repository-settings.tsx","webpack:///./app/src/ui/repository-settings/index.ts","webpack:///./app/src/ui/merge-branch/merge.tsx","webpack:///./app/src/ui/merge-branch/index.ts","webpack:///./app/src/ui/lib/vertical-segmented-control/segmented-item.tsx","webpack:///./app/src/ui/lib/vertical-segmented-control/vertical-segmented-control.tsx","webpack:///./app/src/ui/preferences/appearance.tsx","webpack:///./app/src/ui/preferences/identifier-rules.ts","webpack:///./app/src/ui/preferences/git.tsx","webpack:///./app/src/ui/preferences/advanced.tsx","webpack:///./app/src/ui/preferences/accounts.tsx","webpack:///./app/src/ui/preferences/preferences.tsx","webpack:///./app/src/ui/preferences/index.ts","webpack:///./app/src/ui/updates/update-available.tsx","webpack:///./app/src/ui/updates/index.ts","webpack:///./app/src/ui/app-menu/app-menu-bar-button.tsx","webpack:///./app/src/ui/app-menu/app-menu-bar.tsx","webpack:///./app/src/ui/lib/access-text.tsx","webpack:///./app/src/ui/app-menu/index.ts","webpack:///./app/src/lib/stats/stats-store.ts","webpack:///./app/src/lib/stats/stats-database.ts","webpack:///./app/src/ui/welcome/usage-opt-out.tsx","webpack:///./app/src/ui/lib/configure-git-user.tsx","webpack:///./app/src/ui/welcome/configure-git.tsx","webpack:///./app/src/ui/welcome/sign-in-enterprise.tsx","webpack:///./app/src/ui/lib/enterprise-server-entry.tsx","webpack:///./app/src/ui/lib/two-factor-authentication.tsx","webpack:///./app/src/ui/lib/authentication-form.tsx","webpack:///./app/src/ui/welcome/sign-in-dot-com.tsx","webpack:///./app/src/ui/welcome/start.tsx","webpack:///./app/src/lib/stores/pull-request-store.ts","webpack:///./app/src/lib/enterprise.ts","webpack:///./app/src/ui/lib/enterprise-validate-url.ts","webpack:///./app/src/lib/stores/sign-in-store.ts","webpack:///./app/src/lib/stores/repositories-store.ts","webpack:///./app/src/lib/stores/issues-store.ts","webpack:///./app/src/lib/stores/github-user-store.ts","webpack:///./app/src/lib/stores/helpers/find-default-remote.ts","webpack:///./app/src/lib/queue-work.ts","webpack:///./app/src/lib/stores/git-store.ts","webpack:///./app/src/lib/stores/cloning-repositories-store.ts","webpack:///./app/src/lib/read-emoji.ts","webpack:///./app/src/lib/stores/helpers/pull-request-updater.ts","webpack:///./app/src/lib/stores/helpers/infer-comparison-branch.ts","webpack:///./app/src/lib/stores/helpers/background-fetcher.ts","webpack:///external \"events\"","webpack:///./app/node_modules/inherits/inherits_browser.js","webpack:///./app/node_modules/queue/index.js","webpack:///./app/src/lib/stores/helpers/ahead-behind-updater.ts","webpack:///./app/src/lib/shells/linux.ts","webpack:///./app/src/lib/shells/win32.ts","webpack:///./app/src/lib/shells/darwin.ts","webpack:///./app/src/lib/shells/shared.ts","webpack:///./app/src/lib/menu-update.ts","webpack:///./app/src/lib/infer-last-push-for-repository.ts","webpack:///./app/src/lib/git/lfs.ts","webpack:///./app/node_modules/keytar/build/Release/keytar.node","webpack:///./app/node_modules/keytar/lib/keytar.js","webpack:///./app/src/lib/editors/launch.ts","webpack:///./app/node_modules/registry-js/dist/lib/registry.js","webpack:///external \"querystring\"","webpack:///./app/src/lib/stores/app-store.ts","webpack:///./app/src/lib/stores/accounts-store.ts","webpack:///./app/src/ui/welcome/index.ts","webpack:///./app/src/lib/platform-case.ts","webpack:///./app/src/ui/discard-changes/discard-changes-dialog.tsx","webpack:///./app/src/ui/discard-changes/index.ts","webpack:///./app/src/ui/toolbar/revert-progress.tsx","webpack:///./app/src/ui/toolbar/branch-dropdown.tsx","webpack:///./app/src/ui/toolbar/push-pull-button.tsx","webpack:///./app/src/ui/lib/rect.ts","webpack:///./app/src/ui/toolbar/toolbar.tsx","webpack:///./app/src/ui/cloning-repository.tsx","webpack:///./app/src/ui/delete-branch/delete-branch-dialog.tsx","webpack:///./app/src/ui/delete-branch/index.ts","webpack:///./app/src/ui/rename-branch/rename-branch-dialog.tsx","webpack:///./app/src/ui/rename-branch/index.ts","webpack:///./app/src/ui/history/merge-call-to-action-with-conflicts.tsx","webpack:///./app/src/ui/history/merge-call-to-action.tsx","webpack:///./app/src/ui/notification/new-commits-banner.tsx","webpack:///./app/src/ui/lib/fancy-text-box.tsx","webpack:///./app/src/ui/history/compare-branch-list-item.tsx","webpack:///./app/src/ui/branches/pull-request-badge.tsx","webpack:///./app/src/ui/branches/pull-requests-loading.tsx","webpack:///./app/src/ui/branches/no-pull-requests.tsx","webpack:///./app/src/ui/branches/pull-request-status.ts","webpack:///./app/src/ui/branches/branches-container.tsx","webpack:///./app/src/ui/branches/no-branches.tsx","webpack:///./app/src/ui/dialog/footer.tsx","webpack:///./app/src/ui/dialog/error.tsx","webpack:///./app/src/ui/dialog/dialog.tsx","webpack:///./app/src/ui/dialog/content.tsx","webpack:///./app/src/ui/branches/push-branch-commits.tsx","webpack:///./app/src/ui/history/commit-list.tsx","webpack:///./app/src/ui/history/compare.tsx","webpack:///./app/src/ui/resizable/resizable.tsx","webpack:///./app/src/ui/history/file-list.tsx","webpack:///./app/src/ui/history/commit-summary.tsx","webpack:///./app/src/ui/history/selected-commit.tsx","webpack:///./app/src/ui/history/index.ts","webpack:///./app/src/ui/changes/files-changed-badge.tsx","webpack:///./app/src/ui/changes/multiple-selection.tsx","webpack:///./app/src/ui/changes/no-changes.tsx","webpack:///./app/src/ui/changes/changed-file-details.tsx","webpack:///./app/src/ui/diff/changed-range.ts","webpack:///./app/src/lib/highlighter/worker.ts","webpack:///./app/src/ui/diff/syntax-highlighting/index.ts","webpack:///./app/src/ui/diff/selection/drag-drop-selection-strategy.ts","webpack:///./app/src/ui/diff/selection/range-selection-strategy.ts","webpack:///./app/src/ui/diff/selection/selection.ts","webpack:///./app/src/ui/diff/diff-line-gutter.tsx","webpack:///./app/node_modules/codemirror/addon/scroll/simplescrollbars.js","webpack:///./app/node_modules/codemirror/addon/hint/show-hint.js","webpack:///./app/node_modules/codemirror/addon/selection/mark-selection.js","webpack:///./app/src/ui/diff/code-mirror-host.tsx","webpack:///./app/src/ui/diff/text-diff.tsx","webpack:///./app/node_modules/codemirror/mode/javascript/javascript.js","webpack:///./app/src/ui/diff/binary-file.tsx","webpack:///./app/src/ui/diff/image-diffs/deleted-image-diff.tsx","webpack:///./app/src/ui/diff/image-diffs/new-image-diff.tsx","webpack:///./app/src/ui/diff/image-diffs/sizing.ts","webpack:///./app/src/ui/diff/image-diffs/swipe.tsx","webpack:///./app/src/ui/diff/image-diffs/onion-skin.tsx","webpack:///./app/src/ui/diff/image-diffs/difference-blend.tsx","webpack:///./app/src/ui/lib/bytes.ts","webpack:///./app/src/ui/diff/image-diffs/two-up.tsx","webpack:///./app/src/ui/diff/image-diffs/modified-image-diff.tsx","webpack:///./app/src/ui/diff/image-diffs/index.ts","webpack:///./app/src/ui/changes/changes.tsx","webpack:///./app/src/lib/text-token-parser.ts","webpack:///./app/src/ui/changes/undo-commit.tsx","webpack:///./app/src/ui/changes/changed-file.tsx","webpack:///./app/src/ui/lib/author-input.tsx","webpack:///./app/src/ui/lib/avatar-in-memory-cache.ts","webpack:///./app/node_modules/file-url/index.js","webpack:///./app/src/ui/autocompletion/user-autocompletion-provider.tsx","webpack:///./app/src/ui/autocompletion/issues-autocompletion-provider.tsx","webpack:///./app/src/ui/autocompletion/emoji-autocompletion-provider.tsx","webpack:///./app/node_modules/textarea-caret/index.js","webpack:///./app/src/ui/autocompletion/autocompleting-text-input.tsx","webpack:///./app/src/ui/autocompletion/autocompletion-provider.ts","webpack:///./app/src/ui/changes/commit-message.tsx","webpack:///./app/src/ui/changes/changes-list.tsx","webpack:///./app/src/ui/changes/sidebar.tsx","webpack:///./app/src/ui/changes/index.ts","webpack:///./app/src/ui/repository.tsx","webpack:///./app/node_modules/fuzzaldrin-plus/lib/matcher.js","webpack:///./app/node_modules/fuzzaldrin-plus/lib/filter.js","webpack:///./app/node_modules/fuzzaldrin-plus/lib/fuzzaldrin.js","webpack:///./app/src/lib/fuzzy-find.ts","webpack:///./app/src/ui/lib/list/list-row.tsx","webpack:///./app/node_modules/deep-equal/lib/is_arguments.js","webpack:///./app/node_modules/deep-equal/lib/keys.js","webpack:///./app/node_modules/deep-equal/index.js","webpack:///./app/node_modules/core-js/library/modules/core.get-iterator-method.js","webpack:///./app/node_modules/core-js/library/modules/core.get-iterator.js","webpack:///./app/node_modules/core-js/library/fn/get-iterator.js","webpack:///./app/node_modules/babel-runtime/core-js/get-iterator.js","webpack:///./app/node_modules/core-js/library/modules/core.is-iterable.js","webpack:///./app/node_modules/core-js/library/fn/is-iterable.js","webpack:///./app/node_modules/babel-runtime/core-js/is-iterable.js","webpack:///./app/node_modules/react-virtualized/dist/es/List/types.js","webpack:///./app/node_modules/core-js/library/modules/es6.object.get-own-property-descriptor.js","webpack:///./app/node_modules/core-js/library/fn/object/get-own-property-descriptor.js","webpack:///./app/node_modules/core-js/library/modules/es6.object.keys.js","webpack:///./app/node_modules/core-js/library/fn/object/keys.js","webpack:///./app/node_modules/core-js/library/modules/$.object-assign.js","webpack:///./app/node_modules/core-js/library/modules/es6.object.assign.js","webpack:///./app/node_modules/core-js/library/fn/object/assign.js","webpack:///./app/node_modules/react-virtualized/dist/es/ArrowKeyStepper/types.js","webpack:///./app/node_modules/core-js/library/fn/object/create.js","webpack:///./app/node_modules/babel-runtime/core-js/object/create.js","webpack:///./app/node_modules/core-js/library/modules/$.set-proto.js","webpack:///./app/node_modules/core-js/library/modules/es6.object.set-prototype-of.js","webpack:///./app/node_modules/core-js/library/fn/object/set-prototype-of.js","webpack:///./app/node_modules/babel-runtime/core-js/object/set-prototype-of.js","webpack:///./app/node_modules/core-js/library/modules/$.is-array.js","webpack:///./app/node_modules/core-js/library/modules/$.enum-keys.js","webpack:///./app/node_modules/core-js/library/modules/$.get-names.js","webpack:///./app/node_modules/core-js/library/modules/$.keyof.js","webpack:///./app/node_modules/core-js/library/modules/es6.symbol.js","webpack:///./app/node_modules/core-js/library/fn/symbol/index.js","webpack:///./app/node_modules/babel-runtime/core-js/symbol.js","webpack:///./app/node_modules/core-js/library/modules/$.iter-step.js","webpack:///./app/node_modules/core-js/library/modules/$.add-to-unscopables.js","webpack:///./app/node_modules/core-js/library/modules/es6.array.iterator.js","webpack:///./app/node_modules/core-js/library/modules/$.iter-create.js","webpack:///./app/node_modules/core-js/library/modules/$.to-integer.js","webpack:///./app/node_modules/core-js/library/modules/$.string-at.js","webpack:///./app/node_modules/core-js/library/fn/symbol/iterator.js","webpack:///./app/node_modules/babel-runtime/core-js/symbol/iterator.js","webpack:///./app/node_modules/core-js/library/fn/object/define-property.js","webpack:///./app/node_modules/core-js/library/modules/$.a-function.js","webpack:///./app/node_modules/core-js/library/modules/es6.object.get-prototype-of.js","webpack:///./app/node_modules/core-js/library/fn/object/get-prototype-of.js","webpack:///./app/src/ui/lib/list/list.tsx","webpack:///./app/src/ui/repositories-list/group-repositories.ts","webpack:///./app/src/ui/repositories-list/repository-list-item.tsx","webpack:///./app/src/ui/repositories-list/repositories-list.tsx","webpack:///./app/src/ui/repositories-list/index.ts","webpack:///./app/src/ui/window/full-screen-info.tsx","webpack:///./app/src/ui/window/zoom-info.tsx","webpack:///./app/src/ui/window/window-controls.tsx","webpack:///./app/src/ui/window/title-bar.tsx","webpack:///./app/src/ui/window/index.ts","webpack:///./app/src/lib/git/gitignore.ts","webpack:///./app/src/models/submodule.ts","webpack:///./app/src/lib/git/submodule.ts","webpack:///./app/src/lib/git/mergetool.ts","webpack:///./app/src/lib/git/rm.ts","webpack:///./app/src/lib/progress/revert.ts","webpack:///./app/src/lib/git/revert.ts","webpack:///./app/src/lib/git/checkout-index.ts","webpack:///./app/src/lib/git/diff-index.ts","webpack:///./app/src/lib/merge-tree-parser.ts","webpack:///./app/src/lib/git/merge.ts","webpack:///./app/src/lib/git/var.ts","webpack:///./app/src/lib/git/update-ref.ts","webpack:///./app/node_modules/double-ended-queue/js/deque.js","webpack:///./app/src/lib/status-parser.ts","webpack:///./app/src/lib/helpers/regex.ts","webpack:///./app/src/lib/git/diff-check.ts","webpack:///./app/src/lib/git/status.ts","webpack:///./app/src/lib/git/rev-parse.ts","webpack:///./app/src/lib/git/rev-list.ts","webpack:///./app/src/lib/git/remote.ts","webpack:///./app/src/lib/git/refs.ts","webpack:///./app/src/lib/git/reflog.ts","webpack:///./app/src/lib/git/push.ts","webpack:///./app/src/lib/git/pull.ts","webpack:///./app/src/lib/git/log.ts","webpack:///./app/src/lib/git/init.ts","webpack:///./app/src/lib/git/fetch.ts","webpack:///./app/src/lib/git/update-index.ts","webpack:///./app/src/lib/git/commit.ts","webpack:///./app/src/lib/git/clone.ts","webpack:///./app/src/lib/progress/lfs.ts","webpack:///./app/src/lib/progress/pull.ts","webpack:///./app/src/lib/progress/fetch.ts","webpack:///./app/src/lib/progress/push.ts","webpack:///./app/src/lib/progress/clone.ts","webpack:///./app/src/lib/progress/checkout.ts","webpack:///./app/src/lib/git/checkout.ts","webpack:///./app/src/lib/remove-remote-prefix.ts","webpack:///./app/src/lib/git/branch.ts","webpack:///./app/src/lib/patch-formatter.ts","webpack:///./app/src/lib/diff-parser.ts","webpack:///external \"timers\"","webpack:///./app/src/lib/tailer.ts","webpack:///./app/node_modules/fs-extra/lib/output/index.js","webpack:///./app/node_modules/fs-extra/lib/move/index.js","webpack:///./app/node_modules/fs-extra/lib/move-sync/index.js","webpack:///./app/node_modules/fs-extra/lib/json/output-json-sync.js","webpack:///./app/node_modules/fs-extra/lib/json/output-json.js","webpack:///./app/node_modules/jsonfile/index.js","webpack:///./app/node_modules/fs-extra/lib/json/index.js","webpack:///./app/node_modules/fs-extra/lib/ensure/symlink-type.js","webpack:///./app/node_modules/fs-extra/lib/ensure/symlink-paths.js","webpack:///./app/node_modules/fs-extra/lib/ensure/symlink.js","webpack:///./app/node_modules/fs-extra/lib/ensure/link.js","webpack:///./app/node_modules/fs-extra/lib/ensure/file.js","webpack:///./app/node_modules/fs-extra/lib/ensure/index.js","webpack:///./app/node_modules/fs-extra/lib/remove/rimraf.js","webpack:///./app/node_modules/fs-extra/lib/empty/index.js","webpack:///./app/node_modules/fs-extra/lib/copy/copy.js","webpack:///./app/node_modules/fs-extra/lib/mkdirs/mkdirs-sync.js","webpack:///./app/node_modules/fs-extra/lib/mkdirs/mkdirs.js","webpack:///./app/node_modules/fs-extra/lib/copy-sync/copy-sync.js","webpack:///./app/node_modules/graceful-fs/legacy-streams.js","webpack:///external \"constants\"","webpack:///./app/node_modules/graceful-fs/polyfills.js","webpack:///./app/src/ui/octicons/repository.ts","webpack:///./app/src/ui/octicons/octicon.tsx","webpack:///./app/src/models/diff/raw-diff.ts","webpack:///./app/src/models/diff/image.ts","webpack:///./app/src/models/diff/diff-selection.ts","webpack:///./app/src/models/diff/diff-line.ts","webpack:///./app/src/models/diff/diff-data.ts","webpack:///./app/node_modules/dugite/build/lib/git-environment.js","webpack:///./app/node_modules/dugite/build/lib/git-process.js","webpack:///(webpack)/buildin/amd-options.js","webpack:///./app/node_modules/ua-parser-js/src/ua-parser.js","webpack:///./app/node_modules/mem/index.js","webpack:///./app/node_modules/is-stream/index.js","webpack:///./app/node_modules/npm-run-path/index.js","webpack:///./app/node_modules/strip-eof/index.js","webpack:///./app/node_modules/cross-spawn-async/lib/enoent.js","webpack:///./app/node_modules/isexe/mode.js","webpack:///./app/node_modules/isexe/windows.js","webpack:///./app/node_modules/isexe/index.js","webpack:///./app/node_modules/which/which.js","webpack:///./app/node_modules/cross-spawn-async/lib/resolveCommand.js","webpack:///./app/node_modules/yallist/iterator.js","webpack:///./app/node_modules/pseudomap/pseudomap.js","webpack:///./app/node_modules/pseudomap/map.js","webpack:///./app/node_modules/cross-spawn-async/lib/parse.js","webpack:///./app/node_modules/cross-spawn-async/index.js","webpack:///./app/node_modules/username/index.js","webpack:///./app/node_modules/uuid/lib/bytesToUuid.js","webpack:///./app/node_modules/uuid/lib/rng.js","webpack:///./app/node_modules/uuid/v4.js","webpack:///./app/src/lib/http.ts","webpack:///./app/src/ui/lib/features.ts","webpack:///./app/src/lib/release-notes.ts","webpack:///./app/src/lib/squirrel-error-parser.ts","webpack:///./app/node_modules/event-kit/lib/composite-disposable.js","webpack:///./app/node_modules/event-kit/lib/emitter.js","webpack:///./app/node_modules/dom-helpers/transition/properties.js","webpack:///./app/node_modules/dom-helpers/util/requestAnimationFrame.js","webpack:///./app/node_modules/dom-helpers/class/removeClass.js","webpack:///./app/node_modules/dom-helpers/class/hasClass.js","webpack:///./app/node_modules/dom-helpers/class/addClass.js","webpack:///./app/node_modules/react-transition-group/CSSTransitionGroupChild.js","webpack:///./app/node_modules/react-transition-group/utils/ChildMapping.js","webpack:///./app/node_modules/warning/browser.js","webpack:///./app/node_modules/chain-function/index.js","webpack:///./app/node_modules/prop-types/lib/ReactPropTypesSecret.js","webpack:///./app/node_modules/prop-types/factoryWithThrowingShims.js","webpack:///./app/node_modules/react-transition-group/CSSTransitionGroup.js","webpack:///./app/node_modules/fbjs/lib/isNode.js","webpack:///./app/node_modules/fbjs/lib/isTextNode.js","webpack:///./app/node_modules/fbjs/lib/containsNode.js","webpack:///./app/node_modules/fbjs/lib/shallowEqual.js","webpack:///./app/node_modules/fbjs/lib/getActiveElement.js","webpack:///./app/node_modules/fbjs/lib/ExecutionEnvironment.js","webpack:///./app/node_modules/react-dom/cjs/react-dom.production.min.js","webpack:///./app/node_modules/react/cjs/react.production.min.js","webpack:///external \"module\"","webpack:///./app/node_modules/source-map/lib/source-node.js","webpack:///./app/node_modules/source-map/lib/quick-sort.js","webpack:///./app/node_modules/source-map/lib/binary-search.js","webpack:///./app/node_modules/source-map/lib/source-map-consumer.js","webpack:///./app/node_modules/source-map/lib/mapping-list.js","webpack:///./app/node_modules/source-map/lib/base64.js","webpack:///./app/node_modules/source-map/source-map.js","webpack:///./app/node_modules/source-map-support/source-map-support.js","webpack:///./app/node_modules/file-uri-to-path/index.js","webpack:///./app/src/lib/logging/format-error.ts","webpack:///./app/src/lib/logging/format-log-message.ts","webpack:///./app/src/lib/logging/renderer/install.ts","webpack:///./app/src/ui/index.tsx"],"names":[],"mappings":"0BACA,cAMA,IACA,iBAGA,mBACA,CACA,IACA,aAIA,mCAGA,aAGA,OACA,OAIA,OAzBA,YA4BA,MAGA,uBACA,GACA,kCACA,CACA,gBACA,cAGA,OAGA,iBACA,sCAAiD,CACjD,UAGA,iBACA,YACA,qBAA2B,UAA0B,UACrD,YAAiC,CAAe,QAChD,EAEA,aADA,QAIA,mBAAsD,wCAA+D,SAGrH,MAIA,gCChEA,yBAGA,kBCNA,kB,oCCC2B,aACzB,MAAM,IACP,gDAHD,WACA,EAIA,aAaA,EAIA,YAJsC,aACpC,MAAM,IACP,WAQD,E,YAAgD,aAC9C,OACE,KADE,IAKL,4EClCD,qBACA,OAmEA,GAKa,eAAe,GAAM,SAA2B,wBACnD,4BAEA,sBAAe,KACrB,MAEA,cAAI,KAAK,MACP,kBAAK,MAER,cAKM,aAAQ,IACb,CAAI,KACF,kBAAK,YAER,OAcM,6BACL,IAAO,KAAK,YACR,KAAK,YA6BH,4CAAW,KACjB,CACE,QADE,QAAK,MAAM,QAIf,iBAAI,KAAK,MACP,cAAK,MAER,UACF,CAjDQ,OACL,CAAI,KACF,kBAAK,YAER,MAWM,SACL,MAAM,GAAY,EAChB,mBACA,CAAE,eAAoC,OAApB,QAAK,MAAM,MAC7B,KAAK,MAGP,iBACE,2BACa,YACX,SAAU,KAAK,MAAM,SACrB,QAAS,KAAK,QACd,KAAM,KAAK,MAAM,MAAQ,SACzB,IAAK,KAAK,YACV,SAAU,KAAK,MAAM,SACrB,aAAc,KAAK,MAAM,aACzB,KAAM,KAAK,MAAM,KAAI,gBACN,KAAK,MAAM,aAAY,gBACvB,KAAK,MAAM,cAEzB,KAAK,MAGX,SA7D0D,EAA7D,E,0BCzEA,aAEA,EAEA,sBAEA,OAEA,WAAsC,0BAAuC,CAAgB,eAE7F,gCACA,WAAiB,gBAAsB,OACvC,WAGA,QADA,+CAEA,iBAKA,MACA,Q,iBCtBA,QAOA;;;;aACA,CAEA,yBAGA,WAEA,KAAiB,gBAAsB,OACvC,IAGA,KAFA,sBAIA,0BACA,eACI,sBACJ,0BACI,iBACJ,oBACA,qBACA,QAMA,sBACA,IAEA,OA3BgB,GAEhB,wCA0BA,UAGA,4BACA,CACA,QAAG,8BAIH,YAAC,oBC/CD,aAEA,gBAEA,uBACA,MACA,oCAEA,oC,iFCRA,aAAS,oBACT,aAAS,gCACT,aAAS,sB,mCCFT,aAEA,EAEA,sBAEA,OAEA,WAAsC,0BAAuC,CAAgB,eAE7F,oBACA,gBACA,WAAmB,QAAkB,OACrC,MACA,oBACA,iBACA,gCACA,+BAEA,MAEA,uBACA,CAGA,cAFA,gBACA,QAEA,CAAC,iJC1BD,UACA,UACA,UACA,I,uBCHA,aAEA,EAEA,sBAEA,OAEA,WAAsC,0BAAuC,CAAgB,eAE7F,uBACA,IACA,4BAGA,2IACA,yB,gCCiC0B,aACxB,MAAM,GAAc,EAKpB,+BAAI,EAAO,OACT,OAAO,EACF,OAAI,EAAO,OAChB,OAAO,EAEP,OAEH,gBA0G+B,aAE5B,YAAK,WACH,sBACF,iCAAK,WACL,6BAAK,WACL,yBAAK,WACI,0BACL,8HACF,aACF,uGAAK,WACH,oBACF,6EAAK,WACH,SACF,sEAAK,WACH,gBACF,sGAAK,WACH,eACF,0GAAK,WACL,6BAAK,WACH,sBACF,sHAAK,WACH,mBACF,yFAAK,WACH,qBACF,oEAAK,WACI,4BACT,2EAAK,WACH,gBACF,gEAAK,WACH,iBACF,mDAAK,WACH,uBACF,2EAAK,WACH,gBACF,sCAAK,WACH,mBACF,qJAAK,WACH,gCACF,6DAAK,WACH,oBACF,2DAAK,WACH,sBACF,yBAAK,WACH,aACF,0CAAK,WACH,cACF,2CAAK,WACH,iCACF,mGAAK,WACH,kBACF,+EAAK,WACH,oBACF,8CAAK,WACH,YACF,oBAAK,WACH,kBACF,oCAAK,WACH,yBACF,2DAAK,WACH,8BACF,4IAAK,WACH,+BACF,oJAAK,WACH,sBACF,+IAAK,WACH,kBACF,+DAAK,WACH,iBACF,kDAAK,WACH,8BACF,8DAAK,WACH,qBACF,8FAAK,WACH,yBACF,yFAAK,WACH,8BACF,kGAAK,WACH,8BACF,yGAAK,WACH,mBACF,uCAAK,WACH,iBACF,uCAAK,WACH,kBACF,sDAAK,WACH,kBACF,2DAAK,WACH,sBACF,iGAAK,WACH,eAEA,+DAAO,EAAY,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,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,SACA,I,mBCjCA,kB,4BCAA,CAuDA,aAEA,cAkGA,UACA,UAEA,aAkBA,OACA,4CAEA,yCACA,UAEA,aAiBA,OACA,4CAEA,yCACA,UAEA,gBAcA,OACA,WAEA,gBACA,OACA,WAEA,oBAGA,oBAMA,2BACA,wBACA,wBAEA,aACA,mCACA,WAEA,IACA,EACA,OAfA,6BAEA,MAEA,UAaA,CA7LA,OACA,gBACA,mBACA,oBACA,qBACA,4BACA,WACA,wBACA,kBAMA,yBACA,wBACA,wBAEA,WACA,mCACA,WAEA,IACA,EACA,OAfA,6BAEA,MAEA,QAaA,UACA,YACA,2BACA,oBAMA,2BACA,wBACA,wBAEA,aACA,mCACA,WAEA,IACA,EACA,OAfA,6BAEA,MAEA,UAaA,UAEA,iBACA,4BACA,oBAMA,2BACA,wBACA,wBAEA,aACA,mCACA,WAEA,IACA,EACA,OAfA,6BAEA,MAEA,UAaA,WACA,aACA,uBACA,gBAWA,MACA,QAEA,8BACA,wBAEA,OACA,mCACA,WAEA,IACA,OArBA,UACA,qBAIA,MAFA,UAIA,QAEA,IAcA,uCAKA,OACA,SACA,eACA,WAEA,SACA,uCACA,uBAEA,eAeA,OACA,0CAEA,MACA,aAEA,iBAEA,eACA,YACA,YAEA,OACA,EAEA,UA7BA,wCACA,uBAEA,eAkCA,OACA,0CAEA,MACA,iBAEA,eACA,YAEA,UACA,EAEA,IA7CA,eAEA,sBAoDA,KAqBA,SApBA,SAsBA,aACA,yBACA,MACA,QAEA,YACA,SAEA,kCACA,sBAEA,aApQA,QACA,SACA,OAEA,YAKA,EAHA,WAEA,IAEA,sBACA,iDACA,kBACA,wBACA,yCACA,oBACA,QAEA,4CACA,iCACA,CACA,2BACA,EACA,GAEA,cACA,kBACA,0CAMA,MACA,gBACA,mBAAiC,qBACjC,8BAEA,IAEA,IACA,mCACA,UACA,GAAE,WAEF,oBACA,uBAAyC,kBAGzC,iBACA,WAEA,MADA,OACE,4JCrDF,UACA,UACA,UA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A2B,wCAC3B,eACA,aAA6B,uBAC7B,wBACA,WAAwB,uBACxB,6BACA,QACA,eACA,SACA,mBAAmC,QACnC,QAAoB,aAEpB,KACA,eACA,WACA,KAAiB,MAAkB,OAAO,aAC1C,MACA,QAGA,CAGA,YACA,CACA,MAEA,aACA,CACA,KAEA,CAEA,kBACA,MACA,cAAmB,YACnB,IAEA,CACA,gBACA,CAAc,eAAgB,QAAkB,OAChD,SACA,OAAgC,UAEhC,QAEA,CACA,gBACA,WACiB,EAAjB,MAAmC,OAC9B,IAAwB,0BAC7B,MACA,QACA,CACA,gBACA,uDACA,aACA,aAKA,CACA,kBACA,IACA,GAAY,eAAgB,MAAgB,WAC5C,gBACA,oDACA,wEACA,qDAA0G,0CAC1G,IACA,CACA,CACA,SACA,kBACA,IACA,GAAY,eAAgB,MAAgB,WAC5C,gBACA,iDACA,qEACA,0DAA8G,mCAC9G,yBACA,MACA,CACA,CACA,QAOA,CACA,gBACA,MAAoB,WACpB,+CACA,6CACA,mBAA8B,SAE9B,kCAEA,oBACA,YAGA,qDACA,GAEA,eAAmB,QAAkB,OACrC,SACA,gBACA,cACqB,qCAErB,QAD4B,IAI5B,CAEA,eAAqB,QAAmB,OACxC,SACA,KAA8B,eAC9B,oBACA,cAEA,cACyB,sBAEzB,QACA,QACuB,uBAKT,cACd,UAA8B,SAE9B,aACA,UAEA,uBACA,KACO,iBAAkB,MAAoB,OACpC,IACE,wDACX,iBAAqB,EAAW,IACzB,MACP,UACA,OACA,CACA,QAGA,CACA,cACA,WAAiB,QAAkB,OACnC,MACA,+CACO,6BAEP,YAAsB,SAEtB,IAEA,CACA,kBACA,OACA,0CACA,MAA2B,sBAAgB,oBAA6B,OACxE,uBACA,yBACS,wBAET,OACA,GAAiB,SACjB,kBAAgB,OAChB,SAAiB,MAAoB,OACrC,4BACA,KAAmB,QAAkB,OACrC,SACA,yBACA,6DACA,eACS,2BAAgB,iBACzB,kBACS,4BAAgB,eACzB,cACA,uBAGA,EACA,QAEA,CACA,cACA,SACA,YACA,gBAAiB,MAAkB,OAC9B,gBACL,4BACA,MACA,gBACA,CACA,gBAAiB,MAAkB,OAC9B,gBACL,gBACA,cAGA,CACA,cAA4B,6BAC5B,cAA6B,4BAI7B,CACA,gBACA,8BACA,UAAqB,KACrB,4BACA,iCACA,MAAgB,WAChB,6BAEA,wBACA,EAGA,CACA,gBACA,yBACA,EAAY,wBAA+B,MAAgB,OAC3D,MACA,yBACA,4BACO,wBAEP,QACA,SACA,cAAqC,iBACrC,cAAmC,gBAInC,CACA,sBACA,OACA,eACA,YAAY,eAAgB,QAAgB,OAC5C,SACA,gBACA,+BACA,+BACA,gCACA,6BACA,qEACA,6EACO,gBAEP,SAKA,CACA,cACA,QACA,KACK,uBACL,KACA,SAEA,cACA,QACA,KACK,sBACL,KACA,QAGA,CACA,cACA,WACA,IACA,sBACA,KAAK,YAEL,QACA,QAGA,CACA,gBACA,gBACA,YACA,QACA,IAGA,CACA,gBACA,QAA+B,WAC/B,sBACA,MAAiC,QACjC,gBACK,sBACL,iBACA,CAIA,CACA,gBACA,aACA,YAAY,wBAA+B,MAAgB,OAC3D,SACA,gBACA,cAA0B,aAC1B,sBACA,+CACO,UAEP,UACA,kBACA,eACA,qBACA,iDACA,QACA,0CACK,OACL,4BAAgC,kBAA6B,OAC7D,WACA,mEACA,yBACA,yCACA,iBAA2C,UAE3C,QAEA,CACA,cACA,GAEA,sBACA,SAAiB,cAAwB,aAEzC,SACU,MAFV,SAIA,mBAA+B,iBAC/B,iBAAqB,iBAAyB,aAE9C,YACY,MAFZ,SAKA,OACA,QAIA,CACA,cACA,IAAyB,kBACzB,2BACA,UACA,gBACA,eACA,uBAEA,OACA,aACA,cACA,8BACA,UACA,2BACA,EACA,CACA,QAEA,CACA,cACA,qBACA,oBACA,4BACA,WACA,oCACA,OACA,UACA,kBACA,kBAEA,UACA,EAEA,CAEA,oBACA,IAAe,sBACf,UACA,QAAiB,QAAkB,OACnC,MACA,gCACA,kDACA,SAGe,eACf,MAEA,CACA,kBACA,IACA,MACA,eAAiB,QAAkB,WACnC,MACA,iBAAuC,KACvC,WACA,sBAAqD,YACzC,IAEZ,QACA,wBAAqD,YACzC,IAEZ,KACA,OACA,aAyBA,CAsJA,gBACA,SACA,MAEA,MAFsB,0BACtB,UAQA,CAaA,gBACA,uBACA,iBAEA,kBACA,MACA,sBACG,sCACH,0BACG,cACH,wBACA,UACA,OACA,QACS,yCACT,IACA,CACA,EAEA,gBACA,OACA,aACA,sDACA,KAAiB,MAAqB,OAAO,eAC7C,OAIA,CACA,kBACA,OACK,wBAAM,gCAAqC,MAA8B,mBAC9E,cACA,mBACA,iBAEA,cACA,gCACA,eACA,+EACA,MAAiB,MAAgB,OAAO,KACnC,qBACL,MAEA,gBACA,OACA,iBAGA,CACA,cACA,8BAAyC,YACzC,gCAA0C,YAC1C,CAGA,CAEA,cACA,GAAyB,iBACjB,mBACR,eACA,cACA,GAA0B,kBAClB,oBACR,gBACA,cACA,uCACA,+BACA,eAAwC,YAExC,eAAsB,8BACtB,cACA,SACA,MAOA,MANA,WAAuB,aACvB,EAA4B,aAC5B,EAA4B,eAE5B,mBAAmC,SACnC,IAIA,CASA,cACA,aACA,gBACA,kDACA,QACO,4EACP,MACA,mBACA,+BACA,yDAEA,gCADA,KAIA,CACA,cACA,IAA6B,SAC7B,4CACA,yBACA,oCACA,8BACA,sBACA,YACA,kBAIA,CAqCA,cACA,IAA+B,SAC/B,6BACA,UACA,oCACA,kCACA,kBAGA,CAMA,gBACA,CACK,yEACL,IACA,QAQA,cACA,2BACA,oBACG,oEACH,YACA,MAAmC,wBACnC,WACA,gBACA,IAAG,uDACH,kBACG,qEACH,kBAEA,0BAAgC,oBACxB,YAAiB,KACzB,OAGA,CACA,gBACA,GACA,iBACA,SAAkB,eAClB,oBACA,oCACA,YACA,aACA,UACA,sBAAyC,6BACzC,WAEA,KACA,aACA,OAAwB,4BACxB,cAAuB,yBAClB,iBAEL,aACA,QAIA,CACA,gBACA,wCACA,GACA,OAEA,gBACA,IAAuB,OACvB,cAAuB,mBACvB,mBACA,kBACA,OACA,iBAA+B,oBAC/B,KACA,MACA,CACA,QAGA,CACA,gBACA,QACA,KACA,gBACA,kBACA,cACA,UAEA,gBAAkB,OAClB,SAEA,kBACA,wBACA,eAOA,CAuIA,oBAGA,2BAEA,yCAAsE,UAA4B,SAElG,mBAGA,mBACA,GACA,6CACA,IACA,2CACA,QAEA,OACA,OACA,KACW,wBACX,SACA,IAEA,OACA,UACA,wBACA,kBAEA,MAAc,MAAW,SACzB,WACA,uBACA,YAEA,CACA,OACA,qBACA,oBACA,CAEA,IAAiB,qBAA8B,WAE/C,YAAU,0CACV,MAEA,kBACA,4CACA,YACA,oEACA,SACqB,gBACrB,6BACA,eACA,SAAyB,yBACzB,UAAiC,8BACjC,gBACO,oEACP,mBACA,UACA,OAEA,kBACA,iBACA,mBAA6B,iBAC7B,sBACA,gCACA,iDAEA,SAQA,6BAPA,QACA,gBACA,qEACA,OACA,UACgB,wBAChB,OAKA,CACA,oBACA,aACA,0BACA,gCACA,EAAmB,cACnB,UACA,gBACA,iBAEA,IAEA,gBACA,MAAuB,mBACvB,kBACA,iBACA,kBAA6B,oCAC7B,QAEA,oBACA,WAAiB,EAAQ,SACT,kBAChB,cACA,sBAAoC,MACpC,QACA,gCACA,6BAEA,CAQA,oBACA,sBACA,IACA,kCACA,6CACgB,YAChB,wBACA,iBACA,eACkB,wCAElB,iCACA,OAEA,gBACA,CAAa,KAAQ,OACrB,eACA,wCAAqB,GACrB,gDACA,6BACA,YACO,kBACP,8CACO,oBACP,GACA,CACA,QAEA,CACA,0BACA,SACA,aAA6B,sBAC7B,wBACA,gEAEA,MADA,MACmB,iBACnB,oBACA,oBACA,oBACuB,mBACvB,aACA,SAEA,oBAEA,cACA,YACkB,qBAClB,SACA,aACA,UACA,qBACA,KAEA,OACA,GACA,WACA,GACA,eAIA,iBACA,KACA,OACA,GACA,CAMA,CACA,kBACA,aACA,uCACA,KAAsB,QAAc,QACpC,SAA8B,eAC9B,yBACA,2DACO,cACP,uCACA,mBACA,WACA,EAEA,IACA,CACA,SAEA,gBACA,uBACA,wCACA,iBACA,UAAwB,IAAc,IACtC,gBAIA,oDACA,KACA,EACA,KAEA,yBACA,qBAMA,CAYA,oBACA,GACA,SAAwB,0BACxB,QAAoB,kBACpB,MAA2B,wBAC3B,MACA,MACA,qBACA,OAAiC,QACjC,MAEA,CACA,cACA,UACA,KACA,KAKA,CAEA,gBACA,gBAAsC,cACtC,cACA,yBACA,8BACA,SAMA,CACA,gBAIA,mDACA,SAAiB,mCACjB,sBACA,KACA,mDACA,2BAGA,aAAiB,2BAAiD,OAClE,kCACA,SACA,IAGA,iDACO,8BACP,mBACA,wCACA,YACA,aACA,8BACS,wDACT,oBACS,gEAIT,MACO,mEAGP,WACA,sBACA,oBAEA,kDACA,KAAO,+CAEP,IAGA,OACA,iBACA,4EACO,kCACP,mBAEA,CAKA,oCAJA,WACK,uDAEL,OAGA,cACA,yBACA,kBAGA,8CAFA,kCACA,QAIA,CACA,0BACA,CACA,iCACA,2CACA,KACA,QACA,iBACA,kBACA,2CACA,cAA+B,OAC/B,eACG,WACH,YACA,mCACA,IACA,GACA,oBACA,wBACA,cACA,yCACA,UAAmC,4BACrB,QACd,kCACA,WACA,SACA,MACA,IAAe,GACf,WACA,YACA,iBACA,kCACA,oCACA,iCACA,yCACA,QACA,MAAO,iBACP,kEACA,8CACA,WAEA,4CACA,+BACA,QAAmC,4BACrB,QACd,sBAEA,0BACA,OACA,KACA,CACA,oBACA,2CACA,UACqB,OACF,UACnB,qBACgB,sBAChB,mBACA,cACA,WACA,gBAEA,gBACA,sBAA4C,QAC5C,uBACA,KAAiB,QAAiB,OAClC,QACA,qCACO,2BACP,QACA,OAEA,OACA,QAGA,CACA,gBACA,+BACA,0BACA,kBACW,sBAAX,SAEA,eACA,KAAqB,MAAkB,WAEvC,iBAEA,UAHA,UAG2B,YAC3B,4CACA,YACA,iBACA,UACA,EACA,CACA,EAEA,oBACA,aACe,iCACf,gCACA,wBACO,oDACP,uCAGA,4BACA,2BAEA,kBACA,SACA,gBAGA,CACA,kBACA,gCACA,QACA,WAAqB,MAAqB,UACnC,gDACP,UACA,MAEA,CAES,sCADT,UACA,IACA,SACA,WACA,KAAuB,OACvB,4BACA,KAAqB,MAAkB,WACvC,gBACA,wCACA,aACS,gEACT,mCACA,SACA,KAEA,MAA4B,qBAC5B,aAAsB,aAAsB,UAC5C,qBAA+C,mBAC/C,0BAAkD,qCAClD,aAAkC,SAClC,yBACa,oBACJ,oBACT,WAEA,KACA,CAAsB,eAAkB,MAAwB,UACvD,MAAwC,eAEjD,eAAgD,kBAAkB,MAA6B,OACtF,WACT,2BACA,2BACA,eACA,cAAmC,WACnC,SAAkC,QAClC,KACA,CACA,IAAqB,KAErB,gBACA,SACA,MACA,WACA,aACA,qBACA,wBACA,wBACA,OACA,UAA0B,UAA8B,KAAY,SACpE,CACA,MACA,EACA,iBACA,uBACA,QACA,CACA,CAKA,CACA,kBAEA,MAEA,iBAEA,8CACA,sBACA,iBACA,OAEA,CACA,kBACA,cACsB,IAAtB,IAAgC,IAChC,uBACA,gBACA,OAEA,QACA,QAEA,CAEA,cAEA,WAEA,uBACA,KACA,qBAGA,IAEA,cAGA,4BACA,IACA,CAAU,SAAsB,OACzB,cACP,gBAAmB,YAAsB,OACzC,WACA,SACS,4EACE,uEAEX,GAAG,WACH,QAEA,gBACA,SACA,UAEA,QAAO,CAA4B,KACnC,QACA,IACA,KACA,IACA,CAEA,CASA,gBACA,OACA,aACA,sDAEA,UAEA,oBAEA,WACA,iBAEA,yBACA,kBAA2B,mBAAiC,OAC5D,EAEA,IAAiB,MAAgB,OACjC,IACA,MAEA,aACA,IACA,SACA,eAAiB,MAAoB,OAAO,IAC5C,MAIA,CACA,oBACA,WAAiB,gBAA6B,OAC9C,QACA,WAAyB,UACzB,QAAgC,YAChC,YAA+B,WAC/B,QAAgC,aAEhC,oBACA,IAGA,CACA,cACA,kBACA,gCACA,6BACO,oDACP,2BACA,UAA+B,2BAE/B,MACA,KAEA,gBACA,2DACY,kBACZ,gCACc,0BACJ,mDAAiE,yBACxE,gBACH,OACA,oDACA,4CACA,WACA,CAGA,CACA,gBACA,iBACA,qCACA,iCACA,iBACA,UAEA,OACA,OAIA,CACA,gBACA,cACA,YACA,kBAAuC,gBACvC,4CACA,eACA,yCACA,uBACA,sBACA,UAEA,oBAEA,aAEA,gBACA,CACA,eACK,iCACL,oBACK,wBACL,oEACA,8BACA,GAEA,oBACA,MACA,8BACA,iBAEA,QACA,wCACA,qCAEA,yBACA,OACA,6EACA,4EAAwH,iCACxH,sCACA,sDACA,KACA,cACA,0CACA,OACA,0HACA,MASkB,mBARlB,oCACA,aACO,sCACP,0CACO,2CACP,wBACA,WACA,8FAA0E,0CAC1E,oBAAkC,sBAA+B,WACjE,mDAES,kCACT,iDAA2E,+BAC3E,MACA,CACA,EAEA,kBACA,GAA2B,wBAC3B,wCAAkE,KAClE,QACA,YACO,6CAEP,eACA,SAEA,CACA,oBACA,OACA,+BACA,MAAsB,sBACtB,WAAwB,0BAExB,WACA,QACA,YACA,YACA,IAGA,CACA,kBACA,WACA,eAAsB,eAAgB,WAA0B,OAC3D,WACL,gBAEA,sBACA,MACA,kBACA,cAAoC,YAAe,WACnD,+BACA,2BAAoC,qDACpC,QACA,4BACA,sBACO,mCAEA,QACP,oBACA,SACA,EAEA,oBACA,gBACA,iCACA,gBACA,qCACA,OACA,mBACA,wDAEA,sBACA,IACA,GACA,6BACA,mBACA,cAA4B,mDAE5B,OAEA,cACA,IAA8B,wBAC9B,mBACA,MAAY,SACZ,+BACA,OACA,wBACO,gEACP,SACO,uDACP,4CACA,QACA,mCACA,YAEA,CACA,gBACA,WAA2B,WAAsB,YACjD,iCACA,wEACO,MAEP,QAEA,CAEA,eAA8B,6BAC9B,eAA+B,qDAC/B,cACA,MAA+B,wBAC/B,yCACA,6DACA,gBAAc,8CACd,eAEA,8BAFgD,WAChD,oBAGA,cAAwB,oCACxB,cACA,uDACA,SACA,cACA,wDACA,SAKA,CACA,kBACA,iBACA,kBACA,mDACA,yBACA,QACA,WACA,oCACA,mBAAqB,aAAsB,MAC3C,kBACA,GACW,oDACX,IACA,CACA,mBACA,IACA,CAIA,CACA,kBACA,MACK,eAAS,kCACd,iBAAiB,WAA0B,OACtC,SACE,kBAAS,sCAChB,qBAAmB,WAA4B,OAC1C,WACE,kBAAS,gDAChB,UAGA,CACA,gBACA,GACA,YACA,2CACA,WACA,sBACA,QAGA,gBAFA,8BACA,MAIA,CACA,oBACA,aACA,YAEA,CACA,gBACA,uCACK,6BACL,yBACA,+CACK,KACL,QAMA,CACA,gBACA,OACA,OACA,cACA,OACG,UACH,mBACA,eAGK,sBAEL,eACA,gBACA,oBACA,sCACA,OAEA,cAGA,CACA,sBACA,GAAwB,YACxB,mBACA,iBACA,sBAEA,aACO,0BACP,4BACA,2BACA,QAEA,iBACA,eAAuB,UAEvB,cAAU,oBACV,qBACA,yBACA,OAEA,CAEA,kBACA,WAGiB,YAAjB,MAAoC,UACpC,OACA,WACA,GACA,OAAgB,IAChB,IACK,QACL,OACA,QACK,6BACL,UACA,QACA,EAAuB,SAEvB,kBACA,UACA,iCACS,WACT,gBACS,oCACT,uBACA,KAEA,yBACS,+CACT,uBACA,KAEA,QACA,KAEA,QAAU,6CACV,YAEA,gBACA,IACA,SAAuB,oBAAgB,MAAkB,yBAE7C,MADZ,6BAC6C,EAAU,uBAGvD,MAFA,KAGA,SAEA,oBACA,YACA,wCAEA,SACA,mBACA,WAAqB,EAAS,QAC9B,gCAA6F,gBAC7F,2DAA6H,gBAC7H,yCACS,wBAEA,qCACT,qCAAkD,KAClD,MAEA,UACA,OACA,KAAgC,uBAChC,WAAG,KACH,CAAoB,UACpB,YACA,6BACO,wDAEA,KACP,uBACA,0CACA,qCAEO,QAAS,0DAGhB,UAEA,CAIQ,6CAHR,qBAEA,UACA,aAAgC,WAFhC,EAIA,MADK,wBAEL,QAAgB,wCAChB,6CACA,WACA,UAIA,iBAJkC,UAClC,oBAA8C,8BAAoB,SAElE,YAIA,CACA,gBACA,oBACA,kEACK,MACL,yCACA,uCACA,kBAAU,sBACV,6BACA,UAEA,cACA,MACA,0BACA,qBACA,OAAwB,gBAAgB,WAA0B,OAC3D,wBAEP,GAEA,cACA,2BACA,iBACA,uBAAiB,mBAA4B,OACxC,iBACL,SAEA,cACA,CACA,oFACA,eAAiC,yBACjC,0CACA,KAEA,aAIA,OAA0B,8FAC1B,2EACA,WACA,aACA,OAA0B,6FAC1B,0EACA,UAEA,cACA,OACA,OAAwB,kBAAgB,cAA4B,OAAO,iBACtE,gBACL,aACA,QAKA,CACA,sBACA,OACA,OACA,QAAuB,SACvB,SACA,IAA0B,UACT,eACjB,eACA,SAA2B,mBACnB,sBACR,kCACA,2BACA,gDACA,kCACA,QAAsB,UACtB,QACA,CAEA,SAFmB,SACnB,WAIA,CACA,kBACA,IAAyB,SACzB,0BAEA,OACA,aACA,QACG,4BACH,uBACA,6BACA,UACA,GAEA,2BACA,+BAAU,sBACV,KAEA,sBACiB,wBACjB,uBACA,QAiBA,CACA,wBACA,gBAGA,0BACgB,4BAA2B,gBAC3C,KACA,WACA,kBAWA,cACA,4BACA,KACA,gBApByB,YACzB,gDAMA,oBACA,iBACA,SACG,UACH,SACA,IAEA,SAAe,8BAEf,mBAKA,UACA,aACA,aAEA,MAFsB,yBACtB,eAIA,CACA,gBACA,OACA,QACA,iBAAiC,iCACjC,oBACA,mBACA,gBAAU,gCACV,OAOA,CACA,sBACA,OACA,SAGA,SAFgB,aAChB,aAIA,CACA,kBACA,SACA,oBACA,WAAc,iCACd,iCACA,KACK,0DACL,GAAc,QAEd,GACS,UAAT,SACA,OACA,gBACA,kBACA,8CACO,qBAEA,UACP,SACA,EAEA,oBACA,IACA,mBACA,sBAAuC,oBAAqE,SAAE,IAC9G,yBAAiC,kBAA6D,KAC9F,QAAU,QACV,OAEA,oBACyB,OACzB,wCACA,UACA,YAGA,CACA,oBACA,iDACA,UAEA,sBAEA,IACA,YAGA,UACA,0BAEA,kBAGA,gBACA,kBAEA,qCAKA,2BACA,kBACA,CAKA,cACA,oBACA,OACA,mBAA+B,SAC/B,YACA,4BACA,UACA,IAGA,QAEA,OAEA,cAEA,4BACA,cACA,eACA,sBACA,KAAG,KAEH,UAA6C,MAI7C,oCACA,2BACA,uBAGA,6BACA,gBACA,qBACA,MAEA,qBACA,cACA,KAEA,0BAKA,oBACA,cACA,uDACA,SACA,mBAAG,aACH,KAIA,YACA,OACA,8CACA,UACA,4BACO,cACP,GACA,CACA,SAEA,0BAQA,OACA,gBACA,UACA,8BAAgD,KAChD,qBACA,OAAiB,QAAkB,OACnC,SACA,oBACA,cACA,+CAGA,oBACA,SACA,OACA,IAGc,KAKd,wBAHA,MAA0B,YAAS,uBACnC,UAAsB,UAAS,yBAC/B,SAGA,CAEA,cACA,IAAyC,kCACzC,6BACA,MAGA,iBAAmB,EAAQ,KAC3B,2CACA,uBAEA,8CACA,KACA,KACA,kCACA,SAAmB,SACnB,wBACA,YACA,CAEA,CACA,cACA,IAAwC,iCACxC,+BACA,wBACA,SACA,8DACA,SAAkB,SAClB,sBACA,EAGA,CACA,cACA,uBAA+B,KAC/B,eACA,oCAA8C,oBAC9C,2CACA,uCAEA,mBAAU,SACV,iCACA,YACA,aACA,qCACA,YAIA,CACA,cACA,gFACA,IAIA,CACA,cACA,iCACA,mEACA,qBACA,SAAqC,aAErC,SACA,OAAuB,kBAAgB,cAAyB,OAChE,iBAAmC,yBAI5B,wCAEA,KACP,GACA,EAEA,cACA,eACA,wBACA,OACA,UAAmC,QACnC,MACA,EAMA,CACA,oBACA,SACA,eAAyE,mDAEzE,wBAEA,+BAAO,eAA4B,mBAA2B,GAC9D,SAAa,YACb,iBACA,yDACA,yCACA,oDACA,aACA,CACA,QAGA,CACA,gBACA,iBAA+B,aAC/B,sBACA,SAAc,UACd,0BACA,OAAiB,MAAiB,OAClC,eACA,KAAgB,IAEhB,SAEA,cACA,+CACA,oBAEA,gBACA,cAEA,wBACA,wBACA,gDAEA,2BAAiB,iBAA2B,OAC5C,mBACA,uBACA,sEACA,mBACA,sBACO,iCAEA,WAEP,WACA,QAEA,CACA,kBACA,yCAEA,0DACA,6CACA,uBACA,+DAEA,aAEA,oCACA,iEACA,6BACA,6BACA,qDACA,IACA,EAEA,gBAA0B,kCAE1B,CACA,kBACA,oBAOA,CAAkB,QAClB,KACA,OACA,sDAAsF,+BAAsB,4CAAkD,8BAA6D,mDAC3N,MAEA,kBACA,gBAIA,oBACA,UAEA,kBACA,cACA,wCACA,wEACA,SACA,UAEA,OAbA,gBACA,gBAaA,aAZA,gDAaA,OACA,wBACA,2BAEA,mCACA,8BACA,oBACA,QACA,aACA,wBACA,mBACA,sBACA,OAAO,KACP,WAEA,mBACA,iBACA,sBACA,uBAEA,kBACA,2BACA,qBACA,eAEA,4BACA,mBAAyC,yBACzC,qBACA,OAEA,MAAoD,aACpD,KAAwC,YACxC,UAAgD,aAChD,KAAsC,YACtC,IACA,IAAY,QACZ,MAEA,qBAnEA,eACA,6CACA,kDACA,QAEA,kCA+DA,kBACA,qBACG,QACH,2BACA,eACA,8CACA,8BAEA,sBACA,0BACA,2BAEA,0CAGA,oBACO,yBACP,IAEA,GACA,cAEA,CACA,cACA,YACA,iBACA,wBACA,YACA,mCACA,GACK,4DAA4C,+CAAwE,QACzH,YACA,iBACK,2DACL,WAEA,cACA,SAA0B,0BAA0B,QACpD,OAEA,cACA,SACA,0CAA0B,SAC1B,4BACA,qBACG,MAAE,EACL,KAEA,gBACA,SAAmC,4BAEnC,sBACA,0CACA,eACA,qBACA,+BAIA,mEACA,sBACmB,iCAAyB,wBAAqC,SAAE,EAEnF,qBAEA,iBACA,OACA,gBACA,SAEA,4BACA,eACA,oBACA,gCAEA,+CACA,8BAA0B,SAAyB,oBAA4B,SAAE,EACjF,KAGA,CACA,cACA,aACA,oBACA,YAAiB,WAAyB,WAC1C,uBACA,SACA,oBACA,+BACA,eACA,IACA,GAAK,KACL,cACA,qCACA,GACA,cACA,YAAqB,QACrB,iBACA,cACA,aACA,QAAqB,gBAAgB,WAAqB,OACjD,SAET,SACA,CAGA,CACA,cACA,MAAqB,kBAAgB,cAAyB,WAC9D,6BACiB,0BACjB,aACA,CAIA,CACA,kBACA,4CACA,gBACA,oDAEA,wBAGA,sBACA,wCACA,KACA,KACA,+BACK,qBACL,4CACA,cAEA,IACA,QAAU,gBACV,GAGA,CACA,cACA,qBACA,wDACA,yDACA,uCACA,OAAiB,MAAiB,OAAO,oBACzC,WACA,mBACS,2BACT,aACS,+CAET,oBACA,UAAgB,eAAgB,MAAkB,OAC3C,eACP,MACA,WACK,uCACL,MAIA,CACA,cACA,eAAgC,YAChC,yDACA,oCACA,wCACA,UACA,+EACA,cAOA,gCANA,uDACA,mBACA,iEACA,0CACA,KACA,QAEA,CACA,QAKA,CACA,gBACA,UAEA,6EACA,QAA+B,cAC/B,kEAAmG,gBACnG,mBACA,6BAAqE,yFAAmG,4EAA0G,8CAAuD,kCACzU,2BACA,iBACA,sCACA,cACA,EAIA,CACA,oBACA,CAAuB,YACvB,MACA,2BAIA,sDACA,gDAEA,uBAAqB,EAAW,QAChC,IACA,QACA,kBACA,aAAY,gBACZ,oBACA,wBACA,0BACA,iBACA,kCACA,cACA,2BACA,WAAsD,yBAEtD,OACA,4BACA,YAAwD,0BAExD,OAAmB,GACnB,KACA,CACA,QAEA,CACA,gBACA,OACA,QAAoC,0BACpC,WAAqC,2BACrC,WAKA,CACA,gBACA,wBACA,SAAqB,gBACrB,uEACA,oBACA,cAAwC,mBACxC,0BACA,2BACA,SACA,wBACG,yBACH,sBACA,WAA8B,SAC9B,YAEA,uEACA,gEACA,eACgB,OAQhB,qBAPA,QACK,uBACL,IACK,oCACL,iBACK,8BACL,QAIA,CACA,gBACA,CACA,UACA,yEACA,aAGA,CACA,cACA,CACA,cACA,iCAA0B,6BAC1B,oBAEA,kBACA,WAA+B,UAC/B,MAAkB,kBAClB,cAAkB,kBAClB,aAEA,gBACA,CACA,cACA,aAKA,CACA,cACA,eACA,iBACA,qBACA,iCACA,eACA,OACA,EAEA,oBACA,YACA,iBACA,oBACA,yBACA,2BAEA,gCACA,UAGA,CACA,gBACA,CACA,yBAAe,WACf,QACc,eACd,WACA,MAEA,kBACA,wDACA,oCACA,yBACA,iCACA,mCAA6C,kCAC7C,aAGA,CACA,oBACA,yDACA,8DACA,WACA,aACA,yBAA8C,mCAC9C,mCACA,iBAKA,CACA,cACA,6BACA,kCACA,gBACA,yBACA,kCACA,uEACA,gCACA,4CACA,EACA,mCACA,2BACA,eAEA,cAEA,CAwGA,gBACiB,OACjB,4CACA,UACA,kBAAiB,2CAAmF,UACpG,qCACO,cACP,WACA,mBAAqC,qBAErC,SAGA,CACA,gBACA,SACA,uBAEA,0DACA,wDACA,gDAEA,kCACA,wCACA,gDACA,2CACU,sCACV,6DACA,0CACA,6CACA,8CACU,mCACV,EAEA,CAEA,cACA,WACA,kCACA,6BACO,oDAGP,4EACA,4CAEA,4CACA,SAA6B,8BAAyB,wBAAiC,OAAE,EACzF,EACA,mCACA,OAAG,eACH,CAA+B,gBACrB,QACV,OACA,0BACK,mDACL,SAQA,CAEA,cACA,SACA,CACA,KACA,iCACA,OACA,2BACA,KACA,qBACA,4BACA,0BACA,EACA,oBACA,2CACA,iBACA,KACA,YAEA,WACA,MAEA,CACA,cACA,SACA,sBACA,WAAmB,UAAsB,OAClC,sBACP,KACA,KACA,EAGA,CACA,cACA,aACA,MAAiB,MAAgB,OAC5B,OACL,gBAAmB,MAAkB,OAChC,OACL,gBAAmB,MAAkB,OAChC,OACL,gBAAmB,MAAkB,OAChC,OACL,gBAAmB,MAAkB,OAChC,OACL,MAEA,cACA,gBACA,QACA,QAAyB,eAEzB,iDACA,6DACA,mCACA,qCACA,wBACA,oCAA4C,yBAA0C,eACtF,aAEA,cACA,0CACA,QAEA,cACA,gBACA,UAA0B,gBAE1B,mBAKA,mCACA,0EACA,yBACA,2BACA,wFACA,iEAGA,6BACK,gDACL,oBAEA,cACA,SAEA,GACA,uEACA,2BACO,mDACP,6BAGA,2CACA,MACK,mDACL,6DACK,gBACL,cACK,uBAEL,cAA4B,kBAE5B,yBACK,qCACa,gBAClB,IAEA,cACA,4BAEA,SAA0B,uBAG1B,uEACK,2CAGL,MAA6B,sCAE7B,aAA8B,2BAE9B,gCACA,8BACA,0CACA,QACA,OAIA,gCACA,qBAAe,eAAgB,MAAmB,OAC7C,eAA+B,gBACpC,QAAiB,eAAkB,MAAuB,OACrD,eAAkC,gBAEvC,oBACK,8CAGL,aACK,+BACL,cACK,iBACL,QAEA,CACA,gBACA,MAAiB,YACjB,KACA,SAAO,WACP,QAAW,CAAkB,KAC7B,CACA,CACA,gBACA,kBACA,MAAmB,uBACnB,WACA,SAAS,4BACT,QAAa,CAAkB,KAC/B,CACA,CAEA,CACA,cACA,kBACA,SAAqB,0BACrB,cACA,SAAS,+BACT,QAAa,IAAoB,KACjC,CACA,EACA,cACA,kBACA,YACA,YAA0B,0BAC1B,WACA,SAAS,+BACT,QAAa,CAAkB,KAC/B,CACA,CAOA,CACA,oBACA,CAAqB,kBACrB,OAAmB,8BACF,YAEjB,WACA,kBACA,sCACK,yBAEL,6BAEA,oBACA,yBACO,QACJ,mBACH,6BACA,SAEA,SACA,cAEG,uCACH,OACG,4BACH,kBAEA,4BACA,oBACA,QAEA,WAEA,KAAG,qBACH,iBAEA,8BACA,kBAEA,OAEA,KAAG,KACH,iBACA,gBACA,GACA,8BACA,6BACA,8BACA,UAEA,WAEA,KAEA,SAEA,yBACO,QACP,qBACO,0BAEP,MAGA,CACA,kBACA,SACA,2CACA,+CACK,0BAEL,2BACA,sBACA,YACA,0CACA,KAAiC,aACjC,SAEA,CACA,cACA,2CACA,qBACA,wBACA,EAEA,oBACA,2BACA,oCACK,YAAS,QACd,6BACA,WAAiB,EAAW,IACvB,YACL,aACA,QACA,gBAAqC,QACrC,eACA,OACA,GACA,QAEA,IAAiB,KACjB,IACA,sBACA,uBAAmD,SACnD,0BACA,KACA,IACA,QAAU,QACV,QAGA,CACA,kBACA,qBACA,oCACA,iBACA,YAEA,eACO,8CACP,QACO,iCACP,YACA,aACO,qCACP,aACO,iCAEP,aACA,QAGA,CACA,cACA,4BACA,IAAiB,QAAiB,OAClC,MACA,0BAAmE,SAEnE,IACA,QAEA,CAEA,gBACA,mCACK,gCACL,SAEA,cACA,SACA,wCACA,mCACA,kBACA,qBAEA,mEACA,+BACA,SACA,uEACA,OACuB,mBACvB,oBACA,gCACmB,YACK,kCACxB,uCACA,4DACA,aAAqB,UAAmC,OAAO,cAC1C,sBACrB,qBACA,SACA,UACA,+BACS,2BACT,0CACA,OAEA,qBACA,wBAGA,qBACA,yBACA,uCACA,QAA4B,uBAC5B,WAAmB,MAAyB,OACrC,cACP,OACA,GAIA,CA0BA,cACA,SACA,yCACA,iEACA,8CACA,kDACA,0CACA,OAEA,sBAEA,cACA,MAAsB,iBACtB,YACA,wBAAyD,iBACzD,aACA,oCACA,cACA,6DACA,6BACA,4BACA,2BACA,0BAEA,YACA,CACA,SAEA,cACA,iCACA,kBACA,mFACA,wCACA,sCACA,gBACA,eACA,oBACA,mCACA,YACA,CAIA,CACA,gBACA,qBAEA,SACA,eAKA,MAJA,gBAKA,mDACA,2DACA,iCACK,SAEL,SACA,QACA,aAIA,uBACA,mDACA,oCACA,8BAAgE,gCAChE,uBAAwD,wBAExD,qBACA,cAGA,kCACA,8DACA,aAEA,oCAEA,kDAEA,WACA,+CACA,yDACK,QAIL,eACA,MAuBA,MAvBqB,+BACrB,mCACA,MAAqB,8BACrB,qBAGA,KAIA,UACA,eACA,6DAGA,yBACA,gCACA,kBAGA,0BAEA,QAGA,gBACA,aAEA,SAAyB,WACzB,qDAEA,YACS,iBAAa,yCAGtB,gCACA,mEACS,QAET,UAA6C,QAC7C,MACA,YACA,MACA,MACA,QACA,UACA,QAEA,YACA,yFACA,6EACA,6CAAsD,4CAEtD,QAEA,gBACA,OACA,uBACA,CACA,MACA,cACA,MACA,MACA,QACA,UACA,QACA,CAKA,CACA,kBACA,cAIA,SAEA,YAKA,yBAJO,sCAEA,oBACP,gBAGA,iCAZA,4BAEA,wBAaA,WAAiB,QAAiB,WAClC,MACA,OACK,8CACL,OACA,cACA,iBAAK,KACL,WAAoC,QACpC,cACA,iBACA,aACA,WAAuD,0BACvD,MAGA,qBACA,iEAEA,uBACA,WACA,MACA,IACe,WACf,KAEA,cACA,yBACA,+CACA,KAEA,gBACA,6CACA,kDACA,0EACA,IAGA,CACA,cACA,qCACA,QACA,KACQ,UAAR,MAA0B,WAC1B,OACA,kCACA,yBACA,wCACA,uDAEA,KACA,sBACA,OACA,KAGA,CACA,cACA,mBACA,mCACA,wCACG,oCACH,wCACA,sBAEA,GAaA,CAWA,cACA,yBACA,gDAA8D,sBAC9D,qCAA4D,kBAC5D,OAAwB,cACxB,aAAU,IACV,KACA,cACA,OACA,MAGA,SAFA,QACA,QAGA,gBACA,uBAEA,kBAEA,2BACA,+BACA,sBAMA,SACA,uCAAwD,KAAe,SACvE,qBAAqB,MAAiB,OACtC,oBACA,WACA,0BACA,MAWA,iBACA,SAeA,MAdO,4BACP,6BAKA,YACO,OACP,yBACA,qBAMA,OACA,qCACA,aAAqB,cACX,yBACV,UAA6B,MAC7B,UAEA,CACA,QACA,qCAA8C,2BAC9C,YAA2B,YAC3B,+BACA,IACA,0CACA,4BACA,gCACA,2BACA,oCAEA,0BACA,GACA,MAAO,EAEP,SAA4B,aAG5B,aAMA,CA4DA,gBACA,OACA,yBAA+B,qBAAgC,OAC/D,KACA,iBAAiB,MAAmB,WACpC,kBACA,4BACA,yCACA,+CACA,KAA2B,MAC3B,gCACA,OACA,CACA,OACA,aAEA,gBACA,gCACA,EAGA,CACA,cACA,UAAqB,iCAErB,+CACA,MAFA,EAKA,CACA,gBACA,IAAkC,cAClC,YAAiC,mBAEjC,gEACA,uBAAmC,wBACnC,IACA,OAEA,gBACA,WACA,KAAiB,mBAA2B,OAC5C,YACA,6BACA,eAEA,4BACA,WAEA,kBACA,kBACK,0BAEA,+BACL,GAGA,CACA,kBACA,WACA,kBACA,MAAiB,MAAoB,WACrC,OACA,YACA,eACA,kBACA,GACA,gBACA,yBACA,uCACA,MACA,WAEA,WACA,uBACA,UAEA,CAEA,cACA,+BACA,YACA,MAEA,cACA,uBACA,GAA0B,0BAC1B,QAAsB,kBACtB,KACA,oDACA,WACA,aACA,YAAiB,OACjB,KAMA,CACA,gBACA,kCACA,oCACA,sBAEA,CACA,oBACA,eAAwB,kBACxB,kBACA,CACA,iBACA,aACA,gBACA,WACA,GAAuB,IAAS,IACzB,uBACP,SACA,QAEA,yBACA,2BACA,wCAGA,UACA,sBACA,oCACG,wBAGH,oBACA,SACiB,sBACjB,UAAuB,mBACvB,OAAG,SACH,SACA,sDACK,WACL,oBACA,kCACA,0CACA,oBACA,IACG,UACH,+DACA,oBACG,SACH,iCACA,yBACA,0BACA,GAAqB,yBACrB,mBACA,IAEA,MACA,aAEA,CACA,kBACA,kBACA,MAAqB,iBAAgB,eAAuB,OAC5D,WACA,YACA,mBACA,YACA,aACA,WAEA,UACA,KACA,QAEA,CACA,gBACA,MAAe,mBACf,sCACA,QACA,KACA,MACA,MACA,gBAAiC,cACjC,uBACA,WACA,MAEA,cACA,iDACA,kBAEA,cACA,gBACA,CACA,MACA,KACA,GAEA,cAIA,WAAiB,eACjB,kBAGA,2CACA,6BACA,wCAEA,2CACA,CAGA,CACA,gBACA,QAAoB,0CACpB,KAGA,oCAFA,mBAAkC,qCAAgF,EAClH,OAIA,CACA,cACA,gBACA,OACA,UAAsB,SACZ,UACV,MACA,CAGA,CACA,gBAEA,gBACA,UACG,iCACH,WACG,gDACH,eACA,UAEA,aAIA,CACA,oBACA,SACA,wBACA,kBACA,EAEA,QACA,qCACA,qEACA,mBACA,qCAEA,kBACA,4BAGA,uBAGA,qBAEG,aAEH,WACA,eACO,mBACP,SAAW,SACX,sBACA,mBACA,wBACA,kBACA,kBAAiC,eAEjC,OACA,QACA,yBACA,8BACA,yBACA,2CAEc,eACd,gBAEA,oBACA,gBACA,SACA,QACA,kCACA,iCACA,0FACA,IAKA,CACA,oBACA,wBAMA,YACA,gBACA,mDACA,0BACK,+BAEA,YAEL,wBACA,QACA,kBACA,sBACK,gBACL,QAEA,gBACA,OACA,oBACK,aACL,OAEA,CACA,oBACA,0BACA,qDACA,GACO,sCAAwD,UAC/D,aACA,GACA,EAGA,CACA,cACA,IAAe,SACf,gBACiB,EAAjB,MAAmC,OACnC,gBAAwD,gCACrC,gBAEnB,0BACA,MAEA,CACA,gBACA,oBACA,OAAe,SACf,gBACA,KAAiB,WAAwB,OACpC,cACL,OACA,QAKA,CACA,gBACA,OACA,UACA,WAAa,GACb,YAAmB,GAEnB,mBAAiB,MAAgB,WACjC,cACA,QACA,qBAA4B,QAAuB,WACnD,GACA,eAAuB,MAAmB,OAC/B,sBAAuC,eAClD,SACA,OAEA,UAEA,OACA,CACA,QAGA,CACA,kBACA,WACA,KAAiB,QAAmB,WACpC,MACA,cACA,gCACA,WACA,QACA,mBACA,WACA,sBAAmB,MAAoB,WACvC,kBACA,GACqB,WADE,2BACvB,gBAAgD,mBAChD,oBACA,uBACA,WAGA,MACA,CACA,CACA,QASA,CACA,oBACA,MACA,SACA,YACA,OACA,YACA,YAGA,WAEA,MAJA,IACO,IAIP,OACA,YACA,eAEA,OAEA,CACA,sBACA,CAAuB,yCACvB,iDACA,KAGA,CACA,kBACA,WACA,kCACA,UAAiB,iBAA2B,OACvC,iCACL,yBACA,WACA,SAEA,CACA,oBACA,0BACA,GACA,uBACA,aAEA,CACA,oBACA,MACA,UAGA,CACA,kBACA,OACA,UACA,yBACA,OAEA,iBACA,aAAqB,MAAmB,OAC/B,gCACT,iBACA,MACA,cAEA,oBACA,+BAAe,sCACf,kBAAiC,qCAEjC,GAEA,kBACA,wBACA,UACA,mBACA,KAEA,WAEA,SAEA,CACA,kBACA,CACA,wCACA,OAEA,kBACA,+CACK,8BAEL,sBACA,qDACA,QAEA,qCACK,SACL,IAEA,gBACA,YAEA,SAEA,QACA,uCACA,yBAEA,UACA,oBAGA,CACA,cACA,iBACA,SAGA,CACA,oBACA,WACiB,EAAjB,aAAwC,WACxC,SACA,wDACA,+BACA,+BACA,gCACA,QAAiB,sBACjB,WAEA,YACA,iBACA,aAEA,sBACA,aACA,WAAyB,sBAAgB,kBAA6B,WACtE,4BACA,gEACA,4DACA,CACA,YACA,uBACA,yBAAkC,YAClC,WAAoB,YAGpB,OAAsB,OAEtB,cACA,8BACA,8BACW,iDACX,+CACW,WACX,cAEA,qBACA,gCACS,8CACT,uBACA,IACA,CACA,CACA,QAEA,CACA,sBACA,UACA,IACA,mBACA,yBACA,oBAEA,qBACA,sBAGA,IAEA,oBACA,aACA,iBAA+B,mBACrB,IACP,sCACH,6BAA8C,aACpC,GAEV,oBAEA,MAEA,cACA,uCACA,eAIA,CACA,kBACA,OACA,CACA,mBACA,UACA,UACA,cACA,wBAAyB,UAA4B,WAEtC,wCACA,YACF,iBACE,cACf,QAA+B,eAC/B,SACA,QACA,sBAAe,6BAEf,QAAqB,SACrB,MAAU,yCACV,OAGA,CACA,kBACA,SACA,UAAwB,kBACxB,4BAAqC,cACrC,MAEA,2CACA,qBACA,WAKA,kCACA,IACA,wBAAkC,EAAQ,KACnC,UAAuB,sDAE9B,aAEA,UAEA,gBACA,qCACA,yBACA,oCAEA,cACA,eAEA,qBACA,KACA,yBACA,oBAEA,sBACA,QACA,GAEA,CACA,kBACA,sCAEA,KAMQ,wBALR,uDAIA,OACA,QAA2B,WAE3B,sCAGA,QAJA,aAKA,QAGA,iCADA,cAEA,eACA,IACA,uBACA,KAGA,oBAFA,eAGA,GACU,KAKV,aACA,GACA,gBAAa,uBACb,4CAEA,4DAEA,6BACA,SACA,gBACA,aACA,2BACA,EAGA,UAEA,yBACA,cACA,eAAuB,yBAAwB,eAC/C,cAGA,qBACA,KACA,yBACA,oBAEA,sBACA,QACA,EAEA,qBAA0C,IAAU,KACpD,SAEA,gBAEA,GAGA,CACA,gBACA,IACA,SACA,gDAAgE,OAChE,mCACA,2BACI,IAAE,SACN,iBACA,mBACA,sCAAgD,aAAc,OACvD,cACP,SACA,CAGA,CACA,oBACA,gBACK,kBAEL,+BACA,MAGA,mDAFA,0BAKA,oCACA,uCACA,MACA,WAAc,wCACd,8BACA,OACA,SACA,gBACA,YAAc,+BACd,kCAGA,gCAEkB,UAClB,WAAe,QACP,QACR,UACA,WAGA,CACA,kBACA,sCAEA,YACA,eACA,4BACA,qCACA,SACA,QAGA,MAFA,QAKA,KACK,+BAEL,eAEA,iBACA,wDACA,OACA,UACA,kBACA,YACA,kBACA,kBAEA,KAC6B,eAG7B,0BACA,WAEA,yCAEA,IACK,KACL,6CACK,0BAIL,iBAFK,qCAGL,kBACA,OACA,QACA,YACA,eACA,iBAEwB,gBACC,+DACzB,OACA,6BACA,KAEA,sBACY,QACZ,cAA0B,IAC1B,sBAAoE,IACpE,CAAgC,yBAChC,qBAAmB,mBACnB,UAEA,CAEA,oBACA,KACA,OACG,YACH,SACA,YAEA,EAQA,CACA,oBACA,WAAiB,MAAkB,WACnC,YACA,iBACA,GAAwB,kBAAiC,aACzD,qBAAqB,aAAuB,OAC5C,mBACA,6BAEA,YACA,QACA,WAAqB,gBAA0B,OAC/C,WACA,oBACA,mCACA,4BACO,yBACP,CACA,KACA,KAGA,kBACA,KAEA,EACA,EAEA,gBACA,qDACA,OACA,iBACA,aAIA,CACA,oBACA,SACA,WAAkC,yBAC1B,UACR,KAAmB,SACnB,gBAA+B,SAE/B,UAaA,CAEA,cACA,OAEA,UACA,oBACA,eACA,IAAiB,MAAkB,OACnC,SACA,iBAEA,YACA,SA0CA,cACA,OAEA,UACA,yBACA,IAAiB,QAAqB,OACtC,MACA,UAA2B,iBAC3B,SAEA,cACA,YACA,qBACA,KAsJA,kBACA,0CACK,YACL,QAEA,oBACA,OACA,kBACA,GAgBA,YAhB+B,sBAC/B,4CACA,6BACA,OAAkC,mBACxB,+CACV,OACA,mBACA,eACA,uBACyB,iBACzB,gBACA,cACA,CACA,QACA,mDACA,OAkBA,CA2HA,sBAIA,SAAkC,aAElC,8BAAgC,kBAEhC,sCACgB,aAEhB,4BACK,eACL,cAEA,iBACA,oDACA,wBAAqC,gEACrC,UAA6B,0BAE7B,4BACA,WACA,oCACO,4BACP,oEACA,IAEA,GACK,oBAA0B,mBAAuC,kBAEtE,yBACA,kCACA,2DACO,UACP,wBAAmD,UACnD,QACA,wBACA,oBACA,OACA,GAEA,KAAyB,6CACzB,CAAkC,aAClC,EAEA,KAA4B,iDAA8C,UAAuB,OAEjG,KACA,WACA,6CACO,WAEP,kBACA,iBACA,OAEA,aAEwB,gBACxB,oBACO,6BACP,6DACO,gBAAwB,UAAc,KAAO,WACpD,UAAwB,aACxB,UACA,kBACA,CACA,QAMA,CAyBA,sBACA,GACA,OACA,oCACA,OACA,kCACiB,oBACjB,kCACA,uBAAmB,aAAuB,OACnC,mBAA8B,SACrC,SACA,IACA,GACA,YAEA,cACA,uEAA0F,UAAiB,MAC3G,GAEA,gBACA,WAAiB,MAAoB,WACrC,gBACA,yCACA,cACA,oCACA,gBACA,UACA,QACA,CACA,EAEA,cACA,sBACA,yBACA,iCAAiD,UAAuB,OACxE,aAAmB,gBAA2B,OAC9C,QACA,YACA,yBACA,0BAGA,GAEA,IAAiB,MAAoB,WACrC,IAEA,CA0aA,cACA,OACA,QACA,sBAEA,aACW,kBACX,yCACA,eAGA,uDACA,qCACA,iBACA,gBACA,qBAGA,qDACA,oCACA,SACA,UAAoC,0BAAkB,YACtD,IACA,cACA,OACA,cAAwB,OACxB,wCACA,yBACA,cACA,qBACA,OACA,CACA,KACA,cACA,IAAmB,EAAO,IAAO,MAC9B,YAEH,2BACA,wBAKA,eAHA,0CAA8B,wBAAiC,OAAE,EACjE,OAGA,8BACA,aACA,IACA,GAGuB,+CAFZ,WACX,2BACA,qBAAyC,MAAuB,OACrD,sCACX,sCACA,yBACA,OACA,CACA,UACA,CACA,GAEA,gBACA,gCAAqE,kBACrE,WADgF,0BAGhF,8CACA,6CAIA,6CACA,yBACA,2CAEA,mGACA,oBAEA,wBAEA,2CACiB,oBACjB,cACA,EAEA,gBACA,OACA,QACA,qBACA,yBACA,oBACA,+CACA,6GAEA,wBACA,eAEA,cACA,WACA,uDACA,iCAEA,KAIA,CAEA,cACA,aACA,iEACA,gBAAiB,QAAoB,OACrC,WACa,cAEb,IAEA,CACA,aAEA,MACA,KACA,OACA,aAEA,IACA,gCACA,CAA8B,iCAC9B,GACA,KACA,MAAK,EACL,KAEA,8BAAkC,OAAkC,OACpE,EACA,CACA,cACA,SACA,6EAGA,oEACA,OACA,uBACA,UAEA,CA+DA,cACA,eACA,uBACA,aACiB,QAAjB,eAAuC,EACvC,SACA,uBAAsC,QACtC,yBAAqC,QACrC,mCAA+C,QAC/C,2BAAuC,QAC7B,0BAEE,kCAKZ,aAJa,gBACD,iBACE,gBACd,aAOA,CACA,cACA,OACA,UAA+B,+BAC/B,OACA,2CAA2D,QAC3D,qBAAyB,OAAwB,cAEjD,qBACA,WAAmB,MAAiB,WACpC,oBACA,eACA,YACA,KAEA,4BACA,OAEA,aACA,QAAkB,GAClB,eAA6B,qBAC7B,+BACA,OACA,KACA,QAA0B,aAC1B,KACA,SAEA,oBACA,GACA,+BACA,QAAwB,aACxB,aAAwB,gBACxB,oBAAuC,WAEvC,2BACA,IACO,8EACP,2BAAmB,oBAA+B,OAClD,IACmB,YAAnB,sBAEA,QACA,CAGA,CACA,cACA,iCACA,gDACA,SAEA,kBACA,IACA,KAKA,iBALsC,aACtC,oCAAwE,cACxE,qCAAuE,aACvE,0BAAsD,eACtD,aAGA,CACA,gBACA,uBAAuD,OACvD,oBACA,4BACA,cACA,UAEA,cACA,0BACA,OAGA,CACA,gBACA,8BAGA,KAAiB,QAAmB,WACpC,SACA,sCACA,SACA,4BACA,UACA,KACA,KACA,CACA,GACA,OAEA,gBACA,oBAAiC,EAAQ,KAClC,kCACP,WACA,KACA,GAEA,kBACA,gBACA,mCACA,OAEA,kBACA,cACA,qDACA,UAEA,sBACA,MACA,kBACA,gBACA,kBACA,WACA,wBACA,SAOA,uCACA,OACA,8BACA,kBACA,mBAAsC,kBAA2D,MAAE,gCACnG,KAAiC,uBACjC,GAAc,mBACd,WACA,aACA,CACA,iDACA,SAEA,oBACA,kBACA,cAAc,SACd,wBACA,oBACA,gBACG,UACH,eACA,WAEA,qCACA,sEAGA,UAGA,8BAAgC,8BAAwE,OACxG,eAEA,kBAAmC,mBAEnC,QACA,cAH4C,mBAC5C,OAGA,mCAEA,IAPA,wCAQA,mBACA,eACA,2DAEA,kBACA,uBACA,SACA,CAKA,sBACA,CAIU,uBAJ0C,OACpD,uBACA,yBAAyC,QAEzC,YAAiD,YACjD,OACA,aACA,iCACA,qBAA4C,SAC5C,8BACA,mBAAwE,UACxE,OACA,CAGA,MACA,SAAY,KAGZ,oCACA,oCACA,iCAKA,WACA,IAIA,CA6IA,gBACA,WACA,SACA,YAAuB,UACvB,kBACA,GACA,gBACA,WACA,SACA,YAAuB,UACvB,mBACA,GACA,gBACA,cACA,kBACA,mBACA,gCACA,yBACA,oCACA,2BACA,OACA,CACA,QAEA,CACA,kBACA,IACA,uBACA,MAAiB,IAIjB,yBACA,qCACA,QACA,GAA0B,uBACN,gCACpB,YACA,QAAG,QACH,WACA,gBACA,gBACA,CACA,SAEA,kBACA,WAAiB,sBAA6B,OAC9C,IACiB,kBAAjB,kBAEA,oDACA,+BACA,WAKA,CAEA,oBACA,eACA,YACA,IAA8B,YAC9B,mBACO,uBAEA,yBACP,SACA,2BACA,qBAEA,QACA,UAA4D,WAC5D,QACA,OACA,aAEA,oBACA,OAEA,gBACK,qBACL,UACK,mBAEL,mCACA,cACA,MAGA,QACA,EAEA,CACA,gBACA,OAGA,0CAIA,oCAA6D,OAAqC,WAClG,wBACA,4CACgB,aAChB,QAEA,uBAAkD,OAA+B,QAEjF,GAEA,CACA,kBACA,sCAA0D,OAAqC,WAC/F,EAEA,CACA,cACA,OACA,sBACA,KAEA,oBAAiD,kBACjD,wBACA,iCACA,eAEA,oBAEA,qCACO,qCAIP,iEACK,YACL,OAEA,cACA,cAIA,kBACA,cACA,oCACA,uBAEA,eACA,iBATA,YAEA,oCAQA,uBACA,eAEA,cACA,CAAwB,6BACxB,aACA,QAEA,cACA,OACA,gEACA,8BACA,sBACA,MAD4C,IAAsB,SAAqB,wCAEvF,kBAEA,aACA,SACA,2BACA,eAEA,CAeA,gBACA,WACA,oBACA,sBACA,KACG,iBACH,mBACA,iBACA,KAEA,cACA,iBACA,KAEA,SAMA,CACA,cACA,gBACA,6CACA,6BACA,yBAEA,SAIA,QAKA,4BAJA,kCAA8B,mBAA0C,YAAE,EAE1E,WAGA,2CACA,gBAGA,sBACK,uBAEL,oBAEA,gBACc,OACd,qBAA+C,UAC5C,MACW,cACd,4BAA4B,gBAA8B,OAAE,EACzD,KACyB,UAClB,QAEV,UAEA,sBACA,OACA,cAA2B,cAC3B,WAAgC,gBAChC,yCAEA,qCACA,IAAmC,uBACnC,OAAiB,GACjB,YACA,SACA,GAA4B,uBAC5B,oBACA,UAAK,QACL,SACA,gBACA,CACA,QACA,GAEA,kBACA,mBACA,+BACA,mBACA,kCACA,kEACA,MACA,CAIA,6BAJ8C,mCAC9C,UAA6B,yCAC7B,SAAiC,kDACjC,WAGA,oBACW,uBACH,iBAER,UAEA,sBACA,6BACA,4BACA,qDACA,2BACK,UAEA,YACL,WAGA,CACA,oBACA,iBACA,uBACiB,iBACjB,sBACA,4BACA,yBACA,6BACA,6BAEA,cACA,SACS,+BAET,gBACS,4BAAyB,cAAsB,uBAAwB,EAEvE,YAET,QACA,gBACA,MACA,iDACA,cAA+B,OAAqB,KAErC,kBACf,sBACA,yBAEA,sBAAkC,qBAClC,uBACA,yBACA,6BACA,6BAEA,UACA,2BAA0B,gBAA8B,OAAE,EAC1D,IAEA,kBACA,IAAuB,gBACvB,gBAAuB,mBACvB,iBAAuB,uDACvB,WACA,8BACA,GAEA,CACA,oBACA,cA6CA,IACA,aAEA,wBACA,0BACA,+BACA,6BACA,iBACA,sDACA,OAAuB,SACvB,qBACA,SACW,0BACX,WACW,mCACX,WACA,GAA2B,eAC3B,yCACA,cAAoB,gBACpB,cACA,iBAAK,KACL,IACA,gBACA,iBACA,EACA,qBACA,oBAEA,cACA,oBAEA,4BACA,oBACA,gBACA,WACA,CAEA,cAQA,OACA,gBACA,qBACA,kBACA,eACA,IACA,WACA,gCACS,iCAAuC,CAA0B,MAAW,IAAG,GACxF,IAAK,KACL,iDACoB,+BACpB,CACA,kBACA,aACA,KAAO,GACP,GACA,CAEA,cACA,SACA,mBACA,SACA,cACA,oBACA,2BACA,qCACA,IAEA,qBAtHA,IAEA,sBACA,2BACA,gBACA,eACO,IAEA,KAEP,sBACA,kBAGA,WACA,sBAA2B,WAC3B,eACA,iBACG,MACH,gBACA,UACO,8BAGP,SAEA,GACA,QAIA,UACA,wBACA,SAAkB,iBACf,yDACH,kDACA,IAAkB,iBAClB,eAEA,KAGA,gBAdA,kBACA,WACG,QAaH,iBA2CA,0BAEA,oBA+BA,CAAuB,MAEvB,KADU,IAEV,KACA,gBACA,4BACA,2BACA,YAGA,CACA,gBACA,SACA,WACA,iBACA,gCAA+D,OAC/D,eACA,SAAe,GACf,qCACA,8BAAuD,GACvD,+CACA,iBAAkD,OAIlD,YACA,gBACA,OACG,oDACH,mBACA,0CACA,aACO,KAEA,IACP,GAEA,iBACA,UACA,wCACA,sDACA,YAIA,CACA,oBACA,OACA,OACA,uBACA,uBAEA,gBAAS,KAAgB,YAAgB,OACzC,SAAc,SAEd,mDAA2E,OAC3D,YAEhB,cACA,oBAEA,wCAAqD,cACrD,kBAEA,qBAAiB,wBAA+B,OAChD,mBACA,oDACA,WACA,mBACA,iBACA,iBACA,KAEA,EAEA,gBACA,eACA,iBAMA,CACA,gBACA,kBACA,gBACA,gCACA,iBAEA,gBACA,cACA,6BACA,wBAEA,cACA,gFACA,yCACA,UACA,KAEA,CA2IA,cACA,CACA,MACA,MACA,MAEA,kBACA,aACA,OACA,iBACA,gBACA,2CACA,0CACA,yCACA,yCACA,qCACA,KACA,EAEA,cACA,WACA,kCACA,kDACA,wBAEA,4BACA,mBAEA,OACA,MACA,MACA,2BAA0B,OAA6B,MAAE,EACzD,IAGA,CAEA,gBACA,OAEA,UAAwC,0BAExC,mCAEA,GACA,WAEA,cACA,MAA+B,8DAC/B,iBAEA,6CACA,qBACA,oBAyCmC,2BAxCnC,QACA,SACA,QACK,+CACL,uBAEA,iBACA,SACA,YACA,WACA,EACA,aACA,qBACA,WACA,kCACA,eACA,iBACA,0BACA,cACA,kBAGA,mBAAqC,aAIrC,YAA8B,4BAAyB,wBAAyC,SAAE,EAElG,OACA,MAEA,QACA,iBACA,kBAEA,+BACK,iCAEA,OAEL,YACK,2BACL,YACA,QAA2B,yBAC3B,gBAAiB,OAAsB,OAAO,IAC9C,YAGA,YACA,cACK,gGACL,OAEA,CAMA,cACA,aAsBA,GACA,qCAA8C,sBAA6B,IAAE,EAC7E,SACA,sBAEA,MACA,cACA,IAAgC,oBAChC,yBACA,wBACA,YACA,gBACA,IAA6B,aAC7B,uCACA,mBACA,GACA,SArCA,kCAEA,cACK,+CACL,KACA,eACA,+BACA,aACA,cACA,kCACA,OAEK,wCAA0C,iBAAqD,KAIzE,8CAA6C,OAA6B,QAGrG,UAAkC,IAClC,2CAkBA,8BACA,SACA,eACA,0BACA,qBAAuB,QACvB,6BACA,MACA,sDACA,qCAEA,MACA,CACA,uCACA,GAAwB,4BACxB,SACA,uCACA,SACA,4BACA,6CACA,0CACA,mBACS,MACT,qCACS,QAEA,oDACT,+BACA,QACA,QACA,KACA,CACA,GACA,iBAIA,kDACA,YACA,+BACA,2BACA,oBAEA,YAGA,yCAA6C,OAA6B,QAC1E,6CAAiD,OAA6B,QAG9E,mCAAuC,iDAAuD,CAE9F,mBACA,kBAAyB,CAA6B,SAAW,KACjE,kBAAwB,CAA6B,UAAmB,QAAW,MACnF,mBAAyB,OAA2B,QACpD,OACA,0BAAyB,CAA6B,SAAqB,KAG3E,iBACA,mCAAiC,WAA4B,SAC7D,kBACA,0BACA,kCAAiC,OAAuB,QACxD,0BAAgC,OAAsB,QACtD,GAUA,oBACA,aACA,EAAoB,YACpB,OAGA,oBAA2B,iBAI3B,QAHU,wBAIV,4BACA,UAAwB,0BACxB,oCACA,sBACA,QACA,IACG,cACH,wDACA,oBACA,IAAwB,GACxB,SACA,MAEA,CACA,cAAwB,wBACd,UACP,EACH,uBACG,WACH,4BACG,WACH,uBAEA,SAEA,gBACA,eACK,2BAAmD,WAAsB,QAC9E,QAA0B,WAE1B,MACA,KAMA,mCALA,uBACA,kBAIqB,mBAA6B,OAClD,eACA,6CACA,aACA,eACA,aACA,KAGA,CAKA,CAEA,cACA,CACA,KAEA,sBACA,SACA,cACa,iBAEb,kCACA,qBAEA,WACA,wCACA,+CAMA,0CAAgD,OAAY,GAI5D,8CATA,GACA,aAAuB,YAA4B,OACxC,2BACX,SACK,2BAOkC,EAAvC,EAAiD,SACjD,SACA,yBACA,OACA,aACS,iBACT,yBACS,kDACT,uCACS,wBAET,eACA,mBAAuB,yBACvB,yDACA,gBACA,YACA,gBACA,IACK,IAEL,QACA,cACA,sBACA,wCACA,eAEA,gBACA,gDACA,QACA,KAKA,SAJA,2CACO,6BAA0B,sBAAqD,QACtF,MAIA,gBAEA,uCACA,4BAEA,sBAAqC,IAAQ,KAC7C,WACA,8DACA,2BACA,MACA,UACA,yBAAqB,oBAA+B,OAC3C,+CACT,oBACA,SACA,KACK,SACL,6EACS,0BAEU,2CAEnB,OAEA,cACA,gBACA,KAAiB,qBAA8B,WAC/C,gCACA,QAAqB,yBACrB,MACA,qCACA,MACA,QAAU,OACV,UAEA,gBACA,8BACA,uCACA,oCACA,IAEA,aACA,8BACA,2GAKe,kEAMf,wBALQ,+BAEI,2BACZ,mBACA,OAWA,CA2bA,sBACA,aAIA,SACA,uCACA,yBACA,UACA,OACA,cACA,IAEA,eAEA,UAEA,UACA,QAOA,gBANS,oBAEA,YAET,UAGA,QAEA,IA1BA,KACA,YACA,SAyBA,UACG,YACH,YACG,yBACH,4BACA,oCACA,aAA2B,WAC3B,YAAyC,IACzC,iCACA,cACA,eACA,qBACA,KACA,OAAqC,aACrC,aACA,OAAsB,EAAQ,EAAY,aAC1C,SACA,KAEiB,QACjB,aAAyC,IACzC,KAEA,OACA,eAEA,MAFuC,YACvC,aAKA,CACA,oBACA,sBACA,eACA,qFACA,qCACA,0BAEA,GAAG,KACH,mCAEA,GACS,OAAT,KACA,MACA,aAA0B,QAC1B,8BAA6C,GAAuB,gBACpE,IACA,GACA,CACA,QAIA,CAyWA,gBACA,cACA,eAA6B,aAC7B,sBACA,iBAEA,gCACA,YACA,cACA,kBACA,MACA,kBACA,MAEA,4CADA,QAGA,cACA,QAA6B,WACxB,iDAAwD,WAC7D,SACA,SAEA,gBAAsC,cAAkB,UAExD,sBACA,cACgC,mBAA2B,UAAwB,KAAE,CACrF,aAEA,KACA,KAEA,KACA,cAEA,KACA,IAEA,KACA,cACA,kBACA,sBACA,cACA,QAGA,iDAFA,uCAGA,OACA,qCACA,KAGA,mCAFW,4BACX,SAEA,IAA4D,2CAC5D,qCACoB,aACpB,cAAqB,iBAA4B,OACxC,QACW,mBACpB,KAAK,KACL,oBAEA,UACA,CAAS,0BArCT,kBAsCA,IACA,KAAqB,KACrB,UACA,WACA,CACA,SAEA,kBACA,IACA,2BACA,wBACA,cAAoB,0CACpB,UAAgB,OAChB,CACA,UAA0B,oBAC1B,qBAAwD,cACxD,+CAA6E,QAC7E,KAEA,WAAiB,qBAA4B,OAC7C,mBACA,UACO,cAEP,WAEA,kBACA,kBAqBA,YAAoB,kBAA8B,OAClD,aACA,eAAqB,QAAmB,UACxC,WACA,cACA,sBACA,WACA,mBAAkD,mBAClD,KACA,MAEA,CACA,CACA,yBAjCA,aAA0C,6BAC1C,UACA,OACA,SACA,gBACA,MACA,0BACA,6BACA,UAGA,4BACA,mCACA,+BACiB,6BAEjB,WAAyC,mBACzC,+BAEA,OAeA,SAAc,WAGd,0DAAwG,oBACxG,CAEO,sBADP,0BAGO,0BACP,MACA,6BAAqE,0BACrE,CAEO,uBADP,0BAGO,0BACP,MACA,CAEA,kBAn8RA,uBAEA,yBACA,sBACA,YAAuC,wCACvC,0BACA,YACA,yDACA,uBACA,+BACA,4BACA,sBACA,4CACA,0CACA,wBAEA,uDACA,sBAEA,uEACA,sBACA,uBACA,mBAEA,yBACqB,mCACrB,QAA6C,SAAgB,MAE7D,sCACA,4CAKA,SACA,iBACA,aACA,4BACA,iDACA,GACA,GA4BA,eAA2B,6BAC3B,gBACA,cAGA,gBAFA,UACA,eAEM,iBACN,qBACA,qBAAO,uBAAsC,WAC7C,SAAY,SACZ,CAIA,SAHA,uBACA,2BACA,gBACE,EAuCF,kBAAkC,GAAe,QAE9C,mBAA+B,kBAAyB,yBAAuC,MAE/F,qBAA+B,IAAM,GAAe,QAAE,UAAa,CAAG,GAgCzE,kBAA0B,cAC1B,8BACA,mBACA,YACA,wBAaA,OAAY,oBAAqB,uBAGjC,OACA,eAAiB,OACjB,cAAgB,OAGhB,ghEAsUA,iCAkbA,cAIA,OAAuB,UACvB,mBAA8C,QAC9C,aAA8C,mBAC9C,eAA8C,QAC9C,aAAgD,QAChD,IAA8B,QACpB,IACV,GAEA,kBAIA,MACA,aAAqB,YACrB,IAEA,OAnBA,6PACA,+PAWA,8EAEA,2BAMA,oBAEA,iCAAqE,QACrE,8BACA,KAAmB,EAAS,IACrB,eAMP,4BAAuC,MAAW,IAClD,MACA,KAAwB,OACZ,OAQZ,gBAAsC,MAAW,IACjD,MACA,aAAwC,YACxC,MAAuC,UAAc,IAAqB,cAM1E,sBAAwC,SAAe,EACvD,MACA,qBAAkE,iBAClE,mBACA,aAAkD,UAClD,QAOA,cAAqB,IAAW,IAChC,SACA,KAA0B,YAC1B,mBACA,WACA,WAA2B,OAAgC,UAC3D,kDACA,IAAyB,IAAS,IAAO,IACzC,WACA,CAMA,aAAwC,MAAW,IACnD,MACA,aAA0C,YAC1C,MAAuC,UASvC,eAAqB,EAAW,IAChC,oBACA,WACA,WAA6B,cAA6C,MAC1E,eACA,oBACA,+BACA,MAA2B,IAAa,IAAS,IACjD,WACA,CAQA,gBACqB,EAArB,EACA,qBACA,IACA,SAAmB,gBAA4C,MAC/D,kBACA,OAAO,KACP,aACA,WAAmB,SAAgC,UACnD,YAA2B,KAC3B,qBACA,CAA4B,wBAC5B,WACA,SAAuB,gBAA2C,MAClE,wBACA,QACA,GAAkB,KAElB,IAAwB,wBACxB,OAEA,OACA,qCACA,0BACA,gCAEA,oCACA,yBACA,6BAIA,wBACA,WACA,CAIA,OAcA,qBACA,MACA,mBACG,mCACH,0BACG,cACH,iCACA,oBACA,SACA,gBAyFA,QAA6B,KAC7B,iBACA,8BACA,cAEA,gDA4CuB,gBAAiC,WAExD,aAjBA,sBACA,eACA,aACA,SAAmB,WACnB,8CACA,iBACA,OACA,QAIA,YAEA,mBALA,WAEA,EAIA,CACA,QAAC,oCAGD,IAAO,wCACP,SAAY,SACZ,CAAC,aACD,IACA,OAAO,yCACP,UACA,eACA,qBACA,qCAEA,eACA,SACA,gBACA,wCACA,WACA,4BAEA,eAWA,MAIA,2BAgGA,qBACA,OACA,yBACA,0CACA,iBACA,OACA,oBAEA,4BAA0C,qCAC1C,4BAA0C,iCAC1C,6BAA2C,6CAC3C,4BACA,yBACK,sCACL,QACA,4BACA,+BACA,KACA,OAAiC,mBACzB,0BACR,QACA,MADW,OAAW,OAEtB,iCACA,gBACA,SACA,qBACA,OACA,gCACA,WAEA,YACA,8CAA2D,WAC3D,gBACA,OACA,kCAAgD,6BAChD,+BACA,kCACA,aACA,MADmB,MAAiB,UAEpC,gCAA8C,aAC9C,8BACA,gCACA,2FACA,yCAEA,uFACA,IACA,mCACA,gCACA,oEACA,IACA,kCACA,uBACA,kBAAgC,YAAkD,eAClF,kCACA,iBACA,KAGA,MAH8B,qBAC9B,UAEG,KACH,mCACA,mBAAmC,UACnC,SAAqC,wBAErC,UACA,GACA,gCAA6C,+CAC7C,yCACA,MACA,gBAAO,WACP,QAAW,MAAqB,YAChC,GACA,kCACA,YACA,uBACA,cACA,iCACA,YACA,sCACA,IAEA,sBACA,MACA,aACA,WAEA,sBACA,MACA,aACA,WACA,4BACA,kBACA,uBACA,GAEA,kCACA,6BACA,QAEA,uBAF8C,oBAC9C,mBAGA,kCACA,OAEA,cAAyB,iBACzB,gCACK,kCACL,0CACA,UAAU,oCACV,8BACA,kBAEA,gCACA,MACA,OAA8B,0BAC9B,gBAEA,4BACA,OACK,iDAEA,yBACL,YAEA,6BACA,mBACA,4EACA,eAMA,wBA8GA,cAA4B,iBAC5B,kBACA,uBACA,UACA,OAEA,oBAiHA,MACA,UACA,8BACA,GAEA,8BAAqC,iBAKrC,cAsBA,oBAiVA,SA8WgB,iDAwhChB,MACA,mEACA,iEAA4E,kCAC5E,yBAAc,KAEd,6BACA,GAA4B,4BAC5B,WACA,2BACA,GAA4B,4BAC5B,aAEA,QAEA,wBAA6B,2DAC7B,SA/mBA,GAinBA,+BACA,mCACA,kCACA,MAEA,oBACA,yBACA,wCACA,4BAEA,8BACA,4CACA,IACA,8BACA,qCAGA,SACA,0BACA,wCACA,oCACA,sCACA,+BACA,yCACA,IACA,+BACA,qCAGA,kCACA,mBAAsB,WACtB,qBAGA,sBAAU,uBACV,IAEA,sCACA,YAAqC,2BACrC,mBAA0B,mEAC1B,UAEA,qCACA,WAAmC,yBACnC,kBAAyB,gEACzB,SAEA,qCACA,sBACA,+CACA,qEACA,yBACA,wBACA,QAEA,+CACA,aAQA,SACA,yFACA,yDACA,GAAwB,WAExB,6BADU,MAEV,uBAbA,aAcA,QAEA,6BACA,kBACA,8BACA,0BACA,OAEA,oBAEA,8BAA+C,QAAS,eAAoB,IAC5E,wCACA,uCACA,wCAoCsB,sBA+BtB,oBAiYA,SAEA,aAEA,+BACA,sCACA,yCACA,yCACA,iCACA,WACA,kBACA,kBACA,IAEA,iCACA,CACK,0BACL,YACA,8BACA,WAEA,OAAiB,gBAAwB,OACpC,oBACL,mBAoQA,KAKS,YACQ,UACC,UACA,cAA2B,GAgG7C,oBACA,MACA,cACA,aAEA,+BAA2C,qCAE3C,+BACA,OAEA,WAAsB,KACtB,sEAAuF,OACvF,mBAAiB,gBAAwB,WACzC,uBACA,gDAA+F,MAC/F,QACA,CACA,UAEA,gCACA,WAEA,OACA,KAAiB,gBAAwB,OACpC,oDACL,4BACA,YAEA,yCACA,WAEA,OAAiB,gBAAwB,OACpC,oBAAiC,QACtC,SACA,UAEA,mCACA,OAEa,SACb,eAAiB,kBAAwB,OACzC,WACA,4BACO,eAEP,gBACA,GAEA,oBACA,MAAuB,cACvB,QAEA,4BAAoC,kCACpC,0BAAkC,kCAClC,6BAAqC,sEAIrC,EAk8BA,aACA,qBAAmC,yBAGnC,2BACA,WAEA,WAAuC,EAAP,IAChC,QACA,qBACA,OACA,WAEA,qBACA,WAGA,sBACA,qBACA,MAIA,6BACA,OAEA,UACA,uEACA,oBAAmB,MAAkB,OAAO,SAC5C,QAGA,uBACA,WAEA,OAAwB,IAAQ,IACzB,WAA4B,UACnC,QACA,GAiBA,aACA,qBAAmC,iBAEnC,2BACA,OAEA,UACA,kBAAmB,kBAA0B,WAC7C,yBACA,mBACA,oBACA,YACA,+BACA,OAAuB,6BAAgC,YACvD,MAA6B,UAC7B,QACA,CAAc,KACd,KAGA,IACA,2EACA,OACA,QACA,2BACA,mCACA,IACA,CAEA,sBACA,WAEA,OAAmB,kBAA0B,OAAO,kBACpD,WAEA,6BACA,OAEA,kBACA,YACA,oBAAmB,kBAA0B,WAC7C,yBACA,oBACA,MACA,8CAGA,6BACA,GAAmC,gBACnC,oCACA,iBACA,6BACA,OAEA,+BACA,OACA,YACA,CACA,KACA,CACA,IACA,CAGA,uBACA,MACA,iCACA,OACA,6CACA,KACA,uBACA,gBACA,YACA,oBACA,MACA,GAAM,KACN,WACA,iBACA,wBACA,yCACA,IACA,YACA,MAAK,OACL,+BACA,aAEA,uBACA,WAEA,OAAmB,kBAA0B,WAC7C,yBACA,mBACA,WACA,UAAwC,aACxC,YAA+B,UAC/B,QACA,CAAc,KACd,KACA,CAGA,GAEA,sBACA,OAEA,KAAgB,YAA2B,UACtC,yBACL,WACA,WACA,QAEA,6BACA,OAEA,qDACA,QACA,sBAAiB,MAAe,OAAO,IAAuB,sBAC9D,KAAmB,mBACnB,eACA,gBAEA,8BACA,QACA,WACA,SACA,8BAEA,WAEA,+BACA,OAEA,wCACA,iBACA,cAEA,kBAEA,4BACA,SACA,eACA,uCACA,KAEA,KACA,cA6CA,kBACA,YACA,QACA,YACA,cACA,IAEA,EACA,6BACA,OAEA,cACA,6CACe,YACf,uBACA,YACgB,mCAChB,GACA,kBACA,OAAiB,eAAuB,WACxC,SACA,gBACA,qBAAkC,oBAElC,YAA4B,eAC5B,MAA8B,iBAE9B,0BACA,gDACO,oBACP,SACA,kCAAyD,uBAAkB,eAAyB,WACpG,wBACA,kBACA,0BACA,oBACA,0BAEA,kBAEA,kBAA4C,oBAC5C,qBACA,OACA,2CACA,oBACa,oBAEF,gCACI,aACf,WAAoB,oBACpB,QAMA,EACA,+BACA,OAEA,cAAgD,0BAChD,aACiB,IAAjB,eAAwC,WACxC,SACA,gBACA,kBACA,8BACA,OAAuB,MAEvB,YACA,4BACA,IAAsB,MAEtB,QACA,YAAkB,OAClB,KAGA,EACA,+BACA,OAEA,0CACA,GACA,qBACA,oBACA,QAEA,eACA,uCAEA,wBACA,8CACA,SACA,gBACA,WAES,iBACT,SACA,MACA,oBACA,IAEA,mCACA,oCACA,mBACA,6BACO,4FACP,KACA,YACA,SAEA,mCACA,sCACA,mCACA,yBAA+B,uDAC/B,KACA,GAGA,OA2EA,oBACA,OAEA,UACA,eACA,oBAAiB,MAAoB,OAChC,SACL,UAEA,6BACA,OAEA,cACA,wBACA,+BAAiB,iBAAyB,OACrC,iBACL,gBACA,WAEA,+BACA,qBACA,WACA,cAkDA,wBACA,MAA+B,0BAC/B,mBAA0B,YAE1B,mCACA,eACA,uCACA,OACA,iCACA,yBACA,8BACA,YACA,0BACA,cACA,UACA,kBACA,wCACA,WAEA,UAAgC,4BAChC,wBAAmB,YACnB,iBACA,WAEA,4BACA,CAKA,mCACa,2BACH,6CACV,OAGA,sBACA,WACA,IAAmB,MAAkB,OAAO,YAC5C,+BACA,UACA,sBAA2B,yBAAsC,QAKjE,sBACA,yCACA,YACA,wBACA,gBACA,yBACA,8CACA,WAAsB,6BACtB,kDACA,kBAAkB,iBAClB,WACA,SACA,iCACA,KACA,cACA,aACA,aACA,0BACA,0BACA,eACA,wBACA,gBAEA,sBAA2B,WAAiC,iCAE5D,4BAAiC,KAAyB,wBAC1D,4BAAiC,WAEjC,sCACA,OAAkC,yBAClC,SACA,KAEA,uBAAyB,gBACzB,uBAAyB,iBACzB,sBAAwB,6BAExB,sBAA0B,gBAE1B,uBACA,0BACA,EAKA,kBAL2C,YAC3C,KAAiC,cACjC,0BAAkE,SACxD,OACV,QAEA,2BAA8B,uBAC9B,+BAAiC,mCAEjC,8BACA,gDACA,OACA,kCACA,0BACA,QACA,qCACA,wBACA,UACA,oCACA,WACA,UACA,sCACA,kBACA,oBACA,UACA,mCACA,OAEA,UACA,kBACA,KAAmB,MAAmB,OAC/B,yBACP,iBACA,OAA0B,kCAC1B,oBACA,WACA,kCACA,6BACA,kCACA,8BACA,KAEA,2BACA,WAEA,yBACmB,EAAnB,QAAsC,OACtC,2BACA,YAEA,kBACU,wBACV,gBACA,2BACA,WAEA,qBACA,SAAmB,QAAmB,OACtC,2BACA,MAA8B,uBAC9B,kBAEA,OACA,QACA,kCACA,WACA,KAAmB,oBAA4B,OACxC,IACP,qCACA,SACA,sCACA,WAEA,iBACA,MAAmB,eAAuB,OAC1C,QACA,gBAAoB,gDAEpB,oCACA,qBAAsC,EAAU,KACzC,SACU,WACjB,aAAuB,YACvB,GACA,sBAAgC,eAChC,sBAAgC,eAChC,+BAAyC,kBACzC,+BAAyC,kBAEzC,4BAA+B,aAC/B,0BAA4B,kBAE5B,wBACA,8BACA,IAAmB,WAAsB,OAAO,cAA4B,QAC5E,cAAqB,aAA0B,OAAS,gBAAgC,QACxF,WAAY,OACZ,OACA,0BAA4B,+CAE5B,sBACA,2BACA,oBACA,8BAEO,+EACP,mBACA,UACA,qBACA,0CACA,gBAEA,uBACA,QAAY,qBACZ,6BACA,QACA,wBACA,wCACA,yCACA,uCACA,QAEA,oCACA,sCACA,yCACA,IAGA,MAFA,YAAuC,uBACvC,QAEA,EAEA,6BACA,OAEA,0BACA,oBACA,4CACA,CAGA,0BAFA,SAA4C,iCAC5C,QAGA,EACA,EAEA,uBACA,IACA,yBACA,OAAgC,cAChC,SACA,QACA,QAAkB,SAClB,KACA,WACA,KAAsB,cAEtB,aAAY,4CACZ,kEACA,oBACA,QAEA,iCACA,0DACA,iBACA,4BACA,oCACA,gBAAwB,KACxB,yBAAiD,MACrC,eACZ,MACA,QACA,EACA,qCACA,0DACA,iBACA,4BACA,oCACA,cACA,QAAiB,GACjB,YAA6B,aAC7B,SACA,eACA,SAAqB,GACrB,4BACA,yEACA,IACA,CACA,QACA,EAEA,mCACA,WACA,WACA,+BAAsC,GAAgB,OAEtD,0BACA,iDACA,QACA,2BACA,QAAoB,oCACpB,0BACA,yCACA,8BACA,8BACA,sBACA,WACA,yBACA,KACA,kCACA,YAAgB,eAAgB,QAAkB,OAClD,MACA,8BACA,0BACS,+BAET,QACA,QACA,2BACA,KAA+B,YAC/B,qBACA,KAaA,4CAZA,SACA,YAAkB,eAAgB,QAAkB,OACpD,MACA,oCACA,uBACA,yCACA,YACW,mCAEX,QACA,GACA,IAEA,wBACA,OACA,GAMA,4BALA,SACA,YAAgB,eAAgB,MAAgB,OACvC,IAA2B,6BACpC,OACA,IAGA,0BACA,yCACA,qCACA,cACA,eAAqB,MACrB,aACA,KACA,IACA,UACA,OACA,0BACA,KACA,gBACA,yBAAoD,aACpD,8BACA,OAIA,8CAHA,WACA,QACA,IAGA,kBACA,gDACA,mDACA,WAQA,wBARmC,4BACnC,sBACA,MAEA,+CACA,4BAEA,gBAGA,uBACmB,OACnB,uCACA,qBAAsD,aACtD,oBAAgD,WAChD,yEACA,WAKA,SAL6B,4BACxB,SAAE,sCAA0C,mBACjD,wBAAoB,kCACpB,qBACA,QAEA,uBACA,OAEA,QAAwC,sBACxC,UAAsB,iBAAgB,kBAAwB,OAC9D,WACA,YACA,0BACA,KACA,gBACA,OAGA,iCACA,UACA,oBAAwC,iBAA8B,GACtE,uBACA,qCACA,yCACA,SACA,CACA,6BAA+B,UAE/B,qBAAuB,gBACvB,uBAAyB,cAEzB,wBACA,aAAuB,qBACvB,SACA,KACA,0BAA6B,0BAE7B,6BACA,CAAuB,aACvB,eACA,iBACA,iCAA+B,gBAA0B,IACzD,QAAkB,YAClB,IAGA,KACA,mCAIA,KA8JA,sBAXA,oEACA,gFACA,yEACA,wBAAsB,gCACtB,kDACA,qBAAmB,gEACnB,+EACA,wEAGA,aACe,EAAQ,MAAO,qBAC9B,UACA,UAAkB,GAAW,MAAS,eAEtC,WAAiB,EAAW,OAAS,6BAAyD,OAE9F,UAEA,SACA,0DACA,gFACA,+EACA,6CACA,6CACA,sBAIA,mBACA,aACA,2FACA,uFACA,wGACA,qGACA,6FACA,4CACA,6EACA,4BAEA,SACA,UACA,2EACA,wFACA,6FACA,oGACA,0BACA,YACA,cACA,sFACA,2GACA,2GACA,0GACA,2FACA,yGACA,+GACA,gCACA,WACA,kCAEA,iBAwOA,CACA,wCAAkC,yDAAsF,WACxH,sBAA2B,wBAC3B,cACA,iCACA,0CACS,YAAS,+BAET,KAAS,wBAClB,QACA,QAAc,mBAEd,KAAK,EACL,wBAA6B,wBAAkD,OAC/E,sBACA,8BACK,IAAI,EACT,yBAA8B,wBAAkD,OAChF,8BACK,OAAI,EACT,gCAAqC,wBACrC,sCACA,kBAAiC,OAAkB,OACnD,cAAY,YACZ,OAAK,EACL,iCAAsC,wBACtC,sCACA,kBAAkC,uCAAqD,OACvF,cAAY,cACZ,KAAK,EACL,kBAAuB,UAAkB,MACzC,kBAAuB,UAAkB,MACzC,2BAAgC,UAA2B,eAC3D,2BAAgC,UAA2B,eAC3D,wBAA6B,0CAAmD,GAChF,sBAA2B,8BAA+C,YAC1E,yBAA8B,wCAAgD,oBAAuC,KACrH,GAAK,oBACD,GACJ,8BAAmC,wCAAgD,eAAuC,KAC1H,GAAK,oBACD,GACJ,uBAA4B,wCAAgD,oBAAqC,KACjH,GAAK,qBACD,GACJ,yBAA8B,wCAC9B,wCACA,uBAA0B,uCAAqD,OAC/E,MAAe,KACf,wBAA6B,wCAC7B,wCACA,uBAA0B,OAAkB,OAC5C,MAAe,KACf,6BAAkC,wCAClC,wCACA,kBAA6B,OAAkB,OAC/C,4CAAqD,aAErD,OAAe,KACf,sBAA2B,mBAA6B,OACxD,wBAA6B,kBAA4B,OACzD,sBAA2B,mBAA6B,OACxD,wBAA6B,kBAA4B,OACzD,wBAA6B,mBAA6B,OAC1D,yBAA8B,kBAA4B,OAC1D,0BAA+B,mBAA+B,SAC9D,2BAAgC,kBAA8B,SAC9D,wBAA6B,mBAA6B,OAC1D,0BAA+B,kBAA6B,QAC5D,yBAA8B,mBAA8B,QAC5D,yBAA8B,kBAA4B,OAC1D,2BAAgC,qBAA+B,OAC/D,0BAA+B,oBAA8B,OAC7D,2BAAgC,qBAA+B,OAC/D,0BAA+B,oBAA8B,OAC7D,4BAAiC,qBAAgC,QACjE,2BAAgC,oBAA+B,QAC/D,wBAA6B,0BAAoC,QACjE,wBAA6B,0BAAkC,MAC/D,wBAA6B,0BAAuC,WACpE,uBAA4B,2BAAkC,KAC9D,2BACA,+CACA,UAAmB,MAAmB,WACtC,YACA,+BACA,iBACA,KACA,GACA,oBACA,wBACA,GAAiC,sCACvB,qBACV,YAQA,4BAAiC,uBACjC,gCACA,KAAmB,MAAmB,OACtC,YACA,2CACA,KACA,gBAAoC,6BACpC,IACA,2BACA,iDACA,sBACS,yCACT,yBAEA,wBACA,oCACA,kCACA,4BAEA,cAEA,QAEA,eACA,gBAAK,EACL,8BAAmC,uBACnC,aACA,4BAAiC,EAAQ,KAClC,+DACP,cACA,2BAAqB,MAAmB,OACjC,kCACP,SACA,KAAK,EACL,sBAA2B,gCAA2C,QACtE,6BAAkC,UAA6B,iBAC/D,uCAkLA,MACA,YACA,WACA,UAEA,oCACA,aACA,KARA,iCASA,MAEA,UA6XY,oBAAqB,uBAEjC,MACA,SA/XA,MAmnBA,GACA,YACA,GAEA,kBA4GA,UACA,6BAA4C,WAA0B,OAMtE,4BA6sBA,MACA,uFACA,kBACA,sBACA,UACA,mCACA,MAEA,6BACA,cAgCA,KACA,cACA,wBAAqB,mBACrB,kBAA4B,0CACvB,0BACL,gBAEA,aACA,UAAqB,mBACrB,OACA,qCACA,0BACA,iCACA,MAGA,sBACA,iBACA,+BAEA,iCACA,kCACA,WAGA,cAFA,gBAIA,gBACA,kEACA,iCACA,qBACA,cACA,2BACA,qBACA,iBACA,QAA4B,QAC5B,sBAAK,EACL,IACA,OApEA,gBACA,aACA,uBAEA,oCACA,UAEA,SAA2B,kCAAuC,UAA+B,eAAE,GACnG,GAEA,sCACA,cAAwB,YACxB,QACA,uCACA,GAA4B,yBAAqB,YACjD,SACA,oCACA,GACA,gCAA4C,QAC5C,8BAEA,QAEA,+BAAqC,UAAoC,qBAEzE,0BACA,GAA4B,aAC5B,iBAEA,QAwCA,eACA,UAEA,wCACA,eACA,OAEA,6BADA,WAGA,wCACA,yBACA,YAAgC,gBAChC,4BACA,4BAEA,4CACA,mDACA,yBAEA,yFACA,SAIA,cAHA,4CAIA,mCACA,iCACA,KACA,gBAGA,gCACA,mCACA,UAAO,gCACP,8BACA,cACA,qBACA,2CACA,OAAW,mDACX,GAEA,QACA,GAIA,cAHA,sDAIA,KAAO,iCAA6D,KACpE,UAEA,kBACA,6BACA,WACA,cACA,oBAGA,iBACA,oBAEA,gBAAwC,qBACnB,qBAErB,yBACA,sBAEA,wCACA,OAEA,uBACA,mDACA,GACA,iBACO,6CAAkC,mBAAgD,mBACzF,EAAG,EACH,KAEA,+CACA,+BACA,0CACA,YAEA,yCACA,cACA,qCAAuC,mCACvC,kCAAqC,iCACrC,aAEA,yCACA,cACA,qBAAwB,WACxB,+BACA,sCACA,QAEA,6BACA,CACA,6CACO,6CACP,gCAEA,UACA,4BAAmD,UAAiB,QACpE,gCAAuD,kBAEvD,qCAA4D,WAE5D,qCACA,aAOA,YACA,YACA,2CAEA,gBACA,OAXA,UACK,yBAEA,qCAA+B,mBAA+C,mBAEnF,oCAOA,iBAEA,wCACA,cACA,8EACA,uEACA,iBAEA,qCACA,uDACA,uDAOA,mDACA,YAKA,iCAL8B,yBAC9B,wBACA,iBACA,iBAGA,gBACA,8CACA,mCACA,aAAuB,qBACvB,UACA,sBAAiC,eACjC,oBACA,MAEA,mCACA,CACA,8CACA,oCAGA,4CACA,yBACA,0BACK,6CACL,qDACK,0BACL,uCAAqE,EAErE,iBACA,sBACA,mCACA,kBAEA,qBACA,yBAEA,0BACA,QACA,sBACA,cACA,cAEA,kCACA,qBAGA,iBAAkB,GAClB,oCACA,oDACA,qBACA,qBAAuC,OAAe,QAAe,MACrE,oBAAwC,KAAiB,UAAiB,QAChE,QAGV,qBACA,+BACA,gCACK,eACL,qBACA,iCACA,2BACA,IACA,yDACK,IAEL,sCACA,iBACA,wDACA,IACA,IAIA,2DACA,0CAEA,UACA,oCACA,wBACA,OAGA,sBAFA,cAIA,oCACA,MACA,uBACA,6BACA,MACA,uBACA,2CACA,MACA,8BACA,+BACA,UACA,yBACA,gBACA,UACA,uCACA,OAEA,KACA,qEACA,qBACA,OACA,yBAAkC,iBACtB,SAEZ,UACA,eAAG,EACH,MAEA,qCACA,OAEA,kCACK,qCAA+B,aAA6B,GACjE,IAEA,sCACA,mBACA,SAEA,mCACA,CACA,kBACA,0BACK,8EACL,KAEA,wCACA,2BACA,mBAEA,wCACA,wCAEA,sCAqJA,kBACA,MAEA,oBAKA,QAEA,4BAEA,YACA,+BACA,MAEA,6BACA,cA2BA,KACA,cACA,wBAAqB,mBAChB,qCACL,gBAEA,aACA,UAAqB,mBACrB,OACA,uCAEA,sBACA,uBACA,MAGA,OAA0B,wBAC1B,gBACA,OA3CA,mBAGA,kBAGA,uBACA,8CAGY,+BAEZ,8BACA,cAAuD,8BACvD,QACA,MAEA,2BACA,UAEA,kBACA,mBACA,WAEA,QAoBA,cAEA,2CACA,UACA,kBACA,mBACA,QAGA,2CACA,CAAqC,SACrC,KAEA,qCACA,mBACA,UAA0B,6BAC1B,oBACA,CACA,8CAAqD,UAErD,yBACA,mCACA,GACA,cACA,yBACA,oBAEA,KACA,IAEA,wCAEA,+BACA,MAGA,uCACA,iCACA,uDACA,6DACA,iBACA,2CACA,mBACA,MAEA,CACA,UAEA,sCACA,mBACA,wBACA,4BACA,WACA,+CACA,sCAEA,KAGA,EACA,8BACA,oCACA,uBACA,4BACA,gBACA,WACA,6BACA,gBAA2B,iBAC3B,cAAgC,aAChC,eACA,6CACA,OAAgC,0BAEhC,SAEA,gCAAgD,uBAEhD,qCAAqD,WAErD,6BACA,0DACA,aAAS,eAAuB,OAChC,UAEA,GAEA,4BAA4C,eAAsB,QAElE,qCACA,gDACA,GAEA,qCAAqD,MAAiB,UAGtE,EACA,gCACA,OAEA,UACA,qEACA,GACA,kBAAkC,WAClC,UACA,EAIA,EACA,gCACA,aAGA,SACA,aACU,EAA0B,iBACpC,aAF4C,mBAC5C,MAEA,YANA,OACA,6BAMA,KAOA,EACA,4BACA,OAEA,sCAKA,+CACA,0BACA,2DACK,OAEL,iBAEA,kBAAqD,oBAIrD,4BACA,wCACA,QAIA,uBAHA,qDAIA,oBACA,MAAwC,eACxC,UAA0B,oBAAc,4BACxC,OAEA,4BACA,gCAA2E,eAE3E,IAeA,sBAdA,mBACA,qCAGA,qBAAwD,sCAC9C,KAEV,cACA,8BACA,mEACA,OAA0C,UAE1C,yBACA,OAGA,oCACA,wBAAwC,cACxC,iBAEA,kCACA,KAA8B,0BAC9B,WACA,YAEA,sCACA,aA6BA,2BACA,SACA,0CACA,YACA,WACA,yBACA,0BAA4B,mBAG5B,iCACA,GACA,CACA,aACA,MACA,sCACA,kBACA,cAA+B,2CAG/B,oCACA,WAA0C,OAC1C,wBACA,iCACA,uCACA,sBACS,YACT,yCAEA,0BACA,aAEA,QACA,oCACA,IACA,CAEA,mCAhEA,gCACA,aAIA,wBACA,gCACK,yCAEL,kDACA,gCACA,qCACA,wCAAoE,kFAAwD,kCAAyE,uFACrM,uHACe,oBACf,iBACe,4BACf,gBAEA,UAAgC,0CAChC,OACA,gDACA,mBAKA,wBAqC8B,OAC9B,OACA,CACA,sBACA,WACA,0BACA,GACA,YACA,YACA,mBAEA,MAEA,wCACa,SACb,+BACA,eAEA,wCAEA,sCAh4DA,WACA,oBAGA,GACiB,kBACjB,sBAA2C,CAAkB,OAAsB,QACnF,IAEA,SANA,iBASA,iBAIA,kCAA0C,UAAyB,WACnE,iCACA,OACA,aACA,KAEA,qBACA,WACA,uBACA,2CACA,CACA,MACA,MACA,KAEA,0CACA,UACA,WACA,qBACA,4BACA,WAAwB,MACxB,aACA,cAA0B,KAC1B,YACA,cACA,OACA,CACA,GACA,sBAAsC,EAAQ,KACvC,0CACP,SACA,8GACA,kEACA,KAAsB,SACtB,SACA,4CAAiF,UAAqB,SACtG,QACA,6EACA,iBACA,0DACA,qCAAkD,0BAA4C,YAC9F,0BACA,OAEA,2DACA,CACA,MACA,KACA,0CACA,OACA,eACA,WAA8B,UAC9B,cAAsB,sBACtB,KACA,iBACA,yBAEA,QACA,mDACA,MACA,SACA,KACA,sCACA,mDACA,MACA,SACA,mDAA6D,OAA6B,MAC1F,6CACA,CACA,MACA,8CACA,oDACA,WACA,oCACA,MACA,SACA,KACA,0BACA,4CAAoD,CAAgB,QACpE,WAEA,sCACA,oCACA,wBAEA,0DACA,CACA,gBACA,sBAEA,wBACA,kBACA,oCAA+D,oBAA0B,OACzF,QACA,yCAEA,0BACA,4BACA,oBACA,WACA,mDACA,mBACA,OACA,2BACA,0CACA,oCAA+C,sBAAuC,WACtF,yBACA,uCAA8C,UAAqB,SACnE,6BACA,mDACe,oBACf,eAEA,kCAA+C,+CAAyD,EACxG,iBACA,uCAAiD,cAAiC,eAClF,MAq2DA,gBAh8CA,SAEA,2BAEA,eACA,CACA,+BAAsB,OAAe,kCAErC,yBACA,sBACA,cACA,YACA,SACS,iCACT,iCACA,QAEA,wBAAiC,sBACjC,oBAAwB,eAExB,yBACA,wCACA,MACA,0BACA,sBACA,UAAqB,MAAiB,OAC7B,qBACT,QAGA,kBAFA,KAIA,6BACA,gCACA,gBAA4B,2BAC5B,8CACA,UAAoB,8BACpB,+BACA,cAAuC,UAAyB,QAChE,cACA,aACA,KACA,+BACA,WAEA,kBACA,WAAqB,QAAqB,OAC1C,cACA,qCACA,QAMA,kBALA,WACA,cACA,MAKA,gCACA,qBACA,qBAA0B,2CACZ,iBAEd,mBAAgC,WAChC,WACA,iCACA,WAEA,8BACA,IAAqB,QAAmB,OACxC,SACA,gBACA,oBACA,aACA,0CACA,SAA6B,KAAS,IACzB,IACb,0BACA,oCACa,2CACb,SAAS,aACT,qBACA,oBACA,kBAA8C,WAG9C,MAIA,2BACA,WACA,SAEA,6BACA,gBACA,UAEA,4BACA,UACA,kCACA,gCACA,GACA,KAAoB,SACR,OAAQ,QACpB,YACA,iBAAoD,MACpD,kBAA4C,SAC5C,MAAc,SAA4B,QAC1C,CACA,gCACA,qCACA,EAEA,uBACA,gBACA,cACA,kDACA,MAEA,yBACA,6BACA,EAEA,0BACA,OAEA,OACA,SAA0C,kBAC1C,2BACA,gBACA,wBAA+B,gBACxB,eACP,eAAuB,WAAuB,OAC9C,QACoB,cAEb,+BACP,uBACO,iBACP,kBAEA,iBAAuB,gBAA2B,OAClD,QACA,yBACW,wBAEX,KACA,QAEA,6BACA,YACA,wCACA,oBACA,KAEA,4BACA,oBACA,qBAA0B,UAC1B,KAA0C,0BAC9B,oBACZ,kBACA,OAEA,0BACA,iCACA,OAEA,0BACA,uBACA,yBACA,IAEA,4BACA,mBAAsC,WAAqB,cAC3D,8BACA,WACA,8BACA,UACA,wBACA,oCACA,aAAoC,iBACpC,MAA+B,MAAa,IAC5C,eACA,MACA,KAEA,uBAA6C,WAAgB,mBAC7D,6BACA,EAEA,8BAAmC,wBACnC,6BAAkC,wBAElC,wBAA6B,QAAS,kDAEtC,+BACA,YACA,yBACA,2BACA,yBACA,6CACA,2BACA,yBACA,eACA,cACO,kCACP,yCACA,4CAEA,8DACW,uBACX,wBACW,sBACX,YACW,sBACX,YACA,eACA,gCACA,GACA,oCACA,0BAEA,QAA8B,YAC9B,EAAqC,oDACrC,kBAGS,kBAAuB,8CAChC,cAEA,mBACA,yBACA,OACA,qCAEA,8BACA,OACS,yCACT,KAEA,gCAA8C,IAA6B,OAE3E,6BACA,OAEA,OACA,EAAuB,SAAU,IACjC,qBACA,SAAqB,EAAY,aAEjC,gBAEA,SAHA,KAIA,QAEA,wBACA,OAEA,wCACA,yCACW,sCAEA,gCACX,IACA,KAEA,2BACA,2BACA,MACS,+CAEA,8BACT,cACA,yBAA4B,YAA+B,OAAI,YAC/D,KACA,EAEA,6BACA,OAEA,SACA,IAAuB,SAAU,IACjC,qBACA,SAAqB,IAAY,eAEjC,OAAwB,YACV,OACd,SACA,eAEA,SANA,KAOA,QAEA,wBACA,OAEA,kBACA,2CACA,uDACA,CACW,2BACX,uBACA,OAA0C,8BAC1C,qBACA,YACA,YAGA,0BAFW,oCACX,MAEA,QAAyB,iBAAgB,iBAA2B,OAC3D,+BACT,IAGA,yBACA,8BACA,gBACA,QACA,wBACA,uCAAsE,WAAkB,IACxF,gBACA,YACA,kBAA2B,OAA+B,OAC1D,0BAAkD,aAAsB,OACxE,aAA2B,uBAA4C,IACvE,oBAA4D,KAC5D,yBAA8D,YAC9D,GACA,+BACA,QAEA,6BACA,wBACA,8CACS,oCAEA,kDAET,kEACA,WACA,qBAA0B,0CAC1B,uBAA4B,mDAE5B,2BAAwC,IAA4B,SACpE,2BACA,oBACA,gBAAc,wBACd,sDACA,oDACA,8CACA,MAEA,iCACA,CACA,YAAoB,oCACpB,MAA6B,yBACtB,qBACP,sBAAoB,eACb,MACP,kBAAoB,UAEpB,SAAyB,YACzB,kBAEA,EACA,wCAIA,WAFA,OAIA,2BACA,OAEA,kBAAsC,gDAA+E,MACrH,EAA0B,2CAC1B,MAA2B,4CAC3B,mBAAsC,iBACtC,yBACA,wDACA,MAA2B,kBAAgB,cAAyB,OACzD,8BAAiC,QAA4C,eACxF,CACA,GACA,cACA,iCACA,KAEA,yBAA2B,iBAC3B,4BAA+B,eAC/B,0BAA6B,eAE7B,uBACA,oBACA,oBACA,iBACA,kBACA,2CACA,cACA,gBACS,8BACT,wBACA,KAEA,yBACA,YACA,IAQA,YAPA,QACA,WACA,yBACA,+BACA,sBACA,iCACA,SAGA,4BAA8B,oCAC9B,+BAAkC,2BAClC,gCAAmC,4BACnC,8BAAiC,2BAEjC,GAEA,sCACA,GAAwC,+BAAqC,QAC7E,KACA,SACA,0CACA,GACA,yCAAgC,OAChC,OACA,CAUA,CA2gCA,KACA,mEACA,iBAAiC,2CAC9B,yCACH,mBAAuB,kCACvB,CAAG,KAAyB,gBAyC5B,MArCA,QAEA,gBAA4B,YAM5B,oBACA,yBACA,mBAAsD,wBACtD,sBACA,YAEA,GAEA,WA9oQA,aACA,CACA,OAGA,EA0oQA,+BAA6C,QAAU,iBAA0B,UAA2B,WAAK,EAAE,GACnH,2BAEA,QAEA,gCACA,IACA,gBACA,mCACA,IACA,gBAEA,gBAjJA,aACA,cAcmB,oBAEnB,aAfA,aACA,qBACK,wBACL,4BACK,8BAGL,+BACA,OACA,gBACA,qDACA,IAEA,IAGA,QACA,iBAEA,uCACA,SACA,SACA,UACA,0BACA,CACA,MACA,WACA,WACA,QACA,CAAO,UACP,CAGA,yBACA,GACA,+BAAkC,CAAiB,QACnD,yBACA,cACA,MACA,+BACA,qCACA,KACA,iBACA,YACW,0CAEX,UACA,CAEA,kBACA,2BAAyC,sCAAqE,YAE9G,KACA,UAEA,WACA,GACA,SACA,QACA,sBACA,SACA,gBACA,gBACA,eACA,eACA,UACA,YACA,UACA,eACA,oBACA,QACA,WACA,WACA,eACA,iBACA,aACA,oBACA,gBACA,eACA,gBACA,eACA,cACA,YACA,aACA,mBACA,eACA,qBACA,kBACA,sBACA,gBACA,gBACA,sBACA,uBACA,Y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Aa,EAAb,wBAIJ,IAJ2C,OAK5C,sBC1CD,oCAqQA,wDA9PA,WAGA,GAAC,kBAAqB,CAEtB,aAEA,YACA,sBACA,UAGA,CAKA,aACA,4BACA,qDAEA,aAGA,iBACA,sDAEA,aAEA,CAEA,eAEA,SACA,SAEA,aACA,YACA,OAEA,aACA,2BACA,sDAEA,aACA,2BACA,oDAEA,eACA,UACA,QAAe,MAAgB,OAC/B,aAEA,SACA,SAEA,eACA,wCACA,UAEA,eACA,QACA,QACA,cAIA,MASA,WARA,2BAGA,cACA,yBAGA,WAGA,mBACA,uBACA,MAEA,YAEA,OACA,CACA,sBACA,eACA,aACA,gBACA,EACA,0BACA,KACA,iBACA,mBACA,uBACA,YACA,KACA,WAEA,oBAEA,aACA,OACA,qBAEA,OACA,GAEA,CAoBA,aACA,qBACA,OACA,4CACA,OACA,QACA,iBACA,YACA,iBACA,UACA,iBACA,mBACA,cACA,kBACA,iCAEA,kBACA,YACA,GACA,qBACA,sCAGA,wCACA,cAGA,eAEA,SACA,UACA,SAEA,aACA,SACA,KAQA,MAPA,cAMA,qBAHA,SAQA,CAEA,eACA,SAEA,SACA,yCAEA,sBACA,aAEA,QACA,aAEA,QACA,aAEA,QACA,uBAEA,aACA,iBAEA,UACA,qBAEA,YACA,uBAEA,aACA,aAEA,UACA,uBAGA,SACA,kBAAmB,OAA6B,OAChD,MACA,QACA,KACA,OAKA,QACA,QAEA,CAGA,aACA,GACA,oCACA,yBACA,6BAIA,MACA,UACA,qBACA,MAEA,OAEA,aACA,iCACA,yBAEA,aACA,OAEA,WAEA,OAIA,aACA,OACA,KAEA,EAKA,aAJA,gBAGA,OAGA,CACA,iBACA,oBACA,uBACA,UACA,EACA,QAAe,EAAS,IACxB,eACA,sBACA,QAGA,UACA,KAEA,aACA,QACA,kEACA,mBAEA,2BAEA,eACA,IAEA,yBACA,IACA,iDAEA,UACA,WACA,KAC2B,EAA3B,cAAiD,WACjD,MACA,iCACA,yBACA,eACA,6BAEA,kBACA,EACA,QAEA,eACA,OACA,6EACA,OACA,IACA,qBACA,UACA,IAEA,CAEA,eACA,CACA,8BAEA,wBACA,QACA,KAEA,UAKA,aACA,+BACA,wDAqBA,eACA,SAAuB,MACvB,EACA,WACA,oBACA,YACA,UACA,aACa,OACb,iBAMA,WAJA,MAKA,WACA,SACA,UAEA,eAAiC,GAGjC,OACA,SAEA,aACA,CACA,cAEA,OAsGA,eACA,SACA,8BACA,QAEA,aACA,sCACA,sBAEA,aACA,OACA,GACA,EAEA,EACA,WACA,WAEA,cAKA,OACA,QAEA,CAEA,eACA,CACA,QAEA,aACA,OACA,UACA,gBAAoB,gBAEpB,QAIA,2BAHA,qBACA,QACA,KAGA,eACA,mBACA,OACA,WAMA,WALA,yBACA,QAEA,KAGA,EAEA,eACA,UACA,8CACA,IAEA,iBACA,GACA,sCAEA,SAEA,CA2BA,iBACA,UACA,WACA,cACA,cACA,kDACA,IAEA,CAYA,mBACA,IACA,KACA,iCACA,OACA,UAGA,OAGA,gCACA,yCACA,GAGA,uBACA,+CACA,aAEA,GAEA,aACA,gBACA,iCAEA,oBACA,IAEA,aACA,qBAEA,cAAsC,OAAY,IAClD,YACA,SAEA,QAIA,wBACA,UACA,QAAmB,EAAY,IAC/B,8BAEA,KACA,QACA,CAEA,CACA,eACA,UACA,mBAIA,2BAEA,KACA,yBAJA,cAMA,eACA,cAGA,UACA,oBAEA,OAJA,mBAKA,WACA,aACA,2BACA,KAGA,EACA,QAEA,CA2BA,iBACA,yBACA,OACA,SACA,EAEA,eACA,OACA,2BAIA,oBADA,KAGA,CACA,aACA,8FACA,OACA,WACA,IAEA,aACA,kBAA0C,yBAC1C,OAEA,CAEA,eACA,IACA,WACA,uBAEA,KACA,sBACA,MACA,IAEA,KAAe,MAAkB,OACjC,OAEA,QAEA,eACA,sBACA,YACA,SACA,OACA,GAEA,iBACA,UACA,mBAEA,OAEA,CA6BA,gBACA,oCACA,YAEA,CAsEA,kBACA,SACA,mCAEA,mCACA,yBACA,0BACA,KAAmB,EAAQ,KAC3B,SACA,yDACA,+DAKA,6BACA,0BACA,4BAEA,wBACA,2BAGA,QACA,0BACA,sBAGA,yBACA,2BAEA,wBACA,qBAGA,yBACA,4BAGA,QA0CA,gBACA,IAEA,SAEA,UAGA,YACA,8BACA,UAEA,8BAEA,gBACA,KAKA,SAGA,yBAFA,0CACA,gBAGA,cACA,OACA,gBAMA,aALA,uBACA,SAEA,MAgDA,aACA,gBACA,mBACA,MAEA,iBACA,KACA,QAAe,EAAQ,KAEvB,SACA,kCACA,0BACA,0BACA,+BAIA,WACA,UACA,UACA,UAAe,EAAQ,KACvB,WACA,aAEA,YAAe,EAAQ,KACvB,WAGA,wDACA,iCACA,qEACA,kEACA,IAEA,CA4CA,cACA,kBACA,IAEA,cACA,0BACA,QAEA,CAcA,0BAGA,UAGA,qBAIA,+BAHA,kBAEA,iBAGA,cACA,oCAGA,YAIA,+BAHA,qBAEA,mBAGA,CACA,kBACA,CACA,MAEA,oCAEA,aACA,CAEA,CACA,sBACA,OAEA,mBACA,WAFA,MAIA,QACA,WACA,IACK,WACL,WACA,MAEA,QACA,IAGA,KACA,CACA,OAEA,aAEA,kBACA,YACA,uCACA,IAEA,QACA,iBACA,MACK,kBACL,sBACA,uBAEA,QACA,OAGA,KACA,CACA,OAEA,QAEA,kBACA,OACA,iBACA,yBACA,CAEA,CAwHA,gBACA,OAIA,mBACA,cAIA,iBAIA,qBACA,iBANA,MAQA,gBACA,OACA,yCAEA,WACA,MAIA,CAoBA,kBACA,SACA,mCACA,uCACA,4BACA,0BAEA,KAAmB,EAAO,IAC1B,iBACA,wDACA,yEACA,+DAKA,6BACA,2BACA,yBACS,QACT,0BACA,8BAEA,wBACA,4BAGA,QACA,2BACA,mBAGA,yBACA,wBAGA,yBACA,4BACS,QACT,0BACA,wBAGA,yBACA,mBAGA,yBACA,4BAEA,wBACA,sBAGA,yBACA,mBAGA,yBACA,8BAGA,QA+IA,aACA,gBACA,mBACA,MAEA,sBACA,WACA,QAAe,EAAO,IAEtB,iBACA,4BACA,2BACA,sBACA,MACA,UACA,UACA,UACA,UACA,UAIA,cACA,UACA,UACA,UACA,UAAe,EAAO,IACtB,WACA,aACA,aAGA,0DACA,mCACA,2CAEA,yEACA,oEACA,kEACA,IAEA,CAEA,aACA,yBACA,GA4BA,gBACA,mBACA,qDACA,YACA,GAcA,gBACA,UACA,eA+GA,cACA,sCACA,MAIA,CACA,cACA,mBAEA,cACA,sBACA,SACA,gBACA,qBACA,UACA,CAEA,0BADA,QAGA,yCAEA,EAEA,MACA,GACA,CACA,GACA,OACA,MAEA,cACA,OAEA,gBACA,4BACA,WACA,MACA,qGAGA,IACA,KAAS,SAAY,CAErB,OACA,MAIA,CACA,gBACA,IAEA,gBACA,KAGA,MAKA,YAIA,UACA,MAEA,gBACA,aACA,IACA,WACA,OACA,cAKA,0QACS,gBACT,wBACA,8CAEA,yBACA,mCAEA,4BACA,CACA,OAEA,WAGA,wBAEA,QACA,gCACA,aACA,OAMA,GAGA,MACA,KAEA,cACA,OAEA,KA8BA,cACA,IAEA,8BACA,oBAGA,OACA,GAGA,mBAEA,CAEA,KADA,QAGA,WACA,GAEA,OACA,OAMA,cACA,SAGA,GAFA,EA0BA,WAvBA,oBACA,WACA,oCACA,gEACA,uBACA,qBACA,qBACA,cAEA,kCACA,QAEA,4BACA,QAEA,8BACA,QAGA,WAGA,aAKA,CAoCA,cACA,SAEA,oBACA,UAFA,QAIA,OACA,UAEA,gBAAwC,OAAO,IAC/C,2BACA,SACA,gBACA,GACA,KAEA,IACA,QAGA,cAFA,qBAGA,cAA4C,OAAO,IACnD,2BAEA,qBACA,GACA,KAEA,IACA,QAGA,cAFA,YAGA,QACA,QAGA,cAFA,kBAGA,gBACA,MAEA,QAIA,eAHA,gCAIA,IACA,KACA,QAEA,WAGA,CAGA,cACA,OAGA,QACA,gBACA,gBACA,gBACA,gBACA,gBACA,gBACA,gBACA,gBAEA,cAZA,MACA,IAcA,SACA,gCACA,wBACA,wBACA,SAEA,UACA,4CACA,sCACA,6BAGA,SACA,kBACA,oDAEA,2BACA,OAIA,YAHA,0BACA,YAIA,aACA,YACA,GACA,QAEA,YA9BA,2DA+BA,eACA,gDAEA,MACA,UACA,SACA,IACA,MACA,YAEA,WACA,2BACA,MACA,WACA,QACA,WACA,UACA,QAEA,WAEA,CACA,cACA,iBAEA,OACA,SAIA,6BAHA,QAIA,aACA,kBAEA,aAGA,WACA,aACA,kBAEA,aAIA,UACA,2BAaA,kBACA,OAGA,SAIA,cAEA,cAEA,kBACA,gBACA,8CAEA,8CACA,UAKA,CACA,cACA,gBAEA,QAIA,UAGA,4BACA,gBAIA,MACA,mCAEA,4BACA,yBAGA,kCACA,uBACA,yBAQA,gBAAe,OAA+B,cAC9C,iBAIA,KAAU,KAAO,IACjB,2CAIA,MACA,eACA,cACA,cACA,iBACA,qBAGA,gCAGA,QACA,wDAGA,QACA,oBAEA,KAEA,cACA,mBAEA,SACA,0BACA,YACA,IAMA,kCACA,eACA,YACA,SACA,OAEK,UACL,mBACA,sBAEA,aAEA,+BAGA,iBAEA,MAEA,UAMA,UAQA,SAPA,YACA,SAIA,YAXA,QACA,OAES,MAWT,QACA,eACK,kBACL,WAGA,yBACA,oBAEA,gBAJA,mBAMA,CAOA,cAEA,aACA,SAGA,WAFA,mBAGA,SAGA,WAFA,YAGA,QAGA,oBACA,OAEA,SAEA,UAHA,qCAKA,KAAe,MAAmB,OAClC,MACA,6BAIA,sBACA,YACA,6BAEA,iCACA,aAGA,QAEA,cAGA,2BAEA,QAEA,qBACA,sBAKA,2BACA,IACA,6BAIA,QACA,wBACA,SACA,kBAGA,gDACA,mBAEA,2CAEA,WACA,MACA,MAGA,kBACA,IAEA,SAIA,WACA,qBAGA,oBACA,WACA,UAEA,OACA,WAOA,QAdK,iBAgBL,CACA,cACA,IACA,GAEA,EACA,EACA,EAEA,KACA,gBAKA,YAJA,oCACA,YAGe,SAAsB,OACrC,OACA,MACA,MACA,8BAEA,gBACA,MAEA,QAKA,gBAGA,iBAEA,iCAEA,kBACA,OACA,IAIA,UACA,MAEA,cACA,OAIA,cACA,4FACA,sBACA,GAEA,GACA,OAEA,cACA,gBACA,QAOA,SALA,mBACA,OAGA,mBAGA,cACA,SACA,OAEA,oCAEA,0BACA,WAGA,gBACA,sCAGA,aACA,YACK,QACL,OACK,KACL,KAEA,QAEA,MAGA,MACA,YAIA,SAEA,cACA,SACA,GACA,qBACK,OACL,qBACK,WACL,mBACK,MACL,mCACA,mBACA,GACA,GACK,OACL,KACK,MAEL,aAEA,WAEA,2BAEA,sBACA,OAEA,kBACA,UACA,IAGA,iBACA,YACA,gBAIA,YACA,gCACA,WACA,OACA,OACA,OAEA,UACA,MAEA,oBACA,OACA,eAEA,CA6BA,gBACA,OACA,uBACA,UAEA,OACA,aAEA,cACA,KAAe,MAAoB,OACnC,sBACA,gBAGA,MACA,QAEA,CAmBA,cACA,QACA,iDACA,MAIA,gBACA,QAAmB,OAAqB,OACxC,gBACA,CACA,KAEA,oCACA,UAEA,KAGA,CACA,SAUA,cACA,OACA,eACA,eACA,aACA,YACA,WACA,YACA,cACA,cACA,mBAEA,gBAGA,yBACA,GACA,MACA,MAGA,2BACA,GAIA,iBACA,GACA,IAEA,gBAEA,gBAEA,UACA,UAEA,cACA,OACA,iBAEA,cACA,OACA,MAEA,UAEA,IAEA,CAEA,gBACA,mBACA,YACA,cACA,UACA,SACA,KAEA,gCACA,EACA,GAqBA,gBACA,eAEA,YACA,eAGA,2BACA,8BACA,oBAEA,UACA,OACA,eACA,EAEA,CACA,gBACA,OACA,WACA,YACA,qDAEA,4BACA,eAGA,4BAEA,QAEA,cAGA,OACA,mCAKA,CA+IA,aACA,sCACA,gBAGA,CAOA,gBACA,IAEA,OACA,KACA,EACA,EAEA,EAmDA,MAlDA,SACA,MACA,kBACA,UAEK,SACL,QAEA,KAEA,SAEK,sBACL,0BACA,IACA,GACA,MACA,aACA,aACA,aACA,iBAEK,sBACL,0BACA,IACA,QACA,aACA,aACA,aACA,aACA,aACA,aAEK,QACL,UACK,oCACL,iCAEA,OACA,UACA,mBAGA,UAEA,qBACA,yBAGA,WAMA,gBAIA,mCAEA,sBACA,OAEA,gBACA,QAAe,sBAEf,GASA,4BARA,QACA,mDACA,gBAGA,iDAEA,OAGA,gBACA,IACA,yBACA,aAIA,UACA,cAEA,WACA,0BACA,yBAIA,YAbgB,sBAGhB,EAYA,CACA,gBACA,qBACA,OAEA,yBACA,wBAEA,2JAAsB,IAAc,IAGpC,0BACA,OACA,WACA,UACA,IACA,EAEA,oBACA,SACA,qBACA,cAEA,WAKA,cAGA,0CAGA,+BAGA,0BAGA,yBAEA,MAEA,CA0HA,gBAEA,2CAEA,2BACA,YAEA,QACA,4BAEA,mBAEA,2BAEA,mBAIA,cACA,EAuFA,cACA,IAEA,SACA,yBAEA,SACA,MACA,eAEA,WAEA,MAaA,aACA,aACA,QA+HA,gBACA,kBACA,KA8DA,sBACA,IACA,SACA,sBAEA,QACA,UACA,MAEA,aAEA,iBAEA,sBACA,OACA,8BAEA,8BACA,+BACA,2BACA,cACA,IAEA,CAkLA,gBACA,SACA,cAwIA,cACA,CACA,SAwCA,oBACA,OACA,WACA,eACA,WAEA,kBACA,IACA,OACA,IAGA,eAEA,GACA,wBAGA,eAEA,GADA,QACe,EAAQ,KACvB,kBAEA,SACA,QASA,CACA,oBACA,CACA,qBACA,OACA,IAGA,eAEA,KACA,IACA,IAEA,KACA,OACA,IAGA,eAGA,UACA,qBAEA,KACA,8BAGA,aAEA,GADA,QACe,EAAO,IACtB,wBAEA,OACA,SAyDA,oBACA,OAEA,oCACA,2BACA,qBAEA,UACA,SAEA,CAUA,cACA,OACA,KAEA,KAEA,KAiDA,cAGA,eACA,OAEA,cAEA,iBACA,KA6CA,cACA,kBACA,aACA,KACA,CAEA,CAcA,cACA,kBACA,qCACA,GACA,CAEA,CAuBA,sBACA,6BACA,QAEA,kBACA,aACA,gBACA,gBACA,gBACA,gBACA,gBACA,gBAEA,mBACA,iBACA,gBACA,eACA,gBACA,eACA,gBACA,eACA,gBACA,eACA,uBAEA,iBACA,UACA,OACA,cACA,OAEA,CACA,cACA,OAGA,eACA,uBAIA,QAEA,CAgCA,aAQA,UACA,mCAGA,2CACA,cACA,iBACA,aAGA,QACA,UACA,OACA,MAGA,SACA,OAIA,MACA,KACA,IACA,IACA,IACA,IACA,WAKA,8BAIA,IACA,aACA,aACA,aACA,iBACA,aACA,aACA,aACA,IATA,KAWA,QA7pIA,sBACA,qBAEA,gBACA,kBACA,mBAEA,IAAuB,EAAS,IAChC,2BACA,UAIA,SACA,QAGA,qCAoGA,YAwGA,iCACA,0BAyDA,GAEA,WACA,YAEA,gBACA,OACA,KACA,WACA,UAGA,QACA,QAGA,KAEA,UA6C4C,yBA4I5C,0LAEA,gDAEA,MAK0B,MAgF1B,QACA,UACA,WACA,WACA,gBACA,WACA,eACA,mBACA,aACA,aAEA,kBACA,SAEA,cACA,wBAEA,6BAIA,0BAGA,kIA0DA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KAEA,EAEA,sBACA,wBAEA,mBAEA,IACA,SAAmB,SAAiB,OACpC,OACA,YAGA,gBACA,CACA,EAEA,UAQA,8BACA,qBACA,CAAC,GAED,uBACA,sCACA,OAAC,GAED,wBACA,iCACA,OAEA,GAEA,UAEA,KAEA,UAEA,GAEA,UACA,cACA,qBACA,UACA,mBAAC,GACD,sBACA,UACA,cAAC,GAED,0BACA,YACA,CAAC,GAED,kCACA,mCAEA,SACA,aAIA,eAFA,OAMA,UACA,gCAwNA,oBACA,YACA,2BACA,KAAC,GAED,yBACA,oBACA,GAAC,GAED,yBACA,0BACA,sBAEA,QAEA,SAEA,KAEA,SAEA,GAEA,UACA,cACA,gBACA,iBACA,kBAEA,yBACA,sBACA,2CACA,IAAC,GACD,oBACA,SACA,oBAAC,GACD,mBACA,kBACA,GAEA,GAYA,+BACA,2BACA,IAEA,EAEA,wBA4FA,4BACA,oBAEA,WAEA,cACA,YAEA,KAEA,YACA,YAEA,GAEA,UACA,cACA,UACA,cAEA,uCACA,kBACA,IAIA,GAiCA,oBAEA,sBACA,sCACA,OAAC,GAED,uBACA,wCACA,OAAC,GAED,wBACA,mCACA,OAAC,GAED,qBACA,UAEA,cAEA,aACA,iBACA,eAEA,KACA,YACA,gBACA,eAEA,IAEA,UACA,UACA,UACA,oBACA,UACA,mBAAC,GACD,qBACA,UACA,qBAAC,GACD,sBACA,UACA,gBAAC,GAED,uCACA,qCAEA,SACA,aAIA,mBAFA,GAEC,GAED,iCACA,MACA,IAEA,GAgTA,yBACA,qBACA,iBANA,UACA,sBACA,KAMA,sBACA,0CACA,EAAC,GAED,wBACA,0CACA,oBACA,EAAC,GAED,sBACA,wCACA,EAAC,GAED,wBACA,wCACA,oBACA,EAAC,GAQD,WACA,GAEA,QAEA,SAEA,KACA,SAEA,IAMA,UACA,UACA,UACA,UACA,UACA,cACA,cACA,cAEA,YACA,cACA,YACA,cAEA,iBACA,0BACA,OACA,kBACA,GAAC,GACD,2BACA,mBACA,UACA,WAAC,GACD,4BACA,OACA,UACA,UAAC,GACD,uBACA,gBACA,mBACA,gBACA,gBACA,UAAC,GACD,yBACA,gBACA,aACA,mBACA,yBACA,cACA,gBACA,UAAC,GACD,qBACA,gBACA,mBACA,gBACA,UAAC,GACD,uBACA,gBACA,aACA,mBACA,yBACA,cACA,UAEA,+BA8BA,eACA,CACA,SAz0CA,SACA,wBACA,4BACA,uBACA,6BACA,+BACA,KAo0CA,eA5zCA,KACA,eACA,WACA,gBACA,mBACA,2BACA,6BAuzCA,2BACA,QAhyCA,KAiyCA,0BAEA,aA5xCA,QACA,aACA,WACA,mBACA,eACA,cACA,eACA,aACA,aACA,WACA,YACA,aACA,cACA,YACA,YA+wCA,uHAEA,sFAEA,KAhhBA,KACA,MACA,GA+gBA,kFACA,iDAEA,0DAIA,qBACA,MACA,MA8MA,sJAEA,iJAEA,2BACA,iBACA,qCACA,mCACA,gCACA,8BACA,0BACA,+BACA,0BAEA,uBACA,4BACA,6BAIA,aACA,kBACA,wCACA,kCACA,2BACA,4BACA,oCACA,8BACA,wBACA,kBAGA,YAEA,yBAwDA,kMA+FA,0BAKA,8VACA,sCACA,IAGA,GAgJA,sBAEA,EACA,sBAEA,SA4PA,EACA,+GACA,qBACA,oCACA,iBAEA,OAEA,GAGA,MACA,EACA,+GACA,qBACA,oCACA,iBAEA,OAEA,GAOA,qFAkIA,YACA,QAEA,IAEA,UACA,WACA,4BACA,GACA,kBACA,QAMA,GACA,yBA2CA,0BAaA,SA2IA,yMA+DA,mBACA,WAvVA,UACA,WACA,kBA6aA,4BA8IA,uCACA,4CAkGA,OACA,EACA,6JACA,OACA,iBAEA,kBAEA,SACA,GA2HA,yBACA,wBACA,GAAC,GAED,yBACA,2BACA,GAAC,GAMD,sBACA,uBACA,yBACA,WAEA,eAEA,mBACA,gBAEA,MAEA,gBACA,gBAGA,GAEA,UACA,UACA,cACA,cACA,gBACA,gBACA,iBACA,iBAEA,mDACA,kBACA,IAAC,GAED,+BACA,QACA,oBAEA,GAkDA,aAEA,WAEA,YAEA,KAEA,YAEA,GAEA,UACA,mBACA,OACA,UAEA,GAQA,oBAEA,QAEA,SAEA,KACA,SAEA,GAEA,UACA,cACA,oBAEA,OACA,gCACA,gBACA,8BAAC,GAED,iBACA,oBACA,wBACA,GAEA,GAEA,SAEA,WAEA,0BAEA,aAEA,cAEA,OACA,cAEA,GAEA,YACA,aACA,gCACA,cACA,IAIA,GASA,iBAEA,UAEA,WAEA,KAEA,WAEA,IAEA,UACA,cACA,OAEA,UAEA,SAEA,cAEA,iBAEA,UAEA,WAEA,KAEA,WAEA,IAEA,UACA,cACA,OAEA,UAEA,SAEA,cAEA,oBACA,6BACA,IAAC,GAED,yBACA,6BACA,GAAC,GAED,+BACA,2BACA,OACA,sBAAC,GACD,4BACA,OACA,uBAAC,GACD,6BACA,OACA,uBAAC,GACD,8BACA,OACA,uBAAC,GACD,+BACA,OACA,uBAAC,GACD,gCACA,OACA,uBAGA,GAEA,gBAEA,MAEA,gBAEA,IAEA,aACA,cACA,eAEA,OACA,OAAoB,OAAmB,iBACvC,IACA,SAMA,OAAiB,IAAmB,iBACpC,IAEA,SAEA,SAEA,mBAEA,sBACA,WAEA,YAUA,mBAEA,UACA,YAvpBA,aAGA,UACA,0BACA,mCAEA,2CAEA,8DACA,SA8oBA,SA5oBA,UACA,cACA,OA2oBA,QAllBA,eACA,IACA,GACA,IAEA,cACA,kBAKA,SACA,WAGA,OAEA,uCAEA,8BACA,oBACA,QACA,iBACS,EACT,gBAGA,QACA,wBACA,mBACA,iBACA,qBACA,uBAGA,cACA,MA3BA,KA0kBA,SA1XA,WACA,UACA,iBACA,mBAIA,MACA,eAGA,gEACA,QA+WA,UA3eA,WAEA,yCAEA,uBACA,iCACA,eAseA,QApeA,aACA,aACA,oBACA,iBACA,eAA+B,QAAqB,wCAEpD,sBAEA,eA6dA,WA3dA,WACA,kBACA,SA0dA,MAxdA,aACA,aACA,oBACA,iBACA,eAA+B,UAAqB,sCAEpD,sBAEA,eAidA,SA/cA,WACA,gBACA,OAIA,EA0cA,OAhqGA,WACA,UACA,OACA,SAEA,UACA,MA2pGA,aAxUA,UACA,gBACA,UAuUA,WAlpBA,aACA,cACA,iCAGA,sBACA,iBACA,mCAEA,8CAEA,YAwoBA,YAtoBA,aACA,cACA,iCAGA,sBACA,iBACA,mCAEA,4CAEA,YA4nBA,aA1nBA,iBACA,aACA,yCACA,qDACA,eAunBA,UArnBA,aACA,cACA,MACA,6BAGA,oBACA,eACA,qCAEA,eACA,yEAEA,aAymBA,iBAvmBA,aACA,+BACA,cAsmBA,kBApmBA,aACA,+BACA,eAmmBA,WAvVA,UACA,UACA,OAsVA,WACA,aACA,iBACA,UACA,UACA,gBAzVA,UACA,UAAoB,KACpB,QAwVA,OAtqGA,aACA,uBACA,GACA,eACA,OAAuB,MAAwB,OAC/C,2BAEA,MACA,WACA,OACA,eAGA,kBACA,OAypGA,WA5bA,WACA,CAIA,SADA,YAEA,kBAEA,OACA,cACA,kBAEA,OACA,WACA,cACA,UACA,kBAEA,OACA,oBAEA,OACA,sBAEA,OACA,2BAIA,UACA,yBAEA,GACA,+BAIA,GACA,0BAGA,qBACA,MAmZA,eACA,WAxXA,UACA,OACA,yEACA,gBAsXA,YApXA,UACA,OACA,WACA,SACA,gBACA,eACA,eACA,kBACA,oBACA,yBAEA,iBA0WA,UA9XA,UACA,sBACA,YA6XA,eA5iBA,UACA,UACA,gBAEA,yBACA,yBACA,kBAEA,mDAEA,2BAEA,kBACA,+BAOA,EAyhBA,WAxhBA,UACA,UACA,6CAEA,aACA,WACA,QACA,gDACA,qBAEA,iBACA,iDACA,aAGA,0BACA,IAHA,4BA4gBA,UA3WA,UAEA,0CACA,MAyWA,YAnjBA,UACA,yCACA,qCAkjBA,QAvYA,UACA,yBACA,MAsYA,WA5YA,UACA,0BACA,uBA2YA,GAEA,aAhWA,UACA,OACA,YACA,eACA,eACA,mBACA,mBAEA,QAEA,EAuVA,WACA,GAEA,WA7oFA,UACA,gBACA,SA4oFA,YAxSA,WACA,gBAEA,YACA,YACA,kCACA,4BACA,MAkSA,GAEA,YAlSA,WACA,gBACA,0CACA,IAgSA,cAEA,SA3OA,WACA,sEACA,EAEA,EAwOA,YACA,GAEA,YApyFA,UACA,4BACA,QAEA,EAiyFA,iBAhhFA,WACA,8BACA,wCACA,MA8gFA,uBA5gFA,WACA,oBACA,uCACA,IAEA,EAwgFA,eAnSA,UACA,yBACA,oCACA,MAiSA,GAEA,eA1SA,UACA,yBACA,IAySA,WACA,eAxzEA,WACA,UACA,yBAEA,uDACA,eACA,wBACA,2BAIA,OA8yEA,WA5yEA,WACA,UACA,yBAEA,0DACA,gCACA,MAuyEA,cAryEA,WACA,UACA,yBAOA,oBACA,iBACA,+CACA,EACA,oBAEA,CAEA,EAqxEA,GAEA,UAlMA,WACA,2EACA,gCACA,IAEA,EA8LA,WAEA,SACA,aAEA,WACA,aAEA,WACA,kBAEA,gBACA,aAphCA,eACA,qBACA,EACA,WACA,yBAEA,oBACA,IACA,4BAKA,QAEA,cANA,SACA,eAES,kBAIT,iBAEA,YACA,eACA,UACA,oBAEA,KACA,iBACA,sCACa,YACb,yBACA,oCACA,gCAGA,OACA,IACA,yBAEA,OAi/BA,OAj+BA,WACA,uBACA,MAg+BA,SA99BA,WACA,aACA,wBACA,UAGA,oCAGA,MACA,MAq9BA,aAn9BA,UACA,IACA,oCACK,6CACL,kBACA,IACA,uBAKA,WAFA,YAGA,OACA,OAu8BA,wBAr8BA,WACA,cAGA,kCAEA,EACA,6BA+7BA,SA77BA,UACA,CACA,8CACA,oDAEA,aAy7BA,WAl6BA,UACA,+BACA,QAi6BA,eA/5BA,UACA,8BACA,QA85BA,YACA,GAEA,SACA,YAtGA,UACA,0BACA,IAqGA,GAEA,SArGA,UACA,iDACA,IAoGA,iEACA,mEACA,gEACA,qHAjgCA,aACA,OACA,eAUA,aATA,uBAGA,SAEA,eAEA,QAw/BA,4HAr8BA,UACA,YACA,2BAGA,oBAEA,UACA,QAEA,WACA,6BACA,4BACA,WACA,qBACA,WAGA,6BACA,gBAg8BA,mBAEA,YAv5GA,eACA,+BACA,iCACA,WAEA,EAm5GA,kBA14GA,WACA,YACA,4CAEA,yBAIA,sEACA,gBACA,EAEA,QACA,mBAEA,EA43GA,eA13GA,UACA,aACA,YAEA,EAu3GA,WAp3GA,WACA,8BACA,OAEA,EAi3GA,eACA,iBACA,gBAl2GA,iBACA,YACA,uBACA,MACA,qBACA,UA81GA,cA51GA,aACA,uCACA,mCACA,QAEA,EAw1GA,GAEA,IA/+GA,WACA,OACA,EACA,aACA,KACA,KAEA,eAGA,cAIA,iDACA,iEACA,YAA2B,UAC3B,SA+9GA,UAp/FA,aAEA,yCAIA,mFACA,8BAJA,aAEA,kBAIA,EA4+FA,eA3+FA,aAEA,mDAIA,+DACA,mCAJA,kBAEA,yBAu+FA,eA17FA,eACA,SAEA,UACA,iCAGA,qBACA,iCACA,yBACA,0BAMA,MAAe,EAAQ,SAEvB,SACA,iBACA,oGACA,yFAEA,cACA,kEACA,sDAGA,8CACA,QACS,oDACT,QACS,qCACT,QAEA,QACA,CAEA,EAq5FA,eAv1FA,WACA,aACA,0BACA,yBAGA,aAEA,wBAGA,sBACA,uBAEA,sBACA,mDAEA,eAu0FA,GAEA,iBA92FA,WACA,aACA,0BACA,yBAGA,aAEA,6BAGA,2BACA,4BAEA,2BACA,6DAEA,kBAEA,EA41FA,QAlnFA,WACA,4CACA,IAEA,EA+mFA,kBAtmFA,UACA,mBACA,GAEA,EAmmFA,GAEA,eA7mFA,UACA,mBACA,KA4mFA,YAlgFA,aAEA,6CAIA,+EACA,8BAJA,eAEA,oBAIA,EA0/EA,eAp/EA,WACA,0CACA,cAm/EA,iBA1/EA,WACA,4CACA,cAEA,EAu/EA,iBAl7EA,eACA,SAEA,UACA,mCAGA,qBACA,qCACA,0BACA,4BACA,2BAGA,MAAe,EAAO,QAGtB,iBACA,gBACA,4GACA,+FACA,2FAEA,WACA,oGACA,wDAGA,gDACA,QACS,sDACT,QACS,mDACT,QACS,uCACT,QAEA,QACA,CAEA,EA44EA,iBAn2EA,WACA,aACA,4BACA,2BAGA,aAEA,0BAGA,wBACA,yBAEA,wBACA,uDAEA,eAEA,EAi1EA,sBAh1EA,WACA,aACA,4BACA,2BAGA,aAEA,+BAGA,6BACA,8BAEA,6BACA,iEAEA,oBAEA,EA8zEA,GAEA,iBA/zEA,WACA,aACA,4BACA,2BAGA,aAEA,6BAGA,2BACA,4BAEA,2BACA,6DAEA,oBA+yEA,QArpEA,WAGA,OACA,oCAEA,EAgpEA,YA/oEA,eACA,OACA,aAEA,YAEA,IASA,EA4tEA,QACA,wBACA,0CACA,SACA,qBACA,UACA,UACA,eACA,WACA,IAGA,IACA,qEACA,aAEA,mFA2JA,YACA,WACA,WACA,WACA,WACA,WACA,sBAcA,sBACA,iBACA,iBACA,eACA,cACA,yBAOA,QACA,IACA,KACA,KACA,KACA,KACA,KAGA,yBA8NA,MA1FA,YA/pDA,UACA,aACA,UA8pDA,OAvUA,UACA,YAEA,wCACA,kCACA,4BAEA,6BACA,6BACA,wBACA,sBACA,qBACA,qBAEA,OACA,MAyTA,OA5SA,aACA,oBACA,EAEA,EAySA,YAxSA,aACA,qBACA,IAuSA,MAnOA,WACA,UACA,gBAEA,gBAIA,cAHA,EACA,OAIA,kBACA,iCACA,qBACA,sBAGA,GAEA,8BADA,qCAEA,4BACA,+BACA,kCACA,kCAEA,+BACA,mCAGA,oBAEA,EAsMA,qBACA,gBACA,gBACA,cACA,aACA,cACA,eACA,cACA,WA7MA,UACA,aACA,eAIA,cACA,iBACA,yBAEA,2BALA,KAyMA,WAvSA,UACA,YACA,qBACA,aACA,eACA,cAIA,qBACA,kBACA,UACA,oBACA,IAKA,oBAEA,UACA,iBAEA,SACA,gBAEA,SACA,cAEA,UAGA,QACA,OACA,WAGA,aACA,OAEA,KACA,SACA,WAEA,QACA,MA2PA,OApLA,WACA,UACA,kCACA,KAkLA,mBACA,cACA,cACA,YACA,WACA,SAvKA,UACA,sBACA,EAEA,EAoKA,aACA,YACA,YAjGA,WACA,UACA,mCAGA,yBACA,uBAGA,iCAGA,WACA,aAEA,EAmFA,kBACA,eACA,aACA,aACA,GAEA,cACA,2GACA,GAIA,QAEA,kBACA,UAEA,WAEA,UACA,UACA,qBACA,eACA,qBAAC,GACD,qBACA,eACA,KAEA,GAGA,mBAxzIA,WACA,CACA,KAwzIA,KAEA,QACA,MApwDA,UACA,+BAEA,aACA,eAiwDA,MA/vDA,UACA,+BAEA,aACA,YAEA,EA0vDA,gBAzvDA,gCACA,KAEA,EAuvDA,QACA,OAriBA,WACA,WACA,QAoiBA,SA9aA,aACA,eACA,WA6aA,WACA,YACA,YACA,cACA,aACA,WA5aA,eACA,iBACA,aA2aA,YAziBA,UACA,iCACA,aAwiBA,gBACA,gBACA,cApbA,aACA,eACA,gBAmbA,cAzaA,eACA,iBACA,gBAwaA,kBACA,eAh/EA,aACA,YACA,IAEA,QACA,sBAEA,WACA,SACA,wBACA,MAGA,QACA,KAEA,KACA,eACA,yBAEA,mBAIA,mBALa,oBAMb,MAEA,EAs9EA,UA97EA,UACA,OACA,SA67EA,gBAjbA,eACA,iBACA,kBAgbA,mBACA,0BACA,wBA3KA,aACA,OAGA,kBACA,WAEA,OACA,QACA,kBAGA,SAgKA,iBA/zCA,aACA,gBACA,sBACA,gBACA,eACA,cACA,cACA,yBACA,YAwzCA,gBAIC;AA72ID;AACA;AACA;AAGC;sCCUD,CACA,iBACA,IACA,aACG,SACH,qBAEA,+BAEA,6BAMA,aACA,SAEA,kBAGA,UACA,UACA,UACA,UACA,UAEA,IAPA,KAUA,aACA,OACA,GAiBA,SAhBA,qBAEA,QACA,OACA,iBAEA,OACA,YAEA,QACA,gBAEA,QACA,YAEA,QAeA,aACA,IACA,OACA,UACA,OACA,KAEA,aACA,IACA,aAEA,wBACA,sBAA8C,IAAQ,KACtD,MACA,KACA,mBACK,GACL,SACK,IACL,MAIA,mBACA,OAEA,eACA,GAIA,sBAEA,KACA,iBAIA,UACA,OAGA,QA+GA,aACA,CACA,QAUA,CAmBA,aACA,IACA,GAGA,iBAEA,UACA,IAGA,YACA,wBACA,wBACA,yBACA,yBACA,yBACA,yBACA,yBACA,wBACA,uBAGA,qBAA2B,GAAQ,KACnC,OACA,qBAIA,SACA,QASA,CAsEA,eACA,OACA,OAGA,EACA,IAGA,GACA,CAKA,CAzWA,EAEA,eACA,mFAeA,aAsBA,EAYA,cA4CA,EAiBA,YA0CA,OAzCA,aACA,CACA,WAEA,KACA,WAEA,WACA,OAEA,sBAIA,WAEA,6BAEA,QAGA,aACA,SAIA,2BACA,cACA,OAGA,WAEA,2CAGA,mBACA,OAGA,SAGA,wBACA,8BACA,QAOA,EAiCA,WAhCA,aACA,CACA,WAGA,uBAMA,cACA,0BACA,oBACA,KACA,IAMA,sBACA,aACA,qBAGA,SACA,GAGA,iDACA,IAGA,gBACA,qBACA,cACA,gBAAC,IAsBD,kBAPA,WACA,OACA,MAIA,SAUA,oBAPA,WACA,OACA,cAIA,MAuEA,EAUA,2BAtCA,eACA,kBACA,aAIA,0BACA,aAIA,8BACA,eAIA,kCACA,gBAIA,6BACA,cAIA,cACA,WAwCA,sCA5BA,eACA,yBACA,oBAIA,6BACA,gBAIA,yBACA,OAIA,4BACA,aAIA,8BACA,eAIA,cACA,WA+CA,sCA5BA,aACA,yBACA,oBAIA,8BACA,gBAIA,yBACA,QAIA,6BACA,aAIA,+BACA,eAIA,iBACA,6BC/ZA,aAEA,qCACA,CACC,WAED,qBACA,KACA,kBACA,8BAEA,wBACA,uBACA,wBACA,sBACA,wBAEA,uBACA,iCACA,0BACA,cAGA,CACA,QAEA,UAEA,OAEA,WAAsC,0BAAuC,CAAgB,UAE7F,cAEA,Y,4BClCA,aAEA,EAEA,sBAEA,OAEA,WAAsC,0BAAuC,CAAgB,eAE7F,yBACA,CAYA,MAXA,0BACA,CACA,QACA,cACA,gBAGA,cAGA,Q,iFCtBA,eAEsB,eAAqB,GAA3C,OAGE,CAAiC,gBAC/B,CAEA,cACD,eAaS,MAGR,0BAEA,MAA0B,IAAtB,OAAK,eAAyB,KAIlC,uBAAM,GAAe,KAAa,WAElC,UACE,IADE,WACI,GAET,YAlC6C,EAAhD,E,mFCFA,qBACA,OACA,QAUA,GAIa,eAAqB,GAAM,SAAiC,wBAY/D,wBAAW,KACjB,GAEA,sBAAK,MACN,UACF,CAhBQ,SACL,OACE,iBAAC,EAAD,IAAI,CAAC,UAAU,kBACZ,KAAK,MAAM,SACZ,gBAAC,EAAD,OAAO,CAAC,UAAU,gBAAgB,KAAK,SAAS,QAAS,KAAK,SAC3D,KAAK,MAIb,aAVsE,EAAzE,E,8FChBA,aAAS,gCACT,aAAS,0BAAY,0BACrB,aAAS,Y,mJCFT,SACA,aAAS,e,6ECET,WACA,GAAY,GAAZ,CAAY,WACV,aACA,mBACA,oBACA,qBACD,OALD,GAAY,wCAAe,yECJ3B,qBACA,SACA,SAIA,KACA,QAAsB,WAElB,OAAO,GAYV,UAwBY,eAA4B,MAIvC,CAAmB,cAAiB,EAA2B,GAC7D,CAEA,cACD,UAR2C,EAA9C,E,wFC7CA,WAIA,GAAY,GAAZ,CAAY,WACV,uBACA,0CACD,mBAHD,GAAY,4BAAS,yECJrB,qBACA,OACA,OACA,OACA,OACA,OAEA,KACA,GAAY,GAAZ,CAAY,WAEV,iBAGA,2BACD,UAND,GAAY,8CA8FZ,KAGa,eAAsB,GAAM,SAAkC,wBAClE,4BAEC,kBAAW,KACjB,CAAI,KAAK,MACP,cAAK,MAER,UAEO,mBAAe,KACrB,MACD,aAKM,mBAAc,IACnB,CAAI,KACF,kBAAK,YAER,OAMM,mCACL,IAAO,KAAK,YACR,KAAK,YAiGZ,8BA7FQ,SACL,MAAM,GAAO,KAAK,MAAM,KACtB,gBAAC,EAAD,QAAQ,CACN,OAAQ,KAAK,MAAM,KACnB,UAAW,EAAW,OAAQ,KAAK,MAAM,iBAI7C,KAAM,EAAY,EAChB,iBACA,CAAE,eAAgB,cAAK,MAAwB,eAC/C,KAAK,MAGP,WAAM,EACJ,KAAK,MAAwB,8BACzB,KAAK,MAA8C,GAAxC,SAAM,KAAK,MAAM,cAAe,EAAG,IAGpD,IAAM,EACc,kBAChB,uBACE,UAAU,WACV,MAAO,CAAE,UAAkC,UAAvB,CAM1B,aACE,wBACa,YACX,UAAW,KAAK,MAAM,UACtB,MAAO,KAAK,MAAM,SAElB,gBAAC,EAAD,OAAO,CACL,QAAS,KAAK,QACd,IAAK,KAAK,YACV,SAAU,KAAK,MAAM,SACrB,aAAc,KAAK,MAAM,aACzB,SAAU,KAAK,MAAM,SACrB,KAAM,KAAK,MAAM,KACjB,aAAc,KAAK,MAGlB,kBACA,KAAK,aACL,KAAK,MAIb,UAEO,aACN,IACE,KAAK,MAAgB,gBACrB,KAAK,MAEL,2BAGF,WAAM,GACJ,KAAK,MAAgB,eAIvB,KAHI,uBAAK,UAAU,SAAS,KAAK,MAAM,OAGjC,EACJ,KAAK,MAAsB,qBAI7B,KAHI,uBAAK,UAAU,eAAe,KAAK,MAAM,aAGvC,EAAQ,KAAK,MAAM,OAAS,EAEhC,oBAAK,EACH,SACE,uBAAK,UAMT,iBAAK,EACH,SACE,uBAAK,UAAU,QACb,uBAAK,UAAU,SAAS,KAAK,MAMjC,UAAO,EAAY,cAAqC,yBAA9B,CAE/B,GA5HwE,EAA3E,E,+FCzGA,aAAS,wCACT,aAAS,0BACT,aAAS,wCACT,aAAS,sCACT,aAAS,gCACT,aAAS,kCACT,aAAS,wB,gDCCP,eAEA,MAAM,GAAO,EAAM,KACjB,KAAO,GAAS,EAAE,kBAAoB,GAAS,EAEjD,sBAAO,IACR,2CAXD,WAGA,EAUA,mBAGA,EAYA,iBAVE,aAEA,MAAM,GAEJ,gBAGK,EAAK,MAAM,EAAQ,EAAK,mBAChC,KADC,MAIF,EAiBA,sBAfE,aAEA,IAAI,GACJ,MAAK,KAAc,QACjB,MAAM,GAAQ,EAAK,MACnB,cAAY,CACV,CADE,SAGF,QAAc,EAAK,MAEtB,MAED,OAAO,CACR,GAMD,E,yBAEE,aAEA,MAAM,GACN,UACE,SAGF,WAAM,GAAgB,EAAQ,EAE9B,oBAAI,GACJ,SAAK,GAAI,GAAI,EAAgB,EAAQ,CAAL,IAAQ,IACtC,MAAM,GAAO,EACb,YAAI,CAAC,EAAK,oBACR,MAAM,GAAa,EACnB,IAAyB,EACzB,mBACD,KACF,CAED,MAAM,GACF,IACA,EAAK,iBAET,KAAI,GAEJ,SAAK,GAAI,GAAI,EAAgB,EAAG,EAAI,EAAK,MAAM,OAAQ,IACrD,MAAM,GAAO,EACb,YAAI,CAAC,EAAK,oBACR,MAAM,GAAW,EACjB,IAAwB,EACxB,mBACD,KACF,CAED,MAAM,GACF,IACA,EAEJ,qBAAO,CAAE,QACV,4EC7FD,qBACA,OAeM,IACA,EACN,EADe,CAAf,IACM,EACN,EADa,GACP,EAKA,EALM,GAkBC,eAAqB,GAAM,SAMtC,CAAmB,cACjB,CAAM,oBAgDS,8BAAsB,IACrC,MAAK,eAAe,KAAK,MAC1B,KAFgB,OA/CV,MAAQ,CAAE,aAAc,GAAI,aAClC,GAEO,aACN,CAAI,KACF,eAAO,aAAa,KACpB,YAAK,MAER,KAEO,CAGN,wBAEA,MACA,kBAAK,MAAQ,OAAO,WAClB,KAAK,oBACL,KAEF,MAvCJ,kBAuCS,SAAS,CAAE,eACjB,gBAEO,CAAe,iBACrB,MAAM,GACN,KAAM,EACN,IAAM,EAAO,EACb,QAAM,EAAW,KACjB,OAAM,EAAe,EAAK,OAI1B,QAAW,CAAP,IACF,SAAuB,oBAAc,EAAK,OACrC,UACL,SAAuB,oBAAc,WAChC,KACL,SAAuB,oBAAc,EAChC,WACL,SAAuB,oBAAc,EAChC,WAAI,EACT,SAAuB,oBAAc,EAAU,QAE/C,UAAK,SAAS,CAAE,eAAc,aAAc,EAAK,OAEpD,OAMM,CAA0B,4BAC/B,CAAI,KAAK,MAAM,OAAS,EACtB,WAAK,eAAe,EAEvB,KAEM,qBACL,MAAK,eAAe,KAAK,MAC1B,KAEM,uBACL,MACD,YAEM,CAEL,0BAEA,OACE,GAAU,OAAS,KAAK,MAAM,MAC9B,EAAU,eAAiB,KAAK,MAAM,cACtC,EAAU,eAAiB,KAAK,MAEnC,YAEM,SACL,OACE,yBAAM,MAAO,KAAK,MAAM,cAAe,KAAK,MAE/C,aArFF,EAHD,E,mFCrCA,qBAEA,OAEA,QACA,SAuBA,GAKa,eAAiB,GAAM,SAC3B,SACL,MAAM,GAAM,KAAK,MAIjB,QAAI,CAAC,EACH,aAGF,WAAM,GAAY,GAAI,GAAJ,UAAc,KAAK,MAAM,MAAO,KAAK,MAEvD,YAAM,EAAW,EAAmB,YAAK,IAAY,OACnD,QAAQ,EACN,UAAK,aACH,YACE,wBACO,MACL,IAAK,EAAM,KACX,UAAU,QACV,IAAK,EAGX,WAAK,aACH,WAAI,UAAK,MACP,kBAIO,wBAAW,OAAQ,EAE9B,MALM,gBAAC,EAAD,WAAW,CAAM,MAAO,IAAK,EAAM,IAAK,SAAU,EAGpD,WAEC,aACH,WAAO,yBAAW,OAAQ,EAC5B,MACE,cAAO,GAAY,cAExB,kCAED,SACE,wBAAK,UAAW,KAAK,MAAM,UAI9B,WA3C8D,EAAjE,E,6ECjC0D,WAC7C,EAAqB,mBAE9B,0BAES,EAA2B,yBAEpC,mBAIS,EAAiB,eAAuB,QAExC,EAA8B,4BAEvC,4BAEJ,E,oBAAoC,UAIlC,CACD,kDCFD,KApBA,WACA,2CAEA,IAEA,MAEA,KAEA,MAEA,2BACA,WACA,+BACA,iCACA,WAEA,OACA,gBACA,cAGA,6BACA,iBACA,SACA,WACA,WACA,IAEA,gBACA,KACA,SACA,SACA,kBACA,cACA,YACA,qBAIA,YACA,KAEA,QACA,CACA,QAEA,kCACA,mDACA,SACA,UACA,aACA,WACA,SACA,eACA,QACA,2BAEA,YACA,YACA,UAEA,wBACA,WACA,WACA,gBACA,EACA,IACA,QACA,EACA,YACA,OAEA,SACA,SACA,MACA,oCACA,MACA,QACA,EACA,YAEA,EACA,IACA,CACA,QACA,OACA,IACA,IACA,EACA,KACA,QACA,SACA,MACA,KACA,MAEA,OACA,EACA,cACA,iBACA,qBACA,aACA,IACA,IACW,QACX,OACA,sBAEA,MACA,IAEA,CACA,MACA,KACA,OACA,MACA,CACA,cACA,GACA,GAEA,iCACA,OACA,UAGA,WACA,WACA,2BACA,GAEA,iCACA,OACA,gBAGA,OACA,WACA,2BACA,GAEA,eACA,oDACA,QAEA,eACA,IACA,SACA,QACA,QAEA,eAEA,EAEA,6BACA,sBACA,KAEA,qBACA,uBACA,MAEA,sCACA,OACA,QACA,OACA,EACA,WAGA,UAGA,UAEA,GAEA,YACA,SAEA,KAIA,UAGA,SACA,IAEA,wCACA,IACA,YAEA,sBAEA,MACA,GAEA,+CACA,iBACA,UACA,WACA,SACA,MACA,MACA,UACA,IACA,SACA,MAEA,sBACA,aACA,MAGA,UACA,MAEA,IACA,QAEA,cACA,WAEA,6CACA,aACA,QAEA,6BACA,IACA,QAEA,aAIA,UACA,IACA,EACA,gBACA,MAGA,mBACA,eACA,eAEA,cACA,CAQA,sBAPA,MACA,aACA,WACA,OAEA,CAIA,iBAEA,sCACA,yBACA,SACA,WACA,cACA,KAEA,eACA,IACA,IACA,IACA,KACA,KACA,SACA,MACA,KACA,wBACA,QACA,CACA,IACA,QACA,KAGA,YACA,6BACA,QACA,MAEA,IACA,KACA,IACA,KAEA,IACA,MAEA,KACA,OAGA,gBACA,aACA,0BACA,KAEA,qBACA,WACA,SACA,WACA,SA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BACT,iBACA,aACA,OACA,iBACA,oCACA,yBACA,iBACA,sBAEA,WAEA,EACA,CACA,eACA,eACA,uBACA,MACA,CACA,iBACA,WACA,YACA,eACA,OACA,MACA,aACA,IACA,mBACA,oBACA,aACA,IACA,aAEA,6BACA,EAMA,CACA,eACA,gCACA,OAEA,OAEA,qBADA,KACK,EACL,IACA,eACA,kBACA,IACA,cACA,UACA,SACA,CACA,IACA,CACA,EACA,iBACA,IACA,SACA,OACA,SACA,IACA,IACA,EACA,eAEA,IACA,aACA,SACA,GACA,+BACA,WACA,WAA2C,SAAO,IAClD,UACA,QAEA,QACA,QACA,iBACA,eACA,kBACA,8CACA,GAEA,EACA,iBACA,OAEA,0CAEA,iDACA,uBACA,8BAA2C,OAAO,IAClD,aAEA,KACA,KACA,iBACA,eACA,gBACA,kBACA,MACA,OACA,iBAEA,MACA,WACA,OAEA,gBACA,IACA,QACA,CAEA,KACA,kBAEA,MAEA,MACA,EACA,eACA,CACA,mBACA,cACA,uCACA,CACA,aACA,GACA,aACA,OACA,UACA,QACA,cAEA,MACA,QACA,CACA,aACA,iBACA,KAEA,CAEA,aACA,QACA,mBACA,YACA,YACA,GACA,mBAAuC,OAAO,IAC9C,aAEA,MACA,SACA,6BAGA,gBAEA,6DADA,KAEA,gBAIA,OACA,SACA,mBAEA,CAuBA,YAtBA,QACA,4BACA,KACA,SACA,gBACA,cACA,yBAGA,iDAEA,wBACA,KACA,eACA,KACA,CACA,4BACA,CACA,gBAEA,KACA,IAGA,CAcA,aACA,WACA,0BACA,IACA,eACA,sBACA,yBACA,eACA,OACA,iBACA,eACA,OACA,QACA,IACA,cACA,WACA,0BACA,OACA,SACA,UACA,KACA,QACA,OACA,GACA,iBACA,SACA,SACA,UACA,aACA,QAIA,CAGA,eACA,CACA,KACA,IACA,CAEA,YAEA,CACA,SAMA,SACA,aACA,MACA,SACA,CACA,QACA,WACA,OACA,eACA,SAEA,qBAEA,EACA,0DACA,gBACA,MACA,SACA,0BAA+B,OAAqB,MACpD,QACA,KARA,GASA,eACA,kBACA,8GACA,iBACA,UACA,CAEA,CA4CA,eAMA,SACA,SACA,YACA,UAUA,eACA,uBACA,iBAA2B,UAAqB,UAChD,yBAAoC,UAA2B,cAC/D,QACA,KAIA,CACA,mBACA,SACA,SACA,gBACA,kBACA,eAEA,eACA,SACA,cACA,iBACA,wBACA,OAiDA,eACA,yFACA,MACA,mCACA,WAOA,MALA,yBAA8B,eAC9B,mBACA,KAEA,KAEA,CASA,YAAgB,EAChB,aAAsB,CAAY,SAClC,eAGA,iBAEA,mBACA,UACA,KACA,EACA,eACA,kBACA,cACA,wBACA,UACA,EACA,eAGA,OAEA,mBACA,oBACA,WACA,uBACA,iBACA,iBACA,uBACA,kBACA,wBAEA,6DAEA,qDACA,YACA,cACA,EACA,eACA,OAEA,mBACA,cACA,sBACA,iBACA,oCACA,kBAEA,sDAEA,qDACA,WACA,EACA,eACA,OAEA,oBACA,oBACA,WACA,kBACA,iBACA,uBACA,kBACA,wBAEA,6DAEA,qDACA,YACA,WACA,oBACA,MACA,EACA,eACA,OAEA,mBACA,yBAEA,yBACA,UACA,EAEA,eACA,OAEA,mBACA,oBACA,2CACA,qCACA,SACA,UACA,qCACA,UACA,UACA,EACA,qBACA,UACA,CA8BA,CA2FA,aACA,IACA,0CACA,wDACA,QAOA,mBAEA,mBAEA,kCACA,eACA,mBAEA,wBACA,IACA,2BAGA,kBAKA,6BAJA,yBACA,kBACA,oBACA,QAEA,aACA,iBACA,SACA,MACA,OAEA,CA6FA,qBACA,yCACA,4CACA,UACA,eACA,cACA,KACA,CA4EA,eAGA,IACA,cACA,IAEA,oBACA,0BACA,2DACA,OACA,2CACA,CACA,iBACA,aACA,SAGA,MACA,YACA,SAGA,SACA,IAAS,SACT,QACA,SACA,CACA,MACA,EACA,eACA,OACA,QAEA,+BACA,MACA,QACA,YACA,oEACA,WACA,WACA,uBACA,eACA,OACA,UACA,UACA,WACA,SACA,KAEA,GAEA,GACA,MAEA,QACA,KACA,aAEA,SACA,wBACA,mBAA2C,OAAS,IACpD,QAEA,cACA,gBACA,WAMA,SACA,kBACA,CACA,SACA,IAAS,EAET,KACA,eACA,IACA,gBAGA,yBAFA,uCAGA,iBAEA,0CAEA,qBACA,IACA,UACA,UACA,iBACA,IAGA,CAEA,aACA,WAEA,SAIA,SACA,YACA,MACA,MACA,mBAEA,SACA,UACA,SAEA,GACA,SACA,QAEA,IACA,KACA,SACA,wBACA,UACA,EACA,iBACA,MACA,WACA,eACA,oBACA,kBACA,EACA,SAMA,MAEA,eAPA,YACA,iBAGA,uBAIA,MAEA,CAOA,+BANA,OACA,oBACA,UACA,WAEA,cAEA,eAEA,sBACA,EACA,SACA,UAEA,WAGA,CACA,YACA,MACA,IACA,YACA,IACA,MAGA,MAFA,OACA,OASA,CACA,YACA,SACA,EACA,QACA,iBACA,QACA,OACA,SAAuB,EAAO,QAC9B,OACA,uBACA,GAEK,OACL,aACA,MACA,MACA,aACA,IACA,SACA,wBACA,gCACA,SACA,sBACA,OAEA,YACA,OACA,cACA,aACA,CACA,4BACA,EACA,IACA,QACA,kBACA,CACA,SACA,IAAK,EACL,IACA,cAIA,oBAA4C,qBAAoC,MAChF,OACA,QACA,cAIA,cAEA,gCAGA,OAGA,wBAFA,GAGA,cACA,OACA,gBACA,gBACA,IACA,uBACA,WACA,QACA,OACA,uBACA,UACA,SACA,IACA,IACA,QACA,CAEA,YACA,GACA,CACA,CAIA,CAMA,oBACA,mBACA,YACA,eACA,IACA,eAEA,cACA,aACA,CACA,sBAAsB,yBACtB,mBACA,WACA,eACA,iBACA,kBACA,oBACK,UAEL,MAKA,WACA,yBACA,gCACA,UACA,QACA,YAGA,MAFA,cACA,YAGA,CACA,aACA,WACA,WACA,WACA,UACA,cACA,EAGA,CACA,cACA,uBAEA,KACA,uBACA,gBACA,UACA,CACA,cACA,wBACA,kBACA,uBACA,CAEA,MADA,OACS,aACT,OACA,MACA,KAGA,MACA,cACA,CACA,gBACA,iCAEA,MACA,SACA,SACA,aACA,oBACA,MACA,MACA,SACA,gBACA,IACA,qDAGA,uBAEA,YAEA,UAEA,KACA,gBACA,UAEA,cAEA,YAGA,cACA,yBACA,mBAGA,+CAGA,qBACA,aACA,iBACA,mBAEA,OACA,EACA,aACA,UACA,kBACA,CACA,yDACA,iBACA,WACA,eACA,iBACA,gBACA,uBACK,MACL,GACA,sBACA,IACA,SACA,OACA,UACA,QACA,QACA,CACA,QACA,EACA,cAIA,IACA,WACA,kBACA,sCACA,IAEA,SACA,KACA,YACA,qBACA,UACA,QACA,CACA,QACA,CACA,IACA,gBACA,qBACA,+BACA,WACA,CACA,CACA,gBACA,IACA,MACA,KACA,cACA,SAAe,CACf,IACA,UACA,OAAoC,WACpC,qCACA,oCACA,WACA,oBAEA,WACA,mCAA6D,CAC7D,WAEA,cACA,gBACA,+CAEA,yBACA,IACA,uBACA,SAA+B,CAE/B,GACA,0DAEA,UACA,SAAmB,CACnB,CACA,CAEA,cACA,kBAqBA,IACA,yBAEA,UAEA,SACA,WACA,aACA,GACA,4BACA,EACA,6CACA,mBAEA,QACA,yBACA,+CAAgF,OAAkB,MAClG,wBACA,WAEA,GAEA,YADA,QAEA,cAEA,0BACA,OACA,QACA,uBAEA,YAGA,iCAEA,8BACA,SACA,UAEA,8CACA,aACA,SACA,OACA,EACA,EAGA,qCACA,uBACA,EACA,OAtEA,kBACA,MAEA,sCACA,GACA,YACA,aAEA,4BADA,SAEA,OAEA,mBAEA,WACA,IACA,uCAAyC,OAAO,IAChD,MAEA,cACA,QAkEA,CAoBA,gBAEA,cAgFA,WACA,CACA,uBACA,cACA,UACA,kBAEA,kBACA,GACA,kBA2DA,UACA,+BACA,wBACA,yBACA,qBACA,IACA,QAEA,iCACA,2BACA,QACA,sBAA4C,uBAAmC,OAAE,GAGjF,mBACA,QACA,EACA,kBAGA,aA2DA,kDACA,UACA,SACA,OA7DA,0BAAmE,eAA4C,WAAE,GACjH,MACA,wBACA,2FACA,YACA,6BAAsD,eAAoC,SAC1F,+BAEA,kBACA,IACA,eACA,SACA,QACA,cACA,kBAEA,mCACA,4BACA,QAEA,+BACA,MACA,8BAEA,gDACA,uBAEA,+BACA,CACA,MAEA,+BACA,iBACA,MACA,MAEA,4BACA,GACA,cACA,EACA,CACA,UACA,qBACA,yBACA,QACA,iBAEA,EACA,qBACA,YACA,cAEA,SACA,MACA,CACA,EAEA,sBAKA,CACA,OACA,EACA,gBACA,OACA,KACA,OACA,UAEA,WACA,QACA,YAEA,mBACA,cACA,QACA,cAEA,WACA,OACA,CACA,OACA,MACA,gBACA,OACA,UAEA,iCAEA,MACA,qBAEA,YAEA,SACA,cACA,iBACA,QACA,YAEA,mBACA,cAEA,iBAEA,cACA,cAFA,OAGA,kCACA,6BAEA,OACA,CACA,CACA,CACA,QACA,oBAEA,0CAAgF,mCAAwD,MAAI,iBAC5I,OAEA,4BAFwC,CAAsB,MAC9D,IAEA,gBACA,0BACA,uBACA,qCAEA,QACA,EACA,gBACA,WAAuB,4BAAyC,OAChE,WACA,oBACA,iBAGA,oBACA,gBACA,gCAAkD,8BAClD,OAMA,kBAOA,wBACA,QACA,IACA,qBACA,0BACA,QACA,0BAAoD,OAA8C,SAClG,EAEA,UACA,8BACA,GACA,QACA,SACA,OACA,MACA,kCACA,qBACA,WACA,QACA,QACA,EAAa,mBAWb,qCAA2D,CAAe,QAC1E,EAKA,EACA,kBAyPA,iBACA,UACA,iCAGA,uCACA,GACA,YAEA,iBACA,YACA,WACA,OACA,kBA+IA,MACA,YACA,cACA,yCACA,UACA,cACA,eACA,eAEA,OACA,kBACA,4BACA,GACA,WACA,GACA,EACA,sBAGA,2BACA,oBACA,KACA,YACA,QACA,aAA+B,IAAS,IACxC,eACA,gBACA,MACA,iCAA0D,OAAkB,IAG5E,QACA,kBACA,oBACA,WAAmC,EAAS,QAC5C,GAAmC,wBACnC,YACA,qBACA,uBACA,MACA,aACA,sBACA,MAGA,OACA,CAAiB,aACjB,CAEA,mBADA,YAEA,EACA,CACA,EACA,oBAkdA,OAMA,UACA,WACA,YACA,2BACA,wCACA,wBACA,UACA,yBACA,qBACA,iBACA,kBACA,sBACA,wBACA,qBACA,sCACA,GACA,aACA,SACA,mCACA,GACA,wBACA,MAAS,aACT,SACA,gBACA,qBACA,UACA,gBACA,qCACA,QACA,KACA,EACA,kBAiLA,WACA,CACA,wBACA,OAEA,KACA,gBAoWA,cACA,KACA,QACA,GACA,GACA,SACA,CACA,GACA,kBACA,gBACA,CACA,gBACA,+EACA,KACA,QACA,gBACA,cACA,aACA,YACA,kBACA,KACA,qBACA,YACA,QACA,SACA,aACA,8BAEA,KACA,gBACA,kCACA,uBACA,aACA,gBAyiBA,8BACA,OACA,kBACA,sBACA,OACA,0BACA,CACA,0BAGA,qBAAiD,eAAmB,aAA8B,QAIlG,SAGA,WACA,EACA,EACA,cACA,sBACA,QACA,QACA,wBAEA,KACA,EACA,wBAEA,wBAAyD,UAAiC,SAE1F,MACA,UACA,oBAEA,iCACA,SACA,YACA,iBAAyC,GAAmB,UAC5D,iBAA4D,CAAc,GAC1E,+BAA6E,CAAc,GAC3F,GACA,GAEA,KAEA,IAGA,iBACA,SACA,YACA,iBAAyC,GAAmB,UAC5D,yBAAyE,CAAc,GACvF,GACA,GAEA,KAEA,IAEA,IACA,cAGA,OACA,GAQA,uCAPA,KACA,sCAEA,mDACA,mFACA,SACA,IAEA,gBACA,WACA,QACA,iBACA,OACA,aACA,iBACA,OACA,aACA,iBACA,WACA,QACA,iBACA,WACA,QACA,iBACA,uBACA,CACA,iBACA,uBACA,CACA,iBACA,OACA,GACA,YAA6B,8CAAyE,UAGtG,KACA,cACA,wBACA,mBACA,4BACA,GAEA,2CACA,kCACA,kEACA,+DACA,wBACA,KAA2B,mBAA6B,WACxD,aACA,mBACA,kCACA,yEACA,wBACA,OACA,oBACA,GACA,UACA,WACA,iBAMA,gBACA,mBAAuB,MAAuB,WAC9C,OACA,SACA,kBACA,uBAA2B,iBAA6B,WACxD,SACA,2BACA,kDACA,YACA,YAEA,mBACA,OACA,CACA,CAEA,yBACA,gDACA,mDACA,mBACA,+DAEA,MACA,eACA,kBAEA,QACA,qBAAkC,qCAAsD,QACxF,kBAA+B,8BAAuC,OACtE,EACA,WAjjFA,kBAEA,WACA,OACA,yBACA,yBAEA,kEACA,8BACA,MACA,MACA,MAEA,MACA,QACA,KACA,SACA,KACA,uBACA,eACA,yBACA,CACA,IAAK,yBACL,CACA,IACA,GACA,wBACA,2BAsCA,IACA,2BACA,qEACA,oCAA4D,eAAyC,WAAE,GAGvG,iBACA,YACA,WAEA,QAEA,QACA,gBAWA,mBAeA,2DAEA,wBACA,yBACA,YACA,aACA,4BACA,eAGA,4BACA,uBACA,mDACA,YACA,MACA,IACA,qBACA,kBACA,iBACA,IACA,gCACA,0BACA,gBACA,OACA,OACA,UACA,aACA,0BACA,wCACA,kCACA,8BACA,MACA,yBACA,8DACA,4BACA,yGAAgH,OAAW,EAAE,GAC7H,GACA,QACA,eACA,CACA,EAEA,SAyKA,uDACA,OACA,eAGA,6BAyCA,iDACA,QACA,IACA,IAGA,qBAFA,0BAGA,QACA,IACA,SAAS,GACT,OASA,aACA,sBACA,IACA,gCAAoD,WAAkD,SACtG,wBACA,KACA,SACA,KAEA,SAEA,QACA,0CAMA,IACA,iBAEA,iOACA,iBACA,2BACA,yCACA,kBACA,uCACA,QACA,kCAIA,GACA,aAEA,iBACA,iBACA,qDACA,uCACA,iBACA,EACA,KACA,WACA,iDACA,eACA,SACA,CACA,8BAEA,CAIA,KAHA,UACA,UACA,YAEA,aACA,gCACA,4BACA,sBACA,SAEA,CAEA,kCACA,IACA,mCACA,OACA,OACA,gCAA+C,CAAe,SAE9D,SACA,GACA,IAAa,oBAKb,WACA,wDACA,gBAEA,UACA,sBACA,wBACA,OACA,CACA,EAAS,qBACT,IACA,IAAS,kBAET,CAEA,MADA,SACS,oBACT,IAEA,MACA,OACA,SAAuB,CACvB,OACA,UAEA,QACA,KACA,MAAS,qBACT,CACA,MACA,GACA,EACA,uBACA,UACA,eACA,kBACA,MACA,IACA,IACA,OACA,SAAuB,CACvB,IACA,IACA,CACA,gBAEA,mBAEA,2BACA,CACA,IACA,yBACA,CACA,IACA,EACA,wBACA,OACA,6CACA,aASA,IACA,iBACA,2CAEA,0BAEA,SACA,GACA,aACA,QACA,YACA,CAnBA,kCAEA,8CAGA,QAEA,GAaA,EACA,2BACA,CACA,SACA,wBACA,OACA,UACA,+BACA,6BACA,cACA,2BACA,OACA,UACA,mCACA,CACA,SAIA,OAEA,cACA,QACA,eAEA,8BAA4D,OAAwB,MACpF,EAMA,0DAAoE,OACpE,qEACA,qBACA,kBAGA,KACA,iBAGA,WAIA,aAEA,WAIA,OAEA,KACA,kBACA,aACA,2BACA,cAEA,GACA,EACA,CACA,8BAOA,oBACA,0CACA,OACA,mCAgBA,aAqEA,mCAEA,UAGA,mBAEA,4CASA,WAGA,WACA,kBAEA,8BAGA,CAEA,OADA,kCAEA,oBACA,QACA,SACA,gCAEA,+BAGA,MACA,EA7BA,CACA,QAIA,cAUA,YAgBA,uDAAoE,UAEpE,mCAAkI,8DAElI,oBAAwD,CAAoB,QAAE,oBAG9E,aAGA,wCAA+D,CAAU,QACzE,EAAiB,oBACjB,UACA,WACA,KACA,EACA,EACA,UA3HA,qBACA,uBACA,aACA,mDACA,OAIA,wBACA,wBACA,UACA,uCACA,mFACA,QAIA,cACA,MACA,sBACA,MAEA,uCACA,qCAEA,iBACA,OAEA,OAGA,sCAGA,kHACA,QACA,4BAEA,OAGA,sCACA,WAEA,uCAEA,YAEA,WAEA,KACA,CACA,SACA,OACA,gCAAuE,CAAW,IAClF,GACA,KAEA,OACA,kBACA,WAIA,gCAAmD,WAA6C,aAChG,MACA,aA0DA,wBAEA,KACA,6CAEA,yBACA,MAQA,gBA2DA,uBACA,oBACA,kBACA,eACA,QACA,6BAA0C,UAA8C,eAAE,EAAG,sBAC7F,0BACA,QACA,2BACA,YACA,iBAMA,wBALA,KACA,4DACA,oDACA,iBACA,IAKA,mBACA,uBACA,4BACA,eACA,6CACA,SACA,iBACA,+BACA,yBACA,QACA,IAAa,GACb,OACA,mBACA,IACA,gCACA,WACA,wCAEA,WACA,SAEA,mBACA,cACA,eAIA,6EACA,UACA,6BAAuD,OAAyC,wBAChG,+BAAyD,OAAuC,gBAChG,EAAa,GACb,SAGA,cACA,cACA,sCAAqE,OAAwB,KAE7F,oEACA,uDAGA,wBACA,kCAAqE,OACrE,OACA,YACA,wBAAgD,UAChD,WAAkD,IAClD,KACc,GAAE,QAChB,WACA,SACA,iCACA,mBACA,IACA,gBACA,yBACA,GACA,mBACA,4BACA,QACA,oBACA,4BACA,SACA,mBACA,4BACA,QACA,oBACA,4BACA,SACA,oBACA,4BACA,MACA,kBACA,4BACA,OACA,qBACA,4BACA,UACA,qBACA,yBACA,sBAEA,OACA,yBACA,oBACA,MACA,0BAQA,aACA,oCAGA,cAEA,oBAGA,oCACA,IACA,GAEA,+BAEA,kBACA,WACA,UACA,MACA,IACA,SAAmC,CACnC,CACA,QACA,EAMA,mBALA,oDAEA,sBACA,qBACA,cAEA,yBAOA,2BACA,iBACA,wBACA,2BACA,4CACA,GACA,cAGA,GACA,WACA,OACA,SACA,wBAAuC,CAEvC,EACA,uBACA,OACA,6CACA,wCACA,gCACA,+EACA,wCACA,mFACA,oCACA,2DACA,mBACA,sBACA,CACA,aAEA,qDACA,wBACA,kBACA,8DAIA,GACA,qBAAuD,OAAO,IAC9D,+BACA,QAIA,oBACA,mBACA,KACA,KACA,sCAAiG,cAA0C,QAE3I,yBAAwG,oBAAyC,KACjJ,KAEA,2CAGsF,OAAoB,QAAE,qBAC5G,mBACA,yBACA,IAAyB,sBACzB,KACA,QAAyB,kBAEzB,mBAEA,cAAkE,IAAQ,KAC1E,MACA,eACA,eACA,WACA,QACA,eAOA,gBACA,eACA,YACA,YAAyB,mBAEzB,kBACA,SACA,YACA,KA9BA,wCAgCA,cACA,UACA,GAAqB,GACrB,QACA,CAAa,EACb,SACA,uBACA,iCACA,+CACA,cASA,CACA,aAEA,qDACA,wBACA,wCAbA,gCACA,+EACA,wCACA,mFACA,oCACA,2DACA,mBACA,kBAOA,sBAKA,iBACA,QACA,cACA,kBACA,iBAA2D,OAAO,QAClE,GAAuC,wBACvC,eACA,sCACA,uBAEA,eACA,KAGA,UAGA,iBACA,oBACA,eACA,MACA,YACA,cAEA,aACA,CAAqB,aACrB,CAEA,mBADA,YAEA,aACA,sBACA,KACA,KAIA,GACA,qBAAuD,OAAO,IAC9D,+BACA,QAIA,oBACA,mBACA,KACA,CACA,EACA,mBAMA,0BACA,+CACA,OAA+B,wBAC/B,eACA,+BACA,sBACA,uBACA,YACA,cAEA,WAEA,IACA,IACA,iBACA,oBACA,qBACA,gCAGA,SAEA,WACA,SACA,IACA,EACA,SACA,CAGA,QAFA,WACA,YAEA,CACA,EACA,mBACA,OAMA,oDACA,qBAKA,2BACA,wBACA,eACA,cAIA,UACA,8BACA,kDAGA,MACA,OAAqB,mBAAyB,gBAAyD,UACvG,EAAiB,EACjB,UAGA,yCACA,oBACA,4BACA,gCACA,SAEA,0BACA,YACA,OACA,EAEA,EACA,oBAEA,uCAGA,mCAIA,0CACA,SACA,oBACA,+BACA,KACA,OACA,EAEA,EACA,kBACA,uCAGA,2BAGA,0CACA,SACA,kBACA,+BACA,KACA,OACA,EAEA,EACA,sBACA,wBACA,mCACA,kEAEA,0BACA,OACA,KACA,iCACA,eACA,sCACA,8EACA,SAGA,oCAEA,SASA,kBA0CA,iBACA,cAEA,eACA,iCACA,yBACA,MACA,IACA,oBACA,UACA,QACA,2BACA,yBACA,oDACA,0BACA,WACA,WACA,GACA,SAA+B,CAC/B,CAEA,OACA,KACA,oBAWA,0CACA,IACA,oBACA,OACA,cACA,WACA,iBACA,cACA,kBACA,UAEA,mCACA,uBAEA,6CACA,YAEA,qBAGA,yBACA,oBACA,6BACA,2FACA,8BACA,CACA,kBACA,MACA,2BACA,CACA,yCACA,UACA,wBACA,OACA,6BACA,GACA,YACA,UACA,GACA,IACA,0BACA,OACA,qBACA,oCACA,qCACA,wBACA,6BACA,oCACA,iCACA,mBACA,SACA,MAEA,GACA,yBACA,0BACA,GACA,cACA,cACA,QACA,SACA,GAGA,2BAH2C,UAAwB,SACnE,KACA,SAIA,4BACA,OACA,cACA,QACA,SACA,GAGA,SAFA,SAGA,kBACA,wCACA,IACA,qBAEA,YAGA,eACA,aAEA,uDAAsE,CAAgB,QAEtF,OAEA,GACA,8BAEA,6CACA,iBACA,SACA,2BACA,wBACA,YACA,+BACA,YACA,IACA,SACA,sCACA,mBAA6C,uCAA+D,SAAE,aAAkB,uCAA8D,SAAE,qBAChM,GAEA,gCAEA,KACA,EACA,EAIA,kBACA,kCACA,YACA,SACA,SACA,sCAA+D,CAAkB,SAEjF,qBACA,UACA,iCACA,KASA,4BAYA,kBACA,OACA,eAEA,WAEA,kCADA,eAEA,cACA,0BAA4D,gBAA6B,GAAE,SAC3F,EACA,cACA,6BAAkD,UAAwB,aAAE,aAAiB,UAAwB,aACrH,CACA,cACA,6BAAkD,UAAwB,aAAE,aAAiB,UAAwB,aACrH,CACA,wBACA,yBACA,WACA,IAA2B,IAAY,QACvC,MACA,SACA,WACA,8CACA,GACA,6CACA,GACA,mCACA,GAEA,KACA,cACA,IACA,oBACA,wBACA,oBACA,wBACA,+CACA,EACA,oBAEA,cAKA,GACA,OACA,OACA,wCACA,OAA4B,kBAC5B,KAAiB,qBACjB,oBACA,MACA,sBAA+D,UAAiB,KAChF,sBAA+D,UAAiB,KAChF,GACA,iBACA,IACA,SAjBA,4CAA6C,OAA8B,kBAC3E,SAEA,WAeA,gCACA,0BACA,KACA,mCAEA,CACA,IACA,QACA,EA+BA,sCA3BA,SACA,OACA,mBACA,eACA,QACA,SAGA,mBACA,KAAqD,MAAgB,IACrE,iBACA,oBACA,aACA,aACA,YAGA,KAQA,MAPA,UAKA,iBAL6C,YAAuD,IAGpG,KAKA,IAKA,OACA,0BASA,GACA,SACA,UACA,OACA,iCACA,QACA,2BAA6D,wBAAsE,GACnI,EACA,SACA,UACA,QACA,CACA,oBACA,6BAAyD,WAAgC,OACzF,EACA,mBACA,6BAAyD,WAA4C,gBACrG,EACA,0BACA,6BAAyD,WAAsC,aAC/F,EACA,mBACA,6BAAyD,WAA4C,gBACrG,EACA,0BACA,6BAAyD,WAAsC,aAC/F,EACA,wBAEA,OACA,kCAEA,cADA,QAEA,kCAEA,OACA,YACA,kCAAqE,OAA8B,oBAAE,EACrG,OACA,8BAEA,4BAAqE,cAAmB,EAAE,MAC1F,GACA,4BACA,kBACA,iBACA,gBACA,0BAAqE,QAA4B,gBAAE,IACnG,GACA,sCACA,kBACA,iBACA,gBACA,0BACA,0BACA,OACA,iBACA,EACA,OACA,kBACA,kBACA,WACA,QACA,GACA,OACA,SACA,UACA,QACA,IACA,sBACA,iCAA0D,iCAAuD,GACjH,mCACA,GACA,mBACA,OACA,QACA,EAsBA,sCArBA,aACA,IAEA,gBACA,UAEA,OAIA,MAHA,eASA,6BAA6C,YAAyB,KAGtE,MACA,IAEA,sBACA,wCAA4E,kBAC5E,kBACA,mBACA,kBACA,cACA,0BACA,SACA,GACA,QACA,SACA,UACA,QAEA,6BAA6D,4CAA4E,OAAE,EAC3I,gCACA,0BAAgD,kBAChD,kBASA,0BACA,gBAQA,iBAAsD,SAAO,IAC7D,SACA,oCACA,gBACA,mBACA,IACA,KAEA,CAGA,MAFA,UACA,SAEA,gBAC4C,iBAAkC,GAE9E,cAgBA,eACA,IACA,IAxCA,sBACA,6BAAoD,sCAA+F,gBACnJ,iJAEA,kCACA,0BACA,cAcA,KAGA,KACA,cACA,MACA,OACA,SACA,UACA,QACA,OACA,IACA,aAAoC,OAAsC,gBAC1E,aAAoC,OAAuC,iBAC3E,IACA,aAAoC,OAAuC,gBAC3E,aAAoC,OAAwC,iBAC5E,EAIA,2BACA,6CACA,GACA,GA2CA,uCA1CA,CACA,YACA,IAGA,OACA,IAEA,QACA,OACA,iCACA,aACA,IAEA,SACA,UAEA,OAIA,MAHA,iBAOA,wBAOA,+BACA,CACA,uBAEA,oBACA,GAGA,MACA,IAEA,4BACA,kBACA,qCAA6C,OAA8B,kBAC3E,GAGA,eACA,uCACA,UACA,KACA,WALA,4CAOA,EAQA,2BA2CA,gBACA,eACA,SACA,kBACA,SACA,wCAAmD,eAAmC,IACtF,mBACA,EACA,gBACA,gBACA,UAQA,gBACA,MACA,UACA,0CACA,UACA,qEACA,oCACA,KAUA,gBACA,OACA,0BACA,0DACA,2CACA,OACA,sBACA,sDACA,SACA,aAIA,aAGA,CACA,QACA,GACA,kBACA,mBACA,SACA,aACA,KACA,oCACA,gBACA,SACA,QAEA,SACA,CACA,OAjBA,KACA,OAiBA,4DACA,YACA,oDAtBA,YAuBA,OAIA,oBACA,YACA,cACA,yCACA,gCACA,OACA,oBACA,YACA,cACA,yCACA,+BACA,SACA,2BACA,YACA,sBACA,YACA,4BACA,eACA,aACA,mBACA,sEAEA,MAGA,UAFA,SACA,QAEA,gBACA,8BACA,KACA,IAIA,kBACA,YACA,sCACA,CACA,YACA,EACA,mBACA,YACA,QAEA,yCACA,OACA,oCACA,kBACA,6BACA,wBACA,OACA,CAIA,WACA,mCACA,eAA+C,CAAuB,MAAd,MAAgB,YAAe,CAAgB,IACvG,MAEA,IACA,sBAEA,gBAGA,sBACA,GACA,IACA,gBAEA,gBACA,2BACA,CACA,gDAVA,8BAMA,iCAKA,UACA,OAAiB,GACjB,OACA,qBACA,YACA,sCACA,2CAGA,4BACA,OACA,iBACA,4BACA,kBACA,iBACA,kBACA,MACA,oBACA,IACA,KACA,OACA,SACA,CACA,IACA,CACA,EACA,KAEA,OACA,kBAAmD,GAAc,OAAE,YACnE,CACA,IACA,MACA,CACA,IACA,oBACA,YACA,WACA,MACA,QACA,UACA,mBACA,IACA,yBACA,OAEA,SACA,OAGA,qBACA,GACA,aACA,CAEA,OACA,CAGA,iBACA,IACA,sBAA4C,OAA2B,MACvE,CAEA,GACA,KACA,mBACA,qCACA,+BACA,IACA,2BACA,OACA,SACA,KACA,IACA,CACA,MACA,IACA,qBACA,mCACA,YACA,SAMA,OACA,GACA,IACA,mBACA,yCAA2D,UAAa,EAAE,GAC1E,OACA,kBACA,uBACA,QACA,oBAEA,+BACA,YACA,MAGA,UACA,QACA,IACA,iBACA,aACA,SACA,gBACA,gCACA,KACA,oBACA,oDACA,YACA,sDACA,KACA,IACA,iBACA,aACA,SACA,qBACA,YACA,0BACA,+BAAyD,KAAwB,MACjF,EACA,2BACA,yBACA,cACA,UACA,4BACA,YACA,0BACA,+BAAyD,KAA+B,aACxF,EACA,kBACA,YACA,mBACA,cACA,iCACA,UACA,IAAiB,kBACjB,CACA,QAAiB,GACjB,OACA,yBACA,YACA,qCAGA,2CACA,OACA,iBACA,gCACA,sBACA,iBACA,kBACA,KAAqB,GAErB,sBACA,cACA,iCACA,UACA,WAAiB,kBACjB,CACA,QAAiB,GACjB,OACA,wBACA,yBACA,cACA,OACA,sBACA,sCAAwD,UAAa,EAAE,GACvE,OACA,qBACA,uBACA,WACA,qBACA,uDACA,iBACA,YACA,YACA,iCACA,oBACA,aACA,aACA,SACA,EACA,GACA,IAIA,oBACA,sEACA,yCACA,gBA+EA,cAQA,CAIA,SAHA,iBACA,SACA,MAEA,KAZA,iBACA,WACA,WACA,kBACA,aAEA,4BAOA,YACA,SACA,gBACA,+BACA,SACA,qBACA,+BACA,CACA,IACA,GACA,EACA,IACA,QAEA,yBAEA,MACA,cAEA,cACA,UAEA,iBACA,6CACA,aACA,QACA,aACA,WAEA,IAEA,KACA,IA5HA,MAEA,8BAQA,mBACA,OACA,2BACA,MACA,oBAEA,0BAEA,iBAEA,gBACA,4BAGA,wBACA,+BACA,OACA,KAEA,GACA,CAGA,gBAEA,OACA,UACA,oBACA,QACA,QAA2C,EAAa,QACxD,cACA,KACA,aACA,SAEA,KACA,CACA,QACA,CACA,KAGA,IACA,OACA,kBACA,IACA,mCAEA,QAWA,UAVA,gCACA,OACA,KACA,aACA,SAEA,KAEA,SACA,OAEA,CACA,OACA,IACA,EACA,OACA,KACA,KACA,0CAgDA,CACA,KACA,GACA,MACA,EACA,mBACA,OACA,0DACA,SACA,IACA,yBAKA,sCAEA,8BACA,UACA,gCACA,SACA,mBACA,uBACA,UACA,gCAAgE,OAAuB,KACvF,CAA6B,aAAkB,OAAoB,KACnE,EACA,CAMA,eACA,wCACA,OAEA,IACA,QACA,sBAEA,KACA,WACA,SACA,QAGA,eAAiD,8BAGjD,wBACA,OAAqB,eAErB,UACA,WAAqB,kBAErB,OACA,uBAA+D,kBAA8B,GAC7F,KACA,SACA,YAAqB,kBACrB,SACA,aACA,QACA,SACA,GAAuB,EACvB,IACA,IACA,EAEA,EAQA,UAqKA,CACA,aACA,QACA,cACA,UAEA,0BAzhFA,kCAKA,CACA,sFAEA,mHACA,uDAOA,OACA,8BACA,+BACA,kDAEA,oHACA,GACA,EAQA,CA2/EA,yBACA,CACA,KACA,GACA,cACA,IACA,2BAEA,UACA,kBAEA,8BACA,OACA,GAEA,MADA,UAGA,CAEA,SACA,gBACA,CAKA,gCAJA,UACA,MACA,MACA,KAEA,cAUA,sBACA,oBACA,sBACA,cACA,aACA,QACA,IACA,KACA,cACA,sBACA,CAGA,MAFA,kBACA,SAEA,GACA,cACA,sBACA,YACA,OACA,GACA,cACA,sBAEA,8BACA,gBACA,QAIA,UAHA,KACA,MACA,OAEA,GACA,cACA,GACA,mBACA,oBACA,kBACA,iBACA,cACA,cAEA,mBACA,gBACA,eACA,UACA,4BAEA,mCADA,IAEA,CACA,kBAVsC,UAA8B,OAAE,WACtE,aADoG,UAA8B,QAAE,SAWpI,OAGA,CACA,0BAQA,MACA,YACA,eACA,cACA,aACA,YACA,gBACA,+DACA,2CACA,KAGA,CACA,oBAKA,MACA,uBACA,wBACA,aACA,oCACA,mCAA8D,UAA4B,OAC1F,GACA,cACA,uBACA,KACA,cACA,iCACA,oCACA,OACA,iBAlpIA,EAaA,mBACA,cACA,sEAEA,OADA,eAWA,kBAAgB,0GAiKhB,wKAAmE,6CAAmD,YAA0B,OAAI,EAAE,uBAAyB,OAAmB,MAAE,kBAAoB,OAAmB,MAAE,yCAoD7O,0BACA,IACA,gCACA,QAAC,YAAgB,OAAa,KAC9B,KAQA,MAoCA,4GAKiC,CAAa,QAC9C,6BAyDA,CACA,UACA,aACA,OACA,sBACA,WACA,UACA,WACA,eACA,gBACA,QACA,UACA,gBACA,SAEA,gBAjCA,CACA,SACA,OACA,aACA,gBACA,SACA,UACA,eACA,aACA,iBACA,kBACA,iBACA,cACA,WACA,iBACA,kBAEA,gBAiBA,cACA,gBACA,uEACA,iCACA,0CAIA,+CAWA,wBACA,OACA,eACA,aACA,2DACA,GAEA,sBAA2B,4BAAwC,OAClE,IAiBD,aAOA,KAQA,sCAAsD,eAA0C,SAAE,EAElG,IAEA,+BAOA,gBAEA,SACA,SAEA,SAIA,yBACA,wBAEA,MACA,+CACA,aAEA,uBAVA,oBAEA,KASA,SAhBA,QAmBA,YAFA,SACA,QACC,EACD,IACA,sBACA,kBACA,SACA,yCACA,CAEA,oBADA,OACC,EAAI,8BAcL,CAGA,OAFA,wDACA,QACC,EAAI,IACL,iBACA,gBACA,sBAoIA,MACA,OAEA,eACA,IAEA,qBACA,kGACA,SACA,UACA,cACA,8BACA,WACA,EACA,CACA,UACA,SACA,SACA,aACA,eACA,kBACA,OACA,IAQA,SACA,aAAiB,IAA0C,OAE3D,KAEA,+BACA,WAEA,2BACA,8BACA,sCACA,CACA,MACA,IAAqB,aAAuB,CAC5C,mCACA,IAIA,YAA6B,cAA6B,EAM1D,kBACA,SAEA,YACA,KAEA,MACA,EACA,MACA,SACA,MACA,MACA,KACA,QACA,IACA,SACA,cACA,aACA,GACA,eACA,WACA,sBACA,oCACA,IACA,WACA,GACA,SAAuB,CACvB,CACA,EAEA,GACA,SACA,MACA,KAAwB,MAsCxB,eACA,gBAEA,OACA,2BAEA,WACA,8BACA,qBACA,iBACA,GAEA,eADA,OAEA,UAXA,KAaA,SADA,cAIA,iBACA,oBAEA,kBACA,eACA,CACA,QACA,SAEA,KACA,GACA,cACA,CACA,2BAEA,mBACA,aACA,mBACA,IACA,sCAEA,uCACA,wDAGA,4BACA,KACA,6BAIA,2BACA,KACA,EACA,qBACA,6BACA,CAEA,MADA,MACS,aACT,OACA,KACA,KACA,EACA,QACA,eACA,SACA,mBACA,UACA,CACA,mBACA,GAhMA,aAiMA,qBAGA,MAFA,2BACA,WAEA,QACA,CACA,KACA,CAEA,wBACA,OACA,cACA,4BACA,4BAAqD,iBAA4C,WACjG,2CACA,QAAa,GACb,IAEA,uCACA,8CAEA,WACA,YASA,IACA,eACA,oBACA,WACA,kCACA,CACA,gBACA,YACA,8BAA4C,qCAC5C,CACA,OACA,KACA,IAAuB,IACvB,EACA,EACA,qBACA,IACA,eACA,eACA,oDACA,GACA,SACA,SACA,eAEA,MADA,UAEA,EACA,yBACA,+BACA,kCACA,kBAAyC,qBAAqD,SAC9F,EACA,EACA,MACA,eAA0B,CAAY,SACtC,iBAA+B,OAAoB,KAInD,GACA,UACA,oBACA,eAA0B,CAAe,SACzC,iBAA+B,CAAgB,IAE/C,mBACA,eAA0B,CAAwB,SAClD,iBAA+B,CAAyB,IAExD,uBACA,2BACA,wBACA,IACA,mBACA,KACA,qCACA,OAIA,kBACA,4CACA,GACA,EAAiB,IACjB,UACA,GACA,QACA,EAOA,WAwQY,sBACZ,MACA,KACA,MACA,KACA,8CA+RA,YACA,yBAA2B,IAC3B,0BACA,MACA,IACA,QACA,CACA,SAAC,CACD,QACA,YACA,uGACA,sBACA,0EACA,WACA,MACA,oBAA8C,qCAAkD,OAChG,EACA,GACA,SAmsFA,SACA,KAIA,mBACA,qBACA,SAKA,8BAJA,aACA,aACA,IACA,GAKA,oBACA,yCACA,CAEA,SADA,UACS,0CAAgD,CAAc,QACvE,EAIA,8BACA,0BACA,uCACA,OACA,2BACA,qBACA,GACA,YACA,KAAS,qCACT,cACA,wBAEA,CAOA,kBAHA,MACA,OACA,CAEA,EACA,+CAsBA,WACA,YACA,aACA,GACA,iBASA,qBACA,WACA,cACA,GACA,EACA,mBACA,kBACA,IACA,uBACA,sBACA,8BAEA,UACA,SACA,OACA,MACA,CACA,CACA,uBACA,IACA,uBACA,eACA,8BAEA,UACA,SACA,OACA,MACA,CAEA,qBACA,eAA0B,kBAA0B,IAEpD,wBAEA,yCACA,mCAGA,8BACA,YAEA,EAKA,gBACA,eAA0B,CAAc,SACxC,iBACA,2BAA6D,CAAa,QAC1E,KAGA,GACA,SACA,SACA,QAEA,WAEA,UACA,eACA,eACA,eACA,eACA,YACA,gBACA,OACA,UAEA,iBAEA,GACA,mCACA,OAEA,YACA,aASA,sCACA,IACA,OAEA,iEACA,2CAEA,kBACA,SACA,OACA,WACA,iBAEA,KACA,CAEA,IACA,2BACA,oBAA2B,OAAoB,YAC/C,yBAAoC,wBAAsC,IAI1E,GAMA,WAEA,WACA,EACA,kBACA,uBACA,qBAA6B,SAAkB,mBAG/C,OACA,yBACA,kCAEA,wDACA,yBAA0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OACjC,WAwBD,E,uBAIE,uBAEA,MAAM,GAAmB,GAAI,KAAI,CAAC,EAElC,IAAM,EAAO,CAAC,OAAoB,GAAZ,CAAoB,KAE1C,IAAM,CAAE,UAAW,KAAM,GACvB,mBACA,EAAW,KAMb,8BACD,0BClED,CA0BA,eACA,IACA,mBAEA,6BACA,yBAEA,qCACA,SAEA,SADA,SAKA,CAIA,aACA,kBACA,aAIA,uBACA,+BACA,0BACA,wBAGA,+BACA,+BACA,IAEA,yBACA,uCAGA,SACA,GA/DA,QACA,SACA,SAEA,KACA,uBACA,kBACA,iBAEA,EACA,oCAEA,UAEA,OAEA,QAEA,EACA,sCACA,oBACA,2EACA,MAkBA,uBAwBA,0BAEA,sCAEA,MAEA,cACA,cACA,iBACA,aAGA,YAGA,kBAGA,+BAGA,gEACA,cAGA,QACA,2EACA,KAGA,oCACA,sDACA,6BACA,MAEA,uCAEA,iCACA,wBAEA,kCACA,6CAEA,OACA,KAIA,qCAHA,GACA,kBACA,EAGA,CACA,CACA,KAEA,8BACA,sCACA,IAEA,EACA,mCACA,4BACA,0CAEA,eAKA,cAEA,+BC1JA,aAEA,2BACA,UACA,UACA,oBCJA,aACA,qBACA,IACA,yCACA,eACA,cAAK,SACL,WACA,UAEA,WACA,6BCTA,wCACA,QACA,QAEgB,GAkEhB,UACA,CACA,aAtDA,WACA,iFACA,eAGA,6BACA,sFACA,OACA,wBACA,SACA,0BACA,OACA,oBACA,OACA,mBACA,SACA,iBAMA,4BAiCA,iBApEA,UACA,sFACA,eAGA,6BACA,iCACA,+EACA,eACA,qBACA,aACA,kCA0DA,iBAhCA,WACA,IACA,yBACG,6BACH,sBAEA,wCAEA,wDAyBA,aAvBA,iBAEA,eACA,SACA,+BACA,gBACA,MACA,KACA,EAEA,KAcA,iBAZA,eACA,sBACA,eACA,qBACA,gCCpEA,aAGA,aACA,4CACA,kBACA,GACA,IAIA,WATA,iBAiBA,UACA,CACA,cACA,iBATA,WACA,SACA,0BACA,MACA,2BCnBA,aAEA,UACA,YACA,mBCJA,kB,uBCAA,kB,2BCAA,aAEA,YAEA,UAEA,WACA,cA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W,gBAChB,OAAW,OACT,GACA,GAGH,uTACM,WAAW,cAChB,OAAW,OACT,GACA,GAGH,uTACM,WAAW,OAChB,OAAW,OACT,GACA,GAGH,yFACM,WAAW,UAChB,OAAW,OACT,GACA,GAGH,uHACM,WAAW,oBAChB,OAAW,OACT,GACA,GAGH,oNACM,WAAW,aAChB,OAAW,OACT,GACA,GAGH,4IACM,WAAW,OAChB,OAAW,OAAc,EAAG,GAC7B,cACM,WAAW,YAChB,OAAW,OACT,GACA,GAGH,6ZACM,WAAW,WAChB,OAAW,OACT,GACA,GAGH,sZACM,WAAW,kBAChB,OAAW,OACT,GACA,GAGH,qLACM,WAAW,eAChB,OAAW,OACT,GACA,GAGH,sRACM,WAAW,oBAChB,OAAW,OACT,GACA,GAGH,uJACM,WAAW,gBAChB,OAAW,OACT,GACA,GAGH,0JACM,WAAW,eAChB,OAAW,OACT,GACA,GAGH,6LACM,WAAW,OAChB,OAAW,OACT,GACA,GAGH,0KACM,WAAW,YAChB,OAAW,OACT,GACA,GAGH,gIACM,WAAW,cAChB,OAAW,OACT,GACA,GAGH,sIACM,WAAW,eAChB,OAAW,OACT,GACA,GAGH,2JACM,WAAW,cAChB,OAAW,OACT,GACA,GAGH,iHACM,WAAW,cAChB,OAAW,OACT,GACA,GAGH,yHACM,WAAW,WAChB,OAAW,OACT,GACA,GAGH,yHACM,WAAW,MAChB,OAAW,OACT,GACA,GAGH,iNACM,WAAW,OAChB,OAAW,OACT,GACA,GAGH,sJACM,WAAW,aAChB,OAAW,OACT,GACA,GAGH,0MACM,WAAW,WAChB,OAAW,OACT,GACA,GAGH,0LACM,WAAW,gBAChB,OAAW,OACT,GACA,GAGH,oHACM,WAAW,YAChB,OAAW,OACT,GACA,GAGH,yHACM,WAAW,UAChB,OAAW,OACT,GACA,GAGH,w1BACM,WAAW,gBAChB,OAAW,OACT,GACA,GAGH,uLACM,WAAW,uBAChB,OAAW,OACT,GACA,GAGH,4OACM,WAAW,kBAChB,OAAW,OACT,GACA,GAGH,6NACM,WAAW,UAChB,OAAW,OACT,GACA,GAGH,sOACM,WAAW,QAChB,OAAW,OACT,GACA,GAGH,2XACM,WAAW,OAChB,OAAW,OACT,GACA,GAGH,mNACM,WAAW,OAChB,OAAW,OACT,GACA,GAGH,mVACM,WAAW,OAChB,OAAW,OACT,GACA,GAGH,8pBACM,WAAW,OAChB,OAAW,OACT,GACA,GAGH,2MACM,WAAW,aAChB,OAAW,OACT,GACA,GAGH,uPACM,WAAW,YAChB,OAAW,OACT,GACA,GAGH,8oBACM,WAAW,YAChB,OAAW,OACT,GACA,GAGH,4NACM,WAAW,aAChB,OAAW,OACT,GACA,GAGH,6gBACM,WAAW,WAChB,OAAW,OACT,GACA,GAGH,8lBACM,WAAW,iBAChB,OAAW,OACT,GACA,GAGH,+jBACM,WAAW,QAChB,OAAW,OACT,GACA,GAGH,4tDACM,WAAW,UAChB,OAAW,OAAc,EAAG,GAC7B,2CACM,WAAW,QAChB,OAAW,OACT,GACA,GAGH,kEACM,WAAW,QAChB,OAAW,OACT,GACA,GAGH,+RACM,WAAW,UAChB,OAAW,OACT,GACA,GAGH,gPACM,WAAW,OAChB,OAAW,OACT,GACA,GAGH,2HACM,WAAW,iBAChB,OAAW,OACT,GACA,GAGH,mGACM,WAAW,QAChB,OAAW,OACT,GACA,GAGH,qUACM,WAAW,QAChB,OAAW,OACT,GACA,GAGH,iQACM,WAAW,OAChB,OAAW,OACT,GACA,GAGH,kgBACM,WAAW,cAChB,OAAW,OACT,GACA,GAGH,2QACM,WAAW,cAChB,OAAW,OACT,GACA,GAGH,qLACM,WAAW,gBAChB,OAAW,OACT,GACA,GAGH,iXACM,WAAW,SAChB,OAAW,OACT,EACA,GAGH,mIACM,WAAW,SAChB,OAAW,OACT,GACA,GAGH,wlBACM,WAAW,kBAChB,OAAW,OACT,GACA,GAGH,gIACM,WAAW,gBAChB,OAAW,OACT,EACA,GAGH,gIACM,WAAW,MAChB,OAAW,OACT,GACA,GAGH,uVACM,WAAW,WAChB,OAAW,OACT,GACA,GAGH,gXACM,WAAW,MAChB,OAAW,OACT,GACA,GAGH,oXACM,WAAW,YAChB,OAAW,OACT,GACA,GAGH,qcACM,WAAW,OAChB,OAAW,OACT,GACA,GAGH,gVACM,WAAW,eAChB,OAAW,OACT,GACA,GAGH,+HACM,WAAW,cAChB,OAAW,OACT,GACA,GAGH,syBACM,WAAW,gBAChB,OAAW,OACT,GACA,GAGH,kgBACM,WAAW,WAChB,OAAW,OACT,GACA,GAGH,qRACM,WAAW,OAChB,OAAW,OACT,GACA,GAGH,yOACM,WAAW,WAChB,OAAW,OACT,GACA,GAGH,23BACM,WAAW,aAChB,OAAW,OACT,GACA,GAGH,oyDACM,WAAW,OAChB,OAAW,OACT,GACA,GAGH,uKACM,WAAW,WAChB,OAAW,OACT,GACA,GAGH,qRACM,WAAW,aAChB,OAAW,OACT,GACA,GAGH,6jBACM,WAAW,WAChB,OAAW,OACT,GACA,GAGH,8MACM,WAAW,YAChB,OAAW,OACT,GACA,GAGH,4VACM,WAAW,UAChB,OAAW,OACT,GACA,GAGH,+iBACM,WAAW,YAChB,OAAW,OACT,GACA,GAGH,+FACM,WAAW,SAChB,OAAW,OACT,GACA,GAGH,0KACM,WAAW,cAChB,OAAW,OACT,GACA,GAGH,ybACM,WAAW,OAChB,OAAW,OACT,GACA,GAGH,kPACM,WAAW,YAChB,OAAW,OACT,GACA,GAGH,gQACM,WAAW,OAChB,OAAW,OACT,GACA,GAGH,wIACM,WAAW,WAChB,OAAW,OACT,GACA,GAGH,8kBACM,WAAW,eAChB,OAAW,OACT,GACA,GAGH,4ZACM,WAAW,UAChB,OAAW,OACT,GACA,GAGH,uUACM,WAAW,WAChB,OAAW,OACT,GACA,GAGH,8gBACM,WAAW,SAChB,OAAW,OACT,GACA,GAGH,4HACM,WAAW,SAChB,OAAW,OACT,GACA,GAGH,wNACM,WAAW,MAChB,OAAW,OACT,GACA,GAGH,2JACM,WAAW,OAChB,OAAW,OACT,GACA,GAGH,kIACM,WAAW,OAChB,OAAW,OAAc,GAAI,GAC9B,+BACM,WAAW,YAChB,OAAW,OAAc,EAAG,GAC7B,gCACM,WAAW,eAChB,OAAW,OACT,EACA,GAGH,sDACM,WAAW,kBAChB,OAAW,OAAc,EAAG,GAC7B,eACM,WAAW,UAChB,OAAW,OACT,GACA,GAGH,yIACM,WAAW,QAChB,OAAW,OACT,GACA,GAGH,kFACM,WAAW,WAChB,OAAW,OACT,GACA,GAGH,+SACM,WAAW,QAChB,OAAW,OACT,GACA,GAGH,2VACM,WAAW,aAChB,OAAW,OACT,GACA,GAGH,+8BACM,WAAW,QAChB,OAAW,OACT,GACA,GAGH,wEACM,WAAW,OAChB,OAAW,OACT,GACA,GAGH,kMACM,WAAW,YAChB,OAAW,OACT,GACA,GAGH,0RACM,WAAW,gBAChB,OAAW,OACT,GACA,GAGH,8JACM,WAAW,aAChB,OAAW,OACT,GACA,GAGH,idACM,WAAW,WAChB,OAAW,OACT,GACA,GAGH,0NACM,WAAW,WAChB,OAAW,OACT,GACA,GAGH,2KACM,WAAW,SAChB,OAAW,OACT,GACA,GAGH,+dACM,WAAW,MAChB,OAAW,OACT,GACA,GAGH,sHACM,WAAW,OAChB,OAAW,OACT,GACA,GAGH,iFACM,WAAW,aAChB,OAAW,OACT,GACA,GAGH,mLACM,WAAW,eAChB,OAAW,OACT,GACA,GAGH,wPACM,WAAW,SAChB,OAAW,OACT,GACA,GAGH,6RACM,WAAW,SAChB,OAAW,OACT,GACA,GAGH,8ZACM,WAAW,WAChB,OAAW,OACT,GACA,GAGH,qRACM,WAAW,SAChB,OAAW,OACT,GACA,GAGH,oNACM,WAAW,SAChB,OAAW,OACT,GACA,GAGH,0JACM,WAAW,UAChB,OAAW,OACT,GACA,GAGH,+IACM,WAAW,SAChB,OAAW,OACT,GACA,GAGH,ywBACM,WAAW,WAChB,OAAW,OACT,GACA,GAGH,kaACM,WAAW,OAChB,OAAW,OACT,GACA,GAGH,+EACM,WAAW,OAChB,OAAW,OACT,GACA,GAGH,yGACM,WAAW,OAChB,OAAW,OACT,GACA,GAGH,wTACM,WAAW,MAChB,OAAW,OACT,GACA,GAGH,6SACM,WAAW,WAChB,OAAW,OACT,GACA,GAGH,wTACM,WAAW,YAChB,OAAW,OACT,GACA,GAGH,mTACM,WAAW,WAChB,OAAW,OACT,GACA,GAGH,6JACM,WAAW,WAChB,OAAW,OACT,GACA,GAGH,uNACM,WAAW,YAChB,OAAW,OACT,GACA,GAGH,kQACM,WAAW,aAChB,OAAW,OACT,GACA,GAGH,qeACM,WAAW,WAChB,OAAW,OACT,GACA,GAGH,4dACM,WAAW,QAChB,OAAW,OACT,GACA,GAGH,waACM,WAAW,WAChB,OAAW,OACT,GACA,GAGH,8MACM,WAAW,eAChB,OAAW,OAAc,GAAI,GAC9B,gBACM,WAAW,eAChB,OAAW,OAAc,EAAG,GAC7B,gBACM,WAAW,gBAChB,OAAW,OAAc,EAAG,GAC7B,iBACM,WAAW,aAChB,OAAW,OAAc,GAAI,GAC9B,mBACM,WAAW,SAChB,OAAW,OACT,GACA,GAGH,0MACM,WAAW,SAChB,OAAW,OACT,GACA,GAGH,qfACM,WAAW,aAChB,OAAW,OACT,GACA,GAGH,orCACM,WAAW,WAChB,OAAW,OACT,GACA,GAGH,wjBACM,WAAW,WAChB,OAAW,OACT,GACA,GAGH,yMACM,WAAW,QAChB,OAAW,OACT,GACA,GAGH,0PACM,WAAW,IAChB,OAAW,OACT,GACA,GAGH,gHACM,WAAW,MAChB,OAAW,OAAc,GAAI,GAC9B,0BAnnCuB,EAA1B,E,+BCLA,aACA,qCAA8C,CAC9C,WACA,MACA,YACA,8BACA,uDACA,qDACA,uDACA,uDACA,sCACA,kCACA,wCACA,gDACA,uDACA,mDACA,kDACA,2DACA,sDACA,2CACA,kDACA,iDACA,6CACA,6DACA,8DACA,oDACA,6CACA,qCACA,yDACA,6DACA,gDACA,0CACA,wCACA,0DACA,iEACA,sDACA,8CACA,6CACA,8CACA,kDACA,+CAEA,wDACA,+DACA,kDACA,6CACA,yDACA,iEACA,iEACA,sEACA,6DACA,sBAAC,6BACD,KACA,kBACA,iGACA,qEACA,2DACA,0EACA,8DACA,yEACA,gGACA,6CACA,gBAA4C,sFAC5C,sDACA,wDACA,wGACA,iFACA,oGACA,2NACA,0JACA,8MACA,6CACA,8EACA,uHACA,0IACA,0FACA,mEACA,uCACA,wFACA,6GACA,mEACA,mDACA,4FACA,mEACA,0EACA,yDACA,4DACA,wDACA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CA,QACA,OAIA,iCAEA,OA0OA,iBACA,YACA,YACA,SACA,MACA,QACA,eAGA,mBAGA,uBACA,MACA,CACA,SAEA,eACA,oBACA,KAEA,YACA,qBACA,IAMA,WALA,WAEA,eAEA,OAGA,aACA,SACA,oBACA,kBAIA,cACA,KACA,OAGA,IAEA,eACA,MACA,SACA,MACA,mBAEA,eACA,qBACA,UACA,aACA,CAEA,CACA,qBACA,MACA,WACA,aACA,cACA,qBACA,EAhdA,EAIA,kBACA,SAGA,SAGA,OACA,0BAEA,iBACA,eACA,MAEA,aACA,OACA,KAGA,UACA,WACA,cACA,wBACA,kBACA,cACA,eACA,sBACA,wBA+CA,wCACA,gBACA,0BACA,UAEA,UACA,YACA,KACA,gBACA,OACA,QACA,EACC,gBAED,+CACA,gBACA,UACA,EACA,gBACA,OACA,QACA,EACC,gBAED,2CACA,gBACA,0BACA,SAEA,GACA,YACA,KACA,gBACA,OACA,QACA,EAGA,gBACA,qDACA,gBACA,CACA,uBAEA,SACA,UACA,kBACA,6BACA,4BACA,gBACA,MAAO,EAEP,SACA,KACA,gBAAoB,eACpB,EACC,gBAED,2CACA,eAAoB,eACpB,EACC,gBAED,8CACA,eAAoB,sBACpB,EACC,gBAED,kCACA,MACA,uBAAwC,OACxC,cACA,OACA,YAEA,KAeA,iCACA,MACA,uBAAwC,OACxC,cACA,OACA,YAEA,KAEA,2BACA,yCACA,UACA,GAAG,EACH,OAEA,6BACA,yCACA,UACA,KAAG,EACH,OAEA,4BACA,CACA,SACA,iBACA,mCACA,iBACA,MAAK,EAGL,cACA,cACA,cACA,GAEA,2BACA,+BACA,OACA,cACA,KACA,QACA,yBAGA,GAAG,oCACH,CACA,QACA,IAEA,8BACA,OACA,UAEA,iCACA,OACA,aAEA,OAEA,eACA,uBAGA,YACA,eAEA,kBAEA,sBACA,aAGA,YAGA,mBAEA,yBACA,aAGA,YACA,WAEA,eAEA,iCACA,WAGA,SACA,MAgCA,kCA9BA,MAGA,gBAEA,OACA,QAEA,gDACA,UAAe,SACf,SACA,wBAEA,QACA,mBAEA,UACA,YAGA,4CACA,aACA,QAEA,IACA,WAEA,SAEA,OAGA,+BACA,MAEA,2BACA,IAEA,+BACA,MACA,QAIA,sBAHA,yBAIA,WAIA,MAcA,MAbA,WACA,qBAIA,SACA,QACA,WACA,qBACA,SACA,cACA,SACA,QAGA,OAGA,iCACA,SACA,SAKA,6BACA,eACA,iCACA,QAEA,WAEA,2BACA,oBACA,8BACA,eAIA,SAEA,2BACA,UACA,YAEA,4BACA,UACA,YAEA,0BACA,eACA,iBAEA,UACA,OAFA,MAIA,2BACA,gBACA,SAEA,4BAEA,MAEA,uBAEA,iBAA8B,EAAQ,SACtC,OACA,YACA,KAEA,qBACK,OACL,OAEA,IACA,oBAEA,IACA,CACA,GAEA,4BACA,OACA,kCACA,CACA,SACA,qBC/YA,aASA,iBACA,IAEA,oBACA,qBACA,aACA,CACA,UACA,OACA,UACA,OAGA,iBAGA,kBACA,CACA,YACA,YACA,wBACE,UAEF,WACA,sBAA4B,kBAC5B,gBACA,OACA,WAIA,UACA,OACA,eACA,KAEA,QAEA,eACA,SAEA,gBAIA,aACA,cAEA,eAEA,QAEA,eACA,CAKA,SAJA,aAGA,QAGA,iBACA,IACA,GAEA,aAQA,QACA,aAGA,UACA,YAGA,OACA,iBAzFA,QACA,SACA,SACA,SACA,SACA,SACA,kBAqFA,yBACA,gCAGA,OAEA,yDAEA,aACA,WACA,WACA,eAIA,cACA,YACA,mBAEA,SAEA,aAEA,4BACA,KAEA,GAvBA,EA2BA,qBAHA,wBAEA,WAGA,2BAEA,wDACA,UACA,MACA,IAEA,2BAEA,wDACA,UACA,MACA,IAEA,6BACA,YACA,cAEA,+BACA,OACA,kCAEA,MAGA,iBADA,yBAGA,8BACA,OAEA,qBACA,2BAGA,uFAEA,MAMA,cALA,wBACA,qBAGA,YAGA,iCACA,oBACA,4BC3KA,aAcA,aAAsC,0BAAuC,CAAgB,WAZ7F,gBACA,mBACA,EAEA,kBAUA,WACA,sBACA,4BAIA,MAFA,gBAIA,IACA,4BAGO,6NACP,yCAEA,sCAEA,OACA,KACA,CAEA,UA7BA,KAEA,SAEA,+EA0BA,iB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,MACA,iBACA,UACA,KAEA,QAAG,KACH,SACA,8BACA,oBAEA,OAEA,uBACA,uBAMA,EACA,0BACA,wBACA,mBAEA,0BACA,2BAMA,EACA,8BACA,oBACA,SAEA,6BCnFA,CA+BA,aACA,OACA,aACA,SACA,CAOA,CACA,aACA,UAEA,QADA,SAEA,CAEA,IAIA,SAvCA,OAGA,IAGA,SAGA,EAOA,IAwBA,oBACA,OACA,KAIA,KAFA,EAGA,KACA,IACA,OAGA,MAEA,WACG,gBAEH,KACA,QAKA,EACA,wBACA,SACA,SACA,IACA,IAEA,IACA,IACA,qBAGA,yEACA,OACA,0DAGA,SACA,KACA,QACA,KACA,IAEA,kBACA,OACA,wBCpIA,CAaA,aAEA,OAEA,iCACA,+CACA,sCACA,mCACA,kBACA,qBACA,4BACA,aAvBA,SACA,aACA,kBASA,YAcA,qBAMA,EACA,EACA,yBACA,SACA,mBACA,QACA,KAEA,eAiCA,gCAhCA,OACA,WACA,QACA,uBAIA,kBACA,4BACA,OACA,kCAGA,oBACA,QACA,sBAGA,gBACA,wBAIA,SACA,aACA,gCACA,SACA,oBACA,WAEA,qBACA,IAYA,EACA,YACA,sBACA,kBACA,qCACA,4BACA,0BAEA,WACA,sBAGA,0BACA,UACA,sBACA,sBAIA,QACA,UACA,oBACA,oBAIA,2BACA,iBACA,uBACA,+BACA,+BACA,OACA,SAEA,QAIA,EACA,YACA,8BACA,IACA,KACA,2CAGA,gBAGA,aAOA,kDACA,gBACA,sEAGA,cAXA,uDAEA,+BACK,kBAyBL,EACA,YACA,8BACA,IAEA,gBACA,IACA,sBAKA,4JACA,IACA,YAEA,YACA,cAIA,qBACA,QAGA,gDACA,uCAEA,6BACA,QACA,sBAEA,iBAEA,4BACA,OACA,8BAEA,SACA,kCAEA,0BACA,wBACA,OACA,wBAGA,MAEA,SACA,kBACA,UAGA,eACA,gBACA,UAGA,MAAK,EACL,WACA,gBAGA,sCACA,SACA,oBACA,UACA,cAEA,WACA,cAEA,oBAEA,sBAAK,EACL,KAYA,EACA,YACA,iBACA,iBAKA,gCACA,mCAOA,2QACA,wBACA,qBAIA,sBACA,6BACA,wBACA,uBAMA,mEACA,CACA,YACA,SACA,WAGA,SAKA,EACA,YACA,6BACA,WACA,IACA,IACA,IACA,IACA,IACA,IACA,oBAMA,kBAA0C,OAL1C,EACA,EACA,EAEA,EACmD,QACnD,MACA,OAEA,KACA,wBACA,IACA,sBACA,IAIA,gBACA,iDACA,IAEA,YACA,GAGA,eAEA,uBAEA,gBACA,2CACA,oBACA,KAGA,+BAEA,sBAEA,gBAEA,sBAEA,eACA,uCACA,kBACA,KAIA,MACA,IAEA,CACA,UAEA,YACA,qCACA,yBACA,UACA,uBAEA,MACA,cAEA,uBACA,gEACA,yBACA,oBACA,IAAK,EACL,KAIA,EACA,YACA,iBACA,OACA,cACA,+BACA,4BACA,wBAEA,sBAWA,MAVA,gCAEA,OACA,2CAEA,kBACA,6EAGA,cAKA,EACA,YACA,mBACA,4BACA,WAEA,qDC9Y2B,aAGzB,IAAI,CAAC,EAAwB,KAAK,KAAQ,EACxC,mBAIF,MAAI,EAAO,WACT,eAIF,WAAM,GAAgB,GAAT,CAqBb,cAAI,CAAC,EAIL,iBAEE,MAAM,GAAM,EAAgB,eAC5B,cAAO,CAAE,IAAK,EAAc,YAC7B,MAJD,CAIS,QAER,CACF,CAGD,CAeyC,eACvC,UAKA,SAAO,EAAQ,EAAO,IAAI,KAA0B,YAAjB,CAApB,IAAyC,KACzD,GAED,CA4BgC,aAC9B,IAAI,GAAS,EASV,mBAAC,EAAM,OAAS,IACjB,aAAS,EAIT,UAIH,OAJU,EAGT,K,uCAvIF,qBACA,OAEA,IAAM,EAAyC,EAC/C,KAAM,EAAmB,EAWzB,KAAM,EAA0B,CAAC,cAAe,WAkD1C,EAAgB,GAEtB,SAIA,GAKA,GAcA,EAcA,iBAdgB,UACd,GAAiB,QACf,aACA,OACA,4BAGF,2BAAM,GAGN,QAAiC,EACjC,oBACD,qBAMD,EAQA,sBARsC,WACpC,OACE,MAAM,EACN,aAAS,EACT,cAEH,wBClHD,aAYA,aAAsC,0BAAuC,CAAgB,WAV7F,EAEA,sBAEA,OAEA,SAEA,YAIA,oBACA,gBACA,OACA,GACA,KACA,KAEA,YACA,4BAAwD,mBAA+B,iBAGvF,cAEA,aAJA,MAIK,SACL,CACA,KACA,GAAK,QACL,IACA,oBACA,WAAO,QACP,MACA,OACA,CAEA,CACA,QAEA,qBACA,UACA,WACK,0BACL,iBAEA,4BAEA,uDACA,CAAC,qBClDD,UAAkB,gB,6CCOlB,YAEA,iEACA,iBACA,iBAEA,YAEA,aAGA,0BACA,wBACA,4DACA,IAEA,OACA,OAEA,eACA,IACA,YACA,aACA,WACA,aACA,aACA,iEAIA,4BAAG,QACH,MACA,aACA,OACA,CAGA,CAKA,aACA,SAEA,oBACA,iCAGA,sCACA,GACA,+CAEA,6CAMA,eACA,OACA,OACA,KAgBA,GAfA,0CACG,qBACH,mDAEA,6BACA,iDACG,4BACH,0DAEA,oCACA,2CACG,sBACH,oDAEA,8BAEA,SACA,SACA,QACA,wBACA,KACA,EACA,8CACA,6BAEA,iCACA,OAEA,6FAEA,WACA,+DACA,cACA,QAEA,GADA,mBAKA,oJAKA,IACA,kDACA,uBAMA,0EACA,IACA,iDACA,OAIA,uHAEA,8BAEA,wCAIA,eASA,YACA,iCAGA,iCACA,WACA,CAEA,CACA,QAEQ,CCjJR,aAEA,IACA,GACA,2BAEA,yBAKA,OAHA,KAHG,oDAQH,kBACA,iBACA,sGACA,uBACA,GACA,oBACA,OACA,KACA,CAEA,gBACA,0FACA,+BACA,OACA,KACA,CAEA,iBACA,SACA,uBACA,sBACA,qBACA,iCACA,0BACA,2CACA,qCACA,oBACA,0BACA,YAEA,eACA,gFACA,MAEA,eAEA,wDAIA,uDACA,OACA,WACA,sBAEA,8CACA,CACA,gCACA,sCACA,sDACA,GACA,SAEA,GACA,GAGA,EACA,OACA,KACA,iBACA,4BACA,mFACA,GACA,8BACA,mCACA,gBAGA,MACA,gBAAuB,MAAwB,OAC/C,8CACA,GACA,2BACA,MACA,KACA,KACA,KAGA,CAEA,OACA,oCACA,wEACA,IAEA,kBACA,6CAEA,gBAAoF,2BACpF,0YACA,qBAEA,cACA,6BAEA,WACA,wBAGA,aACA,wBAEA,0BAGA,qBACA,cACA,CAEA,iBACA,CACA,mBACK,kBACL,0BACA,SACA,kBACA,uBACA,wCAEA,YACA,sBACA,yBACA,2DACA,uCACA,8GACA,oBACA,wBAIA,yEACA,GACA,kBAEA,IACA,+DAEA,uBACA,uBACA,OACA,CAEA,iBACA,CACA,mBAEA,oFACA,iCACA,uBACA,oCACA,wFACA,kEAEA,SACA,uCACA,mBAAS,SAET,CACA,CAEA,CAEA,QACA,CACA,oBAEA,uBCxLA,CCoMA,eACA,UACA,KC5MA,CCCA,YACA,+DAEA,KAEA,qBACA,SACA,aAEA,UACA,iCACA,OACA,wCACA,IACA,kDACA,OACA,OAEA,uDACA,KAEA,GAEA,IACA,MAEA,IACA,C,CC7BA,aACA,aACA,cACA,8BAEA,cACA,KACA,YACA,IAEA,IAAqB,IAAmB,QACxC,QAAmD,CAEnD,oHACA,uHAGA,qBACA,qBAEA,OACA,sBACA,CACA,gBAEA,SAEA,OACA,CACA,eACA,SACA,iBAEA,QCxBA,CACA,aACA,SACA,mBACA,aACA,eACA,aACA,kBAEA,cACA,MAGA,YAEA,cAEA,YACA,qBAEA,OAEA,QChBA,CCfA,aACA,SACA,cACA,aACA,4BACA,iCACA,mBACA,iBACA,sBACA,kBAIA,qFACA,SAIA,WACA,OAGA,ICjBA,CCOA,aACA,SACA,cACA,uBACA,oBACA,eAEA,gBACA,QACA,uBACA,8BAGA,MACA,yBACA,4BAGA,KCzBA,CAEA,aACA,SACA,aACA,+BACA,uBACA,qBACA,8BACA,0BACA,iBACA,iBACA,sBACA,kBACA,SACA,8BAEA,8BACA,uBACA,0CAIA,cACA,OAIG,oBAKH,UACA,sBAGA,ECvCA,CAEA,aACA,aACA,cACA,iBACA,iCACA,qBACA,oBACA,6BACA,+BACA,gBACA,sBACA,WACA,8BACA,kBACA,iBACA,eACA,6BACA,yBAEA,oBAOA,+BAEA,qBAEoC,MAA0B,SAC9D,KAEA,mCAA4C,KAAgC,SAC5E,SACA,sEACA,SACA,YAGA,OAVA,IAWA,OAIA,WAIA,WACA,QACA,YACA,WACA,eACA,QAGA,WACA,UACA,YACA,kBACA,iBACA,iBAGA,MAIA,cACA,CACA,cACA,cACA,YACA,MACA,SACA,WAGA,eAYA,gBACA,KACA,YAGA,QAKA,QAGA,cAQA,eACA,QACA,CAEA,CACA,QCzHA,CCWA,aACA,SACA,cACA,uBACA,oBACA,eAKA,sBAEA,KACA,OACA,2BACA,4BAGA,MACA,yBACA,gCAGA,GCtBA,CA2KA,aACA,SACA,2BACA,0BACA,eAEA,uBACA,IAIA,CACA,aACA,aACA,gBACA,qBACA,aACA,eAEA,YAEA,KACA,OAEA,KAA8B,MAAoB,KAClD,QAA8B,CAG9B,YAKA,kBACA,CACA,aAGA,kBAMA,OAfA,IACA,WAEK,kBAaL,4BAEA,OAAyC,EAA8B,SAC/C,CACxB,UADA,IAOA,WACA,CACA,aAEA,aAIA,MACA,mBAEA,mCACA,gCAEA,KAAwB,CACxB,cAOA,aACA,QAYA,CACA,aACA,8DAEA,iEAGA,wBAEA,YAEA,aC7RA,CCAA,aACA,cAYA,WACA,IAAmB,MAA0B,OAC7C,SACA,OAIA,cACA,aAEA,kBAEA,eACA,CACA,OAEA,MAEA,aAGA,GACA,aAAmB,EAAiB,IACpC,SAEA,CAEA,SAtCA,sBACA,gBACA,gBACA,oBAEA,UAEA,GA0CA,MAxCA,OAuCA,iBATA,KACA,gBACA,gBAEA,OACA,GAEA,GAI4C,CC7C5C,mBACA,aACA,QACA,aACA,IACA,KACA,MACA,QAEA,OAEA,CACA,CACA,SACA,qBACA,aACA,QACA,aACA,IACA,KACA,WACA,QAEA,OAEA,CACA,CACA,SASA,mBACA,aACA,QACA,aACA,IACA,KACA,KACA,QAEA,OAEA,CACA,CACA,SACA,qBACA,aACA,QACA,aACA,IACA,KACA,UACA,QAEA,OAEA,CACA,CACA,SASA,mBACA,aACA,QACA,aACA,IACA,KACA,KACA,QAEA,OAEA,CACA,CACA,SACA,qBACA,aACA,QACA,aACA,IACA,KACA,UACA,QAEA,OAEA,CACA,CACA,SASA,mBACA,aACA,QACA,aACA,IACA,KACA,MACA,QAEA,OAEA,CACA,CACA,SACA,qBACA,aACA,QACA,aACA,IACA,KACA,WACA,QAEA,OAEA,CACA,CACA,SASA,mBACA,OACA,QACA,aACA,IACA,QACA,MACK,SACL,SAEA,MAEA,CACA,QACA,EACA,qBACA,OACA,QACA,aACA,IACA,OACA,UACA,MACK,SACL,SAEA,MAEA,CACA,QACA,ECxKA,qBACA,MACA,WACA,YACA,aACA,kBACA,uDACA,MAEA,CAEA,eACA,SACA,aACA,eACA,qBACA,2BACA,sBACA,MAEA,eACA,OACA,aACA,aACA,eACA,qBACA,2BACA,sBACA,MAEA,eACA,mBACA,MACA,QACA,OAEA,eACA,mBACA,QACA,iBAGA,oBACA,GAEA,WAwIA,iBACA,WAAiB,qBAAmC,MACpD,IAEA,OADA,QAIA,SAEA,iBACA,oBAA8B,eAA2B,MACzD,IAEA,OADA,QAIA,SAEA,eACA,WAAiB,QAAgB,OACjC,IAEA,OADA,QAIA,SA8CA,eACA,OACA,KAEA,eACA,cAIA,qBACA,GAEA,eACA,cAIA,qBACA,GAEA,aACA,IACA,mBAEA,gBACA,KAAiB,MAAsB,OACvC,wBAEA,MAEA,8BAEA,KACA,KACA,KACA,KAAiB,QAAsB,OACvC,MACA,OACA,OACK,YACL,KAEA,UAKA,WACA,SACA,iBACA,UAEA,qBACA,SAEA,CACA,aACA,MACA,OAqDA,aACA,WACA,mBAGA,YADA,KCtXA,CCobA,aAEA,CC5bA,aACA,8DACA,OACA,kBACA,kCAEA,QACA,eAGA,4DACA,KAEA,+BACA,+BACA,KAEA,GAuCA,CACA,gBAvCA,SACA,yBACA,UAEA,YAEA,WACA,2CAEA,OACA,SAEK,sCAEL,SACA,WACA,kBACA,SAEA,MACA,eACA,IAEA,eACA,sCAOA,UACA,CACA,SAEA,iBAEA,EAGA,SAEA,gBCxDA,CACA,aACA,SACA,YAEA,cACA,2BAEA,OAEA,ICXA,CACA,aACA,SAEA,eACA,SAIA,OCdA,CAGA,aACA,SACA,cACA,YAEA,YACA,kBACA,MAAK,wBAGL,YCLA,aACA,SAEA,mEACA,2DACA,+DAGA,aACA,kBACA,MAAK,wCACL,gDAAuE,GAAsB,2CAAiC,GAC9H,2CAAiC,wBAEjC,UCfA,aACA,SACA,YACA,UACA,WAEA,iBAEA,iBACA,OACA,WACA,mDACA,QAKA,aAIA,MAdA,kCAUsD,qBAGtD,qBCpBA,aACA,SACA,cACA,YACA,UACA,QACA,eACA,qBACA,kBACA,mBACA,oBACA,YAEA,QAEA,UACA,iCACA,iBAGA,2BACA,UAA2B,iBAC3B,WAGA,kCACA,UAAiC,iBACjC,WAGA,+BACA,UAA8B,iBAC9B,WAGA,gCACA,UAA+B,iBAC/B,WAGA,kCACA,UAAgC,iBAChC,WAIA,IACA,iBACA,WAAe,KACf,CACA,YACA,WACA,MAGA,aCvDA,YAEA,SAEA,oBACA,+BAGA,qBAEA,MAEA,aACA,CACA,0BACA,UACA,oBACA,GAEA,aAEA,KAGA,aACA,wBACA,gBACA,2BAEA,MACA,SAEA,cACA,8CACA,8BAEA,gDAEA,QACA,2BACA,2BACA,iBAEA,2BACA,GAEA,gBACA,oBACA,gBACA,iBACA,uBAEA,gBACA,QAEA,gBACA,yBACA,OACA,MACA,MACA,+BAEA,kBACA,OAGA,KClEA,CAWA,gBACA,IACA,SACA,UACA,qBAEG,sBACH,OACA,WACA,gBAEA,iBACA,6BACA,6BAEA,EACA,OAEA,MAOA,CACA,gBACA,oCACA,gBACA,kBACA,QACA,YACA,aACA,kBAEA,KACA,OACA,QACA,QACA,YACA,mBACA,yBAGA,KAKA,CACA,cACA,wBACA,gBACA,gEACA,0EAGA,YACA,OACA,iBAGA,WChEA,wLhCXA,GAwCA,kCACA,kCACA,2CiCnCA,kBACA,aAGA,IAEA,OAEA,OAEA,gDAAmE,EAAa,IAChF,SAGA,0GACA,gBACA,cACK,2GACL,SACA,UACA,gBACA,aACA,SAGA,SAIA,eACA,sBACA,mBAEA,gBACA,sBACA,mBAMA,qBACA,SACA,6DACA,GACA,UACA,6DACA,GACA,UACA,iEACA,GACA,UACA,wDAIA,YACA,WAEA,sCAAkC,kBAElC,iBAAK,kCACL,SACA,qBACA,oBACA,kBAEA,eACA,sBACA,qBACA,mBACA,eAAK,KACL,SAEA,CA0EA,MAjJA,mBAwEA,KACA,oCACA,SACA,mBAEA,0BACA,CACA,cAEA,kBACG,GACH,KACA,yBACA,YACA,UACA,cAEA,gBACA,sBACA,mBAEA,kBACA,kBACA,MAAS,4BACT,cACA,wBACA,mBACA,iBAGA,gBACG,GACH,KACA,kCACA,gDACA,KACG,GACH,KACA,sCACA,SACA,mBACA,mBACA,UACA,iBAGA,iBACA,wBAA0B,kBAI1B,iCAAuB,kBAEvB,eACG,KACH,KACA,8CACA,UACA,aAGA,4DACA,YACA,kBACA,6BAIA,aACA,IAGA,MACC,oBAED,gBACA,CACA,YACA,qBACA,uBACA,cACA,GACA,aAWA,KC/KwC,uBjCKxC,oBCAA,aAGA,IAEA,OAEA,OAEA,gDAAmE,EAAa,IAChF,SAGA,0GACA,+BACA,8BACK,yBACL,SACA,UACA,kBACA,iBAGA,0BAKA,mCACA,+BAEA,4CACA,iCACA,iCACA,+BACA,kCAEA,uBACA,oBAGA,QADA,oBAEA,QACA,YAGA,UAAoB,UAEpB,UACA,CAAK,uBACL,GACA,YAAK,KACL,SAEA,CAiFA,MArIA,mBAqDA,KACA,oCACA,kBAEA,8OAIA,+CAIA,qCACA,uEAEA,gBAEA,YACG,GACH,KACA,uCACA,iCACA,kFAEA,UACG,GACH,KACA,yBACA,YACA,UACA,aACA,cACA,kBACA,iBACA,aACA,UACA,WAMA,QAAwB,UACxB,aAGA,uBACA,IAIA,sBACA,IAgBA,SACA,iBACA,MACA,CACA,qBACA,mBACA,SAEA,KAGA,MACC,oBAED,gBACA,qBACA,EACA,iBACA,sBACA,IACA,aiCzJkB,cCalB,kBACA,aAGA,IAEA,OAEA,OAEA,gDAAmE,EAAa,IAChF,SAGA,uHACA,SACA,UACA,UACA,yBACA,QACA,WACA,qCAEA,QACA,2BACA,WAEA,mCACA,mBAEA,gBACA,4DACA,CACA,cAIA,aAAK,KACL,SAEA,CA+FA,MApIA,mBAsCA,KACA,oCACA,MACA,mBACG,GACH,KACA,qCACA,MACA,mBACG,GACH,KACA,yBACA,kBAGA,sCAAwD,cACxD,YACG,GACH,KACA,uCACA,kBAGA,+BAIA,+GACA,eACA,gBAWA,SACA,gCAEA,UACA,kCAGA,mBACA,qBAIA,gCAGA,qBAGA,UAAgB,UAChB,QACA,OAAgB,gBAEhB,EACG,GACH,KACA,oCACA,YACA,UACA,UACA,yBACA,QACA,WACA,wCAGA,mBACA,YACA,2BACA,WAEA,QAGA,gBACA,oFACA,CACA,cAGA,YACA,CAGA,MACC,EAED,kBAGA,iCACA,aAYA,QAK2C,wBjC5J3C,aACA,OAEA,8DAEA,QAEA,8BACA,wBACA,0BACA,wBACA,qBACA,iBAEA,8BACA,SAEA,qBAEA,2EACA,aAEA,4BACA,SAEA,uBAEA,qEACA,cAEA,UACA,kBACA,iBACA,gBACA,eACA,cACA,cAGA,8BACA,2BACA,0BACA,oBACA,kBAEA,4CACA,qBAvDA,yCAsEA,qBA9DA,OAgEA,CA0HA,eAzHA,KACA,yBACA,8DAEA,SAEA,4BACA,gCAEA,wBACA,mCACG,GACH,KACA,2BACA,uBACA,wBACA,0BACA,wBACA,kBACA,oBACA,CACG,GACH,KACA,iCACA,aACA,eACG,GACH,KACA,gCACA,aACA,cACG,GACH,KACA,6BACA,8DAEA,UACA,4BAEA,0BAEA,iHAEA,cACG,GACH,KACA,4BACA,8DAEA,UACA,2BAEA,yBAEA,8GAEA,aACG,GACH,KACA,uBACA,8DAEA,SAEA,6CACA,iBACG,GACH,KACA,6BACA,YAEA,wBACA,mCAEA,WACA,6BAIA,QACA,2BAEA,0BACA,mCACG,GACH,KACA,oDAKA,yBACA,WACA,IAAuB,SAAoB,UAC3C,gBAEA,qCACA,UACA,sBACA,0BACA,WACA,IAAwB,SAAwB,aAChD,gBAEA,wCACA,QACA,oBACA,CACG,GACH,KACA,8BACA,aACA,cACG,GACH,KACA,6BACA,aACA,aAGA,MAGA,yDEvMA,oBgCgBA,SAOA,UACA,qBAQA,2BACA,aAIA,IAEA,QAEA,gDAAmE,EAAa,IAChF,SAKA,0EAEA,YA6HA,eA5HA,CACA,0BACA,YAEA,KACA,0EACA,wBAEA,iDACA,SACA,UACA,sBAGA,+CACA,CACA,mBACA,WAGA,2BAEA,yCACA,GACA,qBAEA,mDACA,SACA,UACA,sBACA,WACA,sBACA,iBACA,UACA,UACA,eAGA,kBACA,kCACA,CACA,QACA,YACA,SACA,aACA,YAGA,+BACA,kBAEA,qBACA,CAEA,yBAIA,iBAKA,uBAMA,yCACA,UACA,sBACA,WACA,sBAEA,UAEA,mBACA,mBACA,WAEA,+BACA,sCAMA,6DAKA,mCAGA,kBACA,aAGA,iBACA,CACA,eACA,aACA,6BAEA,aAEA,2BACA,CACA,aACA,YACA,aAEA,gBAEA,mBACA,kBACA,kBACA,2CAEA,KAEA,2BAUA,CAsTA,MAzcA,mBAoJA,KACA,iDACA,MACA,kDACA,aAYG,GACH,KACA,oCACA,YACA,UACA,sBACA,eACA,iBAKA,eACA,6CACA,YACA,wCAGA,KACA,UACO,8CACP,+BAAiC,cAIjC,mBAEA,yCACA,mBACA,WAKA,mCACA,eACA,eACA,EACA,cAEA,cACG,GACH,KACA,wCACA,YACA,UACA,WACA,sBACA,iBACA,aACA,UACA,eACA,+BAQA,iBACA,iEACA,sCAEA,kEACA,qCAKA,gFACA,aAIA,4CACA,gCACG,GACH,KACA,uCACA,MACA,kDAEA,+BACG,GACH,KACA,yBACA,YACA,UACA,eACA,cACA,sBACA,cACA,WACA,2BACA,OACA,sBACA,UACA,yBACA,aACA,UACA,gBACA,eAIA,0FACA,kDACA,8BACA,sCAEA,+CAGA,wCACA,mBACA,WAKA,aACA,YACA,YACA,cAEA,kCACA,QACA,IACA,oBACA,IACA,IACO,MAEP,KACA,WACA,uBACA,eACA,kBACA,mCACA,QACA,mBAMA,uCACA,4BAOA,qCACA,mCAEA,OACA,iBACA,MACA,UACA,kDACA,6BACA,kCACA,mBACA,eACA,kBACA,iBACA,QACA,iBACA,MACA,WACA,2DACA,CACA,SACA,YACA,oBACA,gCACA,GAIA,oBAEA,IAUG,GACH,KACA,iDACA,OAEA,UACA,kDAGA,yFACA,eAGA,kBAEA,uCACA,gBACA,CAEA,gBACA,EAzYA,IA0YG,GACH,KACA,2CACA,OAEA,SACA,eACA,cACA,gBAEA,kCACA,qBACA,SACA,eACA,cACA,UACA,WACA,aAGA,QACA,CACA,eACA,cACA,eACA,aACA,YAEA,eACA,UACA,CACA,aAGA,cACG,GACH,KACA,sCACA,SACA,eAEA,YACA,+BAGA,WACA,SAGA,cACA,SAGA,oEACA,iBAEA,WACG,KACH,KACA,8CACA,4CACA,iBACA,YACA,YAEO,gDACP,UACA,iCACA,sDAIA,uBACA,IAGA,MACC,oBAED,gBACA,cACA,8BACA,8BACA,OACA,KACA,qBACA,OACA,KACA,8BACA,OACA,KACA,oBACA,qBACA,QACA,wBACA,GACA,GAiGC,aC3lBD,uBACA,cACA,SACA,WACA,UACA,MAEA,OAEA,aACA,cACA,aACA,SAEA,mBACA,iBACA,EAKA,CA6BA,eA5BA,KACA,gCACA,SAEA,WACA,oBACA,8BAEA,QAIG,GACH,KACA,iCACA,aACA,QAIG,GACH,KACA,2BACA,kDACA,MAGA,MC/CA,iBAQA,aACA,2DAEA,GAJA,SAMA,aAEA,kCACA,kBACA,EAQA,CA0GA,eAzGA,KACA,kCACA,SACA,WACA,UACA,MAEA,IAEA,2BAAwB,sBAA2C,yBACnE,8CACA,CACA,MACA,EAGA,0BACA,OACA,KACA,EAIG,GACH,KACA,mCACA,SAEA,kBACA,gBAIG,GACH,KACA,+BACA,aACA,WACA,UACA,MAEA,cACA,gCACA,0BACA,gCAEA,gBAEA,GAAwC,IAA0B,KAClE,WAA0C,OAA0B,KACpE,QAEA,WACA,wCACA,aACA,wBACA,sBACA,sBAIA,4BAIA,cACA,QAIG,GACH,KACA,uCACA,6BACA,MAIG,GACH,KACA,2BACA,OAEA,gDACA,uBACA,UACA,EAIG,GACH,KACA,gCACA,SACA,kBAEA,WAEA,0DACA,uBAAqC,CACrC,SACA,EAGA,MAGA,IACgC,oB/B/HhC,gBAGA,MAEA,oDAEA,WASA,uBARA,8BAGA,gBAEA,6CACA,wDACA,SAGA,CAoKA,MApLA,mBAiBA,KACA,8BACA,eACA,sCAEA,aAIG,GACH,KACA,iDACA,iBACA,wBACA,gCAIG,GACH,KACA,yBACA,uBAEA,oCACA,mBACA,4BACA,4BAEA,0BAIG,GACH,KACA,+CACA,YACA,UACA,cACA,8BAGA,gBACA,CACA,YACA,4BAGA,qCACA,oCACA,8BACA,qBACA,KAMG,GACH,KACA,yCACA,aACA,wBAMG,GACH,KACA,4CACA,SACA,UACA,cACA,WACA,eACA,cACA,mBAGA,uBACA,YAEA,qBACA,CACA,qBACA,aACA,MACA,gBACA,gBAGA,oBACA,CACA,qBACA,aACA,OACA,gBACA,gBAEA,eAEA,OACA,CACA,aAEA,YACG,GACH,KACA,+BACA,OACA,aACA,mBAEA,OACG,GACH,KACA,iCACA,OAEA,SACA,WACA,gBACA,UACA,MACA,SACA,UACA,sBAIA,sFACA,CACA,SACA,QACA,IAGA,QACA,gBACA,WACA,oDACA,SACA,+CAAyD,CACzD,SACA,eACA,yBAEA,eACG,GACH,KACA,sCAEA,qBAEA,GACG,GACH,KACA,yCACA,MACA,iBAGA,MACC,oBAED,gBACA,cACA,OAEA,kBAsCA,WACA,SACA,cACA,iBACA,8BACA,YAEA,oCACA,SAAkD,CAElD,YACA,CACA,QACA,cACA,YACA,UACA,cACA,WACA,iBACA,UASA,kBACA,cAGA,MAEA,MAEA,IAAG,qBACH,QACA,EACA,EgC/QA,ahCmMA,GAkCC,+BgCpOD,gBAGA,MAEA,oDAEA,WAEA,yCADA,SAGA,CA+DA,MAxEA,mBAUA,KACA,sCACA,YACA,UACA,mBACA,mBACA,gBAGA,4EACA,aACA,wCAGA,mBACG,GACH,KACA,yBACA,YACA,UACA,aACA,mBACA,mBACA,gBAGA,UAIA,YACA,MACA,MAJA,OAKA,UAEA,iBAEA,cACA,CACA,gBACA,uCACA,CACA,QACA,qBAEA,gBACG,GACH,KACA,kCACA,OACA,mDAGA,sFAEA,wBACA,wCAEA,mBAGA,MACC,EAED,wBACA,GAuBC,UC/GD,yC/BWA,cACA,SACA,cACA,mBAEA,uBAEA,sCACA,4BACA,0BAEA,OACA,uBACA,kBACA,oBAKA,CA8QA,eA7QA,KACA,qCACA,CACA,QACG,GACH,KACA,6BACA,SACA,cACA,sBAEA,oBACA,kBACA,0BACA,iBACG,GACH,KACA,+BACA,aACA,UACG,GACH,KACA,uCACA,aACA,kBACG,GACH,KACA,uCACA,aACA,kBACG,GACH,KACA,sCACA,OACA,EAOG,GACH,KACA,4CACA,iBACA,4EAGA,sBACA,kCACA,oDAEA,+BAAiD,IAAY,KAC7D,8BAA4C,CAI5C,sBACA,yDACW,oBACX,4CACA,CACA,cAGA,QAEA,uDACA,CACA,SAGA,QAEA,UAKA,kCACA,2BACG,GACH,KACA,uDACA,0FACA,QACA,OAEA,EAQG,GACH,KACA,+BACA,YACA,oDACA,+CACA,WACA,yBACA,IAcG,GACH,KACA,4CACA,SACA,mBACA,aACA,kBACA,kBAEA,eACA,WAGA,cACA,gCACA,eAEA,WAGA,KAGA,cAGA,YACA,0BAGA,OAIA,oBAEA,8BACA,OACG,GACH,KACA,uCACA,SACA,kBAGA,cAEA,kBACA,YAGA,SACA,WAEA,2BACA,yCAEA,YAEA,4BACA,GAEA,wCAGA,WACA,CACA,QAEA,OAQG,GACH,KACA,6BACA,sDACA,EACG,GACH,KACA,qCACA,YACA,kBACA,sCAEA,UACA,MACS,SACT,QACS,EACT,UAEA,EAEA,OACA,OAEA,EAEA,CACG,GACH,KACA,wCACA,WAEA,sDACA,UACA,QAGA,yDACA,KASG,GACH,KACA,oCACA,IACA,yCAKA,mBAEA,gBACA,mDAEA,6BAEA,+BAKA,UAEA,uBAGA,MgC7SA,iBAIA,OACA,0BAEA,eACA,wCACA,QAEA,eACA,OACA,OAKA,KAfA,SAFA,ICiBA,eACA,cACA,SACA,2BACA,iBAEA,uBAGA,yCACA,eACA,gBAEA,CA4KA,eA3KA,KACA,qCACA,6DACA,cACG,GACH,KACA,6BACA,kCACA,YACG,GACH,KACA,+BACA,yCACA,cACG,GACH,KACA,uCACA,yCACA,sBACG,GACH,KACA,uCACA,yCACA,sBAOG,GACH,KACA,uCACA,SACA,kBAEA,0CACA,sBACA,2CACA,CACA,gBACA,SAGA,2BACA,KACG,GACH,KACA,4CACA,yCACA,2BACG,GACH,KACA,uDACA,yCACA,sCAIG,GACH,KACA,+BACA,gEACA,eAIG,GACH,KACA,4CACA,SACA,mBACA,aACA,kBACA,kBAEA,uCACA,CACA,gBAGA,2EACA,CACA,QACA,gBACA,gBAGA,gDACA,CACA,gBAEA,UAIG,GACH,KACA,uCACA,SACA,kBAEA,yCACA,CACA,gBAGA,gEACA,CACA,gBAEA,UACG,GACH,KACA,6BACA,kCACA,YACG,GACH,KACA,wCACA,SACA,kBACA,WAEA,2BACA,IACG,GACH,KACA,uCACA,SACA,kBAEA,0CACA,sBAEA,kBACA,MAEA,yCACA,CACA,gBACA,SAGA,2BAEA,KACG,GACH,KACA,uCACA,SACA,kBAEA,0CACA,sBAEA,kBACA,MAEA,yCACA,CACA,gBACA,SAGA,2BAEA,KAGA,MAGA,IAEyC,UhC3MzC,KAQA,SGPA,MACA,2BAEA,yBAOA,GALA,KAHC,uKASD,4BACA,GAEA,yJACA,IACA,eAEA,E8BrBA,SAKA,mBACA,aACA,GAQA,kBACA,YAEA,QASA,IAGA,eAXA,MACA,aAEA,YAEA,KAEA,IAKA,QCVA,KAOA,UACA,qBAGA,2BASA,cAIA,MAEA,oDAEA,mCACA,wBACA,uCACA,mCACA,OACA,8BACA,sDACA,2BACA,IACA,yDACA,6BACA,2BACA,0BACA,gBACA,gBAEA,4CACA,kCAEA,gBACA,CACA,eAEA,0BAEA,0CACA,eAGA,4CACA,CACA,mBACA,4BACA,4CACA,oCACA,4CACA,iDACA,sCACA,8BACA,sCAGA,wBAEA,yCACA,GACA,qBAEA,yBAIA,cACA,2CAEA,OAEA,eACA,aACA,sCACA,4BACA,eACA,sBAEA,sCACA,aACA,mCACA,4BACA,aACA,sBAGA,0BAiCA,eAhCA,eACA,CACA,+BAEA,8CACA,4BACA,4BACA,2BACA,gCACA,iCACA,iCAEA,0BACA,EAEA,0BACA,eACA,6BACA,sCACA,YACA,6BAEA,KAGA,0BACA,oEAEA,QACA,yEAEA,SAQA,CAomCA,MAztCA,mBAsHA,KACA,mCACA,8DACA,OACA,kCACA,wBACA,oCACA,qBACA,iCAEA,qBAAmC,cACnC,CACA,oBACA,iBAGA,sBACA,iBACA,2CAEA,2BAMG,GACH,KACA,qCACA,2DACA,cAMG,GACH,KACA,uCACA,8DACA,cAOG,GACH,KACA,qCACA,SACA,wBACA,QACA,uBAIA,SAKA,WAEA,kCACA,UACA,eACA,cACA,WACA,mBAOA,kBACA,4CACA,gDACA,yBACA,oBAMA,iEAGA,4CACA,8FAEA,uDACA,CACA,eACA,4BACA,wDAIA,gBAIA,mBAGA,gBACA,8BACA,WAEA,8BACA,CACA,aACA,YACA,oBAEA,oBAUG,GACH,KACA,iDACA,SACA,gBAEA,0GACA,+HACA,gCAQG,GACH,KACA,kCACA,YACA,UACA,gBACA,sBAEA,wEACA,0DACA,EAQG,GACH,KACA,oCACA,8DACA,OACA,yBACA,QACA,sBAEA,WACA,UACA,mBACA,yBAGA,6CACA,yCAKA,iDACA,wCAIA,sBACA,mBAEA,QACA,aAMG,GACH,KACA,gCACA,SACA,gBACA,sBAGA,mBAIA,WACA,yDAA2D,KAC3D,CAIA,oBACA,qDAAuD,KACvD,CAGA,gBACG,GACH,KACA,oCACA,YACA,UACA,qBACA,WACA,eACA,mBACA,cACA,gBACA,mBAIA,wCACA,0BAIA,OAIA,+BACA,gDACA,YAAuC,KAAc,CACrD,2BAGA,qCAFA,oBACA,0BAIA,sDACA,yCACA,gBACA,MACA,aAGA,oBACA,8BAEA,YAGA,MAGA,uEACA,4DAEA,4DACA,0DAMA,uBACA,IACA,cAEA,qCACA,cAIA,sCAGA,2DACA,eACA,eACA,mDACA,2DAGA,sBACA,qCAQG,GACH,KACA,wCACA,OAEA,YACA,UACA,eACA,cACA,gBACA,WACA,aACA,sBACA,mBACA,gBACA,aACA,UACA,eACA,+BACA,cAIA,mBAKA,gEAOA,sBAGA,oDACA,0CAEA,sDACA,yCAOA,sDAIA,YACA,+BACA,yEAEA,UACA,8BACA,kDACA,+BACA,wCACA,0CACA,8BACA,MACA,eACA,oBACA,gBACA,OACA,gEACA,+CACA,MAIA,SACA,8BACA,oEAEA,UACA,8BACA,+CACA,4BACA,sCACA,0CACA,2BACA,OACA,eACA,oBACA,gBACA,OACA,gEACA,2CACA,MAKA,SAGA,gEACA,mCACA,gDAEA,4CACA,CACA,aACA,YACA,oBAEA,mBAEA,MACA,qCACG,GACH,KACA,uCACA,MACA,wCAEA,+BASG,GACH,KACA,yBACA,YACA,UACA,uBACA,eACA,cACA,cACA,mBACA,kBACA,mBACA,WACA,OACA,sBACA,SACA,UACA,aACA,aACA,UACA,kBAGA,6BAEA,iBACA,WACA,uBACA,eACA,kBACA,mBACA,iCACA,mBAIA,kCAKA,eACA,kBAIA,mEAEA,4CACA,6CAKA,qCACA,wBAEA,+CACA,+BACA,gCACA,8BAQA,0DACA,mCAEA,kBAEA,wCAEA,UACA,kBACA,WACA,UACS,6BACT,yBACA,yCACA,gCACA,4BACA,mBACA,UACA,kBACA,QACA,yBACA,iBACA,MACA,WACA,+CACA,kBACA,SACA,SACA,SACA,WACA,qBACA,gCACA,YAIA,sBAEA,IAIG,GACH,KACA,6CACA,mEACA,oEACA,UACA,iBACA,sBACA,gBACA,6BACA,WACA,wBACA,0BACA,qBACA,aACA,UACA,sBACA,8BACA,4BAGA,kEACA,gEAEA,kBAEA,6CAGA,YACA,0DACA,CACA,gBAEA,6DACA,CACA,gBAGA,gEACA,CACA,gBAEA,6DACA,CACA,gBAIA,4CACA,sCACA,mCACA,mCAEA,aACA,WACA,aACA,YACA,qBACA,8DACA,4CAGA,QACA,WACA,WACA,YACA,qBACA,8DACA,4CAIA,QACA,uBACA,sBACA,uBAGA,uBAKA,OACA,wBAA8C,KAA0B,KACxE,mBACA,GACA,MACA,EACA,KAQA,OACA,uBAAoD,KAAgC,KACpF,mBACA,GACA,MACA,EACA,KAGA,CAEA,2BACA,gBACA,WACA,8CACA,6BACA,mBACA,kBACA,2BACA,6BACA,cACA,2BACA,iCACA,0BACA,gBACA,eACA,aACA,4BACA,YACA,2BACA,uBAIA,2BACA,yBACA,wBACA,sBACA,eACA,CAQG,GACH,KACA,uCACA,kBAGA,gCACA,wCAGA,4EACA,+BACG,GACH,KAOA,6CACA,4GACA,YACA,sCAEA,gEACA,sCAEA,4BAAgC,eAChC,YACA,CACG,GACH,KACA,2CACA,OAEA,SACA,eACA,cACA,sBAEA,uCACA,qBACA,SACA,eACA,cACA,UACA,WACA,aAGA,QACA,CACA,eACA,cACA,eACA,aACA,YAEA,eACA,UACA,CACA,aAGA,cACG,GACH,KACA,+BACA,mEACA,oEAIA,6EACA,WACG,GACH,KACA,sDACA,mCACA,kBAGA,+BAEA,+BACA,YACA,8DACA,uBAEA,+BACA,CACG,GACH,KAOA,oCACA,SACA,eAEA,8CACA,gBACA,MACA,aAIA,oBACA,8BAEA,YACG,GACH,KACA,2CACA,mEACA,oEAEA,eACA,6BACG,GACH,KACA,qDACA,mEACA,oEAEA,UAEA,sDACA,8BAEA,YACG,GACH,KACA,0CACA,mEACA,oEAEA,eACA,4BACG,GACH,KACA,mCACA,YACA,mBACA,wBASA,kCACA,oBAGA,kBAA8C,uBAAgC,cAC9E,mBAAsD,4BAAsC,iBAC5F,QACA,0BAGA,4BAIA,KACG,GACH,KACA,iDACA,mEACA,oEAEA,UAEA,kDACA,8BAEA,YACG,KACH,KACA,8CACA,OAEA,wDACA,8BACA,cAIO,gFACP,2DACA,CACA,yBACA,uBAIA,qBAIA,gBACA,6EAEA,mBAGA,mEACA,aACA,gCACA,8DAGA,qDACA,aACA,6BACA,2DAGA,qCACA,wCACA,iBAIA,4CACA,wBACA,CAIA,2BACA,SAEA,YACA,aACA,8EACA,uCACA,iDACA,EACA,EACA,gDACA,sEACA,yBACA,+BACA,gEACA,KACA,+CAEA,MACA,aACA,uEACA,uCACA,8CACA,EACA,EACA,gDACA,+DACA,yBACA,4BACA,6DACA,KACA,2CAGA,wBACA,gCACA,qCACA,6BACA,2BACA,iCACA,mCAGA,8BACA,8BACA,iBACA,yCAEA,KAGA,2BAEA,qBACA,SACG,GACH,KACA,2CACA,sDACA,mBACG,GACH,KACA,wCACA,kDACA,gBACG,GACH,KAOA,mDACA,SACA,cACA,eAEA,YACA,+BAGA,qCACA,uCACA,mBAGA,kCACA,qCACA,kBAGA,yFAGA,YACA,IACG,GACH,KACA,mCACA,wCACA,CACA,QACA,CACG,GACH,KACA,8CACA,SACA,gBACA,WACA,sBACA,mBACA,UACA,eAGA,qBACA,SACA,UACA,sCACA,8DAEA,iEACA,CACA,sBACA,IACA,gBAEA,eACA,OACA,EACG,GACH,KACA,gEACA,SAEA,eAEA,8DACA,wCACA,CACA,YACA,wBAGA,IACA,IACG,GACH,KACA,6CACA,SACA,WACA,aACA,sBACA,gBACA,UACA,cAGA,qBACA,SACA,UACA,yCACA,8DAEA,8DACA,CACA,sBACA,IACA,gBAEA,eACA,OACA,EACG,GACH,KACA,4DACA,SAEA,cAEA,6DACA,wCACA,CACA,wBACA,EAGA,cACA,IAGA,MACC,oBAED,gBACA,cACA,OACA,mBACA,sBACA,cACA,aACA,kCACA,0BACA,uBACA,qBACA,uBACA,EACA,4BAnvCA,OACA,KAMA,sBA6uCA,uCACA,+BACA,sBACA,EACA,yCACA,QACA,OACA,2BAjwCA,sBAkwCA,uBACA,eACA,QACA,YACA,EACA,sBACA,aAwNA,KAIA,SAc6C,U9BngD7C,gBCIA,gBAGA,MAEA,oDAEA,WAKA,+BAHA,wCACA,0CACA,SAGA,CAmGA,MA/GA,mBAaA,KACA,0CACA,4BAGA,uDAEA,uBACG,GACH,KACA,yBACA,kBAGA,kBACA,qBACA,mCAEA,gBACG,GACH,KACA,uCACA,OAEA,kBAGA,kCACA,OAEA,yBAGA,GACA,0BACA,gDACA,oCACA,uBAEA,eACA,yCAGA,wBAEA,EACA,EACG,GACH,KACA,mCACA,SACA,eAEA,eACA,+BAEA,8BACA,aACG,GACH,KACA,8BACA,OAEA,YACA,UACA,gBACA,qBACA,aAGA,cACA,CACA,cACA,mBACA,2BACA,sBAIA,+BACA,iCACA,WAAO,EAEP,+BACA,oBACA,GACA,sBACA,UAAkB,CAElB,2BACG,GACH,KACA,kCACA,MACA,kBAGA,MACC,EAID,kBAGA,gBACA,kBACA,YACA,YAEA,cACA,GA2CC,gC8BrKD,oBACA,aAGA,IAEA,OAEA,OAEA,gDAAmE,EAAa,IAChF,SAGA,6HACA,SACA,WACA,aACA,UACA,gBACA,cACA,cAQA,qBACA,aAKA,4BAGA,UACA,CACA,QACA,QACA,cACA,YACA,MAEA,UAAK,uBACL,GACA,MAAK,yBACL,SACA,iBACA,iBACA,oBAGA,WAAgB,+BAChB,aAAK,kCACL,SACA,0BACA,yBACA,kBACA,uBAGA,iBACA,CACA,qBACA,oBACA,aAEA,aAAK,KACL,SAEA,CA+IA,MArNA,mBAuEA,KACA,kCACA,MACA,gBAEA,aAIG,GACH,KACA,mCACA,SACA,cAEA,mBACA,kCACA,CACA,YACA,uBAEA,QAEA,UACA,QACA,OACA,EAIG,GACH,KACA,iDACA,SACA,gBAEA,cACA,8CACA,CACA,WAGA,eAIG,GACH,KACA,iCACA,MACA,gBAEA,iBAIG,GACH,KACA,oCACA,8DACA,OACA,yBACA,QACA,sBAEA,SACA,kCACA,CACA,WAGA,eAIG,GACH,KACA,sCACA,8DAEA,OACA,kCACA,CACA,uBAGA,GAIG,GACH,KACA,mCACA,8DAEA,OACA,iCAAoC,CAEpC,aAIG,GACH,KACA,8BACA,8DAEA,OACA,6BACA,aACA,EAGA,YACG,GACH,KACA,yBACA,YACA,UACA,cACA,mBACA,kBAGA,aAEA,4DAAkD,cAClD,CACA,wCACA,cACA,YACA,0BACA,EACA,kCACA,iCACA,4BACA,QAEA,gBAGA,MACC,oBAED,gBACA,CACA,+BACA,uBACA,2BACA,OACA,KACA,4BACA,EACA,yCACA,qBACA,sBACA,QACA,IACA,aCvP4C,4C5BE5C,SA0LA,CACA,GA7JA,mBACA,OACA,gEAEA,oDAEA,QAwJA,GA1HA,mBACA,OACA,gEAEA,oDAEA,QAqHA,GAvFA,mBACA,OACA,gEAEA,oDAEA,QAkFA,GApDA,mBACA,OACA,gEAEA,oDAEA,QC5IA,GD6KA,mBACA,OACA,gEAEA,oDAEA,MAEA,MCpLA,KACA,sBAiDA,wBACA,CAQA,2BAPA,iBACA,gBAEA,kBACA,kBAEA,gBAGA,qBACA,kCACA,sBACA,YACA,SACA,gCACA,KAEA,kBAGA,sBAEG,uBACH,SACA,kCACA,KAEA,mBAGA,uBAEG,SACH,kBACA,6BACA,0CACA,+BACA,IACA,GAEA,qBACA,uBACA,4BACA,UACA,KAEA,4CACA,cACA,YAEA,wBACA,gBACA,mBACA,iBAEK,OACL,qBAGA,KAAG,kBACH,UACA,MAEA,0CACA,cACA,YAEA,yBACA,gBACA,oBACA,iBAEK,OACL,qBAGA,KACA,IACA,sCAMA,mEACA,0BACA,WACA,YACA,OACA,OACA,QAEA,aACA,kBACS,UACT,YACA,YACA,iBACA,gBACA,OACA,SACA,OACA,GACA,iGACA,MAAO,WACP,iBAEA,kBAEA,OACA,SACA,sBAAoE,kCAA4B,kCAIhG,GAHA,8BAIA,aACA,2BACA,wBAAuE,oCAA6B,mCAGzF,GAFX,YAGA,mBAIA,iCAHA,KAKA,CAEA,WA6BA,2BACA,eACA,cACA,iBACA,gBACA,KAEA,QACA,eACA,eAAG,eACH,eACA,kBACA,gBACA,KAEA,QACA,eACA,gBACA,eAEA,eAEA,gCACA,0BACA,iBACA,qBACA,KAEA,QACA,2BACA,kBACA,qBACA,KAEA,QACA,eACA,WACG,uBACH,WAEA,wBAEA,eA8DA,mBAEA,qBACA,MACA,eAEA,6CAEA,MAEA,qBACA,cACA,iBACA,gBACA,oBAEA,MACA,MACA,CACA,UAEA,2BACA,SACA,sBAEA,iBAEA,gCACA,eACA,sBAEA,sBAEA,iCACA,eACA,aACA,eAEA,MACA,CACC,IAED,qCACA,eACA,aACA,yBAEA,IACA,EACC,qBC/WD,aACA,MAEA,4BACA,sBACA,kBACA,EAUA,CAyEA,eAxEA,KACA,2CACA,cACA,uCACA,MAIG,GACH,KACA,6BACA,OAEA,uDACA,cACA,OACA,OACA,OAEA,gBACA,cACA,EACG,GACH,KACA,qCACA,8BACA,aAEA,yBACA,iBACA,UACA,WAEA,SAEA,IACG,GACH,KACA,sBACA,2BACA,KACG,GACH,KACA,mCACA,YAEA,iBAEA,iBACA,OACA,eACA,OAEA,CACA,QACG,GACH,KACA,kCACA,YAEA,iBAEA,iBACA,OACA,OACA,OAEA,CACA,QAGA,MAGA,ICvFA,oBAsCA,aAGA,IAEA,OAEA,OAEA,gDAAmE,EAAa,IAChF,SAGA,0GACA,CACA,yBACK,4OACL,YACA,CAEA,gBAAK,yCACL,GACA,qBAAK,yBACL,eAGA,kBAMA,sBAIA,iCAKA,UAMA,oCACA,0BACA,CACA,eAGA,cAAK,KACL,SAEA,CAyRA,MA/UA,mBAuDA,KACA,qCACA,qBACA,YACA,aAIG,GACH,KACA,iDACA,SAEA,SACA,gDACA,qCAEA,4EACA,2EAEA,gCACG,GACH,KACA,yCACA,iCAEA,sBACA,mCAEA,UACA,aACG,GACH,KACA,oCACA,MACA,gCACA,+BACA,gCACG,GACH,KACA,sCACA,MACA,gCACA,+BAEA,0DACA,gBAEA,2BACG,GACH,KACA,uCACA,MACA,qCAEA,4BACG,GACH,KACA,yBACA,OAEA,YACA,UACA,eACA,cACA,sBACA,iBACA,cACA,WACA,OACA,cACA,qBACA,SACA,UACA,aACA,UACA,oBACA,UACA,gBAGA,YAEA,UAEA,iDACA,yCAEA,QACA,QAEA,+DACA,IAEA,GACA,uBACA,IAEA,QACA,UAGA,kBACA,CACA,QACA,kBACA,KACA,kBACA,UACW,gHAEX,kBAGA,YACA,sDAEA,eAA4C,MAAwC,IACpF,IAEA,aACA,CACA,QACA,kBACA,YACA,WACA,SAMA,4BACA,mBAEA,aACA,iBACA,MACA,UACA,kDACA,6BACA,+BACA,mBACA,UACA,kBACA,WACA,uBACA,eACA,mBACA,gCACA,gBACA,WACA,gCACA,mBAEA,gBACA,YACA,iBACA,MACA,WACA,wDACA,OACA,OACA,kBACA,OACA,qBACA,gCACA,YAKA,gBACG,GACH,KACA,2CACA,wDACA,YACA,qCAEA,gEACA,uCAGA,UAEA,iCACA,aACA,CACG,GACH,KACA,4CACA,kBAGA,gCACA,qCAGA,sEACA,oCACG,GACH,KACA,2CACA,YACA,UACA,cACA,sBAGA,oBAEA,oEACA,cACG,GACH,KACA,0CACA,YACA,UACA,WACA,sBAGA,eACA,0BACA,CACA,iCACA,2BAGA,mBAEA,oBACG,GACH,KACA,iDACA,2FACA,kBAGA,kBACA,iBACA,2BAGA,2CACA,yCACA,UACA,CACG,GACH,KACA,4CACA,gBACA,UACA,sBAGA,eAAoC,IAAsB,SAC1D,OACA,SACA,SAEA,4CACA,aACA,CACG,KACH,KACA,8CACA,8CACA,UACA,CACA,2BAIA,WACA,IAGA,MACC,oBAED,gBACA,CACA,cACA,UA+CA,WACA,CACA,UAhDA,kBACA,4BACA,QACA,OACA,2BA5VA,IA6VA,MA5XA,YA6XA,eACA,OACA,aAmCA,KAcA,KAKA,SAEA,U0BncA,kBACA,aACA,OAEA,8DAEA,QAEA,oCACA,SAEA,uCACA,WAEA,oBAEA,4BACA,SAEA,qCACA,WAEA,iBAEA,UACA,sBACA,+BACA,QACA,4BAGA,SACA,0BACA,0BACA,iBAEA,CA2DA,eA1DA,KACA,2BACA,6DACA,mBACG,GACH,KACA,2BACA,yBACA,UACG,GACH,KACA,iCACA,gCACA,gBACG,GACH,KACA,gCACA,gCACA,eACG,GACH,KACA,6BACA,8DAEA,yEACA,mBACG,GACH,KACA,4BACA,8DAEA,wEACA,mBACG,GACH,KACA,uBACA,8DAEA,mEACA,mBACG,GACH,KACA,6BACA,2DACA,uBACG,GACH,KACA,8BACA,gCACA,aACG,GACH,KACA,6BACA,gCACA,YAGA,MAGA,IC3FA,SAUA,iBACA,gBAGA,MAEA,oDAEA,cAEA,gBACA,6BACA,qBAGA,cAsBA,SAnBA,yFACA,CACA,sCACA,EAGA,gFACA,CACA,oBACA,oBAGA,wEACA,CACA,oBACA,mCAGA,QAGA,CAgiBA,MApkBA,mBAqCA,KACA,mCACA,4CACA,2DACA,mDACA,qDACA,aAIG,GACH,KACA,gDACA,8DACA,OACA,yBACA,QACA,sBAEA,qGACA,+HACA,gCAIG,GACH,KACA,kCACA,4CACA,+DACA,uDACA,yDACA,iBAIG,GACH,KACA,oCACA,8DACA,OACA,yBACA,QACA,sBAEA,WACA,UACA,qBAGA,qBACA,YAEA,kEACA,CACA,cAEA,4EACA,CACA,cAEA,oEACA,CACA,cAEA,sEACA,CACA,cAGA,iCACA,yBACA,UACA,+BACG,GACH,KACA,oCACA,YACA,UACA,eAGA,sBACA,OAEA,GACA,QAGA,cACA,QAGA,kBACA,WACA,MACA,4BACG,GACH,KACA,qCACA,MACA,4BACG,GACH,KACA,yBACA,YACA,UACA,aACA,sBACA,8BACA,eACA,mBACA,cACA,2HAEA,wBAKA,0CACA,4BAKA,iBACA,UACA,eAGA,gBACA,kBACA,MAAS,YACT,sBACA,iBACA,MAAW,YACX,yBACA,oDAA8C,KAC9C,CACA,WAGA,iBACA,iBACA,MAAW,YACX,uDAAgD,KAChD,CACA,WAEA,gDAAiD,KACjD,CACA,WACA,oBACA,aACA,iBACA,cAIA,gBACG,GACH,KACA,wCACA,SAGA,cAEA,2BACA,IACG,GACH,KACA,qCACA,SACA,qBAGA,eACA,kDACA,WAEA,IAA6B,EAA0B,IACvD,SAA0C,CAG1C,eACA,gBACA,0BAIA,gBACA,cACG,GACH,KACA,sCACA,SAGA,aAEA,2BACA,IACG,GACH,KACA,qCACA,SACA,kBAGA,aACA,kDACA,WAEA,IAA6B,EAAuB,IACpD,SAAwC,CAGxC,eACA,gBACA,0BAIA,gBACA,cACG,GACH,KACA,6CACA,yDACA,YACA,sCAEA,gEACA,sCAEA,4BACA,CACA,cAEA,kBACA,aACA,CAOG,GACH,KACA,+CACA,YACA,UACA,gBACA,4BACA,yBACA,WACA,qBACA,kBACA,cACA,UACA,wBACA,yBACA,qBACA,sBAGA,kDACA,oEACA,iFAEA,uCACA,qDACA,CACA,kBACA,UAIA,cACA,mCACA,oCACA,gBACA,WAGA,oCACA,sCACA,gBACA,mBACA,WAIA,uBACA,mEACA,MACA,YACA,4BACA,kBAIA,gCACA,qEACA,kCACA,gBAIA,6BACA,6DACA,MACA,YACA,mBACA,kBACA,eAIA,uBACA,+DACA,kCACA,0BACA,mBACA,kBACA,eAIA,YACA,gCACA,qCACA,kCACA,2BACA,8BACA,0BACA,wCACA,yCACA,qCACA,sCACA,oBACG,GACH,KACA,oCACA,0GACA,wCAGA,4GACA,iCAGA,WAEA,uEACA,0DACA,4DACA,qDACA,SACG,GACH,KACA,yCACA,SACA,4BACA,qBACA,kBACA,aACA,yCAGA,yBACA,SAGA,gBACA,SACA,+BACA,iFACA,MAEA,iCAAgE,KAChE,mBACA,iDACA,wBACA,4CACA,wCACA,yBACA,6BACA,iCACA,sBACA,gCACA,8BACA,KAIA,oBACA,iBACA,MACA,WACA,0CAA8B,6BAC9B,CACA,SACA,kBAMA,gBACG,GACH,KACA,0CACA,SACA,gBACA,qBACA,kBACA,aACA,mBAGA,4CAAkD,KAClD,mBACA,kDACA,0CACA,sBACA,oDACA,qDACA,sCACA,yCACA,oCACA,kCACA,oBACA,oCACA,gBACA,eACA,iCAEA,wBACG,GACH,KACA,sCACA,SACA,qBAGA,oBACA,+BAGkD,KAClD,sBACA,qBACA,0BACA,8BACA,gBACA,sBACA,2BACA,gBAEA,wBAVA,IAWG,GACH,KACA,uCACA,SACA,gBACA,yBACA,qBACA,kBACA,eACA,iCACA,UACA,4BAGA,iBACA,SAGA,gBACA,SACA,4BACA,4BAEA,EACA,WAGA,yBACA,WAA2B,2BAC3B,MAIA,oCAA8D,KAC9D,mBACA,+CACA,uCACA,wBACA,oDACA,sCACA,yBACA,8BACA,iBACA,WACA,aACA,iBACA,KAIA,oBACA,iBACA,MACA,WACA,wCAA8B,2BAC9B,CACA,SACA,kBAMA,gBACG,KACH,KACA,8CACA,qDACA,UACA,+DACA,qEAIA,WACA,IAGA,MACC,oBAED,gBACA,yBACA,4BACA,wBACA,yBACA,GACA,2BACA,yCACA,gBACA,kBACA,eACA,QACA,uBACA,wBACA,oBACA,qBACA,GACA,6BACA,gCAEA,iBACA,OAEA,gBACA,YACA,YACA,gBACA,EACA,2BAEA,8DACA,sCAEA,wCACA,GACA,iBAEA,sCACA,GACA,kBAEA,8CACA,SACA,mBAEA,iBACA,UACA,iBACA,kBAGA,oBACA,2BACA,OACA,eAA0B,WAC1B,CAIA,qBAAqC,KACrC,CACA,kBAGA,MAEA,+CACA,SACA,gBACA,iCAEA,iBACA,UACA,iBACA,qBAGA,4BAAmC,KACnC,aACA,IACA,kBAEA,MAEA,4CACA,SACA,sBAEA,oBACA,UACA,iBACA,gBAGA,4BACA,2BACA,OACA,eAA0B,WAC1B,CAIA,oBAAqC,KACrC,aACA,IAGA,WAEA,wCACA,SACA,UACA,UACA,gBACA,qBACA,gBACA,UACA,kBAOA,sCAIA,6BAA4D,OAC5D,OAEA,4BACA,SACA,eAEA,qBACA,CACA,aAEA,4BAEA,YAEA,IAEA,6CACA,SACA,eACA,SACA,aACA,UACA,4BAGA,sCACA,YACA,CACA,gBACA,0BAGA,wCAEA,0BACA,wBACA,CACA,aACA,OAGA,YACA,CAEA,gCACA,SAEA,uBACA,CACA,+BAEA,WAEA,+BACA,SAEA,sBACA,CACA,+BAEA,YAEA,uCACA,SACA,UACA,UACA,kBACA,aACA,cACA,UACA,kBAOA,oCAIA,6BAAwD,OACxD,OAEA,kCACA,GACA,cAEA,mCACA,GACA,eACA,GAEA,GAiBC,aAKD,SCx0BA,qBACA,gBAGA,MAEA,oDAEA,WAWA,eAVA,cACA,cACA,eACA,aACA,YACA,cAGA,2BACA,SAGA,CA6CA,MA/DA,mBAmBA,KACA,yBACA,kBACA,gBACA,UACA,iBACA,gBACA,iBACA,eACA,cAGA,qBACA,CACA,eACA,4BACA,UACA,eACA,aACA,YAEA,eACG,GACH,KACA,6BACA,SACA,iBACA,gBACA,iBACA,eACA,cAEA,0BACA,CACA,eACA,cACA,eACA,aACA,YAEA,eAGA,MACC,EAED,wBACA,GAOC,UCtFD,GzBYA,Y0BdA,QzBOA,IyBFA,KAMA,WAGA,QzBUA,EAEC,UCpBD,GAuBA,YCvBA,KAyDA,YwBlDA,KAEA,kBACA,aAGA,aAEA,oDACA,WAEA,CACA,MAPA,YAOC,gBAED,gBACA,CACA,iBACA,uCACA,aACA,aACA,EACA,uBAEA,IACA,GAkEC,UChFD,GAEA,kBACA,cAGA,MAEA,oDAEA,SAUA,eATA,gBAGA,mCACA,kCACA,gCACA,kDACA,4BACA,SAGA,CA6fA,MA9gBA,mBAkBA,KACA,kCACA,MACA,gBAEA,aAIG,GACH,KACA,mCACA,SACA,cAEA,mBACA,kCACA,CACA,YAEA,iBAEA,UACA,QACA,OACA,EAIG,GACH,KACA,iDACA,SACA,gBAEA,cACA,8CACA,CACA,WAGA,eAIG,GACH,KACA,iCACA,MACA,gBAEA,iBAIG,GACH,KACA,oCACA,8DACA,OACA,yBACA,QACA,sBAEA,SACA,kCACA,CACA,WAGA,eAIG,GACH,KACA,sCACA,8DAEA,OACA,kCACA,CAGA,YAIG,GACH,KACA,mCACA,8DAEA,OACA,iCAAoC,CAEpC,aAIG,GACH,KACA,8BACA,8DAEA,OACA,6BACA,aACA,EAGA,YACG,GACH,KACA,oCACA,MACA,oBACG,GACH,KACA,qCACA,MACA,oBACG,GACH,KACA,yBACA,OAEA,YACA,UACA,aACA,cACA,kBACA,kBACA,cACA,iBACA,sBACA,WACA,OACA,mBACA,iBACA,aACA,kBACA,UACA,mBAGA,qBAEA,6BAAwE,QACxE,+BAAsE,QAGtE,sCACA,+CACA,0CAEA,qCAAuD,KACvD,UAEA,UAKA,GACA,iBACA,MACA,gBACA,6BACA,UACA,OACA,eACA,gBACA,qDACA,+BAA4B,KAC5B,CACA,kBACA,SACA,eAGA,qCAA6C,cAC7C,CACA,qCACA,qDACA,WACA,0BACA,EACA,SACA,UACA,kCACA,iCACA,4BACA,aACA,WACA,iBACA,yBAA4B,KAC5B,WAIA,cACG,GACH,KACA,iCACA,SACA,WACA,gBACA,gBACA,WACA,YACA,aACA,UACA,mBACA,iBACA,cACA,eACA,YAGA,OAAqC,wBACrC,gBACA,CACA,WACA,aACA,cACA,UACA,cACA,SACA,UAGA,oBAEA,8CAKA,WACA,kBACA,MACA,CACA,oCACA,4CACA,sBACA,WACA,QAGA,WACG,GACH,KACA,iCACA,SACA,WACA,aACA,UACA,oBACA,gBACA,kBACA,SACA,WACA,kBACA,UACA,eACA,YACA,yBACA,gBACA,mBACA,OAEA,QAEA,+EACA,CAEA,uFAAiE,aAEjE,kBACA,CACA,aACA,UACA,cACA,QACA,SAGA,wBACA,SACA,SACA,SACA,SAEA,WAEA,OAIA,8BAEA,kBACA,MACA,CACA,uBACA,QACA,SAEA,uBAA0C,wBAC1C,SAEA,eACA,mBACA,cAEA,IAEA,YACA,sBACA,EACA,IACA,GAEA,OACA,kCAMA,cACA,iBACA,MACA,CACA,eACA,cACA,YACA,SACA,eACA,UACA,iBACA,eACA,QAGA,cACG,GACH,KACA,8BACA,OAEA,SACA,aACA,gBACA,QACA,WACA,aACA,UACA,aACA,eACA,qBACA,oBACA,mBACA,kBACA,iBACA,cACA,gBACA,sBAGA,wCAAwE,CACxE,qCAAsE,CACtE,gBAA+B,CAE/B,oDACA,wBACA,CACA,SACA,cACA,cACA,SACA,UACA,WAEA,kBAEA,UACA,yCAAsC,OACtC,aACA,0BACA,SAGA,0BACA,CACA,YACA,UACA,QACA,cACA,MACA,aACA,mBACA,kBACA,iBACA,gBACA,UAEA,SAMG,GACH,KACA,0CACA,8DAEA,+DAEA,YAA6B,KAC7B,CACA,OACA,SAGA,eASA,eARA,8BAGA,kBACA,8BAGA,WAEG,GACH,KACA,oCACA,OAEA,YACA,UACA,aAEA,iCAEA,qCACA,wBAAqC,UACrC,SACA,EACG,GACH,KACA,iCACA,kBAGA,uCAA0D,CAC1D,WACG,GACH,KACA,6BACA,SACA,iBACA,iBACA,uBAGA,WAAgB,+BAChB,aACG,GACH,KACA,sCACA,SACA,0BACA,yBACA,kBACA,0BAGA,iBACA,CACA,qBACA,oBACA,aAEA,aACG,GACH,KACA,2BACA,MACA,MACG,GACH,KACA,qCACA,cACA,mCACA,uBACA,mBACA,gBAEuB,CACvB,eADA,KAEA,CAGA,MACC,oBAED,gBACA,CACA,kCACA,gBACA,cACA,4BACA,OACA,KACA,2BACA,OACA,KACA,qBACA,OACA,KACA,EACA,yCACA,GACA,cACA,6BACA,qBACA,sBACA,QAEA,cACA,GAwMC,UCjwBD,UzBPA,MACA,2BCGA,YACA,MAKA,gBACA,UACA,sCCGA,yCACA,MAEA,gBACA,aAGA,IAEA,OAEA,OAEA,gDAAmE,EAAa,IAChF,SAGA,yLAA0U,qCAC1U,CACA,0BACA,YACK,gCACL,kBACA,wBAEA,uEACA,WACA,gBAAK,8BACL,SAEA,qBAIA,6BAEA,kBACA,+CAEA,kCAGA,kBAAK,uCACL,KACA,0CAEA,2DAEA,UAAK,yCACL,KACA,6CAEA,iEAEA,UAAK,wBACL,GACA,gBAAK,wCACL,MAIA,0BAGA,mBACA,mBACA,OACA,sBACA,kCAEA,6BACA,CACA,eACA,aAGA,gBACA,CACA,aAEA,aACA,EAAK,iCACL,YACA,CAEA,gBAAK,KACL,SAEA,CAwGA,MA1LA,mBAmFA,KACA,iCACA,yEACA,2BACA,gBACA,UACA,WAGA,oCACA,iCACA,OACA,gCACA,6BACA,IAEA,iBACA,4BACA,uBACA,UACA,eAEA,UACA,UACA,eAGA,QACG,GACH,KACA,oCACA,kBAEA,wCAEA,SAGA,yBACA,aAGA,iCACA,aACG,GACH,KACA,sCACA,kBACA,kBAGA,8BACA,eAEA,qBACA,WAEA,aACA,kCAEA,2BACG,GACH,KACA,uCACA,kBAEA,qBACA,aAGA,mCACA,aACG,GACH,KACA,yBACA,kBACA,gBACA,UACA,gBACA,cACA,eACA,WAGA,eACA,oBACA,kCACA,eACA,SACA,cACA,aACA,YAEA,SASA,MACC,oBAED,gBACA,qBACA,sBACA,EACA,2BAvMA,kBAwMA,kBACA,cACA,GACA,aAmCA,QwB9PA,2wCCSoW,mBCXpW,aCAA,eACA,CAGA,GAAC,kBAAqB,CAOtB,aAWA,aACA,QACA,+BAGA,4CACA,sBACA,SAOA,CACA,eACA,SAEA,WACA,4BACA,WACA,yEAGA,2BACA,gBACA,aAIA,+FACA,iBACA,OAKA,8IAMA,CApDA,iBACA,OACA,SAMA,EA6CA,8BACA,gEACA,cACA,OAEA,aAF0B,MAC1B,SAOA,EACA,2BACA,OACA,EAgBA,WAdA,iBACA,yBAIA,eACA,cACA,YACA,UACA,4CAIA,QAQA,EACA,gCACA,YAEA,iBACA,yBACA,aACA,2BAMA,EACA,8BACA,aAEA,kDACA,mBACA,kBAAiC,OAAS,IAC1C,WACA,mBAKA,eAEA,eACA,yBAIA,kBACA,cACA,YACA,iBACA,uCAMA,OAYA,EACA,gCACA,KAEA,qBACA,yCAGA,gBAGA,iCACA,EASA,EAuCA,GAEA,GAvCA,aAEA,sBACA,cACA,WACA,sBACA,qBACA,oBAEA,6BACA,eAGA,iBAGA,WACA,cAIA,sBACA,wBAEA,SAAiB,EAAS,IAC1B,OACA,SAIA,SACA,QAIA,EAKA,uDACA,cAgCA,oBACA,mBAOA,cACA,eAEA,yBACA,qDACA,IAOA,cACA,gBAEA,uCACA,gCACA,yBAQA,aACA,CAGA,8BACA,sBACA,eACA,OACA,uCACA,CACA,OACA,CAAK,EACL,IASA,cACA,SACA,cACA,OAMA,IA9FA,QAIA,EA0BA,gUAqEA,+CACA,6CACA,kBANA,KACA,OAEA,KAKA,EAAC,iCC9OQ,YACP,OACE,iBACE,KACA,UACA,KACA,qBAEF,mBACE,kBAAkB,yBAGlB,8BACA,QACA,6BACA,mBACA,eACA,GACA,kCAEF,sBAAiB,uBACjB,sBACE,KAAK,CAAE,KAAM,WACb,uBACA,KACA,eACA,kBACA,uCACA,KAEF,uCACE,CACA,4CAAW,CAAE,KAAM,iBACnB,UACA,iBACA,KACA,6BACA,cACA,oBAAkB,GAAI,GACtB,gBACA,eACA,gCACA,8BAA0B,CAAE,OAAQ,KAAM,YAE5C,oBACA,iBAAa,GACb,kBAAc,GACd,qBACA,eACA,YACA,KACA,6BACA,4BACA,sBACA,2BACA,oBAEH,K,uCA7ID,qBAKA,QACA,QAQA,QAEA,aAEA,uBAAa,KAGX,CACmB,cAEY,MALd,6CAAkB,GAM/B,IAGG,CAAI,MACT,MAAM,GAAW,KAAK,gBAAgB,IAAI,EAC1C,SAAgB,IAAZ,IACF,MAAM,GAAc,KACpB,+BAAO,GAAM,QAAU,CACxB,eAED,MAAM,GACN,IAED,YAFM,gBAAgB,IAAI,EACzB,SAGK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,oBACA,kBACA,uECpDA,qBACA,QACA,QAEA,IAMA,E,qBAEE,mBAEA,MAAM,GAAa,EACnB,KAAM,EAAS,KAAM,GACrB,iBAAK,GACH,MAAc,GACd,mBAAM,IAAI,GAAJ,sDAC8B,EAAa,oBAC7C,EACF,IAAwB,mBAFxB,CADI,mCAIJ,CAEH,oBAED,GAAM,QACP,qBC3BD,aAkBA,eACA,UACA,SAKA,CA4BA,aACA,cACA,kBACA,iBACA,kBACA,iBACA,mBACA,iBACA,WACA,iBACA,sBACA,iBACA,oBACA,iBACA,cACA,iBACA,iCACA,iBACA,sBACA,iBACA,yBACA,eACA,oDACA,eAGA,OAKA,GAnFA,qCAA8C,CAAc,WAC5D,KAEA,GAaA,KASA,MACA,YACA,cACA,yBACA,sCACA,iDACA,uCACA,2BACA,0BACA,0BACA,uBACA,sCACA,mCACA,QAAC,+CAAkF,KACnF,MACA,YACA,qBACA,0CACA,sCACA,mDACA,uDACA,yCACA,6CACA,gDACA,mDACA,wCACA,YAAC,qBAA2C,KAiC5C,oBASA,EACA,oBATA,aACA,IACA,OACA,OACA,SACA,OACA,EACA,gBC7FA,kB,6CC85HE,aAEA,OAAI,GAAY,OAAS,iBACvB,KACE,MAAM,oBAIV,SACE,MAAM,oBACN,cAAQ,EACR,sBAAM,EAET,KAED,CAG4B,aAC1B,OACE,KADE,KAIJ,EAAO,EACR,M,uCAt7HD,qBACA,QACA,QACA,SAWA,QACA,SAEA,SAKA,QACA,SACA,SAEA,QACA,QACA,QACA,SAEA,SACA,SAKA,QAMA,QACA,QACA,QAKA,QAIA,QAOA,QACA,QAuBA,QAEA,QAOA,SAEA,OACA,SACA,SACA,SACA,SA0BA,QAKA,SACA,SACA,SACA,QAKA,SACA,QAQA,QACA,SACA,SACA,QACA,SAIA,QACA,QACA,SACA,SACA,SACA,UAEA,UAOA,KAAM,GAEN,GAAM,GAEN,8BAAM,GACN,IAAM,GAEN,gBAAM,GACN,IAAM,GAIN,uBAAM,GACN,qBAAM,GAEN,wBAAM,GAEN,iBAAM,GAAuB,gBAC7B,MAAM,GAEN,kBAAM,GAK2C,QAEpC,gB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EA,IAXA,cACA,8DACA,mBACA,kBASA,6BACA,aAEA,qCACA,GACA,0DACA,IACA,oEAEA,0CACA,qBACA,OAEA,kBAOA,+BACA,mBAEA,kBAmCA,MACA,8BACA,6BACA,wBACA,0BACA,iBACA,IAEA,iCA1CA,gBACA,gDACA,mBACA,YACA,6DACA,gCAEA,QAEA,gCACA,oCACA,YAEA,QAEA,qCACA,2CAEA,iBACA,cACA,aAGA,0CACA,OACA,iBACA,IAEA,6DACA,YACA,sBACA,MAEA,gCAUA,qBACA,wFACA,uCACA,QACA,mBAEA,gCACA,kCACA,gDACA,+CAGA,6CACA,+BACA,yCAGA,2CACA,kCACA,8CACA,yCAGA,OAAY,uBACZ,EAEA,sCACA,WACA,SAEA,uCACA,YACA,SAEA,8BACA,uBACA,oCACA,8BACA,KAEA,uCACA,cACA,8BACA,wCACA,cACA,+BACA,CAAC,mBCtJD,gBAEA,YAEA,KAKA,IAAC,cACD,CAEA,4BAoCA,MACA,UACA,sBACA,mBACA,YACA,kCACA,yFAEA,aACA,uDAA4D,GAAuB,gBACnF,EAEA,kBA4EA,iBACA,cACA,uBACA,iBACA,6BACA,kBACA,6BACA,MAEA,sCADA,eAGA,cACA,OACA,uBACA,IAEA,gBACA,gBAcA,IACA,KACA,qBAGA,kBAGA,kBAN8B,OAAwB,OAEtD,EAKA,MACA,OAvBA,eAAsB,eACtB,kBAAwB,cACxB,oBAA0B,+BAC1B,sBAA4B,8BAC5B,kBAAwB,aACxB,iBAAuB,sBACvB,UACA,WACA,WAEA,mBACA,eACA,KAYA,sBACA,uBACA,sBACA,UACA,sBACA,uBACA,MACA,QAEA,gBACA,eACA,qDACA,aACA,UACA,CAEA,gBACA,MACA,kBACA,YACA,yBAEA,uCACA,kBACA,qDAEA,cACA,OAAmB,MAAwB,WAC3C,qDACA,+BACA,4CACA,SACA,uBACA,mEACA,SACA,QAEA,qDACA,0BACA,oBACA,mBAEA,mFACA,yFACA,mDACA,mDACA,yCACA,MAEA,uBACA,0CACA,QACA,8BACA,KACO,iBACP,oBACA,oCACA,aACA,yBACA,SACA,wCACA,SAEA,wBACA,CACA,SACA,WACA,gBACA,2BACA,kBAEA,kCAEA,oBAAwD,iBACxD,0DAEA,oCACA,wBAAyC,kBAAyD,iBAClG,sBAA6B,GAAwB,eACrD,qBAA4B,UAA8B,cAC1D,WACA,uBAAyB,GAAoB,OAC7C,iBAAwB,GAAe,MACvC,EAGA,mCACA,IACA,qCAA8C,wBAAwC,GAAoB,OAAE,EAAO,IACnH,uCAAgD,CAA6B,eAC7E,EAEA,CA6BA,6CA5BA,iDACA,oCACA,uEACA,2BACA,sCACA,2BACA,kCACA,KAEA,gCACA,uBACA,gCAAkC,iBAA8B,UAChE,OAEA,6BACA,uBACA,eACA,kCACA,2CAEA,OAEA,gCACA,uBAA4B,SAAY,EACxC,GAEA,8DACA,iBAGA,gBAiDA,2BACA,mBACA,KAAmB,MAAoB,OACvC,mCACA,MACA,QAEA,oBACA,MACA,MACK,aACL,OACA,mBACA,QACA,IACA,CAEA,OAlWA,oBAIA,mDACA,gBACA,2BACA,iBACA,iCACA,cACA,WAEA,0CACA,yBACA,uBACA,sBAIA,yCACA,8BAEA,iBAAqB,MAAuB,OAC5C,wCACA,MAEA,0DACA,gDACA,kBAEA,uCACA,QACA,YAEA,kDAcA,yBACA,GACA,iCAEA,yBACA,iBACA,MACA,0CACA,eACA,uCAEA,yDACA,kCACA,8CACA,IAEA,mBACA,wCACA,IAEA,oBACA,SACA,2BACA,4CACA,gBACA,uBACA,eACA,OAEA,2BACA,MACA,kBACA,wBAGA,iDACA,gFACA,mCACA,2EACA,SACO,YACP,OACA,gCAA0D,UAC1D,4BACA,SACA,CAEA,oBACA,IACA,qCACA,yDACA,cACA,iBACA,GAEA,4BACA,+BAEA,iEACA,wCAEA,aAEA,iBACA,YACA,6BAEA,sBACA,mBAGA,UAGA,eAuKA,iBACA,4BACA,6BACA,4CACA,4CAEA,8BACA,2BACA,mCACA,2BAEA,8BACA,UAEA,oBACA,sCACA,cACA,kBAAqB,gBAAmB,GAAsB,SAC9D,qCACA,OAEA,iBACA,qCACA,aAEA,4BACA,sBACA,mCACA,EACA,kCACA,QACA,kDACA,oDACA,iCACA,6BACA,6BACA,2CACA,6DACA,uFACA,mDACA,iBAEA,yBACA,gFACA,CAGA,kCA6CA,CAGA,qBA7BA,8BACA,cACA,sBACA,cAEA,sBACA,iCACA,oBACA,SACA,EACA,EACA,OAPA,SAQA,EACA,EAGA,SAFA,WACA,sBACK,oCACL,yBAA2B,2BAAmD,SACzE,SACL,qBAAoC,2BAEpC,aAEA,CAEA,oDAKA,yBACA,+BACA,qDACA,oCAEA,qBAEA,cACA,KAAmB,cAA0B,OAC7C,QACA,qBACA,cAGA,2BAA8B,cAC9B,KAEA,6BAEA,eACA,aACA,KACA,kBACA,iCACA,mBACA,kBACA,mCACA,gBACA,eAGA,mCACA,KAAC,mBCxaD,CAEA,YAEA,KAKA,IAAC,cACD,CAEA,0BAiBA,SACA,uCAA+B,CAAY,IAC3C,EAEA,cACA,kDACA,8BAA+B,CAAW,IAC1C,EAEA,oBAKA,IACA,4BACA,0BACA,yBAA+B,OAC/B,uBACA,gBACA,eACA,qBACA,2BACA,qBACA,OACA,MACA,GACA,CAEA,cACA,mBACA,kBAAmB,MAAkB,gBACrC,iBACA,CAEA,cACA,CACA,iBACA,mBAAmB,MAAmB,OACtC,yBACA,KAEA,cACA,iCACA,2CAEA,+CAEA,iBACA,mCAEA,4CACA,2BACA,uBACA,qBAEA,WACA,yBACA,eAEA,WACA,4BACA,kBACA,mBAEA,iBAIA,IACA,qBACA,wBAEA,OACA,4BACA,gBACA,cAEA,eAGA,MACA,sDAlGA,eACA,QACA,4BACA,qDACA,0BACA,UACA,yBACK,aACL,cACA,0BACA,YACA,0DAEA,KAEA,SAWA,MACA,QAEA,MAqEC,uECtHD,qBACA,OAEA,IACA,EAEA,KACA,EAIE,OAuCF,KAGa,eAAuB,GAAM,SAAmC,wBACnE,wBACA,qBAwBA,iBAAuC,OAC7C,CAAI,KAAK,MACP,aAAK,MAER,WA6BO,8BAAiD,OACvD,CAAI,KAAK,MACP,oBAAI,CAAC,KAAK,MAMR,wBAAU,OAAO,CACf,CAAE,KAAM,CAAE,KAAM,EAAG,GAAI,GAAK,OAAQ,CAAE,KAAM,EAAG,GAItD,KAEO,iBAEN,OAEA,CAAI,KAAK,MACP,gBAAK,MAER,cAEO,oBAGN,SAEA,CAAI,KAAK,MACP,mBAAK,MAER,mBAEO,aAAS,KACf,MACD,SAKF,CA5FQ,YACL,OAAO,MACR,UAEM,oBACL,MAAK,WAAa,EAAW,KAAK,QAAU,KAAK,MAEjD,cAAK,WAAW,GAAG,aAAc,KACjC,mBAAK,WAAW,GAAG,UAAW,KAC9B,gBAAK,WAAW,GAAG,wBAAyB,KAI5C,6BAAK,WAAW,GAAG,OAAQ,KAE3B,aAAK,WAAW,SAAS,KAAK,MAC/B,MAQM,uBACL,MAAM,GAAK,KAGT,iBAAG,IAAI,UAAW,KAClB,aAAG,IAAI,aAAc,KACrB,gBAAG,IAAI,wBAAyB,KAChC,0BAAG,IAAI,OAAQ,KAEf,aAAK,WAER,KAEM,CAA0B,4BAC/B,CAAI,KAAK,MAAM,QAAU,EACvB,YAAK,WAAY,SAAS,EAE7B,MAEM,CAAsB,wBAK3B,OAAO,GAAU,YAAc,KAAK,MACrC,SAwCM,SACL,OAAO,wBAAK,UAAW,KAAK,MAAM,UAAW,IAAK,KACnD,OAnG0E,EAA7E,E,+CCSE,eAEA,SAIA,QACE,EAAS,KAAK,OAAS,EAAU,KAAK,MACtC,EAAS,KAAK,UAAY,EAAU,KAAK,SACzC,EAAS,OAAS,EAErB,2CAzED,qBACA,OACA,QAEA,QAEA,QAEA,OACA,QAKA,QAGA,OACA,SACA,SACA,SAMA,QAGA,SACA,SAEA,SAKA,SAIA,KAAM,EAIN,KAAM,EAAwB,GAAI,GAAJ,cAC5B,GACA,EAMF,wUA+Ba,eAAiB,GAAM,SAA6B,wBACvD,2BAEA,sBAOA,kCAOS,sBAAc,GAKvB,+BAAuB,GAKvB,oBAuDA,iCAAyB,IAC/B,IAAI,KACF,kBAAO,MAGT,eAAI,KAAK,WAIP,MAAM,GAAW,KAAK,WACtB,gBAAM,EAAM,EAEZ,IAAM,EAAM,KAAK,WAAwB,eACzC,SAAM,EAAU,KAAK,qBAErB,UACE,kBAAQ,MAC0B,6BAAhC,CAEF,oCAGF,UAAK,YAAc,EAEnB,WACE,CADE,QAAK,qBACC,MACe,kBAArB,CAGL,yDAED,OAAO,MACR,WAEO,6BAGN,SAEA,KAAK,GAAQ,KAAY,KACvB,SAEH,cAEO,iBAA0B,OAChC,MAAM,GAAU,KAAK,qBAInB,YAEH,WAKO,sBAIN,WAEA,MAAM,GAAW,EACjB,UAAM,EAAW,EACjB,cAAM,EAEN,GAAI,KACF,MAAM,GAAQ,EACd,iCACE,GAIF,oBAJU,MACR,oDAGG,UAAY,GAAI,GAAJ,eACf,EAAM,MACN,EAIH,QACC,WAAK,UAAY,GAAI,GAGvB,8BAAK,UAAU,MAAM,KACrB,+BAAS,iBAAiB,UAAW,KACtC,kBAYO,yBAAqB,KAC3B,GACA,0BAAS,oBAAoB,UAAW,KACxC,wBACD,cAKO,oBAAe,IACrB,CAAK,KAAK,MAA0B,gBAAhC,EAAiC,KAIrC,iBAAK,MAAM,iBAAiB,KAAK,UAGjC,aAAK,UACN,KAEO,yBAGN,SAEA,IAAI,EAAE,KAAK,MAAM,eAAgB,GAC/B,4BAMF,yBAHE,mFAGE,KACF,MAAM,GAAO,EAEX,iCAAQ,MAEX,6CACD,MAAK,eAAe,KAAK,MAC1B,WAEO,yBAAqB,KACvB,CAAC,KAIL,iBAAK,UACL,eAAK,UAAU,MAAM,KACtB,sBAEO,2BAGN,SAEA,MAAM,GAAW,KACjB,8BAIA,IAJI,WAIE,GAAW,EACjB,sBAII,MAAC,EAIL,0BAAM,GAAQ,EAEZ,iDAIG,sBAAsB,EAAM,MAAO,EACzC,oBALW,MAIV,iDAGM,2BAGN,SAEA,MAAM,GAAW,KAEjB,2BAAI,KAKF,MAEA,iBAAI,EAAE,KAAK,MAAM,eAAgB,GAC/B,4BAMF,yBAHE,wFAGG,eAAe,KAAK,MAC1B,YACF,CAEO,4BAGN,SAEA,MAAM,GAAQ,EAEZ,iDAIG,sBAAsB,EAAM,MAAO,EACzC,qBALW,MAIV,+CAGM,+BAA2B,KACjC,MAAM,GAAQ,KAEd,4BAEE,SAGF,WAAM,GAAS,EACf,eAAiB,EAAV,KAAe,GAAU,EACjC,wBAEO,0BACN,IAUM,IAVC,OAAK,0BAUkC,SAC9C,MAAM,GAAyB,KAAK,YAMlC,aACA,eAAK,YAGP,gBAAM,GAAQ,EAEd,iBAAM,EAAW,mBAAiB,KAAK,MACvC,SAAI,KACF,MAAM,GAAkB,EAAQ,SAEhC,MAAI,GAEJ,KAAI,EACF,sBAA0B,SAAS,cACnC,UAAwB,aACtB,QAGF,+BAAS,OACP,gBAAC,EAAD,QAAQ,CAAS,SAAuB,UAG1C,oBAGF,qBAAM,GAAuB,SAAS,cAEtC,WACA,MAAI,KAAK,MAAM,eAAgB,GAC7B,+BAAa,KAAK,MAAM,KAAK,UAG/B,oBAAM,GAAQ,KAEd,qBAAM,EAAQ,KAAK,MAEnB,QAAS,OACP,gBAAC,EAAD,eAAe,CACP,OACM,aACL,QACP,SAAU,KAAK,MAAM,SACd,QACP,sBAAuB,KAAK,sBAC5B,mBAAoB,KAAK,mBACzB,YAAa,KAAK,kBAClB,YAAa,KAEf,sBACA,UACE,CACE,iBAAU,MAEb,KAGH,QAAM,GAA4C,KAChD,MACD,0BAED,EAAM,EAA4C,KAChD,MACD,0BAED,EAAM,EAA6C,KACjD,MACD,2BAEG,EAAC,KAAK,MACR,aAAgB,iBAChB,iBAAgB,iBAChB,iBAAgB,iBAGlB,mBAUA,qBAMA,QAAM,GAAgB,GAAI,GAAJ,WAAe,IACnC,MAAK,qBAEL,YAGE,+BAGE,0BAAC,KAAK,MACR,aAAgB,oBAChB,iBAAgB,oBAChB,iBAAgB,oBAGlB,mBAAK,IACN,WAKD,QAAK,YAIL,WAAgB,IACd,MAAM,GAAO,KAAK,YAEhB,gBAAK,YACL,YAEH,UACD,IAAK,GACN,WACF,CAEO,qCAAiC,KACvC,MAAK,WAAqB,IAAR,KAAe,KAAO,EACzC,WAEO,cAA0B,OAChC,GAMA,sBAAM,GAAM,EACZ,SAAM,EAAQ,EACd,gBAAM,EAAkB,EACxB,iBAAM,EAEN,OAAK,GAAI,GAAI,EAAG,EAAI,EAAM,OAAQ,IAChC,MAAM,GACN,KAAM,EACN,KAAM,EAAe,EAAQ,MAC7B,UAAK,KAAU,OAAS,GACtB,UAAU,CAAN,MACF,CADa,GAAM,KAAK,KAGxB,UAAY,KAAK,EAAK,OAI1B,SAAM,GAAqB,EAAY,KACvC,kBACD,YACF,CAkEO,iBAAa,KACnB,MAEA,8BAA0B,uBAAI,KAAK,MACpC,MAiIF,CA7oBS,MAAM,qBACZ,MAAM,GAAK,KACX,WAAM,EAAO,KAAK,MAClB,KAAM,EAAQ,KAAK,MACnB,MAAM,EAAO,KAAK,MAElB,WAOA,WAAM,GAAgB,KAEtB,MAAM,EAAc,EACpB,kBAAM,EAAW,KAAM,GAEvB,uBAAI,GAAC,EAAyB,KAI9B,eAAM,GAAQ,EAAG,UACjB,WAAM,EAAsC,QAArB,aAEvB,EAAM,EAAS,KAAM,GAErB,yBAAI,GAAC,EAAyB,KAI9B,eAAM,GACJ,MAAM,iBACN,eAAO,KAAK,MACZ,gBAAW,EACX,oBAAW,EAGb,aAAG,UACJ,YAEO,UACN,MAAK,WAEL,UAAK,YAAY,QAAQ,KAAc,EACvC,gBAAK,YAEL,iBAAS,oBAAoB,UAAW,KACzC,kBA2OO,CAAsB,wBAC5B,MAAM,GAAiB,KACvB,wBACE,QAAG,SAAS,EAAe,KAAM,EAEpC,IAwKO,CAEN,yBAEA,KAAK,KAAc,QACjB,MAAM,GAAY,EAAK,MAAM,OAAO,KAAK,EAAE,OAAS,eACpD,KAAM,EAAY,EAAK,MAAM,OAAO,KAAK,EAAE,OAAS,eACpD,WAAI,EAAU,SAAW,EAIzB,WAAK,GAAI,GAAI,EAAG,EAAI,EAAU,OAAQ,IACpC,MAAM,GACN,KAAM,EACN,QACE,EAAQ,KAAc,UACtB,EAAW,KAEX,SAGF,cAAM,GAAe,kBACnB,EAAQ,QACR,EAEF,SAAM,EAAW,EACjB,gBAAsB,CAAlB,GAAS,OACX,MAAM,GAAgB,EACtB,8BAAoB,CAAC,CAAjB,GACF,MAAM,GACJ,CACA,UAAI,EAAS,SAEf,GAAM,EACJ,CACA,UAAI,EAAS,SAAW,EAAS,OAEnC,KACG,SACkB,aAAO,CAAE,UAC/B,qBACF,CAED,MAAM,GAAc,EACpB,gBAAyB,CAArB,GAAY,OACd,MAAM,GAAmB,EACzB,8BAAuB,CAAC,CAApB,GACF,MAAM,GACJ,CACA,UAAI,EAAY,SAElB,GAAM,EACJ,CACA,UAAI,EAAY,SAAW,EAAY,OAEzC,KAAW,SAA8B,aACvC,WAEH,wBACF,CACF,CACF,CACF,CAQM,CAA0B,4BAG/B,MAAM,GACJ,EAAU,MACV,KAAK,MAAM,MACX,EAAU,KAAK,KAAO,KAAK,MAAM,KAInC,GAAM,EAAiB,EAAU,OAAS,KAAK,MAE/C,KAAM,EAAa,KACnB,cAA8B,QAC5B,MAAM,GAAa,EACnB,qBAAK,wBACH,MAAM,EACN,SAAK,EAER,IACC,WAAK,wBAGP,QAAI,GAAc,KAAK,MAAM,OAAS,EACpC,QAAW,UAAU,OAAQ,CAAE,KAAM,iBAMvC,WAAI,EAAU,eAAgB,GAA9B,2BACE,MAAM,GAAY,EAAU,KAC5B,UAAM,EACJ,KAAK,MAAM,eAAgB,GAA3B,2BACI,KAAK,MAAM,KAAK,UAItB,QACE,MAGF,YAAK,YAEL,UAAM,GAAQ,EACd,WAAK,qBAAqB,QAAkB,OAC1C,IACE,GAIF,oBAJU,MACR,uDAGI,GAAO,EACb,sBAAqB,OAAO,EAC5B,oBAAM,EAAa,EACnB,mBACD,cACF,EACF,CAEM,uBACL,MACD,SAEM,CAAmB,qBACxB,CAAI,KAAK,MAAM,OAAS,EAIxB,OAAI,KACF,iBAAK,WAAW,UAAU,OAAQ,CAAE,KAAM,iBAG5C,gBACD,qBAEM,oBACL,MACD,oBAEM,SACL,MAAM,GACJ,CACA,eACA,YACA,2CAAiB,CACjB,EACA,qBAAM,CAAE,KAAM,iBAEd,oBAAW,CACX,QAAgB,eAChB,SACA,mCACA,kBAcF,2EAAM,EAC8B,CAAC,CAAnC,QAAK,MAAM,KAAK,QAAQ,MAKpB,KAAK,MAEX,KANM,KAAK,MAEH,KACC,QAAQ,cAAe,UAI9B,iBAAC,EAAD,eAAe,CACb,UAAU,mBACH,QACE,UACT,mBAAoB,KAAK,mBACzB,UAAW,KAAK,UAChB,aAAc,KAAK,WACnB,IAAK,KAAK,8BACV,OAAQ,KAGb,QAzqB8D,EAAjE,E,2BCnFA,CAEA,YAEA,KAKA,IAAC,eACD,aAEA,uCACA,cAgCA,cACA,2BACA,OACA,eACA,cACA,iBACA,KACA,OACA,OACA,CAIA,kBAEA,CAEA,MAFc,MACd,MAEA,gBACA,SACA,kBACA,0BACA,OACK,iCACL,4CACK,6BACL,wBACK,WAAwB,qBAC7B,cACK,uBACL,mBACK,6BACL,wBACA,uBACK,2BACL,wBACA,qBACK,2BACL,wBACA,oBACK,kBACL,uBACA,+CACK,aACL,oBACA,QACA,WACO,cACP,QACA,wBACO,mBACP,IACA,aACA,8CAEA,oBACA,+BAEK,eACL,gBACA,WACK,UACL,gBACA,sBACK,eACL,iCACA,4BACA,6BACS,gBACT,YACA,iBAGA,mCACK,yBACL,GACA,qBACA,6BACA,+BACA,OACA,wBACA,QACA,wBACA,gDACA,YACA,qBACA,aACA,CAEA,cACA,qBACA,UACA,0BACA,mBACA,8BAEA,aACA,qBACA,gBAEA,qBACA,uBACA,SACA,CAEA,gBACA,cACA,cACA,cACA,GACA,WACA,KACA,GACA,MACA,oBACA,UAEA,gBACA,cACA,sBACA,+BAAkE,MAClE,GACA,WACA,KACA,OACA,OACA,+BACA,UAEA,gBASA,6BACA,oCACA,YAEA,YACA,OAAoD,mEACpD,kBACA,MAEA,aACA,SAA6B,EAAU,SACvC,gBACA,eACA,wBACA,OAAqB,CAAO,IAAO,KACnC,WAA2B,UAAoC,MAAO,KACtE,CAAO,eACP,IACO,eACP,QACO,sBACP,QACO,gBACP,CACA,IACA,KACA,EACA,WACA,cAIA,wBAGA,MACA,gBACA,cACA,YACA,YACA,sBACA,QAEA,gBACA,aAAoC,gBACpC,kBACA,qBAAoC,cACpC,iBAA8B,WAC9B,kBAEA,QAEA,sBACA,SAGA,UAAqB,WAAoB,2BAA8B,QAEvE,iCACA,qBAEA,YACA,wBACA,iBACA,8BACA,OACA,4BACA,6BAEA,cACA,CACA,CAIA,aAEA,4BAAsC,EAAQ,oBAC9C,aACA,aACA,CAEA,oBADA,aAEA,cACA,cACA,QAA2B,WAC3B,kBACA,SACA,QACA,UACA,mBACA,gBACA,mBACA,oBAAyB,cACzB,UAAK,KACL,oBACA,SACA,2BAA4B,cAC5B,YACA,CAEA,cACA,iEACA,aAIA,aAEA,mBAAwB,oCACxB,oBACA,YACA,aACA,qCACA,uCACA,IACA,gBACA,iBACA,oBACA,+CACA,0BAA0C,0BAA2C,UACrF,SACA,uDACA,UACA,EAEA,SADA,QAEA,aACA,UACA,gBACA,OACA,2CACA,8BAEA,KACA,cAGA,cACA,aACA,IAA2B,OAC3B,IACA,IACA,CACA,QAEA,gBACA,4CACA,2BACA,kCACA,4EACA,0BACA,MAAkB,WAClB,UAAkB,OAClB,IACA,uEACA,mBACA,YAEA,iCACA,mBACA,gCAA4D,0BAAuB,cACnF,eACA,kBACA,qBACA,gCACO,WACP,wBACA,UACO,oDACP,wBACA,2BAAuD,OAChD,iBACP,0BACA,cAEA,oBAGA,uCAA2E,OAAc,IAEzF,iCACA,uBACA,2CAEA,4BACA,8BACA,yBACA,YACA,uBACA,OACA,gBACA,OACA,UACA,gBACA,OACA,UACA,cACA,2BAEA,QADA,GAEA,kBACA,yCACA,OACA,gDACA,4CACA,UAEA,OACA,kCACA,mBACA,wBAA4D,0BAAuB,cACnF,4CACA,2BACA,uCACA,kBACA,aAAkB,WAAkC,IACpD,mBACA,kBACA,MACA,GACA,cACA,gBAAwB,cACxB,IACA,IAEA,gBACA,cACA,KACA,SACA,kBACA,OACA,YACA,4BACA,SACA,4CACA,iCACA,wCACA,uBACA,QAEA,KAA0B,WAC1B,OACA,6BACA,iBACA,2BACA,cAAgC,mBAAuB,UACvD,QACA,yCACA,0DACA,GAEA,YACA,gBACA,kBAC4C,0BAE5C,OADA,KADA,GAGA,cACA,IACA,wBACA,oBACA,WAEA,IACA,cACA,uBACA,SACA,WACA,cACA,uBACA,SACA,WACA,cACA,mBACA,gBACA,6BACA,SACA,MACA,CACA,gBACA,IAA4B,6BAAuB,UACnD,IACA,gBACA,IAA4B,6BAAuB,UACnD,IACA,cACA,cACA,aACA,OACA,cACA,wBAA6B,WAAuB,WACpD,GACA,gBACA,IACA,4BACA,WACK,2CACL,cACA,oCACA,SACA,uEACA,yDACA,QACA,IAAK,oBACL,8CACA,YACK,MACL,oBACK,SACL,gBACA,UACK,MACL,eACK,QACL,YACK,OACL,kBACA,UACK,MACL,OAEA,WACA,cACA,gCAEA,WACA,OAFA,IAGA,cACA,cACA,YACA,YACA,kBACA,gBACA,6BACA,gBACA,gDACA,kBACA,mBACA,IACA,IACA,IACA,mBACA,MACA,KACA,qBACA,mBACA,IACA,MACA,CACA,kBACA,WAAmB,cAAsB,OACzC,eACA,8BACA,SACA,cACA,OAAkB,OAClB,IACA,MACA,gBACA,OACA,iBACA,sBACA,KACA,CACA,cACA,QACA,mDACA,SAEA,IACA,gBACA,IACA,yBACA,UAEA,GACA,gBACA,sBACA,UACA,sBACA,UAEA,iBACA,OAGA,0CACA,6BACA,UAAkB,WAAyB,SAAyB,IACpE,wBACA,cACA,cACA,kBACA,KACA,gBACA,sBACA,+BACA,WACK,MACL,OACK,KACL,OACK,KACL,eAEA,cACA,cACA,qBACA,YACA,WACA,gBACA,2BACA,yBACA,gBACA,sBAAsD,2BAAuB,UAC7E,YACA,gBACA,+BACA,SACA,cACA,OACA,QACA,iBACA,iBACA,KACA,cACA,OACA,cACA,iBACA,YAAoC,gBAAuB,UAC3D,OAA6B,eAAiB,KAC9C,iBACA,kBACA,KAAkB,YAClB,WACA,iBACA,sCACA,uCAIA,wBACA,MAAkB,OAClB,QACA,cANA,KAEA,MAKA,iBACA,iBACA,KACA,eACA,iBACA,MACA,iBACA,gDACA,YACA,eACA,gCACA,OACA,eACA,uBACA,SAAkB,OAClB,oBACA,YACA,QACA,iBACA,gBAAyC,mBAAuB,UAChE,MACA,OACA,iBACA,OAAkB,OAClB,eAAyC,mBAAuB,UAChE,YACA,QACA,eACA,SACA,IACA,iBACA,eAAuB,UAAsB,UAC7C,sBAA6C,KAC7C,8BACA,uCACA,iBACA,iBACA,eACA,oBACA,UAAoC,gBAAuB,UAC3D,OACA,UACA,iBAEA,qBACA,QACA,OACA,iBACA,wBAA6C,MAC7C,KACA,iBACA,4BACA,8CACA,SACA,WAAkB,WAClB,iBACA,iBACA,OACA,YACA,qDACA,uBACA,sCACA,UAEA,sBACA,+BACA,aAEA,cACA,oBACA,aACA,kBACA,UAEA,OAAkB,OAClB,MAAkB,OAClB,WACA,cACA,iBACA,cACA,aACA,eACA,KACA,KACA,iBACA,OAAuB,kBAAuB,iBAC9C,OAA6B,wBAAuB,gBACpD,OAAkB,cAAuC,UACzD,MACA,IACA,iBACA,OAAwB,mBAAuB,cAC/C,4BACA,cACA,eACA,mBAC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ChC,uBAAwB,KAAK,MAGlC,wBACC,OAAO,GAAY,cAEtB,8BAEM,SACL,OACE,iBAAC,EAAD,OAAO,CAAC,GAAG,aAAa,UAAW,KAAK,WACrC,KAAK,gBACL,KAGN,gBAxOF,EAHD,E,kCC9DA,WACA,uBAEA,oFAEA,uCACA,eACA,+CACA,mCACA,WAEA,QACA,gBACA,SAGA,kBACA,mBACA,aAGA,UAEA,wBACA,qBACA,KACA,qDAEA,UACA,YAEA,aACA,gCAEA,MACA,YAEA,aACA,YAEA,YACA,SACA,aAEA,eACA,MACA,IACA,gBACA,OACA,KACA,WACA,eAEA,WACA,oBACA,EACS,QACT,CACA,IACA,KAEA,CACA,IACA,MACA,UACA,eACA,KAEA,IACA,CAIA,mBAHA,SAEA,eAGA,qBACA,SACA,iBACA,EACA,UAEA,WACA,kBACA,YAEA,WACA,MACA,8BACA,IACA,YAGA,SACA,KACA,qBACA,eAEA,iBACA,iBACA,SACA,WACA,OACA,eAEA,WACA,eAEA,eACA,IACA,IACA,OACA,UACA,OACA,WACA,OACA,OAEA,UAEA,OACA,OACA,MACA,cAEA,MACA,QAEA,qBACA,uDACA,MACA,YAEA,OACA,UACA,aACA,WACA,oBACA,QACA,WACA,WACA,IACA,IACA,IACA,UACA,QACA,KACA,EACA,YACA,OAEA,SACA,EACA,aACA,IACA,IACA,IACA,QACA,EACA,SACA,IACA,EACA,IACA,aACA,iBACA,qBAEA,gBACA,OACA,KACA,IAEA,KACA,IAEA,KACA,KACA,IAEA,OAEA,EACA,OACA,cAGA,gBACA,MACA,IACA,MACA,OACA,YACA,aACA,MACA,OACA,IACA,KACA,MACA,OACA,IACA,IACA,MACA,cACA,KACA,IACA,SACA,EACA,MACA,QAGA,MAEA,SADA,WAGA,CAAC,+BCtND,WACA,aAEA,MAEA,SAEA,SAEA,kBACA,UACA,SAEA,iBACA,kBACA,KAEA,2BACA,6BACA,QACA,4CACA,yCACA,IACA,UACA,eAA0C,QAAW,UAErD,SACA,QAGA,UACA,aACA,aACA,CACA,YAEA,WAKA,Q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D,WACA,OACA,cACA,SACA,MACA,YACA,eACA,OACA,mBACA,4BACA,SACA,SACA,EACA,iCAEA,MACA,QAAC,S,uBChCD,CACA,YAEA,oBAA0C,SAAqC,wBCH/E,OACA,uB,qGCDA,0BAIA,sBCJA,YACA,uBACA,UACA,W,mBCHA,UAAkB,gB,+BCElB,aACA,YACA,SACA,oBACA,IACA,uCACA,+BACA,UACA,0CACA,kBACA,IACA,4DACA,OACA,oBACA,OAAO,SAAU,CAAc,IAC/B,qBACA,CAIA,MAHA,YACA,YACA,QAEA,CAAK,EACL,eACA,yBCzBA,CACA,YACA,gBAA8B,sBAA6C,uBCF3E,OACA,uB,gCCDA,UAAkB,gB,4CCAlB,CACA,aACA,oCACA,OACA,a,kBCJA,CACA,YACA,qBACA,SACA,eACA,WACA,eACA,SACA,SACA,EACA,oCAEA,QACA,Q,kBCZA,SACA,YACA,WAAkB,GAElB,2CACA,uDAEA,gBACA,IACA,OACA,KAAG,SACH,UACA,OACA,GAEA,yBACA,wCACA,OACA,K,mBCnBA,QACA,YACA,uBACA,WACA,SACA,eACA,SACA,EACA,0BACA,Q,mBCPA,qBACA,QACA,SACA,SACA,SACA,QACA,SACA,SACA,SACA,SACA,SACA,QACA,SACA,SACA,SACA,SACA,SACA,QACA,SACA,YACA,YACA,WACA,QACA,WACA,YACA,UACA,SACA,eACA,WACA,uBACA,aACA,8BAGA,2BACA,OAGA,QAH2B,OAC3B,eAAoB,oBAA4B,MAAS,IAAI,CAC1D,MACF,kBACD,OACA,gBACA,MACA,mBACA,QAEA,iBACA,gBACA,WASA,SARA,iBACA,CACA,+BACA,2BACA,0BACA,KAEA,KAGA,eACA,OACA,kBAEA,mBACA,WACA,UACA,8BAIA,mBAAsB,aACjB,6BAJL,KAEA,YAGG,UACH,QACA,iBACA,CACA,mBACA,QACA,MACA,OACA,oBACA,MACA,QACA,iBACA,0BACA,OACA,eACA,cACA,mDAEA,cACA,iBACA,WACA,QAEA,yCADA,gBAEA,eACA,aACA,QACA,KACA,EACA,qCACA,QACA,QACA,eACA,aACA,QACA,KACA,EACA,oCACA,MACA,QACA,eACA,kBACA,iBACA,MACA,IACA,YACA,uBACA,iBACA,0BACA,iCACA,iBACA,iBACA,QACA,KACA,OACA,WACA,gBACA,OAIA,4BAAiE,SAAR,OACzD,kBAIA,mBACA,4BACA,uEACA,WACA,qCACA,aACA,EAEA,gBACA,OACA,eAEA,IACA,WACA,WACA,YACA,YACA,wBACA,QAEA,mBACA,UAEA,8BAEA,MAEA,gBACA,eACA,IACA,UACA,IAEA,oBACA,OACA,OACA,sBAAwB,CAAe,IACvC,sBAAwB,CAAgB,IAYxC,GACA,YAGA,uIACA,OACA,cACA,IAAC,GAED,KAEA,WAAgD,WAEhD,kBAEA,sBAEA,CAEA,SAEA,iBAEA,mBAEA,2BAEA,sBAGA,0BACA,6BAEA,cACA,IACA,UACA,OACA,WACA,S,4BClOA,OACA,OACA,gB,wBCFA,UAAkB,gB,4BCAlB,uBACA,QAAU,cACV,G,eCFA,oBAA4B,C,mBCA5B,aACA,QACA,SACA,SACA,QAKA,IACA,4CACA,SACA,aACA,OAEA,IAAC,YACD,YACA,UACA,UACA,oBACA,aACA,YAEA,gBACA,qBACA,aACA,MAAC,EAED,UACA,oBAEA,UACA,YACA,E,4BCjCA,aACA,QACA,QACA,SACA,OAEA,GACA,qCAAkF,OAAa,KAAE,GAEjG,yBACA,yBAAuD,OACvD,aACA,Y,cCZA,CACA,WACA,kBACA,qBACA,uBACA,W,mBCLA,QACA,SAEA,KACA,qBACA,qBACA,OACA,UACA,SACA,SACA,qBACA,eACA,sEACA,YACA,qDACA,MACA,C,mBChBA,OACA,OACA,gB,6BCFA,UAAkB,gB,gCCAlB,YACA,yBACA,UACA,c,eCHA,qBACA,2CACA,uBACA,Q,kBCHA,CACA,aAEA,mCACA,mBACA,UACA,KACA,CAAC,oBCPD,OACA,uB,6CCiOE,eAGA,MAAM,GAAgB,IAAW,EAAU,EAAI,EAC/C,QAAO,GACR,iDAvOD,qBACA,OACA,QACA,SACA,QACA,SACA,SAQA,SACA,QA2MA,KAea,eAAa,GAAM,SA6B9B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BACA,KACA,IAEA,UACA,eACA,eACA,cAEA,iBACA,aAYA,OACA,UACA,IACA,SAdA,CAIA,iBACA,KAEA,KAGA,GAOA,CACA,eACA,IACA,sBACA,eACA,QACA,mEACA,WAAG,SACH,CACA,QACA,YA7GA,QACA,YACA,kBACA,mBACA,oBA2GA,UACA,CACA,6BClHA,uBACA,QACA,OACA,aAYA,UAVA,eACA,WAEA,aACA,iBAGA,gBACA,uCCbA,uBACA,OACA,YACA,oBAqBA,UAnBA,iBACA,CACA,uBACA,MAGA,cAEA,eACA,SACA,SAEA,mCACA,OACA,YAGA,uCCjBA,iBACA,CACA,UACA,MAGA,IACA,wBAGA,kBACA,WAEA,MAEA,KACA,4BACG,kBACH,mBAGA,oCACA,YAEA,QAEA,QACA,MACA,4BACA,KAAK,SAEL,8BACA,QAEA,aAEA,KAEA,GACA,OACA,GAEA,eACA,MACA,GACA,wBAGA,qBAEA,MAEA,KACA,4BACG,kBACH,mBAGA,gBACA,oBAEA,QACA,uBACA,QAAG,SACH,CACA,KAGA,yBAFA,qBAIA,KACA,EAEA,mBACA,CACA,UACA,MAEA,SACA,WAEA,4BACA,SACA,2BACA,YAEA,SACA,MACA,yCACA,IAAG,SACH,iBACA,KAEA,GACA,mBAEA,iBACA,MACA,WAEA,4BACA,SACA,2BACA,YAEA,wCAEA,cACA,qBAEA,aAEA,CAGA,yCAFA,+BACA,KAGA,CA5HA,MACA,GACA,KACA,GAAC,SACD,KACA,IA+HA,UAPA,QACA,KACA,WACA,eACA,YACA,kCChIA,2BACA,sBAEA,uBACA,mBACA,KACA,0BACA,kCACA,wBACA,gCACA,sBACA,8BAEA,6BCfA,aAEA,cAyBA,UACA,CACA,YAzBA,eACA,UACA,2BACA,4BACA,uBACA,gBACA,wCACA,SAEA,WAiBA,gBAfA,aACA,IAEA,QACA,YACA,KACA,YAAG,SACH,OACA,MACA,iCACA,0BCvBA,uBACA,OACA,YAsBA,WAqEA,UACA,CACA,aArEA,eACA,MACA,+BAEA,4CACA,iBAEA,aACA,CACA,QAGG,eACH,WACA,eACA,qBACA,SAEA,cACA,CACA,QAGA,oBAEA,4CACA,iBAEA,aACA,CACA,gBAKA,iBACA,GAkCA,iBAhCA,aACA,IACA,sBACA,QACA,iCACA,yCACA,CACA,QAEA,QAAG,KACH,WACA,eACA,UAEA,OADA,sBAEA,CACA,QAGA,gBACA,iCACA,yCACA,CACA,gBAGA,cACA,qBC3FA,2BACA,iBACA,OACA,QACA,QACA,WAEA,eACA,SACA,iBAEA,qBACA,SACA,gBAEA,mCA0CA,UACA,eACA,EA1CA,iBACA,GACA,2BAEA,4BACA,SACA,SACA,iBACA,SACA,cACA,yBACA,YACA,gBACA,eACA,SACA,SACA,0BACA,OACA,YAGA,kBAGA,QAmBA,kBAjBA,eACA,WACA,cAEA,eACA,WACA,YACA,mBACA,eACA,yBACA,oBACA,OACA,wCCvDA,2BACA,iBACA,OACA,QACA,uBAmDA,UACA,YACA,EAnDA,eACA,gBACA,YACA,OACA,YAEA,MAEA,KACA,SACA,SACA,0BACA,CACA,gDACA,cAGA,eACA,eACA,SACA,OACA,uBACA,OACA,SAGA,SAEA,MAwBA,eAtBA,aACA,WACA,cAEA,UACA,GACA,YAAG,SACH,CAEA,0CADA,eAGA,WACA,eACA,yBACA,iBAEA,gBACA,mCCrDA,2BACA,iBACA,OACA,QACA,uBAuCA,UACA,YACA,EAvCA,aACA,aACA,kBACA,OACA,SAEA,KAEA,iBACA,yBACA,eACA,eACA,SACA,OACA,oBACA,OACA,SAGA,MACA,KAoBA,eAlBA,WACA,IACA,MACA,KACA,WAAG,UACH,WAEA,qBACA,aACA,iBAGA,gCACA,wBCzCA,uBACA,SACA,cAEA,UAEA,cACA,4BACA,4BACA,4BAEA,4BACA,4BACA,4BACA,4BAEA,+BACA,kCACA,kCACA,kCACA,oCCpBA,aAMA,aACA,CACA,CACA,SACA,QACA,OACA,QACA,QAEA,wBACA,YACA,QACA,kBACA,IAEA,kCACA,EAEA,iBACA,OAEA,EACA,uBACA,MAGA,QACA,wDACA,qEACA,0CACA,6EAEA,oCAEA,wBACA,MACA,6CACA,oCACA,CACA,YAEA,4BACA,WAGA,uBACA,KAEA,CACA,IACA,EAYA,CACA,iBACA,CACA,KACA,OAIA,uCACA,OACA,2BAQA,kBACA,cAGA,gCACA,MACA,IACA,2BAEA,SACA,iBAEA,MAEA,eACA,wBAEA,WACA,OACA,KACA,EACA,GAEA,mBACA,CACA,KACA,OAEA,uCAGA,2BAEA,uBAEA,wBAEA,uBACS,UACT,cAEA,aAEA,WAEA,EACA,GAEA,iBACA,IAEA,GACA,KAEA,sBAGA,WACA,eACA,IAAG,SACH,IACA,kBAEA,OAEA,OAEA,IACA,KACA,WAAG,SACH,IACA,kBAEA,OAEA,OAEA,GACA,cAEA,WAEA,cAEA,mBACA,CACA,KAEA,sBAEA,UAKA,qCACA,8CACA,kBACK,YACL,mBAEA,KAEA,IACA,GAEA,iBACA,CACA,KACA,OAEA,yCACA,YAEA,cACA,OAEA,iBAEA,+BACA,iBAIA,kBACA,UACA,UAGA,YACA,EACA,EAIA,CACA,eACA,IAEA,QACA,GAEA,SACA,wDACA,uCACA,2DAEA,uCACA,KACA,YAAG,SACH,IACA,kBAIA,OAGA,gBAEA,IAEA,MACA,oBAEA,QAEA,aAAG,SACH,IACA,kBACK,UACL,uBACK,aACL,kBAEA,QACA,QACA,EAEA,iBACA,CACA,KAEA,sBAGA,WACA,GACA,YAAG,SACH,IACA,mBACK,yDACL,iBACK,eACL,kBAEA,OACA,EAEA,eACA,CACA,KACA,uCAQA,sBACA,QACA,IACA,IACA,SACA,WACA,eAEA,MADA,OACK,QACL,aACA,QACA,CACA,qBAnTA,QACA,OAEA,UAkTA,YACA,0BCvTA,aA0BA,aACA,IACA,MACA,KACA,cAAG,SACH,UACA,aAEA,gBACA,KACA,YACA,aACA,iBArCA,iBACA,QACA,OACA,QAEA,sBACA,iBACA,qBACA,aAOA,WACA,+BAEA,OACA,SAEA,MAJA,GAKA,YAZA,gCAEA,WAEA,IASA,EAAC,GAgBD,UACA,CACA,eACA,eACA,WACA,6BC7CA,aASA,oBAEA,wBAGA,0BAGA,YALA,MACG,oBAKH,OAEA,mCACA,oDAGA,8BACA,oCAIA;kEAnBA,OAoBA,SACA,cACA,eAEA,cAEA,qBACA,WACA,eACA,SACA,OACA,sBACA,OACA,KAGA,eAEA,qBACA,iBACA,eACA,aAEA,uBACA,qCAEA,SACA,aAEA,WACG,SACH,MAEA,qBACA,gCACA,iBACA,YAEA,6BACA,iBACA,YACA,uCACA,kCACA,mBACA,GAEA,uBACA,gBACA,2BACA,aACA,aAEA,qBACA,UACA,0BACA,OACA,KAEG,gBACH,yBAA4B,KACzB,qBACH,IAEA,qBACA,OACA,6CACA,OACA,KAGA,YACA,aAEA,qBACA,WACA,4DACA,+BAA2C,QAC3C,yBACA,sBACA,0BACA,WACA,GAEA,mBACA,kBACA,OACA,OACA,iCAEA,SAEA,KAEA,uBACA,IACA,YACA,oBAA0C,iBAAsC,oCAEhF,OACG,mBACH,OACA,mBAA0C,iBAAsC,oCAEhF,OAEA,WACA,WAEA,mBACA,UACA,SACA,OACA,cAIA,uBAJ6D,oCAAyB,sBAEtF,QAIA,qBACA,kBACA,OACA,2BACA,OACA,KAGA,aAEA,mBACA,aACA,SACA,KAEA,cAEA,qBACA,WACA,eAEA,eADA,IAGA,uBACA,WACA,cACA,gBACA,SACA,oBACA,OACA,KAGA,eAEA,qBACA,cACA,SAEA,QACA,kCAGA,iBAGA,SAEA,kBACA,kCAEA,kBAKA,kBACA,SACA,sBACA,mBAAmD,sBAAuB,YAE1E,OAIA,WAEA,iBACA,YACA,OACA,OAEA,eAGA,CACA,eACA,8BACA,4BAEA,qBACA,YAEA,YAEA,CACA,eACA,cAEA,6BAGA,gDAEA,QAEA,OAEA,SAEA,eAEA,WACA,eAGA,sCAGA,cAEA,iBACA,KACA,SACA,YACA,yBACA,mDAGA,2BACA,mDAGA,mBA9QA,QACA,WACA,eACA,oBAEA,sBACA,kCA0QA,6BCjRA,aAMA,iBACA,IACA,uBAAY,CAGZ,iBACA,eAQA,SACA,0BAEA,eAEA,UAEA,cACA,GACA,iBACA,IAAG,SACH,sBACA,qBACA,cACA,gBACA,QAAK,KAGL,IACA,MACA,KACA,WAAO,SACP,CACA,OACA,qBACA,OACA,CAEA,CACA,mBAhDA,QACA,YAEA,sCA+CA,6BCnDA,aAMA,mBACA,CACA,sBACA,MACG,SACH,wBAAY,CASZ,oBACA,eAEA,MACA,0BAEA,eAEA,sBACA,MAEA,4BACA,IACA,YACA,OAEA,iBACA,UACA,mCACA,8BACA,GACA,OACA,UACA,GAKA,MACA,wBAGA,qBACA,SACA,OAGA,IACA,aAzDA,QACA,YAEA,sCAwDA,6BC5DA,aAQA,kBAEA,0BAGA,gBACA,mCACA,oDAGA,8BACA,oCAIA;kEAdA,SAgBA,uBAEA,uBACA,mCACA,KACA,YAEA,mBACA,qBACA,mBACA,WAEA,mBACA,oCACA,YAEA,8BACA,uBACA,YACA,uCACA,gCACA,kBAEA,qBACA,gBACA,yBACA,WACA,WAEA,mBACA,MACA,mBACA,cACG,gBACH,6BAAwB,KAExB,oBAEA,mBACA,OACA,qCACA,kCACA,QACA,iCAIA,eACA,WAEA,mBACA,MACA,aAEA,uBACA,0BACA,gBAEA,YACA,wBACA,uBACA,KACA,IAEA,iDAEA,SACA,eACA,aAEA,qBACA,UACA,IACA,uBAAsC,iBAAsC,oCAE5E,YACA,WAAG,UACH,IACA,uBAAsC,iBAAsC,oCAE5E,YACA,SACA,OACA,UAEA,iBACA,mBACA,8BAAuD,oCAAyB,sBAEhF,YACA,UAEA,mBACA,wBACA,sBACA,MACA,SAEA,iBACA,+BACA,YAEA,mBACA,WACA,cACA,YACA,aACA,YAEA,mBACA,SAEA,qBACA,kCAGA,iBAGA,eAEA,sBACA,kCAEA,WAKA,wCACA,uBAA2C,sBAAuB,YAElE,YAEA,SAEA,eACA,UACA,gBACA,gBAGA,CACA,eACA,8BACA,4BAEA,qBACA,YAEA,YAEA,CACA,aACA,IACA,MACA,KACA,eAAG,SACH,sBAGA,kDAEA,SACA,OACA,CACA,SAEA,eAEA,WACA,eAGA,sCAGA,cAEA,eACA,SACA,qBACA,2BACA,gDACA,QAEA,2BACA,gDAEA,mBArNA,QACA,WACA,oBAEA,0BACA,kCAkNA,6BC1NA,oBAEA,UAEA,WACA,gBAMA,+BAEA,mBAEA,YAEA,UACA,eACA,UACA,iBAEA,qBACA,cACA,SAEA,sBAGA,oBACA,gBAA6C,SAAgB,IAC7D,MACA,aAGA,6CAEA,8BACA,0BACA,sBAEA,2CACA,aACO,uCACP,oBAGA,2CACA,oBAGA,sCACA,KAEA,OACA,wEAQA,kBACA,kBAIA,qBACA,YACA,YACA,QACA,mCAhBA,GACA,OAIA,EAaA,gBACA,+BAEA,mBAEA,WACA,eACA,UAEA,uBACA,kBACA,mBACA,sBAEA,OAGA,oBACA,gBAA6C,SAAgB,IAC7D,MACA,aAGA,4BACA,0BACA,sBAEA,6BACA,6BAGA,uCACA,KAEA,MACA,oBAEA,GACA,8BACA,4DACA,mBAEA,QACA,OA/GA,CACA,aAGA,6BCVA,kB,6BCAA,CAqJA,aACA,yBACA,GACA,oBAEA,yBAEA,kBAKA,mCACA,sBACA,MACA,KACA,EACA,EACA,EAEA,4BACA,iCAIA,aACA,KACA,KACA,KACA,gBACA,IAAK,QACL,CACA,QACA,GACA,YAAS,UAET,QAEA,YACA,CACA,QACA,EAEA,aACA,kBACA,yCACA,mCAEA,kBAGA,sCACA,sBACA,MACA,KACA,EACA,EACA,EAEA,+BACA,sBACA,WAEA,KADA,KAEA,KACA,mBACA,IAAO,QACP,CACA,QACA,GACA,YAAW,UAEX,QAEA,YACA,CACA,QAGA,+BAA4C,uBAC5C,2BAEA,GAEA,aAEA,yBACA,gCACA,UACA,sBACA,UACA,EACA,IAEA,aAEA,uBACA,IACA,UACA,WAAK,SACL,UACA,OACA,CACA,IAGA,aAEA,2BACA,kCACA,UACA,sBACA,UACA,EACA,IAEA,aAEA,yBACA,IACA,UACA,aAAK,SACL,UACA,OACA,CACA,IAGA,aAIA,uBACA,gCACA,gCAEA,6BACA,4BACA,yBAHA,UAIA,EACA,IAEA,aAIA,qBACA,SACA,UAGA,wBAFA,6BACA,aAEA,GAaA,CACA,aACA,IACA,GAEA,YACA,kBAEA,gCAEA,qDAKA,2BAxUA,SAEA,eACA,MAEA,kDAEA,sBAEA,CAEA,oBADA,aAEA,GACA,SACA,KAAC,WAED,oBACA,yBACA,GACA,YACA,YAEA,UA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,iCACA,OACA,QACA,UAEA,UAAmB,OAAmB,iBAMtC,sBACA,CACA,eACA,qBACA,mBAEA,yCACA,IACA,GAIA,cAJ6B,4BAC7B,YAOA,2BACA,iBACA,SACA,eACA,iBACA,iDAGA,oCAAuF,kDACvF,kIAEA,iCACA,mBACA,OACA,OACA,IAEA,KAEA,MACA,MACA,OACA,0BAA6B,mBAM7B,kBACA,gLAAiK,WAGjK,WAEA,KACA,GACA,UAEA,sCAEA,oBACA,mBAEA,kBACA,EAEA,qBACA,kBACA,8BACA,WACA,mBACA,QAEA,OACA,KACA,EACA,EA2BA,yBC9JA,cACA,6CCDA,GAOA,GAEA,YAEA,CAOA,mBAGA,MACA,aACA,cACA,WAGA,UACA,SACA,SACA,WACA,YACA,iBACA,YACA,WACA,WACA,YACA,aASA,qBACA,OACA,UACA,mBACA,6BAEA,MAGA,KACA,QACA,mBACA,SACA,sBAIA,4CACA,sBACA,UACA,aACA,mBACA,mBA3CA,6CA4CA,SACA,kBACA,uDACA,GASA,KAEA,kBAGA,uBASA,kBAEA,OACA,WACA,WAGA,cAEA,gBAEA,SACA,SAAmC,MAAkB,OACrD,QACA,OAEA,mBACA,WACA,qBAEA,2BAGA,qBAEiC,GAEjC,6CAEA,mCAKiC,2CAFjC,WAGA,2DAGA,qBAKA,cACA,CAGA,CAEA,mBAEA,QAEA,4BACA,yBAAmC,SAAmB,OACtD,aACA,iBAGiB,+BACjB,cAGA,gBACA,QASA,KAEA,SACA,WACA,SACA,OACA,SACA,SACA,WACA,eACA,eACA,eACA,WAKA,cACA,QACA,OACA,oBAGA,eACA,OACA,gBAEA,iBACA,KACA,aAKA,eACA,SACA,SACA,IACA,iBACA,kBACA,aACA,sBACA,gBACA,WACA,WACA,aACA,sBACA,cAYA,YAEA,UAGA,CACA,6BACA,8CACA,+BACA,kCAEA,CACA,iDAEA,CACA,uCAGA,CACA,uBAIA,gEAEA,6DAGA,4BACA,wBAEA,mIAEA,CACA,0DAEA,CACA,kCAEA,CACA,4CAEA,CACA,yCAEA,CAEA,iFAEA,CACA,gDAEA,CACA,iDAEA,CACA,0BAEA,CACA,wCAEA,CACA,0DAEA,CACA,yCAEA,CACA,yDAEA,CACA,4DAEA,CACA,8EAEA,CACA,wFAEA,CAEA,sEAEA,CACA,0CAEA,CACA,0DAEA,CACA,6CAEA,CACA,wCAEA,CACA,uEAEA,CACA,wDAEA,CACA,2FAEA,CACA,0BACA,oCAGA,CACA,wDACA,CACA,cAEA,gGAEA,2EAGA,0CAEA,8EACA,wBACA,4BACA,iCACA,4BAkHA,YAEA,CACA,+DAEA,CACA,iCAEA,CACA,uCAGA,CACA,4CAEA,CACA,sEAEA,CACA,gCAEA,CAEA,qHAGA,oBAEA,CACA,yDAEA,CACA,0DAEA,CACA,kDAEA,CACA,yBACA,oBACA,kBACA,uBACA,+BACA,gDAEA,CACA,8DACA,CACA,yGAEA,CACA,+CACA,CACA,gDAEA,CACA,2BAEA,oGACA,qBACA,8BACA,CACA,8CAEA,CACA,kGAEA,CACA,mCACA,qEACA,CACA,oEAEA,CACA,cACA,wCAEA,CACA,uDAEA,CACA,wDAEA,CACA,6FAEA,CACA,yDAEA,CACA,qCACA,gBAEA,oGAEA,CACA,mCAEA,CACA,4BACA,uCAEA,CACA,6CAEA,CACA,6DACA,CACA,4DAGA,CACA,kFACA,mBACA,uBACA,wCACA,CACA,yEAEA,CACA,wFAEA,CACA,+DAEA,CACA,8CAEA,CACA,8EACA,wCACA,CACA,oCACA,CACA,qDACA,oCACA,2CAEA,CACA,uCAEA,CACA,oCACA,kDAEA,CACA,0DAEA,CACA,wDACA,CACA,oEACA,CACA,iCACA,CACA,iBACA,sBACA,uDAEA,CACA,2DAEA,CACA,mCAEA,CACA,yCAEA,CACA,sDAEA,CACA,0CAEA,CACA,mDAEA,CACA,mDAEA,CACA,0DAEA,CACA,gCACA,qDACA,iHAEA,CACA,4DAEA,CACA,qDAEA,CACA,8DAEA,CACA,iEAEA,CACA,qEAEA,CACA,gGAEA,CACA,oEAEA,CACA,kEAEA,CACA,mEAEA,CACA,8DAEA,CACA,kEAEA,CACA,8CACA,yFAEA,CACA,+DAEA,CACA,sEAEA,CACA,oGAEA,CACA,uEAEA,CACA,oFAEA,CACA,qEAEA,CACA,uEAEA,CACA,kEAEA,CACA,6DAEA,CACA,qDAEA,CACA,uDAEA,CACA,uBACA,sDAEA,CACA,kCAuDA,qBAEA,CACA,kDAEA,CACA,uBACA,+DACA,0CACA,sCAEA,CACA,2BAGA,WAGA,CACA,2CACA,CACA,+BACA,kDACA,yFACA,CACA,uFAGA,CACA,qCACA,CACA,gCACA,0BAEA,qFACA,8BACA,CACA,uEACA,CACA,sBACA,CACA,4DAGA,CAGA,iDACA,yBACA,6BAGA,0JACA,6BACA,6BAEA,CACA,qDAGA,CACA,6CAGA,CACA,yDAEA,CACA,yBAEA,CACA,uBACA,+EAEA,CACA,iCACA,8DAGA,CACA,wCACA,qCAEA,+DACA,wBASA,uBACA,CACA,UACA,SACA,eACA,CACA,SACA,mBACA,CACA,UACA,UACA,SACA,EACA,IAEA,mBAEA,IACA,qBACA,IAGA,YACA,qCAGA,wEACA,UAp3BA,UAq3BA,gBACA,QACA,QACA,QACA,QAEA,uCACA,CAGA,wBAFA,2BACA,UAEA,wBACA,CAEA,wBADA,MAEA,2BACA,CAEA,wBADA,SAEA,2BACA,CAEA,wBADA,SAEA,uBACA,CAEA,wBADA,KAEA,2BACA,OACA,SACA,qBACA,yBACA,oBACA,oBACA,qBAEA,SACA,uBACA,CACA,QACA,wBACA,OACA,OACA,QACA,QACA,QACA,QACA,MACA,IACA,EACA,IAEA,IACA,QA36BA,mBA46BA,CACA,OACA,MAv6BA,QAy6BA,iBACA,CAEA,yBACA,CACA,QACA,SACA,OACA,UACA,SACA,UACA,SACA,WAEA,SAp6BA,qBAq6BA,CACA,OAEA,gBACA,CACA,OAUA,WAEA,cAOA,kBACA,CACA,QAAa,iCAGb,mBASA,4BApBA,cAEA,aAGA,kCAgBA,sBACA,OACA,aACA,+BACA,UACA,OACA,sBACA,GACA,iBACA,mBACA,gBAEA,IACA,CAEA,CAAC,qDCxgCD,aACA,uBACA,MAEA,gCACA,2EAIA,qCACA,UAEA,cACA,SACA,yBAEA,uBACA,SAEA,kDACA,gBAEA,IAEA,oBAEA,WAMA,eALA,CACA,oCAGA,MAGA,EAIA,sCAHA,6BAEA,qBCrCA,aAEA,2BACA,sCACA,2BAEA,sBACA,4DACA,mCAEA,sBACA,2DACA,mCAEA,oBACA,yBACA,aAEA,uBACA,sDACA,qDCnBA,qBACA,YAEA,qBACA,MAEA,8BAGA,OAEA,GAJA,EAKA,uBACA,sBACA,kBAIA,sCAEA,qDACA,yBCtBA,aACA,qBACA,0BACA,6BAEA,QASA,kBARA,8BAGA,eACA,8BAGA,oBCXA,aAsCA,YAKA,OACA,MAEA,2BAlCA,aACA,IAuBA,IAWA,yBACA,wBA9CA,aACA,IAEA,GAKA,2BAJA,0BACA,qBAEA,0BCNA,iBACA,uBACA,SACA,OACA,GAMA,eACA,oBACA,OAEA,eACA,SACA,SACA,QAEA,QACA,qCACA,mBACA,qCAEA,gCACA,oBACA,oBACA,GAQA,MALA,WACA,YACA,UAHA,MAKA,MAvCA,YACA,OAUA,aACA,YACA,gBAVA,6BCEA,eACA,kBACA,oBAEA,qBACA,GAGA,sBACA,MACA,kBAEA,mBAAiB,QAAoB,OACrC,cACA,qCACA,kBAGA,SACA,SAEA,iBACA,gCAGA,WACA,OAEA,iBACA,uBACA,SACA,SACA,GArCA,YACA,OAsCA,aACA,YACA,kBAtCA,4BCHA,CAWA,iBACA,IACA,uBACA,MAGA,OACA,IACA,+CAGA,yDACA,QAA+B,gBAE/B,GAEA,KAEA,IACA,EACA,EAEA,QAA0B,gBAG1B,6BACA,kBACA,KAGA,MACA,MACA,GAEA,eAEA,IACA,oBACA,GAAG,SACH,uBACA,kBAEA,SAEA,OACA,UAvDA,IACA,WACA,kBAEA,OACA,KAEA,YACA,0BCEA,aACA,iBACA,iBAGA,cADA,WAGA,eACA,SACA,qCACA,MAEA,QAEA,eAEA,gCACA,yCACA,0BAKA,8BACA,qBAKA,gCACA,YAEA,KACA,CACA,MACA,MAEA,UAEA,iBACA,CACA,uBACA,MAGA,UACA,WACA,QACA,QACA,SAEA,GAAG,gBACH,IACA,sBACA,SAEA,UAGA,YACA,wBACA,iCAEA,YACA,0BACA,sBAEA,MAAK,gBACL,qBACA,WACA,WAAsB,CAAsB,wBAC5C,IACA,WACA,WAEA,wBAEA,gBACA,IACA,EAAK,OACL,OAAG,OACH,QA5FA,YACA,EAEA,KA2FA,aACA,MAEA,aACA,WACA,QACA,QACA,SAEA,WAAqC,SAAO,QAC5C,GACA,wBACA,iCAEA,YACA,0BACA,sBAEA,sBAAwC,OAAQ,QAChD,SACA,KACA,KACA,CAEA,cAF8B,CAC9B,mBAEA,MAEA,YAEA,SAAO,UACP,CACA,CAEA,aACA,OAEA,cACA,cAEA,WACA,aAjIA,6BADA,EAGA,gCACA,OAA0B,IAC1B,8BCPA,qBACA,OACA,SAEA,aAA4B,QAC5B,kCA8BA,UA5BA,aACA,IAIA,QACA,cAGA,eACA,aAGA,SACA,gBAGA,UACA,GACA,WACiC,2CACjC,QADA,OACK,SAAY,CAEjB,CAGA,eADA,6BClCA,aACA,aAEA,wCACA,gBAAsC,WACtC,aAEA,oBCHA,aACA,MACA,uCAEA,0CAGA,QADA,aAEA,oDACA,4BACA,MACA,QAAO,EACP,oBACA,gCACA,iBACA,GAAO,EAEP,+BAEA,oBA2DA,eACA,sBACA,MAEA,iBACA,MACA,WACA,aACA,SAEA,eACA,qBACA,MACA,cACA,cACA,aAEA,MAEA,iBACA,qBACA,MACA,cACA,cACA,OAIA,iBAHA,WAIA,YACA,aAhHA,sCAEA,YAuBA,iCACA,MACA,gDACA,CACA,uDACA,IAAG,EACH,OAEA,2BACA,gBACA,UAEA,2BACA,cACA,qBACA,OAEA,6BACA,QACA,YAEA,8BACA,cAEA,iCACA,mBAEA,SAEA,4BACA,qBACA,aAEA,qCACA,CACA,QACA,cACA,gBAEA,eAEA,yCACA,eACA,mBACA,IACA,iBACA,EACA,cACC,kBAED,mBACA,iBACA,8BACA,iBACA,gDAEA,kBCjFA,CACA,4CACA,uEAEA,sDACA,iBAGA,KADA,qBCLA,qBACA,QACA,SAGA,aAA4B,QAmE5B,eAqDA,UAnDA,eAGA,IACA,GAGA,mBACA,aACA,MAGA,qBACA,QACA,GA4BA,OACA,CACA,UACA,OACA,UACA,OAEA,8BC3HA,aAIA,iBACA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CA,6BAEA,eACA,QAAS,OACT,qCAEA,YACA,SAEA,sCACA,yBACA,oBAEA,mDACA,OACA,yEACA,GAEA,8CACA,aACA,QACA,qBACA,8BAAsC,QAAW,IACjD,MACA,oCAEA,OACA,QAEA,GAIA,GAAC,+BC1LD,aAmEA,YACA,yCAEA,QACA,cACA,aACA,aACA,iBACA,UACA,aACA,oBACA,OACA,UACA,gBACA,OACA,MAGA,YAEA,cACA,SACA,KAEA,KAAiB,QAAoB,OACrC,SAEA,gCACA,SACA,qBACA,wBACA,gBACA,KAGA,wCAEA,6CAEA,kBAEA,KAAU,gCACV,S,CA3GA,qCACA,CACC,WACD,uLAEA,yBAEA,OAEA,WAAsC,0BAAuC,CAAgB,UAE7F,OACA,kBACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,YAEA,aACA,OAEA,QACA,2BACA,iCAGA,6BACA,+BACA,gDACA,6CACA,2CAEA,kDACA,0CACA,4CACA,wCACA,6BAEA,cACA,uBACA,qBACA,oBACA,uBACA,kBACA,kBACA,sBACA,oBACA,mBACA,iBACA,UACA,CACA,YACA,MACA,WACA,SACA,QACA,6BChEA,aAoCA,aACA,kBACA,2BACA,QAEA,gBAEA,MADA,OAxCA,qCACA,CAGA,mBAEA,OAEA,WAAsC,0BAAuC,CAAgB,UAE7F,OAEA,eACA,UAEA,kBACA,+CACA,gBAEA,IACA,gCATA,sBAUA,WAEA,kBACA,qBACA,uBACA,OACA,aAEA,CAGA,GACA,2BAUA,aACA,OACA,OACA,oBACA,0CACA,cACA,YACA,Y,wBCpDA,aAEA,uBACA,yBAA6D,iIAC7D,G,iBCJA,aAEA,qCACA,CACC,WACD,UACA,aACA,qCAAqF,aACrF,8CACA,Y,4BCTA,aAEA,qCACA,CACC,WACD,EAEA,QAMA,aACA,yBAA0D,mDAC1D,gBANA,OAEA,WAAsC,0BAAuC,CAAgB,eAK7F,Y,4BChBA,aAgCA,aAAsC,0BAAuC,CAAgB,WAE7F,eAAiD,MAA0C,oCAA4D,qCAEvJ,eAAiD,IAAa,4BAAyF,8FAAuF,0BAE9O,eAA0C,0BAA+D,wFAAu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8B,MAAT,WAAkB,wFAAuF,oBAA8B,6BAA4B,YACxf,YAAU,mDCrBV,kB,0BCOA,CA2BA,qBACA,eACA,uBACA,qBACA,2BACA,2BACA,yBACA,OACA,yBACA,MASA,cA5CA,uBAIA,MAGA,YAkBA,qBAoBA,EACA,uCAGA,gBA6FA,yBACA,SACO,WACP,OACA,aACA,UACA,qBACA,eAGA,qBACA,MACA,CACA,OApGA,UACA,WACA,cACA,aAMA,YACA,SACA,WACA,OAPA,WACA,SAEA,IAOA,QAKA,IAEA,KAgEA,gCA/DA,IAGA,gBAEA,kBACA,KACA,MAES,MAIT,OACA,oBAEA,mBAOA,uBALA,uBACA,gBAEA,YACA,IAMA,UACA,qBACA,KAEA,2BACA,OACA,wBACA,kCACA,qBACA,eACA,CACA,GAAK,EAEL,UAGA,gBAGA,4BAIA,mCACA,SACA,oBACA,UACA,cAEA,aAEA,sBAEA,IAuBA,EACA,2BACA,UACA,gCACA,MACA,MAAK,EAEL,oBAEA,oCAIA,sBACA,WAGA,uFACA,KAOA,EACA,+BACA,UACA,8BAAiC,EAAQ,KACzC,iBAGA,oBACA,iCAGA,yBACA,WAGA,uFACA,KAQA,EACA,4BACA,6BAC6C,OAA7C,EAAsD,IACtD,WACA,YACA,OAGA,QACA,YAAoB,aACpB,iBACA,iBACA,iBAIA,MAOA,EACA,4BACA,qBAGA,OAFA,EACA,SAEA,OACA,KAAe,MAAW,EAC1B,gBACA,eAEA,oBACA,kBACA,UACA,OACA,KAQA,EACA,sCACA,0CACA,SACA,QAEA,kBACA,2DAGA,mCAEA,cACA,IAQA,EACA,YACA,8BACA,uBACA,iBAOA,EACA,YACA,8BACA,6BAA+C,OAAS,IACxD,SACA,iCAIA,iDACA,wBAAyC,OAAS,IAClD,gDAEA,MAKA,EACA,+BACA,OACA,GAIA,4BAHA,CACA,IACA,IAMA,EACA,6CACA,OACA,MACA,QACA,SAEA,KACA,SACA,OACA,OACA,OACA,OACA,mCACA,GACA,QACA,iBACA,eACA,wBACA,cACA,YACA,cACA,oBACA,UACA,gBACA,QACA,cAEA,kBACA,QACA,cAEA,eAGA,WACA,WACA,SACA,WACA,KAEA,uBACA,WACA,QACA,cAGA,YACA,KAEA,sBAA4C,OAAc,IAC1D,MACA,gBAxWA,MAyWA,gBAEA,IACA,SACA,KAEA,sBACA,UACA,gBACA,QACA,cAEA,kBACA,QACA,cAEA,eAIA,UAGA,QACA,wCACA,GACA,qBAEA,GAAU,aACV,QAEA,6BClYA,CACA,iBACA,OACA,UACA,KACA,MASA,CACA,eACA,oCACA,KAaA,CACA,mBAKA,QAYA,OACA,WAEA,EACA,mBAQA,KAAmB,IAAO,IAC1B,IACA,kBACA,EAIA,gBACA,aAIA,YACA,WACA,IACA,CASA,CACA,yBACA,kBACA,kBC5GA,CAkBA,uBAUA,wBACA,WACA,eAIA,SAEA,IAEA,MAKA,oBACA,gCAOA,IAEA,MAIA,oBAGA,yBAGA,GAmBA,CAhFA,yBACA,oBAcA,EAkEA,0BACA,IACA,oBAGA,eACA,kBACA,yBACA,WAMA,OACA,UAGA,wBAGA,IACA,0BCvGA,CAMA,aACA,IACA,WACA,4CAAsD,WAGtD,MACA,iBAEA,SADA,SAoQA,aACA,IACA,KACA,4CAAsD,WAGtD,uBACA,wBAGA,gCACA,8BACA,oCACA,mBACA,gCAIA,iBACA,yBAGA,6BACA,MAIA,cAKA,0BACA,8BACA,gBAEA,eAMA,iCACA,4BAEA,qBACA,kBACA,sBACA,iBACA,OA6EA,YACA,oBACA,uBACA,cACA,uBACA,yBACA,eACA,IAMA,CAkZA,aACA,IACA,KACA,4CAAsD,WAGtD,uBACA,wBAEA,uBACA,yBAGA,yCACA,kBAEA,YACA,OACA,SAEA,mCACA,MAGA,oBAEA,uEACA,uBACA,qBAEA,iBACA,sBACA,uBAEA,8DAEA,KACA,iBAGA,iBACA,oBAEA,6BAEA,QACA,WA51BA,QACA,cACA,aACA,wBAaA,2BACA,UACA,gBAIA,EACA,qBA8BA,EAEA,qCACA,uDACA,eACA,aACA,6DAGA,iBACA,mBACC,IAED,oCACA,sDACA,eACA,aACA,4DAGA,iBACA,kBACC,IAED,YACA,qCACA,SACA,gBAAmB,SACnB,OAMA,EACA,YACA,yBACA,iBACA,6CAEA,oBACA,mBAEA,yBACA,oBAiBA,EACA,YACA,2BACA,YAGA,gBACA,EACA,iBACA,uBACA,mBACA,aACA,sBACA,kBACA,MACA,wBAGA,2CACA,4BACA,+CACA,wBACA,cAEA,WACA,CACA,yBACA,gCACA,+BACA,8BACA,wDAEA,MAAK,QACL,aA7BA,KAiDA,EACA,YACA,oCACA,kBAMA,UACA,mBACA,UACA,kDAGA,OACA,8DAEA,8BACA,cAEA,oCAEA,cAEA,UACA,oBACA,kBACA,eACA,mBACA,6BACA,2BACA,YAEA,mCACA,mBAMA,kBACA,yBACA,iCACA,0CACA,kDAGA,iCAGA,sBAMA,eACA,KACA,oBACA,0BACA,iCACA,0CACA,kDAGA,iCAGA,IAEA,CACA,UAEA,EA+BA,oBAoDA,uCACA,YAQA,WACA,EACA,yBACA,uBAEA,2CACA,kDACA,6BACA,kEACA,YACA,qBAOA,sCACA,gCACA,0BAEA,WAAsD,OAAY,QAClE,OACA,OACA,wBACA,kCAEA,kBACA,8BACA,yBACA,gCAEA,iBACA,0BAGA,SAGA,WACA,OAEA,CAGA,gCADA,6BAKA,EACA,qBAIA,EACA,4CACA,eACA,+CACA,4CACA,aAAK,EACL,KAKA,IAeA,YACA,0BACA,WACA,IACA,IACA,IACA,IACA,IACA,MACA,SACA,IACA,KACA,KACA,KACA,WAEA,EACA,QACA,kBACA,IACA,MAEA,UACA,kBAEA,QACA,OACA,QAOA,gBAAyB,IAAc,WAKvC,6BAJA,KAQA,OAFA,aACA,YAES,WACT,OACA,GACA,OACA,kBACA,UACA,OAGA,WACA,6BAGA,6CACA,6BAGA,0CACA,MAGA,uBACA,OAEA,gBAEA,0BACA,QAGA,sBACA,OAEA,6BAGA,uBACA,OAEA,eAEA,wBACA,QAIA,OACA,QACA,mCAEA,OAGA,OACA,0CAEA,4BACA,iCACA,oBAKA,EACA,YACA,aACA,qBAMA,IACA,4BACA,gDAEA,SACA,2BACA,kDAGA,eACA,eAKA,EACA,YACA,6BACA,WAAuB,8BAAwC,WAC/D,WAMA,yDACA,iCAEA,wCACA,yCACA,EACA,QACA,CAGA,uBACA,QACA,CAqBA,EACA,YACA,+BACA,OACA,0BACA,mCAGA,kBAEA,oBACA,mBACA,gBACA,oBACA,wDAGA,+BACA,YAEA,2DACA,2BACA,MACA,2BACA,MACA,sCAGA,wCACA,YACA,0BAEA,OACA,CACA,wCACA,yCACA,MAEA,OACA,CAEA,OACA,QACA,UACA,YACA,UAEA,KAKA,EACA,YACA,kCACA,cAGA,0DACA,6CAA+C,OAAmB,QAClE,EAMA,EACA,YACA,8BACA,UACA,qBAGA,SACA,0CAGA,6BACA,gDAGA,eACA,MACA,uDAKA,8BACA,OACA,gCACA,gDAGA,yBACA,gCACA,wDAEA,OAMA,CACA,WAGA,4BAEA,6BAoBA,EACA,YACA,gCACA,kBACA,aACA,0CAEA,8BACA,aACA,MACA,YACA,gBAGA,sBAEA,iBACA,CACA,iCACA,kCAGA,kBAEA,oBACA,kBACA,eACA,mBACA,+CAGA,+BACA,YAEA,qCACA,aACA,iCACA,0CACA,kDAGA,MAEA,OACA,MACA,YACA,gBAEA,OAEA,EA8CA,yBAiDA,uCACA,YAIA,cACA,qBAIA,EACA,4CACA,eACA,WACA,KAAmB,mBAA2B,OAC9C,cAAqB,uCAA+C,OACpE,sCAGA,YACA,QAiBA,IACA,YACA,+BACA,OACA,0BACA,mCAKA,6BACA,uBACA,yCAKA,2BACA,kCACA,eACA,UAGA,qDASA,QACA,+CACA,YACA,qDACA,gDACA,EACA,UAEA,OAhBA,QACA,UACA,YACA,UAIA,KAcA,EACA,YACA,kCACA,wCACA,mBACA,yBACA,EAMA,EACA,YACA,8BACA,WAAmB,mBAA2B,WAC9C,YAEA,0BACA,uBACA,KAEA,QACA,CACA,WAGA,4BAEA,6BAeA,EACA,YACA,gCACA,WAAmB,qBAA2B,OAC9C,cAIA,cAGA,uEACA,6BACA,OACA,QACA,sCACA,YACA,4CACA,uCACA,EAEA,IACA,QAGA,QACA,MACA,YAEA,KAMA,EACA,YACA,yBACA,0BACA,2BACA,aAAmB,mBAA2B,OAC9C,mBACA,0BACA,qBAAqB,MAA4B,WACjD,OAEA,gCACA,QACA,mDAEA,6BACA,uBAEA,wCACA,kBACA,qBAMA,iBACA,CACA,yBACA,+CACA,qBACA,qDACA,gDACA,EACA,kBACA,8BACA,eAGA,iCACA,QACA,yDAEA,OAGA,8BACA,iEACA,6BAEA,6CCpjCA,CAQA,eAEA,SACA,kBACA,kBACA,oBACA,kCACA,MACA,6CAMA,CACA,YACA,aACA,QAEA,uBAAgB,iCAChB,EAOA,CAjCA,QAKA,IA6BA,YACA,6BACA,aACA,YAMA,EACA,2BACA,QACA,eACA,oBAEA,eACA,uBAEA,QAUA,EACA,8BACA,aACA,6BACA,0CAEA,iBACA,QAEA,8BCzEA,CAEA,GAIA,qQACA,oBACA,cACA,aAEA,0BACA,+BAKA,EACA,oBACA,OACA,KAGA,KAGA,gBAUA,GAdA,GAkBA,UACA,GAhBA,IAoBA,IAbA,SAcA,GAlBA,GAsBA,IAfA,GAgBA,GAtBA,GA0BA,GACA,GAzBA,GA6BA,IACA,mBC9DA,CACA,+CACA,6CACA,+CCPA,CAqCA,YACA,SAEA,gBAEA,4HACA,kCAEA,YACA,iDACA,8BAEA,aACA,mBACA,WAAmB,QAAiB,OACpC,IAEA,KADA,UAIA,eACA,KACA,CAEA,CAiCA,eACA,OACA,iBACA,+BACA,iBACA,gCACA,WAEA,aACA,IAEA,MACA,OACA,UACA,uBACA,mBACA,wCAGA,+BACA,kCACA,eACA,KAEA,QAAM,SACN,CAIA,GACA,eAGA,8HACA,eACA,eAEA,GADA,IAOA,CA6BA,aACA,WACA,cAEA,WAEA,yBACA,OACA,gBAKA,YACA,mDACA,aACA,uBACA,WACA,OACA,MACA,CAGA,kBACA,KACA,SAGA,KAGA,aACA,aAOA,0BACA,gBAIA,gBAHA,UACA,SAIA,CACA,QAGA,CACA,aAEA,gDACA,aACA,SACA,UACA,WACA,eAEA,wCACA,4BACA,GAGA,uCAEA,uCAKA,KAOA,CACA,YACA,OAEA,GADA,UAEA,aACG,aACH,QACA,oCACA,kBACA,mBASA,aAEA,yBACA,2BACA,IACA,iBAEA,yBAEA,MACA,CAEA,OACA,UACA,kBACA,YACA,yBACA,sBACA,YAEA,cACA,0BAEA,mBAEA,sBACA,uBAEA,KACA,4CACA,iBAGA,mBAEA,cACA,sBAEA,iBAEA,MACA,KAGA,MAGA,qBADA,OAGA,aACA,OACA,GAKA,+EAJA,sCAA0D,aAAgC,OAAE,EAC5F,IACA,KACA,aAGA,aACA,MACA,WAMA,kCACA,gCACA,SACA,sCAIA,IACA,yBACA,WAGA,cACA,CACA,SACA,OAEA,WAMA,SALA,6BAAoC,UAAwB,MAC5D,4BAAsC,UAAsB,IAC5D,8BAAwC,iBAA4B,CACpE,uCAAiD,UAAwB,MACzE,GAIA,qBAEA,4BACA,OACA,+BAAsC,CAAe,QAMrD,MAGA,CACA,eAEA,cACA,KAGA,uBACA,mBACA,IAAG,QACH,GAEA,CACA,aACA,oDACA,YACA,SACA,QACA,QAGA,KAGA,iBACA,iBACA,oBACA,OAAO,SACP,GACA,EAIA,MACA,mCACA,GACA,2BACA,wBAEA,GACA,CACA,OACA,MAEA,aACA,OAGA,iBACA,gBAGA,0BACA,oBACA,GAEA,YACA,eAEA,6BACA,4BACA,kCACA,QAEA,iCACA,sBAEA,GAEA,qBACA,UACA,eAvbA,sBAEA,KACA,GACA,KACA,oBAEA,iBAEA,KAAC,SAED,CAGA,IACA,MAGA,KAGA,OAGA,SAGA,KAGA,KAGA,wCACA,eA4BA,kBAEA,QACA,OACA,aAGA,YACA,WAEA,UACA,uBACA,mBACA,YACA,uBACA,qBAEA,aAAG,WAEH,iBACA,oBACA,OAAK,SACL,GACA,EAGA,OACA,OAGA,GA6CA,WACA,kBACA,OACA,iBAGA,SACA,gBAEA,8BACA,4BACA,WACA,GAEA,QACA,SAIA,cAIA,CACA,MAEA,OAJA,IAIC,GAsRD,iBACA,mBACA,sBACA,sBAEA,qBACA,SAEA,KACA,kBACA,aACA,2EAMA,kEACA,iBACA,gCAGA,eAKA,iBACA,sBACA,qCAGA,eAIA,wCACA,IACA,MACA,KACA,IAAK,SAEL,CACA,mBAEA,WACA,uDACA,OACA,QACA,mBACA,SAEA,uBAEA,sBAIA,aACA,sCAKA,iCACA,WAGA,wBACA,SACA,mCASA,4BACA,MACA,KAEA,IACA,mBC3gBA,CAEA,gBAIA,IAEA,EAQA,QAEA,WACA,cACA,UACA,sCACA,uBAGA,mFACA,gBACA,mBACA,qBAMA,4BAGA,UAUA,6BAGA,OACA,4BAGA,eAIA,YAGA,KACA,oFCjEA,UAEA,KAIA,E,YAA0C,aACxC,UAAQ,EAER,yBAAI,EACF,MAAO,EAAgB,GAAR,MAAa,EAAW,KAAhC,GAAqC,EAAM,MAElD,OAAO,EACK,GAAR,MAAa,EAAU,SAAK,EAAa,OACzC,MAAG,EAAU,SAAK,EAAa,OAEtC,mFChBD,eAEA,E,iBAAkD,aAChD,OAAO,GAAQ,EAChB,kDCO8C,iBAC7C,eAAY,KAEV,QACA,uBAAqC,IAAY,KAAhC,CAEpB,6CAjBD,qBAEA,QAEA,KAAM,EAEN,OAaA,EAAE,IACA,CAAuB,UACrB,GACA,qBAAQ,MAAM,EACf,sBACD,EAAsB,SACpB,GACA,oBAAQ,KAAK,EACd,sBACD,EAAsB,SACpB,GACA,oBAAQ,KAAK,EACd,sBACD,EAAuB,UACrB,GACA,qBAAQ,MAAM,EACf,sBAhBK,kFCnBR,EAEA,eACA,OACA,QAEA,OAEA,QACA,SAaA,SAWA,QAEA,SACA,QACA,QAKA,SACA,SACA,SACA,QACA,SACA,QAIA,SACA,SAMA,QAAI,qBACF,YACD,8BAED,EAGA,mBACA,QAAY,wBAAyB,EAAK,QAAQ,UASlD,OACA,EAAQ,KAER,KAAM,GAAY,YAKhB,QACD,KAED,QAAQ,KAAK,oBAAsB,KACjC,GAAQ,EAER,iCAAQ,MAON,0BAAgB,kBACd,WAAW,EACX,aAAM,EAIV,cACD,0BAED,QAAM,GAAkB,GAAI,GAAJ,gBACtB,GAAI,GAAJ,mBAEF,uBAAM,EAA2B,GAAI,GACrC,yBAAM,EAAc,GAAI,GAAJ,YAAgB,GAAI,GAAJ,eACpC,mBAAM,EAAa,GAAI,GAAJ,WACjB,GAAI,GAAJ,cAAkB,iBAClB,GAAI,GAEN,qBAAM,EAAc,GAAI,GAExB,YAAM,EAAgB,GAAI,GAAJ,cAAkB,aAAc,EACtD,YAAM,EAAoB,GAAI,GAAJ,kBACxB,GAAI,GAAJ,qBAGF,aAAM,EAAmB,GAAI,GAAJ,iBACvB,GAAI,GAAJ,oBAIF,0BAAM,EAAyB,GAAI,GAAJ,qBAAyB,KACtD,EAGF,0BAAM,EAAW,GAAI,GAYrB,4BAAM,EAAa,GAAI,GAA6C,kBAEpE,EAAW,qBAAqB,EAAhC,qBACA,EAAW,qBAAqB,EAAhC,8BACA,EAAW,qBAAqB,EAAhC,4BACA,EAAW,qBAAqB,EAAhC,uBACA,EAAW,qBAAqB,EAAhC,sBACA,EAAW,qBAAqB,EAAhC,6BACA,EAAW,qBAAqB,EAAhC,+BACA,EAAW,qBAAqB,EAAhC,sBACA,EAAW,qBAAqB,EAAhC,uBACA,EAAW,qBAAqB,EAAhC,0BAEA,SAAS,KAAK,UAAc,gBAA4B,QAAxD,IAEA,EAAW,iBAAiB,SAAO,mBAAmB,aAEtD,cAAY,GAAG,QAAS,IACtB,MAAM,CAAE,iBAAkB,EAI1B,WAAI,GAAiB,EAAc,OAAS,gBAC1C,cAAW,kBAAkB,EAG/B,cACD,oBAVD,GAYA,cAAY,GAAG,OAAQ,IAIrB,GACA,iCACD,oBAND,GAQA,cAAY,GACV,aACC,GAAiC,CAAE,YAClC,GACD,oBAJH,GAOA,EAAS,OACP,gBAAC,EAAD,IAAI,CACU,aACF,WACc,yBACX,cACI,kBACN,cAEb,SAAS,eAAe","file":"renderer.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 683);\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react.production.min.js');\n} else {\n  module.exports = require('./cjs/react.development.js');\n}\n","module.exports = require(\"path\");","/** Throw an error. */\nexport function fatalError(msg: string): never {\n  throw new Error(msg)\n}\n\n/**\n * Utility function used to achieve exhaustive type checks at compile time.\n *\n * If the type system is bypassed or this method will throw an exception\n * using the second parameter as the message.\n *\n * @param x         Placeholder parameter in order to leverage the type\n *                  system. Pass the variable which has been type narrowed\n *                  in an exhaustive check.\n *\n * @param message   The message to be used in the runtime exception.\n *\n */\nexport function assertNever(x: never, message: string): never {\n  throw new Error(message)\n}\n\n/**\n * Unwrap a value that, according to the type system, could be null or\n * undefined, but which we know is not. If the value _is_ null or undefined,\n * this will throw. The message should contain the rationale for knowing the\n * value is defined.\n */\nexport function forceUnwrap<T>(message: string, x: T | null | undefined): T {\n  if (x == null) {\n    return fatalError(message)\n  } else {\n    return x\n  }\n}\n","import * as React from 'react'\nimport * as classNames from 'classnames'\n\nexport interface IButtonProps {\n  /**\n   * A callback which is invoked when the button is clicked\n   * using a pointer device or keyboard. The source event is\n   * passed along and can be used to prevent the default action\n   * or stop the even from bubbling.\n   */\n  readonly onClick?: (event: React.MouseEvent<HTMLButtonElement>) => void\n\n  /**\n   * A function that's called when the user moves over the button with\n   * a pointer device.\n   */\n  readonly onMouseEnter?: (event: React.MouseEvent<HTMLButtonElement>) => void\n\n  /** Is the button disabled? */\n  readonly disabled?: boolean\n\n  /** Whether the button is a submit. */\n  readonly type?: 'submit'\n\n  /** CSS class names */\n  readonly className?: string\n\n  /** The type of button size, e.g., normal or small. */\n  readonly size?: 'normal' | 'small'\n\n  /**\n   * The `ref` for the underlying <button> element.\n   *\n   * Ideally this would be named `ref`, but TypeScript seems to special-case its\n   * handling of the `ref` type into some ungodly monstrosity. Hopefully someday\n   * this will be unnecessary.\n   */\n  readonly onButtonRef?: (instance: HTMLButtonElement | null) => void\n\n  /**\n   * The tab index of the button element.\n   *\n   * A value of 'undefined' means that whether or not the element participates\n   * in sequential keyboard navigation is left to the user agent's default\n   * settings.\n   *\n   * A negative value means that the element can receive focus but not\n   * through sequential keyboard navigation (i.e. only via programmatic\n   * focus)\n   *\n   * A value of zero means that the element can receive focus through\n   * sequential keyboard navigation and that the order should be determined\n   * by the element's position in the DOM.\n   *\n   * A positive value means that the element can receive focus through\n   * sequential keyboard navigation and that it should have the explicit\n   * order provided and not have it be determined by its position in the DOM.\n   *\n   * Note: A positive value should be avoided if at all possible as it's\n   * detrimental to accessibility in most scenarios.\n   */\n  readonly tabIndex?: number\n\n  readonly role?: string\n  readonly ariaExpanded?: boolean\n  readonly ariaHasPopup?: boolean\n}\n\n/**\n * A button component.\n *\n * Provide `children` elements to represent the title of the button.\n */\nexport class Button extends React.Component<IButtonProps, {}> {\n  private innerButton: HTMLButtonElement | null = null\n\n  private onButtonRef = (button: HTMLButtonElement | null) => {\n    this.innerButton = button\n\n    if (this.props.onButtonRef) {\n      this.props.onButtonRef(button)\n    }\n  }\n\n  /**\n   * Programmatically move keyboard focus to the button element.\n   */\n  public focus = () => {\n    if (this.innerButton) {\n      this.innerButton.focus()\n    }\n  }\n\n  /**\n   * Programmatically remove keyboard focus from the button element.\n   */\n  public blur() {\n    if (this.innerButton) {\n      this.innerButton.blur()\n    }\n  }\n\n  /**\n   * Get the client bounding box for the button element\n   */\n  public getBoundingClientRect = (): ClientRect | undefined => {\n    return this.innerButton\n      ? this.innerButton.getBoundingClientRect()\n      : undefined\n  }\n\n  public render() {\n    const className = classNames(\n      'button-component',\n      { 'small-button': this.props.size === 'small' },\n      this.props.className\n    )\n\n    return (\n      <button\n        className={className}\n        disabled={this.props.disabled}\n        onClick={this.onClick}\n        type={this.props.type || 'button'}\n        ref={this.onButtonRef}\n        tabIndex={this.props.tabIndex}\n        onMouseEnter={this.props.onMouseEnter}\n        role={this.props.role}\n        aria-expanded={this.props.ariaExpanded}\n        aria-haspopup={this.props.ariaHasPopup}\n      >\n        {this.props.children}\n      </button>\n    )\n  }\n\n  private onClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n    if (this.props.type !== 'submit') {\n      event.preventDefault()\n    }\n\n    if (this.props.onClick) {\n      this.props.onClick(event)\n    }\n  }\n}\n","\"use strict\";\n\nexports.__esModule = true;\n\nvar _assign = require(\"../core-js/object/assign\");\n\nvar _assign2 = _interopRequireDefault(_assign);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = _assign2.default || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};","/*!\n  Copyright (c) 2016 Jed Watson.\n  Licensed under the MIT License (MIT), see\n  http://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames () {\n\t\tvar classes = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (!arg) continue;\n\n\t\t\tvar argType = typeof arg;\n\n\t\t\tif (argType === 'string' || argType === 'number') {\n\t\t\t\tclasses.push(arg);\n\t\t\t} else if (Array.isArray(arg)) {\n\t\t\t\tclasses.push(classNames.apply(null, arg));\n\t\t\t} else if (argType === 'object') {\n\t\t\t\tfor (var key in arg) {\n\t\t\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\t\t\tclasses.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn classes.join(' ');\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n","\"use strict\";\n\nexports.__esModule = true;\n\nexports.default = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};","export { Octicon } from './octicon'\nexport { OcticonSymbol } from './octicons.generated'\nexport { iconForRepository } from './repository'\n","\"use strict\";\n\nexports.__esModule = true;\n\nvar _defineProperty = require(\"../core-js/object/define-property\");\n\nvar _defineProperty2 = _interopRequireDefault(_defineProperty);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      (0, _defineProperty2.default)(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();","export * from './content'\nexport * from './dialog'\nexport * from './error'\nexport * from './footer'\n","\"use strict\";\n\nexports.__esModule = true;\n\nvar _typeof2 = require(\"../helpers/typeof\");\n\nvar _typeof3 = _interopRequireDefault(_typeof2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function (self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && ((typeof call === \"undefined\" ? \"undefined\" : (0, _typeof3.default)(call)) === \"object\" || typeof call === \"function\") ? call : self;\n};","import { assertNever } from '../fatal-error'\nimport * as GitPerf from '../../ui/lib/git-perf'\n\nimport {\n  GitProcess,\n  IGitResult as DugiteResult,\n  GitError as DugiteError,\n  IGitExecutionOptions as DugiteExecutionOptions,\n} from 'dugite'\n\n/**\n * An extension of the execution options in dugite that\n * allows us to piggy-back our own configuration options in the\n * same object.\n */\nexport interface IGitExecutionOptions extends DugiteExecutionOptions {\n  /**\n   * The exit codes which indicate success to the\n   * caller. Unexpected exit codes will be logged and an\n   * error thrown. Defaults to 0 if undefined.\n   */\n  readonly successExitCodes?: ReadonlySet<number>\n\n  /**\n   * The git errors which are expected by the caller. Unexpected errors will\n   * be logged and an error thrown.\n   */\n  readonly expectedErrors?: ReadonlySet<DugiteError>\n\n  /** Should it track & report LFS progress? */\n  readonly trackLFSProgress?: boolean\n}\n\n/**\n * The result of using `git`. This wraps dugite's results to provide\n * the parsed error if one occurs.\n */\nexport interface IGitResult extends DugiteResult {\n  /**\n   * The parsed git error. This will be null when the exit code is include in\n   * the `successExitCodes`, or when dugite was unable to parse the\n   * error.\n   */\n  readonly gitError: DugiteError | null\n\n  /** The human-readable error description, based on `gitError`. */\n  readonly gitErrorDescription: string | null\n}\n\nfunction getResultMessage(result: IGitResult) {\n  const description = result.gitErrorDescription\n  if (description) {\n    return description\n  }\n\n  if (result.stderr.length) {\n    return result.stderr\n  } else if (result.stdout.length) {\n    return result.stdout\n  } else {\n    return 'Unknown error'\n  }\n}\n\nexport class GitError extends Error {\n  /** The result from the failed command. */\n  public readonly result: IGitResult\n\n  /** The args for the failed command. */\n  public readonly args: ReadonlyArray<string>\n\n  public constructor(result: IGitResult, args: ReadonlyArray<string>) {\n    super(getResultMessage(result))\n\n    this.name = 'GitError'\n    this.result = result\n    this.args = args\n  }\n}\n\n/**\n * Shell out to git with the given arguments, at the given path.\n *\n * @param args             The arguments to pass to `git`.\n *\n * @param path             The working directory path for the execution of the\n *                         command.\n *\n * @param name             The name for the command based on its caller's\n *                         context. This will be used for performance\n *                         measurements and debugging.\n *\n * @param options          Configuration options for the execution of git,\n *                         see IGitExecutionOptions for more information.\n *\n * Returns the result. If the command exits with a code not in\n * `successExitCodes` or an error not in `expectedErrors`, a `GitError` will be\n * thrown.\n */\nexport async function git(\n  args: string[],\n  path: string,\n  name: string,\n  options?: IGitExecutionOptions\n): Promise<IGitResult> {\n  const defaultOptions: IGitExecutionOptions = {\n    successExitCodes: new Set([0]),\n    expectedErrors: new Set(),\n  }\n\n  const opts = { ...defaultOptions, ...options }\n\n  const commandName = `${name}: git ${args.join(' ')}`\n\n  const result = await GitPerf.measure(commandName, () =>\n    GitProcess.exec(args, path, options)\n  )\n\n  const exitCode = result.exitCode\n\n  let gitError: DugiteError | null = null\n  const acceptableExitCode = opts.successExitCodes\n    ? opts.successExitCodes.has(exitCode)\n    : false\n  if (!acceptableExitCode) {\n    gitError = GitProcess.parseError(result.stderr)\n    if (!gitError) {\n      gitError = GitProcess.parseError(result.stdout)\n    }\n  }\n\n  const gitErrorDescription = gitError ? getDescriptionForError(gitError) : null\n  const gitResult = { ...result, gitError, gitErrorDescription }\n\n  let acceptableError = true\n  if (gitError && opts.expectedErrors) {\n    acceptableError = opts.expectedErrors.has(gitError)\n  }\n\n  if ((gitError && acceptableError) || acceptableExitCode) {\n    return gitResult\n  }\n\n  // The caller should either handle this error, or expect that exit code.\n  const errorMessage = []\n  errorMessage.push(\n    `\\`git ${args.join(' ')}\\` exited with an unexpected code: ${exitCode}.`\n  )\n\n  if (result.stdout) {\n    errorMessage.push(result.stdout)\n  }\n\n  if (result.stderr) {\n    errorMessage.push(result.stderr)\n  }\n\n  if (gitError) {\n    errorMessage.push(\n      `(The error was parsed as ${gitError}: ${gitErrorDescription})`\n    )\n  }\n\n  log.error(errorMessage.join('\\n'))\n\n  throw new GitError(gitResult, args)\n}\n\nfunction getDescriptionForError(error: DugiteError): string {\n  switch (error) {\n    case DugiteError.SSHKeyAuditUnverified:\n      return 'The SSH key is unverified.'\n    case DugiteError.SSHAuthenticationFailed:\n    case DugiteError.SSHPermissionDenied:\n    case DugiteError.HTTPSAuthenticationFailed:\n      return `Authentication failed. You may not have permission to access the repository or the repository may have been archived. Open ${\n        __DARWIN__ ? 'preferences' : 'options'\n      } and verify that you're signed in with an account that has permission to access this repository.`\n    case DugiteError.RemoteDisconnection:\n      return 'The remote disconnected. Check your Internet connection and try again.'\n    case DugiteError.HostDown:\n      return 'The host is down. Check your Internet connection and try again.'\n    case DugiteError.RebaseConflicts:\n      return 'We found some conflicts while trying to rebase. Please resolve the conflicts before continuing.'\n    case DugiteError.MergeConflicts:\n      return 'We found some conflicts while trying to merge. Please resolve the conflicts and commit the changes.'\n    case DugiteError.HTTPSRepositoryNotFound:\n    case DugiteError.SSHRepositoryNotFound:\n      return 'The repository does not seem to exist anymore. You may not have access, or it may have been deleted or renamed.'\n    case DugiteError.PushNotFastForward:\n      return 'The repository has been updated since you last pulled. Try pulling before pushing.'\n    case DugiteError.BranchDeletionFailed:\n      return 'Could not delete the branch. It was probably already deleted.'\n    case DugiteError.DefaultBranchDeletionFailed:\n      return `The branch is the repository's default branch and cannot be deleted.`\n    case DugiteError.RevertConflicts:\n      return 'To finish reverting, please merge and commit the changes.'\n    case DugiteError.EmptyRebasePatch:\n      return 'There arent any changes left to apply.'\n    case DugiteError.NoMatchingRemoteBranch:\n      return 'There arent any remote branches that match the current branch.'\n    case DugiteError.NothingToCommit:\n      return 'There are no changes to commit.'\n    case DugiteError.NoSubmoduleMapping:\n      return 'A submodule was removed from .gitmodules, but the folder still exists in the repository. Delete the folder, commit the change, then try again.'\n    case DugiteError.SubmoduleRepositoryDoesNotExist:\n      return 'A submodule points to a location which does not exist.'\n    case DugiteError.InvalidSubmoduleSHA:\n      return 'A submodule points to a commit which does not exist.'\n    case DugiteError.LocalPermissionDenied:\n      return 'Permission denied.'\n    case DugiteError.InvalidMerge:\n      return 'This is not something we can merge.'\n    case DugiteError.InvalidRebase:\n      return 'This is not something we can rebase.'\n    case DugiteError.NonFastForwardMergeIntoEmptyHead:\n      return 'The merge you attempted is not a fast-forward, so it cannot be performed on an empty branch.'\n    case DugiteError.PatchDoesNotApply:\n      return 'The requested changes conflict with one or more files in the repository.'\n    case DugiteError.BranchAlreadyExists:\n      return 'A branch with that name already exists.'\n    case DugiteError.BadRevision:\n      return 'Bad revision.'\n    case DugiteError.NotAGitRepository:\n      return 'This is not a git repository.'\n    case DugiteError.ProtectedBranchForcePush:\n      return 'This branch is protected from force-push operations.'\n    case DugiteError.ProtectedBranchRequiresReview:\n      return 'This branch is protected and any changes requires an approved review. Open a pull request with changes targeting this branch instead.'\n    case DugiteError.PushWithFileSizeExceedingLimit:\n      return \"The push operation includes a file which exceeds GitHub's file size restriction of 100MB. Please remove the file from history and try again.\"\n    case DugiteError.HexBranchNameRejected:\n      return 'The branch name cannot be a 40-character string of hexadecimal characters, as this is the format that Git uses for representing objects.'\n    case DugiteError.ForcePushRejected:\n      return 'The force push has been rejected for the current branch.'\n    case DugiteError.InvalidRefLength:\n      return 'A ref cannot be longer than 255 characters.'\n    case DugiteError.CannotMergeUnrelatedHistories:\n      return 'Unable to merge unrelated histories in this repository.'\n    case DugiteError.PushWithPrivateEmail:\n      return 'Cannot push these commits as they contain an email address marked as private on GitHub.'\n    case DugiteError.LFSAttributeDoesNotMatch:\n      return 'Git LFS attribute found in global Git configuration does not match expected value.'\n    case DugiteError.ProtectedBranchDeleteRejected:\n      return 'This branch cannot be deleted from the remote repository because it is marked as protected.'\n    case DugiteError.ProtectedBranchRequiredStatus:\n      return 'The push was rejected by the remote server because a required status check has not been satisfied.'\n    case DugiteError.BranchRenameFailed:\n      return 'The branch could not be renamed.'\n    case DugiteError.PathDoesNotExist:\n      return 'The path does not exist on disk.'\n    case DugiteError.InvalidObjectName:\n      return 'The object was not found in the Git repository.'\n    case DugiteError.OutsideRepository:\n      return 'This path is not a valid path inside the repository.'\n    case DugiteError.LockFileAlreadyExists:\n      return 'A lock file already exists in the repository, which blocks this operation from completing.'\n    case DugiteError.NoMergeToAbort:\n      return 'There is no merge in progress, so there is nothing to abort.'\n    default:\n      return assertNever(error, `Unknown error: ${error}`)\n  }\n}\n\n/**\n * An array of command line arguments for network operation that unset\n * or hard-code git configuration values that should not be read from\n * local, global, or system level git configs.\n *\n * These arguments should be inserted before the subcommand, i.e in\n * the case of `git pull` these arguments needs to go before the `pull`\n * argument.\n */\nexport const gitNetworkArguments: ReadonlyArray<string> = [\n  // Explicitly unset any defined credential helper, we rely on our\n  // own askpass for authentication.\n  '-c',\n  'credential.helper=',\n]\n","import * as React from 'react'\nimport { Button, IButtonProps } from './button'\n\ninterface IButtonGroupProps {\n  /**\n   * Does the button group perform a destructive action? On macOS, this controls\n   * whether the submit button belongs on the left or right. This has no effect\n   * on other OSes.\n   */\n  readonly destructive?: boolean\n}\n\n/**\n * A component for rendering primary and secondary buttons in\n * a dialog, form or foldout in the platform specific order.\n *\n * Ie, on Windows we expect the button order to be Ok, Cancel\n * whereas on Mac we expect it to be Cancel, Ok. This component,\n * coupled with the button-group-order tslint rule ensures that\n * we adhere to platform conventions.\n *\n * See https://www.nngroup.com/articles/ok-cancel-or-cancel-ok/\n *\n * Non-button `children` content in this component is prohibited and will\n * not render.\n */\nexport class ButtonGroup extends React.Component<IButtonGroupProps, {}> {\n  public render() {\n    const buttons = new Array<React.ReactElement<IButtonProps>>()\n\n    React.Children.forEach(this.props.children, c => {\n      if (typeof c !== 'string' && typeof c !== 'number') {\n        if (c.type === Button) {\n          buttons.push(c as React.ReactElement<IButtonProps>)\n        }\n      }\n    })\n\n    // Flip the order of the buttons if they don't appear to be\n    // in the correct order. The tslint rule button-group-order\n    // _should_ ensure that it's always Ok, Cancel in markup but\n    // we're a little bit more lax here.\n    if (buttons.length > 1) {\n      if (\n        __DARWIN__ &&\n        buttons[0].props.type === 'submit' &&\n        this.props.destructive !== true\n      ) {\n        buttons.reverse()\n      } else if (\n        __WIN32__ &&\n        buttons[buttons.length - 1].props.type === 'submit'\n      ) {\n        buttons.reverse()\n      }\n    }\n\n    return <div className=\"button-group\">{buttons}</div>\n  }\n}\n","\"use strict\";\n\nexports.__esModule = true;\n\nvar _setPrototypeOf = require(\"../core-js/object/set-prototype-of\");\n\nvar _setPrototypeOf2 = _interopRequireDefault(_setPrototypeOf);\n\nvar _create = require(\"../core-js/object/create\");\n\nvar _create2 = _interopRequireDefault(_create);\n\nvar _typeof2 = require(\"../helpers/typeof\");\n\nvar _typeof3 = _interopRequireDefault(_typeof2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function (subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + (typeof superClass === \"undefined\" ? \"undefined\" : (0, _typeof3.default)(superClass)));\n  }\n\n  subClass.prototype = (0, _create2.default)(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf2.default ? (0, _setPrototypeOf2.default)(subClass, superClass) : subClass.__proto__ = superClass;\n};","module.exports = { \"default\": require(\"core-js/library/fn/object/get-prototype-of\"), __esModule: true };","import * as OS from 'os'\nimport * as URL from 'url'\nimport { Account } from '../models/account'\n\nimport {\n  request,\n  parsedResponse,\n  HTTPMethod,\n  APIError,\n  urlWithQueryString,\n} from './http'\nimport { AuthenticationMode } from './2fa'\nimport { uuid } from './uuid'\nimport { getAvatarWithEnterpriseFallback } from './gravatar'\nimport { getDefaultEmail } from './email'\n\nconst username: () => Promise<string> = require('username')\n\nconst ClientID = process.env.TEST_ENV ? '' : __OAUTH_CLIENT_ID__\nconst ClientSecret = process.env.TEST_ENV ? '' : __OAUTH_SECRET__\n\nif (!ClientID || !ClientID.length || !ClientSecret || !ClientSecret.length) {\n  log.warn(\n    `DESKTOP_OAUTH_CLIENT_ID and/or DESKTOP_OAUTH_CLIENT_SECRET is undefined. You won't be able to authenticate new users.`\n  )\n}\n\n/** The OAuth scopes we need. */\nconst Scopes = ['repo', 'user']\n\nenum HttpStatusCode {\n  NotModified = 304,\n  NotFound = 404,\n}\n\n/** The note URL used for authorizations the app creates. */\nconst NoteURL = 'https://desktop.github.com/'\n\n/**\n * Information about a repository as returned by the GitHub API.\n */\nexport interface IAPIRepository {\n  readonly clone_url: string\n  readonly ssh_url: string\n  readonly html_url: string\n  readonly name: string\n  readonly owner: IAPIUser\n  readonly private: boolean\n  readonly fork: boolean\n  readonly default_branch: string\n  readonly pushed_at: string\n  readonly parent: IAPIRepository | null\n}\n\n/**\n * Information about a commit as returned by the GitHub API.\n */\nexport interface IAPICommit {\n  readonly sha: string\n  readonly author: IAPIUser | null\n}\n\n/**\n * Information about a user as returned by the GitHub API.\n */\nexport interface IAPIUser {\n  readonly id: number\n  readonly url: string\n  readonly login: string\n  readonly avatar_url: string\n\n  /**\n   * The user's real name or null if the user hasn't provided\n   * a real name for their public profile.\n   */\n  readonly name: string | null\n\n  /**\n   * The email address for this user or null if the user has not\n   * specified a public email address in their profile.\n   */\n  readonly email: string | null\n  readonly type: 'User' | 'Organization'\n}\n\n/** The users we get from the mentionables endpoint. */\nexport interface IAPIMentionableUser {\n  readonly avatar_url: string\n\n  /**\n   * Note that this may be an empty string *or* null in the case where the user\n   * has no public email address.\n   */\n  readonly email: string | null\n\n  readonly login: string\n\n  readonly name: string\n}\n\n/**\n * `null` can be returned by the API for legacy reasons. A non-null value is\n * set for the primary email address currently, but in the future visibility\n * may be defined for each email address.\n */\nexport type EmailVisibility = 'public' | 'private' | null\n\n/**\n * Information about a user's email as returned by the GitHub API.\n */\nexport interface IAPIEmail {\n  readonly email: string\n  readonly verified: boolean\n  readonly primary: boolean\n  readonly visibility: EmailVisibility\n}\n\n/** Information about an issue as returned by the GitHub API. */\nexport interface IAPIIssue {\n  readonly number: number\n  readonly title: string\n  readonly state: 'open' | 'closed'\n  readonly updated_at: string\n}\n\n/** The combined state of a ref. */\nexport type APIRefState = 'failure' | 'pending' | 'success'\n\n/**\n * The API response for a combined view of a commit\n * status for a given ref\n */\nexport interface IAPIRefStatusItem {\n  readonly state: APIRefState\n  readonly target_url: string\n  readonly description: string\n  readonly context: string\n  readonly id: number\n}\n\n/** The API response to a ref status request. */\ninterface IAPIRefStatus {\n  readonly state: APIRefState\n  readonly total_count: number\n  readonly statuses: ReadonlyArray<IAPIRefStatusItem>\n}\n\ninterface IAPIPullRequestRef {\n  readonly ref: string\n  readonly sha: string\n\n  /**\n   * The repository in which this ref lives. It could be null if the repository\n   * has been deleted since the PR was opened.\n   */\n  readonly repo: IAPIRepository | null\n}\n\n/** Information about a pull request as returned by the GitHub API. */\nexport interface IAPIPullRequest {\n  readonly number: number\n  readonly title: string\n  readonly created_at: string\n  readonly user: IAPIUser\n  readonly head: IAPIPullRequestRef\n  readonly base: IAPIPullRequestRef\n}\n\n/** The metadata about a GitHub server. */\nexport interface IServerMetadata {\n  /**\n   * Does the server support password-based authentication? If not, the user\n   * must go through the OAuth flow to authenticate.\n   */\n  readonly verifiable_password_authentication: boolean\n}\n\n/** The server response when handling the OAuth callback (with code) to obtain an access token */\ninterface IAPIAccessToken {\n  readonly access_token: string\n  readonly scope: string\n  readonly token_type: string\n}\n\n/** The partial server response when creating a new authorization on behalf of a user */\ninterface IAPIAuthorization {\n  readonly token: string\n}\n\n/** The response we receive from fetching mentionables. */\ninterface IAPIMentionablesResponse {\n  readonly etag: string | null\n  readonly users: ReadonlyArray<IAPIMentionableUser>\n}\n\n/** The response for search results. */\ninterface ISearchResults<T> {\n  readonly items: ReadonlyArray<T>\n}\n\n/**\n * Parses the Link header from GitHub and returns the 'next' path\n * if one is present.\n *\n * If no link rel next header is found this method returns null.\n */\nfunction getNextPagePath(response: Response): string | null {\n  const linkHeader = response.headers.get('Link')\n\n  if (!linkHeader) {\n    return null\n  }\n\n  for (const part of linkHeader.split(',')) {\n    // https://github.com/philschatz/octokat.js/blob/5658abe442e8bf405cfda1c72629526a37554613/src/plugins/pagination.js#L17\n    const match = part.match(/<([^>]+)>; rel=\"([^\"]+)\"/)\n\n    if (match && match[2] === 'next') {\n      const nextURL = URL.parse(match[1])\n      return nextURL.path || null\n    }\n  }\n\n  return null\n}\n\n/**\n * Returns an ISO 8601 time string with second resolution instead of\n * the standard javascript toISOString which returns millisecond\n * resolution. The GitHub API doesn't return dates with milliseconds\n * so we won't send any back either.\n */\nfunction toGitHubIsoDateString(date: Date) {\n  return date.toISOString().replace(/\\.\\d{3}Z$/, 'Z')\n}\n\n/**\n * An object for making authenticated requests to the GitHub API\n */\nexport class API {\n  private endpoint: string\n  private token: string\n\n  /** Create a new API client from the given account. */\n  public static fromAccount(account: Account): API {\n    return new API(account.endpoint, account.token)\n  }\n\n  /** Create a new API client for the endpoint, authenticated with the token. */\n  public constructor(endpoint: string, token: string) {\n    this.endpoint = endpoint\n    this.token = token\n  }\n\n  /** Fetch a repo by its owner and name. */\n  public async fetchRepository(\n    owner: string,\n    name: string\n  ): Promise<IAPIRepository | null> {\n    try {\n      const response = await this.request('GET', `repos/${owner}/${name}`)\n      if (response.status === HttpStatusCode.NotFound) {\n        log.warn(`fetchRepository: '${owner}/${name}' returned a 404`)\n        return null\n      }\n      return await parsedResponse<IAPIRepository>(response)\n    } catch (e) {\n      log.warn(`fetchRepository: an error occurred for '${owner}/${name}'`, e)\n      return null\n    }\n  }\n\n  /** Fetch all repos a user has access to. */\n  public async fetchRepositories(): Promise<ReadonlyArray<\n    IAPIRepository\n  > | null> {\n    try {\n      return await this.fetchAll<IAPIRepository>('user/repos')\n    } catch (error) {\n      log.warn(`fetchRepositories: ${error}`)\n      return null\n    }\n  }\n\n  /** Fetch the logged in account. */\n  public async fetchAccount(): Promise<IAPIUser> {\n    try {\n      const response = await this.request('GET', 'user')\n      const result = await parsedResponse<IAPIUser>(response)\n      return result\n    } catch (e) {\n      log.warn(`fetchAccount: failed with endpoint ${this.endpoint}`, e)\n      throw e\n    }\n  }\n\n  /** Fetch the current user's emails. */\n  public async fetchEmails(): Promise<ReadonlyArray<IAPIEmail>> {\n    try {\n      const response = await this.request('GET', 'user/emails')\n      const result = await parsedResponse<ReadonlyArray<IAPIEmail>>(response)\n\n      return Array.isArray(result) ? result : []\n    } catch (e) {\n      log.warn(`fetchEmails: failed with endpoint ${this.endpoint}`, e)\n      return []\n    }\n  }\n\n  /** Fetch a commit from the repository. */\n  public async fetchCommit(\n    owner: string,\n    name: string,\n    sha: string\n  ): Promise<IAPICommit | null> {\n    try {\n      const path = `repos/${owner}/${name}/commits/${sha}`\n      const response = await this.request('GET', path)\n      if (response.status === HttpStatusCode.NotFound) {\n        log.warn(`fetchCommit: '${path}' returned a 404`)\n        return null\n      }\n      return parsedResponse<IAPICommit>(response)\n    } catch (e) {\n      log.warn(`fetchCommit: returned an error '${owner}/${name}@${sha}'`, e)\n      return null\n    }\n  }\n\n  /** Search for a user with the given public email. */\n  public async searchForUserWithEmail(email: string): Promise<IAPIUser | null> {\n    try {\n      const params = { q: `${email} in:email type:user` }\n      const url = urlWithQueryString('search/users', params)\n      const response = await this.request('GET', url)\n      const result = await parsedResponse<ISearchResults<IAPIUser>>(response)\n      const items = result.items\n      if (items.length) {\n        // The results are sorted by score, best to worst. So the first result\n        // is our best match.\n        return items[0]\n      } else {\n        return null\n      }\n    } catch (e) {\n      log.warn(`searchForUserWithEmail: not found '${email}'`, e)\n      return null\n    }\n  }\n\n  /** Fetch all the orgs to which the user belongs. */\n  public async fetchOrgs(): Promise<ReadonlyArray<IAPIUser>> {\n    try {\n      return this.fetchAll<IAPIUser>('user/orgs')\n    } catch (e) {\n      log.warn(`fetchOrgs: failed with endpoint ${this.endpoint}`, e)\n      return []\n    }\n  }\n\n  /** Create a new GitHub repository with the given properties. */\n  public async createRepository(\n    org: IAPIUser | null,\n    name: string,\n    description: string,\n    private_: boolean\n  ): Promise<IAPIRepository> {\n    try {\n      const apiPath = org ? `orgs/${org.login}/repos` : 'user/repos'\n      const response = await this.request('POST', apiPath, {\n        name,\n        description,\n        private: private_,\n      })\n\n      return await parsedResponse<IAPIRepository>(response)\n    } catch (e) {\n      if (e instanceof APIError) {\n        if (org !== null) {\n          throw new Error(\n            `Unable to create repository for organization '${\n              org.login\n            }'. Verify it exists and that you have permission to create a repository there.`\n          )\n        }\n        throw e\n      }\n\n      log.error(`createRepository: failed with endpoint ${this.endpoint}`, e)\n      throw new Error(\n        `Unable to publish repository. Please check if you have an internet connection and try again.`\n      )\n    }\n  }\n\n  /**\n   * Fetch the issues with the given state that have been created or updated\n   * since the given date.\n   */\n  public async fetchIssues(\n    owner: string,\n    name: string,\n    state: 'open' | 'closed' | 'all',\n    since: Date | null\n  ): Promise<ReadonlyArray<IAPIIssue>> {\n    const params: { [key: string]: string } = {\n      state,\n    }\n    if (since && !isNaN(since.getTime())) {\n      params.since = toGitHubIsoDateString(since)\n    }\n\n    const url = urlWithQueryString(`repos/${owner}/${name}/issues`, params)\n    try {\n      const issues = await this.fetchAll<IAPIIssue>(url)\n\n      // PRs are issues! But we only want Really Seriously Issues.\n      return issues.filter((i: any) => !i.pullRequest)\n    } catch (e) {\n      log.warn(`fetchIssues: failed for repository ${owner}/${name}`, e)\n      throw e\n    }\n  }\n\n  /** Fetch the pull requests in the given repository. */\n  public async fetchPullRequests(\n    owner: string,\n    name: string,\n    state: 'open' | 'closed' | 'all'\n  ): Promise<ReadonlyArray<IAPIPullRequest>> {\n    const url = urlWithQueryString(`repos/${owner}/${name}/pulls`, { state })\n    try {\n      const prs = await this.fetchAll<IAPIPullRequest>(url)\n      return prs\n    } catch (e) {\n      log.warn(`fetchPullRequests: failed for repository ${owner}/${name}`, e)\n      throw e\n    }\n  }\n\n  /** Get the combined status for the given ref. */\n  public async fetchCombinedRefStatus(\n    owner: string,\n    name: string,\n    ref: string\n  ): Promise<IAPIRefStatus> {\n    const path = `repos/${owner}/${name}/commits/${ref}/status`\n    try {\n      const response = await this.request('GET', path)\n      const status = await parsedResponse<IAPIRefStatus>(response)\n      return status\n    } catch (e) {\n      log.warn(\n        `fetchCombinedRefStatus: failed for repository ${owner}/${name} on ref ${ref}`,\n        e\n      )\n      throw e\n    }\n  }\n\n  /**\n   * Authenticated requests to a paginating resource such as issues.\n   *\n   * Follows the GitHub API hypermedia links to get the subsequent\n   * pages when available, buffers all items and returns them in\n   * one array when done.\n   */\n  private async fetchAll<T>(path: string): Promise<ReadonlyArray<T>> {\n    const buf = new Array<T>()\n\n    const params = {\n      per_page: '100',\n    }\n    let nextPath: string | null = urlWithQueryString(path, params)\n\n    do {\n      const response = await this.request('GET', nextPath)\n      if (response.status === HttpStatusCode.NotFound) {\n        log.warn(`fetchAll: '${path}' returned a 404`)\n        return []\n      }\n      if (response.status === HttpStatusCode.NotModified) {\n        log.warn(`fetchAll: '${path}' returned a 304`)\n        return []\n      }\n\n      const items = await parsedResponse<ReadonlyArray<T>>(response)\n      if (items) {\n        buf.push(...items)\n      }\n      nextPath = getNextPagePath(response)\n    } while (nextPath)\n\n    return buf\n  }\n\n  /** Make an authenticated request to the client's endpoint with its token. */\n  private request(\n    method: HTTPMethod,\n    path: string,\n    body?: Object,\n    customHeaders?: Object\n  ): Promise<Response> {\n    return request(this.endpoint, this.token, method, path, body, customHeaders)\n  }\n\n  /**\n   * Get the allowed poll interval for fetching. If an error occurs it will\n   * return null.\n   */\n  public async getFetchPollInterval(\n    owner: string,\n    name: string\n  ): Promise<number | null> {\n    const path = `repos/${owner}/${name}/git`\n    try {\n      const response = await this.request('HEAD', path)\n      const interval = response.headers.get('x-poll-interval')\n      if (interval) {\n        const parsed = parseInt(interval, 10)\n        return isNaN(parsed) ? null : parsed\n      }\n      return null\n    } catch (e) {\n      log.warn(`getFetchPollInterval: failed for ${owner}/${name}`, e)\n      return null\n    }\n  }\n\n  /** Fetch the mentionable users for the repository. */\n  public async fetchMentionables(\n    owner: string,\n    name: string,\n    etag: string | null\n  ): Promise<IAPIMentionablesResponse | null> {\n    // NB: this custom `Accept` is required for the `mentionables` endpoint.\n    const headers: any = {\n      Accept: 'application/vnd.github.jerry-maguire-preview',\n    }\n\n    if (etag) {\n      headers['If-None-Match'] = etag\n    }\n\n    try {\n      const path = `repos/${owner}/${name}/mentionables/users`\n      const response = await this.request('GET', path, undefined, headers)\n\n      if (response.status === HttpStatusCode.NotFound) {\n        log.warn(`fetchMentionables: '${path}' returned a 404`)\n        return null\n      }\n\n      if (response.status === HttpStatusCode.NotModified) {\n        return null\n      }\n      const users = await parsedResponse<ReadonlyArray<IAPIMentionableUser>>(\n        response\n      )\n      const etag = response.headers.get('etag')\n      return { users, etag }\n    } catch (e) {\n      log.warn(`fetchMentionables: failed for ${owner}/${name}`, e)\n      return null\n    }\n  }\n\n  /**\n   * Retrieve the public profile information of a user with\n   * a given username.\n   */\n  public async fetchUser(login: string): Promise<IAPIUser | null> {\n    try {\n      const response = await this.request(\n        'GET',\n        `users/${encodeURIComponent(login)}`\n      )\n\n      if (response.status === 404) {\n        return null\n      }\n\n      return await parsedResponse<IAPIUser>(response)\n    } catch (e) {\n      log.warn(`fetchUser: failed with endpoint ${this.endpoint}`, e)\n      throw e\n    }\n  }\n}\n\nexport enum AuthorizationResponseKind {\n  Authorized,\n  Failed,\n  TwoFactorAuthenticationRequired,\n  UserRequiresVerification,\n  PersonalAccessTokenBlocked,\n  Error,\n  EnterpriseTooOld,\n}\n\nexport type AuthorizationResponse =\n  | { kind: AuthorizationResponseKind.Authorized; token: string }\n  | { kind: AuthorizationResponseKind.Failed; response: Response }\n  | {\n      kind: AuthorizationResponseKind.TwoFactorAuthenticationRequired\n      type: AuthenticationMode\n    }\n  | { kind: AuthorizationResponseKind.Error; response: Response }\n  | { kind: AuthorizationResponseKind.UserRequiresVerification }\n  | { kind: AuthorizationResponseKind.PersonalAccessTokenBlocked }\n  | { kind: AuthorizationResponseKind.EnterpriseTooOld }\n\n/**\n * Create an authorization with the given login, password, and one-time\n * password.\n */\nexport async function createAuthorization(\n  endpoint: string,\n  login: string,\n  password: string,\n  oneTimePassword: string | null\n): Promise<AuthorizationResponse> {\n  const creds = Buffer.from(`${login}:${password}`, 'utf8').toString('base64')\n  const authorization = `Basic ${creds}`\n  const optHeader = oneTimePassword ? { 'X-GitHub-OTP': oneTimePassword } : {}\n\n  const note = await getNote()\n\n  const response = await request(\n    endpoint,\n    null,\n    'POST',\n    'authorizations',\n    {\n      scopes: Scopes,\n      client_id: ClientID,\n      client_secret: ClientSecret,\n      note: note,\n      note_url: NoteURL,\n      fingerprint: uuid(),\n    },\n    {\n      Authorization: authorization,\n      ...optHeader,\n    }\n  )\n\n  try {\n    const result = await parsedResponse<IAPIAuthorization>(response)\n    if (result) {\n      const token = result.token\n      if (token && typeof token === 'string' && token.length) {\n        return { kind: AuthorizationResponseKind.Authorized, token }\n      }\n    }\n  } catch (e) {\n    if (response.status === 401) {\n      const otpResponse = response.headers.get('x-github-otp')\n      if (otpResponse) {\n        const pieces = otpResponse.split(';')\n        if (pieces.length === 2) {\n          const type = pieces[1].trim()\n          switch (type) {\n            case 'app':\n              return {\n                kind: AuthorizationResponseKind.TwoFactorAuthenticationRequired,\n                type: AuthenticationMode.App,\n              }\n            case 'sms':\n              return {\n                kind: AuthorizationResponseKind.TwoFactorAuthenticationRequired,\n                type: AuthenticationMode.Sms,\n              }\n            default:\n              return { kind: AuthorizationResponseKind.Failed, response }\n          }\n        }\n      }\n\n      return { kind: AuthorizationResponseKind.Failed, response }\n    }\n\n    const apiError = e instanceof APIError && e.apiError\n    if (apiError) {\n      if (\n        response.status === 403 &&\n        apiError.message ===\n          'This API can only be accessed with username and password Basic Auth'\n      ) {\n        // Authorization API does not support providing personal access tokens\n        return { kind: AuthorizationResponseKind.PersonalAccessTokenBlocked }\n      } else if (response.status === 422) {\n        if (apiError.errors) {\n          for (const error of apiError.errors) {\n            const isExpectedResource =\n              error.resource.toLowerCase() === 'oauthaccess'\n            const isExpectedField = error.field.toLowerCase() === 'user'\n            if (isExpectedField && isExpectedResource) {\n              return {\n                kind: AuthorizationResponseKind.UserRequiresVerification,\n              }\n            }\n          }\n        } else if (\n          apiError.message === 'Invalid OAuth application client_id or secret.'\n        ) {\n          return { kind: AuthorizationResponseKind.EnterpriseTooOld }\n        }\n      }\n    }\n  }\n\n  return { kind: AuthorizationResponseKind.Error, response }\n}\n\n/** Fetch the user authenticated by the token. */\nexport async function fetchUser(\n  endpoint: string,\n  token: string\n): Promise<Account> {\n  const api = new API(endpoint, token)\n  try {\n    const user = await api.fetchAccount()\n    const emails = await api.fetchEmails()\n    const defaultEmail = getDefaultEmail(emails)\n    const avatarURL = getAvatarWithEnterpriseFallback(\n      user.avatar_url,\n      defaultEmail,\n      endpoint\n    )\n    return new Account(\n      user.login,\n      endpoint,\n      token,\n      emails,\n      avatarURL,\n      user.id,\n      user.name || user.login\n    )\n  } catch (e) {\n    log.warn(`fetchUser: failed with endpoint ${endpoint}`, e)\n    throw e\n  }\n}\n\n/** Get metadata from the server. */\nexport async function fetchMetadata(\n  endpoint: string\n): Promise<IServerMetadata | null> {\n  const url = `${endpoint}/meta`\n\n  try {\n    const response = await request(endpoint, null, 'GET', 'meta', undefined, {\n      'Content-Type': 'application/json',\n    })\n\n    const result = await parsedResponse<IServerMetadata>(response)\n    if (!result || result.verifiable_password_authentication === undefined) {\n      return null\n    }\n\n    return result\n  } catch (e) {\n    log.error(\n      `fetchMetadata: unable to load metadata from '${url}' as a fallback`,\n      e\n    )\n    return null\n  }\n}\n\n/** The note used for created authorizations. */\nasync function getNote(): Promise<string> {\n  let localUsername = 'unknown'\n  try {\n    localUsername = await username()\n  } catch (e) {\n    log.error(\n      `getNote: unable to resolve machine username, using '${localUsername}' as a fallback`,\n      e\n    )\n  }\n\n  return `GitHub Desktop on ${localUsername}@${OS.hostname()}`\n}\n\n/**\n * Map a repository's URL to the endpoint associated with it. For example:\n *\n * https://github.com/desktop/desktop -> https://api.github.com\n * http://github.mycompany.com/my-team/my-project -> http://github.mycompany.com/api\n */\nexport function getEndpointForRepository(url: string): string {\n  const parsed = URL.parse(url)\n  if (parsed.hostname === 'github.com') {\n    return getDotComAPIEndpoint()\n  } else {\n    return `${parsed.protocol}//${parsed.hostname}/api`\n  }\n}\n\n/**\n * Get the URL for the HTML site. For example:\n *\n * https://api.github.com -> https://github.com\n * http://github.mycompany.com/api -> http://github.mycompany.com/\n */\nexport function getHTMLURL(endpoint: string): string {\n  // In the case of GitHub.com, the HTML site lives on the parent domain.\n  //  E.g., https://api.github.com -> https://github.com\n  //\n  // Whereas with Enterprise, it lives on the same domain but without the\n  // API path:\n  //  E.g., https://github.mycompany.com/api/v3 -> https://github.mycompany.com\n  //\n  // We need to normalize them.\n  if (endpoint === getDotComAPIEndpoint()) {\n    return 'https://github.com'\n  } else {\n    const parsed = URL.parse(endpoint)\n    return `${parsed.protocol}//${parsed.hostname}`\n  }\n}\n\n/**\n * Get the API URL for an HTML URL. For example:\n *\n * http://github.mycompany.com -> http://github.mycompany.com/api/v3\n */\nexport function getEnterpriseAPIURL(endpoint: string): string {\n  const parsed = URL.parse(endpoint)\n  return `${parsed.protocol}//${parsed.hostname}/api/v3`\n}\n\n/** Get github.com's API endpoint. */\nexport function getDotComAPIEndpoint(): string {\n  // NOTE:\n  // `DESKTOP_GITHUB_DOTCOM_API_ENDPOINT` only needs to be set if you are\n  // developing against a local version of GitHub the Website, and need to debug\n  // the server-side interaction. For all other cases you should leave this\n  // unset.\n  const envEndpoint = process.env['DESKTOP_GITHUB_DOTCOM_API_ENDPOINT']\n  if (envEndpoint && envEndpoint.length > 0) {\n    return envEndpoint\n  }\n\n  return 'https://api.github.com'\n}\n\n/** Get the account for the endpoint. */\nexport function getAccountForEndpoint(\n  accounts: ReadonlyArray<Account>,\n  endpoint: string\n): Account | null {\n  return accounts.find(a => a.endpoint === endpoint) || null\n}\n\nexport function getOAuthAuthorizationURL(\n  endpoint: string,\n  state: string\n): string {\n  const urlBase = getHTMLURL(endpoint)\n  const scope = encodeURIComponent(Scopes.join(' '))\n  return `${urlBase}/login/oauth/authorize?client_id=${ClientID}&scope=${scope}&state=${state}`\n}\n\nexport async function requestOAuthToken(\n  endpoint: string,\n  code: string\n): Promise<string | null> {\n  try {\n    const urlBase = getHTMLURL(endpoint)\n    const response = await request(\n      urlBase,\n      null,\n      'POST',\n      'login/oauth/access_token',\n      {\n        client_id: ClientID,\n        client_secret: ClientSecret,\n        code: code,\n      }\n    )\n    const result = await parsedResponse<IAPIAccessToken>(response)\n    return result.access_token\n  } catch (e) {\n    log.warn(`requestOAuthToken: failed with endpoint ${endpoint}`, e)\n    return null\n  }\n}\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nif (process.env.NODE_ENV !== 'production') {\n  var REACT_ELEMENT_TYPE = (typeof Symbol === 'function' &&\n    Symbol.for &&\n    Symbol.for('react.element')) ||\n    0xeac7;\n\n  var isValidElement = function(object) {\n    return typeof object === 'object' &&\n      object !== null &&\n      object.$$typeof === REACT_ELEMENT_TYPE;\n  };\n\n  // By explicitly using `prop-types` you are opting into new development behavior.\n  // http://fb.me/prop-types-in-prod\n  var throwOnDirectAccess = true;\n  module.exports = require('./factoryWithTypeCheckers')(isValidElement, throwOnDirectAccess);\n} else {\n  // By explicitly using `prop-types` you are opting into new production behavior.\n  // http://fb.me/prop-types-in-prod\n  module.exports = require('./factoryWithThrowingShims')();\n}\n","import { Account } from '../models/account'\nimport { CommitIdentity } from '../models/commit-identity'\nimport { IDiff } from '../models/diff'\nimport { Repository, ILocalRepositoryState } from '../models/repository'\n\nimport { Branch, IAheadBehind } from '../models/branch'\nimport { Tip } from '../models/tip'\nimport { Commit } from '../models/commit'\nimport {\n  CommittedFileChange,\n  WorkingDirectoryStatus,\n  WorkingDirectoryFileChange,\n} from '../models/status'\nimport { CloningRepository } from '../models/cloning-repository'\nimport { IGitHubUser } from './databases/github-user-database'\nimport { SignInState } from './stores/sign-in-store'\nimport { ICommitMessage } from './stores/git-store'\nimport { IMenu } from '../models/app-menu'\nimport { IRemote } from '../models/remote'\nimport { WindowState } from './window-state'\nimport { RetryAction } from './retry-actions'\nimport { ExternalEditor } from '../lib/editors'\nimport { PreferencesTab } from '../models/preferences'\nimport { Shell } from './shells'\nimport { CloneRepositoryTab } from '../models/clone-repository-tab'\nimport { BranchesTab } from '../models/branches-tab'\nimport { PullRequest } from '../models/pull-request'\nimport { ReleaseSummary } from '../models/release-notes'\nimport { IAuthor } from '../models/author'\nimport { ComparisonCache } from './comparison-cache'\nimport { ApplicationTheme } from '../ui/lib/application-theme'\nimport { MergeResultKind } from '../models/merge'\n\nexport { ICommitMessage }\n\nexport enum SelectionType {\n  Repository,\n  CloningRepository,\n  MissingRepository,\n}\n\n/** The image diff type. */\nexport enum ImageDiffType {\n  /** Show the old and new images side by side. */\n  TwoUp,\n\n  /** Swipe between the old and new image. */\n  Swipe,\n\n  /** Onion skin. */\n  OnionSkin,\n\n  /** Highlight differences. */\n  Difference,\n}\n\nexport type PossibleSelections =\n  | {\n      type: SelectionType.Repository\n      repository: Repository\n      state: IRepositoryState\n    }\n  | {\n      type: SelectionType.CloningRepository\n      repository: CloningRepository\n      progress: ICloneProgress\n    }\n  | { type: SelectionType.MissingRepository; repository: Repository }\n\n/** All of the shared app state. */\nexport interface IAppState {\n  readonly accounts: ReadonlyArray<Account>\n  /**\n   * The current list of repositories tracked in the application\n   */\n  readonly repositories: ReadonlyArray<Repository | CloningRepository>\n\n  /**\n   * A cache of the latest repository state values, keyed by the repository id\n   */\n  readonly localRepositoryStateLookup: Map<number, ILocalRepositoryState>\n\n  readonly selectedState: PossibleSelections | null\n\n  /**\n   * The state of the ongoing (if any) sign in process. See SignInState\n   * and SignInStore for more details. Null if no current sign in flow\n   * is active. Sign in flows are initiated through the dispatcher methods\n   * beginDotComSignIn and beginEnterpriseSign in or via the\n   * showDotcomSignInDialog and showEnterpriseSignInDialog methods.\n   */\n  readonly signInState: SignInState | null\n\n  /**\n   * The current state of the window, ie maximized, minimized full-screen etc.\n   */\n  readonly windowState: WindowState\n\n  /**\n   * The current zoom factor of the window represented as a fractional number\n   * where 1 equals 100% (ie actual size) and 2 represents 200%.\n   */\n  readonly windowZoomFactor: number\n\n  /**\n   * A value indicating whether or not the current application\n   * window has focus.\n   */\n  readonly appIsFocused: boolean\n\n  readonly showWelcomeFlow: boolean\n  readonly currentPopup: Popup | null\n  readonly currentFoldout: Foldout | null\n\n  /**\n   * A list of currently open menus with their selected items\n   * in the application menu.\n   *\n   * The semantics around what constitues an open menu and how\n   * selection works is defined by the AppMenu class and the\n   * individual components transforming that state.\n   *\n   * Note that as long as the renderer has received an application\n   * menu from the main process there will always be one menu\n   * \"open\", that is the root menu which can't be closed. In other\n   * words, a non-zero length appMenuState does not imply that the\n   * application menu should be visible. Currently thats defined by\n   * whether the app menu is open as a foldout (see currentFoldout).\n   *\n   * Not applicable on macOS unless the in-app application menu has\n   * been explicitly enabled for testing purposes.\n   */\n  readonly appMenuState: ReadonlyArray<IMenu>\n\n  readonly errors: ReadonlyArray<Error>\n\n  /** Map from the emoji shortcut (e.g., :+1:) to the image's local path. */\n  readonly emoji: Map<string, string>\n\n  /**\n   * The width of the repository sidebar.\n   *\n   * This affects the changes and history sidebar\n   * as well as the first toolbar section which contains\n   * repo selection on all platforms and repo selection and\n   * app menu on Windows.\n   *\n   * Lives on IAppState as opposed to IRepositoryState\n   * because it's used in the toolbar as well as the\n   * repository.\n   */\n  readonly sidebarWidth: number\n\n  /** The width of the commit summary column in the history view */\n  readonly commitSummaryWidth: number\n\n  /** Whether we should hide the toolbar (and show inverted window controls) */\n  readonly titleBarStyle: 'light' | 'dark'\n\n  /**\n   * Used to highlight access keys throughout the app when the\n   * Alt key is pressed. Only applicable on non-macOS platforms.\n   */\n  readonly highlightAccessKeys: boolean\n\n  /** Whether we should show the update banner */\n  readonly isUpdateAvailableBannerVisible: boolean\n\n  /** Whether we should show a confirmation dialog */\n  readonly askForConfirmationOnRepositoryRemoval: boolean\n\n  /** Whether we should show a confirmation dialog */\n  readonly askForConfirmationOnDiscardChanges: boolean\n\n  /** The external editor to use when opening repositories */\n  readonly selectedExternalEditor?: ExternalEditor\n\n  /** What type of visual diff mode we should use to compare images */\n  readonly imageDiffType: ImageDiffType\n\n  /** The user's preferred shell. */\n  readonly selectedShell: Shell\n\n  /** The current repository filter text. */\n  readonly repositoryFilterText: string\n\n  /** The currently selected tab for Clone Repository. */\n  readonly selectedCloneRepositoryTab: CloneRepositoryTab\n\n  /** The currently selected tab for the Branches foldout. */\n  readonly selectedBranchesTab: BranchesTab\n\n  /** The currently selected appearance (aka theme) */\n  readonly selectedTheme: ApplicationTheme\n}\n\nexport enum PopupType {\n  RenameBranch = 1,\n  DeleteBranch,\n  ConfirmDiscardChanges,\n  Preferences,\n  MergeBranch,\n  RepositorySettings,\n  AddRepository,\n  CreateRepository,\n  CloneRepository,\n  CreateBranch,\n  SignIn,\n  About,\n  InstallGit,\n  PublishRepository,\n  Acknowledgements,\n  UntrustedCertificate,\n  RemoveRepository,\n  TermsAndConditions,\n  PushBranchCommits,\n  CLIInstalled,\n  GenericGitAuthentication,\n  ExternalEditorFailed,\n  OpenShellFailed,\n  InitializeLFS,\n  LFSAttributeMismatch,\n  UpstreamAlreadyExists,\n  ReleaseNotes,\n  DeletePullRequest,\n  MergeConflicts,\n}\n\nexport type Popup =\n  | { type: PopupType.RenameBranch; repository: Repository; branch: Branch }\n  | {\n      type: PopupType.DeleteBranch\n      repository: Repository\n      branch: Branch\n      existsOnRemote: boolean\n    }\n  | {\n      type: PopupType.ConfirmDiscardChanges\n      repository: Repository\n      files: ReadonlyArray<WorkingDirectoryFileChange>\n      showDiscardChangesSetting?: boolean\n      discardingAllChanges?: boolean\n    }\n  | { type: PopupType.Preferences; initialSelectedTab?: PreferencesTab }\n  | {\n      type: PopupType.MergeBranch\n      repository: Repository\n      branch?: Branch\n    }\n  | { type: PopupType.RepositorySettings; repository: Repository }\n  | { type: PopupType.AddRepository; path?: string }\n  | { type: PopupType.CreateRepository; path?: string }\n  | {\n      type: PopupType.CloneRepository\n      initialURL: string | null\n    }\n  | {\n      type: PopupType.CreateBranch\n      repository: Repository\n      initialName?: string\n    }\n  | { type: PopupType.SignIn }\n  | { type: PopupType.About }\n  | { type: PopupType.InstallGit; path: string }\n  | { type: PopupType.PublishRepository; repository: Repository }\n  | { type: PopupType.Acknowledgements }\n  | {\n      type: PopupType.UntrustedCertificate\n      certificate: Electron.Certificate\n      url: string\n    }\n  | { type: PopupType.RemoveRepository; repository: Repository }\n  | { type: PopupType.TermsAndConditions }\n  | {\n      type: PopupType.PushBranchCommits\n      repository: Repository\n      branch: Branch\n      unPushedCommits?: number\n    }\n  | { type: PopupType.CLIInstalled }\n  | {\n      type: PopupType.GenericGitAuthentication\n      hostname: string\n      retryAction: RetryAction\n    }\n  | {\n      type: PopupType.ExternalEditorFailed\n      message: string\n      suggestAtom?: boolean\n      openPreferences?: boolean\n    }\n  | { type: PopupType.OpenShellFailed; message: string }\n  | { type: PopupType.InitializeLFS; repositories: ReadonlyArray<Repository> }\n  | { type: PopupType.LFSAttributeMismatch }\n  | {\n      type: PopupType.UpstreamAlreadyExists\n      repository: Repository\n      existingRemote: IRemote\n    }\n  | {\n      type: PopupType.ReleaseNotes\n      newRelease: ReleaseSummary\n    }\n  | {\n      type: PopupType.DeletePullRequest\n      repository: Repository\n      branch: Branch\n      pullRequest: PullRequest\n    }\n  | { type: PopupType.MergeConflicts; repository: Repository }\n\nexport enum FoldoutType {\n  Repository,\n  Branch,\n  AppMenu,\n  AddMenu,\n}\n\nexport type AppMenuFoldout = {\n  type: FoldoutType.AppMenu\n\n  /**\n   * Whether or not the application menu was opened with the Alt key, this\n   * enables access key highlighting for applicable menu items as well as\n   * keyboard navigation by pressing access keys.\n   */\n  enableAccessKeyNavigation: boolean\n\n  /**\n   * Whether the menu was opened by pressing Alt (or Alt+X where X is an\n   * access key for one of the top level menu items). This is used as a\n   * one-time signal to the AppMenu to use some special semantics for\n   * selection and focus. Specifically it will ensure that the last opened\n   * menu will receive focus.\n   */\n  openedWithAccessKey?: boolean\n}\n\nexport type Foldout =\n  | { type: FoldoutType.Repository }\n  | { type: FoldoutType.Branch }\n  | { type: FoldoutType.AddMenu }\n  | AppMenuFoldout\n\nexport enum RepositorySectionTab {\n  Changes,\n  History,\n}\n\n/**\n * Stores information about a merge conflict when it occurs\n */\ninterface IConflictState {\n  readonly branch: Branch\n}\n\nexport interface IRepositoryState {\n  readonly commitSelection: ICommitSelection\n  readonly changesState: IChangesState\n  readonly compareState: ICompareState\n  readonly selectedSection: RepositorySectionTab\n\n  /**\n   * The name and email that will be used for the author info\n   * when committing barring any race where user.name/user.email is\n   * updated between us reading it and a commit being made\n   * (ie we don't currently use this value explicitly when committing)\n   */\n  readonly commitAuthor: CommitIdentity | null\n\n  readonly branchesState: IBranchesState\n\n  /**\n   * Mapping from lowercased email addresses to the associated GitHub user. Note\n   * that an email address may not have an associated GitHub user, or the user\n   * may still be loading.\n   */\n  readonly gitHubUsers: Map<string, IGitHubUser>\n\n  /** The commits loaded, keyed by their full SHA. */\n  readonly commitLookup: Map<string, Commit>\n\n  /**\n   * The ordered local commit SHAs. The commits themselves can be looked up in\n   * `commitLookup.`\n   */\n  readonly localCommitSHAs: ReadonlyArray<string>\n\n  /** The remote currently associated with the repository, if defined in the configuration */\n  readonly remote: IRemote | null\n\n  /** The state of the current branch in relation to its upstream. */\n  readonly aheadBehind: IAheadBehind | null\n\n  /** Is a push/pull/update in progress? */\n  readonly isPushPullFetchInProgress: boolean\n\n  /** Is a commit in progress? */\n  readonly isCommitting: boolean\n\n  /** The date the repository was last fetched. */\n  readonly lastFetched: Date | null\n\n  /**\n   * If we're currently working on switching to a new branch this\n   * provides insight into the progress of that operation.\n   *\n   * null if no current branch switch operation is in flight.\n   */\n  readonly checkoutProgress: ICheckoutProgress | null\n\n  /**\n   * If we're currently working on pushing a branch, fetching\n   * from a remote or pulling a branch this provides insight\n   * into the progress of that operation.\n   *\n   * null if no such operation is in flight.\n   */\n  readonly pushPullFetchProgress: Progress | null\n\n  /**\n   * If we're currently reverting a commit and it involves LFS progress, this\n   * will contain the LFS progress.\n   *\n   * null if no such operation is in flight.\n   */\n  readonly revertProgress: IRevertProgress | null\n}\n\nexport type Progress =\n  | IGenericProgress\n  | ICheckoutProgress\n  | IFetchProgress\n  | IPullProgress\n  | IPushProgress\n  | IRevertProgress\n\n/**\n * Base interface containing all the properties that progress events\n * need to support.\n */\ninterface IProgress {\n  /**\n   * The overall progress of the operation, represented as a fraction between\n   * 0 and 1.\n   */\n  readonly value: number\n\n  /**\n   * An informative text for user consumption indicating the current operation\n   * state. This will be high level such as 'Pushing origin' or\n   * 'Fetching upstream' and will typically persist over a number of progress\n   * events. For more detailed information about the progress see\n   * the description field\n   */\n  readonly title: string\n\n  /**\n   * An informative text for user consumption. In the case of git progress this\n   * will usually be the last raw line of output from git.\n   */\n  readonly description?: string\n}\n\n/**\n * An object describing progression of an operation that can't be\n * directly mapped or attributed to either one of the more specific\n * progress events (Fetch, Checkout etc). An example of this would be\n * our own refreshing of internal repository state that takes part\n * after fetch, push and pull.\n */\nexport interface IGenericProgress extends IProgress {\n  kind: 'generic'\n}\n\n/**\n * An object describing the progression of a branch checkout operation\n */\nexport interface ICheckoutProgress extends IProgress {\n  kind: 'checkout'\n\n  /** The branch that's currently being checked out */\n  readonly targetBranch: string\n}\n\n/**\n * An object describing the progression of a fetch operation\n */\nexport interface IFetchProgress extends IProgress {\n  kind: 'fetch'\n\n  /**\n   * The remote that's being fetched\n   */\n  readonly remote: string\n}\n\n/**\n * An object describing the progression of a pull operation\n */\nexport interface IPullProgress extends IProgress {\n  kind: 'pull'\n\n  /**\n   * The remote that's being pulled from\n   */\n  readonly remote: string\n}\n\n/**\n * An object describing the progression of a pull operation\n */\nexport interface IPushProgress extends IProgress {\n  kind: 'push'\n\n  /**\n   * The remote that's being pushed to\n   */\n  readonly remote: string\n\n  /**\n   * The branch that's being pushed\n   */\n  readonly branch: string\n}\n\n/**\n * An object describing the progression of a fetch operation\n */\nexport interface ICloneProgress extends IProgress {\n  kind: 'clone'\n}\n\n/** An object describing the progression of a revert operation. */\nexport interface IRevertProgress extends IProgress {\n  kind: 'revert'\n}\n\nexport interface IBranchesState {\n  /**\n   * The current tip of HEAD, either a branch, a commit (if HEAD is\n   * detached) or an unborn branch (a branch with no commits).\n   */\n  readonly tip: Tip\n\n  /**\n   * The default branch for a given repository. Most commonly this\n   * will be the 'master' branch but GitHub users are able to change\n   * their default branch in the web UI.\n   */\n  readonly defaultBranch: Branch | null\n\n  /**\n   * A list of all branches (remote and local) that's currently in\n   * the repository.\n   */\n  readonly allBranches: ReadonlyArray<Branch>\n\n  /**\n   * A list of zero to a few (at time of writing 5 but check loadRecentBranches\n   * in git-store for definitive answer) branches that have been checked out\n   * recently. This list is compiled by reading the reflog and tracking branch\n   * switches over the last couple of thousand reflog entries.\n   */\n  readonly recentBranches: ReadonlyArray<Branch>\n\n  /** The open pull requests in the repository. */\n  readonly openPullRequests: ReadonlyArray<PullRequest>\n\n  /** Are we currently loading pull requests? */\n  readonly isLoadingPullRequests: boolean\n\n  /** The pull request associated with the current branch. */\n  readonly currentPullRequest: PullRequest | null\n}\n\nexport interface ICommitSelection {\n  /** The commit currently selected in the app */\n  readonly sha: string | null\n\n  /** The list of files associated with the current commit */\n  readonly changedFiles: ReadonlyArray<CommittedFileChange>\n\n  /** The selected file inside the selected commit */\n  readonly file: CommittedFileChange | null\n\n  /** The diff of the currently-selected file */\n  readonly diff: IDiff | null\n}\n\nexport interface IChangesState {\n  readonly workingDirectory: WorkingDirectoryStatus\n\n  /**\n   * The ID of the selected files. The files themselves can be looked up in\n   * `workingDirectory`.\n   */\n  readonly selectedFileIDs: string[]\n\n  readonly diff: IDiff | null\n\n  /**\n   * The commit message to use based on the context of the repository, e.g., the\n   * message from a recently undone commit.\n   */\n  readonly contextualCommitMessage: ICommitMessage | null\n\n  /** The commit message for a work-in-progress commit in the changes view. */\n  readonly commitMessage: ICommitMessage | null\n\n  /**\n   * Whether or not to show a field for adding co-authors to\n   * a commit (currently only supported for GH/GHE repositories)\n   */\n  readonly showCoAuthoredBy: boolean\n\n  /**\n   * A list of authors (name, email pairs) which have been\n   * entered into the co-authors input box in the commit form\n   * and which _may_ be used in the subsequent commit to add\n   * Co-Authored-By commit message trailers depending on whether\n   * the user has chosen to do so.\n   */\n  readonly coAuthors: ReadonlyArray<IAuthor>\n\n  /**\n   * Stores information about a merge conflict when it occurs\n   *\n   * The absence of a value means there is no merge conflict\n   */\n  readonly conflictState: IConflictState | null\n}\n\nexport enum ComparisonView {\n  None = 'none',\n  Ahead = 'ahead',\n  Behind = 'behind',\n}\n\n/**\n * The default comparison state is to display the history for the current\n * branch.\n */\nexport interface IDisplayHistory {\n  readonly kind: ComparisonView.None\n}\n\n/**\n * When the user has chosen another branch to compare, using their current\n * branch as the base branch.\n */\nexport interface ICompareBranch {\n  /** The chosen comparison mode determines which commits to show */\n  readonly kind: ComparisonView.Ahead | ComparisonView.Behind\n\n  /** The branch to compare against the base branch */\n  readonly comparisonBranch: Branch\n\n  /** The number of commits the selected branch is ahead/behind the current branch */\n  readonly aheadBehind: IAheadBehind\n}\n\nexport interface ICompareState {\n  /** Show the diverging notification banner */\n  readonly isDivergingBranchBannerVisible: boolean\n\n  /** The current state of the compare form, based on user input */\n  readonly formState: IDisplayHistory | ICompareBranch\n\n  /** The result of merging the compare branch into the current branch, if a branch selected */\n  readonly mergeStatus: MergeResultStatus | null\n\n  /** Whether the branch list should be expanded or hidden */\n  readonly showBranchList: boolean\n\n  /** The text entered into the compare branch filter text box */\n  readonly filterText: string\n\n  /** The SHA associated with the most recent history state */\n  readonly tip: string | null\n\n  /** The SHAs of commits to render in the compare list */\n  readonly commitSHAs: ReadonlyArray<string>\n\n  /** A list of all branches (remote and local) currently in the repository. */\n  readonly allBranches: ReadonlyArray<Branch>\n\n  /**\n   * A list of zero to a few (at time of writing 5 but check loadRecentBranches\n   * in git-store for definitive answer) branches that have been checked out\n   * recently. This list is compiled by reading the reflog and tracking branch\n   * switches over the last couple of thousand reflog entries.\n   */\n  readonly recentBranches: ReadonlyArray<Branch>\n\n  /**\n   * The default branch for a given repository. Most commonly this\n   * will be the 'master' branch but GitHub users are able to change\n   * their default branch in the web UI.\n   */\n  readonly defaultBranch: Branch | null\n\n  /**\n   * A local cache of ahead/behind computations to compare other refs to the current branch\n   */\n  readonly aheadBehindCache: ComparisonCache\n\n  /**\n   * The best candidate branch to compare the current branch to.\n   * Also includes the ahead/behind info for the inferred branch\n   * relative to the current branch.\n   */\n  readonly inferredComparisonBranch: {\n    branch: Branch | null\n    aheadBehind: IAheadBehind | null\n  }\n}\n\nexport interface ICompareFormUpdate {\n  /** The updated filter text to set */\n  readonly filterText: string\n\n  /** Thew new state of the branches list */\n  readonly showBranchList: boolean\n}\n\nexport type MergeResultStatus =\n  | {\n      kind: MergeResultKind.Loading\n    }\n  | {\n      kind: MergeResultKind.Conflicts\n      conflictedFiles: number\n    }\n  | { kind: MergeResultKind.Clean }\n  | { kind: MergeResultKind.Invalid }\n\nexport enum CompareActionKind {\n  History = 'History',\n  Branch = 'Branch',\n}\n\nexport interface ICompareToBranch {\n  readonly kind: CompareActionKind.Branch\n  readonly branch: Branch\n  readonly mode: ComparisonView.Ahead | ComparisonView.Behind\n}\n\n/**\n * An action to send to the application store to update the compare state\n */\nexport type CompareAction =\n  | {\n      readonly kind: CompareActionKind.History\n    }\n  | ICompareToBranch\n","import * as React from 'react'\nimport { shell } from '../../lib/app-shell'\nimport * as classNames from 'classnames'\n\ninterface ILinkButtonProps {\n  /** A URI to open on click. */\n  readonly uri?: string\n\n  /** A function to call on click. */\n  readonly onClick?: () => void\n\n  /** CSS classes attached to the component */\n  readonly className?: string\n\n  /** The tab index of the anchor element. */\n  readonly tabIndex?: number\n\n  /** Disable the link from being clicked */\n  readonly disabled?: boolean\n\n  /** title-text or tooltip for the link */\n  readonly title?: string\n}\n\n/**\n * A link component.\n *\n * Provide `children` elements for the title of the rendered hyperlink.\n */\nexport class LinkButton extends React.Component<ILinkButtonProps, {}> {\n  public render() {\n    const href = this.props.uri || ''\n    const className = classNames('link-button-component', this.props.className)\n\n    return (\n      <a\n        className={className}\n        href={href}\n        onClick={this.onClick}\n        title={this.props.title}\n        tabIndex={this.props.tabIndex}\n      >\n        {this.props.children}\n      </a>\n    )\n  }\n\n  private onClick = (event: React.MouseEvent<HTMLAnchorElement>) => {\n    event.preventDefault()\n\n    if (this.props.disabled) {\n      return\n    }\n\n    const uri = this.props.uri\n    if (uri) {\n      shell.openExternal(uri)\n    }\n\n    const onClick = this.props.onClick\n    if (onClick) {\n      onClick()\n    }\n  }\n}\n","import * as React from 'react'\nimport * as classNames from 'classnames'\n\ninterface IRowProps {\n  /** The class name for the internal element. */\n  readonly className?: string\n}\n\n/**\n * A horizontal row element with app-standard styles.\n *\n * Provide `children` elements for the contents of this row.\n */\nexport class Row extends React.Component<IRowProps, {}> {\n  public render() {\n    const className = classNames('row-component', this.props.className)\n    return <div className={className}>{this.props.children}</div>\n  }\n}\n","'use strict'\n\nmodule.exports = Object.assign(\n  {},\n  // Export promiseified graceful-fs:\n  require('./fs'),\n  // Export extra methods:\n  require('./copy-sync'),\n  require('./copy'),\n  require('./empty'),\n  require('./ensure'),\n  require('./json'),\n  require('./mkdirs'),\n  require('./move-sync'),\n  require('./move'),\n  require('./output'),\n  require('./path-exists'),\n  require('./remove')\n)\n","module.exports = require(\"fs\");","import * as React from 'react'\nimport * as classNames from 'classnames'\nimport { createUniqueId, releaseUniqueId } from './id-pool'\nimport { LinkButton } from './link-button'\nimport { showContextualMenu } from '../main-process-proxy'\n\nexport interface ITextBoxProps {\n  /** The label for the input field. */\n  readonly label?: string | JSX.Element\n\n  /**\n   * An optional className to be applied to the rendered\n   * top level element of the component.\n   */\n  readonly className?: string\n\n  /** The placeholder for the input field. */\n  readonly placeholder?: string\n\n  /** The current value of the input field. */\n  readonly value?: string\n\n  /** Whether the input field should auto focus when mounted. */\n  readonly autoFocus?: boolean\n\n  /** Whether the input field is disabled. */\n  readonly disabled?: boolean\n\n  /**\n   * Called when the user changes the value in the input field.\n   *\n   * This differs from the onChange event in that it passes only the new\n   * value and not the event itself. Subscribe to the onChange event if you\n   * need the ability to prevent the action from occurring.\n   *\n   * This callback will not be invoked if the callback from onChange calls\n   * preventDefault.\n   */\n  readonly onValueChanged?: (value: string) => void\n\n  /** Called on key down. */\n  readonly onKeyDown?: (event: React.KeyboardEvent<HTMLInputElement>) => void\n\n  /** The type of the input. Defaults to `text`. */\n  readonly type?: 'text' | 'search' | 'password'\n\n  /**\n   * An optional text for a link label element. A link label is, for the purposes\n   * of this control an anchor element that's rendered alongside (ie on the same)\n   * row as the the label element.\n   *\n   * Note that the link label will only be rendered if the textbox has a\n   * label text (specified through the label prop). A link label is used for\n   * presenting the user with a contextual link related to a specific text\n   * input such as a password recovery link for a password text box.\n   */\n  readonly labelLinkText?: string\n\n  /**\n   * An optional URL to be opened when the label link (if present, see the\n   * labelLinkText prop for more details) is clicked. The link will be opened using the\n   * standard semantics of a LinkButton, i.e. in the configured system browser.\n   *\n   * If not specified consumers need to subscribe to the onLabelLinkClick event.\n   */\n  readonly labelLinkUri?: string\n\n  /**\n   * An optional event handler which is invoked when the label link (if present,\n   * see the labelLinkText prop for more details) is clicked. See the onClick\n   * event on the LinkButton component for more details.\n   */\n  readonly onLabelLinkClick?: () => void\n\n  /** The tab index of the input element. */\n  readonly tabIndex?: number\n\n  /**\n   * Callback used when the component is focused.\n   */\n  readonly onFocus?: () => void\n\n  /**\n   * Callback used when the component loses focus.\n   */\n  readonly onBlur?: () => void\n\n  /**\n   * Callback used when the user has cleared the search text.\n   */\n  readonly onSearchCleared?: () => void\n}\n\ninterface ITextBoxState {\n  /**\n   * An automatically generated id for the input element used to reference\n   * it from the label element. This is generated once via the id pool when the\n   * component is mounted and then released once the component unmounts.\n   */\n  readonly inputId?: string\n\n  /**\n   * Text to display in the underlying input element\n   */\n  readonly value?: string\n}\n\n/** An input element with app-standard styles. */\nexport class TextBox extends React.Component<ITextBoxProps, ITextBoxState> {\n  private inputElement: HTMLInputElement | null = null\n\n  public componentWillMount() {\n    const friendlyName = this.props.label || this.props.placeholder\n    const inputId = createUniqueId(`TextBox_${friendlyName}`)\n\n    this.setState({ inputId, value: this.props.value })\n  }\n\n  public componentWillUnmount() {\n    if (this.state.inputId) {\n      releaseUniqueId(this.state.inputId)\n    }\n  }\n\n  public componentWillReceiveProps(nextProps: ITextBoxProps) {\n    if (this.state.value !== nextProps.value) {\n      this.setState({ value: nextProps.value })\n    }\n  }\n\n  /**\n   * Selects all text (if any) in the inner text input element. Note that this method does not\n   * automatically move keyboard focus, see the focus method for that\n   */\n  public selectAll() {\n    if (this.inputElement !== null) {\n      this.inputElement.select()\n    }\n  }\n\n  /**\n   * Programmatically moves keyboard focus to the inner text input element if it can be focused\n   * (i.e. if it's not disabled explicitly or implicitly through for example a fieldset).\n   */\n  public focus() {\n    if (this.inputElement !== null) {\n      this.inputElement.focus()\n    }\n  }\n\n  /**\n   * Programmatically removes keyboard focus from the inner text input element\n   */\n  public blur() {\n    if (this.inputElement !== null) {\n      this.inputElement.blur()\n    }\n  }\n\n  private onChange = (event: React.FormEvent<HTMLInputElement>) => {\n    const value = event.currentTarget.value\n\n    this.setState({ value }, () => {\n      if (this.props.onValueChanged) {\n        this.props.onValueChanged(value)\n      }\n    })\n  }\n\n  private onSearchTextCleared = () => {\n    if (this.props.onSearchCleared != null) {\n      this.props.onSearchCleared()\n    }\n  }\n\n  /**\n   * The search event here is a Chrome and Safari specific event that is\n   * only reported for input[type=search] elements.\n   *\n   * Source: http://help.dottoro.com/ljdvxmhr.php\n   *\n   * TODO: can we hook into the warning API of React to report on incorrect usage\n   * when you set a `onSearchCleared` callback prop but don't use a `type=search`\n   * input - because this won't set an event handler.\n   *\n   */\n  private onInputRef = (element: HTMLInputElement | null) => {\n    if (this.inputElement != null && this.props.type === 'search') {\n      this.inputElement.removeEventListener('search', this.onSearchTextCleared)\n    }\n\n    this.inputElement = element\n\n    if (this.inputElement != null && this.props.type === 'search') {\n      this.inputElement.addEventListener('search', this.onSearchTextCleared)\n    }\n  }\n\n  private renderLabelLink() {\n    if (!this.props.labelLinkText) {\n      return null\n    }\n\n    return (\n      <LinkButton\n        uri={this.props.labelLinkUri}\n        onClick={this.props.onLabelLinkClick}\n        className=\"link-label\"\n      >\n        {this.props.labelLinkText}\n      </LinkButton>\n    )\n  }\n\n  private renderLabel() {\n    if (!this.props.label) {\n      return null\n    }\n\n    return (\n      <div className=\"label-container\">\n        <label htmlFor={this.state.inputId}>{this.props.label}</label>\n        {this.renderLabelLink()}\n      </div>\n    )\n  }\n\n  private onContextMenu = (event: React.MouseEvent<any>) => {\n    event.preventDefault()\n    showContextualMenu([{ role: 'editMenu' }])\n  }\n\n  private onKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    const value = this.state.value\n\n    if (\n      value !== '' &&\n      this.props.type === 'search' &&\n      event.key === 'Escape'\n    ) {\n      const value = ''\n\n      event.preventDefault()\n      this.setState({ value })\n\n      if (this.props.onValueChanged) {\n        this.props.onValueChanged(value)\n      }\n    } else if (\n      this.props.type === 'search' &&\n      event.key === 'Escape' &&\n      value === ''\n    ) {\n      if (this.props.onBlur) {\n        this.props.onBlur()\n        if (this.inputElement !== null) {\n          this.inputElement.blur()\n        }\n      }\n    }\n\n    if (this.props.onKeyDown !== undefined) {\n      this.props.onKeyDown(event)\n    }\n  }\n\n  public render() {\n    const className = classNames('text-box-component', this.props.className)\n    const inputId = this.props.label ? this.state.inputId : undefined\n\n    return (\n      <div className={className}>\n        {this.renderLabel()}\n\n        <input\n          id={inputId}\n          ref={this.onInputRef}\n          onFocus={this.onFocus}\n          onBlur={this.onBlur}\n          autoFocus={this.props.autoFocus}\n          disabled={this.props.disabled}\n          type={this.props.type}\n          placeholder={this.props.placeholder}\n          value={this.state.value}\n          onChange={this.onChange}\n          onKeyDown={this.onKeyDown}\n          tabIndex={this.props.tabIndex}\n          onContextMenu={this.onContextMenu}\n        />\n      </div>\n    )\n  }\n\n  private onFocus = (event: React.FocusEvent<HTMLInputElement>) => {\n    if (!this.props.autoFocus && this.props.onFocus !== undefined) {\n      this.props.onFocus()\n    }\n  }\n\n  private onBlur = (event: React.FocusEvent<HTMLInputElement>) => {\n    if (this.props.onBlur !== undefined) {\n      this.props.onBlur()\n    }\n  }\n}\n","import { DiffSelection, DiffSelectionType } from './diff'\nimport { OcticonSymbol } from '../ui/octicons'\nimport { assertNever } from '../lib/fatal-error'\n\n/**\n * The status entry code as reported by Git.\n */\nexport enum GitStatusEntry {\n  // M\n  Modified,\n  // A\n  Added,\n  // D\n  Deleted,\n  // R\n  Renamed,\n  // C\n  Copied,\n  // .\n  Unchanged,\n  // ?\n  Untracked,\n  // !\n  Ignored,\n  // U\n  //\n  // While U is a valid code here, we currently mark conflicts as \"Modified\"\n  // in the application - this will likely be something we need to revisit\n  // down the track as we improve our merge conflict experience\n  UpdatedButUnmerged,\n}\n\n/** The file status as represented in GitHub Desktop. */\nexport enum AppFileStatus {\n  New,\n  Modified,\n  Deleted,\n  Copied,\n  Renamed,\n  Conflicted,\n  Resolved,\n}\n\n/** The porcelain status for an ordinary changed entry */\ntype OrdinaryEntry = {\n  readonly kind: 'ordinary'\n  /** how we should represent the file in the application */\n  readonly type: 'added' | 'modified' | 'deleted'\n  /** the status of the index for this entry (if known) */\n  readonly index?: GitStatusEntry\n  /** the status of the working tree for this entry (if known) */\n  readonly workingTree?: GitStatusEntry\n}\n\n/** The porcelain status for a renamed or copied entry */\ntype RenamedOrCopiedEntry = {\n  readonly kind: 'renamed' | 'copied'\n  /** the status of the index for this entry (if known) */\n  readonly index?: GitStatusEntry\n  /** the status of the working tree for this entry (if known) */\n  readonly workingTree?: GitStatusEntry\n}\n\n/** The porcelain status for an unmerged entry */\ntype UnmergedEntry = {\n  readonly kind: 'conflicted'\n  /** the first character of the short code (\"ours\")  */\n  readonly us: GitStatusEntry\n  /** the second character of the short code (\"theirs\")  */\n  readonly them: GitStatusEntry\n}\n\n/** The porcelain status for an unmerged entry */\ntype UntrackedEntry = {\n  readonly kind: 'untracked'\n}\n\n/** The union of possible entries from the git status */\nexport type FileEntry =\n  | OrdinaryEntry\n  | RenamedOrCopiedEntry\n  | UnmergedEntry\n  | UntrackedEntry\n\n/**\n * Convert a given FileStatus value to a human-readable string to be\n * presented to users which describes the state of a file.\n *\n * Typically this will be the same value as that of the enum key.\n *\n * Used in file lists.\n */\nexport function mapStatus(status: AppFileStatus): string {\n  switch (status) {\n    case AppFileStatus.New:\n      return 'New'\n    case AppFileStatus.Modified:\n      return 'Modified'\n    case AppFileStatus.Deleted:\n      return 'Deleted'\n    case AppFileStatus.Renamed:\n      return 'Renamed'\n    case AppFileStatus.Conflicted:\n      return 'Conflicted'\n    case AppFileStatus.Resolved:\n      return 'Resolved'\n    case AppFileStatus.Copied:\n      return 'Copied'\n  }\n\n  return assertNever(status, `Unknown file status ${status}`)\n}\n\n/**\n * Converts a given FileStatus value to an Octicon symbol\n * presented to users when displaying the file path.\n *\n * Used in file lists.\n */\nexport function iconForStatus(status: AppFileStatus): OcticonSymbol {\n  switch (status) {\n    case AppFileStatus.New:\n      return OcticonSymbol.diffAdded\n    case AppFileStatus.Modified:\n      return OcticonSymbol.diffModified\n    case AppFileStatus.Deleted:\n      return OcticonSymbol.diffRemoved\n    case AppFileStatus.Renamed:\n      return OcticonSymbol.diffRenamed\n    case AppFileStatus.Conflicted:\n      return OcticonSymbol.alert\n    case AppFileStatus.Resolved:\n      return OcticonSymbol.check\n    case AppFileStatus.Copied:\n      return OcticonSymbol.diffAdded\n  }\n\n  return assertNever(status, `Unknown file status ${status}`)\n}\n\n/** encapsulate changes to a file associated with a commit */\nexport class FileChange {\n  /** An ID for the file change. */\n  public readonly id: string\n\n  /**\n   * @param path The relative path to the file in the repository.\n   * @param status The status of the change to the file.\n   * @param oldPath The original path in the case of a renamed file.\n   */\n  public constructor(\n    public readonly path: string,\n    public readonly status: AppFileStatus,\n    public readonly oldPath?: string\n  ) {\n    this.id = `${this.status}+${this.path}`\n  }\n}\n\n/** encapsulate the changes to a file in the working directory */\nexport class WorkingDirectoryFileChange extends FileChange {\n  /**\n   * @param path The relative path to the file in the repository.\n   * @param status The status of the change to the file.\n   * @param selection Contains the selection details for this file - all, nothing or partial.\n   * @param oldPath The original path in the case of a renamed file.\n   * @param conflictMarkers The number of conflict markers found in this file\n   */\n  public constructor(\n    path: string,\n    status: AppFileStatus,\n    public readonly selection: DiffSelection,\n    oldPath?: string,\n    public readonly conflictMarkers: number = 0\n  ) {\n    super(path, status, oldPath)\n  }\n\n  /** Create a new WorkingDirectoryFileChange with the given includedness. */\n  public withIncludeAll(include: boolean): WorkingDirectoryFileChange {\n    const newSelection = include\n      ? this.selection.withSelectAll()\n      : this.selection.withSelectNone()\n\n    return this.withSelection(newSelection)\n  }\n\n  /** Create a new WorkingDirectoryFileChange with the given diff selection. */\n  public withSelection(selection: DiffSelection): WorkingDirectoryFileChange {\n    return new WorkingDirectoryFileChange(\n      this.path,\n      this.status,\n      selection,\n      this.oldPath\n    )\n  }\n}\n\n/**\n * An object encapsulating the changes to a committed file.\n *\n * @param status A commit SHA or some other identifier that ultimately\n *               dereferences to a commit. This is the pointer to the\n *               'after' version of this change. I.e. the parent of this\n *               commit will contain the 'before' (or nothing, if the\n *               file change represents a new file).\n */\nexport class CommittedFileChange extends FileChange {\n  public constructor(\n    path: string,\n    status: AppFileStatus,\n    public readonly commitish: string,\n    oldPath?: string\n  ) {\n    super(path, status, oldPath)\n\n    this.commitish = commitish\n  }\n}\n\n/** the state of the working directory for a repository */\nexport class WorkingDirectoryStatus {\n  private readonly fileIxById = new Map<string, number>()\n\n  /** Create a new status with the given files. */\n  public static fromFiles(\n    files: ReadonlyArray<WorkingDirectoryFileChange>\n  ): WorkingDirectoryStatus {\n    return new WorkingDirectoryStatus(files, getIncludeAllState(files))\n  }\n\n  /**\n   * @param files The list of changes in the repository's working directory.\n   * @param includeAll Update the include checkbox state of the form.\n   *                   NOTE: we need to track this separately to the file list selection\n   *                         and perform two-way binding manually when this changes.\n   */\n  private constructor(\n    public readonly files: ReadonlyArray<WorkingDirectoryFileChange>,\n    public readonly includeAll: boolean | null = true\n  ) {\n    files.forEach((f, ix) => this.fileIxById.set(f.id, ix))\n  }\n\n  /**\n   * Update the include state of all files in the working directory\n   */\n  public withIncludeAllFiles(includeAll: boolean): WorkingDirectoryStatus {\n    const newFiles = this.files.map(f => f.withIncludeAll(includeAll))\n    return new WorkingDirectoryStatus(newFiles, includeAll)\n  }\n\n  /** Find the file with the given ID. */\n  public findFileWithID(id: string): WorkingDirectoryFileChange | null {\n    const ix = this.fileIxById.get(id)\n    return ix !== undefined ? this.files[ix] || null : null\n  }\n\n  /** Find the index of the file with the given ID. Returns -1 if not found */\n  public findFileIndexByID(id: string): number {\n    const ix = this.fileIxById.get(id)\n    return ix !== undefined ? ix : -1\n  }\n}\n\nfunction getIncludeAllState(\n  files: ReadonlyArray<WorkingDirectoryFileChange>\n): boolean | null {\n  if (!files.length) {\n    return true\n  }\n\n  const allSelected = files.every(\n    f => f.selection.getSelectionType() === DiffSelectionType.All\n  )\n  const noneSelected = files.every(\n    f => f.selection.getSelectionType() === DiffSelectionType.None\n  )\n\n  let includeAll: boolean | null = null\n  if (allSelected) {\n    includeAll = true\n  } else if (noneSelected) {\n    includeAll = false\n  }\n\n  return includeAll\n}\n","export * from './apply'\nexport * from './branch'\nexport * from './checkout'\nexport * from './clone'\nexport * from './commit'\nexport * from './config'\nexport * from './core'\nexport * from './description'\nexport * from './diff'\nexport * from './fetch'\nexport * from './for-each-ref'\nexport * from './index'\nexport * from './init'\nexport * from './log'\nexport * from './pull'\nexport * from './push'\nexport * from './reflog'\nexport * from './refs'\nexport * from './remote'\nexport * from './reset'\nexport * from './rev-list'\nexport * from './rev-parse'\nexport * from './status'\nexport * from './update-ref'\nexport * from './var'\nexport * from './merge'\nexport * from './diff-index'\nexport * from './checkout-index'\nexport * from './revert'\nexport * from './rm'\nexport * from './mergetool'\nexport * from './submodule'\nexport * from './interpret-trailers'\nexport * from './gitignore'\n","module.exports = require(\"electron\");","var fs = require('fs')\nvar polyfills = require('./polyfills.js')\nvar legacy = require('./legacy-streams.js')\nvar queue = []\n\nvar util = require('util')\n\nfunction noop () {}\n\nvar debug = noop\nif (util.debuglog)\n  debug = util.debuglog('gfs4')\nelse if (/\\bgfs4\\b/i.test(process.env.NODE_DEBUG || ''))\n  debug = function() {\n    var m = util.format.apply(util, arguments)\n    m = 'GFS4: ' + m.split(/\\n/).join('\\nGFS4: ')\n    console.error(m)\n  }\n\nif (/\\bgfs4\\b/i.test(process.env.NODE_DEBUG || '')) {\n  process.on('exit', function() {\n    debug(queue)\n    require('assert').equal(queue.length, 0)\n  })\n}\n\nmodule.exports = patch(require('./fs.js'))\nif (process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH) {\n  module.exports = patch(fs)\n}\n\n// Always patch fs.close/closeSync, because we want to\n// retry() whenever a close happens *anywhere* in the program.\n// This is essential when multiple graceful-fs instances are\n// in play at the same time.\nmodule.exports.close =\nfs.close = (function (fs$close) { return function (fd, cb) {\n  return fs$close.call(fs, fd, function (err) {\n    if (!err)\n      retry()\n\n    if (typeof cb === 'function')\n      cb.apply(this, arguments)\n  })\n}})(fs.close)\n\nmodule.exports.closeSync =\nfs.closeSync = (function (fs$closeSync) { return function (fd) {\n  // Note that graceful-fs also retries when fs.closeSync() fails.\n  // Looks like a bug to me, although it's probably a harmless one.\n  var rval = fs$closeSync.apply(fs, arguments)\n  retry()\n  return rval\n}})(fs.closeSync)\n\nfunction patch (fs) {\n  // Everything that references the open() function needs to be in here\n  polyfills(fs)\n  fs.gracefulify = patch\n  fs.FileReadStream = ReadStream;  // Legacy name.\n  fs.FileWriteStream = WriteStream;  // Legacy name.\n  fs.createReadStream = createReadStream\n  fs.createWriteStream = createWriteStream\n  var fs$readFile = fs.readFile\n  fs.readFile = readFile\n  function readFile (path, options, cb) {\n    if (typeof options === 'function')\n      cb = options, options = null\n\n    return go$readFile(path, options, cb)\n\n    function go$readFile (path, options, cb) {\n      return fs$readFile(path, options, function (err) {\n        if (err && (err.code === 'EMFILE' || err.code === 'ENFILE'))\n          enqueue([go$readFile, [path, options, cb]])\n        else {\n          if (typeof cb === 'function')\n            cb.apply(this, arguments)\n          retry()\n        }\n      })\n    }\n  }\n\n  var fs$writeFile = fs.writeFile\n  fs.writeFile = writeFile\n  function writeFile (path, data, options, cb) {\n    if (typeof options === 'function')\n      cb = options, options = null\n\n    return go$writeFile(path, data, options, cb)\n\n    function go$writeFile (path, data, options, cb) {\n      return fs$writeFile(path, data, options, function (err) {\n        if (err && (err.code === 'EMFILE' || err.code === 'ENFILE'))\n          enqueue([go$writeFile, [path, data, options, cb]])\n        else {\n          if (typeof cb === 'function')\n            cb.apply(this, arguments)\n          retry()\n        }\n      })\n    }\n  }\n\n  var fs$appendFile = fs.appendFile\n  if (fs$appendFile)\n    fs.appendFile = appendFile\n  function appendFile (path, data, options, cb) {\n    if (typeof options === 'function')\n      cb = options, options = null\n\n    return go$appendFile(path, data, options, cb)\n\n    function go$appendFile (path, data, options, cb) {\n      return fs$appendFile(path, data, options, function (err) {\n        if (err && (err.code === 'EMFILE' || err.code === 'ENFILE'))\n          enqueue([go$appendFile, [path, data, options, cb]])\n        else {\n          if (typeof cb === 'function')\n            cb.apply(this, arguments)\n          retry()\n        }\n      })\n    }\n  }\n\n  var fs$readdir = fs.readdir\n  fs.readdir = readdir\n  function readdir (path, options, cb) {\n    var args = [path]\n    if (typeof options !== 'function') {\n      args.push(options)\n    } else {\n      cb = options\n    }\n    args.push(go$readdir$cb)\n\n    return go$readdir(args)\n\n    function go$readdir$cb (err, files) {\n      if (files && files.sort)\n        files.sort()\n\n      if (err && (err.code === 'EMFILE' || err.code === 'ENFILE'))\n        enqueue([go$readdir, [args]])\n      else {\n        if (typeof cb === 'function')\n          cb.apply(this, arguments)\n        retry()\n      }\n    }\n  }\n\n  function go$readdir (args) {\n    return fs$readdir.apply(fs, args)\n  }\n\n  if (process.version.substr(0, 4) === 'v0.8') {\n    var legStreams = legacy(fs)\n    ReadStream = legStreams.ReadStream\n    WriteStream = legStreams.WriteStream\n  }\n\n  var fs$ReadStream = fs.ReadStream\n  ReadStream.prototype = Object.create(fs$ReadStream.prototype)\n  ReadStream.prototype.open = ReadStream$open\n\n  var fs$WriteStream = fs.WriteStream\n  WriteStream.prototype = Object.create(fs$WriteStream.prototype)\n  WriteStream.prototype.open = WriteStream$open\n\n  fs.ReadStream = ReadStream\n  fs.WriteStream = WriteStream\n\n  function ReadStream (path, options) {\n    if (this instanceof ReadStream)\n      return fs$ReadStream.apply(this, arguments), this\n    else\n      return ReadStream.apply(Object.create(ReadStream.prototype), arguments)\n  }\n\n  function ReadStream$open () {\n    var that = this\n    open(that.path, that.flags, that.mode, function (err, fd) {\n      if (err) {\n        if (that.autoClose)\n          that.destroy()\n\n        that.emit('error', err)\n      } else {\n        that.fd = fd\n        that.emit('open', fd)\n        that.read()\n      }\n    })\n  }\n\n  function WriteStream (path, options) {\n    if (this instanceof WriteStream)\n      return fs$WriteStream.apply(this, arguments), this\n    else\n      return WriteStream.apply(Object.create(WriteStream.prototype), arguments)\n  }\n\n  function WriteStream$open () {\n    var that = this\n    open(that.path, that.flags, that.mode, function (err, fd) {\n      if (err) {\n        that.destroy()\n        that.emit('error', err)\n      } else {\n        that.fd = fd\n        that.emit('open', fd)\n      }\n    })\n  }\n\n  function createReadStream (path, options) {\n    return new ReadStream(path, options)\n  }\n\n  function createWriteStream (path, options) {\n    return new WriteStream(path, options)\n  }\n\n  var fs$open = fs.open\n  fs.open = open\n  function open (path, flags, mode, cb) {\n    if (typeof mode === 'function')\n      cb = mode, mode = null\n\n    return go$open(path, flags, mode, cb)\n\n    function go$open (path, flags, mode, cb) {\n      return fs$open(path, flags, mode, function (err, fd) {\n        if (err && (err.code === 'EMFILE' || err.code === 'ENFILE'))\n          enqueue([go$open, [path, flags, mode, cb]])\n        else {\n          if (typeof cb === 'function')\n            cb.apply(this, arguments)\n          retry()\n        }\n      })\n    }\n  }\n\n  return fs\n}\n\nfunction enqueue (elem) {\n  debug('ENQUEUE', elem[0].name, elem[1])\n  queue.push(elem)\n}\n\nfunction retry () {\n  var elem = queue.shift()\n  if (elem) {\n    debug('RETRY', elem[0].name, elem[1])\n    elem[0].apply(null, elem[1])\n  }\n}\n","export * from './diff-data'\nexport * from './diff-line'\nexport * from './diff-selection'\nexport * from './image'\nexport * from './raw-diff'\n","import { ipcRenderer } from 'electron'\nimport { ExecutableMenuItem } from '../models/app-menu'\nimport { MenuIDs } from '../main-process/menu'\nimport { IMenuItemState } from '../lib/menu-update'\nimport { IMenuItem } from '../lib/menu-item'\n\n/** Set the menu item's enabledness. */\nexport function updateMenuState(\n  state: Array<{ id: MenuIDs; state: IMenuItemState }>\n) {\n  ipcRenderer.send('update-menu-state', state)\n}\n\n/** Tell the main process that the renderer is ready. */\nexport function sendReady(time: number) {\n  ipcRenderer.send('renderer-ready', time)\n}\n\n/** Tell the main process to execute (i.e. simulate a click of) the menu item. */\nexport function executeMenuItem(item: ExecutableMenuItem) {\n  ipcRenderer.send('execute-menu-item', { id: item.id })\n}\n\n/**\n * Show the OS-provided certificate trust dialog for the certificate, using the\n * given message.\n */\nexport function showCertificateTrustDialog(\n  certificate: Electron.Certificate,\n  message: string\n) {\n  ipcRenderer.send('show-certificate-trust-dialog', { certificate, message })\n}\n\n/**\n * Tell the main process that we're going to quit. This means it should allow\n * the window to close.\n *\n * This event is sent synchronously to avoid any races with subsequent calls\n * that would tell the app to quit.\n */\nexport function sendWillQuitSync() {\n  // eslint-disable-next-line no-sync\n  ipcRenderer.sendSync('will-quit')\n}\n\n/**\n * Ask the main-process to send over a copy of the application menu.\n * The response will be send as a separate event with the name 'app-menu' and\n * will be received by the dispatcher.\n */\nexport function getAppMenu() {\n  ipcRenderer.send('get-app-menu')\n}\n\n/**\n * There's currently no way for us to know when a contextual menu is closed (see\n * https://github.com/electron/electron/issues/9441). So we'll store the latest\n * contextual menu items we presented and assume any actions we receive are\n * coming from it.\n */\nlet currentContextualMenuItems: ReadonlyArray<IMenuItem> | null = null\n\n/**\n * Register a global handler for dispatching contextual menu actions. This\n * should be called only once, around app load time.\n */\nexport function registerContextualMenuActionDispatcher() {\n  ipcRenderer.on(\n    'contextual-menu-action',\n    (event: Electron.IpcMessageEvent, index: number) => {\n      if (!currentContextualMenuItems) {\n        return\n      }\n      if (index >= currentContextualMenuItems.length) {\n        return\n      }\n\n      const item = currentContextualMenuItems[index]\n      const action = item.action\n      if (action) {\n        action()\n        currentContextualMenuItems = null\n      }\n    }\n  )\n}\n\n/** Show the given menu items in a contextual menu. */\nexport function showContextualMenu(items: ReadonlyArray<IMenuItem>) {\n  currentContextualMenuItems = items\n  ipcRenderer.send('show-contextual-menu', items)\n}\n\n/** Update the menu item labels with the user's preferred apps. */\nexport function updatePreferredAppMenuItemLabels(labels: {\n  editor?: string\n  pullRequestLabel?: string\n  shell: string\n}) {\n  ipcRenderer.send('update-preferred-app-menu-item-labels', labels)\n}\n\nfunction getIpcFriendlyError(error: Error) {\n  return {\n    message: error.message || `${error}`,\n    name: error.name || `${error.name}`,\n    stack: error.stack || undefined,\n  }\n}\n\nexport function reportUncaughtException(error: Error) {\n  ipcRenderer.send('uncaught-exception', getIpcFriendlyError(error))\n}\n\nexport function sendErrorReport(\n  error: Error,\n  extra: { [key: string]: string } = {}\n) {\n  ipcRenderer.send('send-error-report', {\n    error: getIpcFriendlyError(error),\n    extra,\n  })\n}\n","var $Object = Object;\nmodule.exports = {\n  create:     $Object.create,\n  getProto:   $Object.getPrototypeOf,\n  isEnum:     {}.propertyIsEnumerable,\n  getDesc:    $Object.getOwnPropertyDescriptor,\n  setDesc:    $Object.defineProperty,\n  setDescs:   $Object.defineProperties,\n  getKeys:    $Object.keys,\n  getNames:   $Object.getOwnPropertyNames,\n  getSymbols: $Object.getOwnPropertySymbols,\n  each:       [].forEach\n};","'use strict'\n\nexports.fromCallback = function (fn) {\n  return Object.defineProperty(function () {\n    if (typeof arguments[arguments.length - 1] === 'function') fn.apply(this, arguments)\n    else {\n      return new Promise((resolve, reject) => {\n        arguments[arguments.length] = (err, res) => {\n          if (err) return reject(err)\n          resolve(res)\n        }\n        arguments.length++\n        fn.apply(this, arguments)\n      })\n    }\n  }, 'name', { value: fn.name })\n}\n\nexports.fromPromise = function (fn) {\n  return Object.defineProperty(function () {\n    const cb = arguments[arguments.length - 1]\n    if (typeof cb !== 'function') return fn.apply(this, arguments)\n    else fn.apply(this, arguments).then(r => cb(null, r), cb)\n  }, 'name', { value: fn.name })\n}\n","import { shell as electronShell, ipcRenderer } from 'electron'\nimport * as Path from 'path'\n\nimport { Repository } from '../models/repository'\n\nexport interface IAppShell {\n  readonly moveItemToTrash: (path: string) => boolean\n  readonly beep: () => void\n  readonly openExternal: (path: string) => Promise<boolean>\n  readonly openItem: (path: string) => boolean\n  readonly showItemInFolder: (path: string) => void\n}\n\nexport const shell: IAppShell = {\n  moveItemToTrash: electronShell.moveItemToTrash,\n  beep: electronShell.beep,\n  openExternal: path => {\n    return new Promise<boolean>((resolve, reject) => {\n      ipcRenderer.once(\n        'open-external-result',\n        (event: Electron.IpcMessageEvent, { result }: { result: boolean }) => {\n          resolve(result)\n        }\n      )\n\n      ipcRenderer.send('open-external', { path })\n    })\n  },\n  showItemInFolder: path => {\n    ipcRenderer.send('show-item-in-folder', { path })\n  },\n  openItem: electronShell.openItem,\n}\n\n/**\n * Reveals a file from a repository in the native file manager.\n *\n * @param repository The currently active repository instance\n * @param path The path of the file relative to the root of the repository\n */\nexport function revealInFileManager(repository: Repository, path: string) {\n  const fullyQualifiedFilePath = Path.join(repository.path, path)\n  return shell.showItemInFolder(fullyQualifiedFilePath)\n}\n","'use strict'\nconst u = require('universalify').fromCallback\nconst mkdirs = u(require('./mkdirs'))\nconst mkdirsSync = require('./mkdirs-sync')\n\nmodule.exports = {\n  mkdirs,\n  mkdirsSync,\n  // alias\n  mkdirp: mkdirs,\n  mkdirpSync: mkdirsSync,\n  ensureDir: mkdirs,\n  ensureDirSync: mkdirsSync\n}\n","import * as React from 'react'\n\n/**\n * A simple style component used to mark up arbitrary references such as\n * branches, commit SHAs, paths or other content which needs to be presented\n * in an emphasized way and that benefit from fixed-width fonts.\n *\n * While the styling of the component _may_ differs depending on what context\n * it appears in the general style is an inline-box with a suitable background\n * color, using a fixed-width font.\n */\nexport class Ref extends React.Component<{}, {}> {\n  public render() {\n    return <em className=\"ref-component\">{this.props.children}</em>\n  }\n}\n","import * as Path from 'path'\nimport fileUrl = require('file-url')\n\n/**\n * Resolve and encode the path information into a URL.\n *\n * @param pathSegments array of path segments to resolve\n */\nexport function encodePathAsUrl(...pathSegments: string[]): string {\n  const path = Path.resolve(...pathSegments)\n  return fileUrl(path)\n}\n","/**\n * Compares the two values given and returns a value indicating whether\n * one is greater than the other. When the return value is used in a sort\n * operation the comparands will be sorted in ascending order\n *\n * Used for simplifying custom comparison logic when sorting arrays\n * of complex types.\n *\n * The greater than/less than checks are implemented using standard\n * javascript comparison operators and will only provide a meaningful\n * sort value for types which javascript can compare natively. See\n *\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Comparison_Operators\n *\n * This method can be chained using `||` for more complex sorting\n * logic. Example:\n *\n * ```ts\n * arr.sort(\n *  (x, y) =>\n *    compare(x.firstName, y.firstName) || compare(x.lastName, y.lastName)\n * )\n * ```\n *\n */\nexport function compare<T>(x: T, y: T): number {\n  if (x < y) {\n    return -1\n  }\n  if (x > y) {\n    return 1\n  }\n\n  return 0\n}\n\n/**\n * Compares the two values given and returns a value indicating whether\n * one is greater than the other. When the return value is used in a sort\n * operation the comparands will be sorted in descending order\n *\n * Used for simplifying custom comparison logic when sorting arrays\n * of complex types.\n *\n * The greater than/less than checks are implemented using standard\n * javascript comparison operators and will only provide a meaningful\n * sort value for types which javascript can compare natively. See\n *\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Comparison_Operators\n *\n * This method can be chained using `||` for more complex sorting\n * logic. Ex\n *\n *  arr.sort((x, y) => compare(x.firstName, y.firstName) || compare(x.lastName, y.lastName))\n *\n */\nexport function compareDescending<T>(x: T, y: T): number {\n  if (x < y) {\n    return 1\n  }\n  if (x > y) {\n    return -1\n  }\n\n  return 0\n}\n\n/**\n * Compares the two strings in a case-insensitive manner and returns a value\n * indicating whether these are equal\n */\nexport function caseInsensitiveEquals(x: string, y: string): boolean {\n  return x.toLowerCase() === y.toLowerCase()\n}\n\n/**\n * Compares the two strings in a case-insensitive manner and returns a value\n * indicating whether one is greater than the other. When the return value is\n * used in a sort operation the comparands will be sorted in ascending order.\n */\nexport function caseInsensitiveCompare(x: string, y: string): number {\n  return compare(x.toLowerCase(), y.toLowerCase())\n}\n\n/**\n * Compares the two strings in a case-insensitive manner and returns a value\n * indicating whether one is greater than the other. When the return value is\n * used in a sort operation the comparands will be sorted in descending order.\n */\nexport function caseInsensitiveCompareDescending(x: string, y: string): number {\n  return compareDescending(x.toLowerCase(), y.toLowerCase())\n}\n","var core = module.exports = {version: '1.2.6'};\nif(typeof __e == 'number')__e = core; // eslint-disable-line no-undef","import { Branch } from './branch'\n\nexport enum TipState {\n  Unknown,\n  Unborn,\n  Detached,\n  Valid,\n}\n\nexport interface IUnknownRepository {\n  readonly kind: TipState.Unknown\n}\n\nexport interface IUnbornRepository {\n  readonly kind: TipState.Unborn\n\n  /**\n   * The symbolic reference that the unborn repository points to currently.\n   *\n   * Typically this will be \"master\" but a user can easily create orphaned\n   * branches externally.\n   */\n  readonly ref: string\n}\n\nexport interface IDetachedHead {\n  readonly kind: TipState.Detached\n  /**\n   * The commit identifier of the current tip of the repository.\n   */\n  readonly currentSha: string\n}\n\nexport interface IValidBranch {\n  readonly kind: TipState.Valid\n  /**\n   * The branch information associated with the current tip of the repository.\n   */\n  readonly branch: Branch\n}\n\nexport type Tip =\n  | IUnknownRepository\n  | IUnbornRepository\n  | IDetachedHead\n  | IValidBranch\n","'use strict';\n\nfunction checkDCE() {\n  /* global __REACT_DEVTOOLS_GLOBAL_HOOK__ */\n  if (\n    typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ === 'undefined' ||\n    typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE !== 'function'\n  ) {\n    return;\n  }\n  if (process.env.NODE_ENV !== 'production') {\n    // This branch is unreachable because this function is only called\n    // in production, but the condition is true only in development.\n    // Therefore if the branch is still here, dead code elimination wasn't\n    // properly applied.\n    // Don't change the message. React DevTools relies on it. Also make sure\n    // this message doesn't occur elsewhere in this function, or it will cause\n    // a false positive.\n    throw new Error('^_^');\n  }\n  try {\n    // Verify that the code above has been dead code eliminated (DCE'd).\n    __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE);\n  } catch (err) {\n    // DevTools shouldn't crash React, no matter what.\n    // We should still report in case we break this code.\n    console.error(err);\n  }\n}\n\nif (process.env.NODE_ENV === 'production') {\n  // DCE check should happen before ReactDOM bundle executes so that\n  // DevTools can report bad minification during injection.\n  checkDCE();\n  module.exports = require('./cjs/react-dom.production.min.js');\n} else {\n  module.exports = require('./cjs/react-dom.development.js');\n}\n","import * as Path from 'path'\n\nimport { GitHubRepository } from './github-repository'\nimport { IAheadBehind } from './branch'\n\nfunction getBaseName(path: string): string {\n  const baseName = Path.basename(path)\n\n  if (baseName.length === 0) {\n    // the repository is at the root of the drive\n    // -> show the full path here to show _something_\n    return path\n  }\n\n  return baseName\n}\n\n/** A local repository. */\nexport class Repository {\n  public readonly name: string\n\n  /**\n   * @param path The working directory of this repository\n   * @param missing Was the repository missing on disk last we checked?\n   */\n  public constructor(\n    public readonly path: string,\n    public readonly id: number,\n    public readonly gitHubRepository: GitHubRepository | null,\n    public readonly missing: boolean\n  ) {\n    this.name = (gitHubRepository && gitHubRepository.name) || getBaseName(path)\n  }\n\n  /**\n   * A hash of the properties of the object.\n   *\n   * Objects with the same hash are guaranteed to be structurally equal.\n   */\n  public get hash(): string {\n    return `${this.id}+\n      ${this.gitHubRepository && this.gitHubRepository.hash}+\n      ${this.path}+\n      ${this.missing}+\n      ${this.name}`\n  }\n}\n\n/**\n * A snapshot for the local state for a given repository\n */\nexport interface ILocalRepositoryState {\n  /**\n   * The ahead/behind count for the current branch, or `null` if no tracking\n   * branch found.\n   */\n  readonly aheadBehind: IAheadBehind | null\n  /**\n   * The number of uncommitted changes currently in the repository.\n   */\n  readonly changedFilesCount: number\n}\n\n/**\n * Returns the owner/name alias if associated with a GitHub repository,\n * otherwise the folder name that contains the repository\n */\nexport function nameOf(repository: Repository) {\n  const { gitHubRepository } = repository\n\n  return gitHubRepository !== null ? gitHubRepository.fullName : repository.name\n}\n","const Disable = false\n\n/**\n * Enables the application to opt-in for preview features based on runtime\n * checks. This is backed by the GITHUB_DESKTOP_PREVIEW_FEATURES environment\n * variable, which is checked for non-development environments.\n */\nfunction enableDevelopmentFeatures(): boolean {\n  if (Disable) {\n    return false\n  }\n\n  if (__DEV__) {\n    return true\n  }\n\n  if (process.env.GITHUB_DESKTOP_PREVIEW_FEATURES === '1') {\n    return true\n  }\n\n  return false\n}\n\n/** Should the app enable beta features? */\n//@ts-ignore: this will be used again in the future\nfunction enableBetaFeatures(): boolean {\n  return enableDevelopmentFeatures() || __RELEASE_CHANNEL__ === 'beta'\n}\n\n/** Should merge tool integration be enabled? */\nexport function enableMergeTool(): boolean {\n  return enableDevelopmentFeatures()\n}\n\n/** Should the Notification of Diverging From Default Branch (NDDB) feature be enabled? */\nexport function enableNotificationOfBranchUpdates(): boolean {\n  return true\n}\n\n/** Should the repository list display info indicators? */\nexport function enableRepoInfoIndicators(): boolean {\n  return true\n}\n\n/** Should the app try and detect conflicts before the user stumbles into them? */\nexport function enableMergeConflictDetection(): boolean {\n  return true\n}\n\n/** Should the app display the new release notes dialog? */\nexport function enableInAppReleaseNotes(): boolean {\n  return true\n}\n\n/** Should `git status` use --no-optional-locks to assist with concurrent usage */\nexport function enableStatusWithoutOptionalLocks(): boolean {\n  return enableBetaFeatures()\n}\n","'use strict'\nconst u = require('universalify').fromPromise\nconst fs = require('../fs')\n\nfunction pathExists (path) {\n  return fs.access(path).then(() => true).catch(() => false)\n}\n\nmodule.exports = {\n  pathExists: u(pathExists),\n  pathExistsSync: fs.existsSync\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar git_process_1 = require(\"./git-process\");\nexports.GitProcess = git_process_1.GitProcess;\nvar errors_1 = require(\"./errors\");\nexports.GitError = errors_1.GitError;\nexports.RepositoryDoesNotExistErrorCode = errors_1.RepositoryDoesNotExistErrorCode;\nexports.GitNotFoundErrorCode = errors_1.GitNotFoundErrorCode;\n//# sourceMappingURL=index.js.map","module.exports = require(\"child_process\");","\"use strict\";\n\nexports.__esModule = true;\n\nexports.default = function (obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n};","import { Emitter, Disposable } from 'event-kit'\n\nexport abstract class BaseStore {\n  protected readonly emitter = new Emitter()\n\n  protected emitUpdate() {\n    this.emitter.emit('did-update', {})\n  }\n\n  protected emitError(error: Error) {\n    this.emitter.emit('did-error', error)\n  }\n\n  /** Register a function to be called when the store updates. */\n  public onDidUpdate(fn: () => void): Disposable {\n    return this.emitter.on('did-update', fn)\n  }\n\n  /**\n   * Register an event handler which will be invoked whenever\n   * an unexpected error occurs during the sign-in process. Note\n   * that some error are handled in the flow and passed along in\n   * the sign in state for inline presentation to the user.\n   */\n  public onDidError(fn: (e: Error) => void): Disposable {\n    return this.emitter.on('did-error', fn)\n  }\n}\n\nexport class TypedBaseStore<T> {\n  protected readonly emitter = new Emitter()\n\n  protected emitUpdate(data: T) {\n    this.emitter.emit('did-update', data)\n  }\n\n  protected emitError(error: Error) {\n    this.emitter.emit('did-error', error)\n  }\n\n  /** Register a function to be called when the store updates. */\n  public onDidUpdate(fn: (data: T) => void): Disposable {\n    return this.emitter.on('did-update', fn)\n  }\n\n  /**\n   * Register an event handler which will be invoked whenever\n   * an unexpected error occurs during the sign-in process. Note\n   * that some error are handled in the flow and passed along in\n   * the sign in state for inline presentation to the user.\n   */\n  public onDidError(fn: (e: Error) => void): Disposable {\n    return this.emitter.on('did-error', fn)\n  }\n}\n","import * as React from 'react'\nimport * as classNames from 'classnames'\n\n/** The tab bar type. */\nexport enum TabBarType {\n  /** Standard tabs */\n  Tabs,\n\n  /** Simpler switch appearance */\n  Switch,\n}\n\ninterface ITabBarProps {\n  /** The currently selected tab. */\n  readonly selectedIndex: number\n\n  /** A function which is called when a tab is clicked on. */\n  readonly onTabClicked: (index: number) => void\n\n  /** The type of TabBar controlling its style */\n  readonly type?: TabBarType\n}\n\n/**\n * The tab bar component.\n *\n * Set `children` to an array of JSX.Elements to represent the tab bar items.\n */\nexport class TabBar extends React.Component<ITabBarProps, {}> {\n  private readonly tabRefsByIndex = new Map<number, HTMLButtonElement>()\n\n  public render() {\n    return (\n      <div\n        className={\n          'tab-bar ' +\n          (this.props.type === TabBarType.Switch ? 'switch' : 'tabs')\n        }\n        role=\"tablist\"\n      >\n        {this.renderItems()}\n      </div>\n    )\n  }\n\n  private onSelectAdjacentTab = (\n    direction: 'next' | 'previous',\n    index: number\n  ) => {\n    const children = this.props.children as ReadonlyArray<JSX.Element> | null\n\n    if (!children || !children.length) {\n      return\n    }\n\n    const delta = direction === 'next' ? 1 : -1\n\n    // http://javascript.about.com/od/problemsolving/a/modulobug.htm\n    const nextTabIndex = (index + delta + children.length) % children.length\n\n    const button = this.tabRefsByIndex.get(nextTabIndex)\n\n    if (button) {\n      button.focus()\n    }\n\n    this.props.onTabClicked(nextTabIndex)\n  }\n\n  private onTabClicked = (index: number) => {\n    this.props.onTabClicked(index)\n  }\n\n  private onTabRef = (index: number, ref: HTMLButtonElement | null) => {\n    if (!ref) {\n      this.tabRefsByIndex.delete(index)\n    } else {\n      this.tabRefsByIndex.set(index, ref)\n    }\n  }\n\n  private renderItems() {\n    const children = this.props.children as ReadonlyArray<JSX.Element> | null\n    if (!children) {\n      return null\n    }\n\n    return children.map((child, index) => {\n      const selected = index === this.props.selectedIndex\n      return (\n        <TabBarItem\n          key={index}\n          selected={selected}\n          index={index}\n          onClick={this.onTabClicked}\n          onSelectAdjacent={this.onSelectAdjacentTab}\n          onButtonRef={this.onTabRef}\n        >\n          {child}\n        </TabBarItem>\n      )\n    })\n  }\n}\n\ninterface ITabBarItemProps {\n  readonly index: number\n  readonly selected: boolean\n  readonly onClick: (index: number) => void\n  readonly onSelectAdjacent: (\n    direction: 'next' | 'previous',\n    index: number\n  ) => void\n  readonly onButtonRef: (\n    index: number,\n    button: HTMLButtonElement | null\n  ) => void\n}\n\nclass TabBarItem extends React.Component<ITabBarItemProps, {}> {\n  private onClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n    this.props.onClick(this.props.index)\n  }\n\n  private onKeyDown = (event: React.KeyboardEvent<HTMLButtonElement>) => {\n    if (event.key === 'ArrowLeft') {\n      this.props.onSelectAdjacent('previous', this.props.index)\n      event.preventDefault()\n    } else if (event.key === 'ArrowRight') {\n      this.props.onSelectAdjacent('next', this.props.index)\n      event.preventDefault()\n    }\n  }\n\n  private onButtonRef = (buttonRef: HTMLButtonElement | null) => {\n    this.props.onButtonRef(this.props.index, buttonRef)\n  }\n\n  public render() {\n    const selected = this.props.selected\n    const className = classNames('tab-bar-item', { selected })\n    return (\n      <button\n        ref={this.onButtonRef}\n        className={className}\n        onClick={this.onClick}\n        role=\"tab\"\n        aria-selected={selected}\n        tabIndex={selected ? 0 : -1}\n        onKeyDown={this.onKeyDown}\n        type=\"button\"\n      >\n        {this.props.children}\n      </button>\n    )\n  }\n}\n","import * as React from 'react'\nimport { createUniqueId, releaseUniqueId } from './id-pool'\n\n/** The possible values for a Checkbox component. */\nexport enum CheckboxValue {\n  On,\n  Off,\n  Mixed,\n}\n\ninterface ICheckboxProps {\n  /** Is the component disabled. */\n  readonly disabled?: boolean\n\n  /** The current value of the component. */\n  readonly value: CheckboxValue\n\n  /** The function to call on value change. */\n  readonly onChange?: (event: React.FormEvent<HTMLInputElement>) => void\n\n  /** The tab index of the input element. */\n  readonly tabIndex?: number\n\n  /** The label for the checkbox. */\n  readonly label?: string | JSX.Element\n}\n\ninterface ICheckboxState {\n  /**\n   * An automatically generated id for the input element used to reference\n   * it from the label element. This is generated once via the id pool when the\n   * component is mounted and then released once the component unmounts.\n   */\n  readonly inputId?: string\n}\n\n/** A checkbox component which supports the mixed value. */\nexport class Checkbox extends React.Component<ICheckboxProps, ICheckboxState> {\n  private input: HTMLInputElement | null = null\n\n  private onChange = (event: React.FormEvent<HTMLInputElement>) => {\n    if (this.props.onChange) {\n      this.props.onChange(event)\n    }\n  }\n\n  public componentDidUpdate() {\n    this.updateInputState()\n  }\n\n  public componentWillMount() {\n    const friendlyName = this.props.label || 'unknown'\n    const inputId = createUniqueId(`Checkbox_${friendlyName}`)\n\n    this.setState({ inputId })\n  }\n\n  public componentWillUnmount() {\n    if (this.state.inputId) {\n      releaseUniqueId(this.state.inputId)\n    }\n  }\n\n  private updateInputState() {\n    const input = this.input\n    if (input) {\n      const value = this.props.value\n      input.indeterminate = value === CheckboxValue.Mixed\n      input.checked = value !== CheckboxValue.Off\n    }\n  }\n\n  private onInputRef = (input: HTMLInputElement | null) => {\n    this.input = input\n    // Necessary since componentDidUpdate doesn't run on initial\n    // render\n    this.updateInputState()\n  }\n\n  private renderLabel() {\n    const label = this.props.label\n    const inputId = this.state.inputId\n\n    return label ? <label htmlFor={inputId}>{label}</label> : null\n  }\n\n  public render() {\n    return (\n      <div className=\"checkbox-component\">\n        <input\n          id={this.state.inputId}\n          tabIndex={this.props.tabIndex}\n          type=\"checkbox\"\n          onChange={this.onChange}\n          ref={this.onInputRef}\n          disabled={this.props.disabled}\n        />\n        {this.renderLabel()}\n      </div>\n    )\n  }\n}\n","import * as React from 'react';\nimport ScalingCellSizeAndPositionManager from './utils/ScalingCellSizeAndPositionManager';\n\nvar bpfrpt_proptype_CellPosition = process.env.NODE_ENV === 'production' ? null : {\n  columnIndex: PropTypes.number.isRequired,\n  rowIndex: PropTypes.number.isRequired\n};\nvar bpfrpt_proptype_CellRendererParams = process.env.NODE_ENV === 'production' ? null : {\n  columnIndex: PropTypes.number.isRequired,\n  isScrolling: PropTypes.bool.isRequired,\n  isVisible: PropTypes.bool.isRequired,\n  key: PropTypes.string.isRequired,\n  parent: PropTypes.object.isRequired,\n  rowIndex: PropTypes.number.isRequired,\n  style: PropTypes.object.isRequired\n};\nvar bpfrpt_proptype_CellRenderer = process.env.NODE_ENV === 'production' ? null : PropTypes.func;\nvar bpfrpt_proptype_CellCache = process.env.NODE_ENV === 'production' ? null : PropTypes.objectOf(PropTypes.node.isRequired);\nvar bpfrpt_proptype_StyleCache = process.env.NODE_ENV === 'production' ? null : PropTypes.objectOf(PropTypes.object.isRequired);\nvar bpfrpt_proptype_CellRangeRendererParams = process.env.NODE_ENV === 'production' ? null : {\n  cellCache: PropTypes.objectOf(PropTypes.node.isRequired).isRequired,\n  cellRenderer: PropTypes.func.isRequired,\n  columnSizeAndPositionManager: function columnSizeAndPositionManager() {\n    return (typeof ScalingCellSizeAndPositionManager === 'function' ? PropTypes.instanceOf(ScalingCellSizeAndPositionManager).isRequired : PropTypes.any.isRequired).apply(this, arguments);\n  },\n  columnStartIndex: PropTypes.number.isRequired,\n  columnStopIndex: PropTypes.number.isRequired,\n  deferredMeasurementCache: PropTypes.object,\n  horizontalOffsetAdjustment: PropTypes.number.isRequired,\n  isScrolling: PropTypes.bool.isRequired,\n  isScrollingOptOut: PropTypes.bool.isRequired,\n  parent: PropTypes.object.isRequired,\n  rowSizeAndPositionManager: function rowSizeAndPositionManager() {\n    return (typeof ScalingCellSizeAndPositionManager === 'function' ? PropTypes.instanceOf(ScalingCellSizeAndPositionManager).isRequired : PropTypes.any.isRequired).apply(this, arguments);\n  },\n  rowStartIndex: PropTypes.number.isRequired,\n  rowStopIndex: PropTypes.number.isRequired,\n  scrollLeft: PropTypes.number.isRequired,\n  scrollTop: PropTypes.number.isRequired,\n  styleCache: PropTypes.objectOf(PropTypes.object.isRequired).isRequired,\n  verticalOffsetAdjustment: PropTypes.number.isRequired,\n  visibleColumnIndices: PropTypes.object.isRequired,\n  visibleRowIndices: PropTypes.object.isRequired\n};\nvar bpfrpt_proptype_CellRangeRenderer = process.env.NODE_ENV === 'production' ? null : PropTypes.func;\nvar bpfrpt_proptype_CellSizeGetter = process.env.NODE_ENV === 'production' ? null : PropTypes.func;\nvar bpfrpt_proptype_CellSize = process.env.NODE_ENV === 'production' ? null : PropTypes.oneOfType([PropTypes.func, PropTypes.number]);\nvar bpfrpt_proptype_NoContentRenderer = process.env.NODE_ENV === 'production' ? null : PropTypes.func;\nvar bpfrpt_proptype_Scroll = process.env.NODE_ENV === 'production' ? null : {\n  clientHeight: PropTypes.number.isRequired,\n  clientWidth: PropTypes.number.isRequired,\n  scrollHeight: PropTypes.number.isRequired,\n  scrollLeft: PropTypes.number.isRequired,\n  scrollTop: PropTypes.number.isRequired,\n  scrollWidth: PropTypes.number.isRequired\n};\nvar bpfrpt_proptype_ScrollbarPresenceChange = process.env.NODE_ENV === 'production' ? null : {\n  horizontal: PropTypes.bool.isRequired,\n  vertical: PropTypes.bool.isRequired,\n  size: PropTypes.number.isRequired\n};\nvar bpfrpt_proptype_RenderedSection = process.env.NODE_ENV === 'production' ? null : {\n  columnOverscanStartIndex: PropTypes.number.isRequired,\n  columnOverscanStopIndex: PropTypes.number.isRequired,\n  columnStartIndex: PropTypes.number.isRequired,\n  columnStopIndex: PropTypes.number.isRequired,\n  rowOverscanStartIndex: PropTypes.number.isRequired,\n  rowOverscanStopIndex: PropTypes.number.isRequired,\n  rowStartIndex: PropTypes.number.isRequired,\n  rowStopIndex: PropTypes.number.isRequired\n};\nvar bpfrpt_proptype_OverscanIndicesGetterParams = process.env.NODE_ENV === 'production' ? null : {\n  // One of SCROLL_DIRECTION_HORIZONTAL or SCROLL_DIRECTION_VERTICAL\n  direction: PropTypes.oneOf(['horizontal', 'vertical']).isRequired,\n\n\n  // One of SCROLL_DIRECTION_BACKWARD or SCROLL_DIRECTION_FORWARD\n  scrollDirection: PropTypes.oneOf([-1, 1]).isRequired,\n\n\n  // Number of rows or columns in the current axis\n  cellCount: PropTypes.number.isRequired,\n\n\n  // Maximum number of cells to over-render in either direction\n  overscanCellsCount: PropTypes.number.isRequired,\n\n\n  // Begin of range of visible cells\n  startIndex: PropTypes.number.isRequired,\n\n\n  // End of range of visible cells\n  stopIndex: PropTypes.number.isRequired\n};\nvar bpfrpt_proptype_OverscanIndices = process.env.NODE_ENV === 'production' ? null : {\n  overscanStartIndex: PropTypes.number.isRequired,\n  overscanStopIndex: PropTypes.number.isRequired\n};\nvar bpfrpt_proptype_OverscanIndicesGetter = process.env.NODE_ENV === 'production' ? null : PropTypes.func;\nvar bpfrpt_proptype_Alignment = process.env.NODE_ENV === 'production' ? null : PropTypes.oneOf(['auto', 'end', 'start', 'center']);\nvar bpfrpt_proptype_VisibleCellRange = process.env.NODE_ENV === 'production' ? null : {\n  start: PropTypes.number,\n  stop: PropTypes.number\n};\nimport PropTypes from 'prop-types';\nexport { bpfrpt_proptype_CellPosition };\nexport { bpfrpt_proptype_CellRendererParams };\nexport { bpfrpt_proptype_CellRenderer };\nexport { bpfrpt_proptype_CellCache };\nexport { bpfrpt_proptype_StyleCache };\nexport { bpfrpt_proptype_CellRangeRendererParams };\nexport { bpfrpt_proptype_CellRangeRenderer };\nexport { bpfrpt_proptype_CellSizeGetter };\nexport { bpfrpt_proptype_CellSize };\nexport { bpfrpt_proptype_NoContentRenderer };\nexport { bpfrpt_proptype_Scroll };\nexport { bpfrpt_proptype_ScrollbarPresenceChange };\nexport { bpfrpt_proptype_RenderedSection };\nexport { bpfrpt_proptype_OverscanIndicesGetterParams };\nexport { bpfrpt_proptype_OverscanIndices };\nexport { bpfrpt_proptype_OverscanIndicesGetter };\nexport { bpfrpt_proptype_Alignment };\nexport { bpfrpt_proptype_VisibleCellRange };","var store  = require('./$.shared')('wks')\n  , uid    = require('./$.uid')\n  , Symbol = require('./$.global').Symbol;\nmodule.exports = function(name){\n  return store[name] || (store[name] =\n    Symbol && Symbol[name] || (Symbol || uid)('Symbol.' + name));\n};","import * as Path from 'path'\n\nimport { GitError as DugiteError } from 'dugite'\n\n/**\n * An account which can be used to potentially authenticate with a git server.\n */\nexport interface IGitAccount {\n  /** The login/username to authenticate with. */\n  readonly login: string\n\n  /** The endpoint with which the user is authenticating. */\n  readonly endpoint: string\n}\n\n/** Get the environment for authenticating remote operations. */\nexport function envForAuthentication(auth: IGitAccount | null): Object {\n  const env = {\n    DESKTOP_PATH: process.execPath,\n    DESKTOP_ASKPASS_SCRIPT: getAskPassScriptPath(),\n    GIT_ASKPASS: getAskPassTrampolinePath(),\n    // supported since Git 2.3, this is used to ensure we never interactively prompt\n    // for credentials - even as a fallback\n    GIT_TERMINAL_PROMPT: '0',\n    GIT_TRACE: localStorage.getItem('git-trace') || '0',\n  }\n\n  if (!auth) {\n    return env\n  }\n\n  return {\n    ...env,\n    DESKTOP_USERNAME: auth.login,\n    DESKTOP_ENDPOINT: auth.endpoint,\n  }\n}\n\n/** The set of errors which fit under the \"authentication failed\" umbrella. */\nexport const AuthenticationErrors: ReadonlySet<DugiteError> = new Set([\n  DugiteError.HTTPSAuthenticationFailed,\n  DugiteError.SSHAuthenticationFailed,\n  DugiteError.HTTPSRepositoryNotFound,\n  DugiteError.SSHRepositoryNotFound,\n])\n\nfunction getAskPassTrampolinePath(): string {\n  const extension = __WIN32__ ? 'bat' : 'sh'\n  return Path.resolve(__dirname, 'static', `ask-pass-trampoline.${extension}`)\n}\n\nfunction getAskPassScriptPath(): string {\n  return Path.resolve(__dirname, 'ask-pass.js')\n}\n","export * from './accounts-store'\nexport * from './app-store'\nexport * from './cloning-repositories-store'\nexport * from './git-store'\nexport * from './github-user-store'\nexport * from './issues-store'\nexport * from './repositories-store'\nexport * from './sign-in-store'\nexport * from './token-store'\nexport * from './pull-request-store'\nexport { UpstreamRemoteName } from './helpers/find-upstream-remote'\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n// This is CodeMirror (http://codemirror.net), a code editor\n// implemented in JavaScript on top of the browser's DOM.\n//\n// You can find some technical background for some of the code below\n// at http://marijnhaverbeke.nl/blog/#cm-internals .\n\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.CodeMirror = factory());\n}(this, (function () { 'use strict';\n\n// Kludges for bugs and behavior differences that can't be feature\n// detected are enabled based on userAgent etc sniffing.\nvar userAgent = navigator.userAgent;\nvar platform = navigator.platform;\n\nvar gecko = /gecko\\/\\d/i.test(userAgent);\nvar ie_upto10 = /MSIE \\d/.test(userAgent);\nvar ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(userAgent);\nvar edge = /Edge\\/(\\d+)/.exec(userAgent);\nvar ie = ie_upto10 || ie_11up || edge;\nvar ie_version = ie && (ie_upto10 ? document.documentMode || 6 : +(edge || ie_11up)[1]);\nvar webkit = !edge && /WebKit\\//.test(userAgent);\nvar qtwebkit = webkit && /Qt\\/\\d+\\.\\d+/.test(userAgent);\nvar chrome = !edge && /Chrome\\//.test(userAgent);\nvar presto = /Opera\\//.test(userAgent);\nvar safari = /Apple Computer/.test(navigator.vendor);\nvar mac_geMountainLion = /Mac OS X 1\\d\\D([8-9]|\\d\\d)\\D/.test(userAgent);\nvar phantom = /PhantomJS/.test(userAgent);\n\nvar ios = !edge && /AppleWebKit/.test(userAgent) && /Mobile\\/\\w+/.test(userAgent);\nvar android = /Android/.test(userAgent);\n// This is woefully incomplete. Suggestions for alternative methods welcome.\nvar mobile = ios || android || /webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(userAgent);\nvar mac = ios || /Mac/.test(platform);\nvar chromeOS = /\\bCrOS\\b/.test(userAgent);\nvar windows = /win/i.test(platform);\n\nvar presto_version = presto && userAgent.match(/Version\\/(\\d*\\.\\d*)/);\nif (presto_version) { presto_version = Number(presto_version[1]); }\nif (presto_version && presto_version >= 15) { presto = false; webkit = true; }\n// Some browsers use the wrong event properties to signal cmd/ctrl on OS X\nvar flipCtrlCmd = mac && (qtwebkit || presto && (presto_version == null || presto_version < 12.11));\nvar captureRightClick = gecko || (ie && ie_version >= 9);\n\nfunction classTest(cls) { return new RegExp(\"(^|\\\\s)\" + cls + \"(?:$|\\\\s)\\\\s*\") }\n\nvar rmClass = function(node, cls) {\n  var current = node.className;\n  var match = classTest(cls).exec(current);\n  if (match) {\n    var after = current.slice(match.index + match[0].length);\n    node.className = current.slice(0, match.index) + (after ? match[1] + after : \"\");\n  }\n};\n\nfunction removeChildren(e) {\n  for (var count = e.childNodes.length; count > 0; --count)\n    { e.removeChild(e.firstChild); }\n  return e\n}\n\nfunction removeChildrenAndAdd(parent, e) {\n  return removeChildren(parent).appendChild(e)\n}\n\nfunction elt(tag, content, className, style) {\n  var e = document.createElement(tag);\n  if (className) { e.className = className; }\n  if (style) { e.style.cssText = style; }\n  if (typeof content == \"string\") { e.appendChild(document.createTextNode(content)); }\n  else if (content) { for (var i = 0; i < content.length; ++i) { e.appendChild(content[i]); } }\n  return e\n}\n// wrapper for elt, which removes the elt from the accessibility tree\nfunction eltP(tag, content, className, style) {\n  var e = elt(tag, content, className, style);\n  e.setAttribute(\"role\", \"presentation\");\n  return e\n}\n\nvar range;\nif (document.createRange) { range = function(node, start, end, endNode) {\n  var r = document.createRange();\n  r.setEnd(endNode || node, end);\n  r.setStart(node, start);\n  return r\n}; }\nelse { range = function(node, start, end) {\n  var r = document.body.createTextRange();\n  try { r.moveToElementText(node.parentNode); }\n  catch(e) { return r }\n  r.collapse(true);\n  r.moveEnd(\"character\", end);\n  r.moveStart(\"character\", start);\n  return r\n}; }\n\nfunction contains(parent, child) {\n  if (child.nodeType == 3) // Android browser always returns false when child is a textnode\n    { child = child.parentNode; }\n  if (parent.contains)\n    { return parent.contains(child) }\n  do {\n    if (child.nodeType == 11) { child = child.host; }\n    if (child == parent) { return true }\n  } while (child = child.parentNode)\n}\n\nfunction activeElt() {\n  // IE and Edge may throw an \"Unspecified Error\" when accessing document.activeElement.\n  // IE < 10 will throw when accessed while the page is loading or in an iframe.\n  // IE > 9 and Edge will throw when accessed in an iframe if document.body is unavailable.\n  var activeElement;\n  try {\n    activeElement = document.activeElement;\n  } catch(e) {\n    activeElement = document.body || null;\n  }\n  while (activeElement && activeElement.shadowRoot && activeElement.shadowRoot.activeElement)\n    { activeElement = activeElement.shadowRoot.activeElement; }\n  return activeElement\n}\n\nfunction addClass(node, cls) {\n  var current = node.className;\n  if (!classTest(cls).test(current)) { node.className += (current ? \" \" : \"\") + cls; }\n}\nfunction joinClasses(a, b) {\n  var as = a.split(\" \");\n  for (var i = 0; i < as.length; i++)\n    { if (as[i] && !classTest(as[i]).test(b)) { b += \" \" + as[i]; } }\n  return b\n}\n\nvar selectInput = function(node) { node.select(); };\nif (ios) // Mobile Safari apparently has a bug where select() is broken.\n  { selectInput = function(node) { node.selectionStart = 0; node.selectionEnd = node.value.length; }; }\nelse if (ie) // Suppress mysterious IE10 errors\n  { selectInput = function(node) { try { node.select(); } catch(_e) {} }; }\n\nfunction bind(f) {\n  var args = Array.prototype.slice.call(arguments, 1);\n  return function(){return f.apply(null, args)}\n}\n\nfunction copyObj(obj, target, overwrite) {\n  if (!target) { target = {}; }\n  for (var prop in obj)\n    { if (obj.hasOwnProperty(prop) && (overwrite !== false || !target.hasOwnProperty(prop)))\n      { target[prop] = obj[prop]; } }\n  return target\n}\n\n// Counts the column offset in a string, taking tabs into account.\n// Used mostly to find indentation.\nfunction countColumn(string, end, tabSize, startIndex, startValue) {\n  if (end == null) {\n    end = string.search(/[^\\s\\u00a0]/);\n    if (end == -1) { end = string.length; }\n  }\n  for (var i = startIndex || 0, n = startValue || 0;;) {\n    var nextTab = string.indexOf(\"\\t\", i);\n    if (nextTab < 0 || nextTab >= end)\n      { return n + (end - i) }\n    n += nextTab - i;\n    n += tabSize - (n % tabSize);\n    i = nextTab + 1;\n  }\n}\n\nvar Delayed = function() {this.id = null;};\nDelayed.prototype.set = function (ms, f) {\n  clearTimeout(this.id);\n  this.id = setTimeout(f, ms);\n};\n\nfunction indexOf(array, elt) {\n  for (var i = 0; i < array.length; ++i)\n    { if (array[i] == elt) { return i } }\n  return -1\n}\n\n// Number of pixels added to scroller and sizer to hide scrollbar\nvar scrollerGap = 30;\n\n// Returned or thrown by various protocols to signal 'I'm not\n// handling this'.\nvar Pass = {toString: function(){return \"CodeMirror.Pass\"}};\n\n// Reused option objects for setSelection & friends\nvar sel_dontScroll = {scroll: false};\nvar sel_mouse = {origin: \"*mouse\"};\nvar sel_move = {origin: \"+move\"};\n\n// The inverse of countColumn -- find the offset that corresponds to\n// a particular column.\nfunction findColumn(string, goal, tabSize) {\n  for (var pos = 0, col = 0;;) {\n    var nextTab = string.indexOf(\"\\t\", pos);\n    if (nextTab == -1) { nextTab = string.length; }\n    var skipped = nextTab - pos;\n    if (nextTab == string.length || col + skipped >= goal)\n      { return pos + Math.min(skipped, goal - col) }\n    col += nextTab - pos;\n    col += tabSize - (col % tabSize);\n    pos = nextTab + 1;\n    if (col >= goal) { return pos }\n  }\n}\n\nvar spaceStrs = [\"\"];\nfunction spaceStr(n) {\n  while (spaceStrs.length <= n)\n    { spaceStrs.push(lst(spaceStrs) + \" \"); }\n  return spaceStrs[n]\n}\n\nfunction lst(arr) { return arr[arr.length-1] }\n\nfunction map(array, f) {\n  var out = [];\n  for (var i = 0; i < array.length; i++) { out[i] = f(array[i], i); }\n  return out\n}\n\nfunction insertSorted(array, value, score) {\n  var pos = 0, priority = score(value);\n  while (pos < array.length && score(array[pos]) <= priority) { pos++; }\n  array.splice(pos, 0, value);\n}\n\nfunction nothing() {}\n\nfunction createObj(base, props) {\n  var inst;\n  if (Object.create) {\n    inst = Object.create(base);\n  } else {\n    nothing.prototype = base;\n    inst = new nothing();\n  }\n  if (props) { copyObj(props, inst); }\n  return inst\n}\n\nvar nonASCIISingleCaseWordChar = /[\\u00df\\u0587\\u0590-\\u05f4\\u0600-\\u06ff\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/;\nfunction isWordCharBasic(ch) {\n  return /\\w/.test(ch) || ch > \"\\x80\" &&\n    (ch.toUpperCase() != ch.toLowerCase() || nonASCIISingleCaseWordChar.test(ch))\n}\nfunction isWordChar(ch, helper) {\n  if (!helper) { return isWordCharBasic(ch) }\n  if (helper.source.indexOf(\"\\\\w\") > -1 && isWordCharBasic(ch)) { return true }\n  return helper.test(ch)\n}\n\nfunction isEmpty(obj) {\n  for (var n in obj) { if (obj.hasOwnProperty(n) && obj[n]) { return false } }\n  return true\n}\n\n// Extending unicode characters. A series of a non-extending char +\n// any number of extending chars is treated as a single unit as far\n// as editing and measuring is concerned. This is not fully correct,\n// since some scripts/fonts/browsers also treat other configurations\n// of code points as a group.\nvar extendingChars = /[\\u0300-\\u036f\\u0483-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u065e\\u0670\\u06d6-\\u06dc\\u06de-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0900-\\u0902\\u093c\\u0941-\\u0948\\u094d\\u0951-\\u0955\\u0962\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2\\u09e3\\u0a01\\u0a02\\u0a3c\\u0a41\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70\\u0a71\\u0a75\\u0a81\\u0a82\\u0abc\\u0ac1-\\u0ac5\\u0ac7\\u0ac8\\u0acd\\u0ae2\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57\\u0b62\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc\\u0ccd\\u0cd5\\u0cd6\\u0ce2\\u0ce3\\u0d3e\\u0d41-\\u0d44\\u0d4d\\u0d57\\u0d62\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9\\u0ebb\\u0ebc\\u0ec8-\\u0ecd\\u0f18\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86\\u0f87\\u0f90-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039\\u103a\\u103d\\u103e\\u1058\\u1059\\u105e-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108d\\u109d\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193b\\u1a17\\u1a18\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1b00-\\u1b03\\u1b34\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80\\u1b81\\u1ba2-\\u1ba5\\u1ba8\\u1ba9\\u1c2c-\\u1c33\\u1c36\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1dc0-\\u1de6\\u1dfd-\\u1dff\\u200c\\u200d\\u20d0-\\u20f0\\u2cef-\\u2cf1\\u2de0-\\u2dff\\u302a-\\u302f\\u3099\\u309a\\ua66f-\\ua672\\ua67c\\ua67d\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua825\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc\\uaa29-\\uaa2e\\uaa31\\uaa32\\uaa35\\uaa36\\uaa43\\uaa4c\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uabe5\\uabe8\\uabed\\udc00-\\udfff\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe26\\uff9e\\uff9f]/;\nfunction isExtendingChar(ch) { return ch.charCodeAt(0) >= 768 && extendingChars.test(ch) }\n\n// Returns a number from the range [`0`; `str.length`] unless `pos` is outside that range.\nfunction skipExtendingChars(str, pos, dir) {\n  while ((dir < 0 ? pos > 0 : pos < str.length) && isExtendingChar(str.charAt(pos))) { pos += dir; }\n  return pos\n}\n\n// Returns the value from the range [`from`; `to`] that satisfies\n// `pred` and is closest to `from`. Assumes that at least `to`\n// satisfies `pred`. Supports `from` being greater than `to`.\nfunction findFirst(pred, from, to) {\n  // At any point we are certain `to` satisfies `pred`, don't know\n  // whether `from` does.\n  var dir = from > to ? -1 : 1;\n  for (;;) {\n    if (from == to) { return from }\n    var midF = (from + to) / 2, mid = dir < 0 ? Math.ceil(midF) : Math.floor(midF);\n    if (mid == from) { return pred(mid) ? from : to }\n    if (pred(mid)) { to = mid; }\n    else { from = mid + dir; }\n  }\n}\n\n// The display handles the DOM integration, both for input reading\n// and content drawing. It holds references to DOM nodes and\n// display-related state.\n\nfunction Display(place, doc, input) {\n  var d = this;\n  this.input = input;\n\n  // Covers bottom-right square when both scrollbars are present.\n  d.scrollbarFiller = elt(\"div\", null, \"CodeMirror-scrollbar-filler\");\n  d.scrollbarFiller.setAttribute(\"cm-not-content\", \"true\");\n  // Covers bottom of gutter when coverGutterNextToScrollbar is on\n  // and h scrollbar is present.\n  d.gutterFiller = elt(\"div\", null, \"CodeMirror-gutter-filler\");\n  d.gutterFiller.setAttribute(\"cm-not-content\", \"true\");\n  // Will contain the actual code, positioned to cover the viewport.\n  d.lineDiv = eltP(\"div\", null, \"CodeMirror-code\");\n  // Elements are added to these to represent selection and cursors.\n  d.selectionDiv = elt(\"div\", null, null, \"position: relative; z-index: 1\");\n  d.cursorDiv = elt(\"div\", null, \"CodeMirror-cursors\");\n  // A visibility: hidden element used to find the size of things.\n  d.measure = elt(\"div\", null, \"CodeMirror-measure\");\n  // When lines outside of the viewport are measured, they are drawn in this.\n  d.lineMeasure = elt(\"div\", null, \"CodeMirror-measure\");\n  // Wraps everything that needs to exist inside the vertically-padded coordinate system\n  d.lineSpace = eltP(\"div\", [d.measure, d.lineMeasure, d.selectionDiv, d.cursorDiv, d.lineDiv],\n                    null, \"position: relative; outline: none\");\n  var lines = eltP(\"div\", [d.lineSpace], \"CodeMirror-lines\");\n  // Moved around its parent to cover visible view.\n  d.mover = elt(\"div\", [lines], null, \"position: relative\");\n  // Set to the height of the document, allowing scrolling.\n  d.sizer = elt(\"div\", [d.mover], \"CodeMirror-sizer\");\n  d.sizerWidth = null;\n  // Behavior of elts with overflow: auto and padding is\n  // inconsistent across browsers. This is used to ensure the\n  // scrollable area is big enough.\n  d.heightForcer = elt(\"div\", null, null, \"position: absolute; height: \" + scrollerGap + \"px; width: 1px;\");\n  // Will contain the gutters, if any.\n  d.gutters = elt(\"div\", null, \"CodeMirror-gutters\");\n  d.lineGutter = null;\n  // Actual scrollable element.\n  d.scroller = elt(\"div\", [d.sizer, d.heightForcer, d.gutters], \"CodeMirror-scroll\");\n  d.scroller.setAttribute(\"tabIndex\", \"-1\");\n  // The element in which the editor lives.\n  d.wrapper = elt(\"div\", [d.scrollbarFiller, d.gutterFiller, d.scroller], \"CodeMirror\");\n\n  // Work around IE7 z-index bug (not perfect, hence IE7 not really being supported)\n  if (ie && ie_version < 8) { d.gutters.style.zIndex = -1; d.scroller.style.paddingRight = 0; }\n  if (!webkit && !(gecko && mobile)) { d.scroller.draggable = true; }\n\n  if (place) {\n    if (place.appendChild) { place.appendChild(d.wrapper); }\n    else { place(d.wrapper); }\n  }\n\n  // Current rendered range (may be bigger than the view window).\n  d.viewFrom = d.viewTo = doc.first;\n  d.reportedViewFrom = d.reportedViewTo = doc.first;\n  // Information about the rendered lines.\n  d.view = [];\n  d.renderedView = null;\n  // Holds info about a single rendered line when it was rendered\n  // for measurement, while not in view.\n  d.externalMeasured = null;\n  // Empty space (in pixels) above the view\n  d.viewOffset = 0;\n  d.lastWrapHeight = d.lastWrapWidth = 0;\n  d.updateLineNumbers = null;\n\n  d.nativeBarWidth = d.barHeight = d.barWidth = 0;\n  d.scrollbarsClipped = false;\n\n  // Used to only resize the line number gutter when necessary (when\n  // the amount of lines crosses a boundary that makes its width change)\n  d.lineNumWidth = d.lineNumInnerWidth = d.lineNumChars = null;\n  // Set to true when a non-horizontal-scrolling line widget is\n  // added. As an optimization, line widget aligning is skipped when\n  // this is false.\n  d.alignWidgets = false;\n\n  d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n\n  // Tracks the maximum line length so that the horizontal scrollbar\n  // can be kept static when scrolling.\n  d.maxLine = null;\n  d.maxLineLength = 0;\n  d.maxLineChanged = false;\n\n  // Used for measuring wheel scrolling granularity\n  d.wheelDX = d.wheelDY = d.wheelStartX = d.wheelStartY = null;\n\n  // True when shift is held down.\n  d.shift = false;\n\n  // Used to track whether anything happened since the context menu\n  // was opened.\n  d.selForContextMenu = null;\n\n  d.activeTouch = null;\n\n  input.init(d);\n}\n\n// Find the line object corresponding to the given line number.\nfunction getLine(doc, n) {\n  n -= doc.first;\n  if (n < 0 || n >= doc.size) { throw new Error(\"There is no line \" + (n + doc.first) + \" in the document.\") }\n  var chunk = doc;\n  while (!chunk.lines) {\n    for (var i = 0;; ++i) {\n      var child = chunk.children[i], sz = child.chunkSize();\n      if (n < sz) { chunk = child; break }\n      n -= sz;\n    }\n  }\n  return chunk.lines[n]\n}\n\n// Get the part of a document between two positions, as an array of\n// strings.\nfunction getBetween(doc, start, end) {\n  var out = [], n = start.line;\n  doc.iter(start.line, end.line + 1, function (line) {\n    var text = line.text;\n    if (n == end.line) { text = text.slice(0, end.ch); }\n    if (n == start.line) { text = text.slice(start.ch); }\n    out.push(text);\n    ++n;\n  });\n  return out\n}\n// Get the lines between from and to, as array of strings.\nfunction getLines(doc, from, to) {\n  var out = [];\n  doc.iter(from, to, function (line) { out.push(line.text); }); // iter aborts when callback returns truthy value\n  return out\n}\n\n// Update the height of a line, propagating the height change\n// upwards to parent nodes.\nfunction updateLineHeight(line, height) {\n  var diff = height - line.height;\n  if (diff) { for (var n = line; n; n = n.parent) { n.height += diff; } }\n}\n\n// Given a line object, find its line number by walking up through\n// its parent links.\nfunction lineNo(line) {\n  if (line.parent == null) { return null }\n  var cur = line.parent, no = indexOf(cur.lines, line);\n  for (var chunk = cur.parent; chunk; cur = chunk, chunk = chunk.parent) {\n    for (var i = 0;; ++i) {\n      if (chunk.children[i] == cur) { break }\n      no += chunk.children[i].chunkSize();\n    }\n  }\n  return no + cur.first\n}\n\n// Find the line at the given vertical position, using the height\n// information in the document tree.\nfunction lineAtHeight(chunk, h) {\n  var n = chunk.first;\n  outer: do {\n    for (var i$1 = 0; i$1 < chunk.children.length; ++i$1) {\n      var child = chunk.children[i$1], ch = child.height;\n      if (h < ch) { chunk = child; continue outer }\n      h -= ch;\n      n += child.chunkSize();\n    }\n    return n\n  } while (!chunk.lines)\n  var i = 0;\n  for (; i < chunk.lines.length; ++i) {\n    var line = chunk.lines[i], lh = line.height;\n    if (h < lh) { break }\n    h -= lh;\n  }\n  return n + i\n}\n\nfunction isLine(doc, l) {return l >= doc.first && l < doc.first + doc.size}\n\nfunction lineNumberFor(options, i) {\n  return String(options.lineNumberFormatter(i + options.firstLineNumber))\n}\n\n// A Pos instance represents a position within the text.\nfunction Pos(line, ch, sticky) {\n  if ( sticky === void 0 ) sticky = null;\n\n  if (!(this instanceof Pos)) { return new Pos(line, ch, sticky) }\n  this.line = line;\n  this.ch = ch;\n  this.sticky = sticky;\n}\n\n// Compare two positions, return 0 if they are the same, a negative\n// number when a is less, and a positive number otherwise.\nfunction cmp(a, b) { return a.line - b.line || a.ch - b.ch }\n\nfunction equalCursorPos(a, b) { return a.sticky == b.sticky && cmp(a, b) == 0 }\n\nfunction copyPos(x) {return Pos(x.line, x.ch)}\nfunction maxPos(a, b) { return cmp(a, b) < 0 ? b : a }\nfunction minPos(a, b) { return cmp(a, b) < 0 ? a : b }\n\n// Most of the external API clips given positions to make sure they\n// actually exist within the document.\nfunction clipLine(doc, n) {return Math.max(doc.first, Math.min(n, doc.first + doc.size - 1))}\nfunction clipPos(doc, pos) {\n  if (pos.line < doc.first) { return Pos(doc.first, 0) }\n  var last = doc.first + doc.size - 1;\n  if (pos.line > last) { return Pos(last, getLine(doc, last).text.length) }\n  return clipToLen(pos, getLine(doc, pos.line).text.length)\n}\nfunction clipToLen(pos, linelen) {\n  var ch = pos.ch;\n  if (ch == null || ch > linelen) { return Pos(pos.line, linelen) }\n  else if (ch < 0) { return Pos(pos.line, 0) }\n  else { return pos }\n}\nfunction clipPosArray(doc, array) {\n  var out = [];\n  for (var i = 0; i < array.length; i++) { out[i] = clipPos(doc, array[i]); }\n  return out\n}\n\n// Optimize some code when these features are not used.\nvar sawReadOnlySpans = false;\nvar sawCollapsedSpans = false;\n\nfunction seeReadOnlySpans() {\n  sawReadOnlySpans = true;\n}\n\nfunction seeCollapsedSpans() {\n  sawCollapsedSpans = true;\n}\n\n// TEXTMARKER SPANS\n\nfunction MarkedSpan(marker, from, to) {\n  this.marker = marker;\n  this.from = from; this.to = to;\n}\n\n// Search an array of spans for a span matching the given marker.\nfunction getMarkedSpanFor(spans, marker) {\n  if (spans) { for (var i = 0; i < spans.length; ++i) {\n    var span = spans[i];\n    if (span.marker == marker) { return span }\n  } }\n}\n// Remove a span from an array, returning undefined if no spans are\n// left (we don't store arrays for lines without spans).\nfunction removeMarkedSpan(spans, span) {\n  var r;\n  for (var i = 0; i < spans.length; ++i)\n    { if (spans[i] != span) { (r || (r = [])).push(spans[i]); } }\n  return r\n}\n// Add a span to a line.\nfunction addMarkedSpan(line, span) {\n  line.markedSpans = line.markedSpans ? line.markedSpans.concat([span]) : [span];\n  span.marker.attachLine(line);\n}\n\n// Used for the algorithm that adjusts markers for a change in the\n// document. These functions cut an array of spans at a given\n// character position, returning an array of remaining chunks (or\n// undefined if nothing remains).\nfunction markedSpansBefore(old, startCh, isInsert) {\n  var nw;\n  if (old) { for (var i = 0; i < old.length; ++i) {\n    var span = old[i], marker = span.marker;\n    var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= startCh : span.from < startCh);\n    if (startsBefore || span.from == startCh && marker.type == \"bookmark\" && (!isInsert || !span.marker.insertLeft)) {\n      var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= startCh : span.to > startCh);(nw || (nw = [])).push(new MarkedSpan(marker, span.from, endsAfter ? null : span.to));\n    }\n  } }\n  return nw\n}\nfunction markedSpansAfter(old, endCh, isInsert) {\n  var nw;\n  if (old) { for (var i = 0; i < old.length; ++i) {\n    var span = old[i], marker = span.marker;\n    var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= endCh : span.to > endCh);\n    if (endsAfter || span.from == endCh && marker.type == \"bookmark\" && (!isInsert || span.marker.insertLeft)) {\n      var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= endCh : span.from < endCh);(nw || (nw = [])).push(new MarkedSpan(marker, startsBefore ? null : span.from - endCh,\n                                            span.to == null ? null : span.to - endCh));\n    }\n  } }\n  return nw\n}\n\n// Given a change object, compute the new set of marker spans that\n// cover the line in which the change took place. Removes spans\n// entirely within the change, reconnects spans belonging to the\n// same marker that appear on both sides of the change, and cuts off\n// spans partially within the change. Returns an array of span\n// arrays with one element for each line in (after) the change.\nfunction stretchSpansOverChange(doc, change) {\n  if (change.full) { return null }\n  var oldFirst = isLine(doc, change.from.line) && getLine(doc, change.from.line).markedSpans;\n  var oldLast = isLine(doc, change.to.line) && getLine(doc, change.to.line).markedSpans;\n  if (!oldFirst && !oldLast) { return null }\n\n  var startCh = change.from.ch, endCh = change.to.ch, isInsert = cmp(change.from, change.to) == 0;\n  // Get the spans that 'stick out' on both sides\n  var first = markedSpansBefore(oldFirst, startCh, isInsert);\n  var last = markedSpansAfter(oldLast, endCh, isInsert);\n\n  // Next, merge those two ends\n  var sameLine = change.text.length == 1, offset = lst(change.text).length + (sameLine ? startCh : 0);\n  if (first) {\n    // Fix up .to properties of first\n    for (var i = 0; i < first.length; ++i) {\n      var span = first[i];\n      if (span.to == null) {\n        var found = getMarkedSpanFor(last, span.marker);\n        if (!found) { span.to = startCh; }\n        else if (sameLine) { span.to = found.to == null ? null : found.to + offset; }\n      }\n    }\n  }\n  if (last) {\n    // Fix up .from in last (or move them into first in case of sameLine)\n    for (var i$1 = 0; i$1 < last.length; ++i$1) {\n      var span$1 = last[i$1];\n      if (span$1.to != null) { span$1.to += offset; }\n      if (span$1.from == null) {\n        var found$1 = getMarkedSpanFor(first, span$1.marker);\n        if (!found$1) {\n          span$1.from = offset;\n          if (sameLine) { (first || (first = [])).push(span$1); }\n        }\n      } else {\n        span$1.from += offset;\n        if (sameLine) { (first || (first = [])).push(span$1); }\n      }\n    }\n  }\n  // Make sure we didn't create any zero-length spans\n  if (first) { first = clearEmptySpans(first); }\n  if (last && last != first) { last = clearEmptySpans(last); }\n\n  var newMarkers = [first];\n  if (!sameLine) {\n    // Fill gap with whole-line-spans\n    var gap = change.text.length - 2, gapMarkers;\n    if (gap > 0 && first)\n      { for (var i$2 = 0; i$2 < first.length; ++i$2)\n        { if (first[i$2].to == null)\n          { (gapMarkers || (gapMarkers = [])).push(new MarkedSpan(first[i$2].marker, null, null)); } } }\n    for (var i$3 = 0; i$3 < gap; ++i$3)\n      { newMarkers.push(gapMarkers); }\n    newMarkers.push(last);\n  }\n  return newMarkers\n}\n\n// Remove spans that are empty and don't have a clearWhenEmpty\n// option of false.\nfunction clearEmptySpans(spans) {\n  for (var i = 0; i < spans.length; ++i) {\n    var span = spans[i];\n    if (span.from != null && span.from == span.to && span.marker.clearWhenEmpty !== false)\n      { spans.splice(i--, 1); }\n  }\n  if (!spans.length) { return null }\n  return spans\n}\n\n// Used to 'clip' out readOnly ranges when making a change.\nfunction removeReadOnlyRanges(doc, from, to) {\n  var markers = null;\n  doc.iter(from.line, to.line + 1, function (line) {\n    if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n      var mark = line.markedSpans[i].marker;\n      if (mark.readOnly && (!markers || indexOf(markers, mark) == -1))\n        { (markers || (markers = [])).push(mark); }\n    } }\n  });\n  if (!markers) { return null }\n  var parts = [{from: from, to: to}];\n  for (var i = 0; i < markers.length; ++i) {\n    var mk = markers[i], m = mk.find(0);\n    for (var j = 0; j < parts.length; ++j) {\n      var p = parts[j];\n      if (cmp(p.to, m.from) < 0 || cmp(p.from, m.to) > 0) { continue }\n      var newParts = [j, 1], dfrom = cmp(p.from, m.from), dto = cmp(p.to, m.to);\n      if (dfrom < 0 || !mk.inclusiveLeft && !dfrom)\n        { newParts.push({from: p.from, to: m.from}); }\n      if (dto > 0 || !mk.inclusiveRight && !dto)\n        { newParts.push({from: m.to, to: p.to}); }\n      parts.splice.apply(parts, newParts);\n      j += newParts.length - 3;\n    }\n  }\n  return parts\n}\n\n// Connect or disconnect spans from a line.\nfunction detachMarkedSpans(line) {\n  var spans = line.markedSpans;\n  if (!spans) { return }\n  for (var i = 0; i < spans.length; ++i)\n    { spans[i].marker.detachLine(line); }\n  line.markedSpans = null;\n}\nfunction attachMarkedSpans(line, spans) {\n  if (!spans) { return }\n  for (var i = 0; i < spans.length; ++i)\n    { spans[i].marker.attachLine(line); }\n  line.markedSpans = spans;\n}\n\n// Helpers used when computing which overlapping collapsed span\n// counts as the larger one.\nfunction extraLeft(marker) { return marker.inclusiveLeft ? -1 : 0 }\nfunction extraRight(marker) { return marker.inclusiveRight ? 1 : 0 }\n\n// Returns a number indicating which of two overlapping collapsed\n// spans is larger (and thus includes the other). Falls back to\n// comparing ids when the spans cover exactly the same range.\nfunction compareCollapsedMarkers(a, b) {\n  var lenDiff = a.lines.length - b.lines.length;\n  if (lenDiff != 0) { return lenDiff }\n  var aPos = a.find(), bPos = b.find();\n  var fromCmp = cmp(aPos.from, bPos.from) || extraLeft(a) - extraLeft(b);\n  if (fromCmp) { return -fromCmp }\n  var toCmp = cmp(aPos.to, bPos.to) || extraRight(a) - extraRight(b);\n  if (toCmp) { return toCmp }\n  return b.id - a.id\n}\n\n// Find out whether a line ends or starts in a collapsed span. If\n// so, return the marker for that span.\nfunction collapsedSpanAtSide(line, start) {\n  var sps = sawCollapsedSpans && line.markedSpans, found;\n  if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n    sp = sps[i];\n    if (sp.marker.collapsed && (start ? sp.from : sp.to) == null &&\n        (!found || compareCollapsedMarkers(found, sp.marker) < 0))\n      { found = sp.marker; }\n  } }\n  return found\n}\nfunction collapsedSpanAtStart(line) { return collapsedSpanAtSide(line, true) }\nfunction collapsedSpanAtEnd(line) { return collapsedSpanAtSide(line, false) }\n\n// Test whether there exists a collapsed span that partially\n// overlaps (covers the start or end, but not both) of a new span.\n// Such overlap is not allowed.\nfunction conflictingCollapsedRange(doc, lineNo$$1, from, to, marker) {\n  var line = getLine(doc, lineNo$$1);\n  var sps = sawCollapsedSpans && line.markedSpans;\n  if (sps) { for (var i = 0; i < sps.length; ++i) {\n    var sp = sps[i];\n    if (!sp.marker.collapsed) { continue }\n    var found = sp.marker.find(0);\n    var fromCmp = cmp(found.from, from) || extraLeft(sp.marker) - extraLeft(marker);\n    var toCmp = cmp(found.to, to) || extraRight(sp.marker) - extraRight(marker);\n    if (fromCmp >= 0 && toCmp <= 0 || fromCmp <= 0 && toCmp >= 0) { continue }\n    if (fromCmp <= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.to, from) >= 0 : cmp(found.to, from) > 0) ||\n        fromCmp >= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.from, to) <= 0 : cmp(found.from, to) < 0))\n      { return true }\n  } }\n}\n\n// A visual line is a line as drawn on the screen. Folding, for\n// example, can cause multiple logical lines to appear on the same\n// visual line. This finds the start of the visual line that the\n// given line is part of (usually that is the line itself).\nfunction visualLine(line) {\n  var merged;\n  while (merged = collapsedSpanAtStart(line))\n    { line = merged.find(-1, true).line; }\n  return line\n}\n\nfunction visualLineEnd(line) {\n  var merged;\n  while (merged = collapsedSpanAtEnd(line))\n    { line = merged.find(1, true).line; }\n  return line\n}\n\n// Returns an array of logical lines that continue the visual line\n// started by the argument, or undefined if there are no such lines.\nfunction visualLineContinued(line) {\n  var merged, lines;\n  while (merged = collapsedSpanAtEnd(line)) {\n    line = merged.find(1, true).line\n    ;(lines || (lines = [])).push(line);\n  }\n  return lines\n}\n\n// Get the line number of the start of the visual line that the\n// given line number is part of.\nfunction visualLineNo(doc, lineN) {\n  var line = getLine(doc, lineN), vis = visualLine(line);\n  if (line == vis) { return lineN }\n  return lineNo(vis)\n}\n\n// Get the line number of the start of the next visual line after\n// the given line.\nfunction visualLineEndNo(doc, lineN) {\n  if (lineN > doc.lastLine()) { return lineN }\n  var line = getLine(doc, lineN), merged;\n  if (!lineIsHidden(doc, line)) { return lineN }\n  while (merged = collapsedSpanAtEnd(line))\n    { line = merged.find(1, true).line; }\n  return lineNo(line) + 1\n}\n\n// Compute whether a line is hidden. Lines count as hidden when they\n// are part of a visual line that starts with another line, or when\n// they are entirely covered by collapsed, non-widget span.\nfunction lineIsHidden(doc, line) {\n  var sps = sawCollapsedSpans && line.markedSpans;\n  if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n    sp = sps[i];\n    if (!sp.marker.collapsed) { continue }\n    if (sp.from == null) { return true }\n    if (sp.marker.widgetNode) { continue }\n    if (sp.from == 0 && sp.marker.inclusiveLeft && lineIsHiddenInner(doc, line, sp))\n      { return true }\n  } }\n}\nfunction lineIsHiddenInner(doc, line, span) {\n  if (span.to == null) {\n    var end = span.marker.find(1, true);\n    return lineIsHiddenInner(doc, end.line, getMarkedSpanFor(end.line.markedSpans, span.marker))\n  }\n  if (span.marker.inclusiveRight && span.to == line.text.length)\n    { return true }\n  for (var sp = (void 0), i = 0; i < line.markedSpans.length; ++i) {\n    sp = line.markedSpans[i];\n    if (sp.marker.collapsed && !sp.marker.widgetNode && sp.from == span.to &&\n        (sp.to == null || sp.to != span.from) &&\n        (sp.marker.inclusiveLeft || span.marker.inclusiveRight) &&\n        lineIsHiddenInner(doc, line, sp)) { return true }\n  }\n}\n\n// Find the height above the given line.\nfunction heightAtLine(lineObj) {\n  lineObj = visualLine(lineObj);\n\n  var h = 0, chunk = lineObj.parent;\n  for (var i = 0; i < chunk.lines.length; ++i) {\n    var line = chunk.lines[i];\n    if (line == lineObj) { break }\n    else { h += line.height; }\n  }\n  for (var p = chunk.parent; p; chunk = p, p = chunk.parent) {\n    for (var i$1 = 0; i$1 < p.children.length; ++i$1) {\n      var cur = p.children[i$1];\n      if (cur == chunk) { break }\n      else { h += cur.height; }\n    }\n  }\n  return h\n}\n\n// Compute the character length of a line, taking into account\n// collapsed ranges (see markText) that might hide parts, and join\n// other lines onto it.\nfunction lineLength(line) {\n  if (line.height == 0) { return 0 }\n  var len = line.text.length, merged, cur = line;\n  while (merged = collapsedSpanAtStart(cur)) {\n    var found = merged.find(0, true);\n    cur = found.from.line;\n    len += found.from.ch - found.to.ch;\n  }\n  cur = line;\n  while (merged = collapsedSpanAtEnd(cur)) {\n    var found$1 = merged.find(0, true);\n    len -= cur.text.length - found$1.from.ch;\n    cur = found$1.to.line;\n    len += cur.text.length - found$1.to.ch;\n  }\n  return len\n}\n\n// Find the longest line in the document.\nfunction findMaxLine(cm) {\n  var d = cm.display, doc = cm.doc;\n  d.maxLine = getLine(doc, doc.first);\n  d.maxLineLength = lineLength(d.maxLine);\n  d.maxLineChanged = true;\n  doc.iter(function (line) {\n    var len = lineLength(line);\n    if (len > d.maxLineLength) {\n      d.maxLineLength = len;\n      d.maxLine = line;\n    }\n  });\n}\n\n// BIDI HELPERS\n\nfunction iterateBidiSections(order, from, to, f) {\n  if (!order) { return f(from, to, \"ltr\", 0) }\n  var found = false;\n  for (var i = 0; i < order.length; ++i) {\n    var part = order[i];\n    if (part.from < to && part.to > from || from == to && part.to == from) {\n      f(Math.max(part.from, from), Math.min(part.to, to), part.level == 1 ? \"rtl\" : \"ltr\", i);\n      found = true;\n    }\n  }\n  if (!found) { f(from, to, \"ltr\"); }\n}\n\nvar bidiOther = null;\nfunction getBidiPartAt(order, ch, sticky) {\n  var found;\n  bidiOther = null;\n  for (var i = 0; i < order.length; ++i) {\n    var cur = order[i];\n    if (cur.from < ch && cur.to > ch) { return i }\n    if (cur.to == ch) {\n      if (cur.from != cur.to && sticky == \"before\") { found = i; }\n      else { bidiOther = i; }\n    }\n    if (cur.from == ch) {\n      if (cur.from != cur.to && sticky != \"before\") { found = i; }\n      else { bidiOther = i; }\n    }\n  }\n  return found != null ? found : bidiOther\n}\n\n// Bidirectional ordering algorithm\n// See http://unicode.org/reports/tr9/tr9-13.html for the algorithm\n// that this (partially) implements.\n\n// One-char codes used for character types:\n// L (L):   Left-to-Right\n// R (R):   Right-to-Left\n// r (AL):  Right-to-Left Arabic\n// 1 (EN):  European Number\n// + (ES):  European Number Separator\n// % (ET):  European Number Terminator\n// n (AN):  Arabic Number\n// , (CS):  Common Number Separator\n// m (NSM): Non-Spacing Mark\n// b (BN):  Boundary Neutral\n// s (B):   Paragraph Separator\n// t (S):   Segment Separator\n// w (WS):  Whitespace\n// N (ON):  Other Neutrals\n\n// Returns null if characters are ordered as they appear\n// (left-to-right), or an array of sections ({from, to, level}\n// objects) in the order in which they occur visually.\nvar bidiOrdering = (function() {\n  // Character types for codepoints 0 to 0xff\n  var lowTypes = \"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN\";\n  // Character types for codepoints 0x600 to 0x6f9\n  var arabicTypes = \"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111\";\n  function charType(code) {\n    if (code <= 0xf7) { return lowTypes.charAt(code) }\n    else if (0x590 <= code && code <= 0x5f4) { return \"R\" }\n    else if (0x600 <= code && code <= 0x6f9) { return arabicTypes.charAt(code - 0x600) }\n    else if (0x6ee <= code && code <= 0x8ac) { return \"r\" }\n    else if (0x2000 <= code && code <= 0x200b) { return \"w\" }\n    else if (code == 0x200c) { return \"b\" }\n    else { return \"L\" }\n  }\n\n  var bidiRE = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;\n  var isNeutral = /[stwN]/, isStrong = /[LRr]/, countsAsLeft = /[Lb1n]/, countsAsNum = /[1n]/;\n\n  function BidiSpan(level, from, to) {\n    this.level = level;\n    this.from = from; this.to = to;\n  }\n\n  return function(str, direction) {\n    var outerType = direction == \"ltr\" ? \"L\" : \"R\";\n\n    if (str.length == 0 || direction == \"ltr\" && !bidiRE.test(str)) { return false }\n    var len = str.length, types = [];\n    for (var i = 0; i < len; ++i)\n      { types.push(charType(str.charCodeAt(i))); }\n\n    // W1. Examine each non-spacing mark (NSM) in the level run, and\n    // change the type of the NSM to the type of the previous\n    // character. If the NSM is at the start of the level run, it will\n    // get the type of sor.\n    for (var i$1 = 0, prev = outerType; i$1 < len; ++i$1) {\n      var type = types[i$1];\n      if (type == \"m\") { types[i$1] = prev; }\n      else { prev = type; }\n    }\n\n    // W2. Search backwards from each instance of a European number\n    // until the first strong type (R, L, AL, or sor) is found. If an\n    // AL is found, change the type of the European number to Arabic\n    // number.\n    // W3. Change all ALs to R.\n    for (var i$2 = 0, cur = outerType; i$2 < len; ++i$2) {\n      var type$1 = types[i$2];\n      if (type$1 == \"1\" && cur == \"r\") { types[i$2] = \"n\"; }\n      else if (isStrong.test(type$1)) { cur = type$1; if (type$1 == \"r\") { types[i$2] = \"R\"; } }\n    }\n\n    // W4. A single European separator between two European numbers\n    // changes to a European number. A single common separator between\n    // two numbers of the same type changes to that type.\n    for (var i$3 = 1, prev$1 = types[0]; i$3 < len - 1; ++i$3) {\n      var type$2 = types[i$3];\n      if (type$2 == \"+\" && prev$1 == \"1\" && types[i$3+1] == \"1\") { types[i$3] = \"1\"; }\n      else if (type$2 == \",\" && prev$1 == types[i$3+1] &&\n               (prev$1 == \"1\" || prev$1 == \"n\")) { types[i$3] = prev$1; }\n      prev$1 = type$2;\n    }\n\n    // W5. A sequence of European terminators adjacent to European\n    // numbers changes to all European numbers.\n    // W6. Otherwise, separators and terminators change to Other\n    // Neutral.\n    for (var i$4 = 0; i$4 < len; ++i$4) {\n      var type$3 = types[i$4];\n      if (type$3 == \",\") { types[i$4] = \"N\"; }\n      else if (type$3 == \"%\") {\n        var end = (void 0);\n        for (end = i$4 + 1; end < len && types[end] == \"%\"; ++end) {}\n        var replace = (i$4 && types[i$4-1] == \"!\") || (end < len && types[end] == \"1\") ? \"1\" : \"N\";\n        for (var j = i$4; j < end; ++j) { types[j] = replace; }\n        i$4 = end - 1;\n      }\n    }\n\n    // W7. Search backwards from each instance of a European number\n    // until the first strong type (R, L, or sor) is found. If an L is\n    // found, then change the type of the European number to L.\n    for (var i$5 = 0, cur$1 = outerType; i$5 < len; ++i$5) {\n      var type$4 = types[i$5];\n      if (cur$1 == \"L\" && type$4 == \"1\") { types[i$5] = \"L\"; }\n      else if (isStrong.test(type$4)) { cur$1 = type$4; }\n    }\n\n    // N1. A sequence of neutrals takes the direction of the\n    // surrounding strong text if the text on both sides has the same\n    // direction. European and Arabic numbers act as if they were R in\n    // terms of their influence on neutrals. Start-of-level-run (sor)\n    // and end-of-level-run (eor) are used at level run boundaries.\n    // N2. Any remaining neutrals take the embedding direction.\n    for (var i$6 = 0; i$6 < len; ++i$6) {\n      if (isNeutral.test(types[i$6])) {\n        var end$1 = (void 0);\n        for (end$1 = i$6 + 1; end$1 < len && isNeutral.test(types[end$1]); ++end$1) {}\n        var before = (i$6 ? types[i$6-1] : outerType) == \"L\";\n        var after = (end$1 < len ? types[end$1] : outerType) == \"L\";\n        var replace$1 = before == after ? (before ? \"L\" : \"R\") : outerType;\n        for (var j$1 = i$6; j$1 < end$1; ++j$1) { types[j$1] = replace$1; }\n        i$6 = end$1 - 1;\n      }\n    }\n\n    // Here we depart from the documented algorithm, in order to avoid\n    // building up an actual levels array. Since there are only three\n    // levels (0, 1, 2) in an implementation that doesn't take\n    // explicit embedding into account, we can build up the order on\n    // the fly, without following the level-based algorithm.\n    var order = [], m;\n    for (var i$7 = 0; i$7 < len;) {\n      if (countsAsLeft.test(types[i$7])) {\n        var start = i$7;\n        for (++i$7; i$7 < len && countsAsLeft.test(types[i$7]); ++i$7) {}\n        order.push(new BidiSpan(0, start, i$7));\n      } else {\n        var pos = i$7, at = order.length;\n        for (++i$7; i$7 < len && types[i$7] != \"L\"; ++i$7) {}\n        for (var j$2 = pos; j$2 < i$7;) {\n          if (countsAsNum.test(types[j$2])) {\n            if (pos < j$2) { order.splice(at, 0, new BidiSpan(1, pos, j$2)); }\n            var nstart = j$2;\n            for (++j$2; j$2 < i$7 && countsAsNum.test(types[j$2]); ++j$2) {}\n            order.splice(at, 0, new BidiSpan(2, nstart, j$2));\n            pos = j$2;\n          } else { ++j$2; }\n        }\n        if (pos < i$7) { order.splice(at, 0, new BidiSpan(1, pos, i$7)); }\n      }\n    }\n    if (direction == \"ltr\") {\n      if (order[0].level == 1 && (m = str.match(/^\\s+/))) {\n        order[0].from = m[0].length;\n        order.unshift(new BidiSpan(0, 0, m[0].length));\n      }\n      if (lst(order).level == 1 && (m = str.match(/\\s+$/))) {\n        lst(order).to -= m[0].length;\n        order.push(new BidiSpan(0, len - m[0].length, len));\n      }\n    }\n\n    return direction == \"rtl\" ? order.reverse() : order\n  }\n})();\n\n// Get the bidi ordering for the given line (and cache it). Returns\n// false for lines that are fully left-to-right, and an array of\n// BidiSpan objects otherwise.\nfunction getOrder(line, direction) {\n  var order = line.order;\n  if (order == null) { order = line.order = bidiOrdering(line.text, direction); }\n  return order\n}\n\n// EVENT HANDLING\n\n// Lightweight event framework. on/off also work on DOM nodes,\n// registering native DOM handlers.\n\nvar noHandlers = [];\n\nvar on = function(emitter, type, f) {\n  if (emitter.addEventListener) {\n    emitter.addEventListener(type, f, false);\n  } else if (emitter.attachEvent) {\n    emitter.attachEvent(\"on\" + type, f);\n  } else {\n    var map$$1 = emitter._handlers || (emitter._handlers = {});\n    map$$1[type] = (map$$1[type] || noHandlers).concat(f);\n  }\n};\n\nfunction getHandlers(emitter, type) {\n  return emitter._handlers && emitter._handlers[type] || noHandlers\n}\n\nfunction off(emitter, type, f) {\n  if (emitter.removeEventListener) {\n    emitter.removeEventListener(type, f, false);\n  } else if (emitter.detachEvent) {\n    emitter.detachEvent(\"on\" + type, f);\n  } else {\n    var map$$1 = emitter._handlers, arr = map$$1 && map$$1[type];\n    if (arr) {\n      var index = indexOf(arr, f);\n      if (index > -1)\n        { map$$1[type] = arr.slice(0, index).concat(arr.slice(index + 1)); }\n    }\n  }\n}\n\nfunction signal(emitter, type /*, values...*/) {\n  var handlers = getHandlers(emitter, type);\n  if (!handlers.length) { return }\n  var args = Array.prototype.slice.call(arguments, 2);\n  for (var i = 0; i < handlers.length; ++i) { handlers[i].apply(null, args); }\n}\n\n// The DOM events that CodeMirror handles can be overridden by\n// registering a (non-DOM) handler on the editor for the event name,\n// and preventDefault-ing the event in that handler.\nfunction signalDOMEvent(cm, e, override) {\n  if (typeof e == \"string\")\n    { e = {type: e, preventDefault: function() { this.defaultPrevented = true; }}; }\n  signal(cm, override || e.type, cm, e);\n  return e_defaultPrevented(e) || e.codemirrorIgnore\n}\n\nfunction signalCursorActivity(cm) {\n  var arr = cm._handlers && cm._handlers.cursorActivity;\n  if (!arr) { return }\n  var set = cm.curOp.cursorActivityHandlers || (cm.curOp.cursorActivityHandlers = []);\n  for (var i = 0; i < arr.length; ++i) { if (indexOf(set, arr[i]) == -1)\n    { set.push(arr[i]); } }\n}\n\nfunction hasHandler(emitter, type) {\n  return getHandlers(emitter, type).length > 0\n}\n\n// Add on and off methods to a constructor's prototype, to make\n// registering events on such objects more convenient.\nfunction eventMixin(ctor) {\n  ctor.prototype.on = function(type, f) {on(this, type, f);};\n  ctor.prototype.off = function(type, f) {off(this, type, f);};\n}\n\n// Due to the fact that we still support jurassic IE versions, some\n// compatibility wrappers are needed.\n\nfunction e_preventDefault(e) {\n  if (e.preventDefault) { e.preventDefault(); }\n  else { e.returnValue = false; }\n}\nfunction e_stopPropagation(e) {\n  if (e.stopPropagation) { e.stopPropagation(); }\n  else { e.cancelBubble = true; }\n}\nfunction e_defaultPrevented(e) {\n  return e.defaultPrevented != null ? e.defaultPrevented : e.returnValue == false\n}\nfunction e_stop(e) {e_preventDefault(e); e_stopPropagation(e);}\n\nfunction e_target(e) {return e.target || e.srcElement}\nfunction e_button(e) {\n  var b = e.which;\n  if (b == null) {\n    if (e.button & 1) { b = 1; }\n    else if (e.button & 2) { b = 3; }\n    else if (e.button & 4) { b = 2; }\n  }\n  if (mac && e.ctrlKey && b == 1) { b = 3; }\n  return b\n}\n\n// Detect drag-and-drop\nvar dragAndDrop = function() {\n  // There is *some* kind of drag-and-drop support in IE6-8, but I\n  // couldn't get it to work yet.\n  if (ie && ie_version < 9) { return false }\n  var div = elt('div');\n  return \"draggable\" in div || \"dragDrop\" in div\n}();\n\nvar zwspSupported;\nfunction zeroWidthElement(measure) {\n  if (zwspSupported == null) {\n    var test = elt(\"span\", \"\\u200b\");\n    removeChildrenAndAdd(measure, elt(\"span\", [test, document.createTextNode(\"x\")]));\n    if (measure.firstChild.offsetHeight != 0)\n      { zwspSupported = test.offsetWidth <= 1 && test.offsetHeight > 2 && !(ie && ie_version < 8); }\n  }\n  var node = zwspSupported ? elt(\"span\", \"\\u200b\") :\n    elt(\"span\", \"\\u00a0\", null, \"display: inline-block; width: 1px; margin-right: -1px\");\n  node.setAttribute(\"cm-text\", \"\");\n  return node\n}\n\n// Feature-detect IE's crummy client rect reporting for bidi text\nvar badBidiRects;\nfunction hasBadBidiRects(measure) {\n  if (badBidiRects != null) { return badBidiRects }\n  var txt = removeChildrenAndAdd(measure, document.createTextNode(\"A\\u062eA\"));\n  var r0 = range(txt, 0, 1).getBoundingClientRect();\n  var r1 = range(txt, 1, 2).getBoundingClientRect();\n  removeChildren(measure);\n  if (!r0 || r0.left == r0.right) { return false } // Safari returns null in some cases (#2780)\n  return badBidiRects = (r1.right - r0.right < 3)\n}\n\n// See if \"\".split is the broken IE version, if so, provide an\n// alternative way to split lines.\nvar splitLinesAuto = \"\\n\\nb\".split(/\\n/).length != 3 ? function (string) {\n  var pos = 0, result = [], l = string.length;\n  while (pos <= l) {\n    var nl = string.indexOf(\"\\n\", pos);\n    if (nl == -1) { nl = string.length; }\n    var line = string.slice(pos, string.charAt(nl - 1) == \"\\r\" ? nl - 1 : nl);\n    var rt = line.indexOf(\"\\r\");\n    if (rt != -1) {\n      result.push(line.slice(0, rt));\n      pos += rt + 1;\n    } else {\n      result.push(line);\n      pos = nl + 1;\n    }\n  }\n  return result\n} : function (string) { return string.split(/\\r\\n?|\\n/); };\n\nvar hasSelection = window.getSelection ? function (te) {\n  try { return te.selectionStart != te.selectionEnd }\n  catch(e) { return false }\n} : function (te) {\n  var range$$1;\n  try {range$$1 = te.ownerDocument.selection.createRange();}\n  catch(e) {}\n  if (!range$$1 || range$$1.parentElement() != te) { return false }\n  return range$$1.compareEndPoints(\"StartToEnd\", range$$1) != 0\n};\n\nvar hasCopyEvent = (function () {\n  var e = elt(\"div\");\n  if (\"oncopy\" in e) { return true }\n  e.setAttribute(\"oncopy\", \"return;\");\n  return typeof e.oncopy == \"function\"\n})();\n\nvar badZoomedRects = null;\nfunction hasBadZoomedRects(measure) {\n  if (badZoomedRects != null) { return badZoomedRects }\n  var node = removeChildrenAndAdd(measure, elt(\"span\", \"x\"));\n  var normal = node.getBoundingClientRect();\n  var fromRange = range(node, 0, 1).getBoundingClientRect();\n  return badZoomedRects = Math.abs(normal.left - fromRange.left) > 1\n}\n\n// Known modes, by name and by MIME\nvar modes = {};\nvar mimeModes = {};\n\n// Extra arguments are stored as the mode's dependencies, which is\n// used by (legacy) mechanisms like loadmode.js to automatically\n// load a mode. (Preferred mechanism is the require/define calls.)\nfunction defineMode(name, mode) {\n  if (arguments.length > 2)\n    { mode.dependencies = Array.prototype.slice.call(arguments, 2); }\n  modes[name] = mode;\n}\n\nfunction defineMIME(mime, spec) {\n  mimeModes[mime] = spec;\n}\n\n// Given a MIME type, a {name, ...options} config object, or a name\n// string, return a mode config object.\nfunction resolveMode(spec) {\n  if (typeof spec == \"string\" && mimeModes.hasOwnProperty(spec)) {\n    spec = mimeModes[spec];\n  } else if (spec && typeof spec.name == \"string\" && mimeModes.hasOwnProperty(spec.name)) {\n    var found = mimeModes[spec.name];\n    if (typeof found == \"string\") { found = {name: found}; }\n    spec = createObj(found, spec);\n    spec.name = found.name;\n  } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+xml$/.test(spec)) {\n    return resolveMode(\"application/xml\")\n  } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+json$/.test(spec)) {\n    return resolveMode(\"application/json\")\n  }\n  if (typeof spec == \"string\") { return {name: spec} }\n  else { return spec || {name: \"null\"} }\n}\n\n// Given a mode spec (anything that resolveMode accepts), find and\n// initialize an actual mode object.\nfunction getMode(options, spec) {\n  spec = resolveMode(spec);\n  var mfactory = modes[spec.name];\n  if (!mfactory) { return getMode(options, \"text/plain\") }\n  var modeObj = mfactory(options, spec);\n  if (modeExtensions.hasOwnProperty(spec.name)) {\n    var exts = modeExtensions[spec.name];\n    for (var prop in exts) {\n      if (!exts.hasOwnProperty(prop)) { continue }\n      if (modeObj.hasOwnProperty(prop)) { modeObj[\"_\" + prop] = modeObj[prop]; }\n      modeObj[prop] = exts[prop];\n    }\n  }\n  modeObj.name = spec.name;\n  if (spec.helperType) { modeObj.helperType = spec.helperType; }\n  if (spec.modeProps) { for (var prop$1 in spec.modeProps)\n    { modeObj[prop$1] = spec.modeProps[prop$1]; } }\n\n  return modeObj\n}\n\n// This can be used to attach properties to mode objects from\n// outside the actual mode definition.\nvar modeExtensions = {};\nfunction extendMode(mode, properties) {\n  var exts = modeExtensions.hasOwnProperty(mode) ? modeExtensions[mode] : (modeExtensions[mode] = {});\n  copyObj(properties, exts);\n}\n\nfunction copyState(mode, state) {\n  if (state === true) { return state }\n  if (mode.copyState) { return mode.copyState(state) }\n  var nstate = {};\n  for (var n in state) {\n    var val = state[n];\n    if (val instanceof Array) { val = val.concat([]); }\n    nstate[n] = val;\n  }\n  return nstate\n}\n\n// Given a mode and a state (for that mode), find the inner mode and\n// state at the position that the state refers to.\nfunction innerMode(mode, state) {\n  var info;\n  while (mode.innerMode) {\n    info = mode.innerMode(state);\n    if (!info || info.mode == mode) { break }\n    state = info.state;\n    mode = info.mode;\n  }\n  return info || {mode: mode, state: state}\n}\n\nfunction startState(mode, a1, a2) {\n  return mode.startState ? mode.startState(a1, a2) : true\n}\n\n// STRING STREAM\n\n// Fed to the mode parsers, provides helper functions to make\n// parsers more succinct.\n\nvar StringStream = function(string, tabSize, lineOracle) {\n  this.pos = this.start = 0;\n  this.string = string;\n  this.tabSize = tabSize || 8;\n  this.lastColumnPos = this.lastColumnValue = 0;\n  this.lineStart = 0;\n  this.lineOracle = lineOracle;\n};\n\nStringStream.prototype.eol = function () {return this.pos >= this.string.length};\nStringStream.prototype.sol = function () {return this.pos == this.lineStart};\nStringStream.prototype.peek = function () {return this.string.charAt(this.pos) || undefined};\nStringStream.prototype.next = function () {\n  if (this.pos < this.string.length)\n    { return this.string.charAt(this.pos++) }\n};\nStringStream.prototype.eat = function (match) {\n  var ch = this.string.charAt(this.pos);\n  var ok;\n  if (typeof match == \"string\") { ok = ch == match; }\n  else { ok = ch && (match.test ? match.test(ch) : match(ch)); }\n  if (ok) {++this.pos; return ch}\n};\nStringStream.prototype.eatWhile = function (match) {\n  var start = this.pos;\n  while (this.eat(match)){}\n  return this.pos > start\n};\nStringStream.prototype.eatSpace = function () {\n    var this$1 = this;\n\n  var start = this.pos;\n  while (/[\\s\\u00a0]/.test(this.string.charAt(this.pos))) { ++this$1.pos; }\n  return this.pos > start\n};\nStringStream.prototype.skipToEnd = function () {this.pos = this.string.length;};\nStringStream.prototype.skipTo = function (ch) {\n  var found = this.string.indexOf(ch, this.pos);\n  if (found > -1) {this.pos = found; return true}\n};\nStringStream.prototype.backUp = function (n) {this.pos -= n;};\nStringStream.prototype.column = function () {\n  if (this.lastColumnPos < this.start) {\n    this.lastColumnValue = countColumn(this.string, this.start, this.tabSize, this.lastColumnPos, this.lastColumnValue);\n    this.lastColumnPos = this.start;\n  }\n  return this.lastColumnValue - (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n};\nStringStream.prototype.indentation = function () {\n  return countColumn(this.string, null, this.tabSize) -\n    (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n};\nStringStream.prototype.match = function (pattern, consume, caseInsensitive) {\n  if (typeof pattern == \"string\") {\n    var cased = function (str) { return caseInsensitive ? str.toLowerCase() : str; };\n    var substr = this.string.substr(this.pos, pattern.length);\n    if (cased(substr) == cased(pattern)) {\n      if (consume !== false) { this.pos += pattern.length; }\n      return true\n    }\n  } else {\n    var match = this.string.slice(this.pos).match(pattern);\n    if (match && match.index > 0) { return null }\n    if (match && consume !== false) { this.pos += match[0].length; }\n    return match\n  }\n};\nStringStream.prototype.current = function (){return this.string.slice(this.start, this.pos)};\nStringStream.prototype.hideFirstChars = function (n, inner) {\n  this.lineStart += n;\n  try { return inner() }\n  finally { this.lineStart -= n; }\n};\nStringStream.prototype.lookAhead = function (n) {\n  var oracle = this.lineOracle;\n  return oracle && oracle.lookAhead(n)\n};\nStringStream.prototype.baseToken = function () {\n  var oracle = this.lineOracle;\n  return oracle && oracle.baseToken(this.pos)\n};\n\nvar SavedContext = function(state, lookAhead) {\n  this.state = state;\n  this.lookAhead = lookAhead;\n};\n\nvar Context = function(doc, state, line, lookAhead) {\n  this.state = state;\n  this.doc = doc;\n  this.line = line;\n  this.maxLookAhead = lookAhead || 0;\n  this.baseTokens = null;\n  this.baseTokenPos = 1;\n};\n\nContext.prototype.lookAhead = function (n) {\n  var line = this.doc.getLine(this.line + n);\n  if (line != null && n > this.maxLookAhead) { this.maxLookAhead = n; }\n  return line\n};\n\nContext.prototype.baseToken = function (n) {\n    var this$1 = this;\n\n  if (!this.baseTokens) { return null }\n  while (this.baseTokens[this.baseTokenPos] <= n)\n    { this$1.baseTokenPos += 2; }\n  var type = this.baseTokens[this.baseTokenPos + 1];\n  return {type: type && type.replace(/( |^)overlay .*/, \"\"),\n          size: this.baseTokens[this.baseTokenPos] - n}\n};\n\nContext.prototype.nextLine = function () {\n  this.line++;\n  if (this.maxLookAhead > 0) { this.maxLookAhead--; }\n};\n\nContext.fromSaved = function (doc, saved, line) {\n  if (saved instanceof SavedContext)\n    { return new Context(doc, copyState(doc.mode, saved.state), line, saved.lookAhead) }\n  else\n    { return new Context(doc, copyState(doc.mode, saved), line) }\n};\n\nContext.prototype.save = function (copy) {\n  var state = copy !== false ? copyState(this.doc.mode, this.state) : this.state;\n  return this.maxLookAhead > 0 ? new SavedContext(state, this.maxLookAhead) : state\n};\n\n\n// Compute a style array (an array starting with a mode generation\n// -- for invalidation -- followed by pairs of end positions and\n// style strings), which is used to highlight the tokens on the\n// line.\nfunction highlightLine(cm, line, context, forceToEnd) {\n  // A styles array always starts with a number identifying the\n  // mode/overlays that it is based on (for easy invalidation).\n  var st = [cm.state.modeGen], lineClasses = {};\n  // Compute the base array of styles\n  runMode(cm, line.text, cm.doc.mode, context, function (end, style) { return st.push(end, style); },\n          lineClasses, forceToEnd);\n  var state = context.state;\n\n  // Run overlays, adjust style array.\n  var loop = function ( o ) {\n    context.baseTokens = st;\n    var overlay = cm.state.overlays[o], i = 1, at = 0;\n    context.state = true;\n    runMode(cm, line.text, overlay.mode, context, function (end, style) {\n      var start = i;\n      // Ensure there's a token end at the current position, and that i points at it\n      while (at < end) {\n        var i_end = st[i];\n        if (i_end > end)\n          { st.splice(i, 1, end, st[i+1], i_end); }\n        i += 2;\n        at = Math.min(end, i_end);\n      }\n      if (!style) { return }\n      if (overlay.opaque) {\n        st.splice(start, i - start, end, \"overlay \" + style);\n        i = start + 2;\n      } else {\n        for (; start < i; start += 2) {\n          var cur = st[start+1];\n          st[start+1] = (cur ? cur + \" \" : \"\") + \"overlay \" + style;\n        }\n      }\n    }, lineClasses);\n    context.state = state;\n    context.baseTokens = null;\n    context.baseTokenPos = 1;\n  };\n\n  for (var o = 0; o < cm.state.overlays.length; ++o) loop( o );\n\n  return {styles: st, classes: lineClasses.bgClass || lineClasses.textClass ? lineClasses : null}\n}\n\nfunction getLineStyles(cm, line, updateFrontier) {\n  if (!line.styles || line.styles[0] != cm.state.modeGen) {\n    var context = getContextBefore(cm, lineNo(line));\n    var resetState = line.text.length > cm.options.maxHighlightLength && copyState(cm.doc.mode, context.state);\n    var result = highlightLine(cm, line, context);\n    if (resetState) { context.state = resetState; }\n    line.stateAfter = context.save(!resetState);\n    line.styles = result.styles;\n    if (result.classes) { line.styleClasses = result.classes; }\n    else if (line.styleClasses) { line.styleClasses = null; }\n    if (updateFrontier === cm.doc.highlightFrontier)\n      { cm.doc.modeFrontier = Math.max(cm.doc.modeFrontier, ++cm.doc.highlightFrontier); }\n  }\n  return line.styles\n}\n\nfunction getContextBefore(cm, n, precise) {\n  var doc = cm.doc, display = cm.display;\n  if (!doc.mode.startState) { return new Context(doc, true, n) }\n  var start = findStartLine(cm, n, precise);\n  var saved = start > doc.first && getLine(doc, start - 1).stateAfter;\n  var context = saved ? Context.fromSaved(doc, saved, start) : new Context(doc, startState(doc.mode), start);\n\n  doc.iter(start, n, function (line) {\n    processLine(cm, line.text, context);\n    var pos = context.line;\n    line.stateAfter = pos == n - 1 || pos % 5 == 0 || pos >= display.viewFrom && pos < display.viewTo ? context.save() : null;\n    context.nextLine();\n  });\n  if (precise) { doc.modeFrontier = context.line; }\n  return context\n}\n\n// Lightweight form of highlight -- proceed over this line and\n// update state, but don't save a style array. Used for lines that\n// aren't currently visible.\nfunction processLine(cm, text, context, startAt) {\n  var mode = cm.doc.mode;\n  var stream = new StringStream(text, cm.options.tabSize, context);\n  stream.start = stream.pos = startAt || 0;\n  if (text == \"\") { callBlankLine(mode, context.state); }\n  while (!stream.eol()) {\n    readToken(mode, stream, context.state);\n    stream.start = stream.pos;\n  }\n}\n\nfunction callBlankLine(mode, state) {\n  if (mode.blankLine) { return mode.blankLine(state) }\n  if (!mode.innerMode) { return }\n  var inner = innerMode(mode, state);\n  if (inner.mode.blankLine) { return inner.mode.blankLine(inner.state) }\n}\n\nfunction readToken(mode, stream, state, inner) {\n  for (var i = 0; i < 10; i++) {\n    if (inner) { inner[0] = innerMode(mode, state).mode; }\n    var style = mode.token(stream, state);\n    if (stream.pos > stream.start) { return style }\n  }\n  throw new Error(\"Mode \" + mode.name + \" failed to advance stream.\")\n}\n\nvar Token = function(stream, type, state) {\n  this.start = stream.start; this.end = stream.pos;\n  this.string = stream.current();\n  this.type = type || null;\n  this.state = state;\n};\n\n// Utility for getTokenAt and getLineTokens\nfunction takeToken(cm, pos, precise, asArray) {\n  var doc = cm.doc, mode = doc.mode, style;\n  pos = clipPos(doc, pos);\n  var line = getLine(doc, pos.line), context = getContextBefore(cm, pos.line, precise);\n  var stream = new StringStream(line.text, cm.options.tabSize, context), tokens;\n  if (asArray) { tokens = []; }\n  while ((asArray || stream.pos < pos.ch) && !stream.eol()) {\n    stream.start = stream.pos;\n    style = readToken(mode, stream, context.state);\n    if (asArray) { tokens.push(new Token(stream, style, copyState(doc.mode, context.state))); }\n  }\n  return asArray ? tokens : new Token(stream, style, context.state)\n}\n\nfunction extractLineClasses(type, output) {\n  if (type) { for (;;) {\n    var lineClass = type.match(/(?:^|\\s+)line-(background-)?(\\S+)/);\n    if (!lineClass) { break }\n    type = type.slice(0, lineClass.index) + type.slice(lineClass.index + lineClass[0].length);\n    var prop = lineClass[1] ? \"bgClass\" : \"textClass\";\n    if (output[prop] == null)\n      { output[prop] = lineClass[2]; }\n    else if (!(new RegExp(\"(?:^|\\s)\" + lineClass[2] + \"(?:$|\\s)\")).test(output[prop]))\n      { output[prop] += \" \" + lineClass[2]; }\n  } }\n  return type\n}\n\n// Run the given mode's parser over a line, calling f for each token.\nfunction runMode(cm, text, mode, context, f, lineClasses, forceToEnd) {\n  var flattenSpans = mode.flattenSpans;\n  if (flattenSpans == null) { flattenSpans = cm.options.flattenSpans; }\n  var curStart = 0, curStyle = null;\n  var stream = new StringStream(text, cm.options.tabSize, context), style;\n  var inner = cm.options.addModeClass && [null];\n  if (text == \"\") { extractLineClasses(callBlankLine(mode, context.state), lineClasses); }\n  while (!stream.eol()) {\n    if (stream.pos > cm.options.maxHighlightLength) {\n      flattenSpans = false;\n      if (forceToEnd) { processLine(cm, text, context, stream.pos); }\n      stream.pos = text.length;\n      style = null;\n    } else {\n      style = extractLineClasses(readToken(mode, stream, context.state, inner), lineClasses);\n    }\n    if (inner) {\n      var mName = inner[0].name;\n      if (mName) { style = \"m-\" + (style ? mName + \" \" + style : mName); }\n    }\n    if (!flattenSpans || curStyle != style) {\n      while (curStart < stream.start) {\n        curStart = Math.min(stream.start, curStart + 5000);\n        f(curStart, curStyle);\n      }\n      curStyle = style;\n    }\n    stream.start = stream.pos;\n  }\n  while (curStart < stream.pos) {\n    // Webkit seems to refuse to render text nodes longer than 57444\n    // characters, and returns inaccurate measurements in nodes\n    // starting around 5000 chars.\n    var pos = Math.min(stream.pos, curStart + 5000);\n    f(pos, curStyle);\n    curStart = pos;\n  }\n}\n\n// Finds the line to start with when starting a parse. Tries to\n// find a line with a stateAfter, so that it can start with a\n// valid state. If that fails, it returns the line with the\n// smallest indentation, which tends to need the least context to\n// parse correctly.\nfunction findStartLine(cm, n, precise) {\n  var minindent, minline, doc = cm.doc;\n  var lim = precise ? -1 : n - (cm.doc.mode.innerMode ? 1000 : 100);\n  for (var search = n; search > lim; --search) {\n    if (search <= doc.first) { return doc.first }\n    var line = getLine(doc, search - 1), after = line.stateAfter;\n    if (after && (!precise || search + (after instanceof SavedContext ? after.lookAhead : 0) <= doc.modeFrontier))\n      { return search }\n    var indented = countColumn(line.text, null, cm.options.tabSize);\n    if (minline == null || minindent > indented) {\n      minline = search - 1;\n      minindent = indented;\n    }\n  }\n  return minline\n}\n\nfunction retreatFrontier(doc, n) {\n  doc.modeFrontier = Math.min(doc.modeFrontier, n);\n  if (doc.highlightFrontier < n - 10) { return }\n  var start = doc.first;\n  for (var line = n - 1; line > start; line--) {\n    var saved = getLine(doc, line).stateAfter;\n    // change is on 3\n    // state on line 1 looked ahead 2 -- so saw 3\n    // test 1 + 2 < 3 should cover this\n    if (saved && (!(saved instanceof SavedContext) || line + saved.lookAhead < n)) {\n      start = line + 1;\n      break\n    }\n  }\n  doc.highlightFrontier = Math.min(doc.highlightFrontier, start);\n}\n\n// LINE DATA STRUCTURE\n\n// Line objects. These hold state related to a line, including\n// highlighting info (the styles array).\nvar Line = function(text, markedSpans, estimateHeight) {\n  this.text = text;\n  attachMarkedSpans(this, markedSpans);\n  this.height = estimateHeight ? estimateHeight(this) : 1;\n};\n\nLine.prototype.lineNo = function () { return lineNo(this) };\neventMixin(Line);\n\n// Change the content (text, markers) of a line. Automatically\n// invalidates cached information and tries to re-estimate the\n// line's height.\nfunction updateLine(line, text, markedSpans, estimateHeight) {\n  line.text = text;\n  if (line.stateAfter) { line.stateAfter = null; }\n  if (line.styles) { line.styles = null; }\n  if (line.order != null) { line.order = null; }\n  detachMarkedSpans(line);\n  attachMarkedSpans(line, markedSpans);\n  var estHeight = estimateHeight ? estimateHeight(line) : 1;\n  if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n}\n\n// Detach a line from the document tree and its markers.\nfunction cleanUpLine(line) {\n  line.parent = null;\n  detachMarkedSpans(line);\n}\n\n// Convert a style as returned by a mode (either null, or a string\n// containing one or more styles) to a CSS style. This is cached,\n// and also looks for line-wide styles.\nvar styleToClassCache = {};\nvar styleToClassCacheWithMode = {};\nfunction interpretTokenStyle(style, options) {\n  if (!style || /^\\s*$/.test(style)) { return null }\n  var cache = options.addModeClass ? styleToClassCacheWithMode : styleToClassCache;\n  return cache[style] ||\n    (cache[style] = style.replace(/\\S+/g, \"cm-$&\"))\n}\n\n// Render the DOM representation of the text of a line. Also builds\n// up a 'line map', which points at the DOM nodes that represent\n// specific stretches of text, and is used by the measuring code.\n// The returned object contains the DOM node, this map, and\n// information about line-wide styles that were set by the mode.\nfunction buildLineContent(cm, lineView) {\n  // The padding-right forces the element to have a 'border', which\n  // is needed on Webkit to be able to get line-level bounding\n  // rectangles for it (in measureChar).\n  var content = eltP(\"span\", null, null, webkit ? \"padding-right: .1px\" : null);\n  var builder = {pre: eltP(\"pre\", [content], \"CodeMirror-line\"), content: content,\n                 col: 0, pos: 0, cm: cm,\n                 trailingSpace: false,\n                 splitSpaces: (ie || webkit) && cm.getOption(\"lineWrapping\")};\n  lineView.measure = {};\n\n  // Iterate over the logical lines that make up this visual line.\n  for (var i = 0; i <= (lineView.rest ? lineView.rest.length : 0); i++) {\n    var line = i ? lineView.rest[i - 1] : lineView.line, order = (void 0);\n    builder.pos = 0;\n    builder.addToken = buildToken;\n    // Optionally wire in some hacks into the token-rendering\n    // algorithm, to deal with browser quirks.\n    if (hasBadBidiRects(cm.display.measure) && (order = getOrder(line, cm.doc.direction)))\n      { builder.addToken = buildTokenBadBidi(builder.addToken, order); }\n    builder.map = [];\n    var allowFrontierUpdate = lineView != cm.display.externalMeasured && lineNo(line);\n    insertLineContent(line, builder, getLineStyles(cm, line, allowFrontierUpdate));\n    if (line.styleClasses) {\n      if (line.styleClasses.bgClass)\n        { builder.bgClass = joinClasses(line.styleClasses.bgClass, builder.bgClass || \"\"); }\n      if (line.styleClasses.textClass)\n        { builder.textClass = joinClasses(line.styleClasses.textClass, builder.textClass || \"\"); }\n    }\n\n    // Ensure at least a single node is present, for measuring.\n    if (builder.map.length == 0)\n      { builder.map.push(0, 0, builder.content.appendChild(zeroWidthElement(cm.display.measure))); }\n\n    // Store the map and a cache object for the current logical line\n    if (i == 0) {\n      lineView.measure.map = builder.map;\n      lineView.measure.cache = {};\n    } else {\n      (lineView.measure.maps || (lineView.measure.maps = [])).push(builder.map)\n      ;(lineView.measure.caches || (lineView.measure.caches = [])).push({});\n    }\n  }\n\n  // See issue #2901\n  if (webkit) {\n    var last = builder.content.lastChild;\n    if (/\\bcm-tab\\b/.test(last.className) || (last.querySelector && last.querySelector(\".cm-tab\")))\n      { builder.content.className = \"cm-tab-wrap-hack\"; }\n  }\n\n  signal(cm, \"renderLine\", cm, lineView.line, builder.pre);\n  if (builder.pre.className)\n    { builder.textClass = joinClasses(builder.pre.className, builder.textClass || \"\"); }\n\n  return builder\n}\n\nfunction defaultSpecialCharPlaceholder(ch) {\n  var token = elt(\"span\", \"\\u2022\", \"cm-invalidchar\");\n  token.title = \"\\\\u\" + ch.charCodeAt(0).toString(16);\n  token.setAttribute(\"aria-label\", token.title);\n  return token\n}\n\n// Build up the DOM representation for a single token, and add it to\n// the line map. Takes care to render special characters separately.\nfunction buildToken(builder, text, style, startStyle, endStyle, title, css) {\n  if (!text) { return }\n  var displayText = builder.splitSpaces ? splitSpaces(text, builder.trailingSpace) : text;\n  var special = builder.cm.state.specialChars, mustWrap = false;\n  var content;\n  if (!special.test(text)) {\n    builder.col += text.length;\n    content = document.createTextNode(displayText);\n    builder.map.push(builder.pos, builder.pos + text.length, content);\n    if (ie && ie_version < 9) { mustWrap = true; }\n    builder.pos += text.length;\n  } else {\n    content = document.createDocumentFragment();\n    var pos = 0;\n    while (true) {\n      special.lastIndex = pos;\n      var m = special.exec(text);\n      var skipped = m ? m.index - pos : text.length - pos;\n      if (skipped) {\n        var txt = document.createTextNode(displayText.slice(pos, pos + skipped));\n        if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt])); }\n        else { content.appendChild(txt); }\n        builder.map.push(builder.pos, builder.pos + skipped, txt);\n        builder.col += skipped;\n        builder.pos += skipped;\n      }\n      if (!m) { break }\n      pos += skipped + 1;\n      var txt$1 = (void 0);\n      if (m[0] == \"\\t\") {\n        var tabSize = builder.cm.options.tabSize, tabWidth = tabSize - builder.col % tabSize;\n        txt$1 = content.appendChild(elt(\"span\", spaceStr(tabWidth), \"cm-tab\"));\n        txt$1.setAttribute(\"role\", \"presentation\");\n        txt$1.setAttribute(\"cm-text\", \"\\t\");\n        builder.col += tabWidth;\n      } else if (m[0] == \"\\r\" || m[0] == \"\\n\") {\n        txt$1 = content.appendChild(elt(\"span\", m[0] == \"\\r\" ? \"\\u240d\" : \"\\u2424\", \"cm-invalidchar\"));\n        txt$1.setAttribute(\"cm-text\", m[0]);\n        builder.col += 1;\n      } else {\n        txt$1 = builder.cm.options.specialCharPlaceholder(m[0]);\n        txt$1.setAttribute(\"cm-text\", m[0]);\n        if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt$1])); }\n        else { content.appendChild(txt$1); }\n        builder.col += 1;\n      }\n      builder.map.push(builder.pos, builder.pos + 1, txt$1);\n      builder.pos++;\n    }\n  }\n  builder.trailingSpace = displayText.charCodeAt(text.length - 1) == 32;\n  if (style || startStyle || endStyle || mustWrap || css) {\n    var fullStyle = style || \"\";\n    if (startStyle) { fullStyle += startStyle; }\n    if (endStyle) { fullStyle += endStyle; }\n    var token = elt(\"span\", [content], fullStyle, css);\n    if (title) { token.title = title; }\n    return builder.content.appendChild(token)\n  }\n  builder.content.appendChild(content);\n}\n\nfunction splitSpaces(text, trailingBefore) {\n  if (text.length > 1 && !/  /.test(text)) { return text }\n  var spaceBefore = trailingBefore, result = \"\";\n  for (var i = 0; i < text.length; i++) {\n    var ch = text.charAt(i);\n    if (ch == \" \" && spaceBefore && (i == text.length - 1 || text.charCodeAt(i + 1) == 32))\n      { ch = \"\\u00a0\"; }\n    result += ch;\n    spaceBefore = ch == \" \";\n  }\n  return result\n}\n\n// Work around nonsense dimensions being reported for stretches of\n// right-to-left text.\nfunction buildTokenBadBidi(inner, order) {\n  return function (builder, text, style, startStyle, endStyle, title, css) {\n    style = style ? style + \" cm-force-border\" : \"cm-force-border\";\n    var start = builder.pos, end = start + text.length;\n    for (;;) {\n      // Find the part that overlaps with the start of this text\n      var part = (void 0);\n      for (var i = 0; i < order.length; i++) {\n        part = order[i];\n        if (part.to > start && part.from <= start) { break }\n      }\n      if (part.to >= end) { return inner(builder, text, style, startStyle, endStyle, title, css) }\n      inner(builder, text.slice(0, part.to - start), style, startStyle, null, title, css);\n      startStyle = null;\n      text = text.slice(part.to - start);\n      start = part.to;\n    }\n  }\n}\n\nfunction buildCollapsedSpan(builder, size, marker, ignoreWidget) {\n  var widget = !ignoreWidget && marker.widgetNode;\n  if (widget) { builder.map.push(builder.pos, builder.pos + size, widget); }\n  if (!ignoreWidget && builder.cm.display.input.needsContentAttribute) {\n    if (!widget)\n      { widget = builder.content.appendChild(document.createElement(\"span\")); }\n    widget.setAttribute(\"cm-marker\", marker.id);\n  }\n  if (widget) {\n    builder.cm.display.input.setUneditable(widget);\n    builder.content.appendChild(widget);\n  }\n  builder.pos += size;\n  builder.trailingSpace = false;\n}\n\n// Outputs a number of spans to make up a line, taking highlighting\n// and marked text into account.\nfunction insertLineContent(line, builder, styles) {\n  var spans = line.markedSpans, allText = line.text, at = 0;\n  if (!spans) {\n    for (var i$1 = 1; i$1 < styles.length; i$1+=2)\n      { builder.addToken(builder, allText.slice(at, at = styles[i$1]), interpretTokenStyle(styles[i$1+1], builder.cm.options)); }\n    return\n  }\n\n  var len = allText.length, pos = 0, i = 1, text = \"\", style, css;\n  var nextChange = 0, spanStyle, spanEndStyle, spanStartStyle, title, collapsed;\n  for (;;) {\n    if (nextChange == pos) { // Update current marker set\n      spanStyle = spanEndStyle = spanStartStyle = title = css = \"\";\n      collapsed = null; nextChange = Infinity;\n      var foundBookmarks = [], endStyles = (void 0);\n      for (var j = 0; j < spans.length; ++j) {\n        var sp = spans[j], m = sp.marker;\n        if (m.type == \"bookmark\" && sp.from == pos && m.widgetNode) {\n          foundBookmarks.push(m);\n        } else if (sp.from <= pos && (sp.to == null || sp.to > pos || m.collapsed && sp.to == pos && sp.from == pos)) {\n          if (sp.to != null && sp.to != pos && nextChange > sp.to) {\n            nextChange = sp.to;\n            spanEndStyle = \"\";\n          }\n          if (m.className) { spanStyle += \" \" + m.className; }\n          if (m.css) { css = (css ? css + \";\" : \"\") + m.css; }\n          if (m.startStyle && sp.from == pos) { spanStartStyle += \" \" + m.startStyle; }\n          if (m.endStyle && sp.to == nextChange) { (endStyles || (endStyles = [])).push(m.endStyle, sp.to); }\n          if (m.title && !title) { title = m.title; }\n          if (m.collapsed && (!collapsed || compareCollapsedMarkers(collapsed.marker, m) < 0))\n            { collapsed = sp; }\n        } else if (sp.from > pos && nextChange > sp.from) {\n          nextChange = sp.from;\n        }\n      }\n      if (endStyles) { for (var j$1 = 0; j$1 < endStyles.length; j$1 += 2)\n        { if (endStyles[j$1 + 1] == nextChange) { spanEndStyle += \" \" + endStyles[j$1]; } } }\n\n      if (!collapsed || collapsed.from == pos) { for (var j$2 = 0; j$2 < foundBookmarks.length; ++j$2)\n        { buildCollapsedSpan(builder, 0, foundBookmarks[j$2]); } }\n      if (collapsed && (collapsed.from || 0) == pos) {\n        buildCollapsedSpan(builder, (collapsed.to == null ? len + 1 : collapsed.to) - pos,\n                           collapsed.marker, collapsed.from == null);\n        if (collapsed.to == null) { return }\n        if (collapsed.to == pos) { collapsed = false; }\n      }\n    }\n    if (pos >= len) { break }\n\n    var upto = Math.min(len, nextChange);\n    while (true) {\n      if (text) {\n        var end = pos + text.length;\n        if (!collapsed) {\n          var tokenText = end > upto ? text.slice(0, upto - pos) : text;\n          builder.addToken(builder, tokenText, style ? style + spanStyle : spanStyle,\n                           spanStartStyle, pos + tokenText.length == nextChange ? spanEndStyle : \"\", title, css);\n        }\n        if (end >= upto) {text = text.slice(upto - pos); pos = upto; break}\n        pos = end;\n        spanStartStyle = \"\";\n      }\n      text = allText.slice(at, at = styles[i++]);\n      style = interpretTokenStyle(styles[i++], builder.cm.options);\n    }\n  }\n}\n\n\n// These objects are used to represent the visible (currently drawn)\n// part of the document. A LineView may correspond to multiple\n// logical lines, if those are connected by collapsed ranges.\nfunction LineView(doc, line, lineN) {\n  // The starting line\n  this.line = line;\n  // Continuing lines, if any\n  this.rest = visualLineContinued(line);\n  // Number of logical lines in this visual line\n  this.size = this.rest ? lineNo(lst(this.rest)) - lineN + 1 : 1;\n  this.node = this.text = null;\n  this.hidden = lineIsHidden(doc, line);\n}\n\n// Create a range of LineView objects for the given lines.\nfunction buildViewArray(cm, from, to) {\n  var array = [], nextPos;\n  for (var pos = from; pos < to; pos = nextPos) {\n    var view = new LineView(cm.doc, getLine(cm.doc, pos), pos);\n    nextPos = pos + view.size;\n    array.push(view);\n  }\n  return array\n}\n\nvar operationGroup = null;\n\nfunction pushOperation(op) {\n  if (operationGroup) {\n    operationGroup.ops.push(op);\n  } else {\n    op.ownsGroup = operationGroup = {\n      ops: [op],\n      delayedCallbacks: []\n    };\n  }\n}\n\nfunction fireCallbacksForOps(group) {\n  // Calls delayed callbacks and cursorActivity handlers until no\n  // new ones appear\n  var callbacks = group.delayedCallbacks, i = 0;\n  do {\n    for (; i < callbacks.length; i++)\n      { callbacks[i].call(null); }\n    for (var j = 0; j < group.ops.length; j++) {\n      var op = group.ops[j];\n      if (op.cursorActivityHandlers)\n        { while (op.cursorActivityCalled < op.cursorActivityHandlers.length)\n          { op.cursorActivityHandlers[op.cursorActivityCalled++].call(null, op.cm); } }\n    }\n  } while (i < callbacks.length)\n}\n\nfunction finishOperation(op, endCb) {\n  var group = op.ownsGroup;\n  if (!group) { return }\n\n  try { fireCallbacksForOps(group); }\n  finally {\n    operationGroup = null;\n    endCb(group);\n  }\n}\n\nvar orphanDelayedCallbacks = null;\n\n// Often, we want to signal events at a point where we are in the\n// middle of some work, but don't want the handler to start calling\n// other methods on the editor, which might be in an inconsistent\n// state or simply not expect any other events to happen.\n// signalLater looks whether there are any handlers, and schedules\n// them to be executed when the last operation ends, or, if no\n// operation is active, when a timeout fires.\nfunction signalLater(emitter, type /*, values...*/) {\n  var arr = getHandlers(emitter, type);\n  if (!arr.length) { return }\n  var args = Array.prototype.slice.call(arguments, 2), list;\n  if (operationGroup) {\n    list = operationGroup.delayedCallbacks;\n  } else if (orphanDelayedCallbacks) {\n    list = orphanDelayedCallbacks;\n  } else {\n    list = orphanDelayedCallbacks = [];\n    setTimeout(fireOrphanDelayed, 0);\n  }\n  var loop = function ( i ) {\n    list.push(function () { return arr[i].apply(null, args); });\n  };\n\n  for (var i = 0; i < arr.length; ++i)\n    loop( i );\n}\n\nfunction fireOrphanDelayed() {\n  var delayed = orphanDelayedCallbacks;\n  orphanDelayedCallbacks = null;\n  for (var i = 0; i < delayed.length; ++i) { delayed[i](); }\n}\n\n// When an aspect of a line changes, a string is added to\n// lineView.changes. This updates the relevant part of the line's\n// DOM structure.\nfunction updateLineForChanges(cm, lineView, lineN, dims) {\n  for (var j = 0; j < lineView.changes.length; j++) {\n    var type = lineView.changes[j];\n    if (type == \"text\") { updateLineText(cm, lineView); }\n    else if (type == \"gutter\") { updateLineGutter(cm, lineView, lineN, dims); }\n    else if (type == \"class\") { updateLineClasses(cm, lineView); }\n    else if (type == \"widget\") { updateLineWidgets(cm, lineView, dims); }\n  }\n  lineView.changes = null;\n}\n\n// Lines with gutter elements, widgets or a background class need to\n// be wrapped, and have the extra elements added to the wrapper div\nfunction ensureLineWrapped(lineView) {\n  if (lineView.node == lineView.text) {\n    lineView.node = elt(\"div\", null, null, \"position: relative\");\n    if (lineView.text.parentNode)\n      { lineView.text.parentNode.replaceChild(lineView.node, lineView.text); }\n    lineView.node.appendChild(lineView.text);\n    if (ie && ie_version < 8) { lineView.node.style.zIndex = 2; }\n  }\n  return lineView.node\n}\n\nfunction updateLineBackground(cm, lineView) {\n  var cls = lineView.bgClass ? lineView.bgClass + \" \" + (lineView.line.bgClass || \"\") : lineView.line.bgClass;\n  if (cls) { cls += \" CodeMirror-linebackground\"; }\n  if (lineView.background) {\n    if (cls) { lineView.background.className = cls; }\n    else { lineView.background.parentNode.removeChild(lineView.background); lineView.background = null; }\n  } else if (cls) {\n    var wrap = ensureLineWrapped(lineView);\n    lineView.background = wrap.insertBefore(elt(\"div\", null, cls), wrap.firstChild);\n    cm.display.input.setUneditable(lineView.background);\n  }\n}\n\n// Wrapper around buildLineContent which will reuse the structure\n// in display.externalMeasured when possible.\nfunction getLineContent(cm, lineView) {\n  var ext = cm.display.externalMeasured;\n  if (ext && ext.line == lineView.line) {\n    cm.display.externalMeasured = null;\n    lineView.measure = ext.measure;\n    return ext.built\n  }\n  return buildLineContent(cm, lineView)\n}\n\n// Redraw the line's text. Interacts with the background and text\n// classes because the mode may output tokens that influence these\n// classes.\nfunction updateLineText(cm, lineView) {\n  var cls = lineView.text.className;\n  var built = getLineContent(cm, lineView);\n  if (lineView.text == lineView.node) { lineView.node = built.pre; }\n  lineView.text.parentNode.replaceChild(built.pre, lineView.text);\n  lineView.text = built.pre;\n  if (built.bgClass != lineView.bgClass || built.textClass != lineView.textClass) {\n    lineView.bgClass = built.bgClass;\n    lineView.textClass = built.textClass;\n    updateLineClasses(cm, lineView);\n  } else if (cls) {\n    lineView.text.className = cls;\n  }\n}\n\nfunction updateLineClasses(cm, lineView) {\n  updateLineBackground(cm, lineView);\n  if (lineView.line.wrapClass)\n    { ensureLineWrapped(lineView).className = lineView.line.wrapClass; }\n  else if (lineView.node != lineView.text)\n    { lineView.node.className = \"\"; }\n  var textClass = lineView.textClass ? lineView.textClass + \" \" + (lineView.line.textClass || \"\") : lineView.line.textClass;\n  lineView.text.className = textClass || \"\";\n}\n\nfunction updateLineGutter(cm, lineView, lineN, dims) {\n  if (lineView.gutter) {\n    lineView.node.removeChild(lineView.gutter);\n    lineView.gutter = null;\n  }\n  if (lineView.gutterBackground) {\n    lineView.node.removeChild(lineView.gutterBackground);\n    lineView.gutterBackground = null;\n  }\n  if (lineView.line.gutterClass) {\n    var wrap = ensureLineWrapped(lineView);\n    lineView.gutterBackground = elt(\"div\", null, \"CodeMirror-gutter-background \" + lineView.line.gutterClass,\n                                    (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px; width: \" + (dims.gutterTotalWidth) + \"px\"));\n    cm.display.input.setUneditable(lineView.gutterBackground);\n    wrap.insertBefore(lineView.gutterBackground, lineView.text);\n  }\n  var markers = lineView.line.gutterMarkers;\n  if (cm.options.lineNumbers || markers) {\n    var wrap$1 = ensureLineWrapped(lineView);\n    var gutterWrap = lineView.gutter = elt(\"div\", null, \"CodeMirror-gutter-wrapper\", (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px\"));\n    cm.display.input.setUneditable(gutterWrap);\n    wrap$1.insertBefore(gutterWrap, lineView.text);\n    if (lineView.line.gutterClass)\n      { gutterWrap.className += \" \" + lineView.line.gutterClass; }\n    if (cm.options.lineNumbers && (!markers || !markers[\"CodeMirror-linenumbers\"]))\n      { lineView.lineNumber = gutterWrap.appendChild(\n        elt(\"div\", lineNumberFor(cm.options, lineN),\n            \"CodeMirror-linenumber CodeMirror-gutter-elt\",\n            (\"left: \" + (dims.gutterLeft[\"CodeMirror-linenumbers\"]) + \"px; width: \" + (cm.display.lineNumInnerWidth) + \"px\"))); }\n    if (markers) { for (var k = 0; k < cm.options.gutters.length; ++k) {\n      var id = cm.options.gutters[k], found = markers.hasOwnProperty(id) && markers[id];\n      if (found)\n        { gutterWrap.appendChild(elt(\"div\", [found], \"CodeMirror-gutter-elt\",\n                                   (\"left: \" + (dims.gutterLeft[id]) + \"px; width: \" + (dims.gutterWidth[id]) + \"px\"))); }\n    } }\n  }\n}\n\nfunction updateLineWidgets(cm, lineView, dims) {\n  if (lineView.alignable) { lineView.alignable = null; }\n  for (var node = lineView.node.firstChild, next = (void 0); node; node = next) {\n    next = node.nextSibling;\n    if (node.className == \"CodeMirror-linewidget\")\n      { lineView.node.removeChild(node); }\n  }\n  insertLineWidgets(cm, lineView, dims);\n}\n\n// Build a line's DOM representation from scratch\nfunction buildLineElement(cm, lineView, lineN, dims) {\n  var built = getLineContent(cm, lineView);\n  lineView.text = lineView.node = built.pre;\n  if (built.bgClass) { lineView.bgClass = built.bgClass; }\n  if (built.textClass) { lineView.textClass = built.textClass; }\n\n  updateLineClasses(cm, lineView);\n  updateLineGutter(cm, lineView, lineN, dims);\n  insertLineWidgets(cm, lineView, dims);\n  return lineView.node\n}\n\n// A lineView may contain multiple logical lines (when merged by\n// collapsed spans). The widgets for all of them need to be drawn.\nfunction insertLineWidgets(cm, lineView, dims) {\n  insertLineWidgetsFor(cm, lineView.line, lineView, dims, true);\n  if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n    { insertLineWidgetsFor(cm, lineView.rest[i], lineView, dims, false); } }\n}\n\nfunction insertLineWidgetsFor(cm, line, lineView, dims, allowAbove) {\n  if (!line.widgets) { return }\n  var wrap = ensureLineWrapped(lineView);\n  for (var i = 0, ws = line.widgets; i < ws.length; ++i) {\n    var widget = ws[i], node = elt(\"div\", [widget.node], \"CodeMirror-linewidget\");\n    if (!widget.handleMouseEvents) { node.setAttribute(\"cm-ignore-events\", \"true\"); }\n    positionLineWidget(widget, node, lineView, dims);\n    cm.display.input.setUneditable(node);\n    if (allowAbove && widget.above)\n      { wrap.insertBefore(node, lineView.gutter || lineView.text); }\n    else\n      { wrap.appendChild(node); }\n    signalLater(widget, \"redraw\");\n  }\n}\n\nfunction positionLineWidget(widget, node, lineView, dims) {\n  if (widget.noHScroll) {\n    (lineView.alignable || (lineView.alignable = [])).push(node);\n    var width = dims.wrapperWidth;\n    node.style.left = dims.fixedPos + \"px\";\n    if (!widget.coverGutter) {\n      width -= dims.gutterTotalWidth;\n      node.style.paddingLeft = dims.gutterTotalWidth + \"px\";\n    }\n    node.style.width = width + \"px\";\n  }\n  if (widget.coverGutter) {\n    node.style.zIndex = 5;\n    node.style.position = \"relative\";\n    if (!widget.noHScroll) { node.style.marginLeft = -dims.gutterTotalWidth + \"px\"; }\n  }\n}\n\nfunction widgetHeight(widget) {\n  if (widget.height != null) { return widget.height }\n  var cm = widget.doc.cm;\n  if (!cm) { return 0 }\n  if (!contains(document.body, widget.node)) {\n    var parentStyle = \"position: relative;\";\n    if (widget.coverGutter)\n      { parentStyle += \"margin-left: -\" + cm.display.gutters.offsetWidth + \"px;\"; }\n    if (widget.noHScroll)\n      { parentStyle += \"width: \" + cm.display.wrapper.clientWidth + \"px;\"; }\n    removeChildrenAndAdd(cm.display.measure, elt(\"div\", [widget.node], null, parentStyle));\n  }\n  return widget.height = widget.node.parentNode.offsetHeight\n}\n\n// Return true when the given mouse event happened in a widget\nfunction eventInWidget(display, e) {\n  for (var n = e_target(e); n != display.wrapper; n = n.parentNode) {\n    if (!n || (n.nodeType == 1 && n.getAttribute(\"cm-ignore-events\") == \"true\") ||\n        (n.parentNode == display.sizer && n != display.mover))\n      { return true }\n  }\n}\n\n// POSITION MEASUREMENT\n\nfunction paddingTop(display) {return display.lineSpace.offsetTop}\nfunction paddingVert(display) {return display.mover.offsetHeight - display.lineSpace.offsetHeight}\nfunction paddingH(display) {\n  if (display.cachedPaddingH) { return display.cachedPaddingH }\n  var e = removeChildrenAndAdd(display.measure, elt(\"pre\", \"x\"));\n  var style = window.getComputedStyle ? window.getComputedStyle(e) : e.currentStyle;\n  var data = {left: parseInt(style.paddingLeft), right: parseInt(style.paddingRight)};\n  if (!isNaN(data.left) && !isNaN(data.right)) { display.cachedPaddingH = data; }\n  return data\n}\n\nfunction scrollGap(cm) { return scrollerGap - cm.display.nativeBarWidth }\nfunction displayWidth(cm) {\n  return cm.display.scroller.clientWidth - scrollGap(cm) - cm.display.barWidth\n}\nfunction displayHeight(cm) {\n  return cm.display.scroller.clientHeight - scrollGap(cm) - cm.display.barHeight\n}\n\n// Ensure the lineView.wrapping.heights array is populated. This is\n// an array of bottom offsets for the lines that make up a drawn\n// line. When lineWrapping is on, there might be more than one\n// height.\nfunction ensureLineHeights(cm, lineView, rect) {\n  var wrapping = cm.options.lineWrapping;\n  var curWidth = wrapping && displayWidth(cm);\n  if (!lineView.measure.heights || wrapping && lineView.measure.width != curWidth) {\n    var heights = lineView.measure.heights = [];\n    if (wrapping) {\n      lineView.measure.width = curWidth;\n      var rects = lineView.text.firstChild.getClientRects();\n      for (var i = 0; i < rects.length - 1; i++) {\n        var cur = rects[i], next = rects[i + 1];\n        if (Math.abs(cur.bottom - next.bottom) > 2)\n          { heights.push((cur.bottom + next.top) / 2 - rect.top); }\n      }\n    }\n    heights.push(rect.bottom - rect.top);\n  }\n}\n\n// Find a line map (mapping character offsets to text nodes) and a\n// measurement cache for the given line number. (A line view might\n// contain multiple lines when collapsed ranges are present.)\nfunction mapFromLineView(lineView, line, lineN) {\n  if (lineView.line == line)\n    { return {map: lineView.measure.map, cache: lineView.measure.cache} }\n  for (var i = 0; i < lineView.rest.length; i++)\n    { if (lineView.rest[i] == line)\n      { return {map: lineView.measure.maps[i], cache: lineView.measure.caches[i]} } }\n  for (var i$1 = 0; i$1 < lineView.rest.length; i$1++)\n    { if (lineNo(lineView.rest[i$1]) > lineN)\n      { return {map: lineView.measure.maps[i$1], cache: lineView.measure.caches[i$1], before: true} } }\n}\n\n// Render a line into the hidden node display.externalMeasured. Used\n// when measurement is needed for a line that's not in the viewport.\nfunction updateExternalMeasurement(cm, line) {\n  line = visualLine(line);\n  var lineN = lineNo(line);\n  var view = cm.display.externalMeasured = new LineView(cm.doc, line, lineN);\n  view.lineN = lineN;\n  var built = view.built = buildLineContent(cm, view);\n  view.text = built.pre;\n  removeChildrenAndAdd(cm.display.lineMeasure, built.pre);\n  return view\n}\n\n// Get a {top, bottom, left, right} box (in line-local coordinates)\n// for a given character.\nfunction measureChar(cm, line, ch, bias) {\n  return measureCharPrepared(cm, prepareMeasureForLine(cm, line), ch, bias)\n}\n\n// Find a line view that corresponds to the given line number.\nfunction findViewForLine(cm, lineN) {\n  if (lineN >= cm.display.viewFrom && lineN < cm.display.viewTo)\n    { return cm.display.view[findViewIndex(cm, lineN)] }\n  var ext = cm.display.externalMeasured;\n  if (ext && lineN >= ext.lineN && lineN < ext.lineN + ext.size)\n    { return ext }\n}\n\n// Measurement can be split in two steps, the set-up work that\n// applies to the whole line, and the measurement of the actual\n// character. Functions like coordsChar, that need to do a lot of\n// measurements in a row, can thus ensure that the set-up work is\n// only done once.\nfunction prepareMeasureForLine(cm, line) {\n  var lineN = lineNo(line);\n  var view = findViewForLine(cm, lineN);\n  if (view && !view.text) {\n    view = null;\n  } else if (view && view.changes) {\n    updateLineForChanges(cm, view, lineN, getDimensions(cm));\n    cm.curOp.forceUpdate = true;\n  }\n  if (!view)\n    { view = updateExternalMeasurement(cm, line); }\n\n  var info = mapFromLineView(view, line, lineN);\n  return {\n    line: line, view: view, rect: null,\n    map: info.map, cache: info.cache, before: info.before,\n    hasHeights: false\n  }\n}\n\n// Given a prepared measurement object, measures the position of an\n// actual character (or fetches it from the cache).\nfunction measureCharPrepared(cm, prepared, ch, bias, varHeight) {\n  if (prepared.before) { ch = -1; }\n  var key = ch + (bias || \"\"), found;\n  if (prepared.cache.hasOwnProperty(key)) {\n    found = prepared.cache[key];\n  } else {\n    if (!prepared.rect)\n      { prepared.rect = prepared.view.text.getBoundingClientRect(); }\n    if (!prepared.hasHeights) {\n      ensureLineHeights(cm, prepared.view, prepared.rect);\n      prepared.hasHeights = true;\n    }\n    found = measureCharInner(cm, prepared, ch, bias);\n    if (!found.bogus) { prepared.cache[key] = found; }\n  }\n  return {left: found.left, right: found.right,\n          top: varHeight ? found.rtop : found.top,\n          bottom: varHeight ? found.rbottom : found.bottom}\n}\n\nvar nullRect = {left: 0, right: 0, top: 0, bottom: 0};\n\nfunction nodeAndOffsetInLineMap(map$$1, ch, bias) {\n  var node, start, end, collapse, mStart, mEnd;\n  // First, search the line map for the text node corresponding to,\n  // or closest to, the target character.\n  for (var i = 0; i < map$$1.length; i += 3) {\n    mStart = map$$1[i];\n    mEnd = map$$1[i + 1];\n    if (ch < mStart) {\n      start = 0; end = 1;\n      collapse = \"left\";\n    } else if (ch < mEnd) {\n      start = ch - mStart;\n      end = start + 1;\n    } else if (i == map$$1.length - 3 || ch == mEnd && map$$1[i + 3] > ch) {\n      end = mEnd - mStart;\n      start = end - 1;\n      if (ch >= mEnd) { collapse = \"right\"; }\n    }\n    if (start != null) {\n      node = map$$1[i + 2];\n      if (mStart == mEnd && bias == (node.insertLeft ? \"left\" : \"right\"))\n        { collapse = bias; }\n      if (bias == \"left\" && start == 0)\n        { while (i && map$$1[i - 2] == map$$1[i - 3] && map$$1[i - 1].insertLeft) {\n          node = map$$1[(i -= 3) + 2];\n          collapse = \"left\";\n        } }\n      if (bias == \"right\" && start == mEnd - mStart)\n        { while (i < map$$1.length - 3 && map$$1[i + 3] == map$$1[i + 4] && !map$$1[i + 5].insertLeft) {\n          node = map$$1[(i += 3) + 2];\n          collapse = \"right\";\n        } }\n      break\n    }\n  }\n  return {node: node, start: start, end: end, collapse: collapse, coverStart: mStart, coverEnd: mEnd}\n}\n\nfunction getUsefulRect(rects, bias) {\n  var rect = nullRect;\n  if (bias == \"left\") { for (var i = 0; i < rects.length; i++) {\n    if ((rect = rects[i]).left != rect.right) { break }\n  } } else { for (var i$1 = rects.length - 1; i$1 >= 0; i$1--) {\n    if ((rect = rects[i$1]).left != rect.right) { break }\n  } }\n  return rect\n}\n\nfunction measureCharInner(cm, prepared, ch, bias) {\n  var place = nodeAndOffsetInLineMap(prepared.map, ch, bias);\n  var node = place.node, start = place.start, end = place.end, collapse = place.collapse;\n\n  var rect;\n  if (node.nodeType == 3) { // If it is a text node, use a range to retrieve the coordinates.\n    for (var i$1 = 0; i$1 < 4; i$1++) { // Retry a maximum of 4 times when nonsense rectangles are returned\n      while (start && isExtendingChar(prepared.line.text.charAt(place.coverStart + start))) { --start; }\n      while (place.coverStart + end < place.coverEnd && isExtendingChar(prepared.line.text.charAt(place.coverStart + end))) { ++end; }\n      if (ie && ie_version < 9 && start == 0 && end == place.coverEnd - place.coverStart)\n        { rect = node.parentNode.getBoundingClientRect(); }\n      else\n        { rect = getUsefulRect(range(node, start, end).getClientRects(), bias); }\n      if (rect.left || rect.right || start == 0) { break }\n      end = start;\n      start = start - 1;\n      collapse = \"right\";\n    }\n    if (ie && ie_version < 11) { rect = maybeUpdateRectForZooming(cm.display.measure, rect); }\n  } else { // If it is a widget, simply get the box for the whole widget.\n    if (start > 0) { collapse = bias = \"right\"; }\n    var rects;\n    if (cm.options.lineWrapping && (rects = node.getClientRects()).length > 1)\n      { rect = rects[bias == \"right\" ? rects.length - 1 : 0]; }\n    else\n      { rect = node.getBoundingClientRect(); }\n  }\n  if (ie && ie_version < 9 && !start && (!rect || !rect.left && !rect.right)) {\n    var rSpan = node.parentNode.getClientRects()[0];\n    if (rSpan)\n      { rect = {left: rSpan.left, right: rSpan.left + charWidth(cm.display), top: rSpan.top, bottom: rSpan.bottom}; }\n    else\n      { rect = nullRect; }\n  }\n\n  var rtop = rect.top - prepared.rect.top, rbot = rect.bottom - prepared.rect.top;\n  var mid = (rtop + rbot) / 2;\n  var heights = prepared.view.measure.heights;\n  var i = 0;\n  for (; i < heights.length - 1; i++)\n    { if (mid < heights[i]) { break } }\n  var top = i ? heights[i - 1] : 0, bot = heights[i];\n  var result = {left: (collapse == \"right\" ? rect.right : rect.left) - prepared.rect.left,\n                right: (collapse == \"left\" ? rect.left : rect.right) - prepared.rect.left,\n                top: top, bottom: bot};\n  if (!rect.left && !rect.right) { result.bogus = true; }\n  if (!cm.options.singleCursorHeightPerLine) { result.rtop = rtop; result.rbottom = rbot; }\n\n  return result\n}\n\n// Work around problem with bounding client rects on ranges being\n// returned incorrectly when zoomed on IE10 and below.\nfunction maybeUpdateRectForZooming(measure, rect) {\n  if (!window.screen || screen.logicalXDPI == null ||\n      screen.logicalXDPI == screen.deviceXDPI || !hasBadZoomedRects(measure))\n    { return rect }\n  var scaleX = screen.logicalXDPI / screen.deviceXDPI;\n  var scaleY = screen.logicalYDPI / screen.deviceYDPI;\n  return {left: rect.left * scaleX, right: rect.right * scaleX,\n          top: rect.top * scaleY, bottom: rect.bottom * scaleY}\n}\n\nfunction clearLineMeasurementCacheFor(lineView) {\n  if (lineView.measure) {\n    lineView.measure.cache = {};\n    lineView.measure.heights = null;\n    if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n      { lineView.measure.caches[i] = {}; } }\n  }\n}\n\nfunction clearLineMeasurementCache(cm) {\n  cm.display.externalMeasure = null;\n  removeChildren(cm.display.lineMeasure);\n  for (var i = 0; i < cm.display.view.length; i++)\n    { clearLineMeasurementCacheFor(cm.display.view[i]); }\n}\n\nfunction clearCaches(cm) {\n  clearLineMeasurementCache(cm);\n  cm.display.cachedCharWidth = cm.display.cachedTextHeight = cm.display.cachedPaddingH = null;\n  if (!cm.options.lineWrapping) { cm.display.maxLineChanged = true; }\n  cm.display.lineNumChars = null;\n}\n\nfunction pageScrollX() {\n  // Work around https://bugs.chromium.org/p/chromium/issues/detail?id=489206\n  // which causes page_Offset and bounding client rects to use\n  // different reference viewports and invalidate our calculations.\n  if (chrome && android) { return -(document.body.getBoundingClientRect().left - parseInt(getComputedStyle(document.body).marginLeft)) }\n  return window.pageXOffset || (document.documentElement || document.body).scrollLeft\n}\nfunction pageScrollY() {\n  if (chrome && android) { return -(document.body.getBoundingClientRect().top - parseInt(getComputedStyle(document.body).marginTop)) }\n  return window.pageYOffset || (document.documentElement || document.body).scrollTop\n}\n\nfunction widgetTopHeight(lineObj) {\n  var height = 0;\n  if (lineObj.widgets) { for (var i = 0; i < lineObj.widgets.length; ++i) { if (lineObj.widgets[i].above)\n    { height += widgetHeight(lineObj.widgets[i]); } } }\n  return height\n}\n\n// Converts a {top, bottom, left, right} box from line-local\n// coordinates into another coordinate system. Context may be one of\n// \"line\", \"div\" (display.lineDiv), \"local\"./null (editor), \"window\",\n// or \"page\".\nfunction intoCoordSystem(cm, lineObj, rect, context, includeWidgets) {\n  if (!includeWidgets) {\n    var height = widgetTopHeight(lineObj);\n    rect.top += height; rect.bottom += height;\n  }\n  if (context == \"line\") { return rect }\n  if (!context) { context = \"local\"; }\n  var yOff = heightAtLine(lineObj);\n  if (context == \"local\") { yOff += paddingTop(cm.display); }\n  else { yOff -= cm.display.viewOffset; }\n  if (context == \"page\" || context == \"window\") {\n    var lOff = cm.display.lineSpace.getBoundingClientRect();\n    yOff += lOff.top + (context == \"window\" ? 0 : pageScrollY());\n    var xOff = lOff.left + (context == \"window\" ? 0 : pageScrollX());\n    rect.left += xOff; rect.right += xOff;\n  }\n  rect.top += yOff; rect.bottom += yOff;\n  return rect\n}\n\n// Coverts a box from \"div\" coords to another coordinate system.\n// Context may be \"window\", \"page\", \"div\", or \"local\"./null.\nfunction fromCoordSystem(cm, coords, context) {\n  if (context == \"div\") { return coords }\n  var left = coords.left, top = coords.top;\n  // First move into \"page\" coordinate system\n  if (context == \"page\") {\n    left -= pageScrollX();\n    top -= pageScrollY();\n  } else if (context == \"local\" || !context) {\n    var localBox = cm.display.sizer.getBoundingClientRect();\n    left += localBox.left;\n    top += localBox.top;\n  }\n\n  var lineSpaceBox = cm.display.lineSpace.getBoundingClientRect();\n  return {left: left - lineSpaceBox.left, top: top - lineSpaceBox.top}\n}\n\nfunction charCoords(cm, pos, context, lineObj, bias) {\n  if (!lineObj) { lineObj = getLine(cm.doc, pos.line); }\n  return intoCoordSystem(cm, lineObj, measureChar(cm, lineObj, pos.ch, bias), context)\n}\n\n// Returns a box for a given cursor position, which may have an\n// 'other' property containing the position of the secondary cursor\n// on a bidi boundary.\n// A cursor Pos(line, char, \"before\") is on the same visual line as `char - 1`\n// and after `char - 1` in writing order of `char - 1`\n// A cursor Pos(line, char, \"after\") is on the same visual line as `char`\n// and before `char` in writing order of `char`\n// Examples (upper-case letters are RTL, lower-case are LTR):\n//     Pos(0, 1, ...)\n//     before   after\n// ab     a|b     a|b\n// aB     a|B     aB|\n// Ab     |Ab     A|b\n// AB     B|A     B|A\n// Every position after the last character on a line is considered to stick\n// to the last character on the line.\nfunction cursorCoords(cm, pos, context, lineObj, preparedMeasure, varHeight) {\n  lineObj = lineObj || getLine(cm.doc, pos.line);\n  if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\n  function get(ch, right) {\n    var m = measureCharPrepared(cm, preparedMeasure, ch, right ? \"right\" : \"left\", varHeight);\n    if (right) { m.left = m.right; } else { m.right = m.left; }\n    return intoCoordSystem(cm, lineObj, m, context)\n  }\n  var order = getOrder(lineObj, cm.doc.direction), ch = pos.ch, sticky = pos.sticky;\n  if (ch >= lineObj.text.length) {\n    ch = lineObj.text.length;\n    sticky = \"before\";\n  } else if (ch <= 0) {\n    ch = 0;\n    sticky = \"after\";\n  }\n  if (!order) { return get(sticky == \"before\" ? ch - 1 : ch, sticky == \"before\") }\n\n  function getBidi(ch, partPos, invert) {\n    var part = order[partPos], right = part.level == 1;\n    return get(invert ? ch - 1 : ch, right != invert)\n  }\n  var partPos = getBidiPartAt(order, ch, sticky);\n  var other = bidiOther;\n  var val = getBidi(ch, partPos, sticky == \"before\");\n  if (other != null) { val.other = getBidi(ch, other, sticky != \"before\"); }\n  return val\n}\n\n// Used to cheaply estimate the coordinates for a position. Used for\n// intermediate scroll updates.\nfunction estimateCoords(cm, pos) {\n  var left = 0;\n  pos = clipPos(cm.doc, pos);\n  if (!cm.options.lineWrapping) { left = charWidth(cm.display) * pos.ch; }\n  var lineObj = getLine(cm.doc, pos.line);\n  var top = heightAtLine(lineObj) + paddingTop(cm.display);\n  return {left: left, right: left, top: top, bottom: top + lineObj.height}\n}\n\n// Positions returned by coordsChar contain some extra information.\n// xRel is the relative x position of the input coordinates compared\n// to the found position (so xRel > 0 means the coordinates are to\n// the right of the character position, for example). When outside\n// is true, that means the coordinates lie outside the line's\n// vertical range.\nfunction PosWithInfo(line, ch, sticky, outside, xRel) {\n  var pos = Pos(line, ch, sticky);\n  pos.xRel = xRel;\n  if (outside) { pos.outside = true; }\n  return pos\n}\n\n// Compute the character position closest to the given coordinates.\n// Input must be lineSpace-local (\"div\" coordinate system).\nfunction coordsChar(cm, x, y) {\n  var doc = cm.doc;\n  y += cm.display.viewOffset;\n  if (y < 0) { return PosWithInfo(doc.first, 0, null, true, -1) }\n  var lineN = lineAtHeight(doc, y), last = doc.first + doc.size - 1;\n  if (lineN > last)\n    { return PosWithInfo(doc.first + doc.size - 1, getLine(doc, last).text.length, null, true, 1) }\n  if (x < 0) { x = 0; }\n\n  var lineObj = getLine(doc, lineN);\n  for (;;) {\n    var found = coordsCharInner(cm, lineObj, lineN, x, y);\n    var merged = collapsedSpanAtEnd(lineObj);\n    var mergedPos = merged && merged.find(0, true);\n    if (merged && (found.ch > mergedPos.from.ch || found.ch == mergedPos.from.ch && found.xRel > 0))\n      { lineN = lineNo(lineObj = mergedPos.to.line); }\n    else\n      { return found }\n  }\n}\n\nfunction wrappedLineExtent(cm, lineObj, preparedMeasure, y) {\n  y -= widgetTopHeight(lineObj);\n  var end = lineObj.text.length;\n  var begin = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch - 1).bottom <= y; }, end, 0);\n  end = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch).top > y; }, begin, end);\n  return {begin: begin, end: end}\n}\n\nfunction wrappedLineExtentChar(cm, lineObj, preparedMeasure, target) {\n  if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\n  var targetTop = intoCoordSystem(cm, lineObj, measureCharPrepared(cm, preparedMeasure, target), \"line\").top;\n  return wrappedLineExtent(cm, lineObj, preparedMeasure, targetTop)\n}\n\n// Returns true if the given side of a box is after the given\n// coordinates, in top-to-bottom, left-to-right order.\nfunction boxIsAfter(box, x, y, left) {\n  return box.bottom <= y ? false : box.top > y ? true : (left ? box.left : box.right) > x\n}\n\nfunction coordsCharInner(cm, lineObj, lineNo$$1, x, y) {\n  // Move y into line-local coordinate space\n  y -= heightAtLine(lineObj);\n  var preparedMeasure = prepareMeasureForLine(cm, lineObj);\n  // When directly calling `measureCharPrepared`, we have to adjust\n  // for the widgets at this line.\n  var widgetHeight$$1 = widgetTopHeight(lineObj);\n  var begin = 0, end = lineObj.text.length, ltr = true;\n\n  var order = getOrder(lineObj, cm.doc.direction);\n  // If the line isn't plain left-to-right text, first figure out\n  // which bidi section the coordinates fall into.\n  if (order) {\n    var part = (cm.options.lineWrapping ? coordsBidiPartWrapped : coordsBidiPart)\n                 (cm, lineObj, lineNo$$1, preparedMeasure, order, x, y);\n    ltr = part.level != 1;\n    // The awkward -1 offsets are needed because findFirst (called\n    // on these below) will treat its first bound as inclusive,\n    // second as exclusive, but we want to actually address the\n    // characters in the part's range\n    begin = ltr ? part.from : part.to - 1;\n    end = ltr ? part.to : part.from - 1;\n  }\n\n  // A binary search to find the first character whose bounding box\n  // starts after the coordinates. If we run across any whose box wrap\n  // the coordinates, store that.\n  var chAround = null, boxAround = null;\n  var ch = findFirst(function (ch) {\n    var box = measureCharPrepared(cm, preparedMeasure, ch);\n    box.top += widgetHeight$$1; box.bottom += widgetHeight$$1;\n    if (!boxIsAfter(box, x, y, false)) { return false }\n    if (box.top <= y && box.left <= x) {\n      chAround = ch;\n      boxAround = box;\n    }\n    return true\n  }, begin, end);\n\n  var baseX, sticky, outside = false;\n  // If a box around the coordinates was found, use that\n  if (boxAround) {\n    // Distinguish coordinates nearer to the left or right side of the box\n    var atLeft = x - boxAround.left < boxAround.right - x, atStart = atLeft == ltr;\n    ch = chAround + (atStart ? 0 : 1);\n    sticky = atStart ? \"after\" : \"before\";\n    baseX = atLeft ? boxAround.left : boxAround.right;\n  } else {\n    // (Adjust for extended bound, if necessary.)\n    if (!ltr && (ch == end || ch == begin)) { ch++; }\n    // To determine which side to associate with, get the box to the\n    // left of the character and compare it's vertical position to the\n    // coordinates\n    sticky = ch == 0 ? \"after\" : ch == lineObj.text.length ? \"before\" :\n      (measureCharPrepared(cm, preparedMeasure, ch - (ltr ? 1 : 0)).bottom + widgetHeight$$1 <= y) == ltr ?\n      \"after\" : \"before\";\n    // Now get accurate coordinates for this place, in order to get a\n    // base X position\n    var coords = cursorCoords(cm, Pos(lineNo$$1, ch, sticky), \"line\", lineObj, preparedMeasure);\n    baseX = coords.left;\n    outside = y < coords.top || y >= coords.bottom;\n  }\n\n  ch = skipExtendingChars(lineObj.text, ch, 1);\n  return PosWithInfo(lineNo$$1, ch, sticky, outside, x - baseX)\n}\n\nfunction coordsBidiPart(cm, lineObj, lineNo$$1, preparedMeasure, order, x, y) {\n  // Bidi parts are sorted left-to-right, and in a non-line-wrapping\n  // situation, we can take this ordering to correspond to the visual\n  // ordering. This finds the first part whose end is after the given\n  // coordinates.\n  var index = findFirst(function (i) {\n    var part = order[i], ltr = part.level != 1;\n    return boxIsAfter(cursorCoords(cm, Pos(lineNo$$1, ltr ? part.to : part.from, ltr ? \"before\" : \"after\"),\n                                   \"line\", lineObj, preparedMeasure), x, y, true)\n  }, 0, order.length - 1);\n  var part = order[index];\n  // If this isn't the first part, the part's start is also after\n  // the coordinates, and the coordinates aren't on the same line as\n  // that start, move one part back.\n  if (index > 0) {\n    var ltr = part.level != 1;\n    var start = cursorCoords(cm, Pos(lineNo$$1, ltr ? part.from : part.to, ltr ? \"after\" : \"before\"),\n                             \"line\", lineObj, preparedMeasure);\n    if (boxIsAfter(start, x, y, true) && start.top > y)\n      { part = order[index - 1]; }\n  }\n  return part\n}\n\nfunction coordsBidiPartWrapped(cm, lineObj, _lineNo, preparedMeasure, order, x, y) {\n  // In a wrapped line, rtl text on wrapping boundaries can do things\n  // that don't correspond to the ordering in our `order` array at\n  // all, so a binary search doesn't work, and we want to return a\n  // part that only spans one line so that the binary search in\n  // coordsCharInner is safe. As such, we first find the extent of the\n  // wrapped line, and then do a flat search in which we discard any\n  // spans that aren't on the line.\n  var ref = wrappedLineExtent(cm, lineObj, preparedMeasure, y);\n  var begin = ref.begin;\n  var end = ref.end;\n  if (/\\s/.test(lineObj.text.charAt(end - 1))) { end--; }\n  var part = null, closestDist = null;\n  for (var i = 0; i < order.length; i++) {\n    var p = order[i];\n    if (p.from >= end || p.to <= begin) { continue }\n    var ltr = p.level != 1;\n    var endX = measureCharPrepared(cm, preparedMeasure, ltr ? Math.min(end, p.to) - 1 : Math.max(begin, p.from)).right;\n    // Weigh against spans ending before this, so that they are only\n    // picked if nothing ends after\n    var dist = endX < x ? x - endX + 1e9 : endX - x;\n    if (!part || closestDist > dist) {\n      part = p;\n      closestDist = dist;\n    }\n  }\n  if (!part) { part = order[order.length - 1]; }\n  // Clip the part to the wrapped line.\n  if (part.from < begin) { part = {from: begin, to: part.to, level: part.level}; }\n  if (part.to > end) { part = {from: part.from, to: end, level: part.level}; }\n  return part\n}\n\nvar measureText;\n// Compute the default text height.\nfunction textHeight(display) {\n  if (display.cachedTextHeight != null) { return display.cachedTextHeight }\n  if (measureText == null) {\n    measureText = elt(\"pre\");\n    // Measure a bunch of lines, for browsers that compute\n    // fractional heights.\n    for (var i = 0; i < 49; ++i) {\n      measureText.appendChild(document.createTextNode(\"x\"));\n      measureText.appendChild(elt(\"br\"));\n    }\n    measureText.appendChild(document.createTextNode(\"x\"));\n  }\n  removeChildrenAndAdd(display.measure, measureText);\n  var height = measureText.offsetHeight / 50;\n  if (height > 3) { display.cachedTextHeight = height; }\n  removeChildren(display.measure);\n  return height || 1\n}\n\n// Compute the default character width.\nfunction charWidth(display) {\n  if (display.cachedCharWidth != null) { return display.cachedCharWidth }\n  var anchor = elt(\"span\", \"xxxxxxxxxx\");\n  var pre = elt(\"pre\", [anchor]);\n  removeChildrenAndAdd(display.measure, pre);\n  var rect = anchor.getBoundingClientRect(), width = (rect.right - rect.left) / 10;\n  if (width > 2) { display.cachedCharWidth = width; }\n  return width || 10\n}\n\n// Do a bulk-read of the DOM positions and sizes needed to draw the\n// view, so that we don't interleave reading and writing to the DOM.\nfunction getDimensions(cm) {\n  var d = cm.display, left = {}, width = {};\n  var gutterLeft = d.gutters.clientLeft;\n  for (var n = d.gutters.firstChild, i = 0; n; n = n.nextSibling, ++i) {\n    left[cm.options.gutters[i]] = n.offsetLeft + n.clientLeft + gutterLeft;\n    width[cm.options.gutters[i]] = n.clientWidth;\n  }\n  return {fixedPos: compensateForHScroll(d),\n          gutterTotalWidth: d.gutters.offsetWidth,\n          gutterLeft: left,\n          gutterWidth: width,\n          wrapperWidth: d.wrapper.clientWidth}\n}\n\n// Computes display.scroller.scrollLeft + display.gutters.offsetWidth,\n// but using getBoundingClientRect to get a sub-pixel-accurate\n// result.\nfunction compensateForHScroll(display) {\n  return display.scroller.getBoundingClientRect().left - display.sizer.getBoundingClientRect().left\n}\n\n// Returns a function that estimates the height of a line, to use as\n// first approximation until the line becomes visible (and is thus\n// properly measurable).\nfunction estimateHeight(cm) {\n  var th = textHeight(cm.display), wrapping = cm.options.lineWrapping;\n  var perLine = wrapping && Math.max(5, cm.display.scroller.clientWidth / charWidth(cm.display) - 3);\n  return function (line) {\n    if (lineIsHidden(cm.doc, line)) { return 0 }\n\n    var widgetsHeight = 0;\n    if (line.widgets) { for (var i = 0; i < line.widgets.length; i++) {\n      if (line.widgets[i].height) { widgetsHeight += line.widgets[i].height; }\n    } }\n\n    if (wrapping)\n      { return widgetsHeight + (Math.ceil(line.text.length / perLine) || 1) * th }\n    else\n      { return widgetsHeight + th }\n  }\n}\n\nfunction estimateLineHeights(cm) {\n  var doc = cm.doc, est = estimateHeight(cm);\n  doc.iter(function (line) {\n    var estHeight = est(line);\n    if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n  });\n}\n\n// Given a mouse event, find the corresponding position. If liberal\n// is false, it checks whether a gutter or scrollbar was clicked,\n// and returns null if it was. forRect is used by rectangular\n// selections, and tries to estimate a character position even for\n// coordinates beyond the right of the text.\nfunction posFromMouse(cm, e, liberal, forRect) {\n  var display = cm.display;\n  if (!liberal && e_target(e).getAttribute(\"cm-not-content\") == \"true\") { return null }\n\n  var x, y, space = display.lineSpace.getBoundingClientRect();\n  // Fails unpredictably on IE[67] when mouse is dragged around quickly.\n  try { x = e.clientX - space.left; y = e.clientY - space.top; }\n  catch (e) { return null }\n  var coords = coordsChar(cm, x, y), line;\n  if (forRect && coords.xRel == 1 && (line = getLine(cm.doc, coords.line).text).length == coords.ch) {\n    var colDiff = countColumn(line, line.length, cm.options.tabSize) - line.length;\n    coords = Pos(coords.line, Math.max(0, Math.round((x - paddingH(cm.display).left) / charWidth(cm.display)) - colDiff));\n  }\n  return coords\n}\n\n// Find the view element corresponding to a given line. Return null\n// when the line isn't visible.\nfunction findViewIndex(cm, n) {\n  if (n >= cm.display.viewTo) { return null }\n  n -= cm.display.viewFrom;\n  if (n < 0) { return null }\n  var view = cm.display.view;\n  for (var i = 0; i < view.length; i++) {\n    n -= view[i].size;\n    if (n < 0) { return i }\n  }\n}\n\nfunction updateSelection(cm) {\n  cm.display.input.showSelection(cm.display.input.prepareSelection());\n}\n\nfunction prepareSelection(cm, primary) {\n  if ( primary === void 0 ) primary = true;\n\n  var doc = cm.doc, result = {};\n  var curFragment = result.cursors = document.createDocumentFragment();\n  var selFragment = result.selection = document.createDocumentFragment();\n\n  for (var i = 0; i < doc.sel.ranges.length; i++) {\n    if (!primary && i == doc.sel.primIndex) { continue }\n    var range$$1 = doc.sel.ranges[i];\n    if (range$$1.from().line >= cm.display.viewTo || range$$1.to().line < cm.display.viewFrom) { continue }\n    var collapsed = range$$1.empty();\n    if (collapsed || cm.options.showCursorWhenSelecting)\n      { drawSelectionCursor(cm, range$$1.head, curFragment); }\n    if (!collapsed)\n      { drawSelectionRange(cm, range$$1, selFragment); }\n  }\n  return result\n}\n\n// Draws a cursor for the given range\nfunction drawSelectionCursor(cm, head, output) {\n  var pos = cursorCoords(cm, head, \"div\", null, null, !cm.options.singleCursorHeightPerLine);\n\n  var cursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor\"));\n  cursor.style.left = pos.left + \"px\";\n  cursor.style.top = pos.top + \"px\";\n  cursor.style.height = Math.max(0, pos.bottom - pos.top) * cm.options.cursorHeight + \"px\";\n\n  if (pos.other) {\n    // Secondary cursor, shown when on a 'jump' in bi-directional text\n    var otherCursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor CodeMirror-secondarycursor\"));\n    otherCursor.style.display = \"\";\n    otherCursor.style.left = pos.other.left + \"px\";\n    otherCursor.style.top = pos.other.top + \"px\";\n    otherCursor.style.height = (pos.other.bottom - pos.other.top) * .85 + \"px\";\n  }\n}\n\nfunction cmpCoords(a, b) { return a.top - b.top || a.left - b.left }\n\n// Draws the given range as a highlighted selection\nfunction drawSelectionRange(cm, range$$1, output) {\n  var display = cm.display, doc = cm.doc;\n  var fragment = document.createDocumentFragment();\n  var padding = paddingH(cm.display), leftSide = padding.left;\n  var rightSide = Math.max(display.sizerWidth, displayWidth(cm) - display.sizer.offsetLeft) - padding.right;\n  var docLTR = doc.direction == \"ltr\";\n\n  function add(left, top, width, bottom) {\n    if (top < 0) { top = 0; }\n    top = Math.round(top);\n    bottom = Math.round(bottom);\n    fragment.appendChild(elt(\"div\", null, \"CodeMirror-selected\", (\"position: absolute; left: \" + left + \"px;\\n                             top: \" + top + \"px; width: \" + (width == null ? rightSide - left : width) + \"px;\\n                             height: \" + (bottom - top) + \"px\")));\n  }\n\n  function drawForLine(line, fromArg, toArg) {\n    var lineObj = getLine(doc, line);\n    var lineLen = lineObj.text.length;\n    var start, end;\n    function coords(ch, bias) {\n      return charCoords(cm, Pos(line, ch), \"div\", lineObj, bias)\n    }\n\n    function wrapX(pos, dir, side) {\n      var extent = wrappedLineExtentChar(cm, lineObj, null, pos);\n      var prop = (dir == \"ltr\") == (side == \"after\") ? \"left\" : \"right\";\n      var ch = side == \"after\" ? extent.begin : extent.end - (/\\s/.test(lineObj.text.charAt(extent.end - 1)) ? 2 : 1);\n      return coords(ch, prop)[prop]\n    }\n\n    var order = getOrder(lineObj, doc.direction);\n    iterateBidiSections(order, fromArg || 0, toArg == null ? lineLen : toArg, function (from, to, dir, i) {\n      var ltr = dir == \"ltr\";\n      var fromPos = coords(from, ltr ? \"left\" : \"right\");\n      var toPos = coords(to - 1, ltr ? \"right\" : \"left\");\n\n      var openStart = fromArg == null && from == 0, openEnd = toArg == null && to == lineLen;\n      var first = i == 0, last = !order || i == order.length - 1;\n      if (toPos.top - fromPos.top <= 3) { // Single line\n        var openLeft = (docLTR ? openStart : openEnd) && first;\n        var openRight = (docLTR ? openEnd : openStart) && last;\n        var left = openLeft ? leftSide : (ltr ? fromPos : toPos).left;\n        var right = openRight ? rightSide : (ltr ? toPos : fromPos).right;\n        add(left, fromPos.top, right - left, fromPos.bottom);\n      } else { // Multiple lines\n        var topLeft, topRight, botLeft, botRight;\n        if (ltr) {\n          topLeft = docLTR && openStart && first ? leftSide : fromPos.left;\n          topRight = docLTR ? rightSide : wrapX(from, dir, \"before\");\n          botLeft = docLTR ? leftSide : wrapX(to, dir, \"after\");\n          botRight = docLTR && openEnd && last ? rightSide : toPos.right;\n        } else {\n          topLeft = !docLTR ? leftSide : wrapX(from, dir, \"before\");\n          topRight = !docLTR && openStart && first ? rightSide : fromPos.right;\n          botLeft = !docLTR && openEnd && last ? leftSide : toPos.left;\n          botRight = !docLTR ? rightSide : wrapX(to, dir, \"after\");\n        }\n        add(topLeft, fromPos.top, topRight - topLeft, fromPos.bottom);\n        if (fromPos.bottom < toPos.top) { add(leftSide, fromPos.bottom, null, toPos.top); }\n        add(botLeft, toPos.top, botRight - botLeft, toPos.bottom);\n      }\n\n      if (!start || cmpCoords(fromPos, start) < 0) { start = fromPos; }\n      if (cmpCoords(toPos, start) < 0) { start = toPos; }\n      if (!end || cmpCoords(fromPos, end) < 0) { end = fromPos; }\n      if (cmpCoords(toPos, end) < 0) { end = toPos; }\n    });\n    return {start: start, end: end}\n  }\n\n  var sFrom = range$$1.from(), sTo = range$$1.to();\n  if (sFrom.line == sTo.line) {\n    drawForLine(sFrom.line, sFrom.ch, sTo.ch);\n  } else {\n    var fromLine = getLine(doc, sFrom.line), toLine = getLine(doc, sTo.line);\n    var singleVLine = visualLine(fromLine) == visualLine(toLine);\n    var leftEnd = drawForLine(sFrom.line, sFrom.ch, singleVLine ? fromLine.text.length + 1 : null).end;\n    var rightStart = drawForLine(sTo.line, singleVLine ? 0 : null, sTo.ch).start;\n    if (singleVLine) {\n      if (leftEnd.top < rightStart.top - 2) {\n        add(leftEnd.right, leftEnd.top, null, leftEnd.bottom);\n        add(leftSide, rightStart.top, rightStart.left, rightStart.bottom);\n      } else {\n        add(leftEnd.right, leftEnd.top, rightStart.left - leftEnd.right, leftEnd.bottom);\n      }\n    }\n    if (leftEnd.bottom < rightStart.top)\n      { add(leftSide, leftEnd.bottom, null, rightStart.top); }\n  }\n\n  output.appendChild(fragment);\n}\n\n// Cursor-blinking\nfunction restartBlink(cm) {\n  if (!cm.state.focused) { return }\n  var display = cm.display;\n  clearInterval(display.blinker);\n  var on = true;\n  display.cursorDiv.style.visibility = \"\";\n  if (cm.options.cursorBlinkRate > 0)\n    { display.blinker = setInterval(function () { return display.cursorDiv.style.visibility = (on = !on) ? \"\" : \"hidden\"; },\n      cm.options.cursorBlinkRate); }\n  else if (cm.options.cursorBlinkRate < 0)\n    { display.cursorDiv.style.visibility = \"hidden\"; }\n}\n\nfunction ensureFocus(cm) {\n  if (!cm.state.focused) { cm.display.input.focus(); onFocus(cm); }\n}\n\nfunction delayBlurEvent(cm) {\n  cm.state.delayingBlurEvent = true;\n  setTimeout(function () { if (cm.state.delayingBlurEvent) {\n    cm.state.delayingBlurEvent = false;\n    onBlur(cm);\n  } }, 100);\n}\n\nfunction onFocus(cm, e) {\n  if (cm.state.delayingBlurEvent) { cm.state.delayingBlurEvent = false; }\n\n  if (cm.options.readOnly == \"nocursor\") { return }\n  if (!cm.state.focused) {\n    signal(cm, \"focus\", cm, e);\n    cm.state.focused = true;\n    addClass(cm.display.wrapper, \"CodeMirror-focused\");\n    // This test prevents this from firing when a context\n    // menu is closed (since the input reset would kill the\n    // select-all detection hack)\n    if (!cm.curOp && cm.display.selForContextMenu != cm.doc.sel) {\n      cm.display.input.reset();\n      if (webkit) { setTimeout(function () { return cm.display.input.reset(true); }, 20); } // Issue #1730\n    }\n    cm.display.input.receivedFocus();\n  }\n  restartBlink(cm);\n}\nfunction onBlur(cm, e) {\n  if (cm.state.delayingBlurEvent) { return }\n\n  if (cm.state.focused) {\n    signal(cm, \"blur\", cm, e);\n    cm.state.focused = false;\n    rmClass(cm.display.wrapper, \"CodeMirror-focused\");\n  }\n  clearInterval(cm.display.blinker);\n  setTimeout(function () { if (!cm.state.focused) { cm.display.shift = false; } }, 150);\n}\n\n// Read the actual heights of the rendered lines, and update their\n// stored heights to match.\nfunction updateHeightsInViewport(cm) {\n  var display = cm.display;\n  var prevBottom = display.lineDiv.offsetTop;\n  for (var i = 0; i < display.view.length; i++) {\n    var cur = display.view[i], height = (void 0);\n    if (cur.hidden) { continue }\n    if (ie && ie_version < 8) {\n      var bot = cur.node.offsetTop + cur.node.offsetHeight;\n      height = bot - prevBottom;\n      prevBottom = bot;\n    } else {\n      var box = cur.node.getBoundingClientRect();\n      height = box.bottom - box.top;\n    }\n    var diff = cur.line.height - height;\n    if (height < 2) { height = textHeight(display); }\n    if (diff > .005 || diff < -.005) {\n      updateLineHeight(cur.line, height);\n      updateWidgetHeight(cur.line);\n      if (cur.rest) { for (var j = 0; j < cur.rest.length; j++)\n        { updateWidgetHeight(cur.rest[j]); } }\n    }\n  }\n}\n\n// Read and store the height of line widgets associated with the\n// given line.\nfunction updateWidgetHeight(line) {\n  if (line.widgets) { for (var i = 0; i < line.widgets.length; ++i) {\n    var w = line.widgets[i], parent = w.node.parentNode;\n    if (parent) { w.height = parent.offsetHeight; }\n  } }\n}\n\n// Compute the lines that are visible in a given viewport (defaults\n// the the current scroll position). viewport may contain top,\n// height, and ensure (see op.scrollToPos) properties.\nfunction visibleLines(display, doc, viewport) {\n  var top = viewport && viewport.top != null ? Math.max(0, viewport.top) : display.scroller.scrollTop;\n  top = Math.floor(top - paddingTop(display));\n  var bottom = viewport && viewport.bottom != null ? viewport.bottom : top + display.wrapper.clientHeight;\n\n  var from = lineAtHeight(doc, top), to = lineAtHeight(doc, bottom);\n  // Ensure is a {from: {line, ch}, to: {line, ch}} object, and\n  // forces those lines into the viewport (if possible).\n  if (viewport && viewport.ensure) {\n    var ensureFrom = viewport.ensure.from.line, ensureTo = viewport.ensure.to.line;\n    if (ensureFrom < from) {\n      from = ensureFrom;\n      to = lineAtHeight(doc, heightAtLine(getLine(doc, ensureFrom)) + display.wrapper.clientHeight);\n    } else if (Math.min(ensureTo, doc.lastLine()) >= to) {\n      from = lineAtHeight(doc, heightAtLine(getLine(doc, ensureTo)) - display.wrapper.clientHeight);\n      to = ensureTo;\n    }\n  }\n  return {from: from, to: Math.max(to, from + 1)}\n}\n\n// Re-align line numbers and gutter marks to compensate for\n// horizontal scrolling.\nfunction alignHorizontally(cm) {\n  var display = cm.display, view = display.view;\n  if (!display.alignWidgets && (!display.gutters.firstChild || !cm.options.fixedGutter)) { return }\n  var comp = compensateForHScroll(display) - display.scroller.scrollLeft + cm.doc.scrollLeft;\n  var gutterW = display.gutters.offsetWidth, left = comp + \"px\";\n  for (var i = 0; i < view.length; i++) { if (!view[i].hidden) {\n    if (cm.options.fixedGutter) {\n      if (view[i].gutter)\n        { view[i].gutter.style.left = left; }\n      if (view[i].gutterBackground)\n        { view[i].gutterBackground.style.left = left; }\n    }\n    var align = view[i].alignable;\n    if (align) { for (var j = 0; j < align.length; j++)\n      { align[j].style.left = left; } }\n  } }\n  if (cm.options.fixedGutter)\n    { display.gutters.style.left = (comp + gutterW) + \"px\"; }\n}\n\n// Used to ensure that the line number gutter is still the right\n// size for the current document size. Returns true when an update\n// is needed.\nfunction maybeUpdateLineNumberWidth(cm) {\n  if (!cm.options.lineNumbers) { return false }\n  var doc = cm.doc, last = lineNumberFor(cm.options, doc.first + doc.size - 1), display = cm.display;\n  if (last.length != display.lineNumChars) {\n    var test = display.measure.appendChild(elt(\"div\", [elt(\"div\", last)],\n                                               \"CodeMirror-linenumber CodeMirror-gutter-elt\"));\n    var innerW = test.firstChild.offsetWidth, padding = test.offsetWidth - innerW;\n    display.lineGutter.style.width = \"\";\n    display.lineNumInnerWidth = Math.max(innerW, display.lineGutter.offsetWidth - padding) + 1;\n    display.lineNumWidth = display.lineNumInnerWidth + padding;\n    display.lineNumChars = display.lineNumInnerWidth ? last.length : -1;\n    display.lineGutter.style.width = display.lineNumWidth + \"px\";\n    updateGutterSpace(cm);\n    return true\n  }\n  return false\n}\n\n// SCROLLING THINGS INTO VIEW\n\n// If an editor sits on the top or bottom of the window, partially\n// scrolled out of view, this ensures that the cursor is visible.\nfunction maybeScrollWindow(cm, rect) {\n  if (signalDOMEvent(cm, \"scrollCursorIntoView\")) { return }\n\n  var display = cm.display, box = display.sizer.getBoundingClientRect(), doScroll = null;\n  if (rect.top + box.top < 0) { doScroll = true; }\n  else if (rect.bottom + box.top > (window.innerHeight || document.documentElement.clientHeight)) { doScroll = false; }\n  if (doScroll != null && !phantom) {\n    var scrollNode = elt(\"div\", \"\\u200b\", null, (\"position: absolute;\\n                         top: \" + (rect.top - display.viewOffset - paddingTop(cm.display)) + \"px;\\n                         height: \" + (rect.bottom - rect.top + scrollGap(cm) + display.barHeight) + \"px;\\n                         left: \" + (rect.left) + \"px; width: \" + (Math.max(2, rect.right - rect.left)) + \"px;\"));\n    cm.display.lineSpace.appendChild(scrollNode);\n    scrollNode.scrollIntoView(doScroll);\n    cm.display.lineSpace.removeChild(scrollNode);\n  }\n}\n\n// Scroll a given position into view (immediately), verifying that\n// it actually became visible (as line heights are accurately\n// measured, the position of something may 'drift' during drawing).\nfunction scrollPosIntoView(cm, pos, end, margin) {\n  if (margin == null) { margin = 0; }\n  var rect;\n  if (!cm.options.lineWrapping && pos == end) {\n    // Set pos and end to the cursor positions around the character pos sticks to\n    // If pos.sticky == \"before\", that is around pos.ch - 1, otherwise around pos.ch\n    // If pos == Pos(_, 0, \"before\"), pos and end are unchanged\n    pos = pos.ch ? Pos(pos.line, pos.sticky == \"before\" ? pos.ch - 1 : pos.ch, \"after\") : pos;\n    end = pos.sticky == \"before\" ? Pos(pos.line, pos.ch + 1, \"before\") : pos;\n  }\n  for (var limit = 0; limit < 5; limit++) {\n    var changed = false;\n    var coords = cursorCoords(cm, pos);\n    var endCoords = !end || end == pos ? coords : cursorCoords(cm, end);\n    rect = {left: Math.min(coords.left, endCoords.left),\n            top: Math.min(coords.top, endCoords.top) - margin,\n            right: Math.max(coords.left, endCoords.left),\n            bottom: Math.max(coords.bottom, endCoords.bottom) + margin};\n    var scrollPos = calculateScrollPos(cm, rect);\n    var startTop = cm.doc.scrollTop, startLeft = cm.doc.scrollLeft;\n    if (scrollPos.scrollTop != null) {\n      updateScrollTop(cm, scrollPos.scrollTop);\n      if (Math.abs(cm.doc.scrollTop - startTop) > 1) { changed = true; }\n    }\n    if (scrollPos.scrollLeft != null) {\n      setScrollLeft(cm, scrollPos.scrollLeft);\n      if (Math.abs(cm.doc.scrollLeft - startLeft) > 1) { changed = true; }\n    }\n    if (!changed) { break }\n  }\n  return rect\n}\n\n// Scroll a given set of coordinates into view (immediately).\nfunction scrollIntoView(cm, rect) {\n  var scrollPos = calculateScrollPos(cm, rect);\n  if (scrollPos.scrollTop != null) { updateScrollTop(cm, scrollPos.scrollTop); }\n  if (scrollPos.scrollLeft != null) { setScrollLeft(cm, scrollPos.scrollLeft); }\n}\n\n// Calculate a new scroll position needed to scroll the given\n// rectangle into view. Returns an object with scrollTop and\n// scrollLeft properties. When these are undefined, the\n// vertical/horizontal position does not need to be adjusted.\nfunction calculateScrollPos(cm, rect) {\n  var display = cm.display, snapMargin = textHeight(cm.display);\n  if (rect.top < 0) { rect.top = 0; }\n  var screentop = cm.curOp && cm.curOp.scrollTop != null ? cm.curOp.scrollTop : display.scroller.scrollTop;\n  var screen = displayHeight(cm), result = {};\n  if (rect.bottom - rect.top > screen) { rect.bottom = rect.top + screen; }\n  var docBottom = cm.doc.height + paddingVert(display);\n  var atTop = rect.top < snapMargin, atBottom = rect.bottom > docBottom - snapMargin;\n  if (rect.top < screentop) {\n    result.scrollTop = atTop ? 0 : rect.top;\n  } else if (rect.bottom > screentop + screen) {\n    var newTop = Math.min(rect.top, (atBottom ? docBottom : rect.bottom) - screen);\n    if (newTop != screentop) { result.scrollTop = newTop; }\n  }\n\n  var screenleft = cm.curOp && cm.curOp.scrollLeft != null ? cm.curOp.scrollLeft : display.scroller.scrollLeft;\n  var screenw = displayWidth(cm) - (cm.options.fixedGutter ? display.gutters.offsetWidth : 0);\n  var tooWide = rect.right - rect.left > screenw;\n  if (tooWide) { rect.right = rect.left + screenw; }\n  if (rect.left < 10)\n    { result.scrollLeft = 0; }\n  else if (rect.left < screenleft)\n    { result.scrollLeft = Math.max(0, rect.left - (tooWide ? 0 : 10)); }\n  else if (rect.right > screenw + screenleft - 3)\n    { result.scrollLeft = rect.right + (tooWide ? 0 : 10) - screenw; }\n  return result\n}\n\n// Store a relative adjustment to the scroll position in the current\n// operation (to be applied when the operation finishes).\nfunction addToScrollTop(cm, top) {\n  if (top == null) { return }\n  resolveScrollToPos(cm);\n  cm.curOp.scrollTop = (cm.curOp.scrollTop == null ? cm.doc.scrollTop : cm.curOp.scrollTop) + top;\n}\n\n// Make sure that at the end of the operation the current cursor is\n// shown.\nfunction ensureCursorVisible(cm) {\n  resolveScrollToPos(cm);\n  var cur = cm.getCursor();\n  cm.curOp.scrollToPos = {from: cur, to: cur, margin: cm.options.cursorScrollMargin};\n}\n\nfunction scrollToCoords(cm, x, y) {\n  if (x != null || y != null) { resolveScrollToPos(cm); }\n  if (x != null) { cm.curOp.scrollLeft = x; }\n  if (y != null) { cm.curOp.scrollTop = y; }\n}\n\nfunction scrollToRange(cm, range$$1) {\n  resolveScrollToPos(cm);\n  cm.curOp.scrollToPos = range$$1;\n}\n\n// When an operation has its scrollToPos property set, and another\n// scroll action is applied before the end of the operation, this\n// 'simulates' scrolling that position into view in a cheap way, so\n// that the effect of intermediate scroll commands is not ignored.\nfunction resolveScrollToPos(cm) {\n  var range$$1 = cm.curOp.scrollToPos;\n  if (range$$1) {\n    cm.curOp.scrollToPos = null;\n    var from = estimateCoords(cm, range$$1.from), to = estimateCoords(cm, range$$1.to);\n    scrollToCoordsRange(cm, from, to, range$$1.margin);\n  }\n}\n\nfunction scrollToCoordsRange(cm, from, to, margin) {\n  var sPos = calculateScrollPos(cm, {\n    left: Math.min(from.left, to.left),\n    top: Math.min(from.top, to.top) - margin,\n    right: Math.max(from.right, to.right),\n    bottom: Math.max(from.bottom, to.bottom) + margin\n  });\n  scrollToCoords(cm, sPos.scrollLeft, sPos.scrollTop);\n}\n\n// Sync the scrollable area and scrollbars, ensure the viewport\n// covers the visible area.\nfunction updateScrollTop(cm, val) {\n  if (Math.abs(cm.doc.scrollTop - val) < 2) { return }\n  if (!gecko) { updateDisplaySimple(cm, {top: val}); }\n  setScrollTop(cm, val, true);\n  if (gecko) { updateDisplaySimple(cm); }\n  startWorker(cm, 100);\n}\n\nfunction setScrollTop(cm, val, forceScroll) {\n  val = Math.min(cm.display.scroller.scrollHeight - cm.display.scroller.clientHeight, val);\n  if (cm.display.scroller.scrollTop == val && !forceScroll) { return }\n  cm.doc.scrollTop = val;\n  cm.display.scrollbars.setScrollTop(val);\n  if (cm.display.scroller.scrollTop != val) { cm.display.scroller.scrollTop = val; }\n}\n\n// Sync scroller and scrollbar, ensure the gutter elements are\n// aligned.\nfunction setScrollLeft(cm, val, isScroller, forceScroll) {\n  val = Math.min(val, cm.display.scroller.scrollWidth - cm.display.scroller.clientWidth);\n  if ((isScroller ? val == cm.doc.scrollLeft : Math.abs(cm.doc.scrollLeft - val) < 2) && !forceScroll) { return }\n  cm.doc.scrollLeft = val;\n  alignHorizontally(cm);\n  if (cm.display.scroller.scrollLeft != val) { cm.display.scroller.scrollLeft = val; }\n  cm.display.scrollbars.setScrollLeft(val);\n}\n\n// SCROLLBARS\n\n// Prepare DOM reads needed to update the scrollbars. Done in one\n// shot to minimize update/measure roundtrips.\nfunction measureForScrollbars(cm) {\n  var d = cm.display, gutterW = d.gutters.offsetWidth;\n  var docH = Math.round(cm.doc.height + paddingVert(cm.display));\n  return {\n    clientHeight: d.scroller.clientHeight,\n    viewHeight: d.wrapper.clientHeight,\n    scrollWidth: d.scroller.scrollWidth, clientWidth: d.scroller.clientWidth,\n    viewWidth: d.wrapper.clientWidth,\n    barLeft: cm.options.fixedGutter ? gutterW : 0,\n    docHeight: docH,\n    scrollHeight: docH + scrollGap(cm) + d.barHeight,\n    nativeBarWidth: d.nativeBarWidth,\n    gutterWidth: gutterW\n  }\n}\n\nvar NativeScrollbars = function(place, scroll, cm) {\n  this.cm = cm;\n  var vert = this.vert = elt(\"div\", [elt(\"div\", null, null, \"min-width: 1px\")], \"CodeMirror-vscrollbar\");\n  var horiz = this.horiz = elt(\"div\", [elt(\"div\", null, null, \"height: 100%; min-height: 1px\")], \"CodeMirror-hscrollbar\");\n  place(vert); place(horiz);\n\n  on(vert, \"scroll\", function () {\n    if (vert.clientHeight) { scroll(vert.scrollTop, \"vertical\"); }\n  });\n  on(horiz, \"scroll\", function () {\n    if (horiz.clientWidth) { scroll(horiz.scrollLeft, \"horizontal\"); }\n  });\n\n  this.checkedZeroWidth = false;\n  // Need to set a minimum width to see the scrollbar on IE7 (but must not set it on IE8).\n  if (ie && ie_version < 8) { this.horiz.style.minHeight = this.vert.style.minWidth = \"18px\"; }\n};\n\nNativeScrollbars.prototype.update = function (measure) {\n  var needsH = measure.scrollWidth > measure.clientWidth + 1;\n  var needsV = measure.scrollHeight > measure.clientHeight + 1;\n  var sWidth = measure.nativeBarWidth;\n\n  if (needsV) {\n    this.vert.style.display = \"block\";\n    this.vert.style.bottom = needsH ? sWidth + \"px\" : \"0\";\n    var totalHeight = measure.viewHeight - (needsH ? sWidth : 0);\n    // A bug in IE8 can cause this value to be negative, so guard it.\n    this.vert.firstChild.style.height =\n      Math.max(0, measure.scrollHeight - measure.clientHeight + totalHeight) + \"px\";\n  } else {\n    this.vert.style.display = \"\";\n    this.vert.firstChild.style.height = \"0\";\n  }\n\n  if (needsH) {\n    this.horiz.style.display = \"block\";\n    this.horiz.style.right = needsV ? sWidth + \"px\" : \"0\";\n    this.horiz.style.left = measure.barLeft + \"px\";\n    var totalWidth = measure.viewWidth - measure.barLeft - (needsV ? sWidth : 0);\n    this.horiz.firstChild.style.width =\n      Math.max(0, measure.scrollWidth - measure.clientWidth + totalWidth) + \"px\";\n  } else {\n    this.horiz.style.display = \"\";\n    this.horiz.firstChild.style.width = \"0\";\n  }\n\n  if (!this.checkedZeroWidth && measure.clientHeight > 0) {\n    if (sWidth == 0) { this.zeroWidthHack(); }\n    this.checkedZeroWidth = true;\n  }\n\n  return {right: needsV ? sWidth : 0, bottom: needsH ? sWidth : 0}\n};\n\nNativeScrollbars.prototype.setScrollLeft = function (pos) {\n  if (this.horiz.scrollLeft != pos) { this.horiz.scrollLeft = pos; }\n  if (this.disableHoriz) { this.enableZeroWidthBar(this.horiz, this.disableHoriz, \"horiz\"); }\n};\n\nNativeScrollbars.prototype.setScrollTop = function (pos) {\n  if (this.vert.scrollTop != pos) { this.vert.scrollTop = pos; }\n  if (this.disableVert) { this.enableZeroWidthBar(this.vert, this.disableVert, \"vert\"); }\n};\n\nNativeScrollbars.prototype.zeroWidthHack = function () {\n  var w = mac && !mac_geMountainLion ? \"12px\" : \"18px\";\n  this.horiz.style.height = this.vert.style.width = w;\n  this.horiz.style.pointerEvents = this.vert.style.pointerEvents = \"none\";\n  this.disableHoriz = new Delayed;\n  this.disableVert = new Delayed;\n};\n\nNativeScrollbars.prototype.enableZeroWidthBar = function (bar, delay, type) {\n  bar.style.pointerEvents = \"auto\";\n  function maybeDisable() {\n    // To find out whether the scrollbar is still visible, we\n    // check whether the element under the pixel in the bottom\n    // right corner of the scrollbar box is the scrollbar box\n    // itself (when the bar is still visible) or its filler child\n    // (when the bar is hidden). If it is still visible, we keep\n    // it enabled, if it's hidden, we disable pointer events.\n    var box = bar.getBoundingClientRect();\n    var elt$$1 = type == \"vert\" ? document.elementFromPoint(box.right - 1, (box.top + box.bottom) / 2)\n        : document.elementFromPoint((box.right + box.left) / 2, box.bottom - 1);\n    if (elt$$1 != bar) { bar.style.pointerEvents = \"none\"; }\n    else { delay.set(1000, maybeDisable); }\n  }\n  delay.set(1000, maybeDisable);\n};\n\nNativeScrollbars.prototype.clear = function () {\n  var parent = this.horiz.parentNode;\n  parent.removeChild(this.horiz);\n  parent.removeChild(this.vert);\n};\n\nvar NullScrollbars = function () {};\n\nNullScrollbars.prototype.update = function () { return {bottom: 0, right: 0} };\nNullScrollbars.prototype.setScrollLeft = function () {};\nNullScrollbars.prototype.setScrollTop = function () {};\nNullScrollbars.prototype.clear = function () {};\n\nfunction updateScrollbars(cm, measure) {\n  if (!measure) { measure = measureForScrollbars(cm); }\n  var startWidth = cm.display.barWidth, startHeight = cm.display.barHeight;\n  updateScrollbarsInner(cm, measure);\n  for (var i = 0; i < 4 && startWidth != cm.display.barWidth || startHeight != cm.display.barHeight; i++) {\n    if (startWidth != cm.display.barWidth && cm.options.lineWrapping)\n      { updateHeightsInViewport(cm); }\n    updateScrollbarsInner(cm, measureForScrollbars(cm));\n    startWidth = cm.display.barWidth; startHeight = cm.display.barHeight;\n  }\n}\n\n// Re-synchronize the fake scrollbars with the actual size of the\n// content.\nfunction updateScrollbarsInner(cm, measure) {\n  var d = cm.display;\n  var sizes = d.scrollbars.update(measure);\n\n  d.sizer.style.paddingRight = (d.barWidth = sizes.right) + \"px\";\n  d.sizer.style.paddingBottom = (d.barHeight = sizes.bottom) + \"px\";\n  d.heightForcer.style.borderBottom = sizes.bottom + \"px solid transparent\";\n\n  if (sizes.right && sizes.bottom) {\n    d.scrollbarFiller.style.display = \"block\";\n    d.scrollbarFiller.style.height = sizes.bottom + \"px\";\n    d.scrollbarFiller.style.width = sizes.right + \"px\";\n  } else { d.scrollbarFiller.style.display = \"\"; }\n  if (sizes.bottom && cm.options.coverGutterNextToScrollbar && cm.options.fixedGutter) {\n    d.gutterFiller.style.display = \"block\";\n    d.gutterFiller.style.height = sizes.bottom + \"px\";\n    d.gutterFiller.style.width = measure.gutterWidth + \"px\";\n  } else { d.gutterFiller.style.display = \"\"; }\n}\n\nvar scrollbarModel = {\"native\": NativeScrollbars, \"null\": NullScrollbars};\n\nfunction initScrollbars(cm) {\n  if (cm.display.scrollbars) {\n    cm.display.scrollbars.clear();\n    if (cm.display.scrollbars.addClass)\n      { rmClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n  }\n\n  cm.display.scrollbars = new scrollbarModel[cm.options.scrollbarStyle](function (node) {\n    cm.display.wrapper.insertBefore(node, cm.display.scrollbarFiller);\n    // Prevent clicks in the scrollbars from killing focus\n    on(node, \"mousedown\", function () {\n      if (cm.state.focused) { setTimeout(function () { return cm.display.input.focus(); }, 0); }\n    });\n    node.setAttribute(\"cm-not-content\", \"true\");\n  }, function (pos, axis) {\n    if (axis == \"horizontal\") { setScrollLeft(cm, pos); }\n    else { updateScrollTop(cm, pos); }\n  }, cm);\n  if (cm.display.scrollbars.addClass)\n    { addClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n}\n\n// Operations are used to wrap a series of changes to the editor\n// state in such a way that each change won't have to update the\n// cursor and display (which would be awkward, slow, and\n// error-prone). Instead, display updates are batched and then all\n// combined and executed at once.\n\nvar nextOpId = 0;\n// Start a new operation.\nfunction startOperation(cm) {\n  cm.curOp = {\n    cm: cm,\n    viewChanged: false,      // Flag that indicates that lines might need to be redrawn\n    startHeight: cm.doc.height, // Used to detect need to update scrollbar\n    forceUpdate: false,      // Used to force a redraw\n    updateInput: null,       // Whether to reset the input textarea\n    typing: false,           // Whether this reset should be careful to leave existing text (for compositing)\n    changeObjs: null,        // Accumulated changes, for firing change events\n    cursorActivityHandlers: null, // Set of handlers to fire cursorActivity on\n    cursorActivityCalled: 0, // Tracks which cursorActivity handlers have been called already\n    selectionChanged: false, // Whether the selection needs to be redrawn\n    updateMaxLine: false,    // Set when the widest line needs to be determined anew\n    scrollLeft: null, scrollTop: null, // Intermediate scroll position, not pushed to DOM yet\n    scrollToPos: null,       // Used to scroll to a specific position\n    focus: false,\n    id: ++nextOpId           // Unique ID\n  };\n  pushOperation(cm.curOp);\n}\n\n// Finish an operation, updating the display and signalling delayed events\nfunction endOperation(cm) {\n  var op = cm.curOp;\n  finishOperation(op, function (group) {\n    for (var i = 0; i < group.ops.length; i++)\n      { group.ops[i].cm.curOp = null; }\n    endOperations(group);\n  });\n}\n\n// The DOM updates done when an operation finishes are batched so\n// that the minimum number of relayouts are required.\nfunction endOperations(group) {\n  var ops = group.ops;\n  for (var i = 0; i < ops.length; i++) // Read DOM\n    { endOperation_R1(ops[i]); }\n  for (var i$1 = 0; i$1 < ops.length; i$1++) // Write DOM (maybe)\n    { endOperation_W1(ops[i$1]); }\n  for (var i$2 = 0; i$2 < ops.length; i$2++) // Read DOM\n    { endOperation_R2(ops[i$2]); }\n  for (var i$3 = 0; i$3 < ops.length; i$3++) // Write DOM (maybe)\n    { endOperation_W2(ops[i$3]); }\n  for (var i$4 = 0; i$4 < ops.length; i$4++) // Read DOM\n    { endOperation_finish(ops[i$4]); }\n}\n\nfunction endOperation_R1(op) {\n  var cm = op.cm, display = cm.display;\n  maybeClipScrollbars(cm);\n  if (op.updateMaxLine) { findMaxLine(cm); }\n\n  op.mustUpdate = op.viewChanged || op.forceUpdate || op.scrollTop != null ||\n    op.scrollToPos && (op.scrollToPos.from.line < display.viewFrom ||\n                       op.scrollToPos.to.line >= display.viewTo) ||\n    display.maxLineChanged && cm.options.lineWrapping;\n  op.update = op.mustUpdate &&\n    new DisplayUpdate(cm, op.mustUpdate && {top: op.scrollTop, ensure: op.scrollToPos}, op.forceUpdate);\n}\n\nfunction endOperation_W1(op) {\n  op.updatedDisplay = op.mustUpdate && updateDisplayIfNeeded(op.cm, op.update);\n}\n\nfunction endOperation_R2(op) {\n  var cm = op.cm, display = cm.display;\n  if (op.updatedDisplay) { updateHeightsInViewport(cm); }\n\n  op.barMeasure = measureForScrollbars(cm);\n\n  // If the max line changed since it was last measured, measure it,\n  // and ensure the document's width matches it.\n  // updateDisplay_W2 will use these properties to do the actual resizing\n  if (display.maxLineChanged && !cm.options.lineWrapping) {\n    op.adjustWidthTo = measureChar(cm, display.maxLine, display.maxLine.text.length).left + 3;\n    cm.display.sizerWidth = op.adjustWidthTo;\n    op.barMeasure.scrollWidth =\n      Math.max(display.scroller.clientWidth, display.sizer.offsetLeft + op.adjustWidthTo + scrollGap(cm) + cm.display.barWidth);\n    op.maxScrollLeft = Math.max(0, display.sizer.offsetLeft + op.adjustWidthTo - displayWidth(cm));\n  }\n\n  if (op.updatedDisplay || op.selectionChanged)\n    { op.preparedSelection = display.input.prepareSelection(); }\n}\n\nfunction endOperation_W2(op) {\n  var cm = op.cm;\n\n  if (op.adjustWidthTo != null) {\n    cm.display.sizer.style.minWidth = op.adjustWidthTo + \"px\";\n    if (op.maxScrollLeft < cm.doc.scrollLeft)\n      { setScrollLeft(cm, Math.min(cm.display.scroller.scrollLeft, op.maxScrollLeft), true); }\n    cm.display.maxLineChanged = false;\n  }\n\n  var takeFocus = op.focus && op.focus == activeElt();\n  if (op.preparedSelection)\n    { cm.display.input.showSelection(op.preparedSelection, takeFocus); }\n  if (op.updatedDisplay || op.startHeight != cm.doc.height)\n    { updateScrollbars(cm, op.barMeasure); }\n  if (op.updatedDisplay)\n    { setDocumentHeight(cm, op.barMeasure); }\n\n  if (op.selectionChanged) { restartBlink(cm); }\n\n  if (cm.state.focused && op.updateInput)\n    { cm.display.input.reset(op.typing); }\n  if (takeFocus) { ensureFocus(op.cm); }\n}\n\nfunction endOperation_finish(op) {\n  var cm = op.cm, display = cm.display, doc = cm.doc;\n\n  if (op.updatedDisplay) { postUpdateDisplay(cm, op.update); }\n\n  // Abort mouse wheel delta measurement, when scrolling explicitly\n  if (display.wheelStartX != null && (op.scrollTop != null || op.scrollLeft != null || op.scrollToPos))\n    { display.wheelStartX = display.wheelStartY = null; }\n\n  // Propagate the scroll position to the actual DOM scroller\n  if (op.scrollTop != null) { setScrollTop(cm, op.scrollTop, op.forceScroll); }\n\n  if (op.scrollLeft != null) { setScrollLeft(cm, op.scrollLeft, true, true); }\n  // If we need to scroll a specific position into view, do so.\n  if (op.scrollToPos) {\n    var rect = scrollPosIntoView(cm, clipPos(doc, op.scrollToPos.from),\n                                 clipPos(doc, op.scrollToPos.to), op.scrollToPos.margin);\n    maybeScrollWindow(cm, rect);\n  }\n\n  // Fire events for markers that are hidden/unidden by editing or\n  // undoing\n  var hidden = op.maybeHiddenMarkers, unhidden = op.maybeUnhiddenMarkers;\n  if (hidden) { for (var i = 0; i < hidden.length; ++i)\n    { if (!hidden[i].lines.length) { signal(hidden[i], \"hide\"); } } }\n  if (unhidden) { for (var i$1 = 0; i$1 < unhidden.length; ++i$1)\n    { if (unhidden[i$1].lines.length) { signal(unhidden[i$1], \"unhide\"); } } }\n\n  if (display.wrapper.offsetHeight)\n    { doc.scrollTop = cm.display.scroller.scrollTop; }\n\n  // Fire change events, and delayed event handlers\n  if (op.changeObjs)\n    { signal(cm, \"changes\", cm, op.changeObjs); }\n  if (op.update)\n    { op.update.finish(); }\n}\n\n// Run the given function in an operation\nfunction runInOp(cm, f) {\n  if (cm.curOp) { return f() }\n  startOperation(cm);\n  try { return f() }\n  finally { endOperation(cm); }\n}\n// Wraps a function in an operation. Returns the wrapped function.\nfunction operation(cm, f) {\n  return function() {\n    if (cm.curOp) { return f.apply(cm, arguments) }\n    startOperation(cm);\n    try { return f.apply(cm, arguments) }\n    finally { endOperation(cm); }\n  }\n}\n// Used to add methods to editor and doc instances, wrapping them in\n// operations.\nfunction methodOp(f) {\n  return function() {\n    if (this.curOp) { return f.apply(this, arguments) }\n    startOperation(this);\n    try { return f.apply(this, arguments) }\n    finally { endOperation(this); }\n  }\n}\nfunction docMethodOp(f) {\n  return function() {\n    var cm = this.cm;\n    if (!cm || cm.curOp) { return f.apply(this, arguments) }\n    startOperation(cm);\n    try { return f.apply(this, arguments) }\n    finally { endOperation(cm); }\n  }\n}\n\n// Updates the display.view data structure for a given change to the\n// document. From and to are in pre-change coordinates. Lendiff is\n// the amount of lines added or subtracted by the change. This is\n// used for changes that span multiple lines, or change the way\n// lines are divided into visual lines. regLineChange (below)\n// registers single-line changes.\nfunction regChange(cm, from, to, lendiff) {\n  if (from == null) { from = cm.doc.first; }\n  if (to == null) { to = cm.doc.first + cm.doc.size; }\n  if (!lendiff) { lendiff = 0; }\n\n  var display = cm.display;\n  if (lendiff && to < display.viewTo &&\n      (display.updateLineNumbers == null || display.updateLineNumbers > from))\n    { display.updateLineNumbers = from; }\n\n  cm.curOp.viewChanged = true;\n\n  if (from >= display.viewTo) { // Change after\n    if (sawCollapsedSpans && visualLineNo(cm.doc, from) < display.viewTo)\n      { resetView(cm); }\n  } else if (to <= display.viewFrom) { // Change before\n    if (sawCollapsedSpans && visualLineEndNo(cm.doc, to + lendiff) > display.viewFrom) {\n      resetView(cm);\n    } else {\n      display.viewFrom += lendiff;\n      display.viewTo += lendiff;\n    }\n  } else if (from <= display.viewFrom && to >= display.viewTo) { // Full overlap\n    resetView(cm);\n  } else if (from <= display.viewFrom) { // Top overlap\n    var cut = viewCuttingPoint(cm, to, to + lendiff, 1);\n    if (cut) {\n      display.view = display.view.slice(cut.index);\n      display.viewFrom = cut.lineN;\n      display.viewTo += lendiff;\n    } else {\n      resetView(cm);\n    }\n  } else if (to >= display.viewTo) { // Bottom overlap\n    var cut$1 = viewCuttingPoint(cm, from, from, -1);\n    if (cut$1) {\n      display.view = display.view.slice(0, cut$1.index);\n      display.viewTo = cut$1.lineN;\n    } else {\n      resetView(cm);\n    }\n  } else { // Gap in the middle\n    var cutTop = viewCuttingPoint(cm, from, from, -1);\n    var cutBot = viewCuttingPoint(cm, to, to + lendiff, 1);\n    if (cutTop && cutBot) {\n      display.view = display.view.slice(0, cutTop.index)\n        .concat(buildViewArray(cm, cutTop.lineN, cutBot.lineN))\n        .concat(display.view.slice(cutBot.index));\n      display.viewTo += lendiff;\n    } else {\n      resetView(cm);\n    }\n  }\n\n  var ext = display.externalMeasured;\n  if (ext) {\n    if (to < ext.lineN)\n      { ext.lineN += lendiff; }\n    else if (from < ext.lineN + ext.size)\n      { display.externalMeasured = null; }\n  }\n}\n\n// Register a change to a single line. Type must be one of \"text\",\n// \"gutter\", \"class\", \"widget\"\nfunction regLineChange(cm, line, type) {\n  cm.curOp.viewChanged = true;\n  var display = cm.display, ext = cm.display.externalMeasured;\n  if (ext && line >= ext.lineN && line < ext.lineN + ext.size)\n    { display.externalMeasured = null; }\n\n  if (line < display.viewFrom || line >= display.viewTo) { return }\n  var lineView = display.view[findViewIndex(cm, line)];\n  if (lineView.node == null) { return }\n  var arr = lineView.changes || (lineView.changes = []);\n  if (indexOf(arr, type) == -1) { arr.push(type); }\n}\n\n// Clear the view.\nfunction resetView(cm) {\n  cm.display.viewFrom = cm.display.viewTo = cm.doc.first;\n  cm.display.view = [];\n  cm.display.viewOffset = 0;\n}\n\nfunction viewCuttingPoint(cm, oldN, newN, dir) {\n  var index = findViewIndex(cm, oldN), diff, view = cm.display.view;\n  if (!sawCollapsedSpans || newN == cm.doc.first + cm.doc.size)\n    { return {index: index, lineN: newN} }\n  var n = cm.display.viewFrom;\n  for (var i = 0; i < index; i++)\n    { n += view[i].size; }\n  if (n != oldN) {\n    if (dir > 0) {\n      if (index == view.length - 1) { return null }\n      diff = (n + view[index].size) - oldN;\n      index++;\n    } else {\n      diff = n - oldN;\n    }\n    oldN += diff; newN += diff;\n  }\n  while (visualLineNo(cm.doc, newN) != newN) {\n    if (index == (dir < 0 ? 0 : view.length - 1)) { return null }\n    newN += dir * view[index - (dir < 0 ? 1 : 0)].size;\n    index += dir;\n  }\n  return {index: index, lineN: newN}\n}\n\n// Force the view to cover a given range, adding empty view element\n// or clipping off existing ones as needed.\nfunction adjustView(cm, from, to) {\n  var display = cm.display, view = display.view;\n  if (view.length == 0 || from >= display.viewTo || to <= display.viewFrom) {\n    display.view = buildViewArray(cm, from, to);\n    display.viewFrom = from;\n  } else {\n    if (display.viewFrom > from)\n      { display.view = buildViewArray(cm, from, display.viewFrom).concat(display.view); }\n    else if (display.viewFrom < from)\n      { display.view = display.view.slice(findViewIndex(cm, from)); }\n    display.viewFrom = from;\n    if (display.viewTo < to)\n      { display.view = display.view.concat(buildViewArray(cm, display.viewTo, to)); }\n    else if (display.viewTo > to)\n      { display.view = display.view.slice(0, findViewIndex(cm, to)); }\n  }\n  display.viewTo = to;\n}\n\n// Count the number of lines in the view whose DOM representation is\n// out of date (or nonexistent).\nfunction countDirtyView(cm) {\n  var view = cm.display.view, dirty = 0;\n  for (var i = 0; i < view.length; i++) {\n    var lineView = view[i];\n    if (!lineView.hidden && (!lineView.node || lineView.changes)) { ++dirty; }\n  }\n  return dirty\n}\n\n// HIGHLIGHT WORKER\n\nfunction startWorker(cm, time) {\n  if (cm.doc.highlightFrontier < cm.display.viewTo)\n    { cm.state.highlight.set(time, bind(highlightWorker, cm)); }\n}\n\nfunction highlightWorker(cm) {\n  var doc = cm.doc;\n  if (doc.highlightFrontier >= cm.display.viewTo) { return }\n  var end = +new Date + cm.options.workTime;\n  var context = getContextBefore(cm, doc.highlightFrontier);\n  var changedLines = [];\n\n  doc.iter(context.line, Math.min(doc.first + doc.size, cm.display.viewTo + 500), function (line) {\n    if (context.line >= cm.display.viewFrom) { // Visible\n      var oldStyles = line.styles;\n      var resetState = line.text.length > cm.options.maxHighlightLength ? copyState(doc.mode, context.state) : null;\n      var highlighted = highlightLine(cm, line, context, true);\n      if (resetState) { context.state = resetState; }\n      line.styles = highlighted.styles;\n      var oldCls = line.styleClasses, newCls = highlighted.classes;\n      if (newCls) { line.styleClasses = newCls; }\n      else if (oldCls) { line.styleClasses = null; }\n      var ischange = !oldStyles || oldStyles.length != line.styles.length ||\n        oldCls != newCls && (!oldCls || !newCls || oldCls.bgClass != newCls.bgClass || oldCls.textClass != newCls.textClass);\n      for (var i = 0; !ischange && i < oldStyles.length; ++i) { ischange = oldStyles[i] != line.styles[i]; }\n      if (ischange) { changedLines.push(context.line); }\n      line.stateAfter = context.save();\n      context.nextLine();\n    } else {\n      if (line.text.length <= cm.options.maxHighlightLength)\n        { processLine(cm, line.text, context); }\n      line.stateAfter = context.line % 5 == 0 ? context.save() : null;\n      context.nextLine();\n    }\n    if (+new Date > end) {\n      startWorker(cm, cm.options.workDelay);\n      return true\n    }\n  });\n  doc.highlightFrontier = context.line;\n  doc.modeFrontier = Math.max(doc.modeFrontier, context.line);\n  if (changedLines.length) { runInOp(cm, function () {\n    for (var i = 0; i < changedLines.length; i++)\n      { regLineChange(cm, changedLines[i], \"text\"); }\n  }); }\n}\n\n// DISPLAY DRAWING\n\nvar DisplayUpdate = function(cm, viewport, force) {\n  var display = cm.display;\n\n  this.viewport = viewport;\n  // Store some values that we'll need later (but don't want to force a relayout for)\n  this.visible = visibleLines(display, cm.doc, viewport);\n  this.editorIsHidden = !display.wrapper.offsetWidth;\n  this.wrapperHeight = display.wrapper.clientHeight;\n  this.wrapperWidth = display.wrapper.clientWidth;\n  this.oldDisplayWidth = displayWidth(cm);\n  this.force = force;\n  this.dims = getDimensions(cm);\n  this.events = [];\n};\n\nDisplayUpdate.prototype.signal = function (emitter, type) {\n  if (hasHandler(emitter, type))\n    { this.events.push(arguments); }\n};\nDisplayUpdate.prototype.finish = function () {\n    var this$1 = this;\n\n  for (var i = 0; i < this.events.length; i++)\n    { signal.apply(null, this$1.events[i]); }\n};\n\nfunction maybeClipScrollbars(cm) {\n  var display = cm.display;\n  if (!display.scrollbarsClipped && display.scroller.offsetWidth) {\n    display.nativeBarWidth = display.scroller.offsetWidth - display.scroller.clientWidth;\n    display.heightForcer.style.height = scrollGap(cm) + \"px\";\n    display.sizer.style.marginBottom = -display.nativeBarWidth + \"px\";\n    display.sizer.style.borderRightWidth = scrollGap(cm) + \"px\";\n    display.scrollbarsClipped = true;\n  }\n}\n\nfunction selectionSnapshot(cm) {\n  if (cm.hasFocus()) { return null }\n  var active = activeElt();\n  if (!active || !contains(cm.display.lineDiv, active)) { return null }\n  var result = {activeElt: active};\n  if (window.getSelection) {\n    var sel = window.getSelection();\n    if (sel.anchorNode && sel.extend && contains(cm.display.lineDiv, sel.anchorNode)) {\n      result.anchorNode = sel.anchorNode;\n      result.anchorOffset = sel.anchorOffset;\n      result.focusNode = sel.focusNode;\n      result.focusOffset = sel.focusOffset;\n    }\n  }\n  return result\n}\n\nfunction restoreSelection(snapshot) {\n  if (!snapshot || !snapshot.activeElt || snapshot.activeElt == activeElt()) { return }\n  snapshot.activeElt.focus();\n  if (snapshot.anchorNode && contains(document.body, snapshot.anchorNode) && contains(document.body, snapshot.focusNode)) {\n    var sel = window.getSelection(), range$$1 = document.createRange();\n    range$$1.setEnd(snapshot.anchorNode, snapshot.anchorOffset);\n    range$$1.collapse(false);\n    sel.removeAllRanges();\n    sel.addRange(range$$1);\n    sel.extend(snapshot.focusNode, snapshot.focusOffset);\n  }\n}\n\n// Does the actual updating of the line display. Bails out\n// (returning false) when there is nothing to be done and forced is\n// false.\nfunction updateDisplayIfNeeded(cm, update) {\n  var display = cm.display, doc = cm.doc;\n\n  if (update.editorIsHidden) {\n    resetView(cm);\n    return false\n  }\n\n  // Bail out if the visible area is already rendered and nothing changed.\n  if (!update.force &&\n      update.visible.from >= display.viewFrom && update.visible.to <= display.viewTo &&\n      (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo) &&\n      display.renderedView == display.view && countDirtyView(cm) == 0)\n    { return false }\n\n  if (maybeUpdateLineNumberWidth(cm)) {\n    resetView(cm);\n    update.dims = getDimensions(cm);\n  }\n\n  // Compute a suitable new viewport (from & to)\n  var end = doc.first + doc.size;\n  var from = Math.max(update.visible.from - cm.options.viewportMargin, doc.first);\n  var to = Math.min(end, update.visible.to + cm.options.viewportMargin);\n  if (display.viewFrom < from && from - display.viewFrom < 20) { from = Math.max(doc.first, display.viewFrom); }\n  if (display.viewTo > to && display.viewTo - to < 20) { to = Math.min(end, display.viewTo); }\n  if (sawCollapsedSpans) {\n    from = visualLineNo(cm.doc, from);\n    to = visualLineEndNo(cm.doc, to);\n  }\n\n  var different = from != display.viewFrom || to != display.viewTo ||\n    display.lastWrapHeight != update.wrapperHeight || display.lastWrapWidth != update.wrapperWidth;\n  adjustView(cm, from, to);\n\n  display.viewOffset = heightAtLine(getLine(cm.doc, display.viewFrom));\n  // Position the mover div to align with the current scroll position\n  cm.display.mover.style.top = display.viewOffset + \"px\";\n\n  var toUpdate = countDirtyView(cm);\n  if (!different && toUpdate == 0 && !update.force && display.renderedView == display.view &&\n      (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo))\n    { return false }\n\n  // For big changes, we hide the enclosing element during the\n  // update, since that speeds up the operations on most browsers.\n  var selSnapshot = selectionSnapshot(cm);\n  if (toUpdate > 4) { display.lineDiv.style.display = \"none\"; }\n  patchDisplay(cm, display.updateLineNumbers, update.dims);\n  if (toUpdate > 4) { display.lineDiv.style.display = \"\"; }\n  display.renderedView = display.view;\n  // There might have been a widget with a focused element that got\n  // hidden or updated, if so re-focus it.\n  restoreSelection(selSnapshot);\n\n  // Prevent selection and cursors from interfering with the scroll\n  // width and height.\n  removeChildren(display.cursorDiv);\n  removeChildren(display.selectionDiv);\n  display.gutters.style.height = display.sizer.style.minHeight = 0;\n\n  if (different) {\n    display.lastWrapHeight = update.wrapperHeight;\n    display.lastWrapWidth = update.wrapperWidth;\n    startWorker(cm, 400);\n  }\n\n  display.updateLineNumbers = null;\n\n  return true\n}\n\nfunction postUpdateDisplay(cm, update) {\n  var viewport = update.viewport;\n\n  for (var first = true;; first = false) {\n    if (!first || !cm.options.lineWrapping || update.oldDisplayWidth == displayWidth(cm)) {\n      // Clip forced viewport to actual scrollable area.\n      if (viewport && viewport.top != null)\n        { viewport = {top: Math.min(cm.doc.height + paddingVert(cm.display) - displayHeight(cm), viewport.top)}; }\n      // Updated line heights might result in the drawn area not\n      // actually covering the viewport. Keep looping until it does.\n      update.visible = visibleLines(cm.display, cm.doc, viewport);\n      if (update.visible.from >= cm.display.viewFrom && update.visible.to <= cm.display.viewTo)\n        { break }\n    }\n    if (!updateDisplayIfNeeded(cm, update)) { break }\n    updateHeightsInViewport(cm);\n    var barMeasure = measureForScrollbars(cm);\n    updateSelection(cm);\n    updateScrollbars(cm, barMeasure);\n    setDocumentHeight(cm, barMeasure);\n    update.force = false;\n  }\n\n  update.signal(cm, \"update\", cm);\n  if (cm.display.viewFrom != cm.display.reportedViewFrom || cm.display.viewTo != cm.display.reportedViewTo) {\n    update.signal(cm, \"viewportChange\", cm, cm.display.viewFrom, cm.display.viewTo);\n    cm.display.reportedViewFrom = cm.display.viewFrom; cm.display.reportedViewTo = cm.display.viewTo;\n  }\n}\n\nfunction updateDisplaySimple(cm, viewport) {\n  var update = new DisplayUpdate(cm, viewport);\n  if (updateDisplayIfNeeded(cm, update)) {\n    updateHeightsInViewport(cm);\n    postUpdateDisplay(cm, update);\n    var barMeasure = measureForScrollbars(cm);\n    updateSelection(cm);\n    updateScrollbars(cm, barMeasure);\n    setDocumentHeight(cm, barMeasure);\n    update.finish();\n  }\n}\n\n// Sync the actual display DOM structure with display.view, removing\n// nodes for lines that are no longer in view, and creating the ones\n// that are not there yet, and updating the ones that are out of\n// date.\nfunction patchDisplay(cm, updateNumbersFrom, dims) {\n  var display = cm.display, lineNumbers = cm.options.lineNumbers;\n  var container = display.lineDiv, cur = container.firstChild;\n\n  function rm(node) {\n    var next = node.nextSibling;\n    // Works around a throw-scroll bug in OS X Webkit\n    if (webkit && mac && cm.display.currentWheelTarget == node)\n      { node.style.display = \"none\"; }\n    else\n      { node.parentNode.removeChild(node); }\n    return next\n  }\n\n  var view = display.view, lineN = display.viewFrom;\n  // Loop over the elements in the view, syncing cur (the DOM nodes\n  // in display.lineDiv) with the view as we go.\n  for (var i = 0; i < view.length; i++) {\n    var lineView = view[i];\n    if (lineView.hidden) {\n    } else if (!lineView.node || lineView.node.parentNode != container) { // Not drawn yet\n      var node = buildLineElement(cm, lineView, lineN, dims);\n      container.insertBefore(node, cur);\n    } else { // Already drawn\n      while (cur != lineView.node) { cur = rm(cur); }\n      var updateNumber = lineNumbers && updateNumbersFrom != null &&\n        updateNumbersFrom <= lineN && lineView.lineNumber;\n      if (lineView.changes) {\n        if (indexOf(lineView.changes, \"gutter\") > -1) { updateNumber = false; }\n        updateLineForChanges(cm, lineView, lineN, dims);\n      }\n      if (updateNumber) {\n        removeChildren(lineView.lineNumber);\n        lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options, lineN)));\n      }\n      cur = lineView.node.nextSibling;\n    }\n    lineN += lineView.size;\n  }\n  while (cur) { cur = rm(cur); }\n}\n\nfunction updateGutterSpace(cm) {\n  var width = cm.display.gutters.offsetWidth;\n  cm.display.sizer.style.marginLeft = width + \"px\";\n}\n\nfunction setDocumentHeight(cm, measure) {\n  cm.display.sizer.style.minHeight = measure.docHeight + \"px\";\n  cm.display.heightForcer.style.top = measure.docHeight + \"px\";\n  cm.display.gutters.style.height = (measure.docHeight + cm.display.barHeight + scrollGap(cm)) + \"px\";\n}\n\n// Rebuild the gutter elements, ensure the margin to the left of the\n// code matches their width.\nfunction updateGutters(cm) {\n  var gutters = cm.display.gutters, specs = cm.options.gutters;\n  removeChildren(gutters);\n  var i = 0;\n  for (; i < specs.length; ++i) {\n    var gutterClass = specs[i];\n    var gElt = gutters.appendChild(elt(\"div\", null, \"CodeMirror-gutter \" + gutterClass));\n    if (gutterClass == \"CodeMirror-linenumbers\") {\n      cm.display.lineGutter = gElt;\n      gElt.style.width = (cm.display.lineNumWidth || 1) + \"px\";\n    }\n  }\n  gutters.style.display = i ? \"\" : \"none\";\n  updateGutterSpace(cm);\n}\n\n// Make sure the gutters options contains the element\n// \"CodeMirror-linenumbers\" when the lineNumbers option is true.\nfunction setGuttersForLineNumbers(options) {\n  var found = indexOf(options.gutters, \"CodeMirror-linenumbers\");\n  if (found == -1 && options.lineNumbers) {\n    options.gutters = options.gutters.concat([\"CodeMirror-linenumbers\"]);\n  } else if (found > -1 && !options.lineNumbers) {\n    options.gutters = options.gutters.slice(0);\n    options.gutters.splice(found, 1);\n  }\n}\n\n// Since the delta values reported on mouse wheel events are\n// unstandardized between browsers and even browser versions, and\n// generally horribly unpredictable, this code starts by measuring\n// the scroll effect that the first few mouse wheel events have,\n// and, from that, detects the way it can convert deltas to pixel\n// offsets afterwards.\n//\n// The reason we want to know the amount a wheel event will scroll\n// is that it gives us a chance to update the display before the\n// actual scrolling happens, reducing flickering.\n\nvar wheelSamples = 0;\nvar wheelPixelsPerUnit = null;\n// Fill in a browser-detected starting value on browsers where we\n// know one. These don't have to be accurate -- the result of them\n// being wrong would just be a slight flicker on the first wheel\n// scroll (if it is large enough).\nif (ie) { wheelPixelsPerUnit = -.53; }\nelse if (gecko) { wheelPixelsPerUnit = 15; }\nelse if (chrome) { wheelPixelsPerUnit = -.7; }\nelse if (safari) { wheelPixelsPerUnit = -1/3; }\n\nfunction wheelEventDelta(e) {\n  var dx = e.wheelDeltaX, dy = e.wheelDeltaY;\n  if (dx == null && e.detail && e.axis == e.HORIZONTAL_AXIS) { dx = e.detail; }\n  if (dy == null && e.detail && e.axis == e.VERTICAL_AXIS) { dy = e.detail; }\n  else if (dy == null) { dy = e.wheelDelta; }\n  return {x: dx, y: dy}\n}\nfunction wheelEventPixels(e) {\n  var delta = wheelEventDelta(e);\n  delta.x *= wheelPixelsPerUnit;\n  delta.y *= wheelPixelsPerUnit;\n  return delta\n}\n\nfunction onScrollWheel(cm, e) {\n  var delta = wheelEventDelta(e), dx = delta.x, dy = delta.y;\n\n  var display = cm.display, scroll = display.scroller;\n  // Quit if there's nothing to scroll here\n  var canScrollX = scroll.scrollWidth > scroll.clientWidth;\n  var canScrollY = scroll.scrollHeight > scroll.clientHeight;\n  if (!(dx && canScrollX || dy && canScrollY)) { return }\n\n  // Webkit browsers on OS X abort momentum scrolls when the target\n  // of the scroll event is removed from the scrollable element.\n  // This hack (see related code in patchDisplay) makes sure the\n  // element is kept around.\n  if (dy && mac && webkit) {\n    outer: for (var cur = e.target, view = display.view; cur != scroll; cur = cur.parentNode) {\n      for (var i = 0; i < view.length; i++) {\n        if (view[i].node == cur) {\n          cm.display.currentWheelTarget = cur;\n          break outer\n        }\n      }\n    }\n  }\n\n  // On some browsers, horizontal scrolling will cause redraws to\n  // happen before the gutter has been realigned, causing it to\n  // wriggle around in a most unseemly way. When we have an\n  // estimated pixels/delta value, we just handle horizontal\n  // scrolling entirely here. It'll be slightly off from native, but\n  // better than glitching out.\n  if (dx && !gecko && !presto && wheelPixelsPerUnit != null) {\n    if (dy && canScrollY)\n      { updateScrollTop(cm, Math.max(0, scroll.scrollTop + dy * wheelPixelsPerUnit)); }\n    setScrollLeft(cm, Math.max(0, scroll.scrollLeft + dx * wheelPixelsPerUnit));\n    // Only prevent default scrolling if vertical scrolling is\n    // actually possible. Otherwise, it causes vertical scroll\n    // jitter on OSX trackpads when deltaX is small and deltaY\n    // is large (issue #3579)\n    if (!dy || (dy && canScrollY))\n      { e_preventDefault(e); }\n    display.wheelStartX = null; // Abort measurement, if in progress\n    return\n  }\n\n  // 'Project' the visible viewport to cover the area that is being\n  // scrolled into view (if we know enough to estimate it).\n  if (dy && wheelPixelsPerUnit != null) {\n    var pixels = dy * wheelPixelsPerUnit;\n    var top = cm.doc.scrollTop, bot = top + display.wrapper.clientHeight;\n    if (pixels < 0) { top = Math.max(0, top + pixels - 50); }\n    else { bot = Math.min(cm.doc.height, bot + pixels + 50); }\n    updateDisplaySimple(cm, {top: top, bottom: bot});\n  }\n\n  if (wheelSamples < 20) {\n    if (display.wheelStartX == null) {\n      display.wheelStartX = scroll.scrollLeft; display.wheelStartY = scroll.scrollTop;\n      display.wheelDX = dx; display.wheelDY = dy;\n      setTimeout(function () {\n        if (display.wheelStartX == null) { return }\n        var movedX = scroll.scrollLeft - display.wheelStartX;\n        var movedY = scroll.scrollTop - display.wheelStartY;\n        var sample = (movedY && display.wheelDY && movedY / display.wheelDY) ||\n          (movedX && display.wheelDX && movedX / display.wheelDX);\n        display.wheelStartX = display.wheelStartY = null;\n        if (!sample) { return }\n        wheelPixelsPerUnit = (wheelPixelsPerUnit * wheelSamples + sample) / (wheelSamples + 1);\n        ++wheelSamples;\n      }, 200);\n    } else {\n      display.wheelDX += dx; display.wheelDY += dy;\n    }\n  }\n}\n\n// Selection objects are immutable. A new one is created every time\n// the selection changes. A selection is one or more non-overlapping\n// (and non-touching) ranges, sorted, and an integer that indicates\n// which one is the primary selection (the one that's scrolled into\n// view, that getCursor returns, etc).\nvar Selection = function(ranges, primIndex) {\n  this.ranges = ranges;\n  this.primIndex = primIndex;\n};\n\nSelection.prototype.primary = function () { return this.ranges[this.primIndex] };\n\nSelection.prototype.equals = function (other) {\n    var this$1 = this;\n\n  if (other == this) { return true }\n  if (other.primIndex != this.primIndex || other.ranges.length != this.ranges.length) { return false }\n  for (var i = 0; i < this.ranges.length; i++) {\n    var here = this$1.ranges[i], there = other.ranges[i];\n    if (!equalCursorPos(here.anchor, there.anchor) || !equalCursorPos(here.head, there.head)) { return false }\n  }\n  return true\n};\n\nSelection.prototype.deepCopy = function () {\n    var this$1 = this;\n\n  var out = [];\n  for (var i = 0; i < this.ranges.length; i++)\n    { out[i] = new Range(copyPos(this$1.ranges[i].anchor), copyPos(this$1.ranges[i].head)); }\n  return new Selection(out, this.primIndex)\n};\n\nSelection.prototype.somethingSelected = function () {\n    var this$1 = this;\n\n  for (var i = 0; i < this.ranges.length; i++)\n    { if (!this$1.ranges[i].empty()) { return true } }\n  return false\n};\n\nSelection.prototype.contains = function (pos, end) {\n    var this$1 = this;\n\n  if (!end) { end = pos; }\n  for (var i = 0; i < this.ranges.length; i++) {\n    var range = this$1.ranges[i];\n    if (cmp(end, range.from()) >= 0 && cmp(pos, range.to()) <= 0)\n      { return i }\n  }\n  return -1\n};\n\nvar Range = function(anchor, head) {\n  this.anchor = anchor; this.head = head;\n};\n\nRange.prototype.from = function () { return minPos(this.anchor, this.head) };\nRange.prototype.to = function () { return maxPos(this.anchor, this.head) };\nRange.prototype.empty = function () { return this.head.line == this.anchor.line && this.head.ch == this.anchor.ch };\n\n// Take an unsorted, potentially overlapping set of ranges, and\n// build a selection out of it. 'Consumes' ranges array (modifying\n// it).\nfunction normalizeSelection(ranges, primIndex) {\n  var prim = ranges[primIndex];\n  ranges.sort(function (a, b) { return cmp(a.from(), b.from()); });\n  primIndex = indexOf(ranges, prim);\n  for (var i = 1; i < ranges.length; i++) {\n    var cur = ranges[i], prev = ranges[i - 1];\n    if (cmp(prev.to(), cur.from()) >= 0) {\n      var from = minPos(prev.from(), cur.from()), to = maxPos(prev.to(), cur.to());\n      var inv = prev.empty() ? cur.from() == cur.head : prev.from() == prev.head;\n      if (i <= primIndex) { --primIndex; }\n      ranges.splice(--i, 2, new Range(inv ? to : from, inv ? from : to));\n    }\n  }\n  return new Selection(ranges, primIndex)\n}\n\nfunction simpleSelection(anchor, head) {\n  return new Selection([new Range(anchor, head || anchor)], 0)\n}\n\n// Compute the position of the end of a change (its 'to' property\n// refers to the pre-change end).\nfunction changeEnd(change) {\n  if (!change.text) { return change.to }\n  return Pos(change.from.line + change.text.length - 1,\n             lst(change.text).length + (change.text.length == 1 ? change.from.ch : 0))\n}\n\n// Adjust a position to refer to the post-change position of the\n// same text, or the end of the change if the change covers it.\nfunction adjustForChange(pos, change) {\n  if (cmp(pos, change.from) < 0) { return pos }\n  if (cmp(pos, change.to) <= 0) { return changeEnd(change) }\n\n  var line = pos.line + change.text.length - (change.to.line - change.from.line) - 1, ch = pos.ch;\n  if (pos.line == change.to.line) { ch += changeEnd(change).ch - change.to.ch; }\n  return Pos(line, ch)\n}\n\nfunction computeSelAfterChange(doc, change) {\n  var out = [];\n  for (var i = 0; i < doc.sel.ranges.length; i++) {\n    var range = doc.sel.ranges[i];\n    out.push(new Range(adjustForChange(range.anchor, change),\n                       adjustForChange(range.head, change)));\n  }\n  return normalizeSelection(out, doc.sel.primIndex)\n}\n\nfunction offsetPos(pos, old, nw) {\n  if (pos.line == old.line)\n    { return Pos(nw.line, pos.ch - old.ch + nw.ch) }\n  else\n    { return Pos(nw.line + (pos.line - old.line), pos.ch) }\n}\n\n// Used by replaceSelections to allow moving the selection to the\n// start or around the replaced test. Hint may be \"start\" or \"around\".\nfunction computeReplacedSel(doc, changes, hint) {\n  var out = [];\n  var oldPrev = Pos(doc.first, 0), newPrev = oldPrev;\n  for (var i = 0; i < changes.length; i++) {\n    var change = changes[i];\n    var from = offsetPos(change.from, oldPrev, newPrev);\n    var to = offsetPos(changeEnd(change), oldPrev, newPrev);\n    oldPrev = change.to;\n    newPrev = to;\n    if (hint == \"around\") {\n      var range = doc.sel.ranges[i], inv = cmp(range.head, range.anchor) < 0;\n      out[i] = new Range(inv ? to : from, inv ? from : to);\n    } else {\n      out[i] = new Range(from, from);\n    }\n  }\n  return new Selection(out, doc.sel.primIndex)\n}\n\n// Used to get the editor into a consistent state again when options change.\n\nfunction loadMode(cm) {\n  cm.doc.mode = getMode(cm.options, cm.doc.modeOption);\n  resetModeState(cm);\n}\n\nfunction resetModeState(cm) {\n  cm.doc.iter(function (line) {\n    if (line.stateAfter) { line.stateAfter = null; }\n    if (line.styles) { line.styles = null; }\n  });\n  cm.doc.modeFrontier = cm.doc.highlightFrontier = cm.doc.first;\n  startWorker(cm, 100);\n  cm.state.modeGen++;\n  if (cm.curOp) { regChange(cm); }\n}\n\n// DOCUMENT DATA STRUCTURE\n\n// By default, updates that start and end at the beginning of a line\n// are treated specially, in order to make the association of line\n// widgets and marker elements with the text behave more intuitive.\nfunction isWholeLineUpdate(doc, change) {\n  return change.from.ch == 0 && change.to.ch == 0 && lst(change.text) == \"\" &&\n    (!doc.cm || doc.cm.options.wholeLineUpdateBefore)\n}\n\n// Perform a change on the document data structure.\nfunction updateDoc(doc, change, markedSpans, estimateHeight$$1) {\n  function spansFor(n) {return markedSpans ? markedSpans[n] : null}\n  function update(line, text, spans) {\n    updateLine(line, text, spans, estimateHeight$$1);\n    signalLater(line, \"change\", line, change);\n  }\n  function linesFor(start, end) {\n    var result = [];\n    for (var i = start; i < end; ++i)\n      { result.push(new Line(text[i], spansFor(i), estimateHeight$$1)); }\n    return result\n  }\n\n  var from = change.from, to = change.to, text = change.text;\n  var firstLine = getLine(doc, from.line), lastLine = getLine(doc, to.line);\n  var lastText = lst(text), lastSpans = spansFor(text.length - 1), nlines = to.line - from.line;\n\n  // Adjust the line structure\n  if (change.full) {\n    doc.insert(0, linesFor(0, text.length));\n    doc.remove(text.length, doc.size - text.length);\n  } else if (isWholeLineUpdate(doc, change)) {\n    // This is a whole-line replace. Treated specially to make\n    // sure line objects move the way they are supposed to.\n    var added = linesFor(0, text.length - 1);\n    update(lastLine, lastLine.text, lastSpans);\n    if (nlines) { doc.remove(from.line, nlines); }\n    if (added.length) { doc.insert(from.line, added); }\n  } else if (firstLine == lastLine) {\n    if (text.length == 1) {\n      update(firstLine, firstLine.text.slice(0, from.ch) + lastText + firstLine.text.slice(to.ch), lastSpans);\n    } else {\n      var added$1 = linesFor(1, text.length - 1);\n      added$1.push(new Line(lastText + firstLine.text.slice(to.ch), lastSpans, estimateHeight$$1));\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n      doc.insert(from.line + 1, added$1);\n    }\n  } else if (text.length == 1) {\n    update(firstLine, firstLine.text.slice(0, from.ch) + text[0] + lastLine.text.slice(to.ch), spansFor(0));\n    doc.remove(from.line + 1, nlines);\n  } else {\n    update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n    update(lastLine, lastText + lastLine.text.slice(to.ch), lastSpans);\n    var added$2 = linesFor(1, text.length - 1);\n    if (nlines > 1) { doc.remove(from.line + 1, nlines - 1); }\n    doc.insert(from.line + 1, added$2);\n  }\n\n  signalLater(doc, \"change\", doc, change);\n}\n\n// Call f for all linked documents.\nfunction linkedDocs(doc, f, sharedHistOnly) {\n  function propagate(doc, skip, sharedHist) {\n    if (doc.linked) { for (var i = 0; i < doc.linked.length; ++i) {\n      var rel = doc.linked[i];\n      if (rel.doc == skip) { continue }\n      var shared = sharedHist && rel.sharedHist;\n      if (sharedHistOnly && !shared) { continue }\n      f(rel.doc, shared);\n      propagate(rel.doc, doc, shared);\n    } }\n  }\n  propagate(doc, null, true);\n}\n\n// Attach a document to an editor.\nfunction attachDoc(cm, doc) {\n  if (doc.cm) { throw new Error(\"This document is already in use.\") }\n  cm.doc = doc;\n  doc.cm = cm;\n  estimateLineHeights(cm);\n  loadMode(cm);\n  setDirectionClass(cm);\n  if (!cm.options.lineWrapping) { findMaxLine(cm); }\n  cm.options.mode = doc.modeOption;\n  regChange(cm);\n}\n\nfunction setDirectionClass(cm) {\n  (cm.doc.direction == \"rtl\" ? addClass : rmClass)(cm.display.lineDiv, \"CodeMirror-rtl\");\n}\n\nfunction directionChanged(cm) {\n  runInOp(cm, function () {\n    setDirectionClass(cm);\n    regChange(cm);\n  });\n}\n\nfunction History(startGen) {\n  // Arrays of change events and selections. Doing something adds an\n  // event to done and clears undo. Undoing moves events from done\n  // to undone, redoing moves them in the other direction.\n  this.done = []; this.undone = [];\n  this.undoDepth = Infinity;\n  // Used to track when changes can be merged into a single undo\n  // event\n  this.lastModTime = this.lastSelTime = 0;\n  this.lastOp = this.lastSelOp = null;\n  this.lastOrigin = this.lastSelOrigin = null;\n  // Used by the isClean() method\n  this.generation = this.maxGeneration = startGen || 1;\n}\n\n// Create a history change event from an updateDoc-style change\n// object.\nfunction historyChangeFromChange(doc, change) {\n  var histChange = {from: copyPos(change.from), to: changeEnd(change), text: getBetween(doc, change.from, change.to)};\n  attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1);\n  linkedDocs(doc, function (doc) { return attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1); }, true);\n  return histChange\n}\n\n// Pop all selection events off the end of a history array. Stop at\n// a change event.\nfunction clearSelectionEvents(array) {\n  while (array.length) {\n    var last = lst(array);\n    if (last.ranges) { array.pop(); }\n    else { break }\n  }\n}\n\n// Find the top change event in the history. Pop off selection\n// events that are in the way.\nfunction lastChangeEvent(hist, force) {\n  if (force) {\n    clearSelectionEvents(hist.done);\n    return lst(hist.done)\n  } else if (hist.done.length && !lst(hist.done).ranges) {\n    return lst(hist.done)\n  } else if (hist.done.length > 1 && !hist.done[hist.done.length - 2].ranges) {\n    hist.done.pop();\n    return lst(hist.done)\n  }\n}\n\n// Register a change in the history. Merges changes that are within\n// a single operation, or are close together with an origin that\n// allows merging (starting with \"+\") into a single event.\nfunction addChangeToHistory(doc, change, selAfter, opId) {\n  var hist = doc.history;\n  hist.undone.length = 0;\n  var time = +new Date, cur;\n  var last;\n\n  if ((hist.lastOp == opId ||\n       hist.lastOrigin == change.origin && change.origin &&\n       ((change.origin.charAt(0) == \"+\" && doc.cm && hist.lastModTime > time - doc.cm.options.historyEventDelay) ||\n        change.origin.charAt(0) == \"*\")) &&\n      (cur = lastChangeEvent(hist, hist.lastOp == opId))) {\n    // Merge this change into the last event\n    last = lst(cur.changes);\n    if (cmp(change.from, change.to) == 0 && cmp(change.from, last.to) == 0) {\n      // Optimized case for simple insertion -- don't want to add\n      // new changesets for every character typed\n      last.to = changeEnd(change);\n    } else {\n      // Add new sub-event\n      cur.changes.push(historyChangeFromChange(doc, change));\n    }\n  } else {\n    // Can not be merged, start a new event.\n    var before = lst(hist.done);\n    if (!before || !before.ranges)\n      { pushSelectionToHistory(doc.sel, hist.done); }\n    cur = {changes: [historyChangeFromChange(doc, change)],\n           generation: hist.generation};\n    hist.done.push(cur);\n    while (hist.done.length > hist.undoDepth) {\n      hist.done.shift();\n      if (!hist.done[0].ranges) { hist.done.shift(); }\n    }\n  }\n  hist.done.push(selAfter);\n  hist.generation = ++hist.maxGeneration;\n  hist.lastModTime = hist.lastSelTime = time;\n  hist.lastOp = hist.lastSelOp = opId;\n  hist.lastOrigin = hist.lastSelOrigin = change.origin;\n\n  if (!last) { signal(doc, \"historyAdded\"); }\n}\n\nfunction selectionEventCanBeMerged(doc, origin, prev, sel) {\n  var ch = origin.charAt(0);\n  return ch == \"*\" ||\n    ch == \"+\" &&\n    prev.ranges.length == sel.ranges.length &&\n    prev.somethingSelected() == sel.somethingSelected() &&\n    new Date - doc.history.lastSelTime <= (doc.cm ? doc.cm.options.historyEventDelay : 500)\n}\n\n// Called whenever the selection changes, sets the new selection as\n// the pending selection in the history, and pushes the old pending\n// selection into the 'done' array when it was significantly\n// different (in number of selected ranges, emptiness, or time).\nfunction addSelectionToHistory(doc, sel, opId, options) {\n  var hist = doc.history, origin = options && options.origin;\n\n  // A new event is started when the previous origin does not match\n  // the current, or the origins don't allow matching. Origins\n  // starting with * are always merged, those starting with + are\n  // merged when similar and close together in time.\n  if (opId == hist.lastSelOp ||\n      (origin && hist.lastSelOrigin == origin &&\n       (hist.lastModTime == hist.lastSelTime && hist.lastOrigin == origin ||\n        selectionEventCanBeMerged(doc, origin, lst(hist.done), sel))))\n    { hist.done[hist.done.length - 1] = sel; }\n  else\n    { pushSelectionToHistory(sel, hist.done); }\n\n  hist.lastSelTime = +new Date;\n  hist.lastSelOrigin = origin;\n  hist.lastSelOp = opId;\n  if (options && options.clearRedo !== false)\n    { clearSelectionEvents(hist.undone); }\n}\n\nfunction pushSelectionToHistory(sel, dest) {\n  var top = lst(dest);\n  if (!(top && top.ranges && top.equals(sel)))\n    { dest.push(sel); }\n}\n\n// Used to store marked span information in the history.\nfunction attachLocalSpans(doc, change, from, to) {\n  var existing = change[\"spans_\" + doc.id], n = 0;\n  doc.iter(Math.max(doc.first, from), Math.min(doc.first + doc.size, to), function (line) {\n    if (line.markedSpans)\n      { (existing || (existing = change[\"spans_\" + doc.id] = {}))[n] = line.markedSpans; }\n    ++n;\n  });\n}\n\n// When un/re-doing restores text containing marked spans, those\n// that have been explicitly cleared should not be restored.\nfunction removeClearedSpans(spans) {\n  if (!spans) { return null }\n  var out;\n  for (var i = 0; i < spans.length; ++i) {\n    if (spans[i].marker.explicitlyCleared) { if (!out) { out = spans.slice(0, i); } }\n    else if (out) { out.push(spans[i]); }\n  }\n  return !out ? spans : out.length ? out : null\n}\n\n// Retrieve and filter the old marked spans stored in a change event.\nfunction getOldSpans(doc, change) {\n  var found = change[\"spans_\" + doc.id];\n  if (!found) { return null }\n  var nw = [];\n  for (var i = 0; i < change.text.length; ++i)\n    { nw.push(removeClearedSpans(found[i])); }\n  return nw\n}\n\n// Used for un/re-doing changes from the history. Combines the\n// result of computing the existing spans with the set of spans that\n// existed in the history (so that deleting around a span and then\n// undoing brings back the span).\nfunction mergeOldSpans(doc, change) {\n  var old = getOldSpans(doc, change);\n  var stretched = stretchSpansOverChange(doc, change);\n  if (!old) { return stretched }\n  if (!stretched) { return old }\n\n  for (var i = 0; i < old.length; ++i) {\n    var oldCur = old[i], stretchCur = stretched[i];\n    if (oldCur && stretchCur) {\n      spans: for (var j = 0; j < stretchCur.length; ++j) {\n        var span = stretchCur[j];\n        for (var k = 0; k < oldCur.length; ++k)\n          { if (oldCur[k].marker == span.marker) { continue spans } }\n        oldCur.push(span);\n      }\n    } else if (stretchCur) {\n      old[i] = stretchCur;\n    }\n  }\n  return old\n}\n\n// Used both to provide a JSON-safe object in .getHistory, and, when\n// detaching a document, to split the history in two\nfunction copyHistoryArray(events, newGroup, instantiateSel) {\n  var copy = [];\n  for (var i = 0; i < events.length; ++i) {\n    var event = events[i];\n    if (event.ranges) {\n      copy.push(instantiateSel ? Selection.prototype.deepCopy.call(event) : event);\n      continue\n    }\n    var changes = event.changes, newChanges = [];\n    copy.push({changes: newChanges});\n    for (var j = 0; j < changes.length; ++j) {\n      var change = changes[j], m = (void 0);\n      newChanges.push({from: change.from, to: change.to, text: change.text});\n      if (newGroup) { for (var prop in change) { if (m = prop.match(/^spans_(\\d+)$/)) {\n        if (indexOf(newGroup, Number(m[1])) > -1) {\n          lst(newChanges)[prop] = change[prop];\n          delete change[prop];\n        }\n      } } }\n    }\n  }\n  return copy\n}\n\n// The 'scroll' parameter given to many of these indicated whether\n// the new cursor position should be scrolled into view after\n// modifying the selection.\n\n// If shift is held or the extend flag is set, extends a range to\n// include a given position (and optionally a second position).\n// Otherwise, simply returns the range between the given positions.\n// Used for cursor motion and such.\nfunction extendRange(range, head, other, extend) {\n  if (extend) {\n    var anchor = range.anchor;\n    if (other) {\n      var posBefore = cmp(head, anchor) < 0;\n      if (posBefore != (cmp(other, anchor) < 0)) {\n        anchor = head;\n        head = other;\n      } else if (posBefore != (cmp(head, other) < 0)) {\n        head = other;\n      }\n    }\n    return new Range(anchor, head)\n  } else {\n    return new Range(other || head, head)\n  }\n}\n\n// Extend the primary selection range, discard the rest.\nfunction extendSelection(doc, head, other, options, extend) {\n  if (extend == null) { extend = doc.cm && (doc.cm.display.shift || doc.extend); }\n  setSelection(doc, new Selection([extendRange(doc.sel.primary(), head, other, extend)], 0), options);\n}\n\n// Extend all selections (pos is an array of selections with length\n// equal the number of selections)\nfunction extendSelections(doc, heads, options) {\n  var out = [];\n  var extend = doc.cm && (doc.cm.display.shift || doc.extend);\n  for (var i = 0; i < doc.sel.ranges.length; i++)\n    { out[i] = extendRange(doc.sel.ranges[i], heads[i], null, extend); }\n  var newSel = normalizeSelection(out, doc.sel.primIndex);\n  setSelection(doc, newSel, options);\n}\n\n// Updates a single range in the selection.\nfunction replaceOneSelection(doc, i, range, options) {\n  var ranges = doc.sel.ranges.slice(0);\n  ranges[i] = range;\n  setSelection(doc, normalizeSelection(ranges, doc.sel.primIndex), options);\n}\n\n// Reset the selection to a single range.\nfunction setSimpleSelection(doc, anchor, head, options) {\n  setSelection(doc, simpleSelection(anchor, head), options);\n}\n\n// Give beforeSelectionChange handlers a change to influence a\n// selection update.\nfunction filterSelectionChange(doc, sel, options) {\n  var obj = {\n    ranges: sel.ranges,\n    update: function(ranges) {\n      var this$1 = this;\n\n      this.ranges = [];\n      for (var i = 0; i < ranges.length; i++)\n        { this$1.ranges[i] = new Range(clipPos(doc, ranges[i].anchor),\n                                   clipPos(doc, ranges[i].head)); }\n    },\n    origin: options && options.origin\n  };\n  signal(doc, \"beforeSelectionChange\", doc, obj);\n  if (doc.cm) { signal(doc.cm, \"beforeSelectionChange\", doc.cm, obj); }\n  if (obj.ranges != sel.ranges) { return normalizeSelection(obj.ranges, obj.ranges.length - 1) }\n  else { return sel }\n}\n\nfunction setSelectionReplaceHistory(doc, sel, options) {\n  var done = doc.history.done, last = lst(done);\n  if (last && last.ranges) {\n    done[done.length - 1] = sel;\n    setSelectionNoUndo(doc, sel, options);\n  } else {\n    setSelection(doc, sel, options);\n  }\n}\n\n// Set a new selection.\nfunction setSelection(doc, sel, options) {\n  setSelectionNoUndo(doc, sel, options);\n  addSelectionToHistory(doc, doc.sel, doc.cm ? doc.cm.curOp.id : NaN, options);\n}\n\nfunction setSelectionNoUndo(doc, sel, options) {\n  if (hasHandler(doc, \"beforeSelectionChange\") || doc.cm && hasHandler(doc.cm, \"beforeSelectionChange\"))\n    { sel = filterSelectionChange(doc, sel, options); }\n\n  var bias = options && options.bias ||\n    (cmp(sel.primary().head, doc.sel.primary().head) < 0 ? -1 : 1);\n  setSelectionInner(doc, skipAtomicInSelection(doc, sel, bias, true));\n\n  if (!(options && options.scroll === false) && doc.cm)\n    { ensureCursorVisible(doc.cm); }\n}\n\nfunction setSelectionInner(doc, sel) {\n  if (sel.equals(doc.sel)) { return }\n\n  doc.sel = sel;\n\n  if (doc.cm) {\n    doc.cm.curOp.updateInput = doc.cm.curOp.selectionChanged = true;\n    signalCursorActivity(doc.cm);\n  }\n  signalLater(doc, \"cursorActivity\", doc);\n}\n\n// Verify that the selection does not partially select any atomic\n// marked ranges.\nfunction reCheckSelection(doc) {\n  setSelectionInner(doc, skipAtomicInSelection(doc, doc.sel, null, false));\n}\n\n// Return a selection that does not partially select any atomic\n// ranges.\nfunction skipAtomicInSelection(doc, sel, bias, mayClear) {\n  var out;\n  for (var i = 0; i < sel.ranges.length; i++) {\n    var range = sel.ranges[i];\n    var old = sel.ranges.length == doc.sel.ranges.length && doc.sel.ranges[i];\n    var newAnchor = skipAtomic(doc, range.anchor, old && old.anchor, bias, mayClear);\n    var newHead = skipAtomic(doc, range.head, old && old.head, bias, mayClear);\n    if (out || newAnchor != range.anchor || newHead != range.head) {\n      if (!out) { out = sel.ranges.slice(0, i); }\n      out[i] = new Range(newAnchor, newHead);\n    }\n  }\n  return out ? normalizeSelection(out, sel.primIndex) : sel\n}\n\nfunction skipAtomicInner(doc, pos, oldPos, dir, mayClear) {\n  var line = getLine(doc, pos.line);\n  if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n    var sp = line.markedSpans[i], m = sp.marker;\n    if ((sp.from == null || (m.inclusiveLeft ? sp.from <= pos.ch : sp.from < pos.ch)) &&\n        (sp.to == null || (m.inclusiveRight ? sp.to >= pos.ch : sp.to > pos.ch))) {\n      if (mayClear) {\n        signal(m, \"beforeCursorEnter\");\n        if (m.explicitlyCleared) {\n          if (!line.markedSpans) { break }\n          else {--i; continue}\n        }\n      }\n      if (!m.atomic) { continue }\n\n      if (oldPos) {\n        var near = m.find(dir < 0 ? 1 : -1), diff = (void 0);\n        if (dir < 0 ? m.inclusiveRight : m.inclusiveLeft)\n          { near = movePos(doc, near, -dir, near && near.line == pos.line ? line : null); }\n        if (near && near.line == pos.line && (diff = cmp(near, oldPos)) && (dir < 0 ? diff < 0 : diff > 0))\n          { return skipAtomicInner(doc, near, pos, dir, mayClear) }\n      }\n\n      var far = m.find(dir < 0 ? -1 : 1);\n      if (dir < 0 ? m.inclusiveLeft : m.inclusiveRight)\n        { far = movePos(doc, far, dir, far.line == pos.line ? line : null); }\n      return far ? skipAtomicInner(doc, far, pos, dir, mayClear) : null\n    }\n  } }\n  return pos\n}\n\n// Ensure a given position is not inside an atomic range.\nfunction skipAtomic(doc, pos, oldPos, bias, mayClear) {\n  var dir = bias || 1;\n  var found = skipAtomicInner(doc, pos, oldPos, dir, mayClear) ||\n      (!mayClear && skipAtomicInner(doc, pos, oldPos, dir, true)) ||\n      skipAtomicInner(doc, pos, oldPos, -dir, mayClear) ||\n      (!mayClear && skipAtomicInner(doc, pos, oldPos, -dir, true));\n  if (!found) {\n    doc.cantEdit = true;\n    return Pos(doc.first, 0)\n  }\n  return found\n}\n\nfunction movePos(doc, pos, dir, line) {\n  if (dir < 0 && pos.ch == 0) {\n    if (pos.line > doc.first) { return clipPos(doc, Pos(pos.line - 1)) }\n    else { return null }\n  } else if (dir > 0 && pos.ch == (line || getLine(doc, pos.line)).text.length) {\n    if (pos.line < doc.first + doc.size - 1) { return Pos(pos.line + 1, 0) }\n    else { return null }\n  } else {\n    return new Pos(pos.line, pos.ch + dir)\n  }\n}\n\nfunction selectAll(cm) {\n  cm.setSelection(Pos(cm.firstLine(), 0), Pos(cm.lastLine()), sel_dontScroll);\n}\n\n// UPDATING\n\n// Allow \"beforeChange\" event handlers to influence a change\nfunction filterChange(doc, change, update) {\n  var obj = {\n    canceled: false,\n    from: change.from,\n    to: change.to,\n    text: change.text,\n    origin: change.origin,\n    cancel: function () { return obj.canceled = true; }\n  };\n  if (update) { obj.update = function (from, to, text, origin) {\n    if (from) { obj.from = clipPos(doc, from); }\n    if (to) { obj.to = clipPos(doc, to); }\n    if (text) { obj.text = text; }\n    if (origin !== undefined) { obj.origin = origin; }\n  }; }\n  signal(doc, \"beforeChange\", doc, obj);\n  if (doc.cm) { signal(doc.cm, \"beforeChange\", doc.cm, obj); }\n\n  if (obj.canceled) { return null }\n  return {from: obj.from, to: obj.to, text: obj.text, origin: obj.origin}\n}\n\n// Apply a change to a document, and add it to the document's\n// history, and propagating it to all linked documents.\nfunction makeChange(doc, change, ignoreReadOnly) {\n  if (doc.cm) {\n    if (!doc.cm.curOp) { return operation(doc.cm, makeChange)(doc, change, ignoreReadOnly) }\n    if (doc.cm.state.suppressEdits) { return }\n  }\n\n  if (hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\")) {\n    change = filterChange(doc, change, true);\n    if (!change) { return }\n  }\n\n  // Possibly split or suppress the update based on the presence\n  // of read-only spans in its range.\n  var split = sawReadOnlySpans && !ignoreReadOnly && removeReadOnlyRanges(doc, change.from, change.to);\n  if (split) {\n    for (var i = split.length - 1; i >= 0; --i)\n      { makeChangeInner(doc, {from: split[i].from, to: split[i].to, text: i ? [\"\"] : change.text, origin: change.origin}); }\n  } else {\n    makeChangeInner(doc, change);\n  }\n}\n\nfunction makeChangeInner(doc, change) {\n  if (change.text.length == 1 && change.text[0] == \"\" && cmp(change.from, change.to) == 0) { return }\n  var selAfter = computeSelAfterChange(doc, change);\n  addChangeToHistory(doc, change, selAfter, doc.cm ? doc.cm.curOp.id : NaN);\n\n  makeChangeSingleDoc(doc, change, selAfter, stretchSpansOverChange(doc, change));\n  var rebased = [];\n\n  linkedDocs(doc, function (doc, sharedHist) {\n    if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n      rebaseHist(doc.history, change);\n      rebased.push(doc.history);\n    }\n    makeChangeSingleDoc(doc, change, null, stretchSpansOverChange(doc, change));\n  });\n}\n\n// Revert a change stored in a document's history.\nfunction makeChangeFromHistory(doc, type, allowSelectionOnly) {\n  if (doc.cm && doc.cm.state.suppressEdits && !allowSelectionOnly) { return }\n\n  var hist = doc.history, event, selAfter = doc.sel;\n  var source = type == \"undo\" ? hist.done : hist.undone, dest = type == \"undo\" ? hist.undone : hist.done;\n\n  // Verify that there is a useable event (so that ctrl-z won't\n  // needlessly clear selection events)\n  var i = 0;\n  for (; i < source.length; i++) {\n    event = source[i];\n    if (allowSelectionOnly ? event.ranges && !event.equals(doc.sel) : !event.ranges)\n      { break }\n  }\n  if (i == source.length) { return }\n  hist.lastOrigin = hist.lastSelOrigin = null;\n\n  for (;;) {\n    event = source.pop();\n    if (event.ranges) {\n      pushSelectionToHistory(event, dest);\n      if (allowSelectionOnly && !event.equals(doc.sel)) {\n        setSelection(doc, event, {clearRedo: false});\n        return\n      }\n      selAfter = event;\n    }\n    else { break }\n  }\n\n  // Build up a reverse change object to add to the opposite history\n  // stack (redo when undoing, and vice versa).\n  var antiChanges = [];\n  pushSelectionToHistory(selAfter, dest);\n  dest.push({changes: antiChanges, generation: hist.generation});\n  hist.generation = event.generation || ++hist.maxGeneration;\n\n  var filter = hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\");\n\n  var loop = function ( i ) {\n    var change = event.changes[i];\n    change.origin = type;\n    if (filter && !filterChange(doc, change, false)) {\n      source.length = 0;\n      return {}\n    }\n\n    antiChanges.push(historyChangeFromChange(doc, change));\n\n    var after = i ? computeSelAfterChange(doc, change) : lst(source);\n    makeChangeSingleDoc(doc, change, after, mergeOldSpans(doc, change));\n    if (!i && doc.cm) { doc.cm.scrollIntoView({from: change.from, to: changeEnd(change)}); }\n    var rebased = [];\n\n    // Propagate to the linked documents\n    linkedDocs(doc, function (doc, sharedHist) {\n      if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n        rebaseHist(doc.history, change);\n        rebased.push(doc.history);\n      }\n      makeChangeSingleDoc(doc, change, null, mergeOldSpans(doc, change));\n    });\n  };\n\n  for (var i$1 = event.changes.length - 1; i$1 >= 0; --i$1) {\n    var returned = loop( i$1 );\n\n    if ( returned ) return returned.v;\n  }\n}\n\n// Sub-views need their line numbers shifted when text is added\n// above or below them in the parent document.\nfunction shiftDoc(doc, distance) {\n  if (distance == 0) { return }\n  doc.first += distance;\n  doc.sel = new Selection(map(doc.sel.ranges, function (range) { return new Range(\n    Pos(range.anchor.line + distance, range.anchor.ch),\n    Pos(range.head.line + distance, range.head.ch)\n  ); }), doc.sel.primIndex);\n  if (doc.cm) {\n    regChange(doc.cm, doc.first, doc.first - distance, distance);\n    for (var d = doc.cm.display, l = d.viewFrom; l < d.viewTo; l++)\n      { regLineChange(doc.cm, l, \"gutter\"); }\n  }\n}\n\n// More lower-level change function, handling only a single document\n// (not linked ones).\nfunction makeChangeSingleDoc(doc, change, selAfter, spans) {\n  if (doc.cm && !doc.cm.curOp)\n    { return operation(doc.cm, makeChangeSingleDoc)(doc, change, selAfter, spans) }\n\n  if (change.to.line < doc.first) {\n    shiftDoc(doc, change.text.length - 1 - (change.to.line - change.from.line));\n    return\n  }\n  if (change.from.line > doc.lastLine()) { return }\n\n  // Clip the change to the size of this doc\n  if (change.from.line < doc.first) {\n    var shift = change.text.length - 1 - (doc.first - change.from.line);\n    shiftDoc(doc, shift);\n    change = {from: Pos(doc.first, 0), to: Pos(change.to.line + shift, change.to.ch),\n              text: [lst(change.text)], origin: change.origin};\n  }\n  var last = doc.lastLine();\n  if (change.to.line > last) {\n    change = {from: change.from, to: Pos(last, getLine(doc, last).text.length),\n              text: [change.text[0]], origin: change.origin};\n  }\n\n  change.removed = getBetween(doc, change.from, change.to);\n\n  if (!selAfter) { selAfter = computeSelAfterChange(doc, change); }\n  if (doc.cm) { makeChangeSingleDocInEditor(doc.cm, change, spans); }\n  else { updateDoc(doc, change, spans); }\n  setSelectionNoUndo(doc, selAfter, sel_dontScroll);\n}\n\n// Handle the interaction of a change to a document with the editor\n// that this document is part of.\nfunction makeChangeSingleDocInEditor(cm, change, spans) {\n  var doc = cm.doc, display = cm.display, from = change.from, to = change.to;\n\n  var recomputeMaxLength = false, checkWidthStart = from.line;\n  if (!cm.options.lineWrapping) {\n    checkWidthStart = lineNo(visualLine(getLine(doc, from.line)));\n    doc.iter(checkWidthStart, to.line + 1, function (line) {\n      if (line == display.maxLine) {\n        recomputeMaxLength = true;\n        return true\n      }\n    });\n  }\n\n  if (doc.sel.contains(change.from, change.to) > -1)\n    { signalCursorActivity(cm); }\n\n  updateDoc(doc, change, spans, estimateHeight(cm));\n\n  if (!cm.options.lineWrapping) {\n    doc.iter(checkWidthStart, from.line + change.text.length, function (line) {\n      var len = lineLength(line);\n      if (len > display.maxLineLength) {\n        display.maxLine = line;\n        display.maxLineLength = len;\n        display.maxLineChanged = true;\n        recomputeMaxLength = false;\n      }\n    });\n    if (recomputeMaxLength) { cm.curOp.updateMaxLine = true; }\n  }\n\n  retreatFrontier(doc, from.line);\n  startWorker(cm, 400);\n\n  var lendiff = change.text.length - (to.line - from.line) - 1;\n  // Remember that these lines changed, for updating the display\n  if (change.full)\n    { regChange(cm); }\n  else if (from.line == to.line && change.text.length == 1 && !isWholeLineUpdate(cm.doc, change))\n    { regLineChange(cm, from.line, \"text\"); }\n  else\n    { regChange(cm, from.line, to.line + 1, lendiff); }\n\n  var changesHandler = hasHandler(cm, \"changes\"), changeHandler = hasHandler(cm, \"change\");\n  if (changeHandler || changesHandler) {\n    var obj = {\n      from: from, to: to,\n      text: change.text,\n      removed: change.removed,\n      origin: change.origin\n    };\n    if (changeHandler) { signalLater(cm, \"change\", cm, obj); }\n    if (changesHandler) { (cm.curOp.changeObjs || (cm.curOp.changeObjs = [])).push(obj); }\n  }\n  cm.display.selForContextMenu = null;\n}\n\nfunction replaceRange(doc, code, from, to, origin) {\n  if (!to) { to = from; }\n  if (cmp(to, from) < 0) { var assign;\n    (assign = [to, from], from = assign[0], to = assign[1], assign); }\n  if (typeof code == \"string\") { code = doc.splitLines(code); }\n  makeChange(doc, {from: from, to: to, text: code, origin: origin});\n}\n\n// Rebasing/resetting history to deal with externally-sourced changes\n\nfunction rebaseHistSelSingle(pos, from, to, diff) {\n  if (to < pos.line) {\n    pos.line += diff;\n  } else if (from < pos.line) {\n    pos.line = from;\n    pos.ch = 0;\n  }\n}\n\n// Tries to rebase an array of history events given a change in the\n// document. If the change touches the same lines as the event, the\n// event, and everything 'behind' it, is discarded. If the change is\n// before the event, the event's positions are updated. Uses a\n// copy-on-write scheme for the positions, to avoid having to\n// reallocate them all on every rebase, but also avoid problems with\n// shared position objects being unsafely updated.\nfunction rebaseHistArray(array, from, to, diff) {\n  for (var i = 0; i < array.length; ++i) {\n    var sub = array[i], ok = true;\n    if (sub.ranges) {\n      if (!sub.copied) { sub = array[i] = sub.deepCopy(); sub.copied = true; }\n      for (var j = 0; j < sub.ranges.length; j++) {\n        rebaseHistSelSingle(sub.ranges[j].anchor, from, to, diff);\n        rebaseHistSelSingle(sub.ranges[j].head, from, to, diff);\n      }\n      continue\n    }\n    for (var j$1 = 0; j$1 < sub.changes.length; ++j$1) {\n      var cur = sub.changes[j$1];\n      if (to < cur.from.line) {\n        cur.from = Pos(cur.from.line + diff, cur.from.ch);\n        cur.to = Pos(cur.to.line + diff, cur.to.ch);\n      } else if (from <= cur.to.line) {\n        ok = false;\n        break\n      }\n    }\n    if (!ok) {\n      array.splice(0, i + 1);\n      i = 0;\n    }\n  }\n}\n\nfunction rebaseHist(hist, change) {\n  var from = change.from.line, to = change.to.line, diff = change.text.length - (to - from) - 1;\n  rebaseHistArray(hist.done, from, to, diff);\n  rebaseHistArray(hist.undone, from, to, diff);\n}\n\n// Utility for applying a change to a line by handle or number,\n// returning the number and optionally registering the line as\n// changed.\nfunction changeLine(doc, handle, changeType, op) {\n  var no = handle, line = handle;\n  if (typeof handle == \"number\") { line = getLine(doc, clipLine(doc, handle)); }\n  else { no = lineNo(handle); }\n  if (no == null) { return null }\n  if (op(line, no) && doc.cm) { regLineChange(doc.cm, no, changeType); }\n  return line\n}\n\n// The document is represented as a BTree consisting of leaves, with\n// chunk of lines in them, and branches, with up to ten leaves or\n// other branch nodes below them. The top node is always a branch\n// node, and is the document object itself (meaning it has\n// additional methods and properties).\n//\n// All nodes have parent links. The tree is used both to go from\n// line numbers to line objects, and to go from objects to numbers.\n// It also indexes by height, and is used to convert between height\n// and line object, and to find the total height of the document.\n//\n// See also http://marijnhaverbeke.nl/blog/codemirror-line-tree.html\n\nfunction LeafChunk(lines) {\n  var this$1 = this;\n\n  this.lines = lines;\n  this.parent = null;\n  var height = 0;\n  for (var i = 0; i < lines.length; ++i) {\n    lines[i].parent = this$1;\n    height += lines[i].height;\n  }\n  this.height = height;\n}\n\nLeafChunk.prototype = {\n  chunkSize: function chunkSize() { return this.lines.length },\n\n  // Remove the n lines at offset 'at'.\n  removeInner: function removeInner(at, n) {\n    var this$1 = this;\n\n    for (var i = at, e = at + n; i < e; ++i) {\n      var line = this$1.lines[i];\n      this$1.height -= line.height;\n      cleanUpLine(line);\n      signalLater(line, \"delete\");\n    }\n    this.lines.splice(at, n);\n  },\n\n  // Helper used to collapse a small branch into a single leaf.\n  collapse: function collapse(lines) {\n    lines.push.apply(lines, this.lines);\n  },\n\n  // Insert the given array of lines at offset 'at', count them as\n  // having the given height.\n  insertInner: function insertInner(at, lines, height) {\n    var this$1 = this;\n\n    this.height += height;\n    this.lines = this.lines.slice(0, at).concat(lines).concat(this.lines.slice(at));\n    for (var i = 0; i < lines.length; ++i) { lines[i].parent = this$1; }\n  },\n\n  // Used to iterate over a part of the tree.\n  iterN: function iterN(at, n, op) {\n    var this$1 = this;\n\n    for (var e = at + n; at < e; ++at)\n      { if (op(this$1.lines[at])) { return true } }\n  }\n};\n\nfunction BranchChunk(children) {\n  var this$1 = this;\n\n  this.children = children;\n  var size = 0, height = 0;\n  for (var i = 0; i < children.length; ++i) {\n    var ch = children[i];\n    size += ch.chunkSize(); height += ch.height;\n    ch.parent = this$1;\n  }\n  this.size = size;\n  this.height = height;\n  this.parent = null;\n}\n\nBranchChunk.prototype = {\n  chunkSize: function chunkSize() { return this.size },\n\n  removeInner: function removeInner(at, n) {\n    var this$1 = this;\n\n    this.size -= n;\n    for (var i = 0; i < this.children.length; ++i) {\n      var child = this$1.children[i], sz = child.chunkSize();\n      if (at < sz) {\n        var rm = Math.min(n, sz - at), oldHeight = child.height;\n        child.removeInner(at, rm);\n        this$1.height -= oldHeight - child.height;\n        if (sz == rm) { this$1.children.splice(i--, 1); child.parent = null; }\n        if ((n -= rm) == 0) { break }\n        at = 0;\n      } else { at -= sz; }\n    }\n    // If the result is smaller than 25 lines, ensure that it is a\n    // single leaf node.\n    if (this.size - n < 25 &&\n        (this.children.length > 1 || !(this.children[0] instanceof LeafChunk))) {\n      var lines = [];\n      this.collapse(lines);\n      this.children = [new LeafChunk(lines)];\n      this.children[0].parent = this;\n    }\n  },\n\n  collapse: function collapse(lines) {\n    var this$1 = this;\n\n    for (var i = 0; i < this.children.length; ++i) { this$1.children[i].collapse(lines); }\n  },\n\n  insertInner: function insertInner(at, lines, height) {\n    var this$1 = this;\n\n    this.size += lines.length;\n    this.height += height;\n    for (var i = 0; i < this.children.length; ++i) {\n      var child = this$1.children[i], sz = child.chunkSize();\n      if (at <= sz) {\n        child.insertInner(at, lines, height);\n        if (child.lines && child.lines.length > 50) {\n          // To avoid memory thrashing when child.lines is huge (e.g. first view of a large file), it's never spliced.\n          // Instead, small slices are taken. They're taken in order because sequential memory accesses are fastest.\n          var remaining = child.lines.length % 25 + 25;\n          for (var pos = remaining; pos < child.lines.length;) {\n            var leaf = new LeafChunk(child.lines.slice(pos, pos += 25));\n            child.height -= leaf.height;\n            this$1.children.splice(++i, 0, leaf);\n            leaf.parent = this$1;\n          }\n          child.lines = child.lines.slice(0, remaining);\n          this$1.maybeSpill();\n        }\n        break\n      }\n      at -= sz;\n    }\n  },\n\n  // When a node has grown, check whether it should be split.\n  maybeSpill: function maybeSpill() {\n    if (this.children.length <= 10) { return }\n    var me = this;\n    do {\n      var spilled = me.children.splice(me.children.length - 5, 5);\n      var sibling = new BranchChunk(spilled);\n      if (!me.parent) { // Become the parent node\n        var copy = new BranchChunk(me.children);\n        copy.parent = me;\n        me.children = [copy, sibling];\n        me = copy;\n     } else {\n        me.size -= sibling.size;\n        me.height -= sibling.height;\n        var myIndex = indexOf(me.parent.children, me);\n        me.parent.children.splice(myIndex + 1, 0, sibling);\n      }\n      sibling.parent = me.parent;\n    } while (me.children.length > 10)\n    me.parent.maybeSpill();\n  },\n\n  iterN: function iterN(at, n, op) {\n    var this$1 = this;\n\n    for (var i = 0; i < this.children.length; ++i) {\n      var child = this$1.children[i], sz = child.chunkSize();\n      if (at < sz) {\n        var used = Math.min(n, sz - at);\n        if (child.iterN(at, used, op)) { return true }\n        if ((n -= used) == 0) { break }\n        at = 0;\n      } else { at -= sz; }\n    }\n  }\n};\n\n// Line widgets are block elements displayed above or below a line.\n\nvar LineWidget = function(doc, node, options) {\n  var this$1 = this;\n\n  if (options) { for (var opt in options) { if (options.hasOwnProperty(opt))\n    { this$1[opt] = options[opt]; } } }\n  this.doc = doc;\n  this.node = node;\n};\n\nLineWidget.prototype.clear = function () {\n    var this$1 = this;\n\n  var cm = this.doc.cm, ws = this.line.widgets, line = this.line, no = lineNo(line);\n  if (no == null || !ws) { return }\n  for (var i = 0; i < ws.length; ++i) { if (ws[i] == this$1) { ws.splice(i--, 1); } }\n  if (!ws.length) { line.widgets = null; }\n  var height = widgetHeight(this);\n  updateLineHeight(line, Math.max(0, line.height - height));\n  if (cm) {\n    runInOp(cm, function () {\n      adjustScrollWhenAboveVisible(cm, line, -height);\n      regLineChange(cm, no, \"widget\");\n    });\n    signalLater(cm, \"lineWidgetCleared\", cm, this, no);\n  }\n};\n\nLineWidget.prototype.changed = function () {\n    var this$1 = this;\n\n  var oldH = this.height, cm = this.doc.cm, line = this.line;\n  this.height = null;\n  var diff = widgetHeight(this) - oldH;\n  if (!diff) { return }\n  updateLineHeight(line, line.height + diff);\n  if (cm) {\n    runInOp(cm, function () {\n      cm.curOp.forceUpdate = true;\n      adjustScrollWhenAboveVisible(cm, line, diff);\n      signalLater(cm, \"lineWidgetChanged\", cm, this$1, lineNo(line));\n    });\n  }\n};\neventMixin(LineWidget);\n\nfunction adjustScrollWhenAboveVisible(cm, line, diff) {\n  if (heightAtLine(line) < ((cm.curOp && cm.curOp.scrollTop) || cm.doc.scrollTop))\n    { addToScrollTop(cm, diff); }\n}\n\nfunction addLineWidget(doc, handle, node, options) {\n  var widget = new LineWidget(doc, node, options);\n  var cm = doc.cm;\n  if (cm && widget.noHScroll) { cm.display.alignWidgets = true; }\n  changeLine(doc, handle, \"widget\", function (line) {\n    var widgets = line.widgets || (line.widgets = []);\n    if (widget.insertAt == null) { widgets.push(widget); }\n    else { widgets.splice(Math.min(widgets.length - 1, Math.max(0, widget.insertAt)), 0, widget); }\n    widget.line = line;\n    if (cm && !lineIsHidden(doc, line)) {\n      var aboveVisible = heightAtLine(line) < doc.scrollTop;\n      updateLineHeight(line, line.height + widgetHeight(widget));\n      if (aboveVisible) { addToScrollTop(cm, widget.height); }\n      cm.curOp.forceUpdate = true;\n    }\n    return true\n  });\n  signalLater(cm, \"lineWidgetAdded\", cm, widget, typeof handle == \"number\" ? handle : lineNo(handle));\n  return widget\n}\n\n// TEXTMARKERS\n\n// Created with markText and setBookmark methods. A TextMarker is a\n// handle that can be used to clear or find a marked position in the\n// document. Line objects hold arrays (markedSpans) containing\n// {from, to, marker} object pointing to such marker objects, and\n// indicating that such a marker is present on that line. Multiple\n// lines may point to the same marker when it spans across lines.\n// The spans will have null for their from/to properties when the\n// marker continues beyond the start/end of the line. Markers have\n// links back to the lines they currently touch.\n\n// Collapsed markers have unique ids, in order to be able to order\n// them, which is needed for uniquely determining an outer marker\n// when they overlap (they may nest, but not partially overlap).\nvar nextMarkerId = 0;\n\nvar TextMarker = function(doc, type) {\n  this.lines = [];\n  this.type = type;\n  this.doc = doc;\n  this.id = ++nextMarkerId;\n};\n\n// Clear the marker.\nTextMarker.prototype.clear = function () {\n    var this$1 = this;\n\n  if (this.explicitlyCleared) { return }\n  var cm = this.doc.cm, withOp = cm && !cm.curOp;\n  if (withOp) { startOperation(cm); }\n  if (hasHandler(this, \"clear\")) {\n    var found = this.find();\n    if (found) { signalLater(this, \"clear\", found.from, found.to); }\n  }\n  var min = null, max = null;\n  for (var i = 0; i < this.lines.length; ++i) {\n    var line = this$1.lines[i];\n    var span = getMarkedSpanFor(line.markedSpans, this$1);\n    if (cm && !this$1.collapsed) { regLineChange(cm, lineNo(line), \"text\"); }\n    else if (cm) {\n      if (span.to != null) { max = lineNo(line); }\n      if (span.from != null) { min = lineNo(line); }\n    }\n    line.markedSpans = removeMarkedSpan(line.markedSpans, span);\n    if (span.from == null && this$1.collapsed && !lineIsHidden(this$1.doc, line) && cm)\n      { updateLineHeight(line, textHeight(cm.display)); }\n  }\n  if (cm && this.collapsed && !cm.options.lineWrapping) { for (var i$1 = 0; i$1 < this.lines.length; ++i$1) {\n    var visual = visualLine(this$1.lines[i$1]), len = lineLength(visual);\n    if (len > cm.display.maxLineLength) {\n      cm.display.maxLine = visual;\n      cm.display.maxLineLength = len;\n      cm.display.maxLineChanged = true;\n    }\n  } }\n\n  if (min != null && cm && this.collapsed) { regChange(cm, min, max + 1); }\n  this.lines.length = 0;\n  this.explicitlyCleared = true;\n  if (this.atomic && this.doc.cantEdit) {\n    this.doc.cantEdit = false;\n    if (cm) { reCheckSelection(cm.doc); }\n  }\n  if (cm) { signalLater(cm, \"markerCleared\", cm, this, min, max); }\n  if (withOp) { endOperation(cm); }\n  if (this.parent) { this.parent.clear(); }\n};\n\n// Find the position of the marker in the document. Returns a {from,\n// to} object by default. Side can be passed to get a specific side\n// -- 0 (both), -1 (left), or 1 (right). When lineObj is true, the\n// Pos objects returned contain a line object, rather than a line\n// number (used to prevent looking up the same line twice).\nTextMarker.prototype.find = function (side, lineObj) {\n    var this$1 = this;\n\n  if (side == null && this.type == \"bookmark\") { side = 1; }\n  var from, to;\n  for (var i = 0; i < this.lines.length; ++i) {\n    var line = this$1.lines[i];\n    var span = getMarkedSpanFor(line.markedSpans, this$1);\n    if (span.from != null) {\n      from = Pos(lineObj ? line : lineNo(line), span.from);\n      if (side == -1) { return from }\n    }\n    if (span.to != null) {\n      to = Pos(lineObj ? line : lineNo(line), span.to);\n      if (side == 1) { return to }\n    }\n  }\n  return from && {from: from, to: to}\n};\n\n// Signals that the marker's widget changed, and surrounding layout\n// should be recomputed.\nTextMarker.prototype.changed = function () {\n    var this$1 = this;\n\n  var pos = this.find(-1, true), widget = this, cm = this.doc.cm;\n  if (!pos || !cm) { return }\n  runInOp(cm, function () {\n    var line = pos.line, lineN = lineNo(pos.line);\n    var view = findViewForLine(cm, lineN);\n    if (view) {\n      clearLineMeasurementCacheFor(view);\n      cm.curOp.selectionChanged = cm.curOp.forceUpdate = true;\n    }\n    cm.curOp.updateMaxLine = true;\n    if (!lineIsHidden(widget.doc, line) && widget.height != null) {\n      var oldHeight = widget.height;\n      widget.height = null;\n      var dHeight = widgetHeight(widget) - oldHeight;\n      if (dHeight)\n        { updateLineHeight(line, line.height + dHeight); }\n    }\n    signalLater(cm, \"markerChanged\", cm, this$1);\n  });\n};\n\nTextMarker.prototype.attachLine = function (line) {\n  if (!this.lines.length && this.doc.cm) {\n    var op = this.doc.cm.curOp;\n    if (!op.maybeHiddenMarkers || indexOf(op.maybeHiddenMarkers, this) == -1)\n      { (op.maybeUnhiddenMarkers || (op.maybeUnhiddenMarkers = [])).push(this); }\n  }\n  this.lines.push(line);\n};\n\nTextMarker.prototype.detachLine = function (line) {\n  this.lines.splice(indexOf(this.lines, line), 1);\n  if (!this.lines.length && this.doc.cm) {\n    var op = this.doc.cm.curOp;(op.maybeHiddenMarkers || (op.maybeHiddenMarkers = [])).push(this);\n  }\n};\neventMixin(TextMarker);\n\n// Create a marker, wire it up to the right lines, and\nfunction markText(doc, from, to, options, type) {\n  // Shared markers (across linked documents) are handled separately\n  // (markTextShared will call out to this again, once per\n  // document).\n  if (options && options.shared) { return markTextShared(doc, from, to, options, type) }\n  // Ensure we are in an operation.\n  if (doc.cm && !doc.cm.curOp) { return operation(doc.cm, markText)(doc, from, to, options, type) }\n\n  var marker = new TextMarker(doc, type), diff = cmp(from, to);\n  if (options) { copyObj(options, marker, false); }\n  // Don't connect empty markers unless clearWhenEmpty is false\n  if (diff > 0 || diff == 0 && marker.clearWhenEmpty !== false)\n    { return marker }\n  if (marker.replacedWith) {\n    // Showing up as a widget implies collapsed (widget replaces text)\n    marker.collapsed = true;\n    marker.widgetNode = eltP(\"span\", [marker.replacedWith], \"CodeMirror-widget\");\n    if (!options.handleMouseEvents) { marker.widgetNode.setAttribute(\"cm-ignore-events\", \"true\"); }\n    if (options.insertLeft) { marker.widgetNode.insertLeft = true; }\n  }\n  if (marker.collapsed) {\n    if (conflictingCollapsedRange(doc, from.line, from, to, marker) ||\n        from.line != to.line && conflictingCollapsedRange(doc, to.line, from, to, marker))\n      { throw new Error(\"Inserting collapsed marker partially overlapping an existing one\") }\n    seeCollapsedSpans();\n  }\n\n  if (marker.addToHistory)\n    { addChangeToHistory(doc, {from: from, to: to, origin: \"markText\"}, doc.sel, NaN); }\n\n  var curLine = from.line, cm = doc.cm, updateMaxLine;\n  doc.iter(curLine, to.line + 1, function (line) {\n    if (cm && marker.collapsed && !cm.options.lineWrapping && visualLine(line) == cm.display.maxLine)\n      { updateMaxLine = true; }\n    if (marker.collapsed && curLine != from.line) { updateLineHeight(line, 0); }\n    addMarkedSpan(line, new MarkedSpan(marker,\n                                       curLine == from.line ? from.ch : null,\n                                       curLine == to.line ? to.ch : null));\n    ++curLine;\n  });\n  // lineIsHidden depends on the presence of the spans, so needs a second pass\n  if (marker.collapsed) { doc.iter(from.line, to.line + 1, function (line) {\n    if (lineIsHidden(doc, line)) { updateLineHeight(line, 0); }\n  }); }\n\n  if (marker.clearOnEnter) { on(marker, \"beforeCursorEnter\", function () { return marker.clear(); }); }\n\n  if (marker.readOnly) {\n    seeReadOnlySpans();\n    if (doc.history.done.length || doc.history.undone.length)\n      { doc.clearHistory(); }\n  }\n  if (marker.collapsed) {\n    marker.id = ++nextMarkerId;\n    marker.atomic = true;\n  }\n  if (cm) {\n    // Sync editor state\n    if (updateMaxLine) { cm.curOp.updateMaxLine = true; }\n    if (marker.collapsed)\n      { regChange(cm, from.line, to.line + 1); }\n    else if (marker.className || marker.title || marker.startStyle || marker.endStyle || marker.css)\n      { for (var i = from.line; i <= to.line; i++) { regLineChange(cm, i, \"text\"); } }\n    if (marker.atomic) { reCheckSelection(cm.doc); }\n    signalLater(cm, \"markerAdded\", cm, marker);\n  }\n  return marker\n}\n\n// SHARED TEXTMARKERS\n\n// A shared marker spans multiple linked documents. It is\n// implemented as a meta-marker-object controlling multiple normal\n// markers.\nvar SharedTextMarker = function(markers, primary) {\n  var this$1 = this;\n\n  this.markers = markers;\n  this.primary = primary;\n  for (var i = 0; i < markers.length; ++i)\n    { markers[i].parent = this$1; }\n};\n\nSharedTextMarker.prototype.clear = function () {\n    var this$1 = this;\n\n  if (this.explicitlyCleared) { return }\n  this.explicitlyCleared = true;\n  for (var i = 0; i < this.markers.length; ++i)\n    { this$1.markers[i].clear(); }\n  signalLater(this, \"clear\");\n};\n\nSharedTextMarker.prototype.find = function (side, lineObj) {\n  return this.primary.find(side, lineObj)\n};\neventMixin(SharedTextMarker);\n\nfunction markTextShared(doc, from, to, options, type) {\n  options = copyObj(options);\n  options.shared = false;\n  var markers = [markText(doc, from, to, options, type)], primary = markers[0];\n  var widget = options.widgetNode;\n  linkedDocs(doc, function (doc) {\n    if (widget) { options.widgetNode = widget.cloneNode(true); }\n    markers.push(markText(doc, clipPos(doc, from), clipPos(doc, to), options, type));\n    for (var i = 0; i < doc.linked.length; ++i)\n      { if (doc.linked[i].isParent) { return } }\n    primary = lst(markers);\n  });\n  return new SharedTextMarker(markers, primary)\n}\n\nfunction findSharedMarkers(doc) {\n  return doc.findMarks(Pos(doc.first, 0), doc.clipPos(Pos(doc.lastLine())), function (m) { return m.parent; })\n}\n\nfunction copySharedMarkers(doc, markers) {\n  for (var i = 0; i < markers.length; i++) {\n    var marker = markers[i], pos = marker.find();\n    var mFrom = doc.clipPos(pos.from), mTo = doc.clipPos(pos.to);\n    if (cmp(mFrom, mTo)) {\n      var subMark = markText(doc, mFrom, mTo, marker.primary, marker.primary.type);\n      marker.markers.push(subMark);\n      subMark.parent = marker;\n    }\n  }\n}\n\nfunction detachSharedMarkers(markers) {\n  var loop = function ( i ) {\n    var marker = markers[i], linked = [marker.primary.doc];\n    linkedDocs(marker.primary.doc, function (d) { return linked.push(d); });\n    for (var j = 0; j < marker.markers.length; j++) {\n      var subMarker = marker.markers[j];\n      if (indexOf(linked, subMarker.doc) == -1) {\n        subMarker.parent = null;\n        marker.markers.splice(j--, 1);\n      }\n    }\n  };\n\n  for (var i = 0; i < markers.length; i++) loop( i );\n}\n\nvar nextDocId = 0;\nvar Doc = function(text, mode, firstLine, lineSep, direction) {\n  if (!(this instanceof Doc)) { return new Doc(text, mode, firstLine, lineSep, direction) }\n  if (firstLine == null) { firstLine = 0; }\n\n  BranchChunk.call(this, [new LeafChunk([new Line(\"\", null)])]);\n  this.first = firstLine;\n  this.scrollTop = this.scrollLeft = 0;\n  this.cantEdit = false;\n  this.cleanGeneration = 1;\n  this.modeFrontier = this.highlightFrontier = firstLine;\n  var start = Pos(firstLine, 0);\n  this.sel = simpleSelection(start);\n  this.history = new History(null);\n  this.id = ++nextDocId;\n  this.modeOption = mode;\n  this.lineSep = lineSep;\n  this.direction = (direction == \"rtl\") ? \"rtl\" : \"ltr\";\n  this.extend = false;\n\n  if (typeof text == \"string\") { text = this.splitLines(text); }\n  updateDoc(this, {from: start, to: start, text: text});\n  setSelection(this, simpleSelection(start), sel_dontScroll);\n};\n\nDoc.prototype = createObj(BranchChunk.prototype, {\n  constructor: Doc,\n  // Iterate over the document. Supports two forms -- with only one\n  // argument, it calls that for each line in the document. With\n  // three, it iterates over the range given by the first two (with\n  // the second being non-inclusive).\n  iter: function(from, to, op) {\n    if (op) { this.iterN(from - this.first, to - from, op); }\n    else { this.iterN(this.first, this.first + this.size, from); }\n  },\n\n  // Non-public interface for adding and removing lines.\n  insert: function(at, lines) {\n    var height = 0;\n    for (var i = 0; i < lines.length; ++i) { height += lines[i].height; }\n    this.insertInner(at - this.first, lines, height);\n  },\n  remove: function(at, n) { this.removeInner(at - this.first, n); },\n\n  // From here, the methods are part of the public interface. Most\n  // are also available from CodeMirror (editor) instances.\n\n  getValue: function(lineSep) {\n    var lines = getLines(this, this.first, this.first + this.size);\n    if (lineSep === false) { return lines }\n    return lines.join(lineSep || this.lineSeparator())\n  },\n  setValue: docMethodOp(function(code) {\n    var top = Pos(this.first, 0), last = this.first + this.size - 1;\n    makeChange(this, {from: top, to: Pos(last, getLine(this, last).text.length),\n                      text: this.splitLines(code), origin: \"setValue\", full: true}, true);\n    if (this.cm) { scrollToCoords(this.cm, 0, 0); }\n    setSelection(this, simpleSelection(top), sel_dontScroll);\n  }),\n  replaceRange: function(code, from, to, origin) {\n    from = clipPos(this, from);\n    to = to ? clipPos(this, to) : from;\n    replaceRange(this, code, from, to, origin);\n  },\n  getRange: function(from, to, lineSep) {\n    var lines = getBetween(this, clipPos(this, from), clipPos(this, to));\n    if (lineSep === false) { return lines }\n    return lines.join(lineSep || this.lineSeparator())\n  },\n\n  getLine: function(line) {var l = this.getLineHandle(line); return l && l.text},\n\n  getLineHandle: function(line) {if (isLine(this, line)) { return getLine(this, line) }},\n  getLineNumber: function(line) {return lineNo(line)},\n\n  getLineHandleVisualStart: function(line) {\n    if (typeof line == \"number\") { line = getLine(this, line); }\n    return visualLine(line)\n  },\n\n  lineCount: function() {return this.size},\n  firstLine: function() {return this.first},\n  lastLine: function() {return this.first + this.size - 1},\n\n  clipPos: function(pos) {return clipPos(this, pos)},\n\n  getCursor: function(start) {\n    var range$$1 = this.sel.primary(), pos;\n    if (start == null || start == \"head\") { pos = range$$1.head; }\n    else if (start == \"anchor\") { pos = range$$1.anchor; }\n    else if (start == \"end\" || start == \"to\" || start === false) { pos = range$$1.to(); }\n    else { pos = range$$1.from(); }\n    return pos\n  },\n  listSelections: function() { return this.sel.ranges },\n  somethingSelected: function() {return this.sel.somethingSelected()},\n\n  setCursor: docMethodOp(function(line, ch, options) {\n    setSimpleSelection(this, clipPos(this, typeof line == \"number\" ? Pos(line, ch || 0) : line), null, options);\n  }),\n  setSelection: docMethodOp(function(anchor, head, options) {\n    setSimpleSelection(this, clipPos(this, anchor), clipPos(this, head || anchor), options);\n  }),\n  extendSelection: docMethodOp(function(head, other, options) {\n    extendSelection(this, clipPos(this, head), other && clipPos(this, other), options);\n  }),\n  extendSelections: docMethodOp(function(heads, options) {\n    extendSelections(this, clipPosArray(this, heads), options);\n  }),\n  extendSelectionsBy: docMethodOp(function(f, options) {\n    var heads = map(this.sel.ranges, f);\n    extendSelections(this, clipPosArray(this, heads), options);\n  }),\n  setSelections: docMethodOp(function(ranges, primary, options) {\n    var this$1 = this;\n\n    if (!ranges.length) { return }\n    var out = [];\n    for (var i = 0; i < ranges.length; i++)\n      { out[i] = new Range(clipPos(this$1, ranges[i].anchor),\n                         clipPos(this$1, ranges[i].head)); }\n    if (primary == null) { primary = Math.min(ranges.length - 1, this.sel.primIndex); }\n    setSelection(this, normalizeSelection(out, primary), options);\n  }),\n  addSelection: docMethodOp(function(anchor, head, options) {\n    var ranges = this.sel.ranges.slice(0);\n    ranges.push(new Range(clipPos(this, anchor), clipPos(this, head || anchor)));\n    setSelection(this, normalizeSelection(ranges, ranges.length - 1), options);\n  }),\n\n  getSelection: function(lineSep) {\n    var this$1 = this;\n\n    var ranges = this.sel.ranges, lines;\n    for (var i = 0; i < ranges.length; i++) {\n      var sel = getBetween(this$1, ranges[i].from(), ranges[i].to());\n      lines = lines ? lines.concat(sel) : sel;\n    }\n    if (lineSep === false) { return lines }\n    else { return lines.join(lineSep || this.lineSeparator()) }\n  },\n  getSelections: function(lineSep) {\n    var this$1 = this;\n\n    var parts = [], ranges = this.sel.ranges;\n    for (var i = 0; i < ranges.length; i++) {\n      var sel = getBetween(this$1, ranges[i].from(), ranges[i].to());\n      if (lineSep !== false) { sel = sel.join(lineSep || this$1.lineSeparator()); }\n      parts[i] = sel;\n    }\n    return parts\n  },\n  replaceSelection: function(code, collapse, origin) {\n    var dup = [];\n    for (var i = 0; i < this.sel.ranges.length; i++)\n      { dup[i] = code; }\n    this.replaceSelections(dup, collapse, origin || \"+input\");\n  },\n  replaceSelections: docMethodOp(function(code, collapse, origin) {\n    var this$1 = this;\n\n    var changes = [], sel = this.sel;\n    for (var i = 0; i < sel.ranges.length; i++) {\n      var range$$1 = sel.ranges[i];\n      changes[i] = {from: range$$1.from(), to: range$$1.to(), text: this$1.splitLines(code[i]), origin: origin};\n    }\n    var newSel = collapse && collapse != \"end\" && computeReplacedSel(this, changes, collapse);\n    for (var i$1 = changes.length - 1; i$1 >= 0; i$1--)\n      { makeChange(this$1, changes[i$1]); }\n    if (newSel) { setSelectionReplaceHistory(this, newSel); }\n    else if (this.cm) { ensureCursorVisible(this.cm); }\n  }),\n  undo: docMethodOp(function() {makeChangeFromHistory(this, \"undo\");}),\n  redo: docMethodOp(function() {makeChangeFromHistory(this, \"redo\");}),\n  undoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"undo\", true);}),\n  redoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"redo\", true);}),\n\n  setExtending: function(val) {this.extend = val;},\n  getExtending: function() {return this.extend},\n\n  historySize: function() {\n    var hist = this.history, done = 0, undone = 0;\n    for (var i = 0; i < hist.done.length; i++) { if (!hist.done[i].ranges) { ++done; } }\n    for (var i$1 = 0; i$1 < hist.undone.length; i$1++) { if (!hist.undone[i$1].ranges) { ++undone; } }\n    return {undo: done, redo: undone}\n  },\n  clearHistory: function() {this.history = new History(this.history.maxGeneration);},\n\n  markClean: function() {\n    this.cleanGeneration = this.changeGeneration(true);\n  },\n  changeGeneration: function(forceSplit) {\n    if (forceSplit)\n      { this.history.lastOp = this.history.lastSelOp = this.history.lastOrigin = null; }\n    return this.history.generation\n  },\n  isClean: function (gen) {\n    return this.history.generation == (gen || this.cleanGeneration)\n  },\n\n  getHistory: function() {\n    return {done: copyHistoryArray(this.history.done),\n            undone: copyHistoryArray(this.history.undone)}\n  },\n  setHistory: function(histData) {\n    var hist = this.history = new History(this.history.maxGeneration);\n    hist.done = copyHistoryArray(histData.done.slice(0), null, true);\n    hist.undone = copyHistoryArray(histData.undone.slice(0), null, true);\n  },\n\n  setGutterMarker: docMethodOp(function(line, gutterID, value) {\n    return changeLine(this, line, \"gutter\", function (line) {\n      var markers = line.gutterMarkers || (line.gutterMarkers = {});\n      markers[gutterID] = value;\n      if (!value && isEmpty(markers)) { line.gutterMarkers = null; }\n      return true\n    })\n  }),\n\n  clearGutter: docMethodOp(function(gutterID) {\n    var this$1 = this;\n\n    this.iter(function (line) {\n      if (line.gutterMarkers && line.gutterMarkers[gutterID]) {\n        changeLine(this$1, line, \"gutter\", function () {\n          line.gutterMarkers[gutterID] = null;\n          if (isEmpty(line.gutterMarkers)) { line.gutterMarkers = null; }\n          return true\n        });\n      }\n    });\n  }),\n\n  lineInfo: function(line) {\n    var n;\n    if (typeof line == \"number\") {\n      if (!isLine(this, line)) { return null }\n      n = line;\n      line = getLine(this, line);\n      if (!line) { return null }\n    } else {\n      n = lineNo(line);\n      if (n == null) { return null }\n    }\n    return {line: n, handle: line, text: line.text, gutterMarkers: line.gutterMarkers,\n            textClass: line.textClass, bgClass: line.bgClass, wrapClass: line.wrapClass,\n            widgets: line.widgets}\n  },\n\n  addLineClass: docMethodOp(function(handle, where, cls) {\n    return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n      var prop = where == \"text\" ? \"textClass\"\n               : where == \"background\" ? \"bgClass\"\n               : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n      if (!line[prop]) { line[prop] = cls; }\n      else if (classTest(cls).test(line[prop])) { return false }\n      else { line[prop] += \" \" + cls; }\n      return true\n    })\n  }),\n  removeLineClass: docMethodOp(function(handle, where, cls) {\n    return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n      var prop = where == \"text\" ? \"textClass\"\n               : where == \"background\" ? \"bgClass\"\n               : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n      var cur = line[prop];\n      if (!cur) { return false }\n      else if (cls == null) { line[prop] = null; }\n      else {\n        var found = cur.match(classTest(cls));\n        if (!found) { return false }\n        var end = found.index + found[0].length;\n        line[prop] = cur.slice(0, found.index) + (!found.index || end == cur.length ? \"\" : \" \") + cur.slice(end) || null;\n      }\n      return true\n    })\n  }),\n\n  addLineWidget: docMethodOp(function(handle, node, options) {\n    return addLineWidget(this, handle, node, options)\n  }),\n  removeLineWidget: function(widget) { widget.clear(); },\n\n  markText: function(from, to, options) {\n    return markText(this, clipPos(this, from), clipPos(this, to), options, options && options.type || \"range\")\n  },\n  setBookmark: function(pos, options) {\n    var realOpts = {replacedWith: options && (options.nodeType == null ? options.widget : options),\n                    insertLeft: options && options.insertLeft,\n                    clearWhenEmpty: false, shared: options && options.shared,\n                    handleMouseEvents: options && options.handleMouseEvents};\n    pos = clipPos(this, pos);\n    return markText(this, pos, pos, realOpts, \"bookmark\")\n  },\n  findMarksAt: function(pos) {\n    pos = clipPos(this, pos);\n    var markers = [], spans = getLine(this, pos.line).markedSpans;\n    if (spans) { for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if ((span.from == null || span.from <= pos.ch) &&\n          (span.to == null || span.to >= pos.ch))\n        { markers.push(span.marker.parent || span.marker); }\n    } }\n    return markers\n  },\n  findMarks: function(from, to, filter) {\n    from = clipPos(this, from); to = clipPos(this, to);\n    var found = [], lineNo$$1 = from.line;\n    this.iter(from.line, to.line + 1, function (line) {\n      var spans = line.markedSpans;\n      if (spans) { for (var i = 0; i < spans.length; i++) {\n        var span = spans[i];\n        if (!(span.to != null && lineNo$$1 == from.line && from.ch >= span.to ||\n              span.from == null && lineNo$$1 != from.line ||\n              span.from != null && lineNo$$1 == to.line && span.from >= to.ch) &&\n            (!filter || filter(span.marker)))\n          { found.push(span.marker.parent || span.marker); }\n      } }\n      ++lineNo$$1;\n    });\n    return found\n  },\n  getAllMarks: function() {\n    var markers = [];\n    this.iter(function (line) {\n      var sps = line.markedSpans;\n      if (sps) { for (var i = 0; i < sps.length; ++i)\n        { if (sps[i].from != null) { markers.push(sps[i].marker); } } }\n    });\n    return markers\n  },\n\n  posFromIndex: function(off) {\n    var ch, lineNo$$1 = this.first, sepSize = this.lineSeparator().length;\n    this.iter(function (line) {\n      var sz = line.text.length + sepSize;\n      if (sz > off) { ch = off; return true }\n      off -= sz;\n      ++lineNo$$1;\n    });\n    return clipPos(this, Pos(lineNo$$1, ch))\n  },\n  indexFromPos: function (coords) {\n    coords = clipPos(this, coords);\n    var index = coords.ch;\n    if (coords.line < this.first || coords.ch < 0) { return 0 }\n    var sepSize = this.lineSeparator().length;\n    this.iter(this.first, coords.line, function (line) { // iter aborts when callback returns a truthy value\n      index += line.text.length + sepSize;\n    });\n    return index\n  },\n\n  copy: function(copyHistory) {\n    var doc = new Doc(getLines(this, this.first, this.first + this.size),\n                      this.modeOption, this.first, this.lineSep, this.direction);\n    doc.scrollTop = this.scrollTop; doc.scrollLeft = this.scrollLeft;\n    doc.sel = this.sel;\n    doc.extend = false;\n    if (copyHistory) {\n      doc.history.undoDepth = this.history.undoDepth;\n      doc.setHistory(this.getHistory());\n    }\n    return doc\n  },\n\n  linkedDoc: function(options) {\n    if (!options) { options = {}; }\n    var from = this.first, to = this.first + this.size;\n    if (options.from != null && options.from > from) { from = options.from; }\n    if (options.to != null && options.to < to) { to = options.to; }\n    var copy = new Doc(getLines(this, from, to), options.mode || this.modeOption, from, this.lineSep, this.direction);\n    if (options.sharedHist) { copy.history = this.history\n    ; }(this.linked || (this.linked = [])).push({doc: copy, sharedHist: options.sharedHist});\n    copy.linked = [{doc: this, isParent: true, sharedHist: options.sharedHist}];\n    copySharedMarkers(copy, findSharedMarkers(this));\n    return copy\n  },\n  unlinkDoc: function(other) {\n    var this$1 = this;\n\n    if (other instanceof CodeMirror$1) { other = other.doc; }\n    if (this.linked) { for (var i = 0; i < this.linked.length; ++i) {\n      var link = this$1.linked[i];\n      if (link.doc != other) { continue }\n      this$1.linked.splice(i, 1);\n      other.unlinkDoc(this$1);\n      detachSharedMarkers(findSharedMarkers(this$1));\n      break\n    } }\n    // If the histories were shared, split them again\n    if (other.history == this.history) {\n      var splitIds = [other.id];\n      linkedDocs(other, function (doc) { return splitIds.push(doc.id); }, true);\n      other.history = new History(null);\n      other.history.done = copyHistoryArray(this.history.done, splitIds);\n      other.history.undone = copyHistoryArray(this.history.undone, splitIds);\n    }\n  },\n  iterLinkedDocs: function(f) {linkedDocs(this, f);},\n\n  getMode: function() {return this.mode},\n  getEditor: function() {return this.cm},\n\n  splitLines: function(str) {\n    if (this.lineSep) { return str.split(this.lineSep) }\n    return splitLinesAuto(str)\n  },\n  lineSeparator: function() { return this.lineSep || \"\\n\" },\n\n  setDirection: docMethodOp(function (dir) {\n    if (dir != \"rtl\") { dir = \"ltr\"; }\n    if (dir == this.direction) { return }\n    this.direction = dir;\n    this.iter(function (line) { return line.order = null; });\n    if (this.cm) { directionChanged(this.cm); }\n  })\n});\n\n// Public alias.\nDoc.prototype.eachLine = Doc.prototype.iter;\n\n// Kludge to work around strange IE behavior where it'll sometimes\n// re-fire a series of drag-related events right after the drop (#1551)\nvar lastDrop = 0;\n\nfunction onDrop(e) {\n  var cm = this;\n  clearDragCursor(cm);\n  if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e))\n    { return }\n  e_preventDefault(e);\n  if (ie) { lastDrop = +new Date; }\n  var pos = posFromMouse(cm, e, true), files = e.dataTransfer.files;\n  if (!pos || cm.isReadOnly()) { return }\n  // Might be a file drop, in which case we simply extract the text\n  // and insert it.\n  if (files && files.length && window.FileReader && window.File) {\n    var n = files.length, text = Array(n), read = 0;\n    var loadFile = function (file, i) {\n      if (cm.options.allowDropFileTypes &&\n          indexOf(cm.options.allowDropFileTypes, file.type) == -1)\n        { return }\n\n      var reader = new FileReader;\n      reader.onload = operation(cm, function () {\n        var content = reader.result;\n        if (/[\\x00-\\x08\\x0e-\\x1f]{2}/.test(content)) { content = \"\"; }\n        text[i] = content;\n        if (++read == n) {\n          pos = clipPos(cm.doc, pos);\n          var change = {from: pos, to: pos,\n                        text: cm.doc.splitLines(text.join(cm.doc.lineSeparator())),\n                        origin: \"paste\"};\n          makeChange(cm.doc, change);\n          setSelectionReplaceHistory(cm.doc, simpleSelection(pos, changeEnd(change)));\n        }\n      });\n      reader.readAsText(file);\n    };\n    for (var i = 0; i < n; ++i) { loadFile(files[i], i); }\n  } else { // Normal drop\n    // Don't do a replace if the drop happened inside of the selected text.\n    if (cm.state.draggingText && cm.doc.sel.contains(pos) > -1) {\n      cm.state.draggingText(e);\n      // Ensure the editor is re-focused\n      setTimeout(function () { return cm.display.input.focus(); }, 20);\n      return\n    }\n    try {\n      var text$1 = e.dataTransfer.getData(\"Text\");\n      if (text$1) {\n        var selected;\n        if (cm.state.draggingText && !cm.state.draggingText.copy)\n          { selected = cm.listSelections(); }\n        setSelectionNoUndo(cm.doc, simpleSelection(pos, pos));\n        if (selected) { for (var i$1 = 0; i$1 < selected.length; ++i$1)\n          { replaceRange(cm.doc, \"\", selected[i$1].anchor, selected[i$1].head, \"drag\"); } }\n        cm.replaceSelection(text$1, \"around\", \"paste\");\n        cm.display.input.focus();\n      }\n    }\n    catch(e){}\n  }\n}\n\nfunction onDragStart(cm, e) {\n  if (ie && (!cm.state.draggingText || +new Date - lastDrop < 100)) { e_stop(e); return }\n  if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e)) { return }\n\n  e.dataTransfer.setData(\"Text\", cm.getSelection());\n  e.dataTransfer.effectAllowed = \"copyMove\";\n\n  // Use dummy image instead of default browsers image.\n  // Recent Safari (~6.0.2) have a tendency to segfault when this happens, so we don't do it there.\n  if (e.dataTransfer.setDragImage && !safari) {\n    var img = elt(\"img\", null, null, \"position: fixed; left: 0; top: 0;\");\n    img.src = \"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\";\n    if (presto) {\n      img.width = img.height = 1;\n      cm.display.wrapper.appendChild(img);\n      // Force a relayout, or Opera won't use our image for some obscure reason\n      img._top = img.offsetTop;\n    }\n    e.dataTransfer.setDragImage(img, 0, 0);\n    if (presto) { img.parentNode.removeChild(img); }\n  }\n}\n\nfunction onDragOver(cm, e) {\n  var pos = posFromMouse(cm, e);\n  if (!pos) { return }\n  var frag = document.createDocumentFragment();\n  drawSelectionCursor(cm, pos, frag);\n  if (!cm.display.dragCursor) {\n    cm.display.dragCursor = elt(\"div\", null, \"CodeMirror-cursors CodeMirror-dragcursors\");\n    cm.display.lineSpace.insertBefore(cm.display.dragCursor, cm.display.cursorDiv);\n  }\n  removeChildrenAndAdd(cm.display.dragCursor, frag);\n}\n\nfunction clearDragCursor(cm) {\n  if (cm.display.dragCursor) {\n    cm.display.lineSpace.removeChild(cm.display.dragCursor);\n    cm.display.dragCursor = null;\n  }\n}\n\n// These must be handled carefully, because naively registering a\n// handler for each editor will cause the editors to never be\n// garbage collected.\n\nfunction forEachCodeMirror(f) {\n  if (!document.getElementsByClassName) { return }\n  var byClass = document.getElementsByClassName(\"CodeMirror\");\n  for (var i = 0; i < byClass.length; i++) {\n    var cm = byClass[i].CodeMirror;\n    if (cm) { f(cm); }\n  }\n}\n\nvar globalsRegistered = false;\nfunction ensureGlobalHandlers() {\n  if (globalsRegistered) { return }\n  registerGlobalHandlers();\n  globalsRegistered = true;\n}\nfunction registerGlobalHandlers() {\n  // When the window resizes, we need to refresh active editors.\n  var resizeTimer;\n  on(window, \"resize\", function () {\n    if (resizeTimer == null) { resizeTimer = setTimeout(function () {\n      resizeTimer = null;\n      forEachCodeMirror(onResize);\n    }, 100); }\n  });\n  // When the window loses focus, we want to show the editor as blurred\n  on(window, \"blur\", function () { return forEachCodeMirror(onBlur); });\n}\n// Called when the window resizes\nfunction onResize(cm) {\n  var d = cm.display;\n  if (d.lastWrapHeight == d.wrapper.clientHeight && d.lastWrapWidth == d.wrapper.clientWidth)\n    { return }\n  // Might be a text scaling operation, clear size caches.\n  d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n  d.scrollbarsClipped = false;\n  cm.setSize();\n}\n\nvar keyNames = {\n  3: \"Enter\", 8: \"Backspace\", 9: \"Tab\", 13: \"Enter\", 16: \"Shift\", 17: \"Ctrl\", 18: \"Alt\",\n  19: \"Pause\", 20: \"CapsLock\", 27: \"Esc\", 32: \"Space\", 33: \"PageUp\", 34: \"PageDown\", 35: \"End\",\n  36: \"Home\", 37: \"Left\", 38: \"Up\", 39: \"Right\", 40: \"Down\", 44: \"PrintScrn\", 45: \"Insert\",\n  46: \"Delete\", 59: \";\", 61: \"=\", 91: \"Mod\", 92: \"Mod\", 93: \"Mod\",\n  106: \"*\", 107: \"=\", 109: \"-\", 110: \".\", 111: \"/\", 127: \"Delete\",\n  173: \"-\", 186: \";\", 187: \"=\", 188: \",\", 189: \"-\", 190: \".\", 191: \"/\", 192: \"`\", 219: \"[\", 220: \"\\\\\",\n  221: \"]\", 222: \"'\", 63232: \"Up\", 63233: \"Down\", 63234: \"Left\", 63235: \"Right\", 63272: \"Delete\",\n  63273: \"Home\", 63275: \"End\", 63276: \"PageUp\", 63277: \"PageDown\", 63302: \"Insert\"\n};\n\n// Number keys\nfor (var i = 0; i < 10; i++) { keyNames[i + 48] = keyNames[i + 96] = String(i); }\n// Alphabetic keys\nfor (var i$1 = 65; i$1 <= 90; i$1++) { keyNames[i$1] = String.fromCharCode(i$1); }\n// Function keys\nfor (var i$2 = 1; i$2 <= 12; i$2++) { keyNames[i$2 + 111] = keyNames[i$2 + 63235] = \"F\" + i$2; }\n\nvar keyMap = {};\n\nkeyMap.basic = {\n  \"Left\": \"goCharLeft\", \"Right\": \"goCharRight\", \"Up\": \"goLineUp\", \"Down\": \"goLineDown\",\n  \"End\": \"goLineEnd\", \"Home\": \"goLineStartSmart\", \"PageUp\": \"goPageUp\", \"PageDown\": \"goPageDown\",\n  \"Delete\": \"delCharAfter\", \"Backspace\": \"delCharBefore\", \"Shift-Backspace\": \"delCharBefore\",\n  \"Tab\": \"defaultTab\", \"Shift-Tab\": \"indentAuto\",\n  \"Enter\": \"newlineAndIndent\", \"Insert\": \"toggleOverwrite\",\n  \"Esc\": \"singleSelection\"\n};\n// Note that the save and find-related commands aren't defined by\n// default. User code or addons can define them. Unknown commands\n// are simply ignored.\nkeyMap.pcDefault = {\n  \"Ctrl-A\": \"selectAll\", \"Ctrl-D\": \"deleteLine\", \"Ctrl-Z\": \"undo\", \"Shift-Ctrl-Z\": \"redo\", \"Ctrl-Y\": \"redo\",\n  \"Ctrl-Home\": \"goDocStart\", \"Ctrl-End\": \"goDocEnd\", \"Ctrl-Up\": \"goLineUp\", \"Ctrl-Down\": \"goLineDown\",\n  \"Ctrl-Left\": \"goGroupLeft\", \"Ctrl-Right\": \"goGroupRight\", \"Alt-Left\": \"goLineStart\", \"Alt-Right\": \"goLineEnd\",\n  \"Ctrl-Backspace\": \"delGroupBefore\", \"Ctrl-Delete\": \"delGroupAfter\", \"Ctrl-S\": \"save\", \"Ctrl-F\": \"find\",\n  \"Ctrl-G\": \"findNext\", \"Shift-Ctrl-G\": \"findPrev\", \"Shift-Ctrl-F\": \"replace\", \"Shift-Ctrl-R\": \"replaceAll\",\n  \"Ctrl-[\": \"indentLess\", \"Ctrl-]\": \"indentMore\",\n  \"Ctrl-U\": \"undoSelection\", \"Shift-Ctrl-U\": \"redoSelection\", \"Alt-U\": \"redoSelection\",\n  fallthrough: \"basic\"\n};\n// Very basic readline/emacs-style bindings, which are standard on Mac.\nkeyMap.emacsy = {\n  \"Ctrl-F\": \"goCharRight\", \"Ctrl-B\": \"goCharLeft\", \"Ctrl-P\": \"goLineUp\", \"Ctrl-N\": \"goLineDown\",\n  \"Alt-F\": \"goWordRight\", \"Alt-B\": \"goWordLeft\", \"Ctrl-A\": \"goLineStart\", \"Ctrl-E\": \"goLineEnd\",\n  \"Ctrl-V\": \"goPageDown\", \"Shift-Ctrl-V\": \"goPageUp\", \"Ctrl-D\": \"delCharAfter\", \"Ctrl-H\": \"delCharBefore\",\n  \"Alt-D\": \"delWordAfter\", \"Alt-Backspace\": \"delWordBefore\", \"Ctrl-K\": \"killLine\", \"Ctrl-T\": \"transposeChars\",\n  \"Ctrl-O\": \"openLine\"\n};\nkeyMap.macDefault = {\n  \"Cmd-A\": \"selectAll\", \"Cmd-D\": \"deleteLine\", \"Cmd-Z\": \"undo\", \"Shift-Cmd-Z\": \"redo\", \"Cmd-Y\": \"redo\",\n  \"Cmd-Home\": \"goDocStart\", \"Cmd-Up\": \"goDocStart\", \"Cmd-End\": \"goDocEnd\", \"Cmd-Down\": \"goDocEnd\", \"Alt-Left\": \"goGroupLeft\",\n  \"Alt-Right\": \"goGroupRight\", \"Cmd-Left\": \"goLineLeft\", \"Cmd-Right\": \"goLineRight\", \"Alt-Backspace\": \"delGroupBefore\",\n  \"Ctrl-Alt-Backspace\": \"delGroupAfter\", \"Alt-Delete\": \"delGroupAfter\", \"Cmd-S\": \"save\", \"Cmd-F\": \"find\",\n  \"Cmd-G\": \"findNext\", \"Shift-Cmd-G\": \"findPrev\", \"Cmd-Alt-F\": \"replace\", \"Shift-Cmd-Alt-F\": \"replaceAll\",\n  \"Cmd-[\": \"indentLess\", \"Cmd-]\": \"indentMore\", \"Cmd-Backspace\": \"delWrappedLineLeft\", \"Cmd-Delete\": \"delWrappedLineRight\",\n  \"Cmd-U\": \"undoSelection\", \"Shift-Cmd-U\": \"redoSelection\", \"Ctrl-Up\": \"goDocStart\", \"Ctrl-Down\": \"goDocEnd\",\n  fallthrough: [\"basic\", \"emacsy\"]\n};\nkeyMap[\"default\"] = mac ? keyMap.macDefault : keyMap.pcDefault;\n\n// KEYMAP DISPATCH\n\nfunction normalizeKeyName(name) {\n  var parts = name.split(/-(?!$)/);\n  name = parts[parts.length - 1];\n  var alt, ctrl, shift, cmd;\n  for (var i = 0; i < parts.length - 1; i++) {\n    var mod = parts[i];\n    if (/^(cmd|meta|m)$/i.test(mod)) { cmd = true; }\n    else if (/^a(lt)?$/i.test(mod)) { alt = true; }\n    else if (/^(c|ctrl|control)$/i.test(mod)) { ctrl = true; }\n    else if (/^s(hift)?$/i.test(mod)) { shift = true; }\n    else { throw new Error(\"Unrecognized modifier name: \" + mod) }\n  }\n  if (alt) { name = \"Alt-\" + name; }\n  if (ctrl) { name = \"Ctrl-\" + name; }\n  if (cmd) { name = \"Cmd-\" + name; }\n  if (shift) { name = \"Shift-\" + name; }\n  return name\n}\n\n// This is a kludge to keep keymaps mostly working as raw objects\n// (backwards compatibility) while at the same time support features\n// like normalization and multi-stroke key bindings. It compiles a\n// new normalized keymap, and then updates the old object to reflect\n// this.\nfunction normalizeKeyMap(keymap) {\n  var copy = {};\n  for (var keyname in keymap) { if (keymap.hasOwnProperty(keyname)) {\n    var value = keymap[keyname];\n    if (/^(name|fallthrough|(de|at)tach)$/.test(keyname)) { continue }\n    if (value == \"...\") { delete keymap[keyname]; continue }\n\n    var keys = map(keyname.split(\" \"), normalizeKeyName);\n    for (var i = 0; i < keys.length; i++) {\n      var val = (void 0), name = (void 0);\n      if (i == keys.length - 1) {\n        name = keys.join(\" \");\n        val = value;\n      } else {\n        name = keys.slice(0, i + 1).join(\" \");\n        val = \"...\";\n      }\n      var prev = copy[name];\n      if (!prev) { copy[name] = val; }\n      else if (prev != val) { throw new Error(\"Inconsistent bindings for \" + name) }\n    }\n    delete keymap[keyname];\n  } }\n  for (var prop in copy) { keymap[prop] = copy[prop]; }\n  return keymap\n}\n\nfunction lookupKey(key, map$$1, handle, context) {\n  map$$1 = getKeyMap(map$$1);\n  var found = map$$1.call ? map$$1.call(key, context) : map$$1[key];\n  if (found === false) { return \"nothing\" }\n  if (found === \"...\") { return \"multi\" }\n  if (found != null && handle(found)) { return \"handled\" }\n\n  if (map$$1.fallthrough) {\n    if (Object.prototype.toString.call(map$$1.fallthrough) != \"[object Array]\")\n      { return lookupKey(key, map$$1.fallthrough, handle, context) }\n    for (var i = 0; i < map$$1.fallthrough.length; i++) {\n      var result = lookupKey(key, map$$1.fallthrough[i], handle, context);\n      if (result) { return result }\n    }\n  }\n}\n\n// Modifier key presses don't count as 'real' key presses for the\n// purpose of keymap fallthrough.\nfunction isModifierKey(value) {\n  var name = typeof value == \"string\" ? value : keyNames[value.keyCode];\n  return name == \"Ctrl\" || name == \"Alt\" || name == \"Shift\" || name == \"Mod\"\n}\n\nfunction addModifierNames(name, event, noShift) {\n  var base = name;\n  if (event.altKey && base != \"Alt\") { name = \"Alt-\" + name; }\n  if ((flipCtrlCmd ? event.metaKey : event.ctrlKey) && base != \"Ctrl\") { name = \"Ctrl-\" + name; }\n  if ((flipCtrlCmd ? event.ctrlKey : event.metaKey) && base != \"Cmd\") { name = \"Cmd-\" + name; }\n  if (!noShift && event.shiftKey && base != \"Shift\") { name = \"Shift-\" + name; }\n  return name\n}\n\n// Look up the name of a key as indicated by an event object.\nfunction keyName(event, noShift) {\n  if (presto && event.keyCode == 34 && event[\"char\"]) { return false }\n  var name = keyNames[event.keyCode];\n  if (name == null || event.altGraphKey) { return false }\n  return addModifierNames(name, event, noShift)\n}\n\nfunction getKeyMap(val) {\n  return typeof val == \"string\" ? keyMap[val] : val\n}\n\n// Helper for deleting text near the selection(s), used to implement\n// backspace, delete, and similar functionality.\nfunction deleteNearSelection(cm, compute) {\n  var ranges = cm.doc.sel.ranges, kill = [];\n  // Build up a set of ranges to kill first, merging overlapping\n  // ranges.\n  for (var i = 0; i < ranges.length; i++) {\n    var toKill = compute(ranges[i]);\n    while (kill.length && cmp(toKill.from, lst(kill).to) <= 0) {\n      var replaced = kill.pop();\n      if (cmp(replaced.from, toKill.from) < 0) {\n        toKill.from = replaced.from;\n        break\n      }\n    }\n    kill.push(toKill);\n  }\n  // Next, remove those actual ranges.\n  runInOp(cm, function () {\n    for (var i = kill.length - 1; i >= 0; i--)\n      { replaceRange(cm.doc, \"\", kill[i].from, kill[i].to, \"+delete\"); }\n    ensureCursorVisible(cm);\n  });\n}\n\nfunction moveCharLogically(line, ch, dir) {\n  var target = skipExtendingChars(line.text, ch + dir, dir);\n  return target < 0 || target > line.text.length ? null : target\n}\n\nfunction moveLogically(line, start, dir) {\n  var ch = moveCharLogically(line, start.ch, dir);\n  return ch == null ? null : new Pos(start.line, ch, dir < 0 ? \"after\" : \"before\")\n}\n\nfunction endOfLine(visually, cm, lineObj, lineNo, dir) {\n  if (visually) {\n    var order = getOrder(lineObj, cm.doc.direction);\n    if (order) {\n      var part = dir < 0 ? lst(order) : order[0];\n      var moveInStorageOrder = (dir < 0) == (part.level == 1);\n      var sticky = moveInStorageOrder ? \"after\" : \"before\";\n      var ch;\n      // With a wrapped rtl chunk (possibly spanning multiple bidi parts),\n      // it could be that the last bidi part is not on the last visual line,\n      // since visual lines contain content order-consecutive chunks.\n      // Thus, in rtl, we are looking for the first (content-order) character\n      // in the rtl chunk that is on the last line (that is, the same line\n      // as the last (content-order) character).\n      if (part.level > 0 || cm.doc.direction == \"rtl\") {\n        var prep = prepareMeasureForLine(cm, lineObj);\n        ch = dir < 0 ? lineObj.text.length - 1 : 0;\n        var targetTop = measureCharPrepared(cm, prep, ch).top;\n        ch = findFirst(function (ch) { return measureCharPrepared(cm, prep, ch).top == targetTop; }, (dir < 0) == (part.level == 1) ? part.from : part.to - 1, ch);\n        if (sticky == \"before\") { ch = moveCharLogically(lineObj, ch, 1); }\n      } else { ch = dir < 0 ? part.to : part.from; }\n      return new Pos(lineNo, ch, sticky)\n    }\n  }\n  return new Pos(lineNo, dir < 0 ? lineObj.text.length : 0, dir < 0 ? \"before\" : \"after\")\n}\n\nfunction moveVisually(cm, line, start, dir) {\n  var bidi = getOrder(line, cm.doc.direction);\n  if (!bidi) { return moveLogically(line, start, dir) }\n  if (start.ch >= line.text.length) {\n    start.ch = line.text.length;\n    start.sticky = \"before\";\n  } else if (start.ch <= 0) {\n    start.ch = 0;\n    start.sticky = \"after\";\n  }\n  var partPos = getBidiPartAt(bidi, start.ch, start.sticky), part = bidi[partPos];\n  if (cm.doc.direction == \"ltr\" && part.level % 2 == 0 && (dir > 0 ? part.to > start.ch : part.from < start.ch)) {\n    // Case 1: We move within an ltr part in an ltr editor. Even with wrapped lines,\n    // nothing interesting happens.\n    return moveLogically(line, start, dir)\n  }\n\n  var mv = function (pos, dir) { return moveCharLogically(line, pos instanceof Pos ? pos.ch : pos, dir); };\n  var prep;\n  var getWrappedLineExtent = function (ch) {\n    if (!cm.options.lineWrapping) { return {begin: 0, end: line.text.length} }\n    prep = prep || prepareMeasureForLine(cm, line);\n    return wrappedLineExtentChar(cm, line, prep, ch)\n  };\n  var wrappedLineExtent = getWrappedLineExtent(start.sticky == \"before\" ? mv(start, -1) : start.ch);\n\n  if (cm.doc.direction == \"rtl\" || part.level == 1) {\n    var moveInStorageOrder = (part.level == 1) == (dir < 0);\n    var ch = mv(start, moveInStorageOrder ? 1 : -1);\n    if (ch != null && (!moveInStorageOrder ? ch >= part.from && ch >= wrappedLineExtent.begin : ch <= part.to && ch <= wrappedLineExtent.end)) {\n      // Case 2: We move within an rtl part or in an rtl editor on the same visual line\n      var sticky = moveInStorageOrder ? \"before\" : \"after\";\n      return new Pos(start.line, ch, sticky)\n    }\n  }\n\n  // Case 3: Could not move within this bidi part in this visual line, so leave\n  // the current bidi part\n\n  var searchInVisualLine = function (partPos, dir, wrappedLineExtent) {\n    var getRes = function (ch, moveInStorageOrder) { return moveInStorageOrder\n      ? new Pos(start.line, mv(ch, 1), \"before\")\n      : new Pos(start.line, ch, \"after\"); };\n\n    for (; partPos >= 0 && partPos < bidi.length; partPos += dir) {\n      var part = bidi[partPos];\n      var moveInStorageOrder = (dir > 0) == (part.level != 1);\n      var ch = moveInStorageOrder ? wrappedLineExtent.begin : mv(wrappedLineExtent.end, -1);\n      if (part.from <= ch && ch < part.to) { return getRes(ch, moveInStorageOrder) }\n      ch = moveInStorageOrder ? part.from : mv(part.to, -1);\n      if (wrappedLineExtent.begin <= ch && ch < wrappedLineExtent.end) { return getRes(ch, moveInStorageOrder) }\n    }\n  };\n\n  // Case 3a: Look for other bidi parts on the same visual line\n  var res = searchInVisualLine(partPos + dir, dir, wrappedLineExtent);\n  if (res) { return res }\n\n  // Case 3b: Look for other bidi parts on the next visual line\n  var nextCh = dir > 0 ? wrappedLineExtent.end : mv(wrappedLineExtent.begin, -1);\n  if (nextCh != null && !(dir > 0 && nextCh == line.text.length)) {\n    res = searchInVisualLine(dir > 0 ? 0 : bidi.length - 1, dir, getWrappedLineExtent(nextCh));\n    if (res) { return res }\n  }\n\n  // Case 4: Nowhere to move\n  return null\n}\n\n// Commands are parameter-less actions that can be performed on an\n// editor, mostly used for keybindings.\nvar commands = {\n  selectAll: selectAll,\n  singleSelection: function (cm) { return cm.setSelection(cm.getCursor(\"anchor\"), cm.getCursor(\"head\"), sel_dontScroll); },\n  killLine: function (cm) { return deleteNearSelection(cm, function (range) {\n    if (range.empty()) {\n      var len = getLine(cm.doc, range.head.line).text.length;\n      if (range.head.ch == len && range.head.line < cm.lastLine())\n        { return {from: range.head, to: Pos(range.head.line + 1, 0)} }\n      else\n        { return {from: range.head, to: Pos(range.head.line, len)} }\n    } else {\n      return {from: range.from(), to: range.to()}\n    }\n  }); },\n  deleteLine: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n    from: Pos(range.from().line, 0),\n    to: clipPos(cm.doc, Pos(range.to().line + 1, 0))\n  }); }); },\n  delLineLeft: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n    from: Pos(range.from().line, 0), to: range.from()\n  }); }); },\n  delWrappedLineLeft: function (cm) { return deleteNearSelection(cm, function (range) {\n    var top = cm.charCoords(range.head, \"div\").top + 5;\n    var leftPos = cm.coordsChar({left: 0, top: top}, \"div\");\n    return {from: leftPos, to: range.from()}\n  }); },\n  delWrappedLineRight: function (cm) { return deleteNearSelection(cm, function (range) {\n    var top = cm.charCoords(range.head, \"div\").top + 5;\n    var rightPos = cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\");\n    return {from: range.from(), to: rightPos }\n  }); },\n  undo: function (cm) { return cm.undo(); },\n  redo: function (cm) { return cm.redo(); },\n  undoSelection: function (cm) { return cm.undoSelection(); },\n  redoSelection: function (cm) { return cm.redoSelection(); },\n  goDocStart: function (cm) { return cm.extendSelection(Pos(cm.firstLine(), 0)); },\n  goDocEnd: function (cm) { return cm.extendSelection(Pos(cm.lastLine())); },\n  goLineStart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStart(cm, range.head.line); },\n    {origin: \"+move\", bias: 1}\n  ); },\n  goLineStartSmart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStartSmart(cm, range.head); },\n    {origin: \"+move\", bias: 1}\n  ); },\n  goLineEnd: function (cm) { return cm.extendSelectionsBy(function (range) { return lineEnd(cm, range.head.line); },\n    {origin: \"+move\", bias: -1}\n  ); },\n  goLineRight: function (cm) { return cm.extendSelectionsBy(function (range) {\n    var top = cm.cursorCoords(range.head, \"div\").top + 5;\n    return cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\")\n  }, sel_move); },\n  goLineLeft: function (cm) { return cm.extendSelectionsBy(function (range) {\n    var top = cm.cursorCoords(range.head, \"div\").top + 5;\n    return cm.coordsChar({left: 0, top: top}, \"div\")\n  }, sel_move); },\n  goLineLeftSmart: function (cm) { return cm.extendSelectionsBy(function (range) {\n    var top = cm.cursorCoords(range.head, \"div\").top + 5;\n    var pos = cm.coordsChar({left: 0, top: top}, \"div\");\n    if (pos.ch < cm.getLine(pos.line).search(/\\S/)) { return lineStartSmart(cm, range.head) }\n    return pos\n  }, sel_move); },\n  goLineUp: function (cm) { return cm.moveV(-1, \"line\"); },\n  goLineDown: function (cm) { return cm.moveV(1, \"line\"); },\n  goPageUp: function (cm) { return cm.moveV(-1, \"page\"); },\n  goPageDown: function (cm) { return cm.moveV(1, \"page\"); },\n  goCharLeft: function (cm) { return cm.moveH(-1, \"char\"); },\n  goCharRight: function (cm) { return cm.moveH(1, \"char\"); },\n  goColumnLeft: function (cm) { return cm.moveH(-1, \"column\"); },\n  goColumnRight: function (cm) { return cm.moveH(1, \"column\"); },\n  goWordLeft: function (cm) { return cm.moveH(-1, \"word\"); },\n  goGroupRight: function (cm) { return cm.moveH(1, \"group\"); },\n  goGroupLeft: function (cm) { return cm.moveH(-1, \"group\"); },\n  goWordRight: function (cm) { return cm.moveH(1, \"word\"); },\n  delCharBefore: function (cm) { return cm.deleteH(-1, \"char\"); },\n  delCharAfter: function (cm) { return cm.deleteH(1, \"char\"); },\n  delWordBefore: function (cm) { return cm.deleteH(-1, \"word\"); },\n  delWordAfter: function (cm) { return cm.deleteH(1, \"word\"); },\n  delGroupBefore: function (cm) { return cm.deleteH(-1, \"group\"); },\n  delGroupAfter: function (cm) { return cm.deleteH(1, \"group\"); },\n  indentAuto: function (cm) { return cm.indentSelection(\"smart\"); },\n  indentMore: function (cm) { return cm.indentSelection(\"add\"); },\n  indentLess: function (cm) { return cm.indentSelection(\"subtract\"); },\n  insertTab: function (cm) { return cm.replaceSelection(\"\\t\"); },\n  insertSoftTab: function (cm) {\n    var spaces = [], ranges = cm.listSelections(), tabSize = cm.options.tabSize;\n    for (var i = 0; i < ranges.length; i++) {\n      var pos = ranges[i].from();\n      var col = countColumn(cm.getLine(pos.line), pos.ch, tabSize);\n      spaces.push(spaceStr(tabSize - col % tabSize));\n    }\n    cm.replaceSelections(spaces);\n  },\n  defaultTab: function (cm) {\n    if (cm.somethingSelected()) { cm.indentSelection(\"add\"); }\n    else { cm.execCommand(\"insertTab\"); }\n  },\n  // Swap the two chars left and right of each selection's head.\n  // Move cursor behind the two swapped characters afterwards.\n  //\n  // Doesn't consider line feeds a character.\n  // Doesn't scan more than one line above to find a character.\n  // Doesn't do anything on an empty line.\n  // Doesn't do anything with non-empty selections.\n  transposeChars: function (cm) { return runInOp(cm, function () {\n    var ranges = cm.listSelections(), newSel = [];\n    for (var i = 0; i < ranges.length; i++) {\n      if (!ranges[i].empty()) { continue }\n      var cur = ranges[i].head, line = getLine(cm.doc, cur.line).text;\n      if (line) {\n        if (cur.ch == line.length) { cur = new Pos(cur.line, cur.ch - 1); }\n        if (cur.ch > 0) {\n          cur = new Pos(cur.line, cur.ch + 1);\n          cm.replaceRange(line.charAt(cur.ch - 1) + line.charAt(cur.ch - 2),\n                          Pos(cur.line, cur.ch - 2), cur, \"+transpose\");\n        } else if (cur.line > cm.doc.first) {\n          var prev = getLine(cm.doc, cur.line - 1).text;\n          if (prev) {\n            cur = new Pos(cur.line, 1);\n            cm.replaceRange(line.charAt(0) + cm.doc.lineSeparator() +\n                            prev.charAt(prev.length - 1),\n                            Pos(cur.line - 1, prev.length - 1), cur, \"+transpose\");\n          }\n        }\n      }\n      newSel.push(new Range(cur, cur));\n    }\n    cm.setSelections(newSel);\n  }); },\n  newlineAndIndent: function (cm) { return runInOp(cm, function () {\n    var sels = cm.listSelections();\n    for (var i = sels.length - 1; i >= 0; i--)\n      { cm.replaceRange(cm.doc.lineSeparator(), sels[i].anchor, sels[i].head, \"+input\"); }\n    sels = cm.listSelections();\n    for (var i$1 = 0; i$1 < sels.length; i$1++)\n      { cm.indentLine(sels[i$1].from().line, null, true); }\n    ensureCursorVisible(cm);\n  }); },\n  openLine: function (cm) { return cm.replaceSelection(\"\\n\", \"start\"); },\n  toggleOverwrite: function (cm) { return cm.toggleOverwrite(); }\n};\n\n\nfunction lineStart(cm, lineN) {\n  var line = getLine(cm.doc, lineN);\n  var visual = visualLine(line);\n  if (visual != line) { lineN = lineNo(visual); }\n  return endOfLine(true, cm, visual, lineN, 1)\n}\nfunction lineEnd(cm, lineN) {\n  var line = getLine(cm.doc, lineN);\n  var visual = visualLineEnd(line);\n  if (visual != line) { lineN = lineNo(visual); }\n  return endOfLine(true, cm, line, lineN, -1)\n}\nfunction lineStartSmart(cm, pos) {\n  var start = lineStart(cm, pos.line);\n  var line = getLine(cm.doc, start.line);\n  var order = getOrder(line, cm.doc.direction);\n  if (!order || order[0].level == 0) {\n    var firstNonWS = Math.max(0, line.text.search(/\\S/));\n    var inWS = pos.line == start.line && pos.ch <= firstNonWS && pos.ch;\n    return Pos(start.line, inWS ? 0 : firstNonWS, start.sticky)\n  }\n  return start\n}\n\n// Run a handler that was bound to a key.\nfunction doHandleBinding(cm, bound, dropShift) {\n  if (typeof bound == \"string\") {\n    bound = commands[bound];\n    if (!bound) { return false }\n  }\n  // Ensure previous input has been read, so that the handler sees a\n  // consistent view of the document\n  cm.display.input.ensurePolled();\n  var prevShift = cm.display.shift, done = false;\n  try {\n    if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\n    if (dropShift) { cm.display.shift = false; }\n    done = bound(cm) != Pass;\n  } finally {\n    cm.display.shift = prevShift;\n    cm.state.suppressEdits = false;\n  }\n  return done\n}\n\nfunction lookupKeyForEditor(cm, name, handle) {\n  for (var i = 0; i < cm.state.keyMaps.length; i++) {\n    var result = lookupKey(name, cm.state.keyMaps[i], handle, cm);\n    if (result) { return result }\n  }\n  return (cm.options.extraKeys && lookupKey(name, cm.options.extraKeys, handle, cm))\n    || lookupKey(name, cm.options.keyMap, handle, cm)\n}\n\n// Note that, despite the name, this function is also used to check\n// for bound mouse clicks.\n\nvar stopSeq = new Delayed;\n\nfunction dispatchKey(cm, name, e, handle) {\n  var seq = cm.state.keySeq;\n  if (seq) {\n    if (isModifierKey(name)) { return \"handled\" }\n    if (/\\'$/.test(name))\n      { cm.state.keySeq = null; }\n    else\n      { stopSeq.set(50, function () {\n        if (cm.state.keySeq == seq) {\n          cm.state.keySeq = null;\n          cm.display.input.reset();\n        }\n      }); }\n    if (dispatchKeyInner(cm, seq + \" \" + name, e, handle)) { return true }\n  }\n  return dispatchKeyInner(cm, name, e, handle)\n}\n\nfunction dispatchKeyInner(cm, name, e, handle) {\n  var result = lookupKeyForEditor(cm, name, handle);\n\n  if (result == \"multi\")\n    { cm.state.keySeq = name; }\n  if (result == \"handled\")\n    { signalLater(cm, \"keyHandled\", cm, name, e); }\n\n  if (result == \"handled\" || result == \"multi\") {\n    e_preventDefault(e);\n    restartBlink(cm);\n  }\n\n  return !!result\n}\n\n// Handle a key from the keydown event.\nfunction handleKeyBinding(cm, e) {\n  var name = keyName(e, true);\n  if (!name) { return false }\n\n  if (e.shiftKey && !cm.state.keySeq) {\n    // First try to resolve full name (including 'Shift-'). Failing\n    // that, see if there is a cursor-motion command (starting with\n    // 'go') bound to the keyname without 'Shift-'.\n    return dispatchKey(cm, \"Shift-\" + name, e, function (b) { return doHandleBinding(cm, b, true); })\n        || dispatchKey(cm, name, e, function (b) {\n             if (typeof b == \"string\" ? /^go[A-Z]/.test(b) : b.motion)\n               { return doHandleBinding(cm, b) }\n           })\n  } else {\n    return dispatchKey(cm, name, e, function (b) { return doHandleBinding(cm, b); })\n  }\n}\n\n// Handle a key from the keypress event\nfunction handleCharBinding(cm, e, ch) {\n  return dispatchKey(cm, \"'\" + ch + \"'\", e, function (b) { return doHandleBinding(cm, b, true); })\n}\n\nvar lastStoppedKey = null;\nfunction onKeyDown(e) {\n  var cm = this;\n  cm.curOp.focus = activeElt();\n  if (signalDOMEvent(cm, e)) { return }\n  // IE does strange things with escape.\n  if (ie && ie_version < 11 && e.keyCode == 27) { e.returnValue = false; }\n  var code = e.keyCode;\n  cm.display.shift = code == 16 || e.shiftKey;\n  var handled = handleKeyBinding(cm, e);\n  if (presto) {\n    lastStoppedKey = handled ? code : null;\n    // Opera has no cut event... we try to at least catch the key combo\n    if (!handled && code == 88 && !hasCopyEvent && (mac ? e.metaKey : e.ctrlKey))\n      { cm.replaceSelection(\"\", null, \"cut\"); }\n  }\n\n  // Turn mouse into crosshair when Alt is held on Mac.\n  if (code == 18 && !/\\bCodeMirror-crosshair\\b/.test(cm.display.lineDiv.className))\n    { showCrossHair(cm); }\n}\n\nfunction showCrossHair(cm) {\n  var lineDiv = cm.display.lineDiv;\n  addClass(lineDiv, \"CodeMirror-crosshair\");\n\n  function up(e) {\n    if (e.keyCode == 18 || !e.altKey) {\n      rmClass(lineDiv, \"CodeMirror-crosshair\");\n      off(document, \"keyup\", up);\n      off(document, \"mouseover\", up);\n    }\n  }\n  on(document, \"keyup\", up);\n  on(document, \"mouseover\", up);\n}\n\nfunction onKeyUp(e) {\n  if (e.keyCode == 16) { this.doc.sel.shift = false; }\n  signalDOMEvent(this, e);\n}\n\nfunction onKeyPress(e) {\n  var cm = this;\n  if (eventInWidget(cm.display, e) || signalDOMEvent(cm, e) || e.ctrlKey && !e.altKey || mac && e.metaKey) { return }\n  var keyCode = e.keyCode, charCode = e.charCode;\n  if (presto && keyCode == lastStoppedKey) {lastStoppedKey = null; e_preventDefault(e); return}\n  if ((presto && (!e.which || e.which < 10)) && handleKeyBinding(cm, e)) { return }\n  var ch = String.fromCharCode(charCode == null ? keyCode : charCode);\n  // Some browsers fire keypress events for backspace\n  if (ch == \"\\x08\") { return }\n  if (handleCharBinding(cm, e, ch)) { return }\n  cm.display.input.onKeyPress(e);\n}\n\nvar DOUBLECLICK_DELAY = 400;\n\nvar PastClick = function(time, pos, button) {\n  this.time = time;\n  this.pos = pos;\n  this.button = button;\n};\n\nPastClick.prototype.compare = function (time, pos, button) {\n  return this.time + DOUBLECLICK_DELAY > time &&\n    cmp(pos, this.pos) == 0 && button == this.button\n};\n\nvar lastClick;\nvar lastDoubleClick;\nfunction clickRepeat(pos, button) {\n  var now = +new Date;\n  if (lastDoubleClick && lastDoubleClick.compare(now, pos, button)) {\n    lastClick = lastDoubleClick = null;\n    return \"triple\"\n  } else if (lastClick && lastClick.compare(now, pos, button)) {\n    lastDoubleClick = new PastClick(now, pos, button);\n    lastClick = null;\n    return \"double\"\n  } else {\n    lastClick = new PastClick(now, pos, button);\n    lastDoubleClick = null;\n    return \"single\"\n  }\n}\n\n// A mouse down can be a single click, double click, triple click,\n// start of selection drag, start of text drag, new cursor\n// (ctrl-click), rectangle drag (alt-drag), or xwin\n// middle-click-paste. Or it might be a click on something we should\n// not interfere with, such as a scrollbar or widget.\nfunction onMouseDown(e) {\n  var cm = this, display = cm.display;\n  if (signalDOMEvent(cm, e) || display.activeTouch && display.input.supportsTouch()) { return }\n  display.input.ensurePolled();\n  display.shift = e.shiftKey;\n\n  if (eventInWidget(display, e)) {\n    if (!webkit) {\n      // Briefly turn off draggability, to allow widgets to do\n      // normal dragging things.\n      display.scroller.draggable = false;\n      setTimeout(function () { return display.scroller.draggable = true; }, 100);\n    }\n    return\n  }\n  if (clickInGutter(cm, e)) { return }\n  var pos = posFromMouse(cm, e), button = e_button(e), repeat = pos ? clickRepeat(pos, button) : \"single\";\n  window.focus();\n\n  // #3261: make sure, that we're not starting a second selection\n  if (button == 1 && cm.state.selectingText)\n    { cm.state.selectingText(e); }\n\n  if (pos && handleMappedButton(cm, button, pos, repeat, e)) { return }\n\n  if (button == 1) {\n    if (pos) { leftButtonDown(cm, pos, repeat, e); }\n    else if (e_target(e) == display.scroller) { e_preventDefault(e); }\n  } else if (button == 2) {\n    if (pos) { extendSelection(cm.doc, pos); }\n    setTimeout(function () { return display.input.focus(); }, 20);\n  } else if (button == 3) {\n    if (captureRightClick) { onContextMenu(cm, e); }\n    else { delayBlurEvent(cm); }\n  }\n}\n\nfunction handleMappedButton(cm, button, pos, repeat, event) {\n  var name = \"Click\";\n  if (repeat == \"double\") { name = \"Double\" + name; }\n  else if (repeat == \"triple\") { name = \"Triple\" + name; }\n  name = (button == 1 ? \"Left\" : button == 2 ? \"Middle\" : \"Right\") + name;\n\n  return dispatchKey(cm,  addModifierNames(name, event), event, function (bound) {\n    if (typeof bound == \"string\") { bound = commands[bound]; }\n    if (!bound) { return false }\n    var done = false;\n    try {\n      if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\n      done = bound(cm, pos) != Pass;\n    } finally {\n      cm.state.suppressEdits = false;\n    }\n    return done\n  })\n}\n\nfunction configureMouse(cm, repeat, event) {\n  var option = cm.getOption(\"configureMouse\");\n  var value = option ? option(cm, repeat, event) : {};\n  if (value.unit == null) {\n    var rect = chromeOS ? event.shiftKey && event.metaKey : event.altKey;\n    value.unit = rect ? \"rectangle\" : repeat == \"single\" ? \"char\" : repeat == \"double\" ? \"word\" : \"line\";\n  }\n  if (value.extend == null || cm.doc.extend) { value.extend = cm.doc.extend || event.shiftKey; }\n  if (value.addNew == null) { value.addNew = mac ? event.metaKey : event.ctrlKey; }\n  if (value.moveOnDrag == null) { value.moveOnDrag = !(mac ? event.altKey : event.ctrlKey); }\n  return value\n}\n\nfunction leftButtonDown(cm, pos, repeat, event) {\n  if (ie) { setTimeout(bind(ensureFocus, cm), 0); }\n  else { cm.curOp.focus = activeElt(); }\n\n  var behavior = configureMouse(cm, repeat, event);\n\n  var sel = cm.doc.sel, contained;\n  if (cm.options.dragDrop && dragAndDrop && !cm.isReadOnly() &&\n      repeat == \"single\" && (contained = sel.contains(pos)) > -1 &&\n      (cmp((contained = sel.ranges[contained]).from(), pos) < 0 || pos.xRel > 0) &&\n      (cmp(contained.to(), pos) > 0 || pos.xRel < 0))\n    { leftButtonStartDrag(cm, event, pos, behavior); }\n  else\n    { leftButtonSelect(cm, event, pos, behavior); }\n}\n\n// Start a text drag. When it ends, see if any dragging actually\n// happen, and treat as a click if it didn't.\nfunction leftButtonStartDrag(cm, event, pos, behavior) {\n  var display = cm.display, moved = false;\n  var dragEnd = operation(cm, function (e) {\n    if (webkit) { display.scroller.draggable = false; }\n    cm.state.draggingText = false;\n    off(document, \"mouseup\", dragEnd);\n    off(document, \"mousemove\", mouseMove);\n    off(display.scroller, \"dragstart\", dragStart);\n    off(display.scroller, \"drop\", dragEnd);\n    if (!moved) {\n      e_preventDefault(e);\n      if (!behavior.addNew)\n        { extendSelection(cm.doc, pos, null, null, behavior.extend); }\n      // Work around unexplainable focus problem in IE9 (#2127) and Chrome (#3081)\n      if (webkit || ie && ie_version == 9)\n        { setTimeout(function () {document.body.focus(); display.input.focus();}, 20); }\n      else\n        { display.input.focus(); }\n    }\n  });\n  var mouseMove = function(e2) {\n    moved = moved || Math.abs(event.clientX - e2.clientX) + Math.abs(event.clientY - e2.clientY) >= 10;\n  };\n  var dragStart = function () { return moved = true; };\n  // Let the drag handler handle this.\n  if (webkit) { display.scroller.draggable = true; }\n  cm.state.draggingText = dragEnd;\n  dragEnd.copy = !behavior.moveOnDrag;\n  // IE's approach to draggable\n  if (display.scroller.dragDrop) { display.scroller.dragDrop(); }\n  on(document, \"mouseup\", dragEnd);\n  on(document, \"mousemove\", mouseMove);\n  on(display.scroller, \"dragstart\", dragStart);\n  on(display.scroller, \"drop\", dragEnd);\n\n  delayBlurEvent(cm);\n  setTimeout(function () { return display.input.focus(); }, 20);\n}\n\nfunction rangeForUnit(cm, pos, unit) {\n  if (unit == \"char\") { return new Range(pos, pos) }\n  if (unit == \"word\") { return cm.findWordAt(pos) }\n  if (unit == \"line\") { return new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))) }\n  var result = unit(cm, pos);\n  return new Range(result.from, result.to)\n}\n\n// Normal selection, as opposed to text dragging.\nfunction leftButtonSelect(cm, event, start, behavior) {\n  var display = cm.display, doc = cm.doc;\n  e_preventDefault(event);\n\n  var ourRange, ourIndex, startSel = doc.sel, ranges = startSel.ranges;\n  if (behavior.addNew && !behavior.extend) {\n    ourIndex = doc.sel.contains(start);\n    if (ourIndex > -1)\n      { ourRange = ranges[ourIndex]; }\n    else\n      { ourRange = new Range(start, start); }\n  } else {\n    ourRange = doc.sel.primary();\n    ourIndex = doc.sel.primIndex;\n  }\n\n  if (behavior.unit == \"rectangle\") {\n    if (!behavior.addNew) { ourRange = new Range(start, start); }\n    start = posFromMouse(cm, event, true, true);\n    ourIndex = -1;\n  } else {\n    var range$$1 = rangeForUnit(cm, start, behavior.unit);\n    if (behavior.extend)\n      { ourRange = extendRange(ourRange, range$$1.anchor, range$$1.head, behavior.extend); }\n    else\n      { ourRange = range$$1; }\n  }\n\n  if (!behavior.addNew) {\n    ourIndex = 0;\n    setSelection(doc, new Selection([ourRange], 0), sel_mouse);\n    startSel = doc.sel;\n  } else if (ourIndex == -1) {\n    ourIndex = ranges.length;\n    setSelection(doc, normalizeSelection(ranges.concat([ourRange]), ourIndex),\n                 {scroll: false, origin: \"*mouse\"});\n  } else if (ranges.length > 1 && ranges[ourIndex].empty() && behavior.unit == \"char\" && !behavior.extend) {\n    setSelection(doc, normalizeSelection(ranges.slice(0, ourIndex).concat(ranges.slice(ourIndex + 1)), 0),\n                 {scroll: false, origin: \"*mouse\"});\n    startSel = doc.sel;\n  } else {\n    replaceOneSelection(doc, ourIndex, ourRange, sel_mouse);\n  }\n\n  var lastPos = start;\n  function extendTo(pos) {\n    if (cmp(lastPos, pos) == 0) { return }\n    lastPos = pos;\n\n    if (behavior.unit == \"rectangle\") {\n      var ranges = [], tabSize = cm.options.tabSize;\n      var startCol = countColumn(getLine(doc, start.line).text, start.ch, tabSize);\n      var posCol = countColumn(getLine(doc, pos.line).text, pos.ch, tabSize);\n      var left = Math.min(startCol, posCol), right = Math.max(startCol, posCol);\n      for (var line = Math.min(start.line, pos.line), end = Math.min(cm.lastLine(), Math.max(start.line, pos.line));\n           line <= end; line++) {\n        var text = getLine(doc, line).text, leftPos = findColumn(text, left, tabSize);\n        if (left == right)\n          { ranges.push(new Range(Pos(line, leftPos), Pos(line, leftPos))); }\n        else if (text.length > leftPos)\n          { ranges.push(new Range(Pos(line, leftPos), Pos(line, findColumn(text, right, tabSize)))); }\n      }\n      if (!ranges.length) { ranges.push(new Range(start, start)); }\n      setSelection(doc, normalizeSelection(startSel.ranges.slice(0, ourIndex).concat(ranges), ourIndex),\n                   {origin: \"*mouse\", scroll: false});\n      cm.scrollIntoView(pos);\n    } else {\n      var oldRange = ourRange;\n      var range$$1 = rangeForUnit(cm, pos, behavior.unit);\n      var anchor = oldRange.anchor, head;\n      if (cmp(range$$1.anchor, anchor) > 0) {\n        head = range$$1.head;\n        anchor = minPos(oldRange.from(), range$$1.anchor);\n      } else {\n        head = range$$1.anchor;\n        anchor = maxPos(oldRange.to(), range$$1.head);\n      }\n      var ranges$1 = startSel.ranges.slice(0);\n      ranges$1[ourIndex] = bidiSimplify(cm, new Range(clipPos(doc, anchor), head));\n      setSelection(doc, normalizeSelection(ranges$1, ourIndex), sel_mouse);\n    }\n  }\n\n  var editorSize = display.wrapper.getBoundingClientRect();\n  // Used to ensure timeout re-tries don't fire when another extend\n  // happened in the meantime (clearTimeout isn't reliable -- at\n  // least on Chrome, the timeouts still happen even when cleared,\n  // if the clear happens after their scheduled firing time).\n  var counter = 0;\n\n  function extend(e) {\n    var curCount = ++counter;\n    var cur = posFromMouse(cm, e, true, behavior.unit == \"rectangle\");\n    if (!cur) { return }\n    if (cmp(cur, lastPos) != 0) {\n      cm.curOp.focus = activeElt();\n      extendTo(cur);\n      var visible = visibleLines(display, doc);\n      if (cur.line >= visible.to || cur.line < visible.from)\n        { setTimeout(operation(cm, function () {if (counter == curCount) { extend(e); }}), 150); }\n    } else {\n      var outside = e.clientY < editorSize.top ? -20 : e.clientY > editorSize.bottom ? 20 : 0;\n      if (outside) { setTimeout(operation(cm, function () {\n        if (counter != curCount) { return }\n        display.scroller.scrollTop += outside;\n        extend(e);\n      }), 50); }\n    }\n  }\n\n  function done(e) {\n    cm.state.selectingText = false;\n    counter = Infinity;\n    e_preventDefault(e);\n    display.input.focus();\n    off(document, \"mousemove\", move);\n    off(document, \"mouseup\", up);\n    doc.history.lastSelOrigin = null;\n  }\n\n  var move = operation(cm, function (e) {\n    if (!e_button(e)) { done(e); }\n    else { extend(e); }\n  });\n  var up = operation(cm, done);\n  cm.state.selectingText = up;\n  on(document, \"mousemove\", move);\n  on(document, \"mouseup\", up);\n}\n\n// Used when mouse-selecting to adjust the anchor to the proper side\n// of a bidi jump depending on the visual position of the head.\nfunction bidiSimplify(cm, range$$1) {\n  var anchor = range$$1.anchor;\n  var head = range$$1.head;\n  var anchorLine = getLine(cm.doc, anchor.line);\n  if (cmp(anchor, head) == 0 && anchor.sticky == head.sticky) { return range$$1 }\n  var order = getOrder(anchorLine);\n  if (!order) { return range$$1 }\n  var index = getBidiPartAt(order, anchor.ch, anchor.sticky), part = order[index];\n  if (part.from != anchor.ch && part.to != anchor.ch) { return range$$1 }\n  var boundary = index + ((part.from == anchor.ch) == (part.level != 1) ? 0 : 1);\n  if (boundary == 0 || boundary == order.length) { return range$$1 }\n\n  // Compute the relative visual position of the head compared to the\n  // anchor (<0 is to the left, >0 to the right)\n  var leftSide;\n  if (head.line != anchor.line) {\n    leftSide = (head.line - anchor.line) * (cm.doc.direction == \"ltr\" ? 1 : -1) > 0;\n  } else {\n    var headIndex = getBidiPartAt(order, head.ch, head.sticky);\n    var dir = headIndex - index || (head.ch - anchor.ch) * (part.level == 1 ? -1 : 1);\n    if (headIndex == boundary - 1 || headIndex == boundary)\n      { leftSide = dir < 0; }\n    else\n      { leftSide = dir > 0; }\n  }\n\n  var usePart = order[boundary + (leftSide ? -1 : 0)];\n  var from = leftSide == (usePart.level == 1);\n  var ch = from ? usePart.from : usePart.to, sticky = from ? \"after\" : \"before\";\n  return anchor.ch == ch && anchor.sticky == sticky ? range$$1 : new Range(new Pos(anchor.line, ch, sticky), head)\n}\n\n\n// Determines whether an event happened in the gutter, and fires the\n// handlers for the corresponding event.\nfunction gutterEvent(cm, e, type, prevent) {\n  var mX, mY;\n  if (e.touches) {\n    mX = e.touches[0].clientX;\n    mY = e.touches[0].clientY;\n  } else {\n    try { mX = e.clientX; mY = e.clientY; }\n    catch(e) { return false }\n  }\n  if (mX >= Math.floor(cm.display.gutters.getBoundingClientRect().right)) { return false }\n  if (prevent) { e_preventDefault(e); }\n\n  var display = cm.display;\n  var lineBox = display.lineDiv.getBoundingClientRect();\n\n  if (mY > lineBox.bottom || !hasHandler(cm, type)) { return e_defaultPrevented(e) }\n  mY -= lineBox.top - display.viewOffset;\n\n  for (var i = 0; i < cm.options.gutters.length; ++i) {\n    var g = display.gutters.childNodes[i];\n    if (g && g.getBoundingClientRect().right >= mX) {\n      var line = lineAtHeight(cm.doc, mY);\n      var gutter = cm.options.gutters[i];\n      signal(cm, type, cm, line, gutter, e);\n      return e_defaultPrevented(e)\n    }\n  }\n}\n\nfunction clickInGutter(cm, e) {\n  return gutterEvent(cm, e, \"gutterClick\", true)\n}\n\n// CONTEXT MENU HANDLING\n\n// To make the context menu work, we need to briefly unhide the\n// textarea (making it as unobtrusive as possible) to let the\n// right-click take effect on it.\nfunction onContextMenu(cm, e) {\n  if (eventInWidget(cm.display, e) || contextMenuInGutter(cm, e)) { return }\n  if (signalDOMEvent(cm, e, \"contextmenu\")) { return }\n  cm.display.input.onContextMenu(e);\n}\n\nfunction contextMenuInGutter(cm, e) {\n  if (!hasHandler(cm, \"gutterContextMenu\")) { return false }\n  return gutterEvent(cm, e, \"gutterContextMenu\", false)\n}\n\nfunction themeChanged(cm) {\n  cm.display.wrapper.className = cm.display.wrapper.className.replace(/\\s*cm-s-\\S+/g, \"\") +\n    cm.options.theme.replace(/(^|\\s)\\s*/g, \" cm-s-\");\n  clearCaches(cm);\n}\n\nvar Init = {toString: function(){return \"CodeMirror.Init\"}};\n\nvar defaults = {};\nvar optionHandlers = {};\n\nfunction defineOptions(CodeMirror) {\n  var optionHandlers = CodeMirror.optionHandlers;\n\n  function option(name, deflt, handle, notOnInit) {\n    CodeMirror.defaults[name] = deflt;\n    if (handle) { optionHandlers[name] =\n      notOnInit ? function (cm, val, old) {if (old != Init) { handle(cm, val, old); }} : handle; }\n  }\n\n  CodeMirror.defineOption = option;\n\n  // Passed to option handlers when there is no old value.\n  CodeMirror.Init = Init;\n\n  // These two are, on init, called from the constructor because they\n  // have to be initialized before the editor can start at all.\n  option(\"value\", \"\", function (cm, val) { return cm.setValue(val); }, true);\n  option(\"mode\", null, function (cm, val) {\n    cm.doc.modeOption = val;\n    loadMode(cm);\n  }, true);\n\n  option(\"indentUnit\", 2, loadMode, true);\n  option(\"indentWithTabs\", false);\n  option(\"smartIndent\", true);\n  option(\"tabSize\", 4, function (cm) {\n    resetModeState(cm);\n    clearCaches(cm);\n    regChange(cm);\n  }, true);\n\n  option(\"lineSeparator\", null, function (cm, val) {\n    cm.doc.lineSep = val;\n    if (!val) { return }\n    var newBreaks = [], lineNo = cm.doc.first;\n    cm.doc.iter(function (line) {\n      for (var pos = 0;;) {\n        var found = line.text.indexOf(val, pos);\n        if (found == -1) { break }\n        pos = found + val.length;\n        newBreaks.push(Pos(lineNo, found));\n      }\n      lineNo++;\n    });\n    for (var i = newBreaks.length - 1; i >= 0; i--)\n      { replaceRange(cm.doc, val, newBreaks[i], Pos(newBreaks[i].line, newBreaks[i].ch + val.length)); }\n  });\n  option(\"specialChars\", /[\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u061c\\u200b-\\u200f\\u2028\\u2029\\ufeff]/g, function (cm, val, old) {\n    cm.state.specialChars = new RegExp(val.source + (val.test(\"\\t\") ? \"\" : \"|\\t\"), \"g\");\n    if (old != Init) { cm.refresh(); }\n  });\n  option(\"specialCharPlaceholder\", defaultSpecialCharPlaceholder, function (cm) { return cm.refresh(); }, true);\n  option(\"electricChars\", true);\n  option(\"inputStyle\", mobile ? \"contenteditable\" : \"textarea\", function () {\n    throw new Error(\"inputStyle can not (yet) be changed in a running editor\") // FIXME\n  }, true);\n  option(\"spellcheck\", false, function (cm, val) { return cm.getInputField().spellcheck = val; }, true);\n  option(\"rtlMoveVisually\", !windows);\n  option(\"wholeLineUpdateBefore\", true);\n\n  option(\"theme\", \"default\", function (cm) {\n    themeChanged(cm);\n    guttersChanged(cm);\n  }, true);\n  option(\"keyMap\", \"default\", function (cm, val, old) {\n    var next = getKeyMap(val);\n    var prev = old != Init && getKeyMap(old);\n    if (prev && prev.detach) { prev.detach(cm, next); }\n    if (next.attach) { next.attach(cm, prev || null); }\n  });\n  option(\"extraKeys\", null);\n  option(\"configureMouse\", null);\n\n  option(\"lineWrapping\", false, wrappingChanged, true);\n  option(\"gutters\", [], function (cm) {\n    setGuttersForLineNumbers(cm.options);\n    guttersChanged(cm);\n  }, true);\n  option(\"fixedGutter\", true, function (cm, val) {\n    cm.display.gutters.style.left = val ? compensateForHScroll(cm.display) + \"px\" : \"0\";\n    cm.refresh();\n  }, true);\n  option(\"coverGutterNextToScrollbar\", false, function (cm) { return updateScrollbars(cm); }, true);\n  option(\"scrollbarStyle\", \"native\", function (cm) {\n    initScrollbars(cm);\n    updateScrollbars(cm);\n    cm.display.scrollbars.setScrollTop(cm.doc.scrollTop);\n    cm.display.scrollbars.setScrollLeft(cm.doc.scrollLeft);\n  }, true);\n  option(\"lineNumbers\", false, function (cm) {\n    setGuttersForLineNumbers(cm.options);\n    guttersChanged(cm);\n  }, true);\n  option(\"firstLineNumber\", 1, guttersChanged, true);\n  option(\"lineNumberFormatter\", function (integer) { return integer; }, guttersChanged, true);\n  option(\"showCursorWhenSelecting\", false, updateSelection, true);\n\n  option(\"resetSelectionOnContextMenu\", true);\n  option(\"lineWiseCopyCut\", true);\n  option(\"pasteLinesPerSelection\", true);\n\n  option(\"readOnly\", false, function (cm, val) {\n    if (val == \"nocursor\") {\n      onBlur(cm);\n      cm.display.input.blur();\n    }\n    cm.display.input.readOnlyChanged(val);\n  });\n  option(\"disableInput\", false, function (cm, val) {if (!val) { cm.display.input.reset(); }}, true);\n  option(\"dragDrop\", true, dragDropChanged);\n  option(\"allowDropFileTypes\", null);\n\n  option(\"cursorBlinkRate\", 530);\n  option(\"cursorScrollMargin\", 0);\n  option(\"cursorHeight\", 1, updateSelection, true);\n  option(\"singleCursorHeightPerLine\", true, updateSelection, true);\n  option(\"workTime\", 100);\n  option(\"workDelay\", 100);\n  option(\"flattenSpans\", true, resetModeState, true);\n  option(\"addModeClass\", false, resetModeState, true);\n  option(\"pollInterval\", 100);\n  option(\"undoDepth\", 200, function (cm, val) { return cm.doc.history.undoDepth = val; });\n  option(\"historyEventDelay\", 1250);\n  option(\"viewportMargin\", 10, function (cm) { return cm.refresh(); }, true);\n  option(\"maxHighlightLength\", 10000, resetModeState, true);\n  option(\"moveInputWithCursor\", true, function (cm, val) {\n    if (!val) { cm.display.input.resetPosition(); }\n  });\n\n  option(\"tabindex\", null, function (cm, val) { return cm.display.input.getField().tabIndex = val || \"\"; });\n  option(\"autofocus\", null);\n  option(\"direction\", \"ltr\", function (cm, val) { return cm.doc.setDirection(val); }, true);\n}\n\nfunction guttersChanged(cm) {\n  updateGutters(cm);\n  regChange(cm);\n  alignHorizontally(cm);\n}\n\nfunction dragDropChanged(cm, value, old) {\n  var wasOn = old && old != Init;\n  if (!value != !wasOn) {\n    var funcs = cm.display.dragFunctions;\n    var toggle = value ? on : off;\n    toggle(cm.display.scroller, \"dragstart\", funcs.start);\n    toggle(cm.display.scroller, \"dragenter\", funcs.enter);\n    toggle(cm.display.scroller, \"dragover\", funcs.over);\n    toggle(cm.display.scroller, \"dragleave\", funcs.leave);\n    toggle(cm.display.scroller, \"drop\", funcs.drop);\n  }\n}\n\nfunction wrappingChanged(cm) {\n  if (cm.options.lineWrapping) {\n    addClass(cm.display.wrapper, \"CodeMirror-wrap\");\n    cm.display.sizer.style.minWidth = \"\";\n    cm.display.sizerWidth = null;\n  } else {\n    rmClass(cm.display.wrapper, \"CodeMirror-wrap\");\n    findMaxLine(cm);\n  }\n  estimateLineHeights(cm);\n  regChange(cm);\n  clearCaches(cm);\n  setTimeout(function () { return updateScrollbars(cm); }, 100);\n}\n\n// A CodeMirror instance represents an editor. This is the object\n// that user code is usually dealing with.\n\nfunction CodeMirror$1(place, options) {\n  var this$1 = this;\n\n  if (!(this instanceof CodeMirror$1)) { return new CodeMirror$1(place, options) }\n\n  this.options = options = options ? copyObj(options) : {};\n  // Determine effective options based on given values and defaults.\n  copyObj(defaults, options, false);\n  setGuttersForLineNumbers(options);\n\n  var doc = options.value;\n  if (typeof doc == \"string\") { doc = new Doc(doc, options.mode, null, options.lineSeparator, options.direction); }\n  this.doc = doc;\n\n  var input = new CodeMirror$1.inputStyles[options.inputStyle](this);\n  var display = this.display = new Display(place, doc, input);\n  display.wrapper.CodeMirror = this;\n  updateGutters(this);\n  themeChanged(this);\n  if (options.lineWrapping)\n    { this.display.wrapper.className += \" CodeMirror-wrap\"; }\n  initScrollbars(this);\n\n  this.state = {\n    keyMaps: [],  // stores maps added by addKeyMap\n    overlays: [], // highlighting overlays, as added by addOverlay\n    modeGen: 0,   // bumped when mode/overlay changes, used to invalidate highlighting info\n    overwrite: false,\n    delayingBlurEvent: false,\n    focused: false,\n    suppressEdits: false, // used to disable editing during key handlers when in readOnly mode\n    pasteIncoming: false, cutIncoming: false, // help recognize paste/cut edits in input.poll\n    selectingText: false,\n    draggingText: false,\n    highlight: new Delayed(), // stores highlight worker timeout\n    keySeq: null,  // Unfinished key sequence\n    specialChars: null\n  };\n\n  if (options.autofocus && !mobile) { display.input.focus(); }\n\n  // Override magic textarea content restore that IE sometimes does\n  // on our hidden textarea on reload\n  if (ie && ie_version < 11) { setTimeout(function () { return this$1.display.input.reset(true); }, 20); }\n\n  registerEventHandlers(this);\n  ensureGlobalHandlers();\n\n  startOperation(this);\n  this.curOp.forceUpdate = true;\n  attachDoc(this, doc);\n\n  if ((options.autofocus && !mobile) || this.hasFocus())\n    { setTimeout(bind(onFocus, this), 20); }\n  else\n    { onBlur(this); }\n\n  for (var opt in optionHandlers) { if (optionHandlers.hasOwnProperty(opt))\n    { optionHandlers[opt](this$1, options[opt], Init); } }\n  maybeUpdateLineNumberWidth(this);\n  if (options.finishInit) { options.finishInit(this); }\n  for (var i = 0; i < initHooks.length; ++i) { initHooks[i](this$1); }\n  endOperation(this);\n  // Suppress optimizelegibility in Webkit, since it breaks text\n  // measuring on line wrapping boundaries.\n  if (webkit && options.lineWrapping &&\n      getComputedStyle(display.lineDiv).textRendering == \"optimizelegibility\")\n    { display.lineDiv.style.textRendering = \"auto\"; }\n}\n\n// The default configuration options.\nCodeMirror$1.defaults = defaults;\n// Functions to run when options are changed.\nCodeMirror$1.optionHandlers = optionHandlers;\n\n// Attach the necessary event handlers when initializing the editor\nfunction registerEventHandlers(cm) {\n  var d = cm.display;\n  on(d.scroller, \"mousedown\", operation(cm, onMouseDown));\n  // Older IE's will not fire a second mousedown for a double click\n  if (ie && ie_version < 11)\n    { on(d.scroller, \"dblclick\", operation(cm, function (e) {\n      if (signalDOMEvent(cm, e)) { return }\n      var pos = posFromMouse(cm, e);\n      if (!pos || clickInGutter(cm, e) || eventInWidget(cm.display, e)) { return }\n      e_preventDefault(e);\n      var word = cm.findWordAt(pos);\n      extendSelection(cm.doc, word.anchor, word.head);\n    })); }\n  else\n    { on(d.scroller, \"dblclick\", function (e) { return signalDOMEvent(cm, e) || e_preventDefault(e); }); }\n  // Some browsers fire contextmenu *after* opening the menu, at\n  // which point we can't mess with it anymore. Context menu is\n  // handled in onMouseDown for these browsers.\n  if (!captureRightClick) { on(d.scroller, \"contextmenu\", function (e) { return onContextMenu(cm, e); }); }\n\n  // Used to suppress mouse event handling when a touch happens\n  var touchFinished, prevTouch = {end: 0};\n  function finishTouch() {\n    if (d.activeTouch) {\n      touchFinished = setTimeout(function () { return d.activeTouch = null; }, 1000);\n      prevTouch = d.activeTouch;\n      prevTouch.end = +new Date;\n    }\n  }\n  function isMouseLikeTouchEvent(e) {\n    if (e.touches.length != 1) { return false }\n    var touch = e.touches[0];\n    return touch.radiusX <= 1 && touch.radiusY <= 1\n  }\n  function farAway(touch, other) {\n    if (other.left == null) { return true }\n    var dx = other.left - touch.left, dy = other.top - touch.top;\n    return dx * dx + dy * dy > 20 * 20\n  }\n  on(d.scroller, \"touchstart\", function (e) {\n    if (!signalDOMEvent(cm, e) && !isMouseLikeTouchEvent(e) && !clickInGutter(cm, e)) {\n      d.input.ensurePolled();\n      clearTimeout(touchFinished);\n      var now = +new Date;\n      d.activeTouch = {start: now, moved: false,\n                       prev: now - prevTouch.end <= 300 ? prevTouch : null};\n      if (e.touches.length == 1) {\n        d.activeTouch.left = e.touches[0].pageX;\n        d.activeTouch.top = e.touches[0].pageY;\n      }\n    }\n  });\n  on(d.scroller, \"touchmove\", function () {\n    if (d.activeTouch) { d.activeTouch.moved = true; }\n  });\n  on(d.scroller, \"touchend\", function (e) {\n    var touch = d.activeTouch;\n    if (touch && !eventInWidget(d, e) && touch.left != null &&\n        !touch.moved && new Date - touch.start < 300) {\n      var pos = cm.coordsChar(d.activeTouch, \"page\"), range;\n      if (!touch.prev || farAway(touch, touch.prev)) // Single tap\n        { range = new Range(pos, pos); }\n      else if (!touch.prev.prev || farAway(touch, touch.prev.prev)) // Double tap\n        { range = cm.findWordAt(pos); }\n      else // Triple tap\n        { range = new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))); }\n      cm.setSelection(range.anchor, range.head);\n      cm.focus();\n      e_preventDefault(e);\n    }\n    finishTouch();\n  });\n  on(d.scroller, \"touchcancel\", finishTouch);\n\n  // Sync scrolling between fake scrollbars and real scrollable\n  // area, ensure viewport is updated when scrolling.\n  on(d.scroller, \"scroll\", function () {\n    if (d.scroller.clientHeight) {\n      updateScrollTop(cm, d.scroller.scrollTop);\n      setScrollLeft(cm, d.scroller.scrollLeft, true);\n      signal(cm, \"scroll\", cm);\n    }\n  });\n\n  // Listen to wheel events in order to try and update the viewport on time.\n  on(d.scroller, \"mousewheel\", function (e) { return onScrollWheel(cm, e); });\n  on(d.scroller, \"DOMMouseScroll\", function (e) { return onScrollWheel(cm, e); });\n\n  // Prevent wrapper from ever scrolling\n  on(d.wrapper, \"scroll\", function () { return d.wrapper.scrollTop = d.wrapper.scrollLeft = 0; });\n\n  d.dragFunctions = {\n    enter: function (e) {if (!signalDOMEvent(cm, e)) { e_stop(e); }},\n    over: function (e) {if (!signalDOMEvent(cm, e)) { onDragOver(cm, e); e_stop(e); }},\n    start: function (e) { return onDragStart(cm, e); },\n    drop: operation(cm, onDrop),\n    leave: function (e) {if (!signalDOMEvent(cm, e)) { clearDragCursor(cm); }}\n  };\n\n  var inp = d.input.getField();\n  on(inp, \"keyup\", function (e) { return onKeyUp.call(cm, e); });\n  on(inp, \"keydown\", operation(cm, onKeyDown));\n  on(inp, \"keypress\", operation(cm, onKeyPress));\n  on(inp, \"focus\", function (e) { return onFocus(cm, e); });\n  on(inp, \"blur\", function (e) { return onBlur(cm, e); });\n}\n\nvar initHooks = [];\nCodeMirror$1.defineInitHook = function (f) { return initHooks.push(f); };\n\n// Indent the given line. The how parameter can be \"smart\",\n// \"add\"/null, \"subtract\", or \"prev\". When aggressive is false\n// (typically set to true for forced single-line indents), empty\n// lines are not indented, and places where the mode returns Pass\n// are left alone.\nfunction indentLine(cm, n, how, aggressive) {\n  var doc = cm.doc, state;\n  if (how == null) { how = \"add\"; }\n  if (how == \"smart\") {\n    // Fall back to \"prev\" when the mode doesn't have an indentation\n    // method.\n    if (!doc.mode.indent) { how = \"prev\"; }\n    else { state = getContextBefore(cm, n).state; }\n  }\n\n  var tabSize = cm.options.tabSize;\n  var line = getLine(doc, n), curSpace = countColumn(line.text, null, tabSize);\n  if (line.stateAfter) { line.stateAfter = null; }\n  var curSpaceString = line.text.match(/^\\s*/)[0], indentation;\n  if (!aggressive && !/\\S/.test(line.text)) {\n    indentation = 0;\n    how = \"not\";\n  } else if (how == \"smart\") {\n    indentation = doc.mode.indent(state, line.text.slice(curSpaceString.length), line.text);\n    if (indentation == Pass || indentation > 150) {\n      if (!aggressive) { return }\n      how = \"prev\";\n    }\n  }\n  if (how == \"prev\") {\n    if (n > doc.first) { indentation = countColumn(getLine(doc, n-1).text, null, tabSize); }\n    else { indentation = 0; }\n  } else if (how == \"add\") {\n    indentation = curSpace + cm.options.indentUnit;\n  } else if (how == \"subtract\") {\n    indentation = curSpace - cm.options.indentUnit;\n  } else if (typeof how == \"number\") {\n    indentation = curSpace + how;\n  }\n  indentation = Math.max(0, indentation);\n\n  var indentString = \"\", pos = 0;\n  if (cm.options.indentWithTabs)\n    { for (var i = Math.floor(indentation / tabSize); i; --i) {pos += tabSize; indentString += \"\\t\";} }\n  if (pos < indentation) { indentString += spaceStr(indentation - pos); }\n\n  if (indentString != curSpaceString) {\n    replaceRange(doc, indentString, Pos(n, 0), Pos(n, curSpaceString.length), \"+input\");\n    line.stateAfter = null;\n    return true\n  } else {\n    // Ensure that, if the cursor was in the whitespace at the start\n    // of the line, it is moved to the end of that space.\n    for (var i$1 = 0; i$1 < doc.sel.ranges.length; i$1++) {\n      var range = doc.sel.ranges[i$1];\n      if (range.head.line == n && range.head.ch < curSpaceString.length) {\n        var pos$1 = Pos(n, curSpaceString.length);\n        replaceOneSelection(doc, i$1, new Range(pos$1, pos$1));\n        break\n      }\n    }\n  }\n}\n\n// This will be set to a {lineWise: bool, text: [string]} object, so\n// that, when pasting, we know what kind of selections the copied\n// text was made out of.\nvar lastCopied = null;\n\nfunction setLastCopied(newLastCopied) {\n  lastCopied = newLastCopied;\n}\n\nfunction applyTextInput(cm, inserted, deleted, sel, origin) {\n  var doc = cm.doc;\n  cm.display.shift = false;\n  if (!sel) { sel = doc.sel; }\n\n  var paste = cm.state.pasteIncoming || origin == \"paste\";\n  var textLines = splitLinesAuto(inserted), multiPaste = null;\n  // When pasing N lines into N selections, insert one line per selection\n  if (paste && sel.ranges.length > 1) {\n    if (lastCopied && lastCopied.text.join(\"\\n\") == inserted) {\n      if (sel.ranges.length % lastCopied.text.length == 0) {\n        multiPaste = [];\n        for (var i = 0; i < lastCopied.text.length; i++)\n          { multiPaste.push(doc.splitLines(lastCopied.text[i])); }\n      }\n    } else if (textLines.length == sel.ranges.length && cm.options.pasteLinesPerSelection) {\n      multiPaste = map(textLines, function (l) { return [l]; });\n    }\n  }\n\n  var updateInput;\n  // Normal behavior is to insert the new text into every selection\n  for (var i$1 = sel.ranges.length - 1; i$1 >= 0; i$1--) {\n    var range$$1 = sel.ranges[i$1];\n    var from = range$$1.from(), to = range$$1.to();\n    if (range$$1.empty()) {\n      if (deleted && deleted > 0) // Handle deletion\n        { from = Pos(from.line, from.ch - deleted); }\n      else if (cm.state.overwrite && !paste) // Handle overwrite\n        { to = Pos(to.line, Math.min(getLine(doc, to.line).text.length, to.ch + lst(textLines).length)); }\n      else if (lastCopied && lastCopied.lineWise && lastCopied.text.join(\"\\n\") == inserted)\n        { from = to = Pos(from.line, 0); }\n    }\n    updateInput = cm.curOp.updateInput;\n    var changeEvent = {from: from, to: to, text: multiPaste ? multiPaste[i$1 % multiPaste.length] : textLines,\n                       origin: origin || (paste ? \"paste\" : cm.state.cutIncoming ? \"cut\" : \"+input\")};\n    makeChange(cm.doc, changeEvent);\n    signalLater(cm, \"inputRead\", cm, changeEvent);\n  }\n  if (inserted && !paste)\n    { triggerElectric(cm, inserted); }\n\n  ensureCursorVisible(cm);\n  cm.curOp.updateInput = updateInput;\n  cm.curOp.typing = true;\n  cm.state.pasteIncoming = cm.state.cutIncoming = false;\n}\n\nfunction handlePaste(e, cm) {\n  var pasted = e.clipboardData && e.clipboardData.getData(\"Text\");\n  if (pasted) {\n    e.preventDefault();\n    if (!cm.isReadOnly() && !cm.options.disableInput)\n      { runInOp(cm, function () { return applyTextInput(cm, pasted, 0, null, \"paste\"); }); }\n    return true\n  }\n}\n\nfunction triggerElectric(cm, inserted) {\n  // When an 'electric' character is inserted, immediately trigger a reindent\n  if (!cm.options.electricChars || !cm.options.smartIndent) { return }\n  var sel = cm.doc.sel;\n\n  for (var i = sel.ranges.length - 1; i >= 0; i--) {\n    var range$$1 = sel.ranges[i];\n    if (range$$1.head.ch > 100 || (i && sel.ranges[i - 1].head.line == range$$1.head.line)) { continue }\n    var mode = cm.getModeAt(range$$1.head);\n    var indented = false;\n    if (mode.electricChars) {\n      for (var j = 0; j < mode.electricChars.length; j++)\n        { if (inserted.indexOf(mode.electricChars.charAt(j)) > -1) {\n          indented = indentLine(cm, range$$1.head.line, \"smart\");\n          break\n        } }\n    } else if (mode.electricInput) {\n      if (mode.electricInput.test(getLine(cm.doc, range$$1.head.line).text.slice(0, range$$1.head.ch)))\n        { indented = indentLine(cm, range$$1.head.line, \"smart\"); }\n    }\n    if (indented) { signalLater(cm, \"electricInput\", cm, range$$1.head.line); }\n  }\n}\n\nfunction copyableRanges(cm) {\n  var text = [], ranges = [];\n  for (var i = 0; i < cm.doc.sel.ranges.length; i++) {\n    var line = cm.doc.sel.ranges[i].head.line;\n    var lineRange = {anchor: Pos(line, 0), head: Pos(line + 1, 0)};\n    ranges.push(lineRange);\n    text.push(cm.getRange(lineRange.anchor, lineRange.head));\n  }\n  return {text: text, ranges: ranges}\n}\n\nfunction disableBrowserMagic(field, spellcheck) {\n  field.setAttribute(\"autocorrect\", \"off\");\n  field.setAttribute(\"autocapitalize\", \"off\");\n  field.setAttribute(\"spellcheck\", !!spellcheck);\n}\n\nfunction hiddenTextarea() {\n  var te = elt(\"textarea\", null, null, \"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none\");\n  var div = elt(\"div\", [te], null, \"overflow: hidden; position: relative; width: 3px; height: 0px;\");\n  // The textarea is kept positioned near the cursor to prevent the\n  // fact that it'll be scrolled into view on input from scrolling\n  // our fake cursor out of view. On webkit, when wrap=off, paste is\n  // very slow. So make the area wide instead.\n  if (webkit) { te.style.width = \"1000px\"; }\n  else { te.setAttribute(\"wrap\", \"off\"); }\n  // If border: 0; -- iOS fails to open keyboard (issue #1287)\n  if (ios) { te.style.border = \"1px solid black\"; }\n  disableBrowserMagic(te);\n  return div\n}\n\n// The publicly visible API. Note that methodOp(f) means\n// 'wrap f in an operation, performed on its `this` parameter'.\n\n// This is not the complete set of editor methods. Most of the\n// methods defined on the Doc type are also injected into\n// CodeMirror.prototype, for backwards compatibility and\n// convenience.\n\nvar addEditorMethods = function(CodeMirror) {\n  var optionHandlers = CodeMirror.optionHandlers;\n\n  var helpers = CodeMirror.helpers = {};\n\n  CodeMirror.prototype = {\n    constructor: CodeMirror,\n    focus: function(){window.focus(); this.display.input.focus();},\n\n    setOption: function(option, value) {\n      var options = this.options, old = options[option];\n      if (options[option] == value && option != \"mode\") { return }\n      options[option] = value;\n      if (optionHandlers.hasOwnProperty(option))\n        { operation(this, optionHandlers[option])(this, value, old); }\n      signal(this, \"optionChange\", this, option);\n    },\n\n    getOption: function(option) {return this.options[option]},\n    getDoc: function() {return this.doc},\n\n    addKeyMap: function(map$$1, bottom) {\n      this.state.keyMaps[bottom ? \"push\" : \"unshift\"](getKeyMap(map$$1));\n    },\n    removeKeyMap: function(map$$1) {\n      var maps = this.state.keyMaps;\n      for (var i = 0; i < maps.length; ++i)\n        { if (maps[i] == map$$1 || maps[i].name == map$$1) {\n          maps.splice(i, 1);\n          return true\n        } }\n    },\n\n    addOverlay: methodOp(function(spec, options) {\n      var mode = spec.token ? spec : CodeMirror.getMode(this.options, spec);\n      if (mode.startState) { throw new Error(\"Overlays may not be stateful.\") }\n      insertSorted(this.state.overlays,\n                   {mode: mode, modeSpec: spec, opaque: options && options.opaque,\n                    priority: (options && options.priority) || 0},\n                   function (overlay) { return overlay.priority; });\n      this.state.modeGen++;\n      regChange(this);\n    }),\n    removeOverlay: methodOp(function(spec) {\n      var this$1 = this;\n\n      var overlays = this.state.overlays;\n      for (var i = 0; i < overlays.length; ++i) {\n        var cur = overlays[i].modeSpec;\n        if (cur == spec || typeof spec == \"string\" && cur.name == spec) {\n          overlays.splice(i, 1);\n          this$1.state.modeGen++;\n          regChange(this$1);\n          return\n        }\n      }\n    }),\n\n    indentLine: methodOp(function(n, dir, aggressive) {\n      if (typeof dir != \"string\" && typeof dir != \"number\") {\n        if (dir == null) { dir = this.options.smartIndent ? \"smart\" : \"prev\"; }\n        else { dir = dir ? \"add\" : \"subtract\"; }\n      }\n      if (isLine(this.doc, n)) { indentLine(this, n, dir, aggressive); }\n    }),\n    indentSelection: methodOp(function(how) {\n      var this$1 = this;\n\n      var ranges = this.doc.sel.ranges, end = -1;\n      for (var i = 0; i < ranges.length; i++) {\n        var range$$1 = ranges[i];\n        if (!range$$1.empty()) {\n          var from = range$$1.from(), to = range$$1.to();\n          var start = Math.max(end, from.line);\n          end = Math.min(this$1.lastLine(), to.line - (to.ch ? 0 : 1)) + 1;\n          for (var j = start; j < end; ++j)\n            { indentLine(this$1, j, how); }\n          var newRanges = this$1.doc.sel.ranges;\n          if (from.ch == 0 && ranges.length == newRanges.length && newRanges[i].from().ch > 0)\n            { replaceOneSelection(this$1.doc, i, new Range(from, newRanges[i].to()), sel_dontScroll); }\n        } else if (range$$1.head.line > end) {\n          indentLine(this$1, range$$1.head.line, how, true);\n          end = range$$1.head.line;\n          if (i == this$1.doc.sel.primIndex) { ensureCursorVisible(this$1); }\n        }\n      }\n    }),\n\n    // Fetch the parser token for a given character. Useful for hacks\n    // that want to inspect the mode state (say, for completion).\n    getTokenAt: function(pos, precise) {\n      return takeToken(this, pos, precise)\n    },\n\n    getLineTokens: function(line, precise) {\n      return takeToken(this, Pos(line), precise, true)\n    },\n\n    getTokenTypeAt: function(pos) {\n      pos = clipPos(this.doc, pos);\n      var styles = getLineStyles(this, getLine(this.doc, pos.line));\n      var before = 0, after = (styles.length - 1) / 2, ch = pos.ch;\n      var type;\n      if (ch == 0) { type = styles[2]; }\n      else { for (;;) {\n        var mid = (before + after) >> 1;\n        if ((mid ? styles[mid * 2 - 1] : 0) >= ch) { after = mid; }\n        else if (styles[mid * 2 + 1] < ch) { before = mid + 1; }\n        else { type = styles[mid * 2 + 2]; break }\n      } }\n      var cut = type ? type.indexOf(\"overlay \") : -1;\n      return cut < 0 ? type : cut == 0 ? null : type.slice(0, cut - 1)\n    },\n\n    getModeAt: function(pos) {\n      var mode = this.doc.mode;\n      if (!mode.innerMode) { return mode }\n      return CodeMirror.innerMode(mode, this.getTokenAt(pos).state).mode\n    },\n\n    getHelper: function(pos, type) {\n      return this.getHelpers(pos, type)[0]\n    },\n\n    getHelpers: function(pos, type) {\n      var this$1 = this;\n\n      var found = [];\n      if (!helpers.hasOwnProperty(type)) { return found }\n      var help = helpers[type], mode = this.getModeAt(pos);\n      if (typeof mode[type] == \"string\") {\n        if (help[mode[type]]) { found.push(help[mode[type]]); }\n      } else if (mode[type]) {\n        for (var i = 0; i < mode[type].length; i++) {\n          var val = help[mode[type][i]];\n          if (val) { found.push(val); }\n        }\n      } else if (mode.helperType && help[mode.helperType]) {\n        found.push(help[mode.helperType]);\n      } else if (help[mode.name]) {\n        found.push(help[mode.name]);\n      }\n      for (var i$1 = 0; i$1 < help._global.length; i$1++) {\n        var cur = help._global[i$1];\n        if (cur.pred(mode, this$1) && indexOf(found, cur.val) == -1)\n          { found.push(cur.val); }\n      }\n      return found\n    },\n\n    getStateAfter: function(line, precise) {\n      var doc = this.doc;\n      line = clipLine(doc, line == null ? doc.first + doc.size - 1: line);\n      return getContextBefore(this, line + 1, precise).state\n    },\n\n    cursorCoords: function(start, mode) {\n      var pos, range$$1 = this.doc.sel.primary();\n      if (start == null) { pos = range$$1.head; }\n      else if (typeof start == \"object\") { pos = clipPos(this.doc, start); }\n      else { pos = start ? range$$1.from() : range$$1.to(); }\n      return cursorCoords(this, pos, mode || \"page\")\n    },\n\n    charCoords: function(pos, mode) {\n      return charCoords(this, clipPos(this.doc, pos), mode || \"page\")\n    },\n\n    coordsChar: function(coords, mode) {\n      coords = fromCoordSystem(this, coords, mode || \"page\");\n      return coordsChar(this, coords.left, coords.top)\n    },\n\n    lineAtHeight: function(height, mode) {\n      height = fromCoordSystem(this, {top: height, left: 0}, mode || \"page\").top;\n      return lineAtHeight(this.doc, height + this.display.viewOffset)\n    },\n    heightAtLine: function(line, mode, includeWidgets) {\n      var end = false, lineObj;\n      if (typeof line == \"number\") {\n        var last = this.doc.first + this.doc.size - 1;\n        if (line < this.doc.first) { line = this.doc.first; }\n        else if (line > last) { line = last; end = true; }\n        lineObj = getLine(this.doc, line);\n      } else {\n        lineObj = line;\n      }\n      return intoCoordSystem(this, lineObj, {top: 0, left: 0}, mode || \"page\", includeWidgets || end).top +\n        (end ? this.doc.height - heightAtLine(lineObj) : 0)\n    },\n\n    defaultTextHeight: function() { return textHeight(this.display) },\n    defaultCharWidth: function() { return charWidth(this.display) },\n\n    getViewport: function() { return {from: this.display.viewFrom, to: this.display.viewTo}},\n\n    addWidget: function(pos, node, scroll, vert, horiz) {\n      var display = this.display;\n      pos = cursorCoords(this, clipPos(this.doc, pos));\n      var top = pos.bottom, left = pos.left;\n      node.style.position = \"absolute\";\n      node.setAttribute(\"cm-ignore-events\", \"true\");\n      this.display.input.setUneditable(node);\n      display.sizer.appendChild(node);\n      if (vert == \"over\") {\n        top = pos.top;\n      } else if (vert == \"above\" || vert == \"near\") {\n        var vspace = Math.max(display.wrapper.clientHeight, this.doc.height),\n        hspace = Math.max(display.sizer.clientWidth, display.lineSpace.clientWidth);\n        // Default to positioning above (if specified and possible); otherwise default to positioning below\n        if ((vert == 'above' || pos.bottom + node.offsetHeight > vspace) && pos.top > node.offsetHeight)\n          { top = pos.top - node.offsetHeight; }\n        else if (pos.bottom + node.offsetHeight <= vspace)\n          { top = pos.bottom; }\n        if (left + node.offsetWidth > hspace)\n          { left = hspace - node.offsetWidth; }\n      }\n      node.style.top = top + \"px\";\n      node.style.left = node.style.right = \"\";\n      if (horiz == \"right\") {\n        left = display.sizer.clientWidth - node.offsetWidth;\n        node.style.right = \"0px\";\n      } else {\n        if (horiz == \"left\") { left = 0; }\n        else if (horiz == \"middle\") { left = (display.sizer.clientWidth - node.offsetWidth) / 2; }\n        node.style.left = left + \"px\";\n      }\n      if (scroll)\n        { scrollIntoView(this, {left: left, top: top, right: left + node.offsetWidth, bottom: top + node.offsetHeight}); }\n    },\n\n    triggerOnKeyDown: methodOp(onKeyDown),\n    triggerOnKeyPress: methodOp(onKeyPress),\n    triggerOnKeyUp: onKeyUp,\n    triggerOnMouseDown: methodOp(onMouseDown),\n\n    execCommand: function(cmd) {\n      if (commands.hasOwnProperty(cmd))\n        { return commands[cmd].call(null, this) }\n    },\n\n    triggerElectric: methodOp(function(text) { triggerElectric(this, text); }),\n\n    findPosH: function(from, amount, unit, visually) {\n      var this$1 = this;\n\n      var dir = 1;\n      if (amount < 0) { dir = -1; amount = -amount; }\n      var cur = clipPos(this.doc, from);\n      for (var i = 0; i < amount; ++i) {\n        cur = findPosH(this$1.doc, cur, dir, unit, visually);\n        if (cur.hitSide) { break }\n      }\n      return cur\n    },\n\n    moveH: methodOp(function(dir, unit) {\n      var this$1 = this;\n\n      this.extendSelectionsBy(function (range$$1) {\n        if (this$1.display.shift || this$1.doc.extend || range$$1.empty())\n          { return findPosH(this$1.doc, range$$1.head, dir, unit, this$1.options.rtlMoveVisually) }\n        else\n          { return dir < 0 ? range$$1.from() : range$$1.to() }\n      }, sel_move);\n    }),\n\n    deleteH: methodOp(function(dir, unit) {\n      var sel = this.doc.sel, doc = this.doc;\n      if (sel.somethingSelected())\n        { doc.replaceSelection(\"\", null, \"+delete\"); }\n      else\n        { deleteNearSelection(this, function (range$$1) {\n          var other = findPosH(doc, range$$1.head, dir, unit, false);\n          return dir < 0 ? {from: other, to: range$$1.head} : {from: range$$1.head, to: other}\n        }); }\n    }),\n\n    findPosV: function(from, amount, unit, goalColumn) {\n      var this$1 = this;\n\n      var dir = 1, x = goalColumn;\n      if (amount < 0) { dir = -1; amount = -amount; }\n      var cur = clipPos(this.doc, from);\n      for (var i = 0; i < amount; ++i) {\n        var coords = cursorCoords(this$1, cur, \"div\");\n        if (x == null) { x = coords.left; }\n        else { coords.left = x; }\n        cur = findPosV(this$1, coords, dir, unit);\n        if (cur.hitSide) { break }\n      }\n      return cur\n    },\n\n    moveV: methodOp(function(dir, unit) {\n      var this$1 = this;\n\n      var doc = this.doc, goals = [];\n      var collapse = !this.display.shift && !doc.extend && doc.sel.somethingSelected();\n      doc.extendSelectionsBy(function (range$$1) {\n        if (collapse)\n          { return dir < 0 ? range$$1.from() : range$$1.to() }\n        var headPos = cursorCoords(this$1, range$$1.head, \"div\");\n        if (range$$1.goalColumn != null) { headPos.left = range$$1.goalColumn; }\n        goals.push(headPos.left);\n        var pos = findPosV(this$1, headPos, dir, unit);\n        if (unit == \"page\" && range$$1 == doc.sel.primary())\n          { addToScrollTop(this$1, charCoords(this$1, pos, \"div\").top - headPos.top); }\n        return pos\n      }, sel_move);\n      if (goals.length) { for (var i = 0; i < doc.sel.ranges.length; i++)\n        { doc.sel.ranges[i].goalColumn = goals[i]; } }\n    }),\n\n    // Find the word at the given position (as returned by coordsChar).\n    findWordAt: function(pos) {\n      var doc = this.doc, line = getLine(doc, pos.line).text;\n      var start = pos.ch, end = pos.ch;\n      if (line) {\n        var helper = this.getHelper(pos, \"wordChars\");\n        if ((pos.sticky == \"before\" || end == line.length) && start) { --start; } else { ++end; }\n        var startChar = line.charAt(start);\n        var check = isWordChar(startChar, helper)\n          ? function (ch) { return isWordChar(ch, helper); }\n          : /\\s/.test(startChar) ? function (ch) { return /\\s/.test(ch); }\n          : function (ch) { return (!/\\s/.test(ch) && !isWordChar(ch)); };\n        while (start > 0 && check(line.charAt(start - 1))) { --start; }\n        while (end < line.length && check(line.charAt(end))) { ++end; }\n      }\n      return new Range(Pos(pos.line, start), Pos(pos.line, end))\n    },\n\n    toggleOverwrite: function(value) {\n      if (value != null && value == this.state.overwrite) { return }\n      if (this.state.overwrite = !this.state.overwrite)\n        { addClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n      else\n        { rmClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n\n      signal(this, \"overwriteToggle\", this, this.state.overwrite);\n    },\n    hasFocus: function() { return this.display.input.getField() == activeElt() },\n    isReadOnly: function() { return !!(this.options.readOnly || this.doc.cantEdit) },\n\n    scrollTo: methodOp(function (x, y) { scrollToCoords(this, x, y); }),\n    getScrollInfo: function() {\n      var scroller = this.display.scroller;\n      return {left: scroller.scrollLeft, top: scroller.scrollTop,\n              height: scroller.scrollHeight - scrollGap(this) - this.display.barHeight,\n              width: scroller.scrollWidth - scrollGap(this) - this.display.barWidth,\n              clientHeight: displayHeight(this), clientWidth: displayWidth(this)}\n    },\n\n    scrollIntoView: methodOp(function(range$$1, margin) {\n      if (range$$1 == null) {\n        range$$1 = {from: this.doc.sel.primary().head, to: null};\n        if (margin == null) { margin = this.options.cursorScrollMargin; }\n      } else if (typeof range$$1 == \"number\") {\n        range$$1 = {from: Pos(range$$1, 0), to: null};\n      } else if (range$$1.from == null) {\n        range$$1 = {from: range$$1, to: null};\n      }\n      if (!range$$1.to) { range$$1.to = range$$1.from; }\n      range$$1.margin = margin || 0;\n\n      if (range$$1.from.line != null) {\n        scrollToRange(this, range$$1);\n      } else {\n        scrollToCoordsRange(this, range$$1.from, range$$1.to, range$$1.margin);\n      }\n    }),\n\n    setSize: methodOp(function(width, height) {\n      var this$1 = this;\n\n      var interpret = function (val) { return typeof val == \"number\" || /^\\d+$/.test(String(val)) ? val + \"px\" : val; };\n      if (width != null) { this.display.wrapper.style.width = interpret(width); }\n      if (height != null) { this.display.wrapper.style.height = interpret(height); }\n      if (this.options.lineWrapping) { clearLineMeasurementCache(this); }\n      var lineNo$$1 = this.display.viewFrom;\n      this.doc.iter(lineNo$$1, this.display.viewTo, function (line) {\n        if (line.widgets) { for (var i = 0; i < line.widgets.length; i++)\n          { if (line.widgets[i].noHScroll) { regLineChange(this$1, lineNo$$1, \"widget\"); break } } }\n        ++lineNo$$1;\n      });\n      this.curOp.forceUpdate = true;\n      signal(this, \"refresh\", this);\n    }),\n\n    operation: function(f){return runInOp(this, f)},\n    startOperation: function(){return startOperation(this)},\n    endOperation: function(){return endOperation(this)},\n\n    refresh: methodOp(function() {\n      var oldHeight = this.display.cachedTextHeight;\n      regChange(this);\n      this.curOp.forceUpdate = true;\n      clearCaches(this);\n      scrollToCoords(this, this.doc.scrollLeft, this.doc.scrollTop);\n      updateGutterSpace(this);\n      if (oldHeight == null || Math.abs(oldHeight - textHeight(this.display)) > .5)\n        { estimateLineHeights(this); }\n      signal(this, \"refresh\", this);\n    }),\n\n    swapDoc: methodOp(function(doc) {\n      var old = this.doc;\n      old.cm = null;\n      attachDoc(this, doc);\n      clearCaches(this);\n      this.display.input.reset();\n      scrollToCoords(this, doc.scrollLeft, doc.scrollTop);\n      this.curOp.forceScroll = true;\n      signalLater(this, \"swapDoc\", this, old);\n      return old\n    }),\n\n    getInputField: function(){return this.display.input.getField()},\n    getWrapperElement: function(){return this.display.wrapper},\n    getScrollerElement: function(){return this.display.scroller},\n    getGutterElement: function(){return this.display.gutters}\n  };\n  eventMixin(CodeMirror);\n\n  CodeMirror.registerHelper = function(type, name, value) {\n    if (!helpers.hasOwnProperty(type)) { helpers[type] = CodeMirror[type] = {_global: []}; }\n    helpers[type][name] = value;\n  };\n  CodeMirror.registerGlobalHelper = function(type, name, predicate, value) {\n    CodeMirror.registerHelper(type, name, value);\n    helpers[type]._global.push({pred: predicate, val: value});\n  };\n};\n\n// Used for horizontal relative motion. Dir is -1 or 1 (left or\n// right), unit can be \"char\", \"column\" (like char, but doesn't\n// cross line boundaries), \"word\" (across next word), or \"group\" (to\n// the start of next group of word or non-word-non-whitespace\n// chars). The visually param controls whether, in right-to-left\n// text, direction 1 means to move towards the next index in the\n// string, or towards the character to the right of the current\n// position. The resulting position will have a hitSide=true\n// property if it reached the end of the document.\nfunction findPosH(doc, pos, dir, unit, visually) {\n  var oldPos = pos;\n  var origDir = dir;\n  var lineObj = getLine(doc, pos.line);\n  function findNextLine() {\n    var l = pos.line + dir;\n    if (l < doc.first || l >= doc.first + doc.size) { return false }\n    pos = new Pos(l, pos.ch, pos.sticky);\n    return lineObj = getLine(doc, l)\n  }\n  function moveOnce(boundToLine) {\n    var next;\n    if (visually) {\n      next = moveVisually(doc.cm, lineObj, pos, dir);\n    } else {\n      next = moveLogically(lineObj, pos, dir);\n    }\n    if (next == null) {\n      if (!boundToLine && findNextLine())\n        { pos = endOfLine(visually, doc.cm, lineObj, pos.line, dir); }\n      else\n        { return false }\n    } else {\n      pos = next;\n    }\n    return true\n  }\n\n  if (unit == \"char\") {\n    moveOnce();\n  } else if (unit == \"column\") {\n    moveOnce(true);\n  } else if (unit == \"word\" || unit == \"group\") {\n    var sawType = null, group = unit == \"group\";\n    var helper = doc.cm && doc.cm.getHelper(pos, \"wordChars\");\n    for (var first = true;; first = false) {\n      if (dir < 0 && !moveOnce(!first)) { break }\n      var cur = lineObj.text.charAt(pos.ch) || \"\\n\";\n      var type = isWordChar(cur, helper) ? \"w\"\n        : group && cur == \"\\n\" ? \"n\"\n        : !group || /\\s/.test(cur) ? null\n        : \"p\";\n      if (group && !first && !type) { type = \"s\"; }\n      if (sawType && sawType != type) {\n        if (dir < 0) {dir = 1; moveOnce(); pos.sticky = \"after\";}\n        break\n      }\n\n      if (type) { sawType = type; }\n      if (dir > 0 && !moveOnce(!first)) { break }\n    }\n  }\n  var result = skipAtomic(doc, pos, oldPos, origDir, true);\n  if (equalCursorPos(oldPos, result)) { result.hitSide = true; }\n  return result\n}\n\n// For relative vertical movement. Dir may be -1 or 1. Unit can be\n// \"page\" or \"line\". The resulting position will have a hitSide=true\n// property if it reached the end of the document.\nfunction findPosV(cm, pos, dir, unit) {\n  var doc = cm.doc, x = pos.left, y;\n  if (unit == \"page\") {\n    var pageSize = Math.min(cm.display.wrapper.clientHeight, window.innerHeight || document.documentElement.clientHeight);\n    var moveAmount = Math.max(pageSize - .5 * textHeight(cm.display), 3);\n    y = (dir > 0 ? pos.bottom : pos.top) + dir * moveAmount;\n\n  } else if (unit == \"line\") {\n    y = dir > 0 ? pos.bottom + 3 : pos.top - 3;\n  }\n  var target;\n  for (;;) {\n    target = coordsChar(cm, x, y);\n    if (!target.outside) { break }\n    if (dir < 0 ? y <= 0 : y >= doc.height) { target.hitSide = true; break }\n    y += dir * 5;\n  }\n  return target\n}\n\n// CONTENTEDITABLE INPUT STYLE\n\nvar ContentEditableInput = function(cm) {\n  this.cm = cm;\n  this.lastAnchorNode = this.lastAnchorOffset = this.lastFocusNode = this.lastFocusOffset = null;\n  this.polling = new Delayed();\n  this.composing = null;\n  this.gracePeriod = false;\n  this.readDOMTimeout = null;\n};\n\nContentEditableInput.prototype.init = function (display) {\n    var this$1 = this;\n\n  var input = this, cm = input.cm;\n  var div = input.div = display.lineDiv;\n  disableBrowserMagic(div, cm.options.spellcheck);\n\n  on(div, \"paste\", function (e) {\n    if (signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n    // IE doesn't fire input events, so we schedule a read for the pasted content in this way\n    if (ie_version <= 11) { setTimeout(operation(cm, function () { return this$1.updateFromDOM(); }), 20); }\n  });\n\n  on(div, \"compositionstart\", function (e) {\n    this$1.composing = {data: e.data, done: false};\n  });\n  on(div, \"compositionupdate\", function (e) {\n    if (!this$1.composing) { this$1.composing = {data: e.data, done: false}; }\n  });\n  on(div, \"compositionend\", function (e) {\n    if (this$1.composing) {\n      if (e.data != this$1.composing.data) { this$1.readFromDOMSoon(); }\n      this$1.composing.done = true;\n    }\n  });\n\n  on(div, \"touchstart\", function () { return input.forceCompositionEnd(); });\n\n  on(div, \"input\", function () {\n    if (!this$1.composing) { this$1.readFromDOMSoon(); }\n  });\n\n  function onCopyCut(e) {\n    if (signalDOMEvent(cm, e)) { return }\n    if (cm.somethingSelected()) {\n      setLastCopied({lineWise: false, text: cm.getSelections()});\n      if (e.type == \"cut\") { cm.replaceSelection(\"\", null, \"cut\"); }\n    } else if (!cm.options.lineWiseCopyCut) {\n      return\n    } else {\n      var ranges = copyableRanges(cm);\n      setLastCopied({lineWise: true, text: ranges.text});\n      if (e.type == \"cut\") {\n        cm.operation(function () {\n          cm.setSelections(ranges.ranges, 0, sel_dontScroll);\n          cm.replaceSelection(\"\", null, \"cut\");\n        });\n      }\n    }\n    if (e.clipboardData) {\n      e.clipboardData.clearData();\n      var content = lastCopied.text.join(\"\\n\");\n      // iOS exposes the clipboard API, but seems to discard content inserted into it\n      e.clipboardData.setData(\"Text\", content);\n      if (e.clipboardData.getData(\"Text\") == content) {\n        e.preventDefault();\n        return\n      }\n    }\n    // Old-fashioned briefly-focus-a-textarea hack\n    var kludge = hiddenTextarea(), te = kludge.firstChild;\n    cm.display.lineSpace.insertBefore(kludge, cm.display.lineSpace.firstChild);\n    te.value = lastCopied.text.join(\"\\n\");\n    var hadFocus = document.activeElement;\n    selectInput(te);\n    setTimeout(function () {\n      cm.display.lineSpace.removeChild(kludge);\n      hadFocus.focus();\n      if (hadFocus == div) { input.showPrimarySelection(); }\n    }, 50);\n  }\n  on(div, \"copy\", onCopyCut);\n  on(div, \"cut\", onCopyCut);\n};\n\nContentEditableInput.prototype.prepareSelection = function () {\n  var result = prepareSelection(this.cm, false);\n  result.focus = this.cm.state.focused;\n  return result\n};\n\nContentEditableInput.prototype.showSelection = function (info, takeFocus) {\n  if (!info || !this.cm.display.view.length) { return }\n  if (info.focus || takeFocus) { this.showPrimarySelection(); }\n  this.showMultipleSelections(info);\n};\n\nContentEditableInput.prototype.showPrimarySelection = function () {\n  var sel = window.getSelection(), cm = this.cm, prim = cm.doc.sel.primary();\n  var from = prim.from(), to = prim.to();\n\n  if (cm.display.viewTo == cm.display.viewFrom || from.line >= cm.display.viewTo || to.line < cm.display.viewFrom) {\n    sel.removeAllRanges();\n    return\n  }\n\n  var curAnchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n  var curFocus = domToPos(cm, sel.focusNode, sel.focusOffset);\n  if (curAnchor && !curAnchor.bad && curFocus && !curFocus.bad &&\n      cmp(minPos(curAnchor, curFocus), from) == 0 &&\n      cmp(maxPos(curAnchor, curFocus), to) == 0)\n    { return }\n\n  var view = cm.display.view;\n  var start = (from.line >= cm.display.viewFrom && posToDOM(cm, from)) ||\n      {node: view[0].measure.map[2], offset: 0};\n  var end = to.line < cm.display.viewTo && posToDOM(cm, to);\n  if (!end) {\n    var measure = view[view.length - 1].measure;\n    var map$$1 = measure.maps ? measure.maps[measure.maps.length - 1] : measure.map;\n    end = {node: map$$1[map$$1.length - 1], offset: map$$1[map$$1.length - 2] - map$$1[map$$1.length - 3]};\n  }\n\n  if (!start || !end) {\n    sel.removeAllRanges();\n    return\n  }\n\n  var old = sel.rangeCount && sel.getRangeAt(0), rng;\n  try { rng = range(start.node, start.offset, end.offset, end.node); }\n  catch(e) {} // Our model of the DOM might be outdated, in which case the range we try to set can be impossible\n  if (rng) {\n    if (!gecko && cm.state.focused) {\n      sel.collapse(start.node, start.offset);\n      if (!rng.collapsed) {\n        sel.removeAllRanges();\n        sel.addRange(rng);\n      }\n    } else {\n      sel.removeAllRanges();\n      sel.addRange(rng);\n    }\n    if (old && sel.anchorNode == null) { sel.addRange(old); }\n    else if (gecko) { this.startGracePeriod(); }\n  }\n  this.rememberSelection();\n};\n\nContentEditableInput.prototype.startGracePeriod = function () {\n    var this$1 = this;\n\n  clearTimeout(this.gracePeriod);\n  this.gracePeriod = setTimeout(function () {\n    this$1.gracePeriod = false;\n    if (this$1.selectionChanged())\n      { this$1.cm.operation(function () { return this$1.cm.curOp.selectionChanged = true; }); }\n  }, 20);\n};\n\nContentEditableInput.prototype.showMultipleSelections = function (info) {\n  removeChildrenAndAdd(this.cm.display.cursorDiv, info.cursors);\n  removeChildrenAndAdd(this.cm.display.selectionDiv, info.selection);\n};\n\nContentEditableInput.prototype.rememberSelection = function () {\n  var sel = window.getSelection();\n  this.lastAnchorNode = sel.anchorNode; this.lastAnchorOffset = sel.anchorOffset;\n  this.lastFocusNode = sel.focusNode; this.lastFocusOffset = sel.focusOffset;\n};\n\nContentEditableInput.prototype.selectionInEditor = function () {\n  var sel = window.getSelection();\n  if (!sel.rangeCount) { return false }\n  var node = sel.getRangeAt(0).commonAncestorContainer;\n  return contains(this.div, node)\n};\n\nContentEditableInput.prototype.focus = function () {\n  if (this.cm.options.readOnly != \"nocursor\") {\n    if (!this.selectionInEditor())\n      { this.showSelection(this.prepareSelection(), true); }\n    this.div.focus();\n  }\n};\nContentEditableInput.prototype.blur = function () { this.div.blur(); };\nContentEditableInput.prototype.getField = function () { return this.div };\n\nContentEditableInput.prototype.supportsTouch = function () { return true };\n\nContentEditableInput.prototype.receivedFocus = function () {\n  var input = this;\n  if (this.selectionInEditor())\n    { this.pollSelection(); }\n  else\n    { runInOp(this.cm, function () { return input.cm.curOp.selectionChanged = true; }); }\n\n  function poll() {\n    if (input.cm.state.focused) {\n      input.pollSelection();\n      input.polling.set(input.cm.options.pollInterval, poll);\n    }\n  }\n  this.polling.set(this.cm.options.pollInterval, poll);\n};\n\nContentEditableInput.prototype.selectionChanged = function () {\n  var sel = window.getSelection();\n  return sel.anchorNode != this.lastAnchorNode || sel.anchorOffset != this.lastAnchorOffset ||\n    sel.focusNode != this.lastFocusNode || sel.focusOffset != this.lastFocusOffset\n};\n\nContentEditableInput.prototype.pollSelection = function () {\n  if (this.readDOMTimeout != null || this.gracePeriod || !this.selectionChanged()) { return }\n  var sel = window.getSelection(), cm = this.cm;\n  // On Android Chrome (version 56, at least), backspacing into an\n  // uneditable block element will put the cursor in that element,\n  // and then, because it's not editable, hide the virtual keyboard.\n  // Because Android doesn't allow us to actually detect backspace\n  // presses in a sane way, this code checks for when that happens\n  // and simulates a backspace press in this case.\n  if (android && chrome && this.cm.options.gutters.length && isInGutter(sel.anchorNode)) {\n    this.cm.triggerOnKeyDown({type: \"keydown\", keyCode: 8, preventDefault: Math.abs});\n    this.blur();\n    this.focus();\n    return\n  }\n  if (this.composing) { return }\n  this.rememberSelection();\n  var anchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n  var head = domToPos(cm, sel.focusNode, sel.focusOffset);\n  if (anchor && head) { runInOp(cm, function () {\n    setSelection(cm.doc, simpleSelection(anchor, head), sel_dontScroll);\n    if (anchor.bad || head.bad) { cm.curOp.selectionChanged = true; }\n  }); }\n};\n\nContentEditableInput.prototype.pollContent = function () {\n  if (this.readDOMTimeout != null) {\n    clearTimeout(this.readDOMTimeout);\n    this.readDOMTimeout = null;\n  }\n\n  var cm = this.cm, display = cm.display, sel = cm.doc.sel.primary();\n  var from = sel.from(), to = sel.to();\n  if (from.ch == 0 && from.line > cm.firstLine())\n    { from = Pos(from.line - 1, getLine(cm.doc, from.line - 1).length); }\n  if (to.ch == getLine(cm.doc, to.line).text.length && to.line < cm.lastLine())\n    { to = Pos(to.line + 1, 0); }\n  if (from.line < display.viewFrom || to.line > display.viewTo - 1) { return false }\n\n  var fromIndex, fromLine, fromNode;\n  if (from.line == display.viewFrom || (fromIndex = findViewIndex(cm, from.line)) == 0) {\n    fromLine = lineNo(display.view[0].line);\n    fromNode = display.view[0].node;\n  } else {\n    fromLine = lineNo(display.view[fromIndex].line);\n    fromNode = display.view[fromIndex - 1].node.nextSibling;\n  }\n  var toIndex = findViewIndex(cm, to.line);\n  var toLine, toNode;\n  if (toIndex == display.view.length - 1) {\n    toLine = display.viewTo - 1;\n    toNode = display.lineDiv.lastChild;\n  } else {\n    toLine = lineNo(display.view[toIndex + 1].line) - 1;\n    toNode = display.view[toIndex + 1].node.previousSibling;\n  }\n\n  if (!fromNode) { return false }\n  var newText = cm.doc.splitLines(domTextBetween(cm, fromNode, toNode, fromLine, toLine));\n  var oldText = getBetween(cm.doc, Pos(fromLine, 0), Pos(toLine, getLine(cm.doc, toLine).text.length));\n  while (newText.length > 1 && oldText.length > 1) {\n    if (lst(newText) == lst(oldText)) { newText.pop(); oldText.pop(); toLine--; }\n    else if (newText[0] == oldText[0]) { newText.shift(); oldText.shift(); fromLine++; }\n    else { break }\n  }\n\n  var cutFront = 0, cutEnd = 0;\n  var newTop = newText[0], oldTop = oldText[0], maxCutFront = Math.min(newTop.length, oldTop.length);\n  while (cutFront < maxCutFront && newTop.charCodeAt(cutFront) == oldTop.charCodeAt(cutFront))\n    { ++cutFront; }\n  var newBot = lst(newText), oldBot = lst(oldText);\n  var maxCutEnd = Math.min(newBot.length - (newText.length == 1 ? cutFront : 0),\n                           oldBot.length - (oldText.length == 1 ? cutFront : 0));\n  while (cutEnd < maxCutEnd &&\n         newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1))\n    { ++cutEnd; }\n  // Try to move start of change to start of selection if ambiguous\n  if (newText.length == 1 && oldText.length == 1 && fromLine == from.line) {\n    while (cutFront && cutFront > from.ch &&\n           newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1)) {\n      cutFront--;\n      cutEnd++;\n    }\n  }\n\n  newText[newText.length - 1] = newBot.slice(0, newBot.length - cutEnd).replace(/^\\u200b+/, \"\");\n  newText[0] = newText[0].slice(cutFront).replace(/\\u200b+$/, \"\");\n\n  var chFrom = Pos(fromLine, cutFront);\n  var chTo = Pos(toLine, oldText.length ? lst(oldText).length - cutEnd : 0);\n  if (newText.length > 1 || newText[0] || cmp(chFrom, chTo)) {\n    replaceRange(cm.doc, newText, chFrom, chTo, \"+input\");\n    return true\n  }\n};\n\nContentEditableInput.prototype.ensurePolled = function () {\n  this.forceCompositionEnd();\n};\nContentEditableInput.prototype.reset = function () {\n  this.forceCompositionEnd();\n};\nContentEditableInput.prototype.forceCompositionEnd = function () {\n  if (!this.composing) { return }\n  clearTimeout(this.readDOMTimeout);\n  this.composing = null;\n  this.updateFromDOM();\n  this.div.blur();\n  this.div.focus();\n};\nContentEditableInput.prototype.readFromDOMSoon = function () {\n    var this$1 = this;\n\n  if (this.readDOMTimeout != null) { return }\n  this.readDOMTimeout = setTimeout(function () {\n    this$1.readDOMTimeout = null;\n    if (this$1.composing) {\n      if (this$1.composing.done) { this$1.composing = null; }\n      else { return }\n    }\n    this$1.updateFromDOM();\n  }, 80);\n};\n\nContentEditableInput.prototype.updateFromDOM = function () {\n    var this$1 = this;\n\n  if (this.cm.isReadOnly() || !this.pollContent())\n    { runInOp(this.cm, function () { return regChange(this$1.cm); }); }\n};\n\nContentEditableInput.prototype.setUneditable = function (node) {\n  node.contentEditable = \"false\";\n};\n\nContentEditableInput.prototype.onKeyPress = function (e) {\n  if (e.charCode == 0) { return }\n  e.preventDefault();\n  if (!this.cm.isReadOnly())\n    { operation(this.cm, applyTextInput)(this.cm, String.fromCharCode(e.charCode == null ? e.keyCode : e.charCode), 0); }\n};\n\nContentEditableInput.prototype.readOnlyChanged = function (val) {\n  this.div.contentEditable = String(val != \"nocursor\");\n};\n\nContentEditableInput.prototype.onContextMenu = function () {};\nContentEditableInput.prototype.resetPosition = function () {};\n\nContentEditableInput.prototype.needsContentAttribute = true;\n\nfunction posToDOM(cm, pos) {\n  var view = findViewForLine(cm, pos.line);\n  if (!view || view.hidden) { return null }\n  var line = getLine(cm.doc, pos.line);\n  var info = mapFromLineView(view, line, pos.line);\n\n  var order = getOrder(line, cm.doc.direction), side = \"left\";\n  if (order) {\n    var partPos = getBidiPartAt(order, pos.ch);\n    side = partPos % 2 ? \"right\" : \"left\";\n  }\n  var result = nodeAndOffsetInLineMap(info.map, pos.ch, side);\n  result.offset = result.collapse == \"right\" ? result.end : result.start;\n  return result\n}\n\nfunction isInGutter(node) {\n  for (var scan = node; scan; scan = scan.parentNode)\n    { if (/CodeMirror-gutter-wrapper/.test(scan.className)) { return true } }\n  return false\n}\n\nfunction badPos(pos, bad) { if (bad) { pos.bad = true; } return pos }\n\nfunction domTextBetween(cm, from, to, fromLine, toLine) {\n  var text = \"\", closing = false, lineSep = cm.doc.lineSeparator();\n  function recognizeMarker(id) { return function (marker) { return marker.id == id; } }\n  function close() {\n    if (closing) {\n      text += lineSep;\n      closing = false;\n    }\n  }\n  function addText(str) {\n    if (str) {\n      close();\n      text += str;\n    }\n  }\n  function walk(node) {\n    if (node.nodeType == 1) {\n      var cmText = node.getAttribute(\"cm-text\");\n      if (cmText != null) {\n        addText(cmText || node.textContent.replace(/\\u200b/g, \"\"));\n        return\n      }\n      var markerID = node.getAttribute(\"cm-marker\"), range$$1;\n      if (markerID) {\n        var found = cm.findMarks(Pos(fromLine, 0), Pos(toLine + 1, 0), recognizeMarker(+markerID));\n        if (found.length && (range$$1 = found[0].find(0)))\n          { addText(getBetween(cm.doc, range$$1.from, range$$1.to).join(lineSep)); }\n        return\n      }\n      if (node.getAttribute(\"contenteditable\") == \"false\") { return }\n      var isBlock = /^(pre|div|p)$/i.test(node.nodeName);\n      if (isBlock) { close(); }\n      for (var i = 0; i < node.childNodes.length; i++)\n        { walk(node.childNodes[i]); }\n      if (isBlock) { closing = true; }\n    } else if (node.nodeType == 3) {\n      addText(node.nodeValue);\n    }\n  }\n  for (;;) {\n    walk(from);\n    if (from == to) { break }\n    from = from.nextSibling;\n  }\n  return text\n}\n\nfunction domToPos(cm, node, offset) {\n  var lineNode;\n  if (node == cm.display.lineDiv) {\n    lineNode = cm.display.lineDiv.childNodes[offset];\n    if (!lineNode) { return badPos(cm.clipPos(Pos(cm.display.viewTo - 1)), true) }\n    node = null; offset = 0;\n  } else {\n    for (lineNode = node;; lineNode = lineNode.parentNode) {\n      if (!lineNode || lineNode == cm.display.lineDiv) { return null }\n      if (lineNode.parentNode && lineNode.parentNode == cm.display.lineDiv) { break }\n    }\n  }\n  for (var i = 0; i < cm.display.view.length; i++) {\n    var lineView = cm.display.view[i];\n    if (lineView.node == lineNode)\n      { return locateNodeInLineView(lineView, node, offset) }\n  }\n}\n\nfunction locateNodeInLineView(lineView, node, offset) {\n  var wrapper = lineView.text.firstChild, bad = false;\n  if (!node || !contains(wrapper, node)) { return badPos(Pos(lineNo(lineView.line), 0), true) }\n  if (node == wrapper) {\n    bad = true;\n    node = wrapper.childNodes[offset];\n    offset = 0;\n    if (!node) {\n      var line = lineView.rest ? lst(lineView.rest) : lineView.line;\n      return badPos(Pos(lineNo(line), line.text.length), bad)\n    }\n  }\n\n  var textNode = node.nodeType == 3 ? node : null, topNode = node;\n  if (!textNode && node.childNodes.length == 1 && node.firstChild.nodeType == 3) {\n    textNode = node.firstChild;\n    if (offset) { offset = textNode.nodeValue.length; }\n  }\n  while (topNode.parentNode != wrapper) { topNode = topNode.parentNode; }\n  var measure = lineView.measure, maps = measure.maps;\n\n  function find(textNode, topNode, offset) {\n    for (var i = -1; i < (maps ? maps.length : 0); i++) {\n      var map$$1 = i < 0 ? measure.map : maps[i];\n      for (var j = 0; j < map$$1.length; j += 3) {\n        var curNode = map$$1[j + 2];\n        if (curNode == textNode || curNode == topNode) {\n          var line = lineNo(i < 0 ? lineView.line : lineView.rest[i]);\n          var ch = map$$1[j] + offset;\n          if (offset < 0 || curNode != textNode) { ch = map$$1[j + (offset ? 1 : 0)]; }\n          return Pos(line, ch)\n        }\n      }\n    }\n  }\n  var found = find(textNode, topNode, offset);\n  if (found) { return badPos(found, bad) }\n\n  // FIXME this is all really shaky. might handle the few cases it needs to handle, but likely to cause problems\n  for (var after = topNode.nextSibling, dist = textNode ? textNode.nodeValue.length - offset : 0; after; after = after.nextSibling) {\n    found = find(after, after.firstChild, 0);\n    if (found)\n      { return badPos(Pos(found.line, found.ch - dist), bad) }\n    else\n      { dist += after.textContent.length; }\n  }\n  for (var before = topNode.previousSibling, dist$1 = offset; before; before = before.previousSibling) {\n    found = find(before, before.firstChild, -1);\n    if (found)\n      { return badPos(Pos(found.line, found.ch + dist$1), bad) }\n    else\n      { dist$1 += before.textContent.length; }\n  }\n}\n\n// TEXTAREA INPUT STYLE\n\nvar TextareaInput = function(cm) {\n  this.cm = cm;\n  // See input.poll and input.reset\n  this.prevInput = \"\";\n\n  // Flag that indicates whether we expect input to appear real soon\n  // now (after some event like 'keypress' or 'input') and are\n  // polling intensively.\n  this.pollingFast = false;\n  // Self-resetting timeout for the poller\n  this.polling = new Delayed();\n  // Used to work around IE issue with selection being forgotten when focus moves away from textarea\n  this.hasSelection = false;\n  this.composing = null;\n};\n\nTextareaInput.prototype.init = function (display) {\n    var this$1 = this;\n\n  var input = this, cm = this.cm;\n\n  // Wraps and hides input textarea\n  var div = this.wrapper = hiddenTextarea();\n  // The semihidden textarea that is focused when the editor is\n  // focused, and receives input.\n  var te = this.textarea = div.firstChild;\n  display.wrapper.insertBefore(div, display.wrapper.firstChild);\n\n  // Needed to hide big blue blinking cursor on Mobile Safari (doesn't seem to work in iOS 8 anymore)\n  if (ios) { te.style.width = \"0px\"; }\n\n  on(te, \"input\", function () {\n    if (ie && ie_version >= 9 && this$1.hasSelection) { this$1.hasSelection = null; }\n    input.poll();\n  });\n\n  on(te, \"paste\", function (e) {\n    if (signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n\n    cm.state.pasteIncoming = true;\n    input.fastPoll();\n  });\n\n  function prepareCopyCut(e) {\n    if (signalDOMEvent(cm, e)) { return }\n    if (cm.somethingSelected()) {\n      setLastCopied({lineWise: false, text: cm.getSelections()});\n    } else if (!cm.options.lineWiseCopyCut) {\n      return\n    } else {\n      var ranges = copyableRanges(cm);\n      setLastCopied({lineWise: true, text: ranges.text});\n      if (e.type == \"cut\") {\n        cm.setSelections(ranges.ranges, null, sel_dontScroll);\n      } else {\n        input.prevInput = \"\";\n        te.value = ranges.text.join(\"\\n\");\n        selectInput(te);\n      }\n    }\n    if (e.type == \"cut\") { cm.state.cutIncoming = true; }\n  }\n  on(te, \"cut\", prepareCopyCut);\n  on(te, \"copy\", prepareCopyCut);\n\n  on(display.scroller, \"paste\", function (e) {\n    if (eventInWidget(display, e) || signalDOMEvent(cm, e)) { return }\n    cm.state.pasteIncoming = true;\n    input.focus();\n  });\n\n  // Prevent normal selection in the editor (we handle our own)\n  on(display.lineSpace, \"selectstart\", function (e) {\n    if (!eventInWidget(display, e)) { e_preventDefault(e); }\n  });\n\n  on(te, \"compositionstart\", function () {\n    var start = cm.getCursor(\"from\");\n    if (input.composing) { input.composing.range.clear(); }\n    input.composing = {\n      start: start,\n      range: cm.markText(start, cm.getCursor(\"to\"), {className: \"CodeMirror-composing\"})\n    };\n  });\n  on(te, \"compositionend\", function () {\n    if (input.composing) {\n      input.poll();\n      input.composing.range.clear();\n      input.composing = null;\n    }\n  });\n};\n\nTextareaInput.prototype.prepareSelection = function () {\n  // Redraw the selection and/or cursor\n  var cm = this.cm, display = cm.display, doc = cm.doc;\n  var result = prepareSelection(cm);\n\n  // Move the hidden textarea near the cursor to prevent scrolling artifacts\n  if (cm.options.moveInputWithCursor) {\n    var headPos = cursorCoords(cm, doc.sel.primary().head, \"div\");\n    var wrapOff = display.wrapper.getBoundingClientRect(), lineOff = display.lineDiv.getBoundingClientRect();\n    result.teTop = Math.max(0, Math.min(display.wrapper.clientHeight - 10,\n                                        headPos.top + lineOff.top - wrapOff.top));\n    result.teLeft = Math.max(0, Math.min(display.wrapper.clientWidth - 10,\n                                         headPos.left + lineOff.left - wrapOff.left));\n  }\n\n  return result\n};\n\nTextareaInput.prototype.showSelection = function (drawn) {\n  var cm = this.cm, display = cm.display;\n  removeChildrenAndAdd(display.cursorDiv, drawn.cursors);\n  removeChildrenAndAdd(display.selectionDiv, drawn.selection);\n  if (drawn.teTop != null) {\n    this.wrapper.style.top = drawn.teTop + \"px\";\n    this.wrapper.style.left = drawn.teLeft + \"px\";\n  }\n};\n\n// Reset the input to correspond to the selection (or to be empty,\n// when not typing and nothing is selected)\nTextareaInput.prototype.reset = function (typing) {\n  if (this.contextMenuPending || this.composing) { return }\n  var cm = this.cm;\n  if (cm.somethingSelected()) {\n    this.prevInput = \"\";\n    var content = cm.getSelection();\n    this.textarea.value = content;\n    if (cm.state.focused) { selectInput(this.textarea); }\n    if (ie && ie_version >= 9) { this.hasSelection = content; }\n  } else if (!typing) {\n    this.prevInput = this.textarea.value = \"\";\n    if (ie && ie_version >= 9) { this.hasSelection = null; }\n  }\n};\n\nTextareaInput.prototype.getField = function () { return this.textarea };\n\nTextareaInput.prototype.supportsTouch = function () { return false };\n\nTextareaInput.prototype.focus = function () {\n  if (this.cm.options.readOnly != \"nocursor\" && (!mobile || activeElt() != this.textarea)) {\n    try { this.textarea.focus(); }\n    catch (e) {} // IE8 will throw if the textarea is display: none or not in DOM\n  }\n};\n\nTextareaInput.prototype.blur = function () { this.textarea.blur(); };\n\nTextareaInput.prototype.resetPosition = function () {\n  this.wrapper.style.top = this.wrapper.style.left = 0;\n};\n\nTextareaInput.prototype.receivedFocus = function () { this.slowPoll(); };\n\n// Poll for input changes, using the normal rate of polling. This\n// runs as long as the editor is focused.\nTextareaInput.prototype.slowPoll = function () {\n    var this$1 = this;\n\n  if (this.pollingFast) { return }\n  this.polling.set(this.cm.options.pollInterval, function () {\n    this$1.poll();\n    if (this$1.cm.state.focused) { this$1.slowPoll(); }\n  });\n};\n\n// When an event has just come in that is likely to add or change\n// something in the input textarea, we poll faster, to ensure that\n// the change appears on the screen quickly.\nTextareaInput.prototype.fastPoll = function () {\n  var missed = false, input = this;\n  input.pollingFast = true;\n  function p() {\n    var changed = input.poll();\n    if (!changed && !missed) {missed = true; input.polling.set(60, p);}\n    else {input.pollingFast = false; input.slowPoll();}\n  }\n  input.polling.set(20, p);\n};\n\n// Read input from the textarea, and update the document to match.\n// When something is selected, it is present in the textarea, and\n// selected (unless it is huge, in which case a placeholder is\n// used). When nothing is selected, the cursor sits after previously\n// seen text (can be empty), which is stored in prevInput (we must\n// not reset the textarea when typing, because that breaks IME).\nTextareaInput.prototype.poll = function () {\n    var this$1 = this;\n\n  var cm = this.cm, input = this.textarea, prevInput = this.prevInput;\n  // Since this is called a *lot*, try to bail out as cheaply as\n  // possible when it is clear that nothing happened. hasSelection\n  // will be the case when there is a lot of text in the textarea,\n  // in which case reading its value would be expensive.\n  if (this.contextMenuPending || !cm.state.focused ||\n      (hasSelection(input) && !prevInput && !this.composing) ||\n      cm.isReadOnly() || cm.options.disableInput || cm.state.keySeq)\n    { return false }\n\n  var text = input.value;\n  // If nothing changed, bail.\n  if (text == prevInput && !cm.somethingSelected()) { return false }\n  // Work around nonsensical selection resetting in IE9/10, and\n  // inexplicable appearance of private area unicode characters on\n  // some key combos in Mac (#2689).\n  if (ie && ie_version >= 9 && this.hasSelection === text ||\n      mac && /[\\uf700-\\uf7ff]/.test(text)) {\n    cm.display.input.reset();\n    return false\n  }\n\n  if (cm.doc.sel == cm.display.selForContextMenu) {\n    var first = text.charCodeAt(0);\n    if (first == 0x200b && !prevInput) { prevInput = \"\\u200b\"; }\n    if (first == 0x21da) { this.reset(); return this.cm.execCommand(\"undo\") }\n  }\n  // Find the part of the input that is actually new\n  var same = 0, l = Math.min(prevInput.length, text.length);\n  while (same < l && prevInput.charCodeAt(same) == text.charCodeAt(same)) { ++same; }\n\n  runInOp(cm, function () {\n    applyTextInput(cm, text.slice(same), prevInput.length - same,\n                   null, this$1.composing ? \"*compose\" : null);\n\n    // Don't leave long text in the textarea, since it makes further polling slow\n    if (text.length > 1000 || text.indexOf(\"\\n\") > -1) { input.value = this$1.prevInput = \"\"; }\n    else { this$1.prevInput = text; }\n\n    if (this$1.composing) {\n      this$1.composing.range.clear();\n      this$1.composing.range = cm.markText(this$1.composing.start, cm.getCursor(\"to\"),\n                                         {className: \"CodeMirror-composing\"});\n    }\n  });\n  return true\n};\n\nTextareaInput.prototype.ensurePolled = function () {\n  if (this.pollingFast && this.poll()) { this.pollingFast = false; }\n};\n\nTextareaInput.prototype.onKeyPress = function () {\n  if (ie && ie_version >= 9) { this.hasSelection = null; }\n  this.fastPoll();\n};\n\nTextareaInput.prototype.onContextMenu = function (e) {\n  var input = this, cm = input.cm, display = cm.display, te = input.textarea;\n  var pos = posFromMouse(cm, e), scrollPos = display.scroller.scrollTop;\n  if (!pos || presto) { return } // Opera is difficult.\n\n  // Reset the current text selection only if the click is done outside of the selection\n  // and 'resetSelectionOnContextMenu' option is true.\n  var reset = cm.options.resetSelectionOnContextMenu;\n  if (reset && cm.doc.sel.contains(pos) == -1)\n    { operation(cm, setSelection)(cm.doc, simpleSelection(pos), sel_dontScroll); }\n\n  var oldCSS = te.style.cssText, oldWrapperCSS = input.wrapper.style.cssText;\n  input.wrapper.style.cssText = \"position: absolute\";\n  var wrapperBox = input.wrapper.getBoundingClientRect();\n  te.style.cssText = \"position: absolute; width: 30px; height: 30px;\\n      top: \" + (e.clientY - wrapperBox.top - 5) + \"px; left: \" + (e.clientX - wrapperBox.left - 5) + \"px;\\n      z-index: 1000; background: \" + (ie ? \"rgba(255, 255, 255, .05)\" : \"transparent\") + \";\\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);\";\n  var oldScrollY;\n  if (webkit) { oldScrollY = window.scrollY; } // Work around Chrome issue (#2712)\n  display.input.focus();\n  if (webkit) { window.scrollTo(null, oldScrollY); }\n  display.input.reset();\n  // Adds \"Select all\" to context menu in FF\n  if (!cm.somethingSelected()) { te.value = input.prevInput = \" \"; }\n  input.contextMenuPending = true;\n  display.selForContextMenu = cm.doc.sel;\n  clearTimeout(display.detectingSelectAll);\n\n  // Select-all will be greyed out if there's nothing to select, so\n  // this adds a zero-width space so that we can later check whether\n  // it got selected.\n  function prepareSelectAllHack() {\n    if (te.selectionStart != null) {\n      var selected = cm.somethingSelected();\n      var extval = \"\\u200b\" + (selected ? te.value : \"\");\n      te.value = \"\\u21da\"; // Used to catch context-menu undo\n      te.value = extval;\n      input.prevInput = selected ? \"\" : \"\\u200b\";\n      te.selectionStart = 1; te.selectionEnd = extval.length;\n      // Re-set this, in case some other handler touched the\n      // selection in the meantime.\n      display.selForContextMenu = cm.doc.sel;\n    }\n  }\n  function rehide() {\n    input.contextMenuPending = false;\n    input.wrapper.style.cssText = oldWrapperCSS;\n    te.style.cssText = oldCSS;\n    if (ie && ie_version < 9) { display.scrollbars.setScrollTop(display.scroller.scrollTop = scrollPos); }\n\n    // Try to detect the user choosing select-all\n    if (te.selectionStart != null) {\n      if (!ie || (ie && ie_version < 9)) { prepareSelectAllHack(); }\n      var i = 0, poll = function () {\n        if (display.selForContextMenu == cm.doc.sel && te.selectionStart == 0 &&\n            te.selectionEnd > 0 && input.prevInput == \"\\u200b\") {\n          operation(cm, selectAll)(cm);\n        } else if (i++ < 10) {\n          display.detectingSelectAll = setTimeout(poll, 500);\n        } else {\n          display.selForContextMenu = null;\n          display.input.reset();\n        }\n      };\n      display.detectingSelectAll = setTimeout(poll, 200);\n    }\n  }\n\n  if (ie && ie_version >= 9) { prepareSelectAllHack(); }\n  if (captureRightClick) {\n    e_stop(e);\n    var mouseup = function () {\n      off(window, \"mouseup\", mouseup);\n      setTimeout(rehide, 20);\n    };\n    on(window, \"mouseup\", mouseup);\n  } else {\n    setTimeout(rehide, 50);\n  }\n};\n\nTextareaInput.prototype.readOnlyChanged = function (val) {\n  if (!val) { this.reset(); }\n  this.textarea.disabled = val == \"nocursor\";\n};\n\nTextareaInput.prototype.setUneditable = function () {};\n\nTextareaInput.prototype.needsContentAttribute = false;\n\nfunction fromTextArea(textarea, options) {\n  options = options ? copyObj(options) : {};\n  options.value = textarea.value;\n  if (!options.tabindex && textarea.tabIndex)\n    { options.tabindex = textarea.tabIndex; }\n  if (!options.placeholder && textarea.placeholder)\n    { options.placeholder = textarea.placeholder; }\n  // Set autofocus to true if this textarea is focused, or if it has\n  // autofocus and no other element is focused.\n  if (options.autofocus == null) {\n    var hasFocus = activeElt();\n    options.autofocus = hasFocus == textarea ||\n      textarea.getAttribute(\"autofocus\") != null && hasFocus == document.body;\n  }\n\n  function save() {textarea.value = cm.getValue();}\n\n  var realSubmit;\n  if (textarea.form) {\n    on(textarea.form, \"submit\", save);\n    // Deplorable hack to make the submit method do the right thing.\n    if (!options.leaveSubmitMethodAlone) {\n      var form = textarea.form;\n      realSubmit = form.submit;\n      try {\n        var wrappedSubmit = form.submit = function () {\n          save();\n          form.submit = realSubmit;\n          form.submit();\n          form.submit = wrappedSubmit;\n        };\n      } catch(e) {}\n    }\n  }\n\n  options.finishInit = function (cm) {\n    cm.save = save;\n    cm.getTextArea = function () { return textarea; };\n    cm.toTextArea = function () {\n      cm.toTextArea = isNaN; // Prevent this from being ran twice\n      save();\n      textarea.parentNode.removeChild(cm.getWrapperElement());\n      textarea.style.display = \"\";\n      if (textarea.form) {\n        off(textarea.form, \"submit\", save);\n        if (typeof textarea.form.submit == \"function\")\n          { textarea.form.submit = realSubmit; }\n      }\n    };\n  };\n\n  textarea.style.display = \"none\";\n  var cm = CodeMirror$1(function (node) { return textarea.parentNode.insertBefore(node, textarea.nextSibling); },\n    options);\n  return cm\n}\n\nfunction addLegacyProps(CodeMirror) {\n  CodeMirror.off = off;\n  CodeMirror.on = on;\n  CodeMirror.wheelEventPixels = wheelEventPixels;\n  CodeMirror.Doc = Doc;\n  CodeMirror.splitLines = splitLinesAuto;\n  CodeMirror.countColumn = countColumn;\n  CodeMirror.findColumn = findColumn;\n  CodeMirror.isWordChar = isWordCharBasic;\n  CodeMirror.Pass = Pass;\n  CodeMirror.signal = signal;\n  CodeMirror.Line = Line;\n  CodeMirror.changeEnd = changeEnd;\n  CodeMirror.scrollbarModel = scrollbarModel;\n  CodeMirror.Pos = Pos;\n  CodeMirror.cmpPos = cmp;\n  CodeMirror.modes = modes;\n  CodeMirror.mimeModes = mimeModes;\n  CodeMirror.resolveMode = resolveMode;\n  CodeMirror.getMode = getMode;\n  CodeMirror.modeExtensions = modeExtensions;\n  CodeMirror.extendMode = extendMode;\n  CodeMirror.copyState = copyState;\n  CodeMirror.startState = startState;\n  CodeMirror.innerMode = innerMode;\n  CodeMirror.commands = commands;\n  CodeMirror.keyMap = keyMap;\n  CodeMirror.keyName = keyName;\n  CodeMirror.isModifierKey = isModifierKey;\n  CodeMirror.lookupKey = lookupKey;\n  CodeMirror.normalizeKeyMap = normalizeKeyMap;\n  CodeMirror.StringStream = StringStream;\n  CodeMirror.SharedTextMarker = SharedTextMarker;\n  CodeMirror.TextMarker = TextMarker;\n  CodeMirror.LineWidget = LineWidget;\n  CodeMirror.e_preventDefault = e_preventDefault;\n  CodeMirror.e_stopPropagation = e_stopPropagation;\n  CodeMirror.e_stop = e_stop;\n  CodeMirror.addClass = addClass;\n  CodeMirror.contains = contains;\n  CodeMirror.rmClass = rmClass;\n  CodeMirror.keyNames = keyNames;\n}\n\n// EDITOR CONSTRUCTOR\n\ndefineOptions(CodeMirror$1);\n\naddEditorMethods(CodeMirror$1);\n\n// Set up methods on CodeMirror's prototype to redirect to the editor's document.\nvar dontDelegate = \"iter insert remove copy getEditor constructor\".split(\" \");\nfor (var prop in Doc.prototype) { if (Doc.prototype.hasOwnProperty(prop) && indexOf(dontDelegate, prop) < 0)\n  { CodeMirror$1.prototype[prop] = (function(method) {\n    return function() {return method.apply(this.doc, arguments)}\n  })(Doc.prototype[prop]); } }\n\neventMixin(Doc);\n\n// INPUT HANDLING\n\nCodeMirror$1.inputStyles = {\"textarea\": TextareaInput, \"contenteditable\": ContentEditableInput};\n\n// MODE DEFINITION AND QUERYING\n\n// Extra arguments are stored as the mode's dependencies, which is\n// used by (legacy) mechanisms like loadmode.js to automatically\n// load a mode. (Preferred mechanism is the require/define calls.)\nCodeMirror$1.defineMode = function(name/*, mode, */) {\n  if (!CodeMirror$1.defaults.mode && name != \"null\") { CodeMirror$1.defaults.mode = name; }\n  defineMode.apply(this, arguments);\n};\n\nCodeMirror$1.defineMIME = defineMIME;\n\n// Minimal default mode.\nCodeMirror$1.defineMode(\"null\", function () { return ({token: function (stream) { return stream.skipToEnd(); }}); });\nCodeMirror$1.defineMIME(\"text/plain\", \"null\");\n\n// EXTENSIONS\n\nCodeMirror$1.defineExtension = function (name, func) {\n  CodeMirror$1.prototype[name] = func;\n};\nCodeMirror$1.defineDocExtension = function (name, func) {\n  Doc.prototype[name] = func;\n};\n\nCodeMirror$1.fromTextArea = fromTextArea;\n\naddLegacyProps(CodeMirror$1);\n\nCodeMirror$1.version = \"5.33.0\";\n\nreturn CodeMirror$1;\n\n})));\n","import * as React from 'react'\nimport { Octicon, OcticonSymbol } from '../octicons'\n\n/** A Loading component. */\nexport class Loading extends React.Component<{}, {}> {\n  public render() {\n    return <Octicon className=\"spin\" symbol={OcticonSymbol.sync} />\n  }\n}\n","/**\n * Identifies a particular subset of progress events from Git by\n * title.\n */\nexport interface IProgressStep {\n  /**\n   * The title of the git progress event. By title we refer to the\n   * exact value of the title field in the Git progress struct:\n   *\n   * https://github.com/git/git/blob/6a2c2f8d34fa1e8f3bb85d159d354810ed63692e/progress.c#L31-L39\n   *\n   * In essence this means anything up to (but not including) the last colon (:)\n   * in a single progress line. Take this example progress line\n   *\n   *    remote: Compressing objects:  14% (159/1133)\n   *\n   * In this case the title would be 'remote: Compressing objects'.\n   */\n  readonly title: string\n\n  /**\n   * The weight of this step in relation to others for a particular\n   * Git operation. This value can be any number as long as it's\n   * proportional to others in the same parser, it will all be scaled\n   * to a decimal value between 0 and 1 before being used to calculate\n   * overall progress.\n   */\n  readonly weight: number\n}\n\n/**\n * The overall progress of one or more steps in a Git operation.\n */\nexport interface IGitProgress {\n  readonly kind: 'progress'\n\n  /**\n   * The overall percent of the operation\n   */\n  readonly percent: number\n\n  /**\n   * The underlying progress line that this progress instance was\n   * constructed from. Note that the percent value in details\n   * doesn't correspond to that of percent in this instance for\n   * two reasons. Fist, we calculate percent by dividing value with total\n   * to produce a high precision decimal value between 0 and 1 while\n   * details.percent is a rounded integer between 0 and 100.\n   *\n   * Second, the percent in this instance is scaled in relation to any\n   * other steps included in the progress parser.\n   */\n  readonly details: IGitProgressInfo\n}\n\nexport interface IGitOutput {\n  readonly kind: 'context'\n  readonly percent: number\n  readonly text: string\n}\n\n/**\n * A well-structured representation of a Git progress line.\n */\nexport interface IGitProgressInfo {\n  /**\n   * The title of the git progress event. By title we refer to the\n   * exact value of the title field in Git's progress struct:\n   *\n   * https://github.com/git/git/blob/6a2c2f8d34fa1e8f3bb85d159d354810ed63692e/progress.c#L31-L39\n   *\n   * In essence this means anything up to (but not including) the last colon (:)\n   * in a single progress line. Take this example progress line\n   *\n   *    remote: Compressing objects:  14% (159/1133)\n   *\n   * In this case the title would be 'remote: Compressing objects'.\n   */\n  readonly title: string\n\n  /**\n   * The progress value as parsed from the Git progress line.\n   *\n   * We define value to mean the same as it does in the Git progress struct, i.e\n   * it's the number of processed units.\n   *\n   * In the progress line 'remote: Compressing objects:  14% (159/1133)' the\n   * value is 159.\n   *\n   * In the progress line 'remote: Counting objects: 123' the value is 123.\n   *\n   */\n  readonly value: number\n\n  /**\n   * The progress total as parsed from the git progress line.\n   *\n   * We define total to mean the same as it does in the Git progress struct, i.e\n   * it's the total number of units in a given process.\n   *\n   * In the progress line 'remote: Compressing objects:  14% (159/1133)' the\n   * total is 1133.\n   *\n   * In the progress line 'remote: Counting objects: 123' the total is undefined.\n   *\n   */\n  readonly total?: number\n\n  /**\n   * The progress percent as parsed from the git progress line represented as\n   * an integer between 0 and 100.\n   *\n   * We define percent to mean the same as it does in the Git progress struct, i.e\n   * it's the value divided by total.\n   *\n   * In the progress line 'remote: Compressing objects:  14% (159/1133)' the\n   * percent is 14.\n   *\n   * In the progress line 'remote: Counting objects: 123' the percent is undefined.\n   *\n   */\n  readonly percent?: number\n\n  /**\n   * Whether or not the parsed git progress line indicates that the operation\n   * is done.\n   *\n   * This is denoted by a trailing \", done\" string in the progress line.\n   * Example: Checking out files:  100% (728/728), done\n   */\n  readonly done: boolean\n\n  /**\n   * The untouched raw text line that this instance was parsed from. Useful\n   * for presenting the actual output from Git to the user.\n   */\n  readonly text: string\n}\n\n/**\n * A utility class for interpreting progress output from `git`\n * and turning that into a percentage value estimating the overall progress\n * of the an operation. An operation could be something like `git fetch`\n * which contains multiple steps, each individually reported by Git as\n * progress events between 0 and 100%.\n *\n * A parser cannot be reused, it's mean to parse a single stderr stream\n * for Git.\n */\nexport class GitProgressParser {\n  private readonly steps: ReadonlyArray<IProgressStep>\n\n  /* The provided steps should always occur in order but some\n   * might not happen at all (like remote compression of objects) so\n   * we keep track of the \"highest\" seen step so that we can fill in\n   * progress with the assumption that we've already seen the previous\n   * steps.\n   */\n  private stepIndex = 0\n\n  private lastPercent = 0\n\n  /**\n   * Initialize a new instance of a Git progress parser.\n   *\n   * @param steps - A series of steps that could be present in the git\n   *                output with relative weight between these steps. Note\n   *                that order is significant here as once the parser sees\n   *                a progress line that matches a step all previous steps\n   *                are considered completed and overall progress is adjusted\n   *                accordingly.\n   */\n  public constructor(steps: ReadonlyArray<IProgressStep>) {\n    if (!steps.length) {\n      throw new Error('must specify at least one step')\n    }\n\n    // Scale the step weight so that they're all a percentage\n    // adjusted to the total weight of all steps.\n    const totalStepWeight = steps.reduce((sum, step) => sum + step.weight, 0)\n\n    this.steps = steps.map(step => ({\n      title: step.title,\n      weight: step.weight / totalStepWeight,\n    }))\n  }\n\n  /**\n   * Parse the given line of output from Git, returns either an IGitProgress\n   * instance if the line could successfully be parsed as a Git progress\n   * event whose title was registered with this parser or an IGitOutput\n   * instance if the line couldn't be parsed or if the title wasn't\n   * registered with the parser.\n   */\n  public parse(line: string): IGitProgress | IGitOutput {\n    const progress = parse(line)\n\n    if (!progress) {\n      return { kind: 'context', text: line, percent: this.lastPercent }\n    }\n\n    let percent = 0\n\n    for (let i = 0; i < this.steps.length; i++) {\n      const step = this.steps[i]\n\n      if (i >= this.stepIndex && progress.title === step.title) {\n        if (progress.total) {\n          percent += step.weight * (progress.value / progress.total)\n        }\n\n        this.stepIndex = i\n        this.lastPercent = percent\n\n        return { kind: 'progress', percent, details: progress }\n      } else {\n        percent += step.weight\n      }\n    }\n\n    return { kind: 'context', text: line, percent: this.lastPercent }\n  }\n}\n\nconst percentRe = /^(\\d{1,3})% \\((\\d+)\\/(\\d+)\\)$/\nconst valueOnlyRe = /^\\d+$/\n\n/**\n * Attempts to parse a single line of progress output from Git.\n *\n * For details about how Git formats progress see\n *\n *   https://github.com/git/git/blob/6a2c2f8d34fa1e8f3bb85d159d354810ed63692e/progress.c\n *\n * Some examples:\n *  remote: Counting objects: 123\n *  remote: Counting objects: 167587, done.\n *  Receiving objects:  99% (166741/167587), 272.10 MiB | 2.39 MiB/s\n *  Checking out files:  100% (728/728)\n *  Checking out files:  100% (728/728), done\n *\n * @returns An object containing well-structured information about the progress\n *          or null if the line could not be parsed as a Git progress line.\n */\nexport function parse(line: string): IGitProgressInfo | null {\n  const titleLength = line.lastIndexOf(': ')\n\n  if (titleLength === 0) {\n    return null\n  }\n\n  if (titleLength - 2 >= line.length) {\n    return null\n  }\n\n  const title = line.substr(0, titleLength)\n  const progressText = line.substr(title.length + 2).trim()\n\n  if (!progressText.length) {\n    return null\n  }\n\n  const progressParts = progressText.split(', ')\n\n  if (!progressParts.length) {\n    return null\n  }\n\n  let value: number\n  let total: number | undefined = undefined\n  let percent: number | undefined = undefined\n\n  if (valueOnlyRe.test(progressParts[0])) {\n    value = parseInt(progressParts[0], 10)\n\n    if (isNaN(value)) {\n      return null\n    }\n  } else {\n    const percentMatch = percentRe.exec(progressParts[0])\n\n    if (!percentMatch || percentMatch.length !== 4) {\n      return null\n    }\n\n    percent = parseInt(percentMatch[1], 10)\n    value = parseInt(percentMatch[2], 10)\n    total = parseInt(percentMatch[3], 10)\n\n    if (isNaN(percent) || isNaN(value) || isNaN(total)) {\n      return null\n    }\n  }\n\n  let done = false\n\n  // We don't parse throughput at the moment so let's just loop\n  // through the remaining\n  for (let i = 1; i < progressParts.length; i++) {\n    if (progressParts[i] === 'done.') {\n      done = true\n      break\n    }\n  }\n\n  return { title, value, percent, total, done, text: line }\n}\n","import { Commit } from './commit'\nimport { removeRemotePrefix } from '../lib/remove-remote-prefix'\n\n// NOTE: The values here matter as they are used to sort\n// local and remote branches, Local should come before Remote\nexport enum BranchType {\n  Local = 0,\n  Remote = 1,\n}\n\n/** The number of commits a revision range is ahead/behind. */\nexport interface IAheadBehind {\n  readonly ahead: number\n  readonly behind: number\n}\n\n/** The result of comparing two refs in a repository. */\nexport interface ICompareResult extends IAheadBehind {\n  readonly commits: ReadonlyArray<Commit>\n}\n\n/**\n * Check if a branch is eligible for beign fast forarded.\n *\n * Requirements:\n *   1. It's local.\n *   2. It's not the current branch.\n *   3. It has an upstream.\n *\n * @param branch The branch to validate\n * @param currentBranchName The current branch in the repository\n */\nexport function eligibleForFastForward(\n  branch: Branch,\n  currentBranchName: string | null\n): boolean {\n  return (\n    branch.type === BranchType.Local &&\n    branch.name !== currentBranchName &&\n    branch.upstream != null\n  )\n}\n\n/** A branch as loaded from Git. */\nexport class Branch {\n  /**\n   * A branch as loaded from Git.\n   *\n   * @param name The short name of the branch. E.g., `master`.\n   * @param upstream The remote-prefixed upstream name. E.g., `origin/master`.\n   * @param tip The commit associated with this branch\n   * @param type The type of branch, e.g., local or remote.\n   */\n  public constructor(\n    public readonly name: string,\n    public readonly upstream: string | null,\n    public readonly tip: Commit,\n    public readonly type: BranchType\n  ) {}\n\n  /** The name of the upstream's remote. */\n  public get remote(): string | null {\n    const upstream = this.upstream\n    if (!upstream) {\n      return null\n    }\n\n    const pieces = upstream.match(/(.*?)\\/.*/)\n    if (!pieces || pieces.length < 2) {\n      return null\n    }\n\n    return pieces[1]\n  }\n\n  /**\n   * The name of the branch's upstream without the remote prefix.\n   */\n  public get upstreamWithoutRemote(): string | null {\n    if (!this.upstream) {\n      return null\n    }\n\n    return removeRemotePrefix(this.upstream)\n  }\n\n  /**\n   * The name of the branch without the remote prefix. If the branch is a local\n   * branch, this is the same as its `name`.\n   */\n  public get nameWithoutRemote(): string {\n    if (this.type === BranchType.Local) {\n      return this.name\n    } else {\n      const withoutRemote = removeRemotePrefix(this.name)\n      return withoutRemote || this.name\n    }\n  }\n}\n","module.exports = require(\"os\");","module.exports = require(\"url\");","(function() {\n  exports.Emitter = require('./emitter');\n\n  exports.Disposable = require('./disposable');\n\n  exports.CompositeDisposable = require('./composite-disposable');\n\n}).call(this);\n","'use strict';\n\nvar _CSSTransitionGroup = require('./CSSTransitionGroup');\n\nvar _CSSTransitionGroup2 = _interopRequireDefault(_CSSTransitionGroup);\n\nvar _TransitionGroup = require('./TransitionGroup');\n\nvar _TransitionGroup2 = _interopRequireDefault(_TransitionGroup);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = {\n  TransitionGroup: _TransitionGroup2.default,\n  CSSTransitionGroup: _CSSTransitionGroup2.default\n};","module.exports = { \"default\": require(\"core-js/library/fn/object/keys\"), __esModule: true };","import * as React from 'react'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { encodePathAsUrl } from '../../lib/path'\nimport { AppStore, SignInState, SignInStep } from '../../lib/stores'\nimport { assertNever } from '../../lib/fatal-error'\nimport { Start } from './start'\nimport { SignInDotCom } from './sign-in-dot-com'\nimport { SignInEnterprise } from './sign-in-enterprise'\nimport { ConfigureGit } from './configure-git'\nimport { UiView } from '../ui-view'\nimport { UsageOptOut } from './usage-opt-out'\n\n/** The steps along the Welcome flow. */\nexport enum WelcomeStep {\n  Start = 'Start',\n  SignInToDotCom = 'SignInToDotCom',\n  SignInToEnterprise = 'SignInToEnterprise',\n  ConfigureGit = 'ConfigureGit',\n  UsageOptOut = 'UsageOptOut',\n}\n\ninterface IWelcomeProps {\n  readonly dispatcher: Dispatcher\n  readonly appStore: AppStore\n  readonly signInState: SignInState | null\n}\n\ninterface IWelcomeState {\n  readonly currentStep: WelcomeStep\n}\n\n// Note that we're reusing the welcome illustrations in the crash process, any\n// changes to these will have to be reflected in the crash process as well.\nconst WelcomeRightImageUri = encodePathAsUrl(\n  __dirname,\n  'static/welcome-illustration-right.svg'\n)\nconst WelcomeLeftTopImageUri = encodePathAsUrl(\n  __dirname,\n  'static/welcome-illustration-left-top.svg'\n)\nconst WelcomeLeftBottomImageUri = encodePathAsUrl(\n  __dirname,\n  'static/welcome-illustration-left-bottom.svg'\n)\n\n/** The Welcome flow. */\nexport class Welcome extends React.Component<IWelcomeProps, IWelcomeState> {\n  public constructor(props: IWelcomeProps) {\n    super(props)\n\n    this.state = { currentStep: WelcomeStep.Start }\n  }\n\n  public componentWillReceiveProps(nextProps: IWelcomeProps) {\n    this.advanceOnSuccessfulSignIn(nextProps)\n  }\n\n  public componentDidMount() {\n    this.props.dispatcher.recordWelcomeWizardInitiated()\n  }\n\n  /**\n   * Returns a value indicating whether or not the welcome flow is\n   * currently in one of the sign in steps, i.e. either dotcom sign\n   * in or enterprise sign in.\n   */\n  private get inSignInStep() {\n    if (this.state.currentStep === WelcomeStep.SignInToDotCom) {\n      return true\n    }\n\n    if (this.state.currentStep === WelcomeStep.SignInToEnterprise) {\n      return true\n    }\n\n    return false\n  }\n\n  /**\n   * Checks to see whether or not we're currently in a sign in step\n   * and whether the newly received props signal that the user has\n   * signed in successfully. If both conditions hold true we move\n   * the user to the configure git step.\n   */\n  private advanceOnSuccessfulSignIn(nextProps: IWelcomeProps) {\n    // If we're not currently in a sign in flow we don't care about\n    // new props\n    if (!this.inSignInStep) {\n      log.info(`[Welcome] no sign in step found. ignoring...`)\n      return\n    }\n\n    // We need to currently have a sign in state _and_ receive a new\n    // one in order to be able to make any sort of determination about\n    // what's going on in the sign in flow.\n    if (!this.props.signInState) {\n      log.info(`[Welcome] current sign in state not found. ignoring...`)\n      return\n    }\n\n    if (!nextProps.signInState) {\n      log.info(`[Welcome] next sign in state not found. ignoring...`)\n      return\n    }\n\n    // Only advance when the state first changes...\n    if (this.props.signInState.kind === nextProps.signInState.kind) {\n      log.info(\n        `[Welcome] kind ${this.props.signInState.kind} is the same as ${\n          nextProps.signInState.kind\n        }. ignoring...`\n      )\n      return\n    }\n\n    // ...and changes to success\n    if (nextProps.signInState.kind === SignInStep.Success) {\n      this.advanceToStep(WelcomeStep.ConfigureGit)\n      this.props.dispatcher.resetSignInState()\n    }\n  }\n\n  private getComponentForCurrentStep() {\n    const step = this.state.currentStep\n    const signInState = this.props.signInState\n\n    switch (step) {\n      case WelcomeStep.Start:\n        return <Start advance={this.advanceToStep} />\n\n      case WelcomeStep.SignInToDotCom:\n        return (\n          <SignInDotCom\n            dispatcher={this.props.dispatcher}\n            advance={this.advanceToStep}\n            signInState={signInState}\n          />\n        )\n\n      case WelcomeStep.SignInToEnterprise:\n        return (\n          <SignInEnterprise\n            dispatcher={this.props.dispatcher}\n            advance={this.advanceToStep}\n            signInState={signInState}\n          />\n        )\n\n      case WelcomeStep.ConfigureGit:\n        return (\n          <ConfigureGit\n            advance={this.advanceToStep}\n            accounts={this.props.appStore.getState().accounts}\n          />\n        )\n\n      case WelcomeStep.UsageOptOut:\n        return (\n          <UsageOptOut\n            dispatcher={this.props.dispatcher}\n            advance={this.advanceToStep}\n            optOut={this.props.appStore.getStatsOptOut()}\n            done={this.done}\n          />\n        )\n\n      default:\n        return assertNever(step, `Unknown welcome step: ${step}`)\n    }\n  }\n\n  private advanceToStep = (step: WelcomeStep) => {\n    log.info(`[Welcome] advancing to step: ${step}`)\n    if (step === WelcomeStep.SignInToDotCom) {\n      this.props.dispatcher.beginDotComSignIn()\n    } else if (step === WelcomeStep.SignInToEnterprise) {\n      this.props.dispatcher.beginEnterpriseSignIn()\n    }\n\n    this.setState({ currentStep: step })\n  }\n\n  private done = () => {\n    this.props.dispatcher.endWelcomeFlow()\n  }\n\n  public render() {\n    return (\n      <UiView id=\"welcome\">\n        <div className=\"welcome-left\">\n          <div className=\"welcome-content\">\n            {this.getComponentForCurrentStep()}\n            <img className=\"welcome-graphic-top\" src={WelcomeLeftTopImageUri} />\n            <img\n              className=\"welcome-graphic-bottom\"\n              src={WelcomeLeftBottomImageUri}\n            />\n          </div>\n        </div>\n\n        <div className=\"welcome-right\">\n          <img className=\"welcome-graphic\" src={WelcomeRightImageUri} />\n        </div>\n      </UiView>\n    )\n  }\n}\n","import * as React from 'react'\n\nimport { Image } from '../../../models/diff'\n\ninterface IImageProps {\n  /** The image contents to render */\n  readonly image: Image\n\n  /** Optional styles to apply to the image container */\n  readonly style?: React.CSSProperties\n\n  /** callback to fire after the image has been loaded */\n  readonly onElementLoad?: (img: HTMLImageElement) => void\n}\n\nexport class ImageContainer extends React.Component<IImageProps, {}> {\n  public render() {\n    const image = this.props.image\n    const imageSource = `data:${image.mediaType};base64,${image.contents}`\n\n    return (\n      <img src={imageSource} style={this.props.style} onLoad={this.onLoad} />\n    )\n  }\n\n  private onLoad = (e: React.SyntheticEvent<HTMLImageElement>) => {\n    if (this.props.onElementLoad) {\n      this.props.onElementLoad(e.currentTarget)\n    }\n  }\n}\n","import { uuid } from '../../lib/uuid'\n\nconst activeIds = new Set<string>()\nconst poolPrefix = '__'\n\nfunction sanitizeId(id: string): string {\n  // We're following the old HTML4 rules for ids for know\n  // and we're explicitly not testing for a valid first\n  // character since we have the poolPrefix which will\n  // guarantee that.\n  // See http://stackoverflow.com/a/79022/2114\n  return id.replace(/[^a-z0-9\\-_:.]+/gi, '_')\n}\n\n/**\n * Generate a unique id for an html element. The Id pool\n * maintains a list of used ids and if an id with a duplicate\n * prefix is already in use a counter value will be appended\n * to the generated id to maintain uniqueness.\n *\n * This method should be called from a component's\n * componentWillMount method and then released using the\n * releaseUniqueId method from the component's componentWillUnmount\n * method. The component should store the generated id in its\n * state for the lifetime of the component.\n *\n * @param prefix - A prefix used to distinguish components\n *                 or instances of components from each other.\n *                 At minimum a component should pass its own\n *                 name and ideally it should pass some other\n *                 form of semi-unique string directly related\n *                 to the currently rendering instance of that\n *                 component such as a friendly name (if such\n *                 a value exist. See TextBox for a good example).\n */\nexport function createUniqueId(prefix: string): string {\n  if (__DEV__) {\n    if (activeIds.size > 50) {\n      console.warn(\n        `Id pool contains ${\n          activeIds.size\n        } entries, it's possible that id's aren't being released properly.`\n      )\n    }\n  }\n\n  const safePrefix = sanitizeId(`${poolPrefix}${prefix}`)\n\n  for (let i = 0; i < 100; i++) {\n    const id = i > 0 ? `${safePrefix}_${i}` : safePrefix\n\n    if (!activeIds.has(id)) {\n      activeIds.add(id)\n      return id\n    }\n  }\n\n  // If we've failed to create an id 100 times it's likely\n  // that we've either started using the id pool so widely\n  // that 100 isn't enough at which point we should really\n  // look into the root cause because that shouldn't be\n  // necessary. In either case, let's just return a uuid\n  // without storing it in the activeIds set because we\n  // know it'll be unique.\n  if (__DEV__) {\n    console.warn(\n      `Exhausted search for valid id for ${prefix}. Please investigate.`\n    )\n  }\n\n  return uuid()\n}\n\n/**\n * Release a previously generated id such that it can be\n * reused by another component instance.\n */\nexport function releaseUniqueId(id: string) {\n  activeIds.delete(id)\n}\n","export * from './list'\nexport * from './selection'\n","export enum MergeResultKind {\n  Loading = 'loading',\n  Invalid = 'invalid',\n  Clean = 'clean',\n  Conflicts = 'conflicts',\n}\n\ninterface IBlobResult {\n  readonly mode: string\n  readonly sha: string\n  readonly path: string\n}\n\nexport interface IMergeEntry {\n  readonly context: string\n  readonly base?: IBlobResult\n  readonly result?: IBlobResult\n  readonly our?: IBlobResult\n  readonly their?: IBlobResult\n  readonly diff: string\n  readonly hasConflicts?: boolean\n}\n\nexport interface IMergeSuccess {\n  readonly kind: MergeResultKind.Clean\n  readonly entries: ReadonlyArray<IMergeEntry>\n}\n\nexport interface IMergeError {\n  readonly kind: MergeResultKind.Conflicts\n  readonly conflictedFiles: number\n}\n\nexport interface IMergeUnsupported {\n  readonly kind: MergeResultKind.Invalid\n}\n\nexport type MergeResult = IMergeSuccess | IMergeError | IMergeUnsupported\n","/** Create a copy of an object by merging it with a subset of its properties. */\nexport function merge<T, K extends keyof T>(obj: T, subset: Pick<T, K>): T {\n  const copy = Object.assign({}, obj)\n  for (const k in subset) {\n    copy[k] = subset[k]\n  }\n  return copy\n}\n","import { remote } from 'electron'\n\nlet app: Electron.App | null = null\nlet version: string | null = null\nlet name: string | null = null\nlet path: string | null = null\nlet userDataPath: string | null = null\nlet documentsPath: string | null = null\n\nfunction getApp(): Electron.App {\n  if (!app) {\n    app = remote.app\n  }\n\n  return app\n}\n\n/**\n * Get the version of the app.\n *\n * This is preferrable to using `remote` directly because we cache the result.\n */\nexport function getVersion(): string {\n  if (!version) {\n    version = getApp().getVersion()\n  }\n\n  return version\n}\n\n/**\n * Get the name of the app.\n *\n * This is preferrable to using `remote` directly because we cache the result.\n */\nexport function getName(): string {\n  if (!name) {\n    name = getApp().getName()\n  }\n\n  return name\n}\n\n/**\n * Get the path to the application.\n *\n * This is preferrable to using `remote` directly because we cache the result.\n */\nexport function getAppPath(): string {\n  if (!path) {\n    path = getApp().getAppPath()\n  }\n\n  return path\n}\n\n/**\n * Get the path to the user's data.\n *\n * This is preferrable to using `remote` directly because we cache the result.\n */\nexport function getUserDataPath(): string {\n  if (!userDataPath) {\n    userDataPath = getApp().getPath('userData')\n  }\n\n  return userDataPath\n}\n\n/**\n * Get the path to the user's documents path.\n *\n * This is preferrable to using `remote` directly because we cache the result.\n */\nexport function getDocumentsPath(): string {\n  if (!documentsPath) {\n    const app = getApp()\n    try {\n      documentsPath = app.getPath('documents')\n    } catch (ex) {\n      // a user profile may not have the Documents folder defined on Windows\n      documentsPath = app.getPath('home')\n    }\n  }\n\n  return documentsPath\n}\n","import * as React from 'react'\nimport * as classNames from 'classnames'\n\ninterface IFormProps {\n  /** The class name for the form. */\n  readonly className?: string\n\n  /** Called when the form is submitted. */\n  readonly onSubmit?: () => void\n}\n\n/** A form element with app-standard styles. */\nexport class Form extends React.Component<IFormProps, {}> {\n  public render() {\n    const className = classNames('form-component', this.props.className)\n    return (\n      <form className={className} onSubmit={this.onSubmit}>\n        {this.props.children}\n      </form>\n    )\n  }\n\n  private onSubmit = (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault()\n\n    if (this.props.onSubmit) {\n      this.props.onSubmit()\n    }\n  }\n}\n","import { assertNever } from '../../lib/fatal-error'\n\n/**\n * A set of the user-selectable appearances (aka themes)\n */\nexport enum ApplicationTheme {\n  Light,\n  Dark,\n}\n\n/**\n * Gets the friendly name of an application theme for use\n * in persisting to storage and/or calculating the required\n * body class name to set in order to apply the theme.\n */\nexport function getThemeName(theme: ApplicationTheme): string {\n  switch (theme) {\n    case ApplicationTheme.Light:\n      return 'light'\n    case ApplicationTheme.Dark:\n      return 'dark'\n    default:\n      return assertNever(theme, `Unknown theme ${theme}`)\n  }\n}\n\n// The key under which the currently selected theme is persisted\n// in localStorage.\nconst applicationThemeKey = 'theme'\n\n/**\n * Load the currently selected theme from the persistent\n * store (localStorage). If no theme is selected the default\n * theme will be returned.\n */\nexport function getPersistedTheme(): ApplicationTheme {\n  return localStorage.getItem(applicationThemeKey) === 'dark'\n    ? ApplicationTheme.Dark\n    : ApplicationTheme.Light\n}\n\n/**\n * Load the name of the currently selected theme from the persistent\n * store (localStorage). If no theme is selected the default\n * theme name will be returned.\n */\nexport function getPersistedThemeName(): string {\n  return getThemeName(getPersistedTheme())\n}\n\n/**\n * Store the given theme in the persistent store (localStorage).\n */\nexport function setPersistedTheme(theme: ApplicationTheme) {\n  localStorage.setItem(applicationThemeKey, getThemeName(theme))\n}\n","import * as React from 'react'\nimport * as classNames from 'classnames'\n\ninterface IUiViewProps extends React.HTMLProps<HTMLDivElement> {}\n\n/**\n * High order component for housing a View.\n *\n * In Desktop we currently define a view as a component which occupies\n * the entire app save for the sidebar and minus any currently active\n * popovers and of which there's only ever one single instance active\n * at any point in time.\n *\n * Examples of views are <Repository /> and <CloningRepository />.\n *\n * Examples of what's not a View include the Changes and History tabs\n * as these are contained within the <Repository /> view\n */\nexport class UiView extends React.Component<IUiViewProps, {}> {\n  public render() {\n    const className = classNames(this.props.className, 'ui-view')\n    const props = { ...this.props, className }\n\n    return <div {...props}>{this.props.children}</div>\n  }\n}\n","const deepEquals: (\n  actual: object,\n  expected: object,\n  opts?: { strict: boolean }\n) => boolean = require('deep-equal')\n\nexport function structuralEquals<T extends object>(\n  actual: T,\n  expected: T\n): boolean {\n  return deepEquals(actual, expected, { strict: true })\n}\n\n/**\n * Performs a shallow equality comparison on the two objects, iterating over\n * their keys (non-recursively) and compares their values.\n *\n * This method is functionally identical to that of React's shallowCompare\n * function and is intended to be used where we need to test for the same\n * kind of equality comparisons that a PureComponent performs.\n *\n * Note that for Arrays and primitive types this method will follow the same\n * semantics as Object.is, see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is\n */\nexport function shallowEquals(x: any, y: any) {\n  if (Object.is(x, y)) {\n    return true\n  }\n\n  // After this we know that neither side is null or undefined\n  if (\n    x === null ||\n    y === null ||\n    typeof x !== 'object' ||\n    typeof y !== 'object'\n  ) {\n    return false\n  }\n\n  const xKeys = Object.keys(x)\n  const yKeys = Object.keys(y)\n\n  if (xKeys.length !== yKeys.length) {\n    return false\n  }\n\n  for (let i = 0; i < xKeys.length; i++) {\n    const key = xKeys[i]\n    if (\n      !Object.prototype.hasOwnProperty.call(y, key) ||\n      !Object.is(x[key], y[key])\n    ) {\n      return false\n    }\n  }\n\n  return true\n}\n\n/**\n * Compares two arrays for element reference equality.\n *\n * Two arrays are considered equal if they either contain the\n * exact same elements in the same order (reference equality)\n * if they're both empty, or if they are the exact same object\n */\nexport function arrayEquals<T>(x: ReadonlyArray<T>, y: ReadonlyArray<T>) {\n  if (x === y) {\n    return true\n  }\n\n  if (x.length !== y.length) {\n    return false\n  }\n\n  for (let i = 0; i < x.length; i++) {\n    if (x[i] !== y[i]) {\n      return false\n    }\n  }\n\n  return true\n}\n","// to indexed object, toObject with fallback for non-array-like ES3 strings\nvar IObject = require('./$.iobject')\n  , defined = require('./$.defined');\nmodule.exports = function(it){\n  return IObject(defined(it));\n};","module.exports = {};","var global    = require('./$.global')\n  , core      = require('./$.core')\n  , ctx       = require('./$.ctx')\n  , PROTOTYPE = 'prototype';\n\nvar $export = function(type, name, source){\n  var IS_FORCED = type & $export.F\n    , IS_GLOBAL = type & $export.G\n    , IS_STATIC = type & $export.S\n    , IS_PROTO  = type & $export.P\n    , IS_BIND   = type & $export.B\n    , IS_WRAP   = type & $export.W\n    , exports   = IS_GLOBAL ? core : core[name] || (core[name] = {})\n    , target    = IS_GLOBAL ? global : IS_STATIC ? global[name] : (global[name] || {})[PROTOTYPE]\n    , key, own, out;\n  if(IS_GLOBAL)source = name;\n  for(key in source){\n    // contains in native\n    own = !IS_FORCED && target && key in target;\n    if(own && key in exports)continue;\n    // export native or passed\n    out = own ? target[key] : source[key];\n    // prevent global pollution for namespaces\n    exports[key] = IS_GLOBAL && typeof target[key] != 'function' ? source[key]\n    // bind timers to global for call from export context\n    : IS_BIND && own ? ctx(out, global)\n    // wrap global constructors for prevent change them in library\n    : IS_WRAP && target[key] == out ? (function(C){\n      var F = function(param){\n        return this instanceof C ? new C(param) : C(param);\n      };\n      F[PROTOTYPE] = C[PROTOTYPE];\n      return F;\n    // make static versions for prototype methods\n    })(out) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;\n    if(IS_PROTO)(exports[PROTOTYPE] || (exports[PROTOTYPE] = {}))[key] = out;\n  }\n};\n// type bitmap\n$export.F = 1;  // forced\n$export.G = 2;  // global\n$export.S = 4;  // static\n$export.P = 8;  // proto\n$export.B = 16; // bind\n$export.W = 32; // wrap\nmodule.exports = $export;","import * as React from 'react'\nimport * as classnames from 'classnames'\n\nimport {\n  List,\n  SelectionSource as ListSelectionSource,\n  findNextSelectableRow,\n} from '../lib/list'\nimport { TextBox } from '../lib/text-box'\nimport { Row } from '../lib/row'\n\nimport { match, IMatch, IMatches } from '../../lib/fuzzy-find'\n\n/** An item in the filter list. */\nexport interface IFilterListItem {\n  /** The text which represents the item. This is used for filtering. */\n  readonly text: ReadonlyArray<string>\n\n  /** A unique identifier for the item. */\n  readonly id: string\n}\n\n/** A group of items in the list. */\nexport interface IFilterListGroup<T extends IFilterListItem> {\n  /** The identifier for this group. */\n  readonly identifier: string\n\n  /** The items in the group. */\n  readonly items: ReadonlyArray<T>\n}\n\ninterface IFlattenedGroup {\n  readonly kind: 'group'\n  readonly identifier: string\n}\n\ninterface IFlattenedItem<T extends IFilterListItem> {\n  readonly kind: 'item'\n  readonly item: T\n  /** Array of indexes in `item.text` that should be highlighted */\n  readonly matches: IMatches\n}\n\n/**\n * A row in the list. This is used internally after the user-provided groups are\n * flattened.\n */\ntype IFilterListRow<T extends IFilterListItem> =\n  | IFlattenedGroup\n  | IFlattenedItem<T>\n\ninterface IFilterListProps<T extends IFilterListItem> {\n  /** A class name for the wrapping element. */\n  readonly className?: string\n\n  /** The height of the rows. */\n  readonly rowHeight: number\n\n  /** The ordered groups to display in the list. */\n  readonly groups: ReadonlyArray<IFilterListGroup<T>>\n\n  /** The selected item. */\n  readonly selectedItem: T | null\n\n  /** Called to render each visible item. */\n  readonly renderItem: (item: T, matches: IMatches) => JSX.Element | null\n\n  /** Called to render header for the group with the given identifier. */\n  readonly renderGroupHeader?: (identifier: string) => JSX.Element | null\n\n  /** Called to render content before/above the filter and list. */\n  readonly renderPreList?: () => JSX.Element | null\n\n  /** Called when an item is clicked. */\n  readonly onItemClick?: (item: T) => void\n\n  /**\n   * This function will be called when the selection changes as a result of a\n   * user keyboard or mouse action (i.e. not when props change). This function\n   * will not be invoked when an already selected row is clicked on.\n   *\n   * @param selectedItem - The item that was just selected\n   * @param source       - The kind of user action that provoked the change,\n   *                       either a pointer device press, or a keyboard event\n   *                       (arrow up/down)\n   */\n  readonly onSelectionChanged?: (\n    selectedItem: T | null,\n    source: SelectionSource\n  ) => void\n\n  /**\n   * Called when a key down happens in the filter text input. Users have a\n   * chance to respond or cancel the default behavior by calling\n   * `preventDefault()`.\n   */\n  readonly onFilterKeyDown?: (\n    event: React.KeyboardEvent<HTMLInputElement>\n  ) => void\n\n  /** The current filter text to use in the form */\n  readonly filterText?: string\n\n  /** Called when the filter text is changed by the user */\n  readonly onFilterTextChanged?: (text: string) => void\n\n  /**\n   * Whether or not the filter list should allow selection\n   * and filtering. Defaults to false.\n   */\n  readonly disabled?: boolean\n\n  /** Any props which should cause a re-render if they change. */\n  readonly invalidationProps: any\n\n  /** Called to render content after the filter. */\n  readonly renderPostFilter?: () => JSX.Element | null\n\n  /** Called when there are no items to render.  */\n  readonly renderNoItems?: () => JSX.Element | null\n\n  /**\n   * A reference to a TextBox that will be used to control this component.\n   *\n   * See https://github.com/desktop/desktop/issues/4317 for refactoring work to\n   * make this more composable which should make this unnecessary.\n   */\n  readonly filterTextBox?: TextBox\n\n  /**\n   * Callback to fire when the items in the filter list are updated\n   */\n  readonly onFilterListResultsChanged?: (resultCount: number) => void\n}\n\ninterface IFilterListState<T extends IFilterListItem> {\n  readonly rows: ReadonlyArray<IFilterListRow<T>>\n  readonly selectedRow: number\n}\n\n/**\n * Interface describing a user initiated selection change event\n * originating from changing the filter text.\n */\nexport interface IFilterSelectionSource {\n  kind: 'filter'\n\n  /** The filter text at the time the selection event was raised.  */\n  filterText: string\n}\n\nexport type SelectionSource = ListSelectionSource | IFilterSelectionSource\n\n/** A List which includes the ability to filter based on its contents. */\nexport class FilterList<T extends IFilterListItem> extends React.Component<\n  IFilterListProps<T>,\n  IFilterListState<T>\n> {\n  private list: List | null = null\n  private filterTextBox: TextBox | null = null\n\n  public constructor(props: IFilterListProps<T>) {\n    super(props)\n\n    this.state = createStateUpdate(props)\n  }\n\n  public componentWillMount() {\n    if (this.props.filterTextBox !== undefined) {\n      this.filterTextBox = this.props.filterTextBox\n    }\n  }\n\n  public componentWillReceiveProps(nextProps: IFilterListProps<T>) {\n    this.setState(createStateUpdate(nextProps))\n  }\n\n  public componentDidUpdate(\n    prevProps: IFilterListProps<T>,\n    prevState: IFilterListState<T>\n  ) {\n    if (this.props.onSelectionChanged) {\n      const oldSelectedItemId = getItemIdFromRowIndex(\n        prevState.rows,\n        prevState.selectedRow\n      )\n      const newSelectedItemId = getItemIdFromRowIndex(\n        this.state.rows,\n        this.state.selectedRow\n      )\n\n      if (oldSelectedItemId !== newSelectedItemId) {\n        const propSelectionId = this.props.selectedItem\n          ? this.props.selectedItem.id\n          : null\n\n        if (propSelectionId !== newSelectedItemId) {\n          const newSelectedItem = getItemFromRowIndex(\n            this.state.rows,\n            this.state.selectedRow\n          )\n          this.props.onSelectionChanged(newSelectedItem, {\n            kind: 'filter',\n            filterText: this.props.filterText || '',\n          })\n        }\n      }\n    }\n\n    if (this.props.onFilterListResultsChanged !== undefined) {\n      const itemCount = this.state.rows.filter(row => row.kind === 'item')\n        .length\n\n      this.props.onFilterListResultsChanged(itemCount)\n    }\n  }\n\n  public componentDidMount() {\n    if (this.filterTextBox !== null) {\n      this.filterTextBox.selectAll()\n    }\n  }\n\n  public renderTextBox() {\n    return (\n      <TextBox\n        ref={this.onTextBoxRef}\n        type=\"search\"\n        autoFocus={true}\n        placeholder=\"Filter\"\n        className=\"filter-list-filter-field\"\n        onValueChanged={this.onFilterValueChanged}\n        onKeyDown={this.onKeyDown}\n        value={this.props.filterText}\n        disabled={this.props.disabled}\n      />\n    )\n  }\n\n  public render() {\n    return (\n      <div className={classnames('filter-list', this.props.className)}>\n        {this.props.renderPreList ? this.props.renderPreList() : null}\n\n        <Row className=\"filter-field-row\">\n          {this.props.filterTextBox === undefined ? this.renderTextBox() : null}\n          {this.props.renderPostFilter ? this.props.renderPostFilter() : null}\n        </Row>\n\n        <div className=\"filter-list-container\">{this.renderContent()}</div>\n      </div>\n    )\n  }\n\n  public selectFirstItem(focus: boolean = false) {\n    if (this.list === null) {\n      return\n    }\n\n    const next = findNextSelectableRow(\n      this.state.rows.length,\n      {\n        direction: 'down',\n        row: -1,\n      },\n      this.canSelectRow\n    )\n\n    if (next !== null) {\n      this.setState({ selectedRow: next }, () => {\n        if (focus && this.list !== null) {\n          this.list.focus()\n        }\n      })\n    }\n  }\n\n  private renderContent() {\n    if (this.state.rows.length === 0 && this.props.renderNoItems) {\n      return this.props.renderNoItems()\n    } else {\n      return (\n        <List\n          ref={this.onListRef}\n          rowCount={this.state.rows.length}\n          rowRenderer={this.renderRow}\n          rowHeight={this.props.rowHeight}\n          selectedRows={[this.state.selectedRow]}\n          onSelectedRowChanged={this.onSelectedRowChanged}\n          onRowClick={this.onRowClick}\n          onRowKeyDown={this.onRowKeyDown}\n          canSelectRow={this.canSelectRow}\n          invalidationProps={{\n            ...this.props,\n            ...this.props.invalidationProps,\n          }}\n        />\n      )\n    }\n  }\n\n  private renderRow = (index: number) => {\n    const row = this.state.rows[index]\n    if (row.kind === 'item') {\n      return this.props.renderItem(row.item, row.matches)\n    } else if (this.props.renderGroupHeader) {\n      return this.props.renderGroupHeader(row.identifier)\n    } else {\n      return null\n    }\n  }\n\n  private onTextBoxRef = (component: TextBox | null) => {\n    this.filterTextBox = component\n  }\n\n  private onListRef = (instance: List | null) => {\n    this.list = instance\n  }\n\n  private onFilterValueChanged = (text: string) => {\n    if (this.props.onFilterTextChanged) {\n      this.props.onFilterTextChanged(text)\n    }\n  }\n\n  private onSelectedRowChanged = (index: number, source: SelectionSource) => {\n    this.setState({ selectedRow: index })\n\n    if (this.props.onSelectionChanged) {\n      const row = this.state.rows[index]\n      if (row.kind === 'item') {\n        this.props.onSelectionChanged(row.item, source)\n      }\n    }\n  }\n\n  private canSelectRow = (index: number) => {\n    if (this.props.disabled) {\n      return false\n    }\n\n    const row = this.state.rows[index]\n    return row.kind === 'item'\n  }\n\n  private onRowClick = (index: number) => {\n    if (this.props.onItemClick) {\n      const row = this.state.rows[index]\n\n      if (row.kind === 'item') {\n        this.props.onItemClick(row.item)\n      }\n    }\n  }\n\n  private onRowKeyDown = (row: number, event: React.KeyboardEvent<any>) => {\n    const list = this.list\n    if (!list) {\n      return\n    }\n\n    const rowCount = this.state.rows.length\n\n    const firstSelectableRow = findNextSelectableRow(\n      rowCount,\n      { direction: 'down', row: -1 },\n      this.canSelectRow\n    )\n    const lastSelectableRow = findNextSelectableRow(\n      rowCount,\n      { direction: 'up', row: 0 },\n      this.canSelectRow\n    )\n\n    let shouldFocus = false\n\n    if (event.key === 'ArrowUp' && row === firstSelectableRow) {\n      shouldFocus = true\n    } else if (event.key === 'ArrowDown' && row === lastSelectableRow) {\n      shouldFocus = true\n    }\n\n    if (shouldFocus) {\n      const textBox = this.filterTextBox\n\n      if (textBox) {\n        event.preventDefault()\n        textBox.focus()\n      }\n    }\n  }\n\n  private onKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    const list = this.list\n    const key = event.key\n\n    if (!list) {\n      return\n    }\n\n    if (this.props.onFilterKeyDown) {\n      this.props.onFilterKeyDown(event)\n    }\n\n    if (event.defaultPrevented) {\n      return\n    }\n\n    const rowCount = this.state.rows.length\n\n    if (key === 'ArrowDown') {\n      if (rowCount > 0) {\n        const selectedRow = findNextSelectableRow(\n          rowCount,\n          { direction: 'down', row: -1 },\n          this.canSelectRow\n        )\n        if (selectedRow != null) {\n          this.setState({ selectedRow }, () => {\n            list.focus()\n          })\n        }\n      }\n\n      event.preventDefault()\n    } else if (key === 'ArrowUp') {\n      if (rowCount > 0) {\n        const selectedRow = findNextSelectableRow(\n          rowCount,\n          { direction: 'up', row: 0 },\n          this.canSelectRow\n        )\n        if (selectedRow != null) {\n          this.setState({ selectedRow }, () => {\n            list.focus()\n          })\n        }\n      }\n\n      event.preventDefault()\n    } else if (key === 'Enter') {\n      // no repositories currently displayed, bail out\n      if (rowCount === 0) {\n        return event.preventDefault()\n      }\n\n      const filterText = this.props.filterText\n\n      if (filterText !== undefined && !/\\S/.test(filterText)) {\n        return event.preventDefault()\n      }\n\n      const row = findNextSelectableRow(\n        rowCount,\n        { direction: 'down', row: -1 },\n        this.canSelectRow\n      )\n\n      if (row != null) {\n        this.onRowClick(row)\n      }\n    }\n  }\n}\n\nexport function getText<T extends IFilterListItem>(\n  item: T\n): ReadonlyArray<string> {\n  return item['text']\n}\n\nfunction createStateUpdate<T extends IFilterListItem>(\n  props: IFilterListProps<T>\n) {\n  const flattenedRows = new Array<IFilterListRow<T>>()\n  const filter = (props.filterText || '').toLowerCase()\n\n  for (const group of props.groups) {\n    const items: ReadonlyArray<IMatch<T>> = filter\n      ? match(filter, group.items, getText)\n      : group.items.map(item => ({\n          score: 1,\n          matches: { title: [], subtitle: [] },\n          item,\n        }))\n\n    if (!items.length) {\n      continue\n    }\n\n    if (props.renderGroupHeader) {\n      flattenedRows.push({ kind: 'group', identifier: group.identifier })\n    }\n\n    for (const { item, matches } of items) {\n      flattenedRows.push({ kind: 'item', item, matches })\n    }\n  }\n\n  let selectedRow = -1\n  const selectedItem = props.selectedItem\n  if (selectedItem) {\n    selectedRow = flattenedRows.findIndex(\n      i => i.kind === 'item' && i.item.id === selectedItem.id\n    )\n  }\n\n  if (selectedRow < 0 && filter.length) {\n    // If the selected item isn't in the list (e.g., filtered out), then\n    // select the first visible item.\n    selectedRow = flattenedRows.findIndex(i => i.kind === 'item')\n  }\n\n  return { rows: flattenedRows, selectedRow }\n}\n\nfunction getItemFromRowIndex<T extends IFilterListItem>(\n  items: ReadonlyArray<IFilterListRow<T>>,\n  index: number\n): T | null {\n  if (index >= 0 && index < items.length) {\n    const row = items[index]\n\n    if (row.kind === 'item') {\n      return row.item\n    }\n  }\n\n  return null\n}\n\nfunction getItemIdFromRowIndex<T extends IFilterListItem>(\n  items: ReadonlyArray<IFilterListRow<T>>,\n  index: number\n): string | null {\n  const item = getItemFromRowIndex(items, index)\n  return item ? item.id : null\n}\n","import * as React from 'react'\n\n// broken for SFCs: https://github.com/Microsoft/tslint-microsoft-contrib/issues/339\n/* tslint:disable react-unused-props-and-state */\n\ninterface IHighlightTextProps {\n  /** The text to render */\n  readonly text: string\n  /** The characters in `text` to highlight */\n  readonly highlight: ReadonlyArray<number>\n}\n\nexport const HighlightText: React.SFC<IHighlightTextProps> = ({\n  text,\n  highlight,\n}) => (\n  <span>\n    {\n      text\n        .split('')\n        .map((ch, i): [string, boolean] => [ch, highlight.includes(i)])\n        .concat([['', false]])\n        .reduce(\n          (state, [ch, matched], i, arr) => {\n            if (matched === state.matched && i < arr.length - 1) {\n              state.str += ch\n            } else {\n              const Component = state.matched ? 'mark' : 'span'\n              state.result.push(<Component key={i}>{state.str}</Component>)\n              state.str = ch\n              state.matched = matched\n            }\n            return state\n          },\n          {\n            matched: false,\n            str: '',\n            result: new Array<React.ReactElement<any>>(),\n          }\n        ).result\n    }\n  </span>\n)\n","export * from './checkout'\nexport * from './clone'\nexport * from './push'\nexport * from './fetch'\nexport * from './git'\nexport * from './pull'\nexport * from './from-process'\n","import { git } from './core'\nimport { Repository } from '../../models/repository'\nimport { normalize } from 'path'\n\n/** Look up a config value by name in the repository. */\nexport function getConfigValue(\n  repository: Repository,\n  name: string\n): Promise<string | null> {\n  return getConfigValueInPath(name, repository.path)\n}\n\n/** Look up a global config value by name. */\nexport function getGlobalConfigValue(\n  name: string,\n  env?: {\n    HOME: string\n  }\n): Promise<string | null> {\n  return getConfigValueInPath(name, null, env)\n}\n\n/** Set the local config value by name. */\nexport async function setGlobalConfigValue(\n  name: string,\n  value: string,\n  env?: {\n    HOME: string\n  }\n): Promise<void> {\n  const options = env ? { env } : undefined\n\n  await git(\n    ['config', '--global', '--replace-all', name, value],\n    __dirname,\n    'setGlobalConfigValue',\n    options\n  )\n}\n\nasync function getConfigValueInPath(\n  name: string,\n  path: string | null,\n  env?: {\n    HOME: string\n  }\n): Promise<string | null> {\n  const flags = ['config', '-z']\n  if (!path) {\n    flags.push('--global')\n  }\n\n  flags.push(name)\n\n  const result = await git(flags, path || __dirname, 'getConfigValueInPath', {\n    successExitCodes: new Set([0, 1]),\n    env,\n  })\n\n  // Git exits with 1 if the value isn't found. That's OK.\n  if (result.exitCode === 1) {\n    return null\n  }\n\n  const output = result.stdout\n  const pieces = output.split('\\0')\n  return pieces[0]\n}\n\n/** Get the path to the global git config. */\nexport async function getGlobalConfigPath(env?: {\n  HOME: string\n}): Promise<string | null> {\n  const options = env ? { env } : undefined\n  const result = await git(\n    ['config', '--global', '--list', '--show-origin', '--name-only', '-z'],\n    __dirname,\n    'getGlobalConfigPath',\n    options\n  )\n  const segments = result.stdout.split('\\0')\n  if (segments.length < 1) {\n    return null\n  }\n\n  const pathSegment = segments[0]\n  if (!pathSegment.length) {\n    return null\n  }\n\n  const path = pathSegment.match(/file:(.+)/i)\n  if (!path || path.length < 2) {\n    return null\n  }\n\n  return normalize(path[1])\n}\n\nexport interface IMergeTool {\n  /** The name of the configured merge tool. */\n  readonly name: string\n\n  /** The command to run for the merge tool. */\n  readonly command: string | null\n}\n\n/** Get the configured merge tool. */\nexport async function getMergeTool(): Promise<IMergeTool | null> {\n  const name = await getGlobalConfigValue('merge.tool')\n  if (name) {\n    const command = await getGlobalConfigValue(`mergetool.${name}.cmd`)\n    return { name, command }\n  } else {\n    return null\n  }\n}\n","import { git } from './core'\nimport { Repository } from '../../models/repository'\nimport { getConfigValue } from './config'\n\n/**\n * A representation of a Git commit message trailer.\n *\n * See git-interpret-trailers for more information.\n */\nexport interface ITrailer {\n  readonly token: string\n  readonly value: string\n}\n\n/**\n * Gets a value indicating whether the trailer token is\n * Co-Authored-By. Does not validate the token value.\n */\nexport function isCoAuthoredByTrailer(trailer: ITrailer) {\n  return trailer.token.toLowerCase() === 'co-authored-by'\n}\n\n/**\n * Parse a string containing only unfolded trailers produced by\n * git-interpret-trailers --only-input --only-trailers --unfold or\n * a derivative such as git log --format=\"%(trailers:only,unfold)\"\n *\n * @param trailers   A string containing one well formed trailer per\n *                   line\n *\n * @param separators A string containing all characters to use when\n *                   attempting to find the separator between token\n *                   and value in a trailer. See the configuration\n *                   option trailer.separators for more information\n *\n *                   Also see getTrailerSeparatorCharacters.\n */\nexport function parseRawUnfoldedTrailers(trailers: string, separators: string) {\n  const lines = trailers.split('\\n')\n  const parsedTrailers = new Array<ITrailer>()\n\n  for (const line of lines) {\n    const trailer = parseSingleUnfoldedTrailer(line, separators)\n\n    if (trailer) {\n      parsedTrailers.push(trailer)\n    }\n  }\n\n  return parsedTrailers\n}\n\nexport function parseSingleUnfoldedTrailer(\n  line: string,\n  separators: string\n): ITrailer | null {\n  for (const separator of separators) {\n    const ix = line.indexOf(separator)\n    if (ix > 0) {\n      return {\n        token: line.substring(0, ix).trim(),\n        value: line.substring(ix + 1).trim(),\n      }\n    }\n  }\n\n  return null\n}\n\n/**\n * Get a string containing the characters that may be used in this repository\n * separate tokens from values in commit message trailers. If no specific\n * trailer separator is configured the default separator (:) will be returned.\n */\nexport async function getTrailerSeparatorCharacters(\n  repository: Repository\n): Promise<string> {\n  return (await getConfigValue(repository, 'trailer.separators')) || ':'\n}\n\n/**\n * Extract commit message trailers from a commit message.\n *\n * The trailers returned here are unfolded, i.e. they've had their\n * whitespace continuation removed and are all on one line. See the\n * documentation for --unfold in the help for `git interpret-trailers`\n *\n * @param repository    The repository in which to run the interpret-\n *                      trailers command. Although not intuitive this\n *                      does matter as there are configuration options\n *                      available for the format, position, etc of commit\n *                      message trailers. See the manpage for\n *                      git-interpret-trailers for more information.\n *\n * @param commitMessage A commit message from where to attempt to extract\n *                      commit message trailers.\n *\n * @returns An array of zero or more parsed trailers\n */\nexport async function parseTrailers(\n  repository: Repository,\n  commitMessage: string\n): Promise<ReadonlyArray<ITrailer>> {\n  const result = await git(\n    ['interpret-trailers', '--parse'],\n    repository.path,\n    'parseTrailers',\n    {\n      stdin: commitMessage,\n    }\n  )\n\n  const trailers = result.stdout\n\n  if (trailers.length === 0) {\n    return []\n  }\n\n  const separators = await getTrailerSeparatorCharacters(repository)\n  return parseRawUnfoldedTrailers(result.stdout, separators)\n}\n\n/**\n * Merge one or more commit message trailers into a commit message.\n *\n * If no trailers are given this method will simply try to ensure that\n * any trailers that happen to be part of the raw message are formatted\n * in accordance with the configuration options set for trailers in\n * the given repository.\n *\n * Note that configuration may be set so that duplicate trailers are\n * kept or discarded.\n *\n * @param repository    The repository in which to run the interpret-\n *                      trailers command. Although not intuitive this\n *                      does matter as there are configuration options\n *                      available for the format, position, etc of commit\n *                      message trailers. See the manpage for\n *                      git-interpret-trailers for more information.\n *\n * @param commitMessage A commit message with or withot existing commit\n *                      message trailers into which to merge the trailers\n *                      given in the trailers parameter\n *\n * @param trailers      Zero or more trailers to merge into the commit message\n *\n * @returns             A commit message string where the provided trailers (if)\n *                      any have been merged into the commit message using the\n *                      configuration settings for trailers in the provided\n *                      repository.\n */\nexport async function mergeTrailers(\n  repository: Repository,\n  commitMessage: string,\n  trailers: ReadonlyArray<ITrailer>,\n  unfold: boolean = false\n) {\n  const args = ['interpret-trailers']\n\n  if (unfold) {\n    args.push('--unfold')\n  }\n\n  for (const trailer of trailers) {\n    args.push('--trailer', `${trailer.token}=${trailer.value}`)\n  }\n\n  const result = await git(args, repository.path, 'mergeTrailers', {\n    stdin: commitMessage,\n  })\n\n  return result.stdout\n}\n","import { GitProcess } from 'dugite'\nimport * as GitPerf from '../../ui/lib/git-perf'\n\ntype ProcessOutput = {\n  /** The contents of stdout received from the spawned process */\n  output: Buffer\n  /** The contents of stderr received from the spawned process */\n  error: Buffer\n  /** The exit code returned by the spawned process */\n  exitCode: number\n}\n\n/**\n * Spawn a Git process and buffer the stdout and stderr streams, deferring\n * all processing work to the caller.\n *\n * @param args Array of strings to pass to the Git executable.\n * @param path The path to execute the command from.\n * @param name The name of the operation - for tracing purposes.\n * @param successExitCodes An optional array of exit codes that indicate success.\n * @param stdOutMaxLength  An optional maximum number of bytes to read from stdout.\n *                         If the process writes more than this number of bytes it\n *                         will be killed silently and the truncated output is\n *                         returned.\n */\nexport function spawnAndComplete(\n  args: string[],\n  path: string,\n  name: string,\n  successExitCodes?: Set<number>,\n  stdOutMaxLength?: number\n): Promise<ProcessOutput> {\n  const commandName = `${name}: git ${args.join(' ')}`\n  return GitPerf.measure(\n    commandName,\n    () =>\n      new Promise<ProcessOutput>((resolve, reject) => {\n        const process = GitProcess.spawn(args, path)\n        let totalStdoutLength = 0\n        let killSignalSent = false\n\n        const stdoutChunks = new Array<Buffer>()\n        process.stdout.on('data', (chunk: Buffer) => {\n          if (!stdOutMaxLength || totalStdoutLength < stdOutMaxLength) {\n            stdoutChunks.push(chunk)\n            totalStdoutLength += chunk.length\n          }\n\n          if (\n            stdOutMaxLength &&\n            totalStdoutLength >= stdOutMaxLength &&\n            !killSignalSent\n          ) {\n            process.kill()\n            killSignalSent = true\n          }\n        })\n\n        const stderrChunks = new Array<Buffer>()\n        process.stderr.on('data', (chunk: Buffer) => {\n          stderrChunks.push(chunk)\n        })\n\n        process.on('error', err => {\n          // for unhandled errors raised by the process, let's surface this in the\n          // promise and make the caller handle it\n          reject(err)\n        })\n\n        process.on('close', (code, signal) => {\n          const stdout = Buffer.concat(\n            stdoutChunks,\n            stdOutMaxLength\n              ? Math.min(stdOutMaxLength, totalStdoutLength)\n              : totalStdoutLength\n          )\n\n          const stderr = Buffer.concat(stderrChunks)\n\n          // mimic the experience of GitProcess.exec for handling known codes when\n          // the process terminates\n          const exitCodes = successExitCodes || new Set([0])\n\n          if (exitCodes.has(code) || signal) {\n            resolve({\n              output: stdout,\n              error: stderr,\n              exitCode: code,\n            })\n            return\n          } else {\n            reject(\n              new Error(\n                `Git returned an unexpected exit code '${code}' which should be handled by the caller.'`\n              )\n            )\n          }\n        })\n      })\n  )\n}\n","import * as Path from 'path'\n\nlet CloningRepositoryID = 1\n\n/** A repository which is currently being cloned. */\nexport class CloningRepository {\n  public readonly id = CloningRepositoryID++\n\n  public constructor(\n    public readonly path: string,\n    public readonly url: string\n  ) {}\n\n  public get name(): string {\n    return Path.basename(this.url, '.git')\n  }\n\n  /**\n   * A hash of the properties of the object.\n   *\n   * Objects with the same hash are guaranteed to be structurally equal.\n   */\n  public get hash(): string {\n    return `${this.id}+${this.path}+${this.url}`\n  }\n}\n","type Protocol = 'ssh' | 'https'\n\ninterface IGitRemoteURL {\n  readonly protocol: Protocol\n\n  /** The hostname of the remote. */\n  readonly hostname: string\n\n  /**\n   * The owner of the GitHub repository. This will be null if the URL doesn't\n   * take the form of a GitHub repository URL (e.g., owner/name).\n   */\n  readonly owner: string | null\n\n  /**\n   * The name of the GitHub repository. This will be null if the URL doesn't\n   * take the form of a GitHub repository URL (e.g., owner/name).\n   */\n  readonly name: string | null\n}\n\n// Examples:\n// https://github.com/octocat/Hello-World.git\n// https://github.com/octocat/Hello-World.git/\n// git@github.com:octocat/Hello-World.git\n// git:github.com/octocat/Hello-World.git\nconst remoteRegexes: ReadonlyArray<{ protocol: Protocol; regex: RegExp }> = [\n  {\n    protocol: 'https',\n    regex: new RegExp('^https?://(?:.+@)?(.+)/(.+)/(.+?)(?:/|.git/?)?$'),\n  },\n  {\n    protocol: 'ssh',\n    regex: new RegExp('^git@(.+):(.+)/(.+?)(?:/|.git)?$'),\n  },\n  {\n    protocol: 'ssh',\n    regex: new RegExp('^git:(.+)/(.+)/(.+?)(?:/|.git)?$'),\n  },\n  {\n    protocol: 'ssh',\n    regex: new RegExp('^ssh://git@(.+)/(.+)/(.+?)(?:/|.git)?$'),\n  },\n]\n\n/** Parse the remote information from URL. */\nexport function parseRemote(url: string): IGitRemoteURL | null {\n  for (const { protocol, regex } of remoteRegexes) {\n    const result = url.match(regex)\n    if (!result) {\n      continue\n    }\n\n    const hostname = result[1]\n    const owner = result[2]\n    const name = result[3]\n    if (hostname) {\n      return { protocol, hostname, owner, name }\n    }\n  }\n\n  return null\n}\n\nexport interface IRepositoryIdentifier {\n  readonly hostname: string | null\n  readonly owner: string\n  readonly name: string\n}\n\n/** Try to parse an owner and name from a URL or owner/name shortcut. */\nexport function parseRepositoryIdentifier(\n  url: string\n): IRepositoryIdentifier | null {\n  const parsed = parseRemote(url)\n  // If we can parse it as a remote URL, we'll assume they gave us a proper\n  // URL. If not, we'll try treating it as a GitHub repository owner/name\n  // shortcut.\n  if (parsed) {\n    const { owner, name, hostname } = parsed\n    if (owner && name) {\n      return { owner, name, hostname }\n    }\n  }\n\n  const pieces = url.split('/')\n  if (pieces.length === 2 && pieces[0].length > 0 && pieces[1].length > 0) {\n    const owner = pieces[0]\n    const name = pieces[1]\n    return { owner, name, hostname: null }\n  }\n\n  return null\n}\n","import * as crypto from 'crypto'\n\nimport { getDotComAPIEndpoint } from './api'\n\n/**\n * Convert an email address to a Gravatar URL format\n *\n * @param email The email address associated with a user\n * @param size The size (in pixels) of the avatar to render\n */\nexport function generateGravatarUrl(email: string, size: number = 60): string {\n  const input = email.trim().toLowerCase()\n  const hash = crypto\n    .createHash('md5')\n    .update(input)\n    .digest('hex')\n\n  return `https://www.gravatar.com/avatar/${hash}?s=${size}`\n}\n\n/**\n * Retrieve the avatar for the given author, based on the\n * endpoint associated with an account.\n *\n * This is a workaround for a current limitation with\n * GitHub Enterprise, where avatar URLs are inaccessible\n * in some scenarios.\n *\n * @param avatar_url The canonical avatar to use\n * @param email The email address to use as a fallback\n * @param endpoint The API endpoint for the account\n */\nexport function getAvatarWithEnterpriseFallback(\n  avatar_url: string,\n  email: string | null,\n  endpoint: string\n): string {\n  if (endpoint === getDotComAPIEndpoint() || email === null) {\n    return avatar_url\n  }\n\n  return generateGravatarUrl(email)\n}\n","//! moment.js\n//! version : 2.18.1\n//! authors : Tim Wood, Iskren Chernev, Moment.js contributors\n//! license : MIT\n//! momentjs.com\n\n;(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define(factory) :\n    global.moment = factory()\n}(this, (function () { 'use strict';\n\nvar hookCallback;\n\nfunction hooks () {\n    return hookCallback.apply(null, arguments);\n}\n\n// This is done to register the method called with moment()\n// without creating circular dependencies.\nfunction setHookCallback (callback) {\n    hookCallback = callback;\n}\n\nfunction isArray(input) {\n    return input instanceof Array || Object.prototype.toString.call(input) === '[object Array]';\n}\n\nfunction isObject(input) {\n    // IE8 will treat undefined and null as object if it wasn't for\n    // input != null\n    return input != null && Object.prototype.toString.call(input) === '[object Object]';\n}\n\nfunction isObjectEmpty(obj) {\n    var k;\n    for (k in obj) {\n        // even if its not own property I'd still call it non-empty\n        return false;\n    }\n    return true;\n}\n\nfunction isUndefined(input) {\n    return input === void 0;\n}\n\nfunction isNumber(input) {\n    return typeof input === 'number' || Object.prototype.toString.call(input) === '[object Number]';\n}\n\nfunction isDate(input) {\n    return input instanceof Date || Object.prototype.toString.call(input) === '[object Date]';\n}\n\nfunction map(arr, fn) {\n    var res = [], i;\n    for (i = 0; i < arr.length; ++i) {\n        res.push(fn(arr[i], i));\n    }\n    return res;\n}\n\nfunction hasOwnProp(a, b) {\n    return Object.prototype.hasOwnProperty.call(a, b);\n}\n\nfunction extend(a, b) {\n    for (var i in b) {\n        if (hasOwnProp(b, i)) {\n            a[i] = b[i];\n        }\n    }\n\n    if (hasOwnProp(b, 'toString')) {\n        a.toString = b.toString;\n    }\n\n    if (hasOwnProp(b, 'valueOf')) {\n        a.valueOf = b.valueOf;\n    }\n\n    return a;\n}\n\nfunction createUTC (input, format, locale, strict) {\n    return createLocalOrUTC(input, format, locale, strict, true).utc();\n}\n\nfunction defaultParsingFlags() {\n    // We need to deep clone this object.\n    return {\n        empty           : false,\n        unusedTokens    : [],\n        unusedInput     : [],\n        overflow        : -2,\n        charsLeftOver   : 0,\n        nullInput       : false,\n        invalidMonth    : null,\n        invalidFormat   : false,\n        userInvalidated : false,\n        iso             : false,\n        parsedDateParts : [],\n        meridiem        : null,\n        rfc2822         : false,\n        weekdayMismatch : false\n    };\n}\n\nfunction getParsingFlags(m) {\n    if (m._pf == null) {\n        m._pf = defaultParsingFlags();\n    }\n    return m._pf;\n}\n\nvar some;\nif (Array.prototype.some) {\n    some = Array.prototype.some;\n} else {\n    some = function (fun) {\n        var t = Object(this);\n        var len = t.length >>> 0;\n\n        for (var i = 0; i < len; i++) {\n            if (i in t && fun.call(this, t[i], i, t)) {\n                return true;\n            }\n        }\n\n        return false;\n    };\n}\n\nvar some$1 = some;\n\nfunction isValid(m) {\n    if (m._isValid == null) {\n        var flags = getParsingFlags(m);\n        var parsedParts = some$1.call(flags.parsedDateParts, function (i) {\n            return i != null;\n        });\n        var isNowValid = !isNaN(m._d.getTime()) &&\n            flags.overflow < 0 &&\n            !flags.empty &&\n            !flags.invalidMonth &&\n            !flags.invalidWeekday &&\n            !flags.nullInput &&\n            !flags.invalidFormat &&\n            !flags.userInvalidated &&\n            (!flags.meridiem || (flags.meridiem && parsedParts));\n\n        if (m._strict) {\n            isNowValid = isNowValid &&\n                flags.charsLeftOver === 0 &&\n                flags.unusedTokens.length === 0 &&\n                flags.bigHour === undefined;\n        }\n\n        if (Object.isFrozen == null || !Object.isFrozen(m)) {\n            m._isValid = isNowValid;\n        }\n        else {\n            return isNowValid;\n        }\n    }\n    return m._isValid;\n}\n\nfunction createInvalid (flags) {\n    var m = createUTC(NaN);\n    if (flags != null) {\n        extend(getParsingFlags(m), flags);\n    }\n    else {\n        getParsingFlags(m).userInvalidated = true;\n    }\n\n    return m;\n}\n\n// Plugins that add properties should also add the key here (null value),\n// so we can properly clone ourselves.\nvar momentProperties = hooks.momentProperties = [];\n\nfunction copyConfig(to, from) {\n    var i, prop, val;\n\n    if (!isUndefined(from._isAMomentObject)) {\n        to._isAMomentObject = from._isAMomentObject;\n    }\n    if (!isUndefined(from._i)) {\n        to._i = from._i;\n    }\n    if (!isUndefined(from._f)) {\n        to._f = from._f;\n    }\n    if (!isUndefined(from._l)) {\n        to._l = from._l;\n    }\n    if (!isUndefined(from._strict)) {\n        to._strict = from._strict;\n    }\n    if (!isUndefined(from._tzm)) {\n        to._tzm = from._tzm;\n    }\n    if (!isUndefined(from._isUTC)) {\n        to._isUTC = from._isUTC;\n    }\n    if (!isUndefined(from._offset)) {\n        to._offset = from._offset;\n    }\n    if (!isUndefined(from._pf)) {\n        to._pf = getParsingFlags(from);\n    }\n    if (!isUndefined(from._locale)) {\n        to._locale = from._locale;\n    }\n\n    if (momentProperties.length > 0) {\n        for (i = 0; i < momentProperties.length; i++) {\n            prop = momentProperties[i];\n            val = from[prop];\n            if (!isUndefined(val)) {\n                to[prop] = val;\n            }\n        }\n    }\n\n    return to;\n}\n\nvar updateInProgress = false;\n\n// Moment prototype object\nfunction Moment(config) {\n    copyConfig(this, config);\n    this._d = new Date(config._d != null ? config._d.getTime() : NaN);\n    if (!this.isValid()) {\n        this._d = new Date(NaN);\n    }\n    // Prevent infinite loop in case updateOffset creates new moment\n    // objects.\n    if (updateInProgress === false) {\n        updateInProgress = true;\n        hooks.updateOffset(this);\n        updateInProgress = false;\n    }\n}\n\nfunction isMoment (obj) {\n    return obj instanceof Moment || (obj != null && obj._isAMomentObject != null);\n}\n\nfunction absFloor (number) {\n    if (number < 0) {\n        // -0 -> 0\n        return Math.ceil(number) || 0;\n    } else {\n        return Math.floor(number);\n    }\n}\n\nfunction toInt(argumentForCoercion) {\n    var coercedNumber = +argumentForCoercion,\n        value = 0;\n\n    if (coercedNumber !== 0 && isFinite(coercedNumber)) {\n        value = absFloor(coercedNumber);\n    }\n\n    return value;\n}\n\n// compare two arrays, return the number of differences\nfunction compareArrays(array1, array2, dontConvert) {\n    var len = Math.min(array1.length, array2.length),\n        lengthDiff = Math.abs(array1.length - array2.length),\n        diffs = 0,\n        i;\n    for (i = 0; i < len; i++) {\n        if ((dontConvert && array1[i] !== array2[i]) ||\n            (!dontConvert && toInt(array1[i]) !== toInt(array2[i]))) {\n            diffs++;\n        }\n    }\n    return diffs + lengthDiff;\n}\n\nfunction warn(msg) {\n    if (hooks.suppressDeprecationWarnings === false &&\n            (typeof console !==  'undefined') && console.warn) {\n        console.warn('Deprecation warning: ' + msg);\n    }\n}\n\nfunction deprecate(msg, fn) {\n    var firstTime = true;\n\n    return extend(function () {\n        if (hooks.deprecationHandler != null) {\n            hooks.deprecationHandler(null, msg);\n        }\n        if (firstTime) {\n            var args = [];\n            var arg;\n            for (var i = 0; i < arguments.length; i++) {\n                arg = '';\n                if (typeof arguments[i] === 'object') {\n                    arg += '\\n[' + i + '] ';\n                    for (var key in arguments[0]) {\n                        arg += key + ': ' + arguments[0][key] + ', ';\n                    }\n                    arg = arg.slice(0, -2); // Remove trailing comma and space\n                } else {\n                    arg = arguments[i];\n                }\n                args.push(arg);\n            }\n            warn(msg + '\\nArguments: ' + Array.prototype.slice.call(args).join('') + '\\n' + (new Error()).stack);\n            firstTime = false;\n        }\n        return fn.apply(this, arguments);\n    }, fn);\n}\n\nvar deprecations = {};\n\nfunction deprecateSimple(name, msg) {\n    if (hooks.deprecationHandler != null) {\n        hooks.deprecationHandler(name, msg);\n    }\n    if (!deprecations[name]) {\n        warn(msg);\n        deprecations[name] = true;\n    }\n}\n\nhooks.suppressDeprecationWarnings = false;\nhooks.deprecationHandler = null;\n\nfunction isFunction(input) {\n    return input instanceof Function || Object.prototype.toString.call(input) === '[object Function]';\n}\n\nfunction set (config) {\n    var prop, i;\n    for (i in config) {\n        prop = config[i];\n        if (isFunction(prop)) {\n            this[i] = prop;\n        } else {\n            this['_' + i] = prop;\n        }\n    }\n    this._config = config;\n    // Lenient ordinal parsing accepts just a number in addition to\n    // number + (possibly) stuff coming from _dayOfMonthOrdinalParse.\n    // TODO: Remove \"ordinalParse\" fallback in next major release.\n    this._dayOfMonthOrdinalParseLenient = new RegExp(\n        (this._dayOfMonthOrdinalParse.source || this._ordinalParse.source) +\n            '|' + (/\\d{1,2}/).source);\n}\n\nfunction mergeConfigs(parentConfig, childConfig) {\n    var res = extend({}, parentConfig), prop;\n    for (prop in childConfig) {\n        if (hasOwnProp(childConfig, prop)) {\n            if (isObject(parentConfig[prop]) && isObject(childConfig[prop])) {\n                res[prop] = {};\n                extend(res[prop], parentConfig[prop]);\n                extend(res[prop], childConfig[prop]);\n            } else if (childConfig[prop] != null) {\n                res[prop] = childConfig[prop];\n            } else {\n                delete res[prop];\n            }\n        }\n    }\n    for (prop in parentConfig) {\n        if (hasOwnProp(parentConfig, prop) &&\n                !hasOwnProp(childConfig, prop) &&\n                isObject(parentConfig[prop])) {\n            // make sure changes to properties don't modify parent config\n            res[prop] = extend({}, res[prop]);\n        }\n    }\n    return res;\n}\n\nfunction Locale(config) {\n    if (config != null) {\n        this.set(config);\n    }\n}\n\nvar keys;\n\nif (Object.keys) {\n    keys = Object.keys;\n} else {\n    keys = function (obj) {\n        var i, res = [];\n        for (i in obj) {\n            if (hasOwnProp(obj, i)) {\n                res.push(i);\n            }\n        }\n        return res;\n    };\n}\n\nvar keys$1 = keys;\n\nvar defaultCalendar = {\n    sameDay : '[Today at] LT',\n    nextDay : '[Tomorrow at] LT',\n    nextWeek : 'dddd [at] LT',\n    lastDay : '[Yesterday at] LT',\n    lastWeek : '[Last] dddd [at] LT',\n    sameElse : 'L'\n};\n\nfunction calendar (key, mom, now) {\n    var output = this._calendar[key] || this._calendar['sameElse'];\n    return isFunction(output) ? output.call(mom, now) : output;\n}\n\nvar defaultLongDateFormat = {\n    LTS  : 'h:mm:ss A',\n    LT   : 'h:mm A',\n    L    : 'MM/DD/YYYY',\n    LL   : 'MMMM D, YYYY',\n    LLL  : 'MMMM D, YYYY h:mm A',\n    LLLL : 'dddd, MMMM D, YYYY h:mm A'\n};\n\nfunction longDateFormat (key) {\n    var format = this._longDateFormat[key],\n        formatUpper = this._longDateFormat[key.toUpperCase()];\n\n    if (format || !formatUpper) {\n        return format;\n    }\n\n    this._longDateFormat[key] = formatUpper.replace(/MMMM|MM|DD|dddd/g, function (val) {\n        return val.slice(1);\n    });\n\n    return this._longDateFormat[key];\n}\n\nvar defaultInvalidDate = 'Invalid date';\n\nfunction invalidDate () {\n    return this._invalidDate;\n}\n\nvar defaultOrdinal = '%d';\nvar defaultDayOfMonthOrdinalParse = /\\d{1,2}/;\n\nfunction ordinal (number) {\n    return this._ordinal.replace('%d', number);\n}\n\nvar defaultRelativeTime = {\n    future : 'in %s',\n    past   : '%s ago',\n    s  : 'a few seconds',\n    ss : '%d seconds',\n    m  : 'a minute',\n    mm : '%d minutes',\n    h  : 'an hour',\n    hh : '%d hours',\n    d  : 'a day',\n    dd : '%d days',\n    M  : 'a month',\n    MM : '%d months',\n    y  : 'a year',\n    yy : '%d years'\n};\n\nfunction relativeTime (number, withoutSuffix, string, isFuture) {\n    var output = this._relativeTime[string];\n    return (isFunction(output)) ?\n        output(number, withoutSuffix, string, isFuture) :\n        output.replace(/%d/i, number);\n}\n\nfunction pastFuture (diff, output) {\n    var format = this._relativeTime[diff > 0 ? 'future' : 'past'];\n    return isFunction(format) ? format(output) : format.replace(/%s/i, output);\n}\n\nvar aliases = {};\n\nfunction addUnitAlias (unit, shorthand) {\n    var lowerCase = unit.toLowerCase();\n    aliases[lowerCase] = aliases[lowerCase + 's'] = aliases[shorthand] = unit;\n}\n\nfunction normalizeUnits(units) {\n    return typeof units === 'string' ? aliases[units] || aliases[units.toLowerCase()] : undefined;\n}\n\nfunction normalizeObjectUnits(inputObject) {\n    var normalizedInput = {},\n        normalizedProp,\n        prop;\n\n    for (prop in inputObject) {\n        if (hasOwnProp(inputObject, prop)) {\n            normalizedProp = normalizeUnits(prop);\n            if (normalizedProp) {\n                normalizedInput[normalizedProp] = inputObject[prop];\n            }\n        }\n    }\n\n    return normalizedInput;\n}\n\nvar priorities = {};\n\nfunction addUnitPriority(unit, priority) {\n    priorities[unit] = priority;\n}\n\nfunction getPrioritizedUnits(unitsObj) {\n    var units = [];\n    for (var u in unitsObj) {\n        units.push({unit: u, priority: priorities[u]});\n    }\n    units.sort(function (a, b) {\n        return a.priority - b.priority;\n    });\n    return units;\n}\n\nfunction makeGetSet (unit, keepTime) {\n    return function (value) {\n        if (value != null) {\n            set$1(this, unit, value);\n            hooks.updateOffset(this, keepTime);\n            return this;\n        } else {\n            return get(this, unit);\n        }\n    };\n}\n\nfunction get (mom, unit) {\n    return mom.isValid() ?\n        mom._d['get' + (mom._isUTC ? 'UTC' : '') + unit]() : NaN;\n}\n\nfunction set$1 (mom, unit, value) {\n    if (mom.isValid()) {\n        mom._d['set' + (mom._isUTC ? 'UTC' : '') + unit](value);\n    }\n}\n\n// MOMENTS\n\nfunction stringGet (units) {\n    units = normalizeUnits(units);\n    if (isFunction(this[units])) {\n        return this[units]();\n    }\n    return this;\n}\n\n\nfunction stringSet (units, value) {\n    if (typeof units === 'object') {\n        units = normalizeObjectUnits(units);\n        var prioritized = getPrioritizedUnits(units);\n        for (var i = 0; i < prioritized.length; i++) {\n            this[prioritized[i].unit](units[prioritized[i].unit]);\n        }\n    } else {\n        units = normalizeUnits(units);\n        if (isFunction(this[units])) {\n            return this[units](value);\n        }\n    }\n    return this;\n}\n\nfunction zeroFill(number, targetLength, forceSign) {\n    var absNumber = '' + Math.abs(number),\n        zerosToFill = targetLength - absNumber.length,\n        sign = number >= 0;\n    return (sign ? (forceSign ? '+' : '') : '-') +\n        Math.pow(10, Math.max(0, zerosToFill)).toString().substr(1) + absNumber;\n}\n\nvar formattingTokens = /(\\[[^\\[]*\\])|(\\\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;\n\nvar localFormattingTokens = /(\\[[^\\[]*\\])|(\\\\)?(LTS|LT|LL?L?L?|l{1,4})/g;\n\nvar formatFunctions = {};\n\nvar formatTokenFunctions = {};\n\n// token:    'M'\n// padded:   ['MM', 2]\n// ordinal:  'Mo'\n// callback: function () { this.month() + 1 }\nfunction addFormatToken (token, padded, ordinal, callback) {\n    var func = callback;\n    if (typeof callback === 'string') {\n        func = function () {\n            return this[callback]();\n        };\n    }\n    if (token) {\n        formatTokenFunctions[token] = func;\n    }\n    if (padded) {\n        formatTokenFunctions[padded[0]] = function () {\n            return zeroFill(func.apply(this, arguments), padded[1], padded[2]);\n        };\n    }\n    if (ordinal) {\n        formatTokenFunctions[ordinal] = function () {\n            return this.localeData().ordinal(func.apply(this, arguments), token);\n        };\n    }\n}\n\nfunction removeFormattingTokens(input) {\n    if (input.match(/\\[[\\s\\S]/)) {\n        return input.replace(/^\\[|\\]$/g, '');\n    }\n    return input.replace(/\\\\/g, '');\n}\n\nfunction makeFormatFunction(format) {\n    var array = format.match(formattingTokens), i, length;\n\n    for (i = 0, length = array.length; i < length; i++) {\n        if (formatTokenFunctions[array[i]]) {\n            array[i] = formatTokenFunctions[array[i]];\n        } else {\n            array[i] = removeFormattingTokens(array[i]);\n        }\n    }\n\n    return function (mom) {\n        var output = '', i;\n        for (i = 0; i < length; i++) {\n            output += isFunction(array[i]) ? array[i].call(mom, format) : array[i];\n        }\n        return output;\n    };\n}\n\n// format date using native date object\nfunction formatMoment(m, format) {\n    if (!m.isValid()) {\n        return m.localeData().invalidDate();\n    }\n\n    format = expandFormat(format, m.localeData());\n    formatFunctions[format] = formatFunctions[format] || makeFormatFunction(format);\n\n    return formatFunctions[format](m);\n}\n\nfunction expandFormat(format, locale) {\n    var i = 5;\n\n    function replaceLongDateFormatTokens(input) {\n        return locale.longDateFormat(input) || input;\n    }\n\n    localFormattingTokens.lastIndex = 0;\n    while (i >= 0 && localFormattingTokens.test(format)) {\n        format = format.replace(localFormattingTokens, replaceLongDateFormatTokens);\n        localFormattingTokens.lastIndex = 0;\n        i -= 1;\n    }\n\n    return format;\n}\n\nvar match1         = /\\d/;            //       0 - 9\nvar match2         = /\\d\\d/;          //      00 - 99\nvar match3         = /\\d{3}/;         //     000 - 999\nvar match4         = /\\d{4}/;         //    0000 - 9999\nvar match6         = /[+-]?\\d{6}/;    // -999999 - 999999\nvar match1to2      = /\\d\\d?/;         //       0 - 99\nvar match3to4      = /\\d\\d\\d\\d?/;     //     999 - 9999\nvar match5to6      = /\\d\\d\\d\\d\\d\\d?/; //   99999 - 999999\nvar match1to3      = /\\d{1,3}/;       //       0 - 999\nvar match1to4      = /\\d{1,4}/;       //       0 - 9999\nvar match1to6      = /[+-]?\\d{1,6}/;  // -999999 - 999999\n\nvar matchUnsigned  = /\\d+/;           //       0 - inf\nvar matchSigned    = /[+-]?\\d+/;      //    -inf - inf\n\nvar matchOffset    = /Z|[+-]\\d\\d:?\\d\\d/gi; // +00:00 -00:00 +0000 -0000 or Z\nvar matchShortOffset = /Z|[+-]\\d\\d(?::?\\d\\d)?/gi; // +00 -00 +00:00 -00:00 +0000 -0000 or Z\n\nvar matchTimestamp = /[+-]?\\d+(\\.\\d{1,3})?/; // 123456789 123456789.123\n\n// any word (or two) characters or numbers including two/three word month in arabic.\n// includes scottish gaelic two word and hyphenated months\nvar matchWord = /[0-9]*['a-z\\u00A0-\\u05FF\\u0700-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]+|[\\u0600-\\u06FF\\/]+(\\s*?[\\u0600-\\u06FF]+){1,2}/i;\n\n\nvar regexes = {};\n\nfunction addRegexToken (token, regex, strictRegex) {\n    regexes[token] = isFunction(regex) ? regex : function (isStrict, localeData) {\n        return (isStrict && strictRegex) ? strictRegex : regex;\n    };\n}\n\nfunction getParseRegexForToken (token, config) {\n    if (!hasOwnProp(regexes, token)) {\n        return new RegExp(unescapeFormat(token));\n    }\n\n    return regexes[token](config._strict, config._locale);\n}\n\n// Code from http://stackoverflow.com/questions/3561493/is-there-a-regexp-escape-function-in-javascript\nfunction unescapeFormat(s) {\n    return regexEscape(s.replace('\\\\', '').replace(/\\\\(\\[)|\\\\(\\])|\\[([^\\]\\[]*)\\]|\\\\(.)/g, function (matched, p1, p2, p3, p4) {\n        return p1 || p2 || p3 || p4;\n    }));\n}\n\nfunction regexEscape(s) {\n    return s.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n}\n\nvar tokens = {};\n\nfunction addParseToken (token, callback) {\n    var i, func = callback;\n    if (typeof token === 'string') {\n        token = [token];\n    }\n    if (isNumber(callback)) {\n        func = function (input, array) {\n            array[callback] = toInt(input);\n        };\n    }\n    for (i = 0; i < token.length; i++) {\n        tokens[token[i]] = func;\n    }\n}\n\nfunction addWeekParseToken (token, callback) {\n    addParseToken(token, function (input, array, config, token) {\n        config._w = config._w || {};\n        callback(input, config._w, config, token);\n    });\n}\n\nfunction addTimeToArrayFromToken(token, input, config) {\n    if (input != null && hasOwnProp(tokens, token)) {\n        tokens[token](input, config._a, config, token);\n    }\n}\n\nvar YEAR = 0;\nvar MONTH = 1;\nvar DATE = 2;\nvar HOUR = 3;\nvar MINUTE = 4;\nvar SECOND = 5;\nvar MILLISECOND = 6;\nvar WEEK = 7;\nvar WEEKDAY = 8;\n\nvar indexOf;\n\nif (Array.prototype.indexOf) {\n    indexOf = Array.prototype.indexOf;\n} else {\n    indexOf = function (o) {\n        // I know\n        var i;\n        for (i = 0; i < this.length; ++i) {\n            if (this[i] === o) {\n                return i;\n            }\n        }\n        return -1;\n    };\n}\n\nvar indexOf$1 = indexOf;\n\nfunction daysInMonth(year, month) {\n    return new Date(Date.UTC(year, month + 1, 0)).getUTCDate();\n}\n\n// FORMATTING\n\naddFormatToken('M', ['MM', 2], 'Mo', function () {\n    return this.month() + 1;\n});\n\naddFormatToken('MMM', 0, 0, function (format) {\n    return this.localeData().monthsShort(this, format);\n});\n\naddFormatToken('MMMM', 0, 0, function (format) {\n    return this.localeData().months(this, format);\n});\n\n// ALIASES\n\naddUnitAlias('month', 'M');\n\n// PRIORITY\n\naddUnitPriority('month', 8);\n\n// PARSING\n\naddRegexToken('M',    match1to2);\naddRegexToken('MM',   match1to2, match2);\naddRegexToken('MMM',  function (isStrict, locale) {\n    return locale.monthsShortRegex(isStrict);\n});\naddRegexToken('MMMM', function (isStrict, locale) {\n    return locale.monthsRegex(isStrict);\n});\n\naddParseToken(['M', 'MM'], function (input, array) {\n    array[MONTH] = toInt(input) - 1;\n});\n\naddParseToken(['MMM', 'MMMM'], function (input, array, config, token) {\n    var month = config._locale.monthsParse(input, token, config._strict);\n    // if we didn't find a month name, mark the date as invalid.\n    if (month != null) {\n        array[MONTH] = month;\n    } else {\n        getParsingFlags(config).invalidMonth = input;\n    }\n});\n\n// LOCALES\n\nvar MONTHS_IN_FORMAT = /D[oD]?(\\[[^\\[\\]]*\\]|\\s)+MMMM?/;\nvar defaultLocaleMonths = 'January_February_March_April_May_June_July_August_September_October_November_December'.split('_');\nfunction localeMonths (m, format) {\n    if (!m) {\n        return isArray(this._months) ? this._months :\n            this._months['standalone'];\n    }\n    return isArray(this._months) ? this._months[m.month()] :\n        this._months[(this._months.isFormat || MONTHS_IN_FORMAT).test(format) ? 'format' : 'standalone'][m.month()];\n}\n\nvar defaultLocaleMonthsShort = 'Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec'.split('_');\nfunction localeMonthsShort (m, format) {\n    if (!m) {\n        return isArray(this._monthsShort) ? this._monthsShort :\n            this._monthsShort['standalone'];\n    }\n    return isArray(this._monthsShort) ? this._monthsShort[m.month()] :\n        this._monthsShort[MONTHS_IN_FORMAT.test(format) ? 'format' : 'standalone'][m.month()];\n}\n\nfunction handleStrictParse(monthName, format, strict) {\n    var i, ii, mom, llc = monthName.toLocaleLowerCase();\n    if (!this._monthsParse) {\n        // this is not used\n        this._monthsParse = [];\n        this._longMonthsParse = [];\n        this._shortMonthsParse = [];\n        for (i = 0; i < 12; ++i) {\n            mom = createUTC([2000, i]);\n            this._shortMonthsParse[i] = this.monthsShort(mom, '').toLocaleLowerCase();\n            this._longMonthsParse[i] = this.months(mom, '').toLocaleLowerCase();\n        }\n    }\n\n    if (strict) {\n        if (format === 'MMM') {\n            ii = indexOf$1.call(this._shortMonthsParse, llc);\n            return ii !== -1 ? ii : null;\n        } else {\n            ii = indexOf$1.call(this._longMonthsParse, llc);\n            return ii !== -1 ? ii : null;\n        }\n    } else {\n        if (format === 'MMM') {\n            ii = indexOf$1.call(this._shortMonthsParse, llc);\n            if (ii !== -1) {\n                return ii;\n            }\n            ii = indexOf$1.call(this._longMonthsParse, llc);\n            return ii !== -1 ? ii : null;\n        } else {\n            ii = indexOf$1.call(this._longMonthsParse, llc);\n            if (ii !== -1) {\n                return ii;\n            }\n            ii = indexOf$1.call(this._shortMonthsParse, llc);\n            return ii !== -1 ? ii : null;\n        }\n    }\n}\n\nfunction localeMonthsParse (monthName, format, strict) {\n    var i, mom, regex;\n\n    if (this._monthsParseExact) {\n        return handleStrictParse.call(this, monthName, format, strict);\n    }\n\n    if (!this._monthsParse) {\n        this._monthsParse = [];\n        this._longMonthsParse = [];\n        this._shortMonthsParse = [];\n    }\n\n    // TODO: add sorting\n    // Sorting makes sure if one month (or abbr) is a prefix of another\n    // see sorting in computeMonthsParse\n    for (i = 0; i < 12; i++) {\n        // make the regex if we don't have it already\n        mom = createUTC([2000, i]);\n        if (strict && !this._longMonthsParse[i]) {\n            this._longMonthsParse[i] = new RegExp('^' + this.months(mom, '').replace('.', '') + '$', 'i');\n            this._shortMonthsParse[i] = new RegExp('^' + this.monthsShort(mom, '').replace('.', '') + '$', 'i');\n        }\n        if (!strict && !this._monthsParse[i]) {\n            regex = '^' + this.months(mom, '') + '|^' + this.monthsShort(mom, '');\n            this._monthsParse[i] = new RegExp(regex.replace('.', ''), 'i');\n        }\n        // test the regex\n        if (strict && format === 'MMMM' && this._longMonthsParse[i].test(monthName)) {\n            return i;\n        } else if (strict && format === 'MMM' && this._shortMonthsParse[i].test(monthName)) {\n            return i;\n        } else if (!strict && this._monthsParse[i].test(monthName)) {\n            return i;\n        }\n    }\n}\n\n// MOMENTS\n\nfunction setMonth (mom, value) {\n    var dayOfMonth;\n\n    if (!mom.isValid()) {\n        // No op\n        return mom;\n    }\n\n    if (typeof value === 'string') {\n        if (/^\\d+$/.test(value)) {\n            value = toInt(value);\n        } else {\n            value = mom.localeData().monthsParse(value);\n            // TODO: Another silent failure?\n            if (!isNumber(value)) {\n                return mom;\n            }\n        }\n    }\n\n    dayOfMonth = Math.min(mom.date(), daysInMonth(mom.year(), value));\n    mom._d['set' + (mom._isUTC ? 'UTC' : '') + 'Month'](value, dayOfMonth);\n    return mom;\n}\n\nfunction getSetMonth (value) {\n    if (value != null) {\n        setMonth(this, value);\n        hooks.updateOffset(this, true);\n        return this;\n    } else {\n        return get(this, 'Month');\n    }\n}\n\nfunction getDaysInMonth () {\n    return daysInMonth(this.year(), this.month());\n}\n\nvar defaultMonthsShortRegex = matchWord;\nfunction monthsShortRegex (isStrict) {\n    if (this._monthsParseExact) {\n        if (!hasOwnProp(this, '_monthsRegex')) {\n            computeMonthsParse.call(this);\n        }\n        if (isStrict) {\n            return this._monthsShortStrictRegex;\n        } else {\n            return this._monthsShortRegex;\n        }\n    } else {\n        if (!hasOwnProp(this, '_monthsShortRegex')) {\n            this._monthsShortRegex = defaultMonthsShortRegex;\n        }\n        return this._monthsShortStrictRegex && isStrict ?\n            this._monthsShortStrictRegex : this._monthsShortRegex;\n    }\n}\n\nvar defaultMonthsRegex = matchWord;\nfunction monthsRegex (isStrict) {\n    if (this._monthsParseExact) {\n        if (!hasOwnProp(this, '_monthsRegex')) {\n            computeMonthsParse.call(this);\n        }\n        if (isStrict) {\n            return this._monthsStrictRegex;\n        } else {\n            return this._monthsRegex;\n        }\n    } else {\n        if (!hasOwnProp(this, '_monthsRegex')) {\n            this._monthsRegex = defaultMonthsRegex;\n        }\n        return this._monthsStrictRegex && isStrict ?\n            this._monthsStrictRegex : this._monthsRegex;\n    }\n}\n\nfunction computeMonthsParse () {\n    function cmpLenRev(a, b) {\n        return b.length - a.length;\n    }\n\n    var shortPieces = [], longPieces = [], mixedPieces = [],\n        i, mom;\n    for (i = 0; i < 12; i++) {\n        // make the regex if we don't have it already\n        mom = createUTC([2000, i]);\n        shortPieces.push(this.monthsShort(mom, ''));\n        longPieces.push(this.months(mom, ''));\n        mixedPieces.push(this.months(mom, ''));\n        mixedPieces.push(this.monthsShort(mom, ''));\n    }\n    // Sorting makes sure if one month (or abbr) is a prefix of another it\n    // will match the longer piece.\n    shortPieces.sort(cmpLenRev);\n    longPieces.sort(cmpLenRev);\n    mixedPieces.sort(cmpLenRev);\n    for (i = 0; i < 12; i++) {\n        shortPieces[i] = regexEscape(shortPieces[i]);\n        longPieces[i] = regexEscape(longPieces[i]);\n    }\n    for (i = 0; i < 24; i++) {\n        mixedPieces[i] = regexEscape(mixedPieces[i]);\n    }\n\n    this._monthsRegex = new RegExp('^(' + mixedPieces.join('|') + ')', 'i');\n    this._monthsShortRegex = this._monthsRegex;\n    this._monthsStrictRegex = new RegExp('^(' + longPieces.join('|') + ')', 'i');\n    this._monthsShortStrictRegex = new RegExp('^(' + shortPieces.join('|') + ')', 'i');\n}\n\n// FORMATTING\n\naddFormatToken('Y', 0, 0, function () {\n    var y = this.year();\n    return y <= 9999 ? '' + y : '+' + y;\n});\n\naddFormatToken(0, ['YY', 2], 0, function () {\n    return this.year() % 100;\n});\n\naddFormatToken(0, ['YYYY',   4],       0, 'year');\naddFormatToken(0, ['YYYYY',  5],       0, 'year');\naddFormatToken(0, ['YYYYYY', 6, true], 0, 'year');\n\n// ALIASES\n\naddUnitAlias('year', 'y');\n\n// PRIORITIES\n\naddUnitPriority('year', 1);\n\n// PARSING\n\naddRegexToken('Y',      matchSigned);\naddRegexToken('YY',     match1to2, match2);\naddRegexToken('YYYY',   match1to4, match4);\naddRegexToken('YYYYY',  match1to6, match6);\naddRegexToken('YYYYYY', match1to6, match6);\n\naddParseToken(['YYYYY', 'YYYYYY'], YEAR);\naddParseToken('YYYY', function (input, array) {\n    array[YEAR] = input.length === 2 ? hooks.parseTwoDigitYear(input) : toInt(input);\n});\naddParseToken('YY', function (input, array) {\n    array[YEAR] = hooks.parseTwoDigitYear(input);\n});\naddParseToken('Y', function (input, array) {\n    array[YEAR] = parseInt(input, 10);\n});\n\n// HELPERS\n\nfunction daysInYear(year) {\n    return isLeapYear(year) ? 366 : 365;\n}\n\nfunction isLeapYear(year) {\n    return (year % 4 === 0 && year % 100 !== 0) || year % 400 === 0;\n}\n\n// HOOKS\n\nhooks.parseTwoDigitYear = function (input) {\n    return toInt(input) + (toInt(input) > 68 ? 1900 : 2000);\n};\n\n// MOMENTS\n\nvar getSetYear = makeGetSet('FullYear', true);\n\nfunction getIsLeapYear () {\n    return isLeapYear(this.year());\n}\n\nfunction createDate (y, m, d, h, M, s, ms) {\n    // can't just apply() to create a date:\n    // https://stackoverflow.com/q/181348\n    var date = new Date(y, m, d, h, M, s, ms);\n\n    // the date constructor remaps years 0-99 to 1900-1999\n    if (y < 100 && y >= 0 && isFinite(date.getFullYear())) {\n        date.setFullYear(y);\n    }\n    return date;\n}\n\nfunction createUTCDate (y) {\n    var date = new Date(Date.UTC.apply(null, arguments));\n\n    // the Date.UTC function remaps years 0-99 to 1900-1999\n    if (y < 100 && y >= 0 && isFinite(date.getUTCFullYear())) {\n        date.setUTCFullYear(y);\n    }\n    return date;\n}\n\n// start-of-first-week - start-of-year\nfunction firstWeekOffset(year, dow, doy) {\n    var // first-week day -- which january is always in the first week (4 for iso, 1 for other)\n        fwd = 7 + dow - doy,\n        // first-week day local weekday -- which local weekday is fwd\n        fwdlw = (7 + createUTCDate(year, 0, fwd).getUTCDay() - dow) % 7;\n\n    return -fwdlw + fwd - 1;\n}\n\n// https://en.wikipedia.org/wiki/ISO_week_date#Calculating_a_date_given_the_year.2C_week_number_and_weekday\nfunction dayOfYearFromWeeks(year, week, weekday, dow, doy) {\n    var localWeekday = (7 + weekday - dow) % 7,\n        weekOffset = firstWeekOffset(year, dow, doy),\n        dayOfYear = 1 + 7 * (week - 1) + localWeekday + weekOffset,\n        resYear, resDayOfYear;\n\n    if (dayOfYear <= 0) {\n        resYear = year - 1;\n        resDayOfYear = daysInYear(resYear) + dayOfYear;\n    } else if (dayOfYear > daysInYear(year)) {\n        resYear = year + 1;\n        resDayOfYear = dayOfYear - daysInYear(year);\n    } else {\n        resYear = year;\n        resDayOfYear = dayOfYear;\n    }\n\n    return {\n        year: resYear,\n        dayOfYear: resDayOfYear\n    };\n}\n\nfunction weekOfYear(mom, dow, doy) {\n    var weekOffset = firstWeekOffset(mom.year(), dow, doy),\n        week = Math.floor((mom.dayOfYear() - weekOffset - 1) / 7) + 1,\n        resWeek, resYear;\n\n    if (week < 1) {\n        resYear = mom.year() - 1;\n        resWeek = week + weeksInYear(resYear, dow, doy);\n    } else if (week > weeksInYear(mom.year(), dow, doy)) {\n        resWeek = week - weeksInYear(mom.year(), dow, doy);\n        resYear = mom.year() + 1;\n    } else {\n        resYear = mom.year();\n        resWeek = week;\n    }\n\n    return {\n        week: resWeek,\n        year: resYear\n    };\n}\n\nfunction weeksInYear(year, dow, doy) {\n    var weekOffset = firstWeekOffset(year, dow, doy),\n        weekOffsetNext = firstWeekOffset(year + 1, dow, doy);\n    return (daysInYear(year) - weekOffset + weekOffsetNext) / 7;\n}\n\n// FORMATTING\n\naddFormatToken('w', ['ww', 2], 'wo', 'week');\naddFormatToken('W', ['WW', 2], 'Wo', 'isoWeek');\n\n// ALIASES\n\naddUnitAlias('week', 'w');\naddUnitAlias('isoWeek', 'W');\n\n// PRIORITIES\n\naddUnitPriority('week', 5);\naddUnitPriority('isoWeek', 5);\n\n// PARSING\n\naddRegexToken('w',  match1to2);\naddRegexToken('ww', match1to2, match2);\naddRegexToken('W',  match1to2);\naddRegexToken('WW', match1to2, match2);\n\naddWeekParseToken(['w', 'ww', 'W', 'WW'], function (input, week, config, token) {\n    week[token.substr(0, 1)] = toInt(input);\n});\n\n// HELPERS\n\n// LOCALES\n\nfunction localeWeek (mom) {\n    return weekOfYear(mom, this._week.dow, this._week.doy).week;\n}\n\nvar defaultLocaleWeek = {\n    dow : 0, // Sunday is the first day of the week.\n    doy : 6  // The week that contains Jan 1st is the first week of the year.\n};\n\nfunction localeFirstDayOfWeek () {\n    return this._week.dow;\n}\n\nfunction localeFirstDayOfYear () {\n    return this._week.doy;\n}\n\n// MOMENTS\n\nfunction getSetWeek (input) {\n    var week = this.localeData().week(this);\n    return input == null ? week : this.add((input - week) * 7, 'd');\n}\n\nfunction getSetISOWeek (input) {\n    var week = weekOfYear(this, 1, 4).week;\n    return input == null ? week : this.add((input - week) * 7, 'd');\n}\n\n// FORMATTING\n\naddFormatToken('d', 0, 'do', 'day');\n\naddFormatToken('dd', 0, 0, function (format) {\n    return this.localeData().weekdaysMin(this, format);\n});\n\naddFormatToken('ddd', 0, 0, function (format) {\n    return this.localeData().weekdaysShort(this, format);\n});\n\naddFormatToken('dddd', 0, 0, function (format) {\n    return this.localeData().weekdays(this, format);\n});\n\naddFormatToken('e', 0, 0, 'weekday');\naddFormatToken('E', 0, 0, 'isoWeekday');\n\n// ALIASES\n\naddUnitAlias('day', 'd');\naddUnitAlias('weekday', 'e');\naddUnitAlias('isoWeekday', 'E');\n\n// PRIORITY\naddUnitPriority('day', 11);\naddUnitPriority('weekday', 11);\naddUnitPriority('isoWeekday', 11);\n\n// PARSING\n\naddRegexToken('d',    match1to2);\naddRegexToken('e',    match1to2);\naddRegexToken('E',    match1to2);\naddRegexToken('dd',   function (isStrict, locale) {\n    return locale.weekdaysMinRegex(isStrict);\n});\naddRegexToken('ddd',   function (isStrict, locale) {\n    return locale.weekdaysShortRegex(isStrict);\n});\naddRegexToken('dddd',   function (isStrict, locale) {\n    return locale.weekdaysRegex(isStrict);\n});\n\naddWeekParseToken(['dd', 'ddd', 'dddd'], function (input, week, config, token) {\n    var weekday = config._locale.weekdaysParse(input, token, config._strict);\n    // if we didn't get a weekday name, mark the date as invalid\n    if (weekday != null) {\n        week.d = weekday;\n    } else {\n        getParsingFlags(config).invalidWeekday = input;\n    }\n});\n\naddWeekParseToken(['d', 'e', 'E'], function (input, week, config, token) {\n    week[token] = toInt(input);\n});\n\n// HELPERS\n\nfunction parseWeekday(input, locale) {\n    if (typeof input !== 'string') {\n        return input;\n    }\n\n    if (!isNaN(input)) {\n        return parseInt(input, 10);\n    }\n\n    input = locale.weekdaysParse(input);\n    if (typeof input === 'number') {\n        return input;\n    }\n\n    return null;\n}\n\nfunction parseIsoWeekday(input, locale) {\n    if (typeof input === 'string') {\n        return locale.weekdaysParse(input) % 7 || 7;\n    }\n    return isNaN(input) ? null : input;\n}\n\n// LOCALES\n\nvar defaultLocaleWeekdays = 'Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday'.split('_');\nfunction localeWeekdays (m, format) {\n    if (!m) {\n        return isArray(this._weekdays) ? this._weekdays :\n            this._weekdays['standalone'];\n    }\n    return isArray(this._weekdays) ? this._weekdays[m.day()] :\n        this._weekdays[this._weekdays.isFormat.test(format) ? 'format' : 'standalone'][m.day()];\n}\n\nvar defaultLocaleWeekdaysShort = 'Sun_Mon_Tue_Wed_Thu_Fri_Sat'.split('_');\nfunction localeWeekdaysShort (m) {\n    return (m) ? this._weekdaysShort[m.day()] : this._weekdaysShort;\n}\n\nvar defaultLocaleWeekdaysMin = 'Su_Mo_Tu_We_Th_Fr_Sa'.split('_');\nfunction localeWeekdaysMin (m) {\n    return (m) ? this._weekdaysMin[m.day()] : this._weekdaysMin;\n}\n\nfunction handleStrictParse$1(weekdayName, format, strict) {\n    var i, ii, mom, llc = weekdayName.toLocaleLowerCase();\n    if (!this._weekdaysParse) {\n        this._weekdaysParse = [];\n        this._shortWeekdaysParse = [];\n        this._minWeekdaysParse = [];\n\n        for (i = 0; i < 7; ++i) {\n            mom = createUTC([2000, 1]).day(i);\n            this._minWeekdaysParse[i] = this.weekdaysMin(mom, '').toLocaleLowerCase();\n            this._shortWeekdaysParse[i] = this.weekdaysShort(mom, '').toLocaleLowerCase();\n            this._weekdaysParse[i] = this.weekdays(mom, '').toLocaleLowerCase();\n        }\n    }\n\n    if (strict) {\n        if (format === 'dddd') {\n            ii = indexOf$1.call(this._weekdaysParse, llc);\n            return ii !== -1 ? ii : null;\n        } else if (format === 'ddd') {\n            ii = indexOf$1.call(this._shortWeekdaysParse, llc);\n            return ii !== -1 ? ii : null;\n        } else {\n            ii = indexOf$1.call(this._minWeekdaysParse, llc);\n            return ii !== -1 ? ii : null;\n        }\n    } else {\n        if (format === 'dddd') {\n            ii = indexOf$1.call(this._weekdaysParse, llc);\n            if (ii !== -1) {\n                return ii;\n            }\n            ii = indexOf$1.call(this._shortWeekdaysParse, llc);\n            if (ii !== -1) {\n                return ii;\n            }\n            ii = indexOf$1.call(this._minWeekdaysParse, llc);\n            return ii !== -1 ? ii : null;\n        } else if (format === 'ddd') {\n            ii = indexOf$1.call(this._shortWeekdaysParse, llc);\n            if (ii !== -1) {\n                return ii;\n            }\n            ii = indexOf$1.call(this._weekdaysParse, llc);\n            if (ii !== -1) {\n                return ii;\n            }\n            ii = indexOf$1.call(this._minWeekdaysParse, llc);\n            return ii !== -1 ? ii : null;\n        } else {\n            ii = indexOf$1.call(this._minWeekdaysParse, llc);\n            if (ii !== -1) {\n                return ii;\n            }\n            ii = indexOf$1.call(this._weekdaysParse, llc);\n            if (ii !== -1) {\n                return ii;\n            }\n            ii = indexOf$1.call(this._shortWeekdaysParse, llc);\n            return ii !== -1 ? ii : null;\n        }\n    }\n}\n\nfunction localeWeekdaysParse (weekdayName, format, strict) {\n    var i, mom, regex;\n\n    if (this._weekdaysParseExact) {\n        return handleStrictParse$1.call(this, weekdayName, format, strict);\n    }\n\n    if (!this._weekdaysParse) {\n        this._weekdaysParse = [];\n        this._minWeekdaysParse = [];\n        this._shortWeekdaysParse = [];\n        this._fullWeekdaysParse = [];\n    }\n\n    for (i = 0; i < 7; i++) {\n        // make the regex if we don't have it already\n\n        mom = createUTC([2000, 1]).day(i);\n        if (strict && !this._fullWeekdaysParse[i]) {\n            this._fullWeekdaysParse[i] = new RegExp('^' + this.weekdays(mom, '').replace('.', '\\.?') + '$', 'i');\n            this._shortWeekdaysParse[i] = new RegExp('^' + this.weekdaysShort(mom, '').replace('.', '\\.?') + '$', 'i');\n            this._minWeekdaysParse[i] = new RegExp('^' + this.weekdaysMin(mom, '').replace('.', '\\.?') + '$', 'i');\n        }\n        if (!this._weekdaysParse[i]) {\n            regex = '^' + this.weekdays(mom, '') + '|^' + this.weekdaysShort(mom, '') + '|^' + this.weekdaysMin(mom, '');\n            this._weekdaysParse[i] = new RegExp(regex.replace('.', ''), 'i');\n        }\n        // test the regex\n        if (strict && format === 'dddd' && this._fullWeekdaysParse[i].test(weekdayName)) {\n            return i;\n        } else if (strict && format === 'ddd' && this._shortWeekdaysParse[i].test(weekdayName)) {\n            return i;\n        } else if (strict && format === 'dd' && this._minWeekdaysParse[i].test(weekdayName)) {\n            return i;\n        } else if (!strict && this._weekdaysParse[i].test(weekdayName)) {\n            return i;\n        }\n    }\n}\n\n// MOMENTS\n\nfunction getSetDayOfWeek (input) {\n    if (!this.isValid()) {\n        return input != null ? this : NaN;\n    }\n    var day = this._isUTC ? this._d.getUTCDay() : this._d.getDay();\n    if (input != null) {\n        input = parseWeekday(input, this.localeData());\n        return this.add(input - day, 'd');\n    } else {\n        return day;\n    }\n}\n\nfunction getSetLocaleDayOfWeek (input) {\n    if (!this.isValid()) {\n        return input != null ? this : NaN;\n    }\n    var weekday = (this.day() + 7 - this.localeData()._week.dow) % 7;\n    return input == null ? weekday : this.add(input - weekday, 'd');\n}\n\nfunction getSetISODayOfWeek (input) {\n    if (!this.isValid()) {\n        return input != null ? this : NaN;\n    }\n\n    // behaves the same as moment#day except\n    // as a getter, returns 7 instead of 0 (1-7 range instead of 0-6)\n    // as a setter, sunday should belong to the previous week.\n\n    if (input != null) {\n        var weekday = parseIsoWeekday(input, this.localeData());\n        return this.day(this.day() % 7 ? weekday : weekday - 7);\n    } else {\n        return this.day() || 7;\n    }\n}\n\nvar defaultWeekdaysRegex = matchWord;\nfunction weekdaysRegex (isStrict) {\n    if (this._weekdaysParseExact) {\n        if (!hasOwnProp(this, '_weekdaysRegex')) {\n            computeWeekdaysParse.call(this);\n        }\n        if (isStrict) {\n            return this._weekdaysStrictRegex;\n        } else {\n            return this._weekdaysRegex;\n        }\n    } else {\n        if (!hasOwnProp(this, '_weekdaysRegex')) {\n            this._weekdaysRegex = defaultWeekdaysRegex;\n        }\n        return this._weekdaysStrictRegex && isStrict ?\n            this._weekdaysStrictRegex : this._weekdaysRegex;\n    }\n}\n\nvar defaultWeekdaysShortRegex = matchWord;\nfunction weekdaysShortRegex (isStrict) {\n    if (this._weekdaysParseExact) {\n        if (!hasOwnProp(this, '_weekdaysRegex')) {\n            computeWeekdaysParse.call(this);\n        }\n        if (isStrict) {\n            return this._weekdaysShortStrictRegex;\n        } else {\n            return this._weekdaysShortRegex;\n        }\n    } else {\n        if (!hasOwnProp(this, '_weekdaysShortRegex')) {\n            this._weekdaysShortRegex = defaultWeekdaysShortRegex;\n        }\n        return this._weekdaysShortStrictRegex && isStrict ?\n            this._weekdaysShortStrictRegex : this._weekdaysShortRegex;\n    }\n}\n\nvar defaultWeekdaysMinRegex = matchWord;\nfunction weekdaysMinRegex (isStrict) {\n    if (this._weekdaysParseExact) {\n        if (!hasOwnProp(this, '_weekdaysRegex')) {\n            computeWeekdaysParse.call(this);\n        }\n        if (isStrict) {\n            return this._weekdaysMinStrictRegex;\n        } else {\n            return this._weekdaysMinRegex;\n        }\n    } else {\n        if (!hasOwnProp(this, '_weekdaysMinRegex')) {\n            this._weekdaysMinRegex = defaultWeekdaysMinRegex;\n        }\n        return this._weekdaysMinStrictRegex && isStrict ?\n            this._weekdaysMinStrictRegex : this._weekdaysMinRegex;\n    }\n}\n\n\nfunction computeWeekdaysParse () {\n    function cmpLenRev(a, b) {\n        return b.length - a.length;\n    }\n\n    var minPieces = [], shortPieces = [], longPieces = [], mixedPieces = [],\n        i, mom, minp, shortp, longp;\n    for (i = 0; i < 7; i++) {\n        // make the regex if we don't have it already\n        mom = createUTC([2000, 1]).day(i);\n        minp = this.weekdaysMin(mom, '');\n        shortp = this.weekdaysShort(mom, '');\n        longp = this.weekdays(mom, '');\n        minPieces.push(minp);\n        shortPieces.push(shortp);\n        longPieces.push(longp);\n        mixedPieces.push(minp);\n        mixedPieces.push(shortp);\n        mixedPieces.push(longp);\n    }\n    // Sorting makes sure if one weekday (or abbr) is a prefix of another it\n    // will match the longer piece.\n    minPieces.sort(cmpLenRev);\n    shortPieces.sort(cmpLenRev);\n    longPieces.sort(cmpLenRev);\n    mixedPieces.sort(cmpLenRev);\n    for (i = 0; i < 7; i++) {\n        shortPieces[i] = regexEscape(shortPieces[i]);\n        longPieces[i] = regexEscape(longPieces[i]);\n        mixedPieces[i] = regexEscape(mixedPieces[i]);\n    }\n\n    this._weekdaysRegex = new RegExp('^(' + mixedPieces.join('|') + ')', 'i');\n    this._weekdaysShortRegex = this._weekdaysRegex;\n    this._weekdaysMinRegex = this._weekdaysRegex;\n\n    this._weekdaysStrictRegex = new RegExp('^(' + longPieces.join('|') + ')', 'i');\n    this._weekdaysShortStrictRegex = new RegExp('^(' + shortPieces.join('|') + ')', 'i');\n    this._weekdaysMinStrictRegex = new RegExp('^(' + minPieces.join('|') + ')', 'i');\n}\n\n// FORMATTING\n\nfunction hFormat() {\n    return this.hours() % 12 || 12;\n}\n\nfunction kFormat() {\n    return this.hours() || 24;\n}\n\naddFormatToken('H', ['HH', 2], 0, 'hour');\naddFormatToken('h', ['hh', 2], 0, hFormat);\naddFormatToken('k', ['kk', 2], 0, kFormat);\n\naddFormatToken('hmm', 0, 0, function () {\n    return '' + hFormat.apply(this) + zeroFill(this.minutes(), 2);\n});\n\naddFormatToken('hmmss', 0, 0, function () {\n    return '' + hFormat.apply(this) + zeroFill(this.minutes(), 2) +\n        zeroFill(this.seconds(), 2);\n});\n\naddFormatToken('Hmm', 0, 0, function () {\n    return '' + this.hours() + zeroFill(this.minutes(), 2);\n});\n\naddFormatToken('Hmmss', 0, 0, function () {\n    return '' + this.hours() + zeroFill(this.minutes(), 2) +\n        zeroFill(this.seconds(), 2);\n});\n\nfunction meridiem (token, lowercase) {\n    addFormatToken(token, 0, 0, function () {\n        return this.localeData().meridiem(this.hours(), this.minutes(), lowercase);\n    });\n}\n\nmeridiem('a', true);\nmeridiem('A', false);\n\n// ALIASES\n\naddUnitAlias('hour', 'h');\n\n// PRIORITY\naddUnitPriority('hour', 13);\n\n// PARSING\n\nfunction matchMeridiem (isStrict, locale) {\n    return locale._meridiemParse;\n}\n\naddRegexToken('a',  matchMeridiem);\naddRegexToken('A',  matchMeridiem);\naddRegexToken('H',  match1to2);\naddRegexToken('h',  match1to2);\naddRegexToken('k',  match1to2);\naddRegexToken('HH', match1to2, match2);\naddRegexToken('hh', match1to2, match2);\naddRegexToken('kk', match1to2, match2);\n\naddRegexToken('hmm', match3to4);\naddRegexToken('hmmss', match5to6);\naddRegexToken('Hmm', match3to4);\naddRegexToken('Hmmss', match5to6);\n\naddParseToken(['H', 'HH'], HOUR);\naddParseToken(['k', 'kk'], function (input, array, config) {\n    var kInput = toInt(input);\n    array[HOUR] = kInput === 24 ? 0 : kInput;\n});\naddParseToken(['a', 'A'], function (input, array, config) {\n    config._isPm = config._locale.isPM(input);\n    config._meridiem = input;\n});\naddParseToken(['h', 'hh'], function (input, array, config) {\n    array[HOUR] = toInt(input);\n    getParsingFlags(config).bigHour = true;\n});\naddParseToken('hmm', function (input, array, config) {\n    var pos = input.length - 2;\n    array[HOUR] = toInt(input.substr(0, pos));\n    array[MINUTE] = toInt(input.substr(pos));\n    getParsingFlags(config).bigHour = true;\n});\naddParseToken('hmmss', function (input, array, config) {\n    var pos1 = input.length - 4;\n    var pos2 = input.length - 2;\n    array[HOUR] = toInt(input.substr(0, pos1));\n    array[MINUTE] = toInt(input.substr(pos1, 2));\n    array[SECOND] = toInt(input.substr(pos2));\n    getParsingFlags(config).bigHour = true;\n});\naddParseToken('Hmm', function (input, array, config) {\n    var pos = input.length - 2;\n    array[HOUR] = toInt(input.substr(0, pos));\n    array[MINUTE] = toInt(input.substr(pos));\n});\naddParseToken('Hmmss', function (input, array, config) {\n    var pos1 = input.length - 4;\n    var pos2 = input.length - 2;\n    array[HOUR] = toInt(input.substr(0, pos1));\n    array[MINUTE] = toInt(input.substr(pos1, 2));\n    array[SECOND] = toInt(input.substr(pos2));\n});\n\n// LOCALES\n\nfunction localeIsPM (input) {\n    // IE8 Quirks Mode & IE7 Standards Mode do not allow accessing strings like arrays\n    // Using charAt should be more compatible.\n    return ((input + '').toLowerCase().charAt(0) === 'p');\n}\n\nvar defaultLocaleMeridiemParse = /[ap]\\.?m?\\.?/i;\nfunction localeMeridiem (hours, minutes, isLower) {\n    if (hours > 11) {\n        return isLower ? 'pm' : 'PM';\n    } else {\n        return isLower ? 'am' : 'AM';\n    }\n}\n\n\n// MOMENTS\n\n// Setting the hour should keep the time, because the user explicitly\n// specified which hour he wants. So trying to maintain the same hour (in\n// a new timezone) makes sense. Adding/subtracting hours does not follow\n// this rule.\nvar getSetHour = makeGetSet('Hours', true);\n\n// months\n// week\n// weekdays\n// meridiem\nvar baseConfig = {\n    calendar: defaultCalendar,\n    longDateFormat: defaultLongDateFormat,\n    invalidDate: defaultInvalidDate,\n    ordinal: defaultOrdinal,\n    dayOfMonthOrdinalParse: defaultDayOfMonthOrdinalParse,\n    relativeTime: defaultRelativeTime,\n\n    months: defaultLocaleMonths,\n    monthsShort: defaultLocaleMonthsShort,\n\n    week: defaultLocaleWeek,\n\n    weekdays: defaultLocaleWeekdays,\n    weekdaysMin: defaultLocaleWeekdaysMin,\n    weekdaysShort: defaultLocaleWeekdaysShort,\n\n    meridiemParse: defaultLocaleMeridiemParse\n};\n\n// internal storage for locale config files\nvar locales = {};\nvar localeFamilies = {};\nvar globalLocale;\n\nfunction normalizeLocale(key) {\n    return key ? key.toLowerCase().replace('_', '-') : key;\n}\n\n// pick the locale from the array\n// try ['en-au', 'en-gb'] as 'en-au', 'en-gb', 'en', as in move through the list trying each\n// substring from most specific to least, but move to the next array item if it's a more specific variant than the current root\nfunction chooseLocale(names) {\n    var i = 0, j, next, locale, split;\n\n    while (i < names.length) {\n        split = normalizeLocale(names[i]).split('-');\n        j = split.length;\n        next = normalizeLocale(names[i + 1]);\n        next = next ? next.split('-') : null;\n        while (j > 0) {\n            locale = loadLocale(split.slice(0, j).join('-'));\n            if (locale) {\n                return locale;\n            }\n            if (next && next.length >= j && compareArrays(split, next, true) >= j - 1) {\n                //the next array item is better than a shallower substring of this one\n                break;\n            }\n            j--;\n        }\n        i++;\n    }\n    return null;\n}\n\nfunction loadLocale(name) {\n    var oldLocale = null;\n    // TODO: Find a better way to register and load all the locales in Node\n    if (!locales[name] && (typeof module !== 'undefined') &&\n            module && module.exports) {\n        try {\n            oldLocale = globalLocale._abbr;\n            require('./locale/' + name);\n            // because defineLocale currently also sets the global locale, we\n            // want to undo that for lazy loaded locales\n            getSetGlobalLocale(oldLocale);\n        } catch (e) { }\n    }\n    return locales[name];\n}\n\n// This function will load locale and then set the global locale.  If\n// no arguments are passed in, it will simply return the current global\n// locale key.\nfunction getSetGlobalLocale (key, values) {\n    var data;\n    if (key) {\n        if (isUndefined(values)) {\n            data = getLocale(key);\n        }\n        else {\n            data = defineLocale(key, values);\n        }\n\n        if (data) {\n            // moment.duration._locale = moment._locale = data;\n            globalLocale = data;\n        }\n    }\n\n    return globalLocale._abbr;\n}\n\nfunction defineLocale (name, config) {\n    if (config !== null) {\n        var parentConfig = baseConfig;\n        config.abbr = name;\n        if (locales[name] != null) {\n            deprecateSimple('defineLocaleOverride',\n                    'use moment.updateLocale(localeName, config) to change ' +\n                    'an existing locale. moment.defineLocale(localeName, ' +\n                    'config) should only be used for creating a new locale ' +\n                    'See http://momentjs.com/guides/#/warnings/define-locale/ for more info.');\n            parentConfig = locales[name]._config;\n        } else if (config.parentLocale != null) {\n            if (locales[config.parentLocale] != null) {\n                parentConfig = locales[config.parentLocale]._config;\n            } else {\n                if (!localeFamilies[config.parentLocale]) {\n                    localeFamilies[config.parentLocale] = [];\n                }\n                localeFamilies[config.parentLocale].push({\n                    name: name,\n                    config: config\n                });\n                return null;\n            }\n        }\n        locales[name] = new Locale(mergeConfigs(parentConfig, config));\n\n        if (localeFamilies[name]) {\n            localeFamilies[name].forEach(function (x) {\n                defineLocale(x.name, x.config);\n            });\n        }\n\n        // backwards compat for now: also set the locale\n        // make sure we set the locale AFTER all child locales have been\n        // created, so we won't end up with the child locale set.\n        getSetGlobalLocale(name);\n\n\n        return locales[name];\n    } else {\n        // useful for testing\n        delete locales[name];\n        return null;\n    }\n}\n\nfunction updateLocale(name, config) {\n    if (config != null) {\n        var locale, parentConfig = baseConfig;\n        // MERGE\n        if (locales[name] != null) {\n            parentConfig = locales[name]._config;\n        }\n        config = mergeConfigs(parentConfig, config);\n        locale = new Locale(config);\n        locale.parentLocale = locales[name];\n        locales[name] = locale;\n\n        // backwards compat for now: also set the locale\n        getSetGlobalLocale(name);\n    } else {\n        // pass null for config to unupdate, useful for tests\n        if (locales[name] != null) {\n            if (locales[name].parentLocale != null) {\n                locales[name] = locales[name].parentLocale;\n            } else if (locales[name] != null) {\n                delete locales[name];\n            }\n        }\n    }\n    return locales[name];\n}\n\n// returns locale data\nfunction getLocale (key) {\n    var locale;\n\n    if (key && key._locale && key._locale._abbr) {\n        key = key._locale._abbr;\n    }\n\n    if (!key) {\n        return globalLocale;\n    }\n\n    if (!isArray(key)) {\n        //short-circuit everything else\n        locale = loadLocale(key);\n        if (locale) {\n            return locale;\n        }\n        key = [key];\n    }\n\n    return chooseLocale(key);\n}\n\nfunction listLocales() {\n    return keys$1(locales);\n}\n\nfunction checkOverflow (m) {\n    var overflow;\n    var a = m._a;\n\n    if (a && getParsingFlags(m).overflow === -2) {\n        overflow =\n            a[MONTH]       < 0 || a[MONTH]       > 11  ? MONTH :\n            a[DATE]        < 1 || a[DATE]        > daysInMonth(a[YEAR], a[MONTH]) ? DATE :\n            a[HOUR]        < 0 || a[HOUR]        > 24 || (a[HOUR] === 24 && (a[MINUTE] !== 0 || a[SECOND] !== 0 || a[MILLISECOND] !== 0)) ? HOUR :\n            a[MINUTE]      < 0 || a[MINUTE]      > 59  ? MINUTE :\n            a[SECOND]      < 0 || a[SECOND]      > 59  ? SECOND :\n            a[MILLISECOND] < 0 || a[MILLISECOND] > 999 ? MILLISECOND :\n            -1;\n\n        if (getParsingFlags(m)._overflowDayOfYear && (overflow < YEAR || overflow > DATE)) {\n            overflow = DATE;\n        }\n        if (getParsingFlags(m)._overflowWeeks && overflow === -1) {\n            overflow = WEEK;\n        }\n        if (getParsingFlags(m)._overflowWeekday && overflow === -1) {\n            overflow = WEEKDAY;\n        }\n\n        getParsingFlags(m).overflow = overflow;\n    }\n\n    return m;\n}\n\n// iso 8601 regex\n// 0000-00-00 0000-W00 or 0000-W00-0 + T + 00 or 00:00 or 00:00:00 or 00:00:00.000 + +00:00 or +0000 or +00)\nvar extendedIsoRegex = /^\\s*((?:[+-]\\d{6}|\\d{4})-(?:\\d\\d-\\d\\d|W\\d\\d-\\d|W\\d\\d|\\d\\d\\d|\\d\\d))(?:(T| )(\\d\\d(?::\\d\\d(?::\\d\\d(?:[.,]\\d+)?)?)?)([\\+\\-]\\d\\d(?::?\\d\\d)?|\\s*Z)?)?$/;\nvar basicIsoRegex = /^\\s*((?:[+-]\\d{6}|\\d{4})(?:\\d\\d\\d\\d|W\\d\\d\\d|W\\d\\d|\\d\\d\\d|\\d\\d))(?:(T| )(\\d\\d(?:\\d\\d(?:\\d\\d(?:[.,]\\d+)?)?)?)([\\+\\-]\\d\\d(?::?\\d\\d)?|\\s*Z)?)?$/;\n\nvar tzRegex = /Z|[+-]\\d\\d(?::?\\d\\d)?/;\n\nvar isoDates = [\n    ['YYYYYY-MM-DD', /[+-]\\d{6}-\\d\\d-\\d\\d/],\n    ['YYYY-MM-DD', /\\d{4}-\\d\\d-\\d\\d/],\n    ['GGGG-[W]WW-E', /\\d{4}-W\\d\\d-\\d/],\n    ['GGGG-[W]WW', /\\d{4}-W\\d\\d/, false],\n    ['YYYY-DDD', /\\d{4}-\\d{3}/],\n    ['YYYY-MM', /\\d{4}-\\d\\d/, false],\n    ['YYYYYYMMDD', /[+-]\\d{10}/],\n    ['YYYYMMDD', /\\d{8}/],\n    // YYYYMM is NOT allowed by the standard\n    ['GGGG[W]WWE', /\\d{4}W\\d{3}/],\n    ['GGGG[W]WW', /\\d{4}W\\d{2}/, false],\n    ['YYYYDDD', /\\d{7}/]\n];\n\n// iso time formats and regexes\nvar isoTimes = [\n    ['HH:mm:ss.SSSS', /\\d\\d:\\d\\d:\\d\\d\\.\\d+/],\n    ['HH:mm:ss,SSSS', /\\d\\d:\\d\\d:\\d\\d,\\d+/],\n    ['HH:mm:ss', /\\d\\d:\\d\\d:\\d\\d/],\n    ['HH:mm', /\\d\\d:\\d\\d/],\n    ['HHmmss.SSSS', /\\d\\d\\d\\d\\d\\d\\.\\d+/],\n    ['HHmmss,SSSS', /\\d\\d\\d\\d\\d\\d,\\d+/],\n    ['HHmmss', /\\d\\d\\d\\d\\d\\d/],\n    ['HHmm', /\\d\\d\\d\\d/],\n    ['HH', /\\d\\d/]\n];\n\nvar aspNetJsonRegex = /^\\/?Date\\((\\-?\\d+)/i;\n\n// date from iso format\nfunction configFromISO(config) {\n    var i, l,\n        string = config._i,\n        match = extendedIsoRegex.exec(string) || basicIsoRegex.exec(string),\n        allowTime, dateFormat, timeFormat, tzFormat;\n\n    if (match) {\n        getParsingFlags(config).iso = true;\n\n        for (i = 0, l = isoDates.length; i < l; i++) {\n            if (isoDates[i][1].exec(match[1])) {\n                dateFormat = isoDates[i][0];\n                allowTime = isoDates[i][2] !== false;\n                break;\n            }\n        }\n        if (dateFormat == null) {\n            config._isValid = false;\n            return;\n        }\n        if (match[3]) {\n            for (i = 0, l = isoTimes.length; i < l; i++) {\n                if (isoTimes[i][1].exec(match[3])) {\n                    // match[2] should be 'T' or space\n                    timeFormat = (match[2] || ' ') + isoTimes[i][0];\n                    break;\n                }\n            }\n            if (timeFormat == null) {\n                config._isValid = false;\n                return;\n            }\n        }\n        if (!allowTime && timeFormat != null) {\n            config._isValid = false;\n            return;\n        }\n        if (match[4]) {\n            if (tzRegex.exec(match[4])) {\n                tzFormat = 'Z';\n            } else {\n                config._isValid = false;\n                return;\n            }\n        }\n        config._f = dateFormat + (timeFormat || '') + (tzFormat || '');\n        configFromStringAndFormat(config);\n    } else {\n        config._isValid = false;\n    }\n}\n\n// RFC 2822 regex: For details see https://tools.ietf.org/html/rfc2822#section-3.3\nvar basicRfcRegex = /^((?:Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\\s)?(\\d?\\d\\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\\s(?:\\d\\d)?\\d\\d\\s)(\\d\\d:\\d\\d)(\\:\\d\\d)?(\\s(?:UT|GMT|[ECMP][SD]T|[A-IK-Za-ik-z]|[+-]\\d{4}))$/;\n\n// date and time from ref 2822 format\nfunction configFromRFC2822(config) {\n    var string, match, dayFormat,\n        dateFormat, timeFormat, tzFormat;\n    var timezones = {\n        ' GMT': ' +0000',\n        ' EDT': ' -0400',\n        ' EST': ' -0500',\n        ' CDT': ' -0500',\n        ' CST': ' -0600',\n        ' MDT': ' -0600',\n        ' MST': ' -0700',\n        ' PDT': ' -0700',\n        ' PST': ' -0800'\n    };\n    var military = 'YXWVUTSRQPONZABCDEFGHIKLM';\n    var timezone, timezoneIndex;\n\n    string = config._i\n        .replace(/\\([^\\)]*\\)|[\\n\\t]/g, ' ') // Remove comments and folding whitespace\n        .replace(/(\\s\\s+)/g, ' ') // Replace multiple-spaces with a single space\n        .replace(/^\\s|\\s$/g, ''); // Remove leading and trailing spaces\n    match = basicRfcRegex.exec(string);\n\n    if (match) {\n        dayFormat = match[1] ? 'ddd' + ((match[1].length === 5) ? ', ' : ' ') : '';\n        dateFormat = 'D MMM ' + ((match[2].length > 10) ? 'YYYY ' : 'YY ');\n        timeFormat = 'HH:mm' + (match[4] ? ':ss' : '');\n\n        // TODO: Replace the vanilla JS Date object with an indepentent day-of-week check.\n        if (match[1]) { // day of week given\n            var momentDate = new Date(match[2]);\n            var momentDay = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'][momentDate.getDay()];\n\n            if (match[1].substr(0,3) !== momentDay) {\n                getParsingFlags(config).weekdayMismatch = true;\n                config._isValid = false;\n                return;\n            }\n        }\n\n        switch (match[5].length) {\n            case 2: // military\n                if (timezoneIndex === 0) {\n                    timezone = ' +0000';\n                } else {\n                    timezoneIndex = military.indexOf(match[5][1].toUpperCase()) - 12;\n                    timezone = ((timezoneIndex < 0) ? ' -' : ' +') +\n                        (('' + timezoneIndex).replace(/^-?/, '0')).match(/..$/)[0] + '00';\n                }\n                break;\n            case 4: // Zone\n                timezone = timezones[match[5]];\n                break;\n            default: // UT or +/-9999\n                timezone = timezones[' GMT'];\n        }\n        match[5] = timezone;\n        config._i = match.splice(1).join('');\n        tzFormat = ' ZZ';\n        config._f = dayFormat + dateFormat + timeFormat + tzFormat;\n        configFromStringAndFormat(config);\n        getParsingFlags(config).rfc2822 = true;\n    } else {\n        config._isValid = false;\n    }\n}\n\n// date from iso format or fallback\nfunction configFromString(config) {\n    var matched = aspNetJsonRegex.exec(config._i);\n\n    if (matched !== null) {\n        config._d = new Date(+matched[1]);\n        return;\n    }\n\n    configFromISO(config);\n    if (config._isValid === false) {\n        delete config._isValid;\n    } else {\n        return;\n    }\n\n    configFromRFC2822(config);\n    if (config._isValid === false) {\n        delete config._isValid;\n    } else {\n        return;\n    }\n\n    // Final attempt, use Input Fallback\n    hooks.createFromInputFallback(config);\n}\n\nhooks.createFromInputFallback = deprecate(\n    'value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), ' +\n    'which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are ' +\n    'discouraged and will be removed in an upcoming major release. Please refer to ' +\n    'http://momentjs.com/guides/#/warnings/js-date/ for more info.',\n    function (config) {\n        config._d = new Date(config._i + (config._useUTC ? ' UTC' : ''));\n    }\n);\n\n// Pick the first defined of two or three arguments.\nfunction defaults(a, b, c) {\n    if (a != null) {\n        return a;\n    }\n    if (b != null) {\n        return b;\n    }\n    return c;\n}\n\nfunction currentDateArray(config) {\n    // hooks is actually the exported moment object\n    var nowValue = new Date(hooks.now());\n    if (config._useUTC) {\n        return [nowValue.getUTCFullYear(), nowValue.getUTCMonth(), nowValue.getUTCDate()];\n    }\n    return [nowValue.getFullYear(), nowValue.getMonth(), nowValue.getDate()];\n}\n\n// convert an array to a date.\n// the array should mirror the parameters below\n// note: all values past the year are optional and will default to the lowest possible value.\n// [year, month, day , hour, minute, second, millisecond]\nfunction configFromArray (config) {\n    var i, date, input = [], currentDate, yearToUse;\n\n    if (config._d) {\n        return;\n    }\n\n    currentDate = currentDateArray(config);\n\n    //compute day of the year from weeks and weekdays\n    if (config._w && config._a[DATE] == null && config._a[MONTH] == null) {\n        dayOfYearFromWeekInfo(config);\n    }\n\n    //if the day of the year is set, figure out what it is\n    if (config._dayOfYear != null) {\n        yearToUse = defaults(config._a[YEAR], currentDate[YEAR]);\n\n        if (config._dayOfYear > daysInYear(yearToUse) || config._dayOfYear === 0) {\n            getParsingFlags(config)._overflowDayOfYear = true;\n        }\n\n        date = createUTCDate(yearToUse, 0, config._dayOfYear);\n        config._a[MONTH] = date.getUTCMonth();\n        config._a[DATE] = date.getUTCDate();\n    }\n\n    // Default to current date.\n    // * if no year, month, day of month are given, default to today\n    // * if day of month is given, default month and year\n    // * if month is given, default only year\n    // * if year is given, don't default anything\n    for (i = 0; i < 3 && config._a[i] == null; ++i) {\n        config._a[i] = input[i] = currentDate[i];\n    }\n\n    // Zero out whatever was not defaulted, including time\n    for (; i < 7; i++) {\n        config._a[i] = input[i] = (config._a[i] == null) ? (i === 2 ? 1 : 0) : config._a[i];\n    }\n\n    // Check for 24:00:00.000\n    if (config._a[HOUR] === 24 &&\n            config._a[MINUTE] === 0 &&\n            config._a[SECOND] === 0 &&\n            config._a[MILLISECOND] === 0) {\n        config._nextDay = true;\n        config._a[HOUR] = 0;\n    }\n\n    config._d = (config._useUTC ? createUTCDate : createDate).apply(null, input);\n    // Apply timezone offset from input. The actual utcOffset can be changed\n    // with parseZone.\n    if (config._tzm != null) {\n        config._d.setUTCMinutes(config._d.getUTCMinutes() - config._tzm);\n    }\n\n    if (config._nextDay) {\n        config._a[HOUR] = 24;\n    }\n}\n\nfunction dayOfYearFromWeekInfo(config) {\n    var w, weekYear, week, weekday, dow, doy, temp, weekdayOverflow;\n\n    w = config._w;\n    if (w.GG != null || w.W != null || w.E != null) {\n        dow = 1;\n        doy = 4;\n\n        // TODO: We need to take the current isoWeekYear, but that depends on\n        // how we interpret now (local, utc, fixed offset). So create\n        // a now version of current config (take local/utc/offset flags, and\n        // create now).\n        weekYear = defaults(w.GG, config._a[YEAR], weekOfYear(createLocal(), 1, 4).year);\n        week = defaults(w.W, 1);\n        weekday = defaults(w.E, 1);\n        if (weekday < 1 || weekday > 7) {\n            weekdayOverflow = true;\n        }\n    } else {\n        dow = config._locale._week.dow;\n        doy = config._locale._week.doy;\n\n        var curWeek = weekOfYear(createLocal(), dow, doy);\n\n        weekYear = defaults(w.gg, config._a[YEAR], curWeek.year);\n\n        // Default to current week.\n        week = defaults(w.w, curWeek.week);\n\n        if (w.d != null) {\n            // weekday -- low day numbers are considered next week\n            weekday = w.d;\n            if (weekday < 0 || weekday > 6) {\n                weekdayOverflow = true;\n            }\n        } else if (w.e != null) {\n            // local weekday -- counting starts from begining of week\n            weekday = w.e + dow;\n            if (w.e < 0 || w.e > 6) {\n                weekdayOverflow = true;\n            }\n        } else {\n            // default to begining of week\n            weekday = dow;\n        }\n    }\n    if (week < 1 || week > weeksInYear(weekYear, dow, doy)) {\n        getParsingFlags(config)._overflowWeeks = true;\n    } else if (weekdayOverflow != null) {\n        getParsingFlags(config)._overflowWeekday = true;\n    } else {\n        temp = dayOfYearFromWeeks(weekYear, week, weekday, dow, doy);\n        config._a[YEAR] = temp.year;\n        config._dayOfYear = temp.dayOfYear;\n    }\n}\n\n// constant that refers to the ISO standard\nhooks.ISO_8601 = function () {};\n\n// constant that refers to the RFC 2822 form\nhooks.RFC_2822 = function () {};\n\n// date from string and format string\nfunction configFromStringAndFormat(config) {\n    // TODO: Move this to another part of the creation flow to prevent circular deps\n    if (config._f === hooks.ISO_8601) {\n        configFromISO(config);\n        return;\n    }\n    if (config._f === hooks.RFC_2822) {\n        configFromRFC2822(config);\n        return;\n    }\n    config._a = [];\n    getParsingFlags(config).empty = true;\n\n    // This array is used to make a Date, either with `new Date` or `Date.UTC`\n    var string = '' + config._i,\n        i, parsedInput, tokens, token, skipped,\n        stringLength = string.length,\n        totalParsedInputLength = 0;\n\n    tokens = expandFormat(config._f, config._locale).match(formattingTokens) || [];\n\n    for (i = 0; i < tokens.length; i++) {\n        token = tokens[i];\n        parsedInput = (string.match(getParseRegexForToken(token, config)) || [])[0];\n        // console.log('token', token, 'parsedInput', parsedInput,\n        //         'regex', getParseRegexForToken(token, config));\n        if (parsedInput) {\n            skipped = string.substr(0, string.indexOf(parsedInput));\n            if (skipped.length > 0) {\n                getParsingFlags(config).unusedInput.push(skipped);\n            }\n            string = string.slice(string.indexOf(parsedInput) + parsedInput.length);\n            totalParsedInputLength += parsedInput.length;\n        }\n        // don't parse if it's not a known token\n        if (formatTokenFunctions[token]) {\n            if (parsedInput) {\n                getParsingFlags(config).empty = false;\n            }\n            else {\n                getParsingFlags(config).unusedTokens.push(token);\n            }\n            addTimeToArrayFromToken(token, parsedInput, config);\n        }\n        else if (config._strict && !parsedInput) {\n            getParsingFlags(config).unusedTokens.push(token);\n        }\n    }\n\n    // add remaining unparsed input length to the string\n    getParsingFlags(config).charsLeftOver = stringLength - totalParsedInputLength;\n    if (string.length > 0) {\n        getParsingFlags(config).unusedInput.push(string);\n    }\n\n    // clear _12h flag if hour is <= 12\n    if (config._a[HOUR] <= 12 &&\n        getParsingFlags(config).bigHour === true &&\n        config._a[HOUR] > 0) {\n        getParsingFlags(config).bigHour = undefined;\n    }\n\n    getParsingFlags(config).parsedDateParts = config._a.slice(0);\n    getParsingFlags(config).meridiem = config._meridiem;\n    // handle meridiem\n    config._a[HOUR] = meridiemFixWrap(config._locale, config._a[HOUR], config._meridiem);\n\n    configFromArray(config);\n    checkOverflow(config);\n}\n\n\nfunction meridiemFixWrap (locale, hour, meridiem) {\n    var isPm;\n\n    if (meridiem == null) {\n        // nothing to do\n        return hour;\n    }\n    if (locale.meridiemHour != null) {\n        return locale.meridiemHour(hour, meridiem);\n    } else if (locale.isPM != null) {\n        // Fallback\n        isPm = locale.isPM(meridiem);\n        if (isPm && hour < 12) {\n            hour += 12;\n        }\n        if (!isPm && hour === 12) {\n            hour = 0;\n        }\n        return hour;\n    } else {\n        // this is not supposed to happen\n        return hour;\n    }\n}\n\n// date from string and array of format strings\nfunction configFromStringAndArray(config) {\n    var tempConfig,\n        bestMoment,\n\n        scoreToBeat,\n        i,\n        currentScore;\n\n    if (config._f.length === 0) {\n        getParsingFlags(config).invalidFormat = true;\n        config._d = new Date(NaN);\n        return;\n    }\n\n    for (i = 0; i < config._f.length; i++) {\n        currentScore = 0;\n        tempConfig = copyConfig({}, config);\n        if (config._useUTC != null) {\n            tempConfig._useUTC = config._useUTC;\n        }\n        tempConfig._f = config._f[i];\n        configFromStringAndFormat(tempConfig);\n\n        if (!isValid(tempConfig)) {\n            continue;\n        }\n\n        // if there is any input that was not parsed add a penalty for that format\n        currentScore += getParsingFlags(tempConfig).charsLeftOver;\n\n        //or tokens\n        currentScore += getParsingFlags(tempConfig).unusedTokens.length * 10;\n\n        getParsingFlags(tempConfig).score = currentScore;\n\n        if (scoreToBeat == null || currentScore < scoreToBeat) {\n            scoreToBeat = currentScore;\n            bestMoment = tempConfig;\n        }\n    }\n\n    extend(config, bestMoment || tempConfig);\n}\n\nfunction configFromObject(config) {\n    if (config._d) {\n        return;\n    }\n\n    var i = normalizeObjectUnits(config._i);\n    config._a = map([i.year, i.month, i.day || i.date, i.hour, i.minute, i.second, i.millisecond], function (obj) {\n        return obj && parseInt(obj, 10);\n    });\n\n    configFromArray(config);\n}\n\nfunction createFromConfig (config) {\n    var res = new Moment(checkOverflow(prepareConfig(config)));\n    if (res._nextDay) {\n        // Adding is smart enough around DST\n        res.add(1, 'd');\n        res._nextDay = undefined;\n    }\n\n    return res;\n}\n\nfunction prepareConfig (config) {\n    var input = config._i,\n        format = config._f;\n\n    config._locale = config._locale || getLocale(config._l);\n\n    if (input === null || (format === undefined && input === '')) {\n        return createInvalid({nullInput: true});\n    }\n\n    if (typeof input === 'string') {\n        config._i = input = config._locale.preparse(input);\n    }\n\n    if (isMoment(input)) {\n        return new Moment(checkOverflow(input));\n    } else if (isDate(input)) {\n        config._d = input;\n    } else if (isArray(format)) {\n        configFromStringAndArray(config);\n    } else if (format) {\n        configFromStringAndFormat(config);\n    }  else {\n        configFromInput(config);\n    }\n\n    if (!isValid(config)) {\n        config._d = null;\n    }\n\n    return config;\n}\n\nfunction configFromInput(config) {\n    var input = config._i;\n    if (isUndefined(input)) {\n        config._d = new Date(hooks.now());\n    } else if (isDate(input)) {\n        config._d = new Date(input.valueOf());\n    } else if (typeof input === 'string') {\n        configFromString(config);\n    } else if (isArray(input)) {\n        config._a = map(input.slice(0), function (obj) {\n            return parseInt(obj, 10);\n        });\n        configFromArray(config);\n    } else if (isObject(input)) {\n        configFromObject(config);\n    } else if (isNumber(input)) {\n        // from milliseconds\n        config._d = new Date(input);\n    } else {\n        hooks.createFromInputFallback(config);\n    }\n}\n\nfunction createLocalOrUTC (input, format, locale, strict, isUTC) {\n    var c = {};\n\n    if (locale === true || locale === false) {\n        strict = locale;\n        locale = undefined;\n    }\n\n    if ((isObject(input) && isObjectEmpty(input)) ||\n            (isArray(input) && input.length === 0)) {\n        input = undefined;\n    }\n    // object construction must be done this way.\n    // https://github.com/moment/moment/issues/1423\n    c._isAMomentObject = true;\n    c._useUTC = c._isUTC = isUTC;\n    c._l = locale;\n    c._i = input;\n    c._f = format;\n    c._strict = strict;\n\n    return createFromConfig(c);\n}\n\nfunction createLocal (input, format, locale, strict) {\n    return createLocalOrUTC(input, format, locale, strict, false);\n}\n\nvar prototypeMin = deprecate(\n    'moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/',\n    function () {\n        var other = createLocal.apply(null, arguments);\n        if (this.isValid() && other.isValid()) {\n            return other < this ? this : other;\n        } else {\n            return createInvalid();\n        }\n    }\n);\n\nvar prototypeMax = deprecate(\n    'moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/',\n    function () {\n        var other = createLocal.apply(null, arguments);\n        if (this.isValid() && other.isValid()) {\n            return other > this ? this : other;\n        } else {\n            return createInvalid();\n        }\n    }\n);\n\n// Pick a moment m from moments so that m[fn](other) is true for all\n// other. This relies on the function fn to be transitive.\n//\n// moments should either be an array of moment objects or an array, whose\n// first element is an array of moment objects.\nfunction pickBy(fn, moments) {\n    var res, i;\n    if (moments.length === 1 && isArray(moments[0])) {\n        moments = moments[0];\n    }\n    if (!moments.length) {\n        return createLocal();\n    }\n    res = moments[0];\n    for (i = 1; i < moments.length; ++i) {\n        if (!moments[i].isValid() || moments[i][fn](res)) {\n            res = moments[i];\n        }\n    }\n    return res;\n}\n\n// TODO: Use [].sort instead?\nfunction min () {\n    var args = [].slice.call(arguments, 0);\n\n    return pickBy('isBefore', args);\n}\n\nfunction max () {\n    var args = [].slice.call(arguments, 0);\n\n    return pickBy('isAfter', args);\n}\n\nvar now = function () {\n    return Date.now ? Date.now() : +(new Date());\n};\n\nvar ordering = ['year', 'quarter', 'month', 'week', 'day', 'hour', 'minute', 'second', 'millisecond'];\n\nfunction isDurationValid(m) {\n    for (var key in m) {\n        if (!(ordering.indexOf(key) !== -1 && (m[key] == null || !isNaN(m[key])))) {\n            return false;\n        }\n    }\n\n    var unitHasDecimal = false;\n    for (var i = 0; i < ordering.length; ++i) {\n        if (m[ordering[i]]) {\n            if (unitHasDecimal) {\n                return false; // only allow non-integers for smallest unit\n            }\n            if (parseFloat(m[ordering[i]]) !== toInt(m[ordering[i]])) {\n                unitHasDecimal = true;\n            }\n        }\n    }\n\n    return true;\n}\n\nfunction isValid$1() {\n    return this._isValid;\n}\n\nfunction createInvalid$1() {\n    return createDuration(NaN);\n}\n\nfunction Duration (duration) {\n    var normalizedInput = normalizeObjectUnits(duration),\n        years = normalizedInput.year || 0,\n        quarters = normalizedInput.quarter || 0,\n        months = normalizedInput.month || 0,\n        weeks = normalizedInput.week || 0,\n        days = normalizedInput.day || 0,\n        hours = normalizedInput.hour || 0,\n        minutes = normalizedInput.minute || 0,\n        seconds = normalizedInput.second || 0,\n        milliseconds = normalizedInput.millisecond || 0;\n\n    this._isValid = isDurationValid(normalizedInput);\n\n    // representation for dateAddRemove\n    this._milliseconds = +milliseconds +\n        seconds * 1e3 + // 1000\n        minutes * 6e4 + // 1000 * 60\n        hours * 1000 * 60 * 60; //using 1000 * 60 * 60 instead of 36e5 to avoid floating point rounding errors https://github.com/moment/moment/issues/2978\n    // Because of dateAddRemove treats 24 hours as different from a\n    // day when working around DST, we need to store them separately\n    this._days = +days +\n        weeks * 7;\n    // It is impossible translate months into days without knowing\n    // which months you are are talking about, so we have to store\n    // it separately.\n    this._months = +months +\n        quarters * 3 +\n        years * 12;\n\n    this._data = {};\n\n    this._locale = getLocale();\n\n    this._bubble();\n}\n\nfunction isDuration (obj) {\n    return obj instanceof Duration;\n}\n\nfunction absRound (number) {\n    if (number < 0) {\n        return Math.round(-1 * number) * -1;\n    } else {\n        return Math.round(number);\n    }\n}\n\n// FORMATTING\n\nfunction offset (token, separator) {\n    addFormatToken(token, 0, 0, function () {\n        var offset = this.utcOffset();\n        var sign = '+';\n        if (offset < 0) {\n            offset = -offset;\n            sign = '-';\n        }\n        return sign + zeroFill(~~(offset / 60), 2) + separator + zeroFill(~~(offset) % 60, 2);\n    });\n}\n\noffset('Z', ':');\noffset('ZZ', '');\n\n// PARSING\n\naddRegexToken('Z',  matchShortOffset);\naddRegexToken('ZZ', matchShortOffset);\naddParseToken(['Z', 'ZZ'], function (input, array, config) {\n    config._useUTC = true;\n    config._tzm = offsetFromString(matchShortOffset, input);\n});\n\n// HELPERS\n\n// timezone chunker\n// '+10:00' > ['10',  '00']\n// '-1530'  > ['-15', '30']\nvar chunkOffset = /([\\+\\-]|\\d\\d)/gi;\n\nfunction offsetFromString(matcher, string) {\n    var matches = (string || '').match(matcher);\n\n    if (matches === null) {\n        return null;\n    }\n\n    var chunk   = matches[matches.length - 1] || [];\n    var parts   = (chunk + '').match(chunkOffset) || ['-', 0, 0];\n    var minutes = +(parts[1] * 60) + toInt(parts[2]);\n\n    return minutes === 0 ?\n      0 :\n      parts[0] === '+' ? minutes : -minutes;\n}\n\n// Return a moment from input, that is local/utc/zone equivalent to model.\nfunction cloneWithOffset(input, model) {\n    var res, diff;\n    if (model._isUTC) {\n        res = model.clone();\n        diff = (isMoment(input) || isDate(input) ? input.valueOf() : createLocal(input).valueOf()) - res.valueOf();\n        // Use low-level api, because this fn is low-level api.\n        res._d.setTime(res._d.valueOf() + diff);\n        hooks.updateOffset(res, false);\n        return res;\n    } else {\n        return createLocal(input).local();\n    }\n}\n\nfunction getDateOffset (m) {\n    // On Firefox.24 Date#getTimezoneOffset returns a floating point.\n    // https://github.com/moment/moment/pull/1871\n    return -Math.round(m._d.getTimezoneOffset() / 15) * 15;\n}\n\n// HOOKS\n\n// This function will be called whenever a moment is mutated.\n// It is intended to keep the offset in sync with the timezone.\nhooks.updateOffset = function () {};\n\n// MOMENTS\n\n// keepLocalTime = true means only change the timezone, without\n// affecting the local hour. So 5:31:26 +0300 --[utcOffset(2, true)]-->\n// 5:31:26 +0200 It is possible that 5:31:26 doesn't exist with offset\n// +0200, so we adjust the time as needed, to be valid.\n//\n// Keeping the time actually adds/subtracts (one hour)\n// from the actual represented time. That is why we call updateOffset\n// a second time. In case it wants us to change the offset again\n// _changeInProgress == true case, then we have to adjust, because\n// there is no such time in the given timezone.\nfunction getSetOffset (input, keepLocalTime, keepMinutes) {\n    var offset = this._offset || 0,\n        localAdjust;\n    if (!this.isValid()) {\n        return input != null ? this : NaN;\n    }\n    if (input != null) {\n        if (typeof input === 'string') {\n            input = offsetFromString(matchShortOffset, input);\n            if (input === null) {\n                return this;\n            }\n        } else if (Math.abs(input) < 16 && !keepMinutes) {\n            input = input * 60;\n        }\n        if (!this._isUTC && keepLocalTime) {\n            localAdjust = getDateOffset(this);\n        }\n        this._offset = input;\n        this._isUTC = true;\n        if (localAdjust != null) {\n            this.add(localAdjust, 'm');\n        }\n        if (offset !== input) {\n            if (!keepLocalTime || this._changeInProgress) {\n                addSubtract(this, createDuration(input - offset, 'm'), 1, false);\n            } else if (!this._changeInProgress) {\n                this._changeInProgress = true;\n                hooks.updateOffset(this, true);\n                this._changeInProgress = null;\n            }\n        }\n        return this;\n    } else {\n        return this._isUTC ? offset : getDateOffset(this);\n    }\n}\n\nfunction getSetZone (input, keepLocalTime) {\n    if (input != null) {\n        if (typeof input !== 'string') {\n            input = -input;\n        }\n\n        this.utcOffset(input, keepLocalTime);\n\n        return this;\n    } else {\n        return -this.utcOffset();\n    }\n}\n\nfunction setOffsetToUTC (keepLocalTime) {\n    return this.utcOffset(0, keepLocalTime);\n}\n\nfunction setOffsetToLocal (keepLocalTime) {\n    if (this._isUTC) {\n        this.utcOffset(0, keepLocalTime);\n        this._isUTC = false;\n\n        if (keepLocalTime) {\n            this.subtract(getDateOffset(this), 'm');\n        }\n    }\n    return this;\n}\n\nfunction setOffsetToParsedOffset () {\n    if (this._tzm != null) {\n        this.utcOffset(this._tzm, false, true);\n    } else if (typeof this._i === 'string') {\n        var tZone = offsetFromString(matchOffset, this._i);\n        if (tZone != null) {\n            this.utcOffset(tZone);\n        }\n        else {\n            this.utcOffset(0, true);\n        }\n    }\n    return this;\n}\n\nfunction hasAlignedHourOffset (input) {\n    if (!this.isValid()) {\n        return false;\n    }\n    input = input ? createLocal(input).utcOffset() : 0;\n\n    return (this.utcOffset() - input) % 60 === 0;\n}\n\nfunction isDaylightSavingTime () {\n    return (\n        this.utcOffset() > this.clone().month(0).utcOffset() ||\n        this.utcOffset() > this.clone().month(5).utcOffset()\n    );\n}\n\nfunction isDaylightSavingTimeShifted () {\n    if (!isUndefined(this._isDSTShifted)) {\n        return this._isDSTShifted;\n    }\n\n    var c = {};\n\n    copyConfig(c, this);\n    c = prepareConfig(c);\n\n    if (c._a) {\n        var other = c._isUTC ? createUTC(c._a) : createLocal(c._a);\n        this._isDSTShifted = this.isValid() &&\n            compareArrays(c._a, other.toArray()) > 0;\n    } else {\n        this._isDSTShifted = false;\n    }\n\n    return this._isDSTShifted;\n}\n\nfunction isLocal () {\n    return this.isValid() ? !this._isUTC : false;\n}\n\nfunction isUtcOffset () {\n    return this.isValid() ? this._isUTC : false;\n}\n\nfunction isUtc () {\n    return this.isValid() ? this._isUTC && this._offset === 0 : false;\n}\n\n// ASP.NET json date format regex\nvar aspNetRegex = /^(\\-)?(?:(\\d*)[. ])?(\\d+)\\:(\\d+)(?:\\:(\\d+)(\\.\\d*)?)?$/;\n\n// from http://docs.closure-library.googlecode.com/git/closure_goog_date_date.js.source.html\n// somewhat more in line with 4.4.3.2 2004 spec, but allows decimal anywhere\n// and further modified to allow for strings containing both week and day\nvar isoRegex = /^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;\n\nfunction createDuration (input, key) {\n    var duration = input,\n        // matching against regexp is expensive, do it on demand\n        match = null,\n        sign,\n        ret,\n        diffRes;\n\n    if (isDuration(input)) {\n        duration = {\n            ms : input._milliseconds,\n            d  : input._days,\n            M  : input._months\n        };\n    } else if (isNumber(input)) {\n        duration = {};\n        if (key) {\n            duration[key] = input;\n        } else {\n            duration.milliseconds = input;\n        }\n    } else if (!!(match = aspNetRegex.exec(input))) {\n        sign = (match[1] === '-') ? -1 : 1;\n        duration = {\n            y  : 0,\n            d  : toInt(match[DATE])                         * sign,\n            h  : toInt(match[HOUR])                         * sign,\n            m  : toInt(match[MINUTE])                       * sign,\n            s  : toInt(match[SECOND])                       * sign,\n            ms : toInt(absRound(match[MILLISECOND] * 1000)) * sign // the millisecond decimal point is included in the match\n        };\n    } else if (!!(match = isoRegex.exec(input))) {\n        sign = (match[1] === '-') ? -1 : 1;\n        duration = {\n            y : parseIso(match[2], sign),\n            M : parseIso(match[3], sign),\n            w : parseIso(match[4], sign),\n            d : parseIso(match[5], sign),\n            h : parseIso(match[6], sign),\n            m : parseIso(match[7], sign),\n            s : parseIso(match[8], sign)\n        };\n    } else if (duration == null) {// checks for null or undefined\n        duration = {};\n    } else if (typeof duration === 'object' && ('from' in duration || 'to' in duration)) {\n        diffRes = momentsDifference(createLocal(duration.from), createLocal(duration.to));\n\n        duration = {};\n        duration.ms = diffRes.milliseconds;\n        duration.M = diffRes.months;\n    }\n\n    ret = new Duration(duration);\n\n    if (isDuration(input) && hasOwnProp(input, '_locale')) {\n        ret._locale = input._locale;\n    }\n\n    return ret;\n}\n\ncreateDuration.fn = Duration.prototype;\ncreateDuration.invalid = createInvalid$1;\n\nfunction parseIso (inp, sign) {\n    // We'd normally use ~~inp for this, but unfortunately it also\n    // converts floats to ints.\n    // inp may be undefined, so careful calling replace on it.\n    var res = inp && parseFloat(inp.replace(',', '.'));\n    // apply sign while we're at it\n    return (isNaN(res) ? 0 : res) * sign;\n}\n\nfunction positiveMomentsDifference(base, other) {\n    var res = {milliseconds: 0, months: 0};\n\n    res.months = other.month() - base.month() +\n        (other.year() - base.year()) * 12;\n    if (base.clone().add(res.months, 'M').isAfter(other)) {\n        --res.months;\n    }\n\n    res.milliseconds = +other - +(base.clone().add(res.months, 'M'));\n\n    return res;\n}\n\nfunction momentsDifference(base, other) {\n    var res;\n    if (!(base.isValid() && other.isValid())) {\n        return {milliseconds: 0, months: 0};\n    }\n\n    other = cloneWithOffset(other, base);\n    if (base.isBefore(other)) {\n        res = positiveMomentsDifference(base, other);\n    } else {\n        res = positiveMomentsDifference(other, base);\n        res.milliseconds = -res.milliseconds;\n        res.months = -res.months;\n    }\n\n    return res;\n}\n\n// TODO: remove 'name' arg after deprecation is removed\nfunction createAdder(direction, name) {\n    return function (val, period) {\n        var dur, tmp;\n        //invert the arguments, but complain about it\n        if (period !== null && !isNaN(+period)) {\n            deprecateSimple(name, 'moment().' + name  + '(period, number) is deprecated. Please use moment().' + name + '(number, period). ' +\n            'See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.');\n            tmp = val; val = period; period = tmp;\n        }\n\n        val = typeof val === 'string' ? +val : val;\n        dur = createDuration(val, period);\n        addSubtract(this, dur, direction);\n        return this;\n    };\n}\n\nfunction addSubtract (mom, duration, isAdding, updateOffset) {\n    var milliseconds = duration._milliseconds,\n        days = absRound(duration._days),\n        months = absRound(duration._months);\n\n    if (!mom.isValid()) {\n        // No op\n        return;\n    }\n\n    updateOffset = updateOffset == null ? true : updateOffset;\n\n    if (milliseconds) {\n        mom._d.setTime(mom._d.valueOf() + milliseconds * isAdding);\n    }\n    if (days) {\n        set$1(mom, 'Date', get(mom, 'Date') + days * isAdding);\n    }\n    if (months) {\n        setMonth(mom, get(mom, 'Month') + months * isAdding);\n    }\n    if (updateOffset) {\n        hooks.updateOffset(mom, days || months);\n    }\n}\n\nvar add      = createAdder(1, 'add');\nvar subtract = createAdder(-1, 'subtract');\n\nfunction getCalendarFormat(myMoment, now) {\n    var diff = myMoment.diff(now, 'days', true);\n    return diff < -6 ? 'sameElse' :\n            diff < -1 ? 'lastWeek' :\n            diff < 0 ? 'lastDay' :\n            diff < 1 ? 'sameDay' :\n            diff < 2 ? 'nextDay' :\n            diff < 7 ? 'nextWeek' : 'sameElse';\n}\n\nfunction calendar$1 (time, formats) {\n    // We want to compare the start of today, vs this.\n    // Getting start-of-today depends on whether we're local/utc/offset or not.\n    var now = time || createLocal(),\n        sod = cloneWithOffset(now, this).startOf('day'),\n        format = hooks.calendarFormat(this, sod) || 'sameElse';\n\n    var output = formats && (isFunction(formats[format]) ? formats[format].call(this, now) : formats[format]);\n\n    return this.format(output || this.localeData().calendar(format, this, createLocal(now)));\n}\n\nfunction clone () {\n    return new Moment(this);\n}\n\nfunction isAfter (input, units) {\n    var localInput = isMoment(input) ? input : createLocal(input);\n    if (!(this.isValid() && localInput.isValid())) {\n        return false;\n    }\n    units = normalizeUnits(!isUndefined(units) ? units : 'millisecond');\n    if (units === 'millisecond') {\n        return this.valueOf() > localInput.valueOf();\n    } else {\n        return localInput.valueOf() < this.clone().startOf(units).valueOf();\n    }\n}\n\nfunction isBefore (input, units) {\n    var localInput = isMoment(input) ? input : createLocal(input);\n    if (!(this.isValid() && localInput.isValid())) {\n        return false;\n    }\n    units = normalizeUnits(!isUndefined(units) ? units : 'millisecond');\n    if (units === 'millisecond') {\n        return this.valueOf() < localInput.valueOf();\n    } else {\n        return this.clone().endOf(units).valueOf() < localInput.valueOf();\n    }\n}\n\nfunction isBetween (from, to, units, inclusivity) {\n    inclusivity = inclusivity || '()';\n    return (inclusivity[0] === '(' ? this.isAfter(from, units) : !this.isBefore(from, units)) &&\n        (inclusivity[1] === ')' ? this.isBefore(to, units) : !this.isAfter(to, units));\n}\n\nfunction isSame (input, units) {\n    var localInput = isMoment(input) ? input : createLocal(input),\n        inputMs;\n    if (!(this.isValid() && localInput.isValid())) {\n        return false;\n    }\n    units = normalizeUnits(units || 'millisecond');\n    if (units === 'millisecond') {\n        return this.valueOf() === localInput.valueOf();\n    } else {\n        inputMs = localInput.valueOf();\n        return this.clone().startOf(units).valueOf() <= inputMs && inputMs <= this.clone().endOf(units).valueOf();\n    }\n}\n\nfunction isSameOrAfter (input, units) {\n    return this.isSame(input, units) || this.isAfter(input,units);\n}\n\nfunction isSameOrBefore (input, units) {\n    return this.isSame(input, units) || this.isBefore(input,units);\n}\n\nfunction diff (input, units, asFloat) {\n    var that,\n        zoneDelta,\n        delta, output;\n\n    if (!this.isValid()) {\n        return NaN;\n    }\n\n    that = cloneWithOffset(input, this);\n\n    if (!that.isValid()) {\n        return NaN;\n    }\n\n    zoneDelta = (that.utcOffset() - this.utcOffset()) * 6e4;\n\n    units = normalizeUnits(units);\n\n    if (units === 'year' || units === 'month' || units === 'quarter') {\n        output = monthDiff(this, that);\n        if (units === 'quarter') {\n            output = output / 3;\n        } else if (units === 'year') {\n            output = output / 12;\n        }\n    } else {\n        delta = this - that;\n        output = units === 'second' ? delta / 1e3 : // 1000\n            units === 'minute' ? delta / 6e4 : // 1000 * 60\n            units === 'hour' ? delta / 36e5 : // 1000 * 60 * 60\n            units === 'day' ? (delta - zoneDelta) / 864e5 : // 1000 * 60 * 60 * 24, negate dst\n            units === 'week' ? (delta - zoneDelta) / 6048e5 : // 1000 * 60 * 60 * 24 * 7, negate dst\n            delta;\n    }\n    return asFloat ? output : absFloor(output);\n}\n\nfunction monthDiff (a, b) {\n    // difference in months\n    var wholeMonthDiff = ((b.year() - a.year()) * 12) + (b.month() - a.month()),\n        // b is in (anchor - 1 month, anchor + 1 month)\n        anchor = a.clone().add(wholeMonthDiff, 'months'),\n        anchor2, adjust;\n\n    if (b - anchor < 0) {\n        anchor2 = a.clone().add(wholeMonthDiff - 1, 'months');\n        // linear across the month\n        adjust = (b - anchor) / (anchor - anchor2);\n    } else {\n        anchor2 = a.clone().add(wholeMonthDiff + 1, 'months');\n        // linear across the month\n        adjust = (b - anchor) / (anchor2 - anchor);\n    }\n\n    //check for negative zero, return zero if negative zero\n    return -(wholeMonthDiff + adjust) || 0;\n}\n\nhooks.defaultFormat = 'YYYY-MM-DDTHH:mm:ssZ';\nhooks.defaultFormatUtc = 'YYYY-MM-DDTHH:mm:ss[Z]';\n\nfunction toString () {\n    return this.clone().locale('en').format('ddd MMM DD YYYY HH:mm:ss [GMT]ZZ');\n}\n\nfunction toISOString() {\n    if (!this.isValid()) {\n        return null;\n    }\n    var m = this.clone().utc();\n    if (m.year() < 0 || m.year() > 9999) {\n        return formatMoment(m, 'YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]');\n    }\n    if (isFunction(Date.prototype.toISOString)) {\n        // native implementation is ~50x faster, use it when we can\n        return this.toDate().toISOString();\n    }\n    return formatMoment(m, 'YYYY-MM-DD[T]HH:mm:ss.SSS[Z]');\n}\n\n/**\n * Return a human readable representation of a moment that can\n * also be evaluated to get a new moment which is the same\n *\n * @link https://nodejs.org/dist/latest/docs/api/util.html#util_custom_inspect_function_on_objects\n */\nfunction inspect () {\n    if (!this.isValid()) {\n        return 'moment.invalid(/* ' + this._i + ' */)';\n    }\n    var func = 'moment';\n    var zone = '';\n    if (!this.isLocal()) {\n        func = this.utcOffset() === 0 ? 'moment.utc' : 'moment.parseZone';\n        zone = 'Z';\n    }\n    var prefix = '[' + func + '(\"]';\n    var year = (0 <= this.year() && this.year() <= 9999) ? 'YYYY' : 'YYYYYY';\n    var datetime = '-MM-DD[T]HH:mm:ss.SSS';\n    var suffix = zone + '[\")]';\n\n    return this.format(prefix + year + datetime + suffix);\n}\n\nfunction format (inputString) {\n    if (!inputString) {\n        inputString = this.isUtc() ? hooks.defaultFormatUtc : hooks.defaultFormat;\n    }\n    var output = formatMoment(this, inputString);\n    return this.localeData().postformat(output);\n}\n\nfunction from (time, withoutSuffix) {\n    if (this.isValid() &&\n            ((isMoment(time) && time.isValid()) ||\n             createLocal(time).isValid())) {\n        return createDuration({to: this, from: time}).locale(this.locale()).humanize(!withoutSuffix);\n    } else {\n        return this.localeData().invalidDate();\n    }\n}\n\nfunction fromNow (withoutSuffix) {\n    return this.from(createLocal(), withoutSuffix);\n}\n\nfunction to (time, withoutSuffix) {\n    if (this.isValid() &&\n            ((isMoment(time) && time.isValid()) ||\n             createLocal(time).isValid())) {\n        return createDuration({from: this, to: time}).locale(this.locale()).humanize(!withoutSuffix);\n    } else {\n        return this.localeData().invalidDate();\n    }\n}\n\nfunction toNow (withoutSuffix) {\n    return this.to(createLocal(), withoutSuffix);\n}\n\n// If passed a locale key, it will set the locale for this\n// instance.  Otherwise, it will return the locale configuration\n// variables for this instance.\nfunction locale (key) {\n    var newLocaleData;\n\n    if (key === undefined) {\n        return this._locale._abbr;\n    } else {\n        newLocaleData = getLocale(key);\n        if (newLocaleData != null) {\n            this._locale = newLocaleData;\n        }\n        return this;\n    }\n}\n\nvar lang = deprecate(\n    'moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.',\n    function (key) {\n        if (key === undefined) {\n            return this.localeData();\n        } else {\n            return this.locale(key);\n        }\n    }\n);\n\nfunction localeData () {\n    return this._locale;\n}\n\nfunction startOf (units) {\n    units = normalizeUnits(units);\n    // the following switch intentionally omits break keywords\n    // to utilize falling through the cases.\n    switch (units) {\n        case 'year':\n            this.month(0);\n            /* falls through */\n        case 'quarter':\n        case 'month':\n            this.date(1);\n            /* falls through */\n        case 'week':\n        case 'isoWeek':\n        case 'day':\n        case 'date':\n            this.hours(0);\n            /* falls through */\n        case 'hour':\n            this.minutes(0);\n            /* falls through */\n        case 'minute':\n            this.seconds(0);\n            /* falls through */\n        case 'second':\n            this.milliseconds(0);\n    }\n\n    // weeks are a special case\n    if (units === 'week') {\n        this.weekday(0);\n    }\n    if (units === 'isoWeek') {\n        this.isoWeekday(1);\n    }\n\n    // quarters are also special\n    if (units === 'quarter') {\n        this.month(Math.floor(this.month() / 3) * 3);\n    }\n\n    return this;\n}\n\nfunction endOf (units) {\n    units = normalizeUnits(units);\n    if (units === undefined || units === 'millisecond') {\n        return this;\n    }\n\n    // 'date' is an alias for 'day', so it should be considered as such.\n    if (units === 'date') {\n        units = 'day';\n    }\n\n    return this.startOf(units).add(1, (units === 'isoWeek' ? 'week' : units)).subtract(1, 'ms');\n}\n\nfunction valueOf () {\n    return this._d.valueOf() - ((this._offset || 0) * 60000);\n}\n\nfunction unix () {\n    return Math.floor(this.valueOf() / 1000);\n}\n\nfunction toDate () {\n    return new Date(this.valueOf());\n}\n\nfunction toArray () {\n    var m = this;\n    return [m.year(), m.month(), m.date(), m.hour(), m.minute(), m.second(), m.millisecond()];\n}\n\nfunction toObject () {\n    var m = this;\n    return {\n        years: m.year(),\n        months: m.month(),\n        date: m.date(),\n        hours: m.hours(),\n        minutes: m.minutes(),\n        seconds: m.seconds(),\n        milliseconds: m.milliseconds()\n    };\n}\n\nfunction toJSON () {\n    // new Date(NaN).toJSON() === null\n    return this.isValid() ? this.toISOString() : null;\n}\n\nfunction isValid$2 () {\n    return isValid(this);\n}\n\nfunction parsingFlags () {\n    return extend({}, getParsingFlags(this));\n}\n\nfunction invalidAt () {\n    return getParsingFlags(this).overflow;\n}\n\nfunction creationData() {\n    return {\n        input: this._i,\n        format: this._f,\n        locale: this._locale,\n        isUTC: this._isUTC,\n        strict: this._strict\n    };\n}\n\n// FORMATTING\n\naddFormatToken(0, ['gg', 2], 0, function () {\n    return this.weekYear() % 100;\n});\n\naddFormatToken(0, ['GG', 2], 0, function () {\n    return this.isoWeekYear() % 100;\n});\n\nfunction addWeekYearFormatToken (token, getter) {\n    addFormatToken(0, [token, token.length], 0, getter);\n}\n\naddWeekYearFormatToken('gggg',     'weekYear');\naddWeekYearFormatToken('ggggg',    'weekYear');\naddWeekYearFormatToken('GGGG',  'isoWeekYear');\naddWeekYearFormatToken('GGGGG', 'isoWeekYear');\n\n// ALIASES\n\naddUnitAlias('weekYear', 'gg');\naddUnitAlias('isoWeekYear', 'GG');\n\n// PRIORITY\n\naddUnitPriority('weekYear', 1);\naddUnitPriority('isoWeekYear', 1);\n\n\n// PARSING\n\naddRegexToken('G',      matchSigned);\naddRegexToken('g',      matchSigned);\naddRegexToken('GG',     match1to2, match2);\naddRegexToken('gg',     match1to2, match2);\naddRegexToken('GGGG',   match1to4, match4);\naddRegexToken('gggg',   match1to4, match4);\naddRegexToken('GGGGG',  match1to6, match6);\naddRegexToken('ggggg',  match1to6, match6);\n\naddWeekParseToken(['gggg', 'ggggg', 'GGGG', 'GGGGG'], function (input, week, config, token) {\n    week[token.substr(0, 2)] = toInt(input);\n});\n\naddWeekParseToken(['gg', 'GG'], function (input, week, config, token) {\n    week[token] = hooks.parseTwoDigitYear(input);\n});\n\n// MOMENTS\n\nfunction getSetWeekYear (input) {\n    return getSetWeekYearHelper.call(this,\n            input,\n            this.week(),\n            this.weekday(),\n            this.localeData()._week.dow,\n            this.localeData()._week.doy);\n}\n\nfunction getSetISOWeekYear (input) {\n    return getSetWeekYearHelper.call(this,\n            input, this.isoWeek(), this.isoWeekday(), 1, 4);\n}\n\nfunction getISOWeeksInYear () {\n    return weeksInYear(this.year(), 1, 4);\n}\n\nfunction getWeeksInYear () {\n    var weekInfo = this.localeData()._week;\n    return weeksInYear(this.year(), weekInfo.dow, weekInfo.doy);\n}\n\nfunction getSetWeekYearHelper(input, week, weekday, dow, doy) {\n    var weeksTarget;\n    if (input == null) {\n        return weekOfYear(this, dow, doy).year;\n    } else {\n        weeksTarget = weeksInYear(input, dow, doy);\n        if (week > weeksTarget) {\n            week = weeksTarget;\n        }\n        return setWeekAll.call(this, input, week, weekday, dow, doy);\n    }\n}\n\nfunction setWeekAll(weekYear, week, weekday, dow, doy) {\n    var dayOfYearData = dayOfYearFromWeeks(weekYear, week, weekday, dow, doy),\n        date = createUTCDate(dayOfYearData.year, 0, dayOfYearData.dayOfYear);\n\n    this.year(date.getUTCFullYear());\n    this.month(date.getUTCMonth());\n    this.date(date.getUTCDate());\n    return this;\n}\n\n// FORMATTING\n\naddFormatToken('Q', 0, 'Qo', 'quarter');\n\n// ALIASES\n\naddUnitAlias('quarter', 'Q');\n\n// PRIORITY\n\naddUnitPriority('quarter', 7);\n\n// PARSING\n\naddRegexToken('Q', match1);\naddParseToken('Q', function (input, array) {\n    array[MONTH] = (toInt(input) - 1) * 3;\n});\n\n// MOMENTS\n\nfunction getSetQuarter (input) {\n    return input == null ? Math.ceil((this.month() + 1) / 3) : this.month((input - 1) * 3 + this.month() % 3);\n}\n\n// FORMATTING\n\naddFormatToken('D', ['DD', 2], 'Do', 'date');\n\n// ALIASES\n\naddUnitAlias('date', 'D');\n\n// PRIOROITY\naddUnitPriority('date', 9);\n\n// PARSING\n\naddRegexToken('D',  match1to2);\naddRegexToken('DD', match1to2, match2);\naddRegexToken('Do', function (isStrict, locale) {\n    // TODO: Remove \"ordinalParse\" fallback in next major release.\n    return isStrict ?\n      (locale._dayOfMonthOrdinalParse || locale._ordinalParse) :\n      locale._dayOfMonthOrdinalParseLenient;\n});\n\naddParseToken(['D', 'DD'], DATE);\naddParseToken('Do', function (input, array) {\n    array[DATE] = toInt(input.match(match1to2)[0], 10);\n});\n\n// MOMENTS\n\nvar getSetDayOfMonth = makeGetSet('Date', true);\n\n// FORMATTING\n\naddFormatToken('DDD', ['DDDD', 3], 'DDDo', 'dayOfYear');\n\n// ALIASES\n\naddUnitAlias('dayOfYear', 'DDD');\n\n// PRIORITY\naddUnitPriority('dayOfYear', 4);\n\n// PARSING\n\naddRegexToken('DDD',  match1to3);\naddRegexToken('DDDD', match3);\naddParseToken(['DDD', 'DDDD'], function (input, array, config) {\n    config._dayOfYear = toInt(input);\n});\n\n// HELPERS\n\n// MOMENTS\n\nfunction getSetDayOfYear (input) {\n    var dayOfYear = Math.round((this.clone().startOf('day') - this.clone().startOf('year')) / 864e5) + 1;\n    return input == null ? dayOfYear : this.add((input - dayOfYear), 'd');\n}\n\n// FORMATTING\n\naddFormatToken('m', ['mm', 2], 0, 'minute');\n\n// ALIASES\n\naddUnitAlias('minute', 'm');\n\n// PRIORITY\n\naddUnitPriority('minute', 14);\n\n// PARSING\n\naddRegexToken('m',  match1to2);\naddRegexToken('mm', match1to2, match2);\naddParseToken(['m', 'mm'], MINUTE);\n\n// MOMENTS\n\nvar getSetMinute = makeGetSet('Minutes', false);\n\n// FORMATTING\n\naddFormatToken('s', ['ss', 2], 0, 'second');\n\n// ALIASES\n\naddUnitAlias('second', 's');\n\n// PRIORITY\n\naddUnitPriority('second', 15);\n\n// PARSING\n\naddRegexToken('s',  match1to2);\naddRegexToken('ss', match1to2, match2);\naddParseToken(['s', 'ss'], SECOND);\n\n// MOMENTS\n\nvar getSetSecond = makeGetSet('Seconds', false);\n\n// FORMATTING\n\naddFormatToken('S', 0, 0, function () {\n    return ~~(this.millisecond() / 100);\n});\n\naddFormatToken(0, ['SS', 2], 0, function () {\n    return ~~(this.millisecond() / 10);\n});\n\naddFormatToken(0, ['SSS', 3], 0, 'millisecond');\naddFormatToken(0, ['SSSS', 4], 0, function () {\n    return this.millisecond() * 10;\n});\naddFormatToken(0, ['SSSSS', 5], 0, function () {\n    return this.millisecond() * 100;\n});\naddFormatToken(0, ['SSSSSS', 6], 0, function () {\n    return this.millisecond() * 1000;\n});\naddFormatToken(0, ['SSSSSSS', 7], 0, function () {\n    return this.millisecond() * 10000;\n});\naddFormatToken(0, ['SSSSSSSS', 8], 0, function () {\n    return this.millisecond() * 100000;\n});\naddFormatToken(0, ['SSSSSSSSS', 9], 0, function () {\n    return this.millisecond() * 1000000;\n});\n\n\n// ALIASES\n\naddUnitAlias('millisecond', 'ms');\n\n// PRIORITY\n\naddUnitPriority('millisecond', 16);\n\n// PARSING\n\naddRegexToken('S',    match1to3, match1);\naddRegexToken('SS',   match1to3, match2);\naddRegexToken('SSS',  match1to3, match3);\n\nvar token;\nfor (token = 'SSSS'; token.length <= 9; token += 'S') {\n    addRegexToken(token, matchUnsigned);\n}\n\nfunction parseMs(input, array) {\n    array[MILLISECOND] = toInt(('0.' + input) * 1000);\n}\n\nfor (token = 'S'; token.length <= 9; token += 'S') {\n    addParseToken(token, parseMs);\n}\n// MOMENTS\n\nvar getSetMillisecond = makeGetSet('Milliseconds', false);\n\n// FORMATTING\n\naddFormatToken('z',  0, 0, 'zoneAbbr');\naddFormatToken('zz', 0, 0, 'zoneName');\n\n// MOMENTS\n\nfunction getZoneAbbr () {\n    return this._isUTC ? 'UTC' : '';\n}\n\nfunction getZoneName () {\n    return this._isUTC ? 'Coordinated Universal Time' : '';\n}\n\nvar proto = Moment.prototype;\n\nproto.add               = add;\nproto.calendar          = calendar$1;\nproto.clone             = clone;\nproto.diff              = diff;\nproto.endOf             = endOf;\nproto.format            = format;\nproto.from              = from;\nproto.fromNow           = fromNow;\nproto.to                = to;\nproto.toNow             = toNow;\nproto.get               = stringGet;\nproto.invalidAt         = invalidAt;\nproto.isAfter           = isAfter;\nproto.isBefore          = isBefore;\nproto.isBetween         = isBetween;\nproto.isSame            = isSame;\nproto.isSameOrAfter     = isSameOrAfter;\nproto.isSameOrBefore    = isSameOrBefore;\nproto.isValid           = isValid$2;\nproto.lang              = lang;\nproto.locale            = locale;\nproto.localeData        = localeData;\nproto.max               = prototypeMax;\nproto.min               = prototypeMin;\nproto.parsingFlags      = parsingFlags;\nproto.set               = stringSet;\nproto.startOf           = startOf;\nproto.subtract          = subtract;\nproto.toArray           = toArray;\nproto.toObject          = toObject;\nproto.toDate            = toDate;\nproto.toISOString       = toISOString;\nproto.inspect           = inspect;\nproto.toJSON            = toJSON;\nproto.toString          = toString;\nproto.unix              = unix;\nproto.valueOf           = valueOf;\nproto.creationData      = creationData;\n\n// Year\nproto.year       = getSetYear;\nproto.isLeapYear = getIsLeapYear;\n\n// Week Year\nproto.weekYear    = getSetWeekYear;\nproto.isoWeekYear = getSetISOWeekYear;\n\n// Quarter\nproto.quarter = proto.quarters = getSetQuarter;\n\n// Month\nproto.month       = getSetMonth;\nproto.daysInMonth = getDaysInMonth;\n\n// Week\nproto.week           = proto.weeks        = getSetWeek;\nproto.isoWeek        = proto.isoWeeks     = getSetISOWeek;\nproto.weeksInYear    = getWeeksInYear;\nproto.isoWeeksInYear = getISOWeeksInYear;\n\n// Day\nproto.date       = getSetDayOfMonth;\nproto.day        = proto.days             = getSetDayOfWeek;\nproto.weekday    = getSetLocaleDayOfWeek;\nproto.isoWeekday = getSetISODayOfWeek;\nproto.dayOfYear  = getSetDayOfYear;\n\n// Hour\nproto.hour = proto.hours = getSetHour;\n\n// Minute\nproto.minute = proto.minutes = getSetMinute;\n\n// Second\nproto.second = proto.seconds = getSetSecond;\n\n// Millisecond\nproto.millisecond = proto.milliseconds = getSetMillisecond;\n\n// Offset\nproto.utcOffset            = getSetOffset;\nproto.utc                  = setOffsetToUTC;\nproto.local                = setOffsetToLocal;\nproto.parseZone            = setOffsetToParsedOffset;\nproto.hasAlignedHourOffset = hasAlignedHourOffset;\nproto.isDST                = isDaylightSavingTime;\nproto.isLocal              = isLocal;\nproto.isUtcOffset          = isUtcOffset;\nproto.isUtc                = isUtc;\nproto.isUTC                = isUtc;\n\n// Timezone\nproto.zoneAbbr = getZoneAbbr;\nproto.zoneName = getZoneName;\n\n// Deprecations\nproto.dates  = deprecate('dates accessor is deprecated. Use date instead.', getSetDayOfMonth);\nproto.months = deprecate('months accessor is deprecated. Use month instead', getSetMonth);\nproto.years  = deprecate('years accessor is deprecated. Use year instead', getSetYear);\nproto.zone   = deprecate('moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/', getSetZone);\nproto.isDSTShifted = deprecate('isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information', isDaylightSavingTimeShifted);\n\nfunction createUnix (input) {\n    return createLocal(input * 1000);\n}\n\nfunction createInZone () {\n    return createLocal.apply(null, arguments).parseZone();\n}\n\nfunction preParsePostFormat (string) {\n    return string;\n}\n\nvar proto$1 = Locale.prototype;\n\nproto$1.calendar        = calendar;\nproto$1.longDateFormat  = longDateFormat;\nproto$1.invalidDate     = invalidDate;\nproto$1.ordinal         = ordinal;\nproto$1.preparse        = preParsePostFormat;\nproto$1.postformat      = preParsePostFormat;\nproto$1.relativeTime    = relativeTime;\nproto$1.pastFuture      = pastFuture;\nproto$1.set             = set;\n\n// Month\nproto$1.months            =        localeMonths;\nproto$1.monthsShort       =        localeMonthsShort;\nproto$1.monthsParse       =        localeMonthsParse;\nproto$1.monthsRegex       = monthsRegex;\nproto$1.monthsShortRegex  = monthsShortRegex;\n\n// Week\nproto$1.week = localeWeek;\nproto$1.firstDayOfYear = localeFirstDayOfYear;\nproto$1.firstDayOfWeek = localeFirstDayOfWeek;\n\n// Day of Week\nproto$1.weekdays       =        localeWeekdays;\nproto$1.weekdaysMin    =        localeWeekdaysMin;\nproto$1.weekdaysShort  =        localeWeekdaysShort;\nproto$1.weekdaysParse  =        localeWeekdaysParse;\n\nproto$1.weekdaysRegex       =        weekdaysRegex;\nproto$1.weekdaysShortRegex  =        weekdaysShortRegex;\nproto$1.weekdaysMinRegex    =        weekdaysMinRegex;\n\n// Hours\nproto$1.isPM = localeIsPM;\nproto$1.meridiem = localeMeridiem;\n\nfunction get$1 (format, index, field, setter) {\n    var locale = getLocale();\n    var utc = createUTC().set(setter, index);\n    return locale[field](utc, format);\n}\n\nfunction listMonthsImpl (format, index, field) {\n    if (isNumber(format)) {\n        index = format;\n        format = undefined;\n    }\n\n    format = format || '';\n\n    if (index != null) {\n        return get$1(format, index, field, 'month');\n    }\n\n    var i;\n    var out = [];\n    for (i = 0; i < 12; i++) {\n        out[i] = get$1(format, i, field, 'month');\n    }\n    return out;\n}\n\n// ()\n// (5)\n// (fmt, 5)\n// (fmt)\n// (true)\n// (true, 5)\n// (true, fmt, 5)\n// (true, fmt)\nfunction listWeekdaysImpl (localeSorted, format, index, field) {\n    if (typeof localeSorted === 'boolean') {\n        if (isNumber(format)) {\n            index = format;\n            format = undefined;\n        }\n\n        format = format || '';\n    } else {\n        format = localeSorted;\n        index = format;\n        localeSorted = false;\n\n        if (isNumber(format)) {\n            index = format;\n            format = undefined;\n        }\n\n        format = format || '';\n    }\n\n    var locale = getLocale(),\n        shift = localeSorted ? locale._week.dow : 0;\n\n    if (index != null) {\n        return get$1(format, (index + shift) % 7, field, 'day');\n    }\n\n    var i;\n    var out = [];\n    for (i = 0; i < 7; i++) {\n        out[i] = get$1(format, (i + shift) % 7, field, 'day');\n    }\n    return out;\n}\n\nfunction listMonths (format, index) {\n    return listMonthsImpl(format, index, 'months');\n}\n\nfunction listMonthsShort (format, index) {\n    return listMonthsImpl(format, index, 'monthsShort');\n}\n\nfunction listWeekdays (localeSorted, format, index) {\n    return listWeekdaysImpl(localeSorted, format, index, 'weekdays');\n}\n\nfunction listWeekdaysShort (localeSorted, format, index) {\n    return listWeekdaysImpl(localeSorted, format, index, 'weekdaysShort');\n}\n\nfunction listWeekdaysMin (localeSorted, format, index) {\n    return listWeekdaysImpl(localeSorted, format, index, 'weekdaysMin');\n}\n\ngetSetGlobalLocale('en', {\n    dayOfMonthOrdinalParse: /\\d{1,2}(th|st|nd|rd)/,\n    ordinal : function (number) {\n        var b = number % 10,\n            output = (toInt(number % 100 / 10) === 1) ? 'th' :\n            (b === 1) ? 'st' :\n            (b === 2) ? 'nd' :\n            (b === 3) ? 'rd' : 'th';\n        return number + output;\n    }\n});\n\n// Side effect imports\nhooks.lang = deprecate('moment.lang is deprecated. Use moment.locale instead.', getSetGlobalLocale);\nhooks.langData = deprecate('moment.langData is deprecated. Use moment.localeData instead.', getLocale);\n\nvar mathAbs = Math.abs;\n\nfunction abs () {\n    var data           = this._data;\n\n    this._milliseconds = mathAbs(this._milliseconds);\n    this._days         = mathAbs(this._days);\n    this._months       = mathAbs(this._months);\n\n    data.milliseconds  = mathAbs(data.milliseconds);\n    data.seconds       = mathAbs(data.seconds);\n    data.minutes       = mathAbs(data.minutes);\n    data.hours         = mathAbs(data.hours);\n    data.months        = mathAbs(data.months);\n    data.years         = mathAbs(data.years);\n\n    return this;\n}\n\nfunction addSubtract$1 (duration, input, value, direction) {\n    var other = createDuration(input, value);\n\n    duration._milliseconds += direction * other._milliseconds;\n    duration._days         += direction * other._days;\n    duration._months       += direction * other._months;\n\n    return duration._bubble();\n}\n\n// supports only 2.0-style add(1, 's') or add(duration)\nfunction add$1 (input, value) {\n    return addSubtract$1(this, input, value, 1);\n}\n\n// supports only 2.0-style subtract(1, 's') or subtract(duration)\nfunction subtract$1 (input, value) {\n    return addSubtract$1(this, input, value, -1);\n}\n\nfunction absCeil (number) {\n    if (number < 0) {\n        return Math.floor(number);\n    } else {\n        return Math.ceil(number);\n    }\n}\n\nfunction bubble () {\n    var milliseconds = this._milliseconds;\n    var days         = this._days;\n    var months       = this._months;\n    var data         = this._data;\n    var seconds, minutes, hours, years, monthsFromDays;\n\n    // if we have a mix of positive and negative values, bubble down first\n    // check: https://github.com/moment/moment/issues/2166\n    if (!((milliseconds >= 0 && days >= 0 && months >= 0) ||\n            (milliseconds <= 0 && days <= 0 && months <= 0))) {\n        milliseconds += absCeil(monthsToDays(months) + days) * 864e5;\n        days = 0;\n        months = 0;\n    }\n\n    // The following code bubbles up values, see the tests for\n    // examples of what that means.\n    data.milliseconds = milliseconds % 1000;\n\n    seconds           = absFloor(milliseconds / 1000);\n    data.seconds      = seconds % 60;\n\n    minutes           = absFloor(seconds / 60);\n    data.minutes      = minutes % 60;\n\n    hours             = absFloor(minutes / 60);\n    data.hours        = hours % 24;\n\n    days += absFloor(hours / 24);\n\n    // convert days to months\n    monthsFromDays = absFloor(daysToMonths(days));\n    months += monthsFromDays;\n    days -= absCeil(monthsToDays(monthsFromDays));\n\n    // 12 months -> 1 year\n    years = absFloor(months / 12);\n    months %= 12;\n\n    data.days   = days;\n    data.months = months;\n    data.years  = years;\n\n    return this;\n}\n\nfunction daysToMonths (days) {\n    // 400 years have 146097 days (taking into account leap year rules)\n    // 400 years have 12 months === 4800\n    return days * 4800 / 146097;\n}\n\nfunction monthsToDays (months) {\n    // the reverse of daysToMonths\n    return months * 146097 / 4800;\n}\n\nfunction as (units) {\n    if (!this.isValid()) {\n        return NaN;\n    }\n    var days;\n    var months;\n    var milliseconds = this._milliseconds;\n\n    units = normalizeUnits(units);\n\n    if (units === 'month' || units === 'year') {\n        days   = this._days   + milliseconds / 864e5;\n        months = this._months + daysToMonths(days);\n        return units === 'month' ? months : months / 12;\n    } else {\n        // handle milliseconds separately because of floating point math errors (issue #1867)\n        days = this._days + Math.round(monthsToDays(this._months));\n        switch (units) {\n            case 'week'   : return days / 7     + milliseconds / 6048e5;\n            case 'day'    : return days         + milliseconds / 864e5;\n            case 'hour'   : return days * 24    + milliseconds / 36e5;\n            case 'minute' : return days * 1440  + milliseconds / 6e4;\n            case 'second' : return days * 86400 + milliseconds / 1000;\n            // Math.floor prevents floating point math errors here\n            case 'millisecond': return Math.floor(days * 864e5) + milliseconds;\n            default: throw new Error('Unknown unit ' + units);\n        }\n    }\n}\n\n// TODO: Use this.as('ms')?\nfunction valueOf$1 () {\n    if (!this.isValid()) {\n        return NaN;\n    }\n    return (\n        this._milliseconds +\n        this._days * 864e5 +\n        (this._months % 12) * 2592e6 +\n        toInt(this._months / 12) * 31536e6\n    );\n}\n\nfunction makeAs (alias) {\n    return function () {\n        return this.as(alias);\n    };\n}\n\nvar asMilliseconds = makeAs('ms');\nvar asSeconds      = makeAs('s');\nvar asMinutes      = makeAs('m');\nvar asHours        = makeAs('h');\nvar asDays         = makeAs('d');\nvar asWeeks        = makeAs('w');\nvar asMonths       = makeAs('M');\nvar asYears        = makeAs('y');\n\nfunction get$2 (units) {\n    units = normalizeUnits(units);\n    return this.isValid() ? this[units + 's']() : NaN;\n}\n\nfunction makeGetter(name) {\n    return function () {\n        return this.isValid() ? this._data[name] : NaN;\n    };\n}\n\nvar milliseconds = makeGetter('milliseconds');\nvar seconds      = makeGetter('seconds');\nvar minutes      = makeGetter('minutes');\nvar hours        = makeGetter('hours');\nvar days         = makeGetter('days');\nvar months       = makeGetter('months');\nvar years        = makeGetter('years');\n\nfunction weeks () {\n    return absFloor(this.days() / 7);\n}\n\nvar round = Math.round;\nvar thresholds = {\n    ss: 44,         // a few seconds to seconds\n    s : 45,         // seconds to minute\n    m : 45,         // minutes to hour\n    h : 22,         // hours to day\n    d : 26,         // days to month\n    M : 11          // months to year\n};\n\n// helper function for moment.fn.from, moment.fn.fromNow, and moment.duration.fn.humanize\nfunction substituteTimeAgo(string, number, withoutSuffix, isFuture, locale) {\n    return locale.relativeTime(number || 1, !!withoutSuffix, string, isFuture);\n}\n\nfunction relativeTime$1 (posNegDuration, withoutSuffix, locale) {\n    var duration = createDuration(posNegDuration).abs();\n    var seconds  = round(duration.as('s'));\n    var minutes  = round(duration.as('m'));\n    var hours    = round(duration.as('h'));\n    var days     = round(duration.as('d'));\n    var months   = round(duration.as('M'));\n    var years    = round(duration.as('y'));\n\n    var a = seconds <= thresholds.ss && ['s', seconds]  ||\n            seconds < thresholds.s   && ['ss', seconds] ||\n            minutes <= 1             && ['m']           ||\n            minutes < thresholds.m   && ['mm', minutes] ||\n            hours   <= 1             && ['h']           ||\n            hours   < thresholds.h   && ['hh', hours]   ||\n            days    <= 1             && ['d']           ||\n            days    < thresholds.d   && ['dd', days]    ||\n            months  <= 1             && ['M']           ||\n            months  < thresholds.M   && ['MM', months]  ||\n            years   <= 1             && ['y']           || ['yy', years];\n\n    a[2] = withoutSuffix;\n    a[3] = +posNegDuration > 0;\n    a[4] = locale;\n    return substituteTimeAgo.apply(null, a);\n}\n\n// This function allows you to set the rounding function for relative time strings\nfunction getSetRelativeTimeRounding (roundingFunction) {\n    if (roundingFunction === undefined) {\n        return round;\n    }\n    if (typeof(roundingFunction) === 'function') {\n        round = roundingFunction;\n        return true;\n    }\n    return false;\n}\n\n// This function allows you to set a threshold for relative time strings\nfunction getSetRelativeTimeThreshold (threshold, limit) {\n    if (thresholds[threshold] === undefined) {\n        return false;\n    }\n    if (limit === undefined) {\n        return thresholds[threshold];\n    }\n    thresholds[threshold] = limit;\n    if (threshold === 's') {\n        thresholds.ss = limit - 1;\n    }\n    return true;\n}\n\nfunction humanize (withSuffix) {\n    if (!this.isValid()) {\n        return this.localeData().invalidDate();\n    }\n\n    var locale = this.localeData();\n    var output = relativeTime$1(this, !withSuffix, locale);\n\n    if (withSuffix) {\n        output = locale.pastFuture(+this, output);\n    }\n\n    return locale.postformat(output);\n}\n\nvar abs$1 = Math.abs;\n\nfunction toISOString$1() {\n    // for ISO strings we do not use the normal bubbling rules:\n    //  * milliseconds bubble up until they become hours\n    //  * days do not bubble at all\n    //  * months bubble up until they become years\n    // This is because there is no context-free conversion between hours and days\n    // (think of clock changes)\n    // and also not between days and months (28-31 days per month)\n    if (!this.isValid()) {\n        return this.localeData().invalidDate();\n    }\n\n    var seconds = abs$1(this._milliseconds) / 1000;\n    var days         = abs$1(this._days);\n    var months       = abs$1(this._months);\n    var minutes, hours, years;\n\n    // 3600 seconds -> 60 minutes -> 1 hour\n    minutes           = absFloor(seconds / 60);\n    hours             = absFloor(minutes / 60);\n    seconds %= 60;\n    minutes %= 60;\n\n    // 12 months -> 1 year\n    years  = absFloor(months / 12);\n    months %= 12;\n\n\n    // inspired by https://github.com/dordille/moment-isoduration/blob/master/moment.isoduration.js\n    var Y = years;\n    var M = months;\n    var D = days;\n    var h = hours;\n    var m = minutes;\n    var s = seconds;\n    var total = this.asSeconds();\n\n    if (!total) {\n        // this is the same as C#'s (Noda) and python (isodate)...\n        // but not other JS (goog.date)\n        return 'P0D';\n    }\n\n    return (total < 0 ? '-' : '') +\n        'P' +\n        (Y ? Y + 'Y' : '') +\n        (M ? M + 'M' : '') +\n        (D ? D + 'D' : '') +\n        ((h || m || s) ? 'T' : '') +\n        (h ? h + 'H' : '') +\n        (m ? m + 'M' : '') +\n        (s ? s + 'S' : '');\n}\n\nvar proto$2 = Duration.prototype;\n\nproto$2.isValid        = isValid$1;\nproto$2.abs            = abs;\nproto$2.add            = add$1;\nproto$2.subtract       = subtract$1;\nproto$2.as             = as;\nproto$2.asMilliseconds = asMilliseconds;\nproto$2.asSeconds      = asSeconds;\nproto$2.asMinutes      = asMinutes;\nproto$2.asHours        = asHours;\nproto$2.asDays         = asDays;\nproto$2.asWeeks        = asWeeks;\nproto$2.asMonths       = asMonths;\nproto$2.asYears        = asYears;\nproto$2.valueOf        = valueOf$1;\nproto$2._bubble        = bubble;\nproto$2.get            = get$2;\nproto$2.milliseconds   = milliseconds;\nproto$2.seconds        = seconds;\nproto$2.minutes        = minutes;\nproto$2.hours          = hours;\nproto$2.days           = days;\nproto$2.weeks          = weeks;\nproto$2.months         = months;\nproto$2.years          = years;\nproto$2.humanize       = humanize;\nproto$2.toISOString    = toISOString$1;\nproto$2.toString       = toISOString$1;\nproto$2.toJSON         = toISOString$1;\nproto$2.locale         = locale;\nproto$2.localeData     = localeData;\n\n// Deprecations\nproto$2.toIsoString = deprecate('toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)', toISOString$1);\nproto$2.lang = lang;\n\n// Side effect imports\n\n// FORMATTING\n\naddFormatToken('X', 0, 0, 'unix');\naddFormatToken('x', 0, 0, 'valueOf');\n\n// PARSING\n\naddRegexToken('x', matchSigned);\naddRegexToken('X', matchTimestamp);\naddParseToken('X', function (input, array, config) {\n    config._d = new Date(parseFloat(input, 10) * 1000);\n});\naddParseToken('x', function (input, array, config) {\n    config._d = new Date(toInt(input));\n});\n\n// Side effect imports\n\n\nhooks.version = '2.18.1';\n\nsetHookCallback(createLocal);\n\nhooks.fn                    = proto;\nhooks.min                   = min;\nhooks.max                   = max;\nhooks.now                   = now;\nhooks.utc                   = createUTC;\nhooks.unix                  = createUnix;\nhooks.months                = listMonths;\nhooks.isDate                = isDate;\nhooks.locale                = getSetGlobalLocale;\nhooks.invalid               = createInvalid;\nhooks.duration              = createDuration;\nhooks.isMoment              = isMoment;\nhooks.weekdays              = listWeekdays;\nhooks.parseZone             = createInZone;\nhooks.localeData            = getLocale;\nhooks.isDuration            = isDuration;\nhooks.monthsShort           = listMonthsShort;\nhooks.weekdaysMin           = listWeekdaysMin;\nhooks.defineLocale          = defineLocale;\nhooks.updateLocale          = updateLocale;\nhooks.locales               = listLocales;\nhooks.weekdaysShort         = listWeekdaysShort;\nhooks.normalizeUnits        = normalizeUnits;\nhooks.relativeTimeRounding = getSetRelativeTimeRounding;\nhooks.relativeTimeThreshold = getSetRelativeTimeThreshold;\nhooks.calendarFormat        = getCalendarFormat;\nhooks.prototype             = proto;\n\nreturn hooks;\n\n})));\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\n/**\n * This is a helper function for getting values from parameter/options\n * objects.\n *\n * @param args The object we are extracting values from\n * @param name The name of the property we are getting.\n * @param defaultValue An optional value to return if the property is missing\n * from the object. If this is not specified and the property is missing, an\n * error will be thrown.\n */\nfunction getArg(aArgs, aName, aDefaultValue) {\n  if (aName in aArgs) {\n    return aArgs[aName];\n  } else if (arguments.length === 3) {\n    return aDefaultValue;\n  } else {\n    throw new Error('\"' + aName + '\" is a required argument.');\n  }\n}\nexports.getArg = getArg;\n\nvar urlRegexp = /^(?:([\\w+\\-.]+):)?\\/\\/(?:(\\w+:\\w+)@)?([\\w.]*)(?::(\\d+))?(\\S*)$/;\nvar dataUrlRegexp = /^data:.+\\,.+$/;\n\nfunction urlParse(aUrl) {\n  var match = aUrl.match(urlRegexp);\n  if (!match) {\n    return null;\n  }\n  return {\n    scheme: match[1],\n    auth: match[2],\n    host: match[3],\n    port: match[4],\n    path: match[5]\n  };\n}\nexports.urlParse = urlParse;\n\nfunction urlGenerate(aParsedUrl) {\n  var url = '';\n  if (aParsedUrl.scheme) {\n    url += aParsedUrl.scheme + ':';\n  }\n  url += '//';\n  if (aParsedUrl.auth) {\n    url += aParsedUrl.auth + '@';\n  }\n  if (aParsedUrl.host) {\n    url += aParsedUrl.host;\n  }\n  if (aParsedUrl.port) {\n    url += \":\" + aParsedUrl.port\n  }\n  if (aParsedUrl.path) {\n    url += aParsedUrl.path;\n  }\n  return url;\n}\nexports.urlGenerate = urlGenerate;\n\n/**\n * Normalizes a path, or the path portion of a URL:\n *\n * - Replaces consecutive slashes with one slash.\n * - Removes unnecessary '.' parts.\n * - Removes unnecessary '<dir>/..' parts.\n *\n * Based on code in the Node.js 'path' core module.\n *\n * @param aPath The path or url to normalize.\n */\nfunction normalize(aPath) {\n  var path = aPath;\n  var url = urlParse(aPath);\n  if (url) {\n    if (!url.path) {\n      return aPath;\n    }\n    path = url.path;\n  }\n  var isAbsolute = exports.isAbsolute(path);\n\n  var parts = path.split(/\\/+/);\n  for (var part, up = 0, i = parts.length - 1; i >= 0; i--) {\n    part = parts[i];\n    if (part === '.') {\n      parts.splice(i, 1);\n    } else if (part === '..') {\n      up++;\n    } else if (up > 0) {\n      if (part === '') {\n        // The first part is blank if the path is absolute. Trying to go\n        // above the root is a no-op. Therefore we can remove all '..' parts\n        // directly after the root.\n        parts.splice(i + 1, up);\n        up = 0;\n      } else {\n        parts.splice(i, 2);\n        up--;\n      }\n    }\n  }\n  path = parts.join('/');\n\n  if (path === '') {\n    path = isAbsolute ? '/' : '.';\n  }\n\n  if (url) {\n    url.path = path;\n    return urlGenerate(url);\n  }\n  return path;\n}\nexports.normalize = normalize;\n\n/**\n * Joins two paths/URLs.\n *\n * @param aRoot The root path or URL.\n * @param aPath The path or URL to be joined with the root.\n *\n * - If aPath is a URL or a data URI, aPath is returned, unless aPath is a\n *   scheme-relative URL: Then the scheme of aRoot, if any, is prepended\n *   first.\n * - Otherwise aPath is a path. If aRoot is a URL, then its path portion\n *   is updated with the result and aRoot is returned. Otherwise the result\n *   is returned.\n *   - If aPath is absolute, the result is aPath.\n *   - Otherwise the two paths are joined with a slash.\n * - Joining for example 'http://' and 'www.example.com' is also supported.\n */\nfunction join(aRoot, aPath) {\n  if (aRoot === \"\") {\n    aRoot = \".\";\n  }\n  if (aPath === \"\") {\n    aPath = \".\";\n  }\n  var aPathUrl = urlParse(aPath);\n  var aRootUrl = urlParse(aRoot);\n  if (aRootUrl) {\n    aRoot = aRootUrl.path || '/';\n  }\n\n  // `join(foo, '//www.example.org')`\n  if (aPathUrl && !aPathUrl.scheme) {\n    if (aRootUrl) {\n      aPathUrl.scheme = aRootUrl.scheme;\n    }\n    return urlGenerate(aPathUrl);\n  }\n\n  if (aPathUrl || aPath.match(dataUrlRegexp)) {\n    return aPath;\n  }\n\n  // `join('http://', 'www.example.com')`\n  if (aRootUrl && !aRootUrl.host && !aRootUrl.path) {\n    aRootUrl.host = aPath;\n    return urlGenerate(aRootUrl);\n  }\n\n  var joined = aPath.charAt(0) === '/'\n    ? aPath\n    : normalize(aRoot.replace(/\\/+$/, '') + '/' + aPath);\n\n  if (aRootUrl) {\n    aRootUrl.path = joined;\n    return urlGenerate(aRootUrl);\n  }\n  return joined;\n}\nexports.join = join;\n\nexports.isAbsolute = function (aPath) {\n  return aPath.charAt(0) === '/' || !!aPath.match(urlRegexp);\n};\n\n/**\n * Make a path relative to a URL or another path.\n *\n * @param aRoot The root path or URL.\n * @param aPath The path or URL to be made relative to aRoot.\n */\nfunction relative(aRoot, aPath) {\n  if (aRoot === \"\") {\n    aRoot = \".\";\n  }\n\n  aRoot = aRoot.replace(/\\/$/, '');\n\n  // It is possible for the path to be above the root. In this case, simply\n  // checking whether the root is a prefix of the path won't work. Instead, we\n  // need to remove components from the root one by one, until either we find\n  // a prefix that fits, or we run out of components to remove.\n  var level = 0;\n  while (aPath.indexOf(aRoot + '/') !== 0) {\n    var index = aRoot.lastIndexOf(\"/\");\n    if (index < 0) {\n      return aPath;\n    }\n\n    // If the only part of the root that is left is the scheme (i.e. http://,\n    // file:///, etc.), one or more slashes (/), or simply nothing at all, we\n    // have exhausted all components, so the path is not relative to the root.\n    aRoot = aRoot.slice(0, index);\n    if (aRoot.match(/^([^\\/]+:\\/)?\\/*$/)) {\n      return aPath;\n    }\n\n    ++level;\n  }\n\n  // Make sure we add a \"../\" for each component we removed from the root.\n  return Array(level + 1).join(\"../\") + aPath.substr(aRoot.length + 1);\n}\nexports.relative = relative;\n\nvar supportsNullProto = (function () {\n  var obj = Object.create(null);\n  return !('__proto__' in obj);\n}());\n\nfunction identity (s) {\n  return s;\n}\n\n/**\n * Because behavior goes wacky when you set `__proto__` on objects, we\n * have to prefix all the strings in our set with an arbitrary character.\n *\n * See https://github.com/mozilla/source-map/pull/31 and\n * https://github.com/mozilla/source-map/issues/30\n *\n * @param String aStr\n */\nfunction toSetString(aStr) {\n  if (isProtoString(aStr)) {\n    return '$' + aStr;\n  }\n\n  return aStr;\n}\nexports.toSetString = supportsNullProto ? identity : toSetString;\n\nfunction fromSetString(aStr) {\n  if (isProtoString(aStr)) {\n    return aStr.slice(1);\n  }\n\n  return aStr;\n}\nexports.fromSetString = supportsNullProto ? identity : fromSetString;\n\nfunction isProtoString(s) {\n  if (!s) {\n    return false;\n  }\n\n  var length = s.length;\n\n  if (length < 9 /* \"__proto__\".length */) {\n    return false;\n  }\n\n  if (s.charCodeAt(length - 1) !== 95  /* '_' */ ||\n      s.charCodeAt(length - 2) !== 95  /* '_' */ ||\n      s.charCodeAt(length - 3) !== 111 /* 'o' */ ||\n      s.charCodeAt(length - 4) !== 116 /* 't' */ ||\n      s.charCodeAt(length - 5) !== 111 /* 'o' */ ||\n      s.charCodeAt(length - 6) !== 114 /* 'r' */ ||\n      s.charCodeAt(length - 7) !== 112 /* 'p' */ ||\n      s.charCodeAt(length - 8) !== 95  /* '_' */ ||\n      s.charCodeAt(length - 9) !== 95  /* '_' */) {\n    return false;\n  }\n\n  for (var i = length - 10; i >= 0; i--) {\n    if (s.charCodeAt(i) !== 36 /* '$' */) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Comparator between two mappings where the original positions are compared.\n *\n * Optionally pass in `true` as `onlyCompareGenerated` to consider two\n * mappings with the same original source/line/column, but different generated\n * line and column the same. Useful when searching for a mapping with a\n * stubbed out mapping.\n */\nfunction compareByOriginalPositions(mappingA, mappingB, onlyCompareOriginal) {\n  var cmp = mappingA.source - mappingB.source;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalLine - mappingB.originalLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalColumn - mappingB.originalColumn;\n  if (cmp !== 0 || onlyCompareOriginal) {\n    return cmp;\n  }\n\n  cmp = mappingA.generatedColumn - mappingB.generatedColumn;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.generatedLine - mappingB.generatedLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  return mappingA.name - mappingB.name;\n}\nexports.compareByOriginalPositions = compareByOriginalPositions;\n\n/**\n * Comparator between two mappings with deflated source and name indices where\n * the generated positions are compared.\n *\n * Optionally pass in `true` as `onlyCompareGenerated` to consider two\n * mappings with the same generated line and column, but different\n * source/name/original line and column the same. Useful when searching for a\n * mapping with a stubbed out mapping.\n */\nfunction compareByGeneratedPositionsDeflated(mappingA, mappingB, onlyCompareGenerated) {\n  var cmp = mappingA.generatedLine - mappingB.generatedLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.generatedColumn - mappingB.generatedColumn;\n  if (cmp !== 0 || onlyCompareGenerated) {\n    return cmp;\n  }\n\n  cmp = mappingA.source - mappingB.source;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalLine - mappingB.originalLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalColumn - mappingB.originalColumn;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  return mappingA.name - mappingB.name;\n}\nexports.compareByGeneratedPositionsDeflated = compareByGeneratedPositionsDeflated;\n\nfunction strcmp(aStr1, aStr2) {\n  if (aStr1 === aStr2) {\n    return 0;\n  }\n\n  if (aStr1 > aStr2) {\n    return 1;\n  }\n\n  return -1;\n}\n\n/**\n * Comparator between two mappings with inflated source and name strings where\n * the generated positions are compared.\n */\nfunction compareByGeneratedPositionsInflated(mappingA, mappingB) {\n  var cmp = mappingA.generatedLine - mappingB.generatedLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.generatedColumn - mappingB.generatedColumn;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = strcmp(mappingA.source, mappingB.source);\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalLine - mappingB.originalLine;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  cmp = mappingA.originalColumn - mappingB.originalColumn;\n  if (cmp !== 0) {\n    return cmp;\n  }\n\n  return strcmp(mappingA.name, mappingB.name);\n}\nexports.compareByGeneratedPositionsInflated = compareByGeneratedPositionsInflated;\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = function (recalc) {\n  if (!size || recalc) {\n    if (_inDOM2.default) {\n      var scrollDiv = document.createElement('div');\n\n      scrollDiv.style.position = 'absolute';\n      scrollDiv.style.top = '-9999px';\n      scrollDiv.style.width = '50px';\n      scrollDiv.style.height = '50px';\n      scrollDiv.style.overflow = 'scroll';\n\n      document.body.appendChild(scrollDiv);\n      size = scrollDiv.offsetWidth - scrollDiv.clientWidth;\n      document.body.removeChild(scrollDiv);\n    }\n  }\n\n  return size;\n};\n\nvar _inDOM = require('./inDOM');\n\nvar _inDOM2 = _interopRequireDefault(_inDOM);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar size = void 0;\n\nmodule.exports = exports['default'];","\"use strict\";\n\nexports.__esModule = true;\n\nvar _defineProperty = require(\"../core-js/object/define-property\");\n\nvar _defineProperty2 = _interopRequireDefault(_defineProperty);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function (obj, key, value) {\n  if (key in obj) {\n    (0, _defineProperty2.default)(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n};","import Dexie from 'dexie'\n\nexport abstract class BaseDatabase extends Dexie {\n  private schemaVersion: number | undefined\n\n  public constructor(name: string, schemaVersion: number | undefined) {\n    super(name)\n\n    this.schemaVersion = schemaVersion\n  }\n\n  /**\n   * Register the version of the schema only if `targetVersion` is less than\n   * `version` or is `undefined`.\n   *\n   * targetVersion - The version of the schema that is being targetted. If not\n   *                 provided, the given version will be registered.\n   * version       - The version being registered.\n   * schema        - The schema to register.\n   * upgrade       - An upgrade function to call after upgrading to the given\n   *                 version.\n   */\n  protected async conditionalVersion(\n    version: number,\n    schema: { [key: string]: string | null },\n    upgrade?: (t: Dexie.Transaction) => Promise<void>\n  ) {\n    if (this.schemaVersion != null && this.schemaVersion < version) {\n      return\n    }\n\n    const dexieVersion = this.version(version).stores(schema)\n\n    if (upgrade != null) {\n      await dexieVersion.upgrade(upgrade)\n    }\n  }\n}\n","import * as React from 'react'\nimport { Row } from './row'\nimport { Button } from './button'\n\ninterface ICallToActionProps {\n  /** The action title. */\n  readonly actionTitle: string\n\n  /** The function to call when the user clicks the action button. */\n  readonly onAction: () => void\n}\n\n/**\n * A call-to-action component which displays its children as the message\n * followed by an action button.\n */\nexport class CallToAction extends React.Component<ICallToActionProps, {}> {\n  public render() {\n    return (\n      <Row className=\"call-to-action\">\n        {this.props.children}\n        <Button className=\"action-button\" type=\"submit\" onClick={this.onClick}>\n          {this.props.actionTitle}\n        </Button>\n      </Row>\n    )\n  }\n\n  private onClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n    event.preventDefault()\n\n    this.props.onAction()\n  }\n}\n","export { StatsDatabase, ILaunchStats } from './stats-database'\nexport { StatsStore, SamplesURL } from './stats-store'\nexport { getGUID } from './get-guid'\n","export * from './shared'\nexport { ShellError } from './error'\n","import { Repository } from '../models/repository'\nimport { CloneOptions } from './git/clone'\n\n/** The types of actions that can be retried. */\nexport enum RetryActionType {\n  Push = 1,\n  Pull,\n  Fetch,\n  Clone,\n}\n\n/** The retriable actions and their associated data. */\nexport type RetryAction =\n  | { type: RetryActionType.Push; repository: Repository }\n  | { type: RetryActionType.Pull; repository: Repository }\n  | { type: RetryActionType.Fetch; repository: Repository }\n  | {\n      type: RetryActionType.Clone\n      url: string\n      path: string\n      options: CloneOptions\n    }\n","import * as Darwin from './darwin'\nimport * as Win32 from './win32'\nimport * as Linux from './linux'\n\nexport type ExternalEditor = Darwin.ExternalEditor | Win32.ExternalEditor\n\n/** Parse the label into the specified shell type. */\nexport function parse(label: string): ExternalEditor | null {\n  if (__DARWIN__) {\n    return Darwin.parse(label)\n  } else if (__WIN32__) {\n    return Win32.parse(label)\n  } else if (__LINUX__) {\n    return Linux.parse(label)\n  }\n\n  throw new Error(\n    `Platform not currently supported for resolving editors: ${\n      process.platform\n    }`\n  )\n}\n\n/**\n * A found external editor on the user's machine\n */\nexport type FoundEditor = {\n  /**\n   * The friendly name of the editor, to be used in labels\n   */\n  editor: ExternalEditor\n  /**\n   * The executable associated with the editor to launch\n   */\n  path: string\n}\n\ninterface IErrorMetadata {\n  /** The error dialog should link off to the Atom website */\n  suggestAtom?: boolean\n\n  /** The error dialog should direct the user to open Preferences */\n  openPreferences?: boolean\n}\n\nexport class ExternalEditorError extends Error {\n  /** The error's metadata. */\n  public readonly metadata: IErrorMetadata\n\n  public constructor(message: string, metadata: IErrorMetadata = {}) {\n    super(message)\n\n    this.metadata = metadata\n  }\n}\n","/**\n * Enum used by fetch to determine if\n * a fetch was initiated by the backgroundFetcher\n */\nexport enum FetchType {\n  BackgroundTask,\n  UserInitiatedTask,\n}\n","import * as React from 'react'\nimport { Octicon, OcticonSymbol } from '../octicons'\nimport * as classNames from 'classnames'\nimport { assertNever } from '../../lib/fatal-error'\nimport { Button } from '../lib/button'\nimport { clamp } from '../../lib/clamp'\n\n/** The button style. */\nexport enum ToolbarButtonStyle {\n  /** The default style with the description above the title. */\n  Standard,\n\n  /** A style in which the description is below the title. */\n  Subtitle,\n}\n\nexport interface IToolbarButtonProps {\n  /** The primary button text, describing its function */\n  readonly title?: string\n\n  /** An optional description of the function of the button */\n  readonly description?: JSX.Element | string\n\n  /** The tooltip for the button. */\n  readonly tooltip?: string\n\n  /** An optional symbol to be displayed next to the button text */\n  readonly icon?: OcticonSymbol\n\n  /** The class name for the icon element. */\n  readonly iconClassName?: string\n\n  /**\n   * An optional event handler for when the button is activated\n   * by a pointer event or by hitting space/enter while focused.\n   */\n  readonly onClick?: (event: React.MouseEvent<HTMLButtonElement>) => void\n\n  /**\n   * A function that's called when the user hovers over the button with\n   * a pointer device.\n   */\n  readonly onMouseEnter?: (event: React.MouseEvent<HTMLButtonElement>) => void\n\n  /**\n   * A function that's called when a key event is received from the\n   * ToolbarButton component or any of its descendants.\n   */\n  readonly onKeyDown?: (event: React.KeyboardEvent<HTMLDivElement>) => void\n\n  /**\n   * An optional classname that will be appended to the default\n   * class name 'toolbar-button'\n   */\n  readonly className?: string\n\n  /** The button's style. Defaults to `ToolbarButtonStyle.Standard`. */\n  readonly style?: ToolbarButtonStyle\n\n  /** Whether the button's disabled. Defaults to false. */\n  readonly disabled?: boolean\n\n  /**\n   * The tab index of the button element.\n   *\n   * A value of 'undefined' means that whether or not the element participates\n   * in sequential keyboard navigation is left to the user agent's default\n   * settings.\n   *\n   * A negative value means that the element can receive focus but not\n   * through sequential keyboard navigation (i.e. only via programmatic\n   * focus)\n   *\n   * A value of zero means that the element can receive focus through\n   * sequential keyboard navigation and that the order should be determined\n   * by the element's position in the DOM.\n   *\n   * A positive value means that the element can receive focus through\n   * sequential keyboard navigation and that it should have the explicit\n   * order provided and not have it be determined by its position in the DOM.\n   *\n   * Note: A positive value should be avoided if at all possible as it's\n   * detrimental to accessibility in most scenarios.\n   */\n  readonly tabIndex?: number\n\n  /**\n   * An optional progress value as a fraction between 0 and 1. Passing a number\n   * greater than zero will render a progress bar background in the toolbar\n   * button. Use this to communicate an ongoing operation.\n   *\n   * Consumers should not rely solely on the visual progress bar, they should\n   * also implement alternative representation such as showing a percentage\n   * text in the description or title along with information about what\n   * operation is currently in flight.\n   */\n  readonly progressValue?: number\n\n  readonly role?: string\n  readonly ariaExpanded?: boolean\n}\n\n/**\n * A general purpose toolbar button\n */\nexport class ToolbarButton extends React.Component<IToolbarButtonProps, {}> {\n  public innerButton: Button | null = null\n\n  private onClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n    if (this.props.onClick) {\n      this.props.onClick(event)\n    }\n  }\n\n  private onButtonRef = (ref: Button | null) => {\n    this.innerButton = ref\n  }\n\n  /**\n   * Programmatically move keyboard focus to the button element.\n   */\n  public focusButton = () => {\n    if (this.innerButton) {\n      this.innerButton.focus()\n    }\n  }\n\n  /**\n   * Get the client bounding box for the button element.\n   * Returns undefined if the button hasn't been mounted yet.\n   */\n  public getButtonBoundingClientRect = (): ClientRect | undefined => {\n    return this.innerButton\n      ? this.innerButton.getBoundingClientRect()\n      : undefined\n  }\n\n  public render() {\n    const icon = this.props.icon ? (\n      <Octicon\n        symbol={this.props.icon}\n        className={classNames('icon', this.props.iconClassName)}\n      />\n    ) : null\n\n    const className = classNames(\n      'toolbar-button',\n      { 'has-progress': this.props.progressValue !== undefined },\n      this.props.className\n    )\n\n    const progressValue =\n      this.props.progressValue !== undefined\n        ? Math.round(clamp(this.props.progressValue, 0, 1) * 100) / 100\n        : undefined\n\n    const progress =\n      progressValue !== undefined ? (\n        <div\n          className=\"progress\"\n          style={{ transform: `scaleX(${progressValue})` }}\n        />\n      ) : (\n        undefined\n      )\n\n    return (\n      <div\n        className={className}\n        onKeyDown={this.props.onKeyDown}\n        title={this.props.tooltip}\n      >\n        <Button\n          onClick={this.onClick}\n          ref={this.onButtonRef}\n          disabled={this.props.disabled}\n          onMouseEnter={this.props.onMouseEnter}\n          tabIndex={this.props.tabIndex}\n          role={this.props.role}\n          ariaExpanded={this.props.ariaExpanded}\n        >\n          {progress}\n          {icon}\n          {this.renderText()}\n          {this.props.children}\n        </Button>\n      </div>\n    )\n  }\n\n  private renderText() {\n    if (\n      this.props.title === undefined &&\n      this.props.description === undefined\n    ) {\n      return null\n    }\n\n    const title =\n      this.props.title !== undefined ? (\n        <div className=\"title\">{this.props.title}</div>\n      ) : null\n\n    const description =\n      this.props.description !== undefined ? (\n        <div className=\"description\">{this.props.description}</div>\n      ) : null\n\n    const style = this.props.style || ToolbarButtonStyle.Standard\n    switch (style) {\n      case ToolbarButtonStyle.Standard:\n        return (\n          <div className=\"text\">\n            {description}\n            {title}\n          </div>\n        )\n\n      case ToolbarButtonStyle.Subtitle:\n        return (\n          <div className=\"text\">\n            <div className=\"title\">{this.props.title}</div>\n            {description}\n          </div>\n        )\n\n      default:\n        return assertNever(style, `Unknown button style: ${style}`)\n    }\n  }\n}\n","export { PushBranchCommits } from './push-branch-commits'\nexport { BranchList } from './branch-list'\nexport { BranchesContainer } from './branches-container'\nexport { PullRequestBadge } from './pull-request-badge'\nexport { groupBranches, IBranchListItem } from './group-branches'\nexport { BranchListItem } from './branch-list-item'\nexport { renderDefaultBranch } from './branch-renderer'\n","import { DiffLine, DiffHunk } from '../../models/diff'\n\n/**\n * Locate the diff hunk for the given (absolute) line number in the diff.\n */\nexport function diffHunkForIndex(\n  hunks: ReadonlyArray<DiffHunk>,\n  index: number\n): DiffHunk | null {\n  const hunk = hunks.find(h => {\n    return index >= h.unifiedDiffStart && index <= h.unifiedDiffEnd\n  })\n  return hunk || null\n}\n\n/**\n * Locate the diff line for the given (absolute) line number in the diff.\n */\nexport function diffLineForIndex(\n  hunks: ReadonlyArray<DiffHunk>,\n  index: number\n): DiffLine | null {\n  const hunk = diffHunkForIndex(hunks, index)\n  if (!hunk) {\n    return null\n  }\n\n  return hunk.lines[index - hunk.unifiedDiffStart] || null\n}\n\n/** Get the line number as represented in the diff text itself. */\nexport function lineNumberForDiffLine(\n  diffLine: DiffLine,\n  hunks: ReadonlyArray<DiffHunk>\n): number {\n  let lineOffset = 0\n  for (const hunk of hunks) {\n    const index = hunk.lines.indexOf(diffLine)\n    if (index > -1) {\n      return index + lineOffset\n    } else {\n      lineOffset += hunk.lines.length\n    }\n  }\n\n  return -1\n}\n\n/**\n * For the given row in the diff, determine the range of elements that\n * should be displayed as interactive, as a hunk is not granular enough\n */\nexport function findInteractiveDiffRange(\n  hunks: ReadonlyArray<DiffHunk>,\n  index: number\n): { start: number; end: number } | null {\n  const hunk = diffHunkForIndex(hunks, index)\n  if (!hunk) {\n    return null\n  }\n\n  const relativeIndex = index - hunk.unifiedDiffStart\n\n  let contextLineBeforeIndex: number | null = null\n  for (let i = relativeIndex - 1; i >= 0; i--) {\n    const line = hunk.lines[i]\n    if (!line.isIncludeableLine()) {\n      const startIndex = i + 1\n      contextLineBeforeIndex = hunk.unifiedDiffStart + startIndex\n      break\n    }\n  }\n\n  const start = contextLineBeforeIndex\n    ? contextLineBeforeIndex\n    : hunk.unifiedDiffStart + 1\n\n  let contextLineAfterIndex: number | null = null\n\n  for (let i = relativeIndex + 1; i < hunk.lines.length; i++) {\n    const line = hunk.lines[i]\n    if (!line.isIncludeableLine()) {\n      const endIndex = i - 1\n      contextLineAfterIndex = hunk.unifiedDiffStart + endIndex\n      break\n    }\n  }\n\n  const end = contextLineAfterIndex\n    ? contextLineAfterIndex\n    : hunk.unifiedDiffEnd\n\n  return { start, end }\n}\n","import * as React from 'react'\nimport * as moment from 'moment'\n\ninterface IRelativeTimeProps {\n  /**\n   * The date instance that will be used for calculating\n   * the relative time elapsed\n   */\n  readonly date: Date\n}\n\ninterface IRelativeTimeState {\n  readonly absoluteText: string\n  readonly relativeText: string\n}\n\nconst SECOND = 1000\nconst MINUTE = SECOND * 60\nconst HOUR = MINUTE * 60\nconst DAY = HOUR * 24\n\n// The maximum value that can be used in setInterval or\n// setTimeout without it overflowing (2 ^ 31 - 1). See\n//  http://stackoverflow.com/a/16314807\nconst MAX_INTERVAL = 2147483647\n\n/**\n * An auto-updating component rendering a relative time in human readable form.\n *\n * Example: 'just now', '4 minutes ago', '3 days ago'.\n *\n * For timestamps that are more than 7 days in the past the absolute\n * date is rendered instead.\n *\n * This component will automatically re-render when the relative time\n * changes by scheduling state changes at reasonable intervals.\n */\nexport class RelativeTime extends React.Component<\n  IRelativeTimeProps,\n  IRelativeTimeState\n> {\n  private timer: number | null = null\n\n  public constructor(props: IRelativeTimeProps) {\n    super(props)\n    this.state = { absoluteText: '', relativeText: '' }\n  }\n\n  private clearTimer() {\n    if (this.timer) {\n      window.clearTimeout(this.timer)\n      this.timer = null\n    }\n  }\n\n  private updateAndSchedule(\n    absoluteText: string,\n    relativeText: string,\n    timeout: number\n  ) {\n    this.clearTimer()\n    this.timer = window.setTimeout(\n      this.updateFromScheduler,\n      Math.min(timeout, MAX_INTERVAL)\n    )\n    this.setState({ absoluteText, relativeText })\n  }\n\n  private updateWithDate(date: Date) {\n    const then = moment(date)\n    const now = moment()\n    const diff = then.diff(now)\n    const duration = Math.abs(diff)\n    const absoluteText = then.format('LLLL')\n\n    // Future date, let's just show as absolute and reschedule. If it's less\n    // than a minute into the future we'll treat it as 'just now'.\n    if (diff > 0 && duration > MINUTE) {\n      this.updateAndSchedule(absoluteText, then.format('lll'), duration)\n    } else if (duration < MINUTE) {\n      this.updateAndSchedule(absoluteText, 'just now', MINUTE - duration)\n    } else if (duration < HOUR) {\n      this.updateAndSchedule(absoluteText, then.from(now), MINUTE)\n    } else if (duration < DAY) {\n      this.updateAndSchedule(absoluteText, then.from(now), HOUR)\n    } else if (duration < 7 * DAY) {\n      this.updateAndSchedule(absoluteText, then.from(now), 6 * HOUR)\n    } else {\n      this.setState({ absoluteText, relativeText: then.format('ll') })\n    }\n  }\n\n  private readonly updateFromScheduler = () => {\n    this.updateWithDate(this.props.date)\n  }\n\n  public componentWillReceiveProps(nextProps: IRelativeTimeProps) {\n    if (this.props.date !== nextProps.date) {\n      this.updateWithDate(nextProps.date)\n    }\n  }\n\n  public componentWillMount() {\n    this.updateWithDate(this.props.date)\n  }\n\n  public componentWillUnmount() {\n    this.clearTimer()\n  }\n\n  public shouldComponentUpdate(\n    nextProps: IRelativeTimeProps,\n    nextState: IRelativeTimeState\n  ) {\n    return (\n      nextProps.date !== this.props.date ||\n      nextState.absoluteText !== this.state.absoluteText ||\n      nextState.relativeText !== this.state.relativeText\n    )\n  }\n\n  public render() {\n    return (\n      <span title={this.state.absoluteText}>{this.state.relativeText}</span>\n    )\n  }\n}\n","import * as React from 'react'\n\nimport { LinkButton } from './link-button'\nimport { Repository } from '../../models/repository'\nimport { Tokenizer, TokenType } from '../../lib/text-token-parser'\nimport { assertNever } from '../../lib/fatal-error'\n\ninterface IRichTextProps {\n  readonly className?: string\n\n  /** A lookup of emoji characters to map to image resources */\n  readonly emoji: Map<string, string>\n\n  /** The raw text to inspect for things to highlight */\n  readonly text: string\n\n  /** Should URLs be rendered as clickable links. Default true. */\n  readonly renderUrlsAsLinks?: boolean\n\n  /**\n   * The repository to use as the source for URLs for the rich text.\n   *\n   * If not specified, or the repository is a non-GitHub repository,\n   * no link highlighting is performed.\n   */\n  readonly repository?: Repository\n}\n\n/**\n * A component which replaces any emoji shortcuts (e.g., :+1:) in its child text\n * with the appropriate image tag, and also highlights username and issue mentions\n * with hyperlink tags if it has a repository to read.\n */\nexport class RichText extends React.Component<IRichTextProps, {}> {\n  public render() {\n    const str = this.props.text\n\n    // If we've been given an empty string then return null so that we don't end\n    // up introducing an extra empty <span>.\n    if (!str.length) {\n      return null\n    }\n\n    const tokenizer = new Tokenizer(this.props.emoji, this.props.repository)\n\n    const elements = tokenizer.tokenize(str).map((token, index) => {\n      switch (token.kind) {\n        case TokenType.Emoji:\n          return (\n            <img\n              key={index}\n              alt={token.text}\n              className=\"emoji\"\n              src={token.path}\n            />\n          )\n        case TokenType.Link:\n          if (this.props.renderUrlsAsLinks !== false) {\n            return (\n              <LinkButton key={index} uri={token.url} children={token.text} />\n            )\n          } else {\n            return <span key={index}>{token.text}</span>\n          }\n        case TokenType.Text:\n          return <span key={index}>{token.text}</span>\n        default:\n          return assertNever(token, 'Unknown token type: ${r.kind}')\n      }\n    })\n\n    return (\n      <div className={this.props.className} title={str}>\n        {elements}\n      </div>\n    )\n  }\n}\n","const RestrictedFileExtensions = ['.cmd', '.exe', '.bat', '.sh']\nexport const DefaultEditorLabel = __DARWIN__\n  ? 'Open in External Editor'\n  : 'Open in external editor'\n\nexport const RevealInFileManagerLabel = __DARWIN__\n  ? 'Reveal in Finder'\n  : __WIN32__\n    ? 'Show in Explorer'\n    : 'Show in your File Manager'\n\nexport const TrashNameLabel = __DARWIN__ ? 'Trash' : 'Recycle Bin'\n\nexport const OpenWithDefaultProgramLabel = __DARWIN__\n  ? 'Open with Default Program'\n  : 'Open with default program'\n\nexport function isSafeFileExtension(extension: string): boolean {\n  if (__WIN32__) {\n    return RestrictedFileExtensions.indexOf(extension.toLowerCase()) === -1\n  }\n  return true\n}\n","(function() {\n  var AcronymResult, computeScore, emptyAcronymResult, isAcronymFullWord, isMatch, isSeparator, isWordEnd, isWordStart, miss_coeff, pos_bonus, scoreAcronyms, scoreCharacter, scoreConsecutives, scoreExact, scoreExactMatch, scorePattern, scorePosition, scoreSize, tau_size, wm;\n\n  wm = 150;\n\n  pos_bonus = 20;\n\n  tau_size = 150;\n\n  miss_coeff = 0.75;\n\n  exports.score = function(string, query, options) {\n    var allowErrors, preparedQuery, score, string_lw;\n    preparedQuery = options.preparedQuery, allowErrors = options.allowErrors;\n    if (!(allowErrors || isMatch(string, preparedQuery.core_lw, preparedQuery.core_up))) {\n      return 0;\n    }\n    string_lw = string.toLowerCase();\n    score = computeScore(string, string_lw, preparedQuery);\n    return Math.ceil(score);\n  };\n\n  exports.isMatch = isMatch = function(subject, query_lw, query_up) {\n    var i, j, m, n, qj_lw, qj_up, si;\n    m = subject.length;\n    n = query_lw.length;\n    if (!m || n > m) {\n      return false;\n    }\n    i = -1;\n    j = -1;\n    while (++j < n) {\n      qj_lw = query_lw.charCodeAt(j);\n      qj_up = query_up.charCodeAt(j);\n      while (++i < m) {\n        si = subject.charCodeAt(i);\n        if (si === qj_lw || si === qj_up) {\n          break;\n        }\n      }\n      if (i === m) {\n        return false;\n      }\n    }\n    return true;\n  };\n\n  exports.computeScore = computeScore = function(subject, subject_lw, preparedQuery) {\n    var acro, acro_score, align, csc_diag, csc_row, csc_score, csc_should_rebuild, i, j, m, miss_budget, miss_left, n, pos, query, query_lw, record_miss, score, score_diag, score_row, score_up, si_lw, start, sz;\n    query = preparedQuery.query;\n    query_lw = preparedQuery.query_lw;\n    m = subject.length;\n    n = query.length;\n    acro = scoreAcronyms(subject, subject_lw, query, query_lw);\n    acro_score = acro.score;\n    if (acro.count === n) {\n      return scoreExact(n, m, acro_score, acro.pos);\n    }\n    pos = subject_lw.indexOf(query_lw);\n    if (pos > -1) {\n      return scoreExactMatch(subject, subject_lw, query, query_lw, pos, n, m);\n    }\n    score_row = new Array(n);\n    csc_row = new Array(n);\n    sz = scoreSize(n, m);\n    miss_budget = Math.ceil(miss_coeff * n) + 5;\n    miss_left = miss_budget;\n    csc_should_rebuild = true;\n    j = -1;\n    while (++j < n) {\n      score_row[j] = 0;\n      csc_row[j] = 0;\n    }\n    i = -1;\n    while (++i < m) {\n      si_lw = subject_lw[i];\n      if (!si_lw.charCodeAt(0) in preparedQuery.charCodes) {\n        if (csc_should_rebuild) {\n          j = -1;\n          while (++j < n) {\n            csc_row[j] = 0;\n          }\n          csc_should_rebuild = false;\n        }\n        continue;\n      }\n      score = 0;\n      score_diag = 0;\n      csc_diag = 0;\n      record_miss = true;\n      csc_should_rebuild = true;\n      j = -1;\n      while (++j < n) {\n        score_up = score_row[j];\n        if (score_up > score) {\n          score = score_up;\n        }\n        csc_score = 0;\n        if (query_lw[j] === si_lw) {\n          start = isWordStart(i, subject, subject_lw);\n          csc_score = csc_diag > 0 ? csc_diag : scoreConsecutives(subject, subject_lw, query, query_lw, i, j, start);\n          align = score_diag + scoreCharacter(i, j, start, acro_score, csc_score);\n          if (align > score) {\n            score = align;\n            miss_left = miss_budget;\n          } else {\n            if (record_miss && --miss_left <= 0) {\n              return Math.max(score, score_row[n - 1]) * sz;\n            }\n            record_miss = false;\n          }\n        }\n        score_diag = score_up;\n        csc_diag = csc_row[j];\n        csc_row[j] = csc_score;\n        score_row[j] = score;\n      }\n    }\n    score = score_row[n - 1];\n    return score * sz;\n  };\n\n  exports.isWordStart = isWordStart = function(pos, subject, subject_lw) {\n    var curr_s, prev_s;\n    if (pos === 0) {\n      return true;\n    }\n    curr_s = subject[pos];\n    prev_s = subject[pos - 1];\n    return isSeparator(prev_s) || (curr_s !== subject_lw[pos] && prev_s === subject_lw[pos - 1]);\n  };\n\n  exports.isWordEnd = isWordEnd = function(pos, subject, subject_lw, len) {\n    var curr_s, next_s;\n    if (pos === len - 1) {\n      return true;\n    }\n    curr_s = subject[pos];\n    next_s = subject[pos + 1];\n    return isSeparator(next_s) || (curr_s === subject_lw[pos] && next_s !== subject_lw[pos + 1]);\n  };\n\n  isSeparator = function(c) {\n    return c === ' ' || c === '.' || c === '-' || c === '_' || c === '/' || c === '\\\\';\n  };\n\n  scorePosition = function(pos) {\n    var sc;\n    if (pos < pos_bonus) {\n      sc = pos_bonus - pos;\n      return 100 + sc * sc;\n    } else {\n      return Math.max(100 + pos_bonus - pos, 0);\n    }\n  };\n\n  exports.scoreSize = scoreSize = function(n, m) {\n    return tau_size / (tau_size + Math.abs(m - n));\n  };\n\n  scoreExact = function(n, m, quality, pos) {\n    return 2 * n * (wm * quality + scorePosition(pos)) * scoreSize(n, m);\n  };\n\n  exports.scorePattern = scorePattern = function(count, len, sameCase, start, end) {\n    var bonus, sz;\n    sz = count;\n    bonus = 6;\n    if (sameCase === count) {\n      bonus += 2;\n    }\n    if (start) {\n      bonus += 3;\n    }\n    if (end) {\n      bonus += 1;\n    }\n    if (count === len) {\n      if (start) {\n        if (sameCase === len) {\n          sz += 2;\n        } else {\n          sz += 1;\n        }\n      }\n      if (end) {\n        bonus += 1;\n      }\n    }\n    return sameCase + sz * (sz + bonus);\n  };\n\n  exports.scoreCharacter = scoreCharacter = function(i, j, start, acro_score, csc_score) {\n    var posBonus;\n    posBonus = scorePosition(i);\n    if (start) {\n      return posBonus + wm * ((acro_score > csc_score ? acro_score : csc_score) + 10);\n    }\n    return posBonus + wm * csc_score;\n  };\n\n  exports.scoreConsecutives = scoreConsecutives = function(subject, subject_lw, query, query_lw, i, j, startOfWord) {\n    var k, m, mi, n, nj, sameCase, sz;\n    m = subject.length;\n    n = query.length;\n    mi = m - i;\n    nj = n - j;\n    k = mi < nj ? mi : nj;\n    sameCase = 0;\n    sz = 0;\n    if (query[j] === subject[i]) {\n      sameCase++;\n    }\n    while (++sz < k && query_lw[++j] === subject_lw[++i]) {\n      if (query[j] === subject[i]) {\n        sameCase++;\n      }\n    }\n    if (sz < k) {\n      i--;\n    }\n    if (sz === 1) {\n      return 1 + 2 * sameCase;\n    }\n    return scorePattern(sz, n, sameCase, startOfWord, isWordEnd(i, subject, subject_lw, m));\n  };\n\n  exports.scoreExactMatch = scoreExactMatch = function(subject, subject_lw, query, query_lw, pos, n, m) {\n    var end, i, pos2, sameCase, start;\n    start = isWordStart(pos, subject, subject_lw);\n    if (!start) {\n      pos2 = subject_lw.indexOf(query_lw, pos + 1);\n      if (pos2 > -1) {\n        start = isWordStart(pos2, subject, subject_lw);\n        if (start) {\n          pos = pos2;\n        }\n      }\n    }\n    i = -1;\n    sameCase = 0;\n    while (++i < n) {\n      if (query[pos + i] === subject[i]) {\n        sameCase++;\n      }\n    }\n    end = isWordEnd(pos + n - 1, subject, subject_lw, m);\n    return scoreExact(n, m, scorePattern(n, n, sameCase, start, end), pos);\n  };\n\n  AcronymResult = (function() {\n    function AcronymResult(score, pos, count) {\n      this.score = score;\n      this.pos = pos;\n      this.count = count;\n    }\n\n    return AcronymResult;\n\n  })();\n\n  emptyAcronymResult = new AcronymResult(0, 0.1, 0);\n\n  exports.scoreAcronyms = scoreAcronyms = function(subject, subject_lw, query, query_lw) {\n    var count, fullWord, i, j, m, n, qj_lw, sameCase, score, sepCount, sumPos;\n    m = subject.length;\n    n = query.length;\n    if (!(m > 1 && n > 1)) {\n      return emptyAcronymResult;\n    }\n    count = 0;\n    sepCount = 0;\n    sumPos = 0;\n    sameCase = 0;\n    i = -1;\n    j = -1;\n    while (++j < n) {\n      qj_lw = query_lw[j];\n      if (isSeparator(qj_lw)) {\n        i = subject_lw.indexOf(qj_lw, i + 1);\n        if (i > -1) {\n          sepCount++;\n          continue;\n        } else {\n          break;\n        }\n      }\n      while (++i < m) {\n        if (qj_lw === subject_lw[i] && isWordStart(i, subject, subject_lw)) {\n          if (query[j] === subject[i]) {\n            sameCase++;\n          }\n          sumPos += i;\n          count++;\n          break;\n        }\n      }\n      if (i === m) {\n        break;\n      }\n    }\n    if (count < 2) {\n      return emptyAcronymResult;\n    }\n    fullWord = count === n ? isAcronymFullWord(subject, subject_lw, query, count) : false;\n    score = scorePattern(count, n, sameCase, true, fullWord);\n    return new AcronymResult(score, sumPos / count, count + sepCount);\n  };\n\n  isAcronymFullWord = function(subject, subject_lw, query, nbAcronymInQuery) {\n    var count, i, m, n;\n    m = subject.length;\n    n = query.length;\n    count = 0;\n    if (m > 12 * n) {\n      return false;\n    }\n    i = -1;\n    while (++i < m) {\n      if (isWordStart(i, subject, subject_lw) && ++count > nbAcronymInQuery) {\n        return false;\n      }\n    }\n    return true;\n  };\n\n}).call(this);\n","module.exports = function(exec){\n  try {\n    return !!exec();\n  } catch(e){\n    return true;\n  }\n};","// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n  ? window : typeof self != 'undefined' && self.Math == Math ? self : Function('return this')();\nif(typeof __g == 'number')__g = global; // eslint-disable-line no-undef","import { assertNever } from '../lib/fatal-error'\n\n/** A type union of all possible types of menu items */\nexport type MenuItem =\n  | IMenuItem\n  | ISubmenuItem\n  | ISeparatorMenuItem\n  | ICheckboxMenuItem\n  | IRadioMenuItem\n\n/** A type union of all types of menu items which can be executed */\nexport type ExecutableMenuItem = IMenuItem | ICheckboxMenuItem | IRadioMenuItem\n\n/**\n * Common properties for all item types except separator.\n * Only useful for declaring the types, not for consumption\n */\ninterface IBaseMenuItem {\n  readonly id: string\n  readonly enabled: boolean\n  readonly visible: boolean\n  readonly label: string\n}\n\n/**\n * An interface describing the properties of a 'normal'\n * menu item, i.e. a clickable item with a label but no\n * other special properties.\n */\nexport interface IMenuItem extends IBaseMenuItem {\n  readonly type: 'menuItem'\n  readonly accelerator: string | null\n  readonly accessKey: string | null\n}\n\n/**\n * An interface describing the properties of a\n * submenu menu item, i.e. an item which has an associated\n * submenu which can be expanded to reveal more menu\n * item. Not in itself executable, only a container.\n */\nexport interface ISubmenuItem extends IBaseMenuItem {\n  readonly type: 'submenuItem'\n  readonly menu: IMenu\n  readonly accessKey: string | null\n}\n\n/**\n * An interface describing the properties of a checkbox\n * menu item, i.e. an item which has an associated checked\n * state that can be toggled by executing it.\n */\nexport interface ICheckboxMenuItem extends IBaseMenuItem {\n  readonly type: 'checkbox'\n  readonly accelerator: string | null\n  readonly accessKey: string | null\n  readonly checked: boolean\n}\n\n/**\n * An interface describing the properties of a checkbox\n * menu item, i.e. an item which has an associated checked\n * state that is checked or unchecked based on application logic.\n *\n * The radio menu item is probably going to be used in a collection\n * of more radio menu items where the checked item is assigned\n * based on the last executed item in that group.\n */\nexport interface IRadioMenuItem extends IBaseMenuItem {\n  readonly type: 'radio'\n  readonly accelerator: string | null\n  readonly accessKey: string | null\n  readonly checked: boolean\n}\n\n/**\n * An interface describing the properties of a separator menu\n * item, i.e. an item which sole purpose is to create separation\n * between menu items. It has no other semantics and is purely\n * a visual hint.\n */\nexport interface ISeparatorMenuItem {\n  readonly id: string\n  readonly type: 'separator'\n  readonly visible: boolean\n}\n\n/**\n * An interface describing a menu.\n *\n * Holds collection of menu items and an indication of which item (if any)\n * in the menu is selected.\n */\nexport interface IMenu {\n  /**\n   * The id of this menu. For the root menu this will be undefined. For all\n   * other menus it will be the same as the id of the submenu item which\n   * owns this menu.\n   *\n   * +---------------------------+\n   * | Root menu (id: undefined) |\n   * +---------------------------+  +--------------------------+\n   * |  File (id File)           +--> File menu (id: File)     |\n   * +---------------------------+  +--------------------------+\n   * |  Edit (id Edit)           |  |  Open (id File.Open)     |\n   * +---------------------------+  +--------------------------+\n   *                                |  Close (id File.Close)   |\n   *                                +--------------------------+\n   */\n  readonly id?: string\n\n  /** Type identifier, used for type narrowing */\n  readonly type: 'menu'\n\n  /** A collection of zero or more menu items */\n  readonly items: ReadonlyArray<MenuItem>\n\n  /** The selected item in the menu or undefined if no item is selected */\n  readonly selectedItem?: MenuItem\n}\n\n/**\n * Gets the accelerator for a given menu item. If the menu item doesn't\n * have an explicitly defined accelerator but does have a defined role\n * the default accelerator (if any) for that particular role will be\n * returned.\n */\nfunction getAccelerator(menuItem: Electron.MenuItem): string | null {\n  if (menuItem.accelerator) {\n    return menuItem.accelerator as string\n  }\n\n  if (menuItem.role) {\n    const unsafeItem = menuItem as any\n    // https://github.com/electron/electron/blob/d4a8a64ba/lib/browser/api/menu-item.js#L62\n    const getDefaultRoleAccelerator = unsafeItem.getDefaultRoleAccelerator\n\n    if (typeof getDefaultRoleAccelerator === 'function') {\n      try {\n        const defaultRoleAccelerator = getDefaultRoleAccelerator.call(menuItem)\n        if (typeof defaultRoleAccelerator === 'string') {\n          return defaultRoleAccelerator\n        }\n      } catch (err) {\n        console.error('Could not retrieve default accelerator', err)\n      }\n    }\n  }\n\n  return null\n}\n\n/**\n * Return the access key (applicable on Windows) from a menu item label.\n *\n * An access key is a letter or symbol preceded by an ampersand, i.e. in\n * the string \"Check for &updates\" the access key is 'u'. Access keys are\n * case insensitive and are unique per menu.\n */\nfunction getAccessKey(text: string): string | null {\n  const m = text.match(/&([^&])/)\n  return m ? m[1] : null\n}\n\n/**\n * Creates an instance of one of the types in the MenuItem type union based\n * on an Electron MenuItem instance. Will recurse through all sub menus and\n * convert each item.\n */\nfunction menuItemFromElectronMenuItem(menuItem: Electron.MenuItem): MenuItem {\n  // Our menu items always have ids and Electron.MenuItem takes on whatever\n  // properties was defined on the MenuItemOptions template used to create it\n  // but doesn't surface those in the type declaration.\n  const id: string | undefined = (menuItem as any).id\n  if (!id) {\n    throw new Error(`menuItem must specify id: ${menuItem.label}`)\n  }\n  const enabled = menuItem.enabled\n  const visible = menuItem.visible\n  const label = menuItem.label\n  const checked = menuItem.checked\n  const accelerator = getAccelerator(menuItem)\n  const accessKey = getAccessKey(menuItem.label)\n\n  // normal, separator, submenu, checkbox or radio.\n  switch (menuItem.type) {\n    case 'normal':\n      return {\n        id,\n        type: 'menuItem',\n        label,\n        enabled,\n        visible,\n        accelerator,\n        accessKey,\n      }\n    case 'separator':\n      return { id, type: 'separator', visible }\n    case 'submenu':\n      const menu = menuFromElectronMenu(menuItem.submenu as Electron.Menu, id)\n      return {\n        id,\n        type: 'submenuItem',\n        label,\n        enabled,\n        visible,\n        menu,\n        accessKey,\n      }\n    case 'checkbox':\n      return {\n        id,\n        type: 'checkbox',\n        label,\n        enabled,\n        visible,\n        accelerator,\n        checked,\n        accessKey,\n      }\n    case 'radio':\n      return {\n        id,\n        type: 'radio',\n        label,\n        enabled,\n        visible,\n        accelerator,\n        checked,\n        accessKey,\n      }\n    default:\n      return assertNever(\n        menuItem.type,\n        `Unknown menu item type ${menuItem.type}`\n      )\n  }\n}\n/**\n * Creates a IMenu instance based on an Electron Menu instance.\n * Will recurse through all sub menus and convert each item using\n * menuItemFromElectronMenuItem.\n *\n * @param menu - The electron menu instance to convert into an\n *               IMenu instance\n *\n * @param id   - The id of the menu. Menus share their id with\n *               their parent item. The root menu id is undefined.\n */\nexport function menuFromElectronMenu(menu: Electron.Menu, id?: string): IMenu {\n  const items = menu.items.map(menuItemFromElectronMenuItem)\n\n  if (__DEV__) {\n    const seenAccessKeys = new Set<string>()\n\n    for (const item of items) {\n      if (item.visible) {\n        if (itemMayHaveAccessKey(item) && item.accessKey) {\n          if (seenAccessKeys.has(item.accessKey.toLowerCase())) {\n            throw new Error(\n              `Duplicate access key '${item.accessKey}' for item ${item.label}`\n            )\n          } else {\n            seenAccessKeys.add(item.accessKey.toLowerCase())\n          }\n        }\n      }\n    }\n  }\n\n  return { id, type: 'menu', items }\n}\n\n/**\n * Creates a map between MenuItem ids and MenuItems by recursing\n * through all items and all submenus.\n */\nfunction buildIdMap(\n  menu: IMenu,\n  map = new Map<string, MenuItem>()\n): Map<string, MenuItem> {\n  for (const item of menu.items) {\n    map.set(item.id, item)\n    if (item.type === 'submenuItem') {\n      buildIdMap(item.menu, map)\n    }\n  }\n\n  return map\n}\n\n/** Type guard which narrows a MenuItem to one which supports access keys */\nexport function itemMayHaveAccessKey(\n  item: MenuItem\n): item is IMenuItem | ISubmenuItem | ICheckboxMenuItem | IRadioMenuItem {\n  return (\n    item.type === 'menuItem' ||\n    item.type === 'submenuItem' ||\n    item.type === 'checkbox' ||\n    item.type === 'radio'\n  )\n}\n\n/**\n * Returns a value indicating whether or not the given menu item can be\n * selected. Selectable items are non-separator items which are enabled\n * and visible.\n */\nexport function itemIsSelectable(item: MenuItem) {\n  return item.type !== 'separator' && item.enabled && item.visible\n}\n\n/**\n * Attempts to locate a menu item matching the provided access key in a\n * given list of items. The access key comparison is case-insensitive.\n *\n * Note that this function does not take into account whether or not the\n * item is selectable, consumers of this function need to perform that\n * check themselves when applicable.\n */\nexport function findItemByAccessKey(\n  accessKey: string,\n  items: ReadonlyArray<MenuItem>\n): IMenuItem | ISubmenuItem | ICheckboxMenuItem | IRadioMenuItem | null {\n  const lowerCaseAccessKey = accessKey.toLowerCase()\n\n  for (const item of items) {\n    if (itemMayHaveAccessKey(item)) {\n      if (\n        item.accessKey &&\n        item.accessKey.toLowerCase() === lowerCaseAccessKey\n      ) {\n        return item\n      }\n    }\n  }\n\n  return null\n}\n\n/**\n * An immutable, transformable object which represents an application menu\n * and its current state (which menus are open, which items are selected).\n *\n * The primary use case for this is for rendering a custom application menu\n * on non-macOS systems. As such some interactions are explicitly made to\n * conform to Windows menu interactions. This includes things like selecting\n * the entire path up until the last selected item. This is necessary since,\n * on Windows, the parent menu item of a menu might not be selected even\n * though the submenu is. This is in order to allow for some delay when\n * moving the cursor from one menu pane to another.\n *\n * In general, however, this object is not platform specific and much of\n * the interactions are defined by the component using it.\n */\nexport class AppMenu {\n  /**\n   * Static constructor for the initial creation of an AppMenu instance\n   * from an IMenu instance.\n   */\n  public static fromMenu(menu: IMenu): AppMenu {\n    const map = buildIdMap(menu)\n    const openMenus = [menu]\n\n    return new AppMenu(menu, openMenus, map)\n  }\n\n  /**\n   * Used by static constructors and transformers.\n   *\n   * @param menu  The menu that this instance operates on, taken from an\n   *              electron Menu instance and converted into an IMenu model\n   *              by menuFromElectronMenu.\n   * @param openMenus A list of currently open menus with their selected items\n   *                  in the application menu.\n   *\n   *                  The semantics around what constitutes an open menu and how\n   *                  selection works is defined within this class class as well as\n   *                  in the individual components transforming that state.\n   * @param menuItemById A map between menu item ids and their corresponding MenuItem.\n   */\n  private constructor(\n    private readonly menu: IMenu,\n    public readonly openMenus: ReadonlyArray<IMenu>,\n    private readonly menuItemById: Map<string, MenuItem>\n  ) {}\n\n  /**\n   * Retrieves a menu item by its id.\n   */\n  public getItemById(id: string): MenuItem | undefined {\n    return this.menuItemById.get(id)\n  }\n\n  /**\n   * Merges the current AppMenu state with a new menu while\n   * attempting to maintain selection state.\n   */\n  public withMenu(newMenu: IMenu): AppMenu {\n    const newMap = buildIdMap(newMenu)\n    const newOpenMenus = new Array<IMenu>()\n\n    // Enumerate all currently open menus and attempt to recreate\n    // the openMenus array with the new menu instances\n    for (const openMenu of this.openMenus) {\n      let newOpenMenu: IMenu\n\n      // No id means it's the root menu, simple enough.\n      if (!openMenu.id) {\n        newOpenMenu = newMenu\n      } else {\n        // Menus share id with their parent item\n        const item = newMap.get(openMenu.id)\n\n        if (item && item.type === 'submenuItem') {\n          newOpenMenu = item.menu\n        } else {\n          // This particular menu can't be found in the new menu\n          // structure, we have no choice but to bail here and\n          // not open this particular menu.\n          break\n        }\n      }\n\n      let newSelectedItem: MenuItem | undefined = undefined\n\n      if (openMenu.selectedItem) {\n        newSelectedItem = newMap.get(openMenu.selectedItem.id)\n      }\n\n      newOpenMenus.push({\n        id: newOpenMenu.id,\n        type: 'menu',\n        items: newOpenMenu.items,\n        selectedItem: newSelectedItem,\n      })\n    }\n\n    return new AppMenu(newMenu, newOpenMenus, newMap)\n  }\n\n  /**\n   * Creates a new copy of this AppMenu instance with the given submenu open.\n   *\n   * @param submenuItem     - The item which submenu should be appended\n   *                          to the list of open menus.\n   *\n   * @param selectFirstItem - A convenience item for automatically selecting\n   *                          the first item in the newly opened menu.\n   *\n   *                          If false the new menu is opened without a selection.\n   *\n   *                          Defaults to false.\n   */\n  public withOpenedMenu(\n    submenuItem: ISubmenuItem,\n    selectFirstItem = false\n  ): AppMenu {\n    const ourMenuItem = this.menuItemById.get(submenuItem.id)\n\n    if (!ourMenuItem) {\n      return this\n    }\n\n    if (ourMenuItem.type !== 'submenuItem') {\n      throw new Error(\n        `Attempt to open a submenu from an item of wrong type: ${\n          ourMenuItem.type\n        }`\n      )\n    }\n\n    const parentMenuIndex = this.openMenus.findIndex(\n      m => m.items.indexOf(ourMenuItem) !== -1\n    )\n\n    // The parent menu has apparently been closed in between, we could go and\n    // recreate it but it's probably not worth it.\n    if (parentMenuIndex === -1) {\n      return this\n    }\n\n    const newOpenMenus = this.openMenus.slice(0, parentMenuIndex + 1)\n\n    if (selectFirstItem) {\n      // First selectable item.\n      const selectedItem = ourMenuItem.menu.items.find(itemIsSelectable)\n      newOpenMenus.push({ ...ourMenuItem.menu, selectedItem })\n    } else {\n      newOpenMenus.push(ourMenuItem.menu)\n    }\n\n    return new AppMenu(this.menu, newOpenMenus, this.menuItemById)\n  }\n\n  /**\n   * Creates a new copy of this AppMenu instance with the given menu removed from\n   * the list of open menus.\n   *\n   * @param menu - The menu which is to be closed, i.e. removed from the\n   *               list of open menus.\n   */\n  public withClosedMenu(menu: IMenu) {\n    // Root menu is always open and can't be closed\n    if (!menu.id) {\n      return this\n    }\n\n    const ourMenuIndex = this.openMenus.findIndex(m => m.id === menu.id)\n\n    if (ourMenuIndex === -1) {\n      return this\n    }\n\n    const newOpenMenus = this.openMenus.slice(0, ourMenuIndex)\n\n    return new AppMenu(this.menu, newOpenMenus, this.menuItemById)\n  }\n\n  /**\n   * Creates a new copy of this AppMenu instance with the list of open menus trimmed\n   * to not include any menus below the given menu.\n   *\n   * @param menu - The last menu which is to remain in the list of open\n   *               menus, all menus below this level will be pruned from\n   *               the list of open menus.\n   */\n  public withLastMenu(menu: IMenu) {\n    const ourMenuIndex = this.openMenus.findIndex(m => m.id === menu.id)\n\n    if (ourMenuIndex === -1) {\n      return this\n    }\n\n    const newOpenMenus = this.openMenus.slice(0, ourMenuIndex + 1)\n\n    return new AppMenu(this.menu, newOpenMenus, this.menuItemById)\n  }\n\n  /**\n   * Creates a new copy of this AppMenu instance in which the given menu item\n   * is selected.\n   *\n   * Additional semantics:\n   *\n   *  All menus leading up to the given menu item will have their\n   *  selection reset in such a fashion that the selection path\n   *  points to the given menu item.\n   *\n   *  All menus after the menu in which the given item resides\n   *  will have their selections cleared.\n   *\n   * @param menuItem - The menu item which is to be selected.\n   */\n  public withSelectedItem(menuItem: MenuItem) {\n    const ourMenuItem = this.menuItemById.get(menuItem.id)\n\n    // The item that someone is trying to select no longer\n    // exists, not much we can do about that.\n    if (!ourMenuItem) {\n      return this\n    }\n\n    const parentMenuIndex = this.openMenus.findIndex(\n      m => m.items.indexOf(ourMenuItem) !== -1\n    )\n\n    // The menu which the selected item belongs to is no longer open,\n    // not much we can do about that.\n    if (parentMenuIndex === -1) {\n      return this\n    }\n\n    const newOpenMenus = this.openMenus.slice()\n\n    const parentMenu = newOpenMenus[parentMenuIndex]\n\n    newOpenMenus[parentMenuIndex] = { ...parentMenu, selectedItem: ourMenuItem }\n\n    // All submenus below the active menu should have their selection cleared\n    for (let i = parentMenuIndex + 1; i < newOpenMenus.length; i++) {\n      newOpenMenus[i] = { ...newOpenMenus[i], selectedItem: undefined }\n    }\n\n    // Ensure that the path that lead us to the currently selected menu is\n    // selected. i.e. all menus above the currently active menu should have\n    // their selection reset to point to the currently active menu.\n    for (let i = parentMenuIndex - 1; i >= 0; i--) {\n      const menu = newOpenMenus[i]\n      const childMenu = newOpenMenus[i + 1]\n\n      const selectedItem = menu.items.find(\n        item => item.type === 'submenuItem' && item.id === childMenu.id\n      )\n\n      newOpenMenus[i] = { ...menu, selectedItem }\n    }\n\n    return new AppMenu(this.menu, newOpenMenus, this.menuItemById)\n  }\n\n  /**\n   * Creates a new copy of this AppMenu instance in which the given menu has had\n   * its selection state cleared.\n   *\n   * Additional semantics:\n   *\n   *  All menus leading up to the given menu item will have their\n   *  selection reset in such a fashion that the selection path\n   *  points to the given menu.\n   *\n   * @param menu - The menu which is to have its selection state\n   *               cleared.\n   */\n  public withDeselectedMenu(menu: IMenu) {\n    const ourMenuIndex = this.openMenus.findIndex(m => m.id === menu.id)\n\n    // The menu that someone is trying to deselect is no longer open\n    // so no need to worry about selection\n    if (ourMenuIndex === -1) {\n      return this\n    }\n\n    const ourMenu = this.openMenus[ourMenuIndex]\n    const newOpenMenus = this.openMenus.slice()\n\n    newOpenMenus[ourMenuIndex] = { ...ourMenu, selectedItem: undefined }\n\n    // Ensure that the path to the menu without an active selection is\n    // selected. i.e. all menus above should have their selection reset\n    // to point to the menu which no longer has an active selection.\n    for (let i = ourMenuIndex - 1; i >= 0; i--) {\n      const menu = newOpenMenus[i]\n      const childMenu = newOpenMenus[i + 1]\n\n      const selectedItem = menu.items.find(\n        item => item.type === 'submenuItem' && item.id === childMenu.id\n      )\n\n      newOpenMenus[i] = { ...menu, selectedItem }\n    }\n\n    return new AppMenu(this.menu, newOpenMenus, this.menuItemById)\n  }\n\n  /**\n   * Creates a new copy of this AppMenu instance in which all state\n   * is reset. Resetting means that only the root menu is open and\n   * all selection state is cleared.\n   */\n  public withReset() {\n    return new AppMenu(this.menu, [this.menu], this.menuItemById)\n  }\n}\n","/**\n * A tuple of name, email, and date for the author or commit\n * info in a commit.\n */\nexport class CommitIdentity {\n  /**\n   * Parses a Git ident string (GIT_AUTHOR_IDENT or GIT_COMMITTER_IDENT)\n   * into a commit identity. Returns null if string could not be parsed.\n   */\n  public static parseIdentity(identity: string): CommitIdentity | null {\n    // See fmt_ident in ident.c:\n    //  https://github.com/git/git/blob/3ef7618e6/ident.c#L346\n    //\n    // Format is \"NAME <EMAIL> DATE\"\n    //  Markus Olsson <j.markus.olsson@gmail.com> 1475670580 +0200\n    //\n    // Note that `git var` will strip any < and > from the name and email, see:\n    //  https://github.com/git/git/blob/3ef7618e6/ident.c#L396\n    //\n    // Note also that this expects a date formatted with the RAW option in git see:\n    //  https://github.com/git/git/blob/35f6318d4/date.c#L191\n    //\n    const m = identity.match(/^(.*?) <(.*?)> (\\d+) (\\+|-)?(\\d{2})(\\d{2})/)\n    if (!m) {\n      return null\n    }\n\n    const name = m[1]\n    const email = m[2]\n    // The date is specified as seconds from the epoch,\n    // Date() expects milliseconds since the epoch.\n    const date = new Date(parseInt(m[3], 10) * 1000)\n\n    // The RAW option never uses alphanumeric timezone identifiers and in my\n    // testing I've never found it to omit the leading + for a positive offset\n    // but the docs for strprintf seems to suggest it might on some systems so\n    // we're playing it safe.\n    const tzSign = m[4] === '-' ? '-' : '+'\n    const tzHH = m[5]\n    const tzmm = m[6]\n\n    const tzMinutes = parseInt(tzHH, 10) * 60 + parseInt(tzmm, 10)\n    const tzOffset = tzMinutes * (tzSign === '-' ? -1 : 1)\n\n    return new CommitIdentity(name, email, date, tzOffset)\n  }\n\n  public constructor(\n    public readonly name: string,\n    public readonly email: string,\n    public readonly date: Date,\n    public readonly tzOffset: number = new Date().getTimezoneOffset()\n  ) {}\n}\n","'use strict'\n\nconst u = require('universalify').fromCallback\nconst rimraf = require('./rimraf')\n\nmodule.exports = {\n  remove: u(rimraf),\n  removeSync: rimraf.sync\n}\n","import * as FSE from 'fs-extra'\nimport * as Os from 'os'\nimport * as Path from 'path'\nimport { Disposable } from 'event-kit'\nimport { Tailer } from './tailer'\n\nconst byline = require('byline')\n\n/**\n * Get a path to a temp file using the given name. Note that the file itself\n * will not be created.\n */\nexport async function getTempFilePath(name: string): Promise<string> {\n  const tempDir = Path.join(Os.tmpdir(), `${name}-`)\n  const directory = await FSE.mkdtemp(tempDir)\n  return Path.join(directory, name)\n}\n\n/**\n * Tail the file and call the callback on every line.\n *\n * Note that this will not stop tailing until the returned `Disposable` is\n * disposed of.\n */\nexport function tailByLine(\n  path: string,\n  cb: (line: string) => void\n): Disposable {\n  const tailer = new Tailer(path)\n\n  const onErrorDisposable = tailer.onError(error => {\n    log.warn(`Unable to tail path: ${path}`, error)\n  })\n\n  const onDataDisposable = tailer.onDataAvailable(stream => {\n    byline(stream).on('data', (buffer: Buffer) => {\n      if (onDataDisposable.disposed) {\n        return\n      }\n\n      const line = buffer.toString()\n      cb(line)\n    })\n  })\n\n  tailer.start()\n\n  return new Disposable(() => {\n    onDataDisposable.dispose()\n    onErrorDisposable.dispose()\n    tailer.stop()\n  })\n}\n\n/**\n * Asynchronous readFile - Asynchronously reads the entire contents of a file.\n *\n * @param fileName\n * @param options An object with optional {encoding} and {flag} properties.  If {encoding} is specified, readFile returns a string; otherwise it returns a Buffer.\n * @param callback - The callback is passed two arguments (err, data), where data is the contents of the file.\n */\nexport async function readFile(\n  filename: string,\n  options?: { flag?: string }\n): Promise<Buffer>\n// eslint-disable-next-line no-redeclare\nexport async function readFile(\n  filename: string,\n  options?: { encoding: BufferEncoding; flag?: string }\n): Promise<string>\n// eslint-disable-next-line no-redeclare\nexport async function readFile(\n  filename: string,\n  options?: { encoding?: string; flag?: string }\n): Promise<Buffer | string> {\n  return new Promise<string | Buffer>((resolve, reject) => {\n    options = options || { flag: 'r' }\n    FSE.readFile(filename, options, (err, data) => {\n      if (err) {\n        reject(err)\n      } else {\n        resolve(data)\n      }\n    })\n  })\n}\n\n/**\n * Read a specific region from a file.\n *\n * @param path  Path to the file\n * @param start First index relative to the start of the file to\n *              read from\n * @param end   Last index (inclusive) relative to the start of the\n *              file to read to\n */\nexport async function readPartialFile(\n  path: string,\n  start: number,\n  end: number\n): Promise<Buffer> {\n  return await new Promise<Buffer>((resolve, reject) => {\n    const chunks = new Array<Buffer>()\n    let total = 0\n\n    FSE.createReadStream(path, { start, end })\n      .on('data', (chunk: Buffer) => {\n        chunks.push(chunk)\n        total += chunk.length\n      })\n      .on('error', reject)\n      .on('end', () => resolve(Buffer.concat(chunks, total)))\n  })\n}\n","import { IAPIEmail } from './api'\n\n/**\n * Lookup a suitable email address to display in the application, based on the\n * following rules:\n *\n *  - the primary email if it's publicly visible\n *  - the first public email\n *  - an '@users.noreply.github.com' email address\n *  - the first email address\n *\n * Otherwise just return null\n *\n * @param emails array of email addresses associated with an account\n */\nexport function lookupPreferredEmail(\n  emails: ReadonlyArray<IAPIEmail>\n): IAPIEmail | null {\n  if (emails.length === 0) {\n    return null\n  }\n\n  const primary = emails.find(e => e.primary)\n  if (primary && isEmailPublic(primary)) {\n    return primary\n  }\n\n  const noReply = emails.find(e =>\n    e.email.toLowerCase().endsWith('@users.noreply.github.com')\n  )\n  if (noReply) {\n    return noReply\n  }\n\n  return emails[0]\n}\n\n/**\n * Is the email public?\n */\nfunction isEmailPublic(email: IAPIEmail): boolean {\n  // If an email doesn't have a visibility setting it means it's coming from an\n  // older Enterprise server which doesn't have the concept of visiblity.\n  return email.visibility === 'public' || !email.visibility\n}\n\n/**\n * Get the default email address belonging to a user\n *\n * @param emails Array of email details returned from GitHub API\n * @returns the email address from the first element in the array, or an empty\n *          string if the array is empty\n */\nexport function getDefaultEmail(emails: ReadonlyArray<IAPIEmail>): string {\n  if (emails.length === 0) {\n    return ''\n  }\n\n  return emails[0].email || ''\n}\n","import { randomBytes as nodeCryptoGetRandomBytes } from 'crypto'\n\n// Work around synchronously seeding of random buffer in the v1\n// version of uuid by explicitly only requiring v4. As far as I'm\n// aware we cannot use an import statement here without causing webpack\n// to load the v1 version as well.\n//\n// See\n//  https://github.com/kelektiv/node-uuid/issues/189\nconst guid = require('uuid/v4') as (options?: { random?: Buffer }) => string\n\n/**\n * Fills a buffer with the required number of random bytes.\n *\n * Attempt to use the Chromium-provided crypto library rather than\n * Node.JS. For some reason the Node.JS randomBytes function adds\n * _considerable_ (1s+) synchronous load time to the start up.\n *\n * See\n *  https://developer.mozilla.org/en-US/docs/Web/API/Window/crypto\n *  https://github.com/kelektiv/node-uuid/issues/189\n */\nfunction getRandomBytes(count: number): Buffer {\n  if (window.crypto) {\n    const rndBuf = new Uint8Array(count)\n    crypto.getRandomValues(rndBuf)\n\n    return Buffer.from(rndBuf.buffer as ArrayBuffer)\n  }\n\n  return nodeCryptoGetRandomBytes(count)\n}\n\n/**\n * Wrapper function over uuid's v4 method that attempts to source\n * entropy using the window Crypto instance rather than through\n * Node.JS.\n */\nexport function uuid() {\n  return guid({ random: getRandomBytes(16) })\n}\n","import { getDotComAPIEndpoint, IAPIEmail } from '../lib/api'\n\n/**\n * A GitHub account, representing the user found on GitHub The Website or GitHub Enterprise.\n *\n * This contains a token that will be used for operations that require authentication.\n */\nexport class Account {\n  /** Create an account which can be used to perform unauthenticated API actions */\n  public static anonymous(): Account {\n    return new Account('', getDotComAPIEndpoint(), '', [], '', -1, '')\n  }\n\n  /**\n   * Create an instance of an account\n   *\n   * @param login The login name for this account\n   * @param endpoint The server for this account - GitHub or a GitHub Enterprise instance\n   * @param token The access token used to perform operations on behalf of this account\n   * @param emails The current list of email addresses associated with the account\n   * @param avatarURL The profile URL to render for this account\n   * @param id The database id for this account\n   * @param name The friendly name associated with this account\n   */\n  public constructor(\n    public readonly login: string,\n    public readonly endpoint: string,\n    public readonly token: string,\n    public readonly emails: ReadonlyArray<IAPIEmail>,\n    public readonly avatarURL: string,\n    public readonly id: number,\n    public readonly name: string\n  ) {}\n\n  public withToken(token: string): Account {\n    return new Account(\n      this.login,\n      this.endpoint,\n      token,\n      this.emails,\n      this.avatarURL,\n      this.id,\n      this.name\n    )\n  }\n}\n","import * as URL from 'url'\nimport * as Path from 'path'\n\nimport { CloningRepository } from '../models/cloning-repository'\nimport { Repository } from '../models/repository'\nimport { Account } from '../models/account'\nimport { IRemote } from '../models/remote'\nimport { getHTMLURL } from './api'\nimport { parseRemote } from './remote-parsing'\nimport { caseInsensitiveEquals } from './compare'\nimport { GitHubRepository } from '../models/github-repository'\n\nexport interface IMatchedGitHubRepository {\n  /**\n   * The name of the repository, e.g., for https://github.com/user/repo, the\n   * name is `repo`.\n   */\n  readonly name: string\n\n  /**\n   * The login of the owner of the repository, e.g., for\n   * https://github.com/user/repo, the owner is `user`.\n   */\n  readonly owner: string\n\n  /** The API endpoint. */\n  readonly endpoint: string\n}\n\n/** Try to use the list of users and a remote URL to guess a GitHub repository. */\nexport function matchGitHubRepository(\n  accounts: ReadonlyArray<Account>,\n  remote: string\n): IMatchedGitHubRepository | null {\n  for (const account of accounts) {\n    const match = matchRemoteWithAccount(account, remote)\n    if (match) {\n      return match\n    }\n  }\n\n  return null\n}\n\nfunction matchRemoteWithAccount(\n  account: Account,\n  remote: string\n): IMatchedGitHubRepository | null {\n  const htmlURL = getHTMLURL(account.endpoint)\n  const parsed = URL.parse(htmlURL)\n  const host = parsed.hostname\n\n  const parsedRemote = parseRemote(remote)\n  if (!parsedRemote) {\n    return null\n  }\n\n  const owner = parsedRemote.owner\n  const name = parsedRemote.name\n\n  if (\n    host &&\n    parsedRemote.hostname.toLowerCase() === host.toLowerCase() &&\n    owner &&\n    name\n  ) {\n    return { name, owner, endpoint: account.endpoint }\n  }\n\n  return null\n}\n\n/**\n * Find an existing repository associated with this path\n *\n * @param repositories The list of repositories tracked in the app\n * @param path The path on disk which might be a repository\n */\nexport function matchExistingRepository(\n  repositories: ReadonlyArray<Repository | CloningRepository>,\n  path: string\n): Repository | CloningRepository | null {\n  return (\n    repositories.find(r => {\n      if (__WIN32__) {\n        // Windows is guaranteed to be case-insensitive so we can be a\n        // bit more accepting.\n        return (\n          Path.normalize(r.path).toLowerCase() ===\n          Path.normalize(path).toLowerCase()\n        )\n      } else {\n        return Path.normalize(r.path) === Path.normalize(path)\n      }\n    }) || null\n  )\n}\n\n/**\n * Check whether or not a GitHub repository matches a given remote.\n *\n * @param gitHubRepository the repository containing information from the GitHub API\n * @param remote the remote details found in the Git repository\n */\nexport function repositoryMatchesRemote(\n  gitHubRepository: GitHubRepository,\n  remote: IRemote\n): boolean {\n  return (\n    urlMatchesRemote(gitHubRepository.htmlURL, remote) ||\n    urlMatchesRemote(gitHubRepository.cloneURL, remote)\n  )\n}\n\n/**\n * Check whether or not a GitHub repository URL matches a given remote, by\n * parsing and comparing the structure of the each URL.\n *\n * @param url a URL associated with the GitHub repository\n * @param remote the remote details found in the Git repository\n */\nexport function urlMatchesRemote(url: string | null, remote: IRemote): boolean {\n  if (url == null) {\n    return false\n  }\n\n  const cloneUrl = parseRemote(url)\n  const remoteUrl = parseRemote(remote.url)\n\n  if (remoteUrl == null || cloneUrl == null) {\n    return false\n  }\n\n  if (!caseInsensitiveEquals(remoteUrl.hostname, cloneUrl.hostname)) {\n    return false\n  }\n\n  if (remoteUrl.owner == null || cloneUrl.owner == null) {\n    return false\n  }\n\n  if (remoteUrl.name == null || cloneUrl.name == null) {\n    return false\n  }\n\n  return (\n    caseInsensitiveEquals(remoteUrl.owner, cloneUrl.owner) &&\n    caseInsensitiveEquals(remoteUrl.name, cloneUrl.name)\n  )\n}\n","import { Repository } from '../models/repository'\nimport { CloningRepository } from '../models/cloning-repository'\nimport { RetryAction } from './retry-actions'\n\nexport interface IErrorMetadata {\n  /** The first argument passed to `git` which triggered this error */\n  readonly command?: string\n\n  /** Was the action which caused this error part of a background task? */\n  readonly backgroundTask?: boolean\n\n  /** The repository from which this error originated. */\n  readonly repository?: Repository | CloningRepository\n\n  /** The action to retry if applicable. */\n  readonly retryAction?: RetryAction\n}\n\n/** An error which contains additional metadata. */\nexport class ErrorWithMetadata extends Error {\n  /** The error's metadata. */\n  public readonly metadata: IErrorMetadata\n\n  /** The underlying error to which the metadata is being attached. */\n  public readonly underlyingError: Error\n\n  public constructor(error: Error, metadata: IErrorMetadata) {\n    super(error.message)\n\n    this.name = error.name\n    this.stack = error.stack\n    this.underlyingError = error\n    this.metadata = metadata\n  }\n}\n","import { remote } from 'electron'\n\n// Given that `autoUpdater` is entirely async anyways, I *think* it's safe to\n// use with `remote`.\nconst autoUpdater = remote.autoUpdater\nconst lastSuccessfulCheckKey = 'last-successful-update-check'\n\nimport { Emitter, Disposable } from 'event-kit'\n\nimport { sendWillQuitSync } from '../main-process-proxy'\nimport { ErrorWithMetadata } from '../../lib/error-with-metadata'\nimport { parseError } from '../../lib/squirrel-error-parser'\n\nimport { ReleaseSummary } from '../../models/release-notes'\nimport { generateReleaseSummary } from '../../lib/release-notes'\n\n/** The states the auto updater can be in. */\nexport enum UpdateStatus {\n  /** The auto updater is checking for updates. */\n  CheckingForUpdates,\n\n  /** An update is available and will begin downloading. */\n  UpdateAvailable,\n\n  /** No update is available. */\n  UpdateNotAvailable,\n\n  /** An update has been downloaded and is ready to be installed. */\n  UpdateReady,\n}\n\nexport interface IUpdateState {\n  status: UpdateStatus\n  lastSuccessfulCheck: Date | null\n  newRelease: ReleaseSummary | null\n}\n\n/** A store which contains the current state of the auto updater. */\nclass UpdateStore {\n  private emitter = new Emitter()\n  private status = UpdateStatus.UpdateNotAvailable\n  private lastSuccessfulCheck: Date | null = null\n  private newRelease: ReleaseSummary | null = null\n\n  /** Is the most recent update check user initiated? */\n  private userInitiatedUpdate = true\n\n  public constructor() {\n    const lastSuccessfulCheckValue = localStorage.getItem(\n      lastSuccessfulCheckKey\n    )\n\n    if (lastSuccessfulCheckValue) {\n      const lastSuccessfulCheckTime = parseInt(lastSuccessfulCheckValue, 10)\n\n      if (!isNaN(lastSuccessfulCheckTime)) {\n        this.lastSuccessfulCheck = new Date(lastSuccessfulCheckTime)\n      }\n    }\n\n    autoUpdater.on('error', this.onAutoUpdaterError)\n    autoUpdater.on('checking-for-update', this.onCheckingForUpdate)\n    autoUpdater.on('update-available', this.onUpdateAvailable)\n    autoUpdater.on('update-not-available', this.onUpdateNotAvailable)\n    autoUpdater.on('update-downloaded', this.onUpdateDownloaded)\n\n    window.addEventListener('beforeunload', () => {\n      autoUpdater.removeListener('error', this.onAutoUpdaterError)\n      autoUpdater.removeListener(\n        'checking-for-update',\n        this.onCheckingForUpdate\n      )\n      autoUpdater.removeListener('update-available', this.onUpdateAvailable)\n      autoUpdater.removeListener(\n        'update-not-available',\n        this.onUpdateNotAvailable\n      )\n      autoUpdater.removeListener('update-downloaded', this.onUpdateDownloaded)\n    })\n  }\n\n  private touchLastChecked() {\n    const now = new Date()\n    const persistedValue = now.getTime().toString()\n\n    this.lastSuccessfulCheck = now\n    localStorage.setItem(lastSuccessfulCheckKey, persistedValue)\n  }\n\n  private onAutoUpdaterError = (error: Error) => {\n    this.status = UpdateStatus.UpdateNotAvailable\n\n    if (__WIN32__) {\n      const parsedError = parseError(error)\n      this.emitError(parsedError || error)\n    } else {\n      this.emitError(error)\n    }\n  }\n\n  private onCheckingForUpdate = () => {\n    this.status = UpdateStatus.CheckingForUpdates\n    this.emitDidChange()\n  }\n\n  private onUpdateAvailable = () => {\n    this.touchLastChecked()\n    this.status = UpdateStatus.UpdateAvailable\n    this.emitDidChange()\n  }\n\n  private onUpdateNotAvailable = () => {\n    this.touchLastChecked()\n    this.status = UpdateStatus.UpdateNotAvailable\n    this.emitDidChange()\n  }\n\n  private onUpdateDownloaded = async () => {\n    this.newRelease = await generateReleaseSummary()\n\n    this.status = UpdateStatus.UpdateReady\n\n    this.emitDidChange()\n  }\n\n  /** Register a function to call when the auto updater state changes. */\n  public onDidChange(fn: (state: IUpdateState) => void): Disposable {\n    return this.emitter.on('did-change', fn)\n  }\n\n  private emitDidChange() {\n    this.emitter.emit('did-change', this.state)\n  }\n\n  /** Register a function to call when the auto updater encounters an error. */\n  public onError(fn: (error: Error) => void): Disposable {\n    return this.emitter.on('error', fn)\n  }\n\n  private emitError(error: Error) {\n    const updatedError = new ErrorWithMetadata(error, {\n      backgroundTask: !this.userInitiatedUpdate,\n    })\n    this.emitter.emit('error', updatedError)\n  }\n\n  /** The current auto updater state. */\n  public get state(): IUpdateState {\n    return {\n      status: this.status,\n      lastSuccessfulCheck: this.lastSuccessfulCheck,\n      newRelease: this.newRelease,\n    }\n  }\n\n  /**\n   * Check for updates.\n   *\n   * @param inBackground - Are we checking for updates in the background, or was\n   *                       this check user-initiated?\n   */\n  public checkForUpdates(inBackground: boolean) {\n    // An update has been downloaded and the app is waiting to be restarted.\n    // Checking for updates again may result in the running app being nuked\n    // when it finds a subsequent update.\n    if (__WIN32__ && this.status === UpdateStatus.UpdateReady) {\n      return\n    }\n\n    this.userInitiatedUpdate = !inBackground\n\n    try {\n      autoUpdater.setFeedURL({ url: __UPDATES_URL__ })\n      autoUpdater.checkForUpdates()\n    } catch (e) {\n      this.emitError(e)\n    }\n  }\n\n  /** Quit and install the update. */\n  public quitAndInstallUpdate() {\n    // This is synchronous so that we can ensure the app will let itself be quit\n    // before we call the function to quit.\n    // eslint-disable-next-line no-sync\n    sendWillQuitSync()\n    autoUpdater.quitAndInstall()\n  }\n}\n\n/** The store which contains the current state of the auto updater. */\nexport const updateStore = new UpdateStore()\n","module.exports = { \"default\": require(\"core-js/library/fn/object/assign\"), __esModule: true };","import * as React from 'react'\nimport { createUniqueId, releaseUniqueId } from './id-pool'\n\ninterface ISelectProps {\n  /** The label for the select control. */\n  readonly label?: string\n\n  /** The value of the select control. */\n  readonly value?: string\n\n  /** The default value of the select control. */\n  readonly defaultValue?: string\n\n  /** Called when the user changes the selected valued. */\n  readonly onChange?: (event: React.FormEvent<HTMLSelectElement>) => void\n}\n\ninterface ISelectState {\n  /**\n   * An automatically generated id for the input element used to reference\n   * it from the label element. This is generated once via the id pool when the\n   * component is mounted and then released once the component unmounts.\n   */\n  readonly inputId?: string\n}\n\n/**\n * A select element with app-standard styles.\n *\n * Provide `children` elements for the contents of the `select` element.\n */\nexport class Select extends React.Component<ISelectProps, ISelectState> {\n  public componentWillMount() {\n    const friendlyName = this.props.label || 'unknown'\n    const inputId = createUniqueId(`Select_${friendlyName}`)\n\n    this.setState({ inputId })\n  }\n\n  public componentWillUnmount() {\n    if (this.state.inputId) {\n      releaseUniqueId(this.state.inputId)\n    }\n  }\n\n  private renderLabel() {\n    const label = this.props.label\n    const inputId = this.state.inputId\n\n    return label ? <label htmlFor={inputId}>{label}</label> : null\n  }\n\n  public render() {\n    return (\n      <div className=\"select-component\">\n        {this.renderLabel()}\n        <select\n          id={this.state.inputId}\n          onChange={this.props.onChange}\n          value={this.props.value}\n          defaultValue={this.props.defaultValue}\n        >\n          {this.props.children}\n        </select>\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport * as classNames from 'classnames'\n\ninterface IErrorsProps {\n  /** The class name for the internal element. */\n  readonly className?: string\n}\n\n/**\n * An Errors element with app-standard styles.\n *\n * Provide `children` elements to render as the content for the error element.\n */\nexport class Errors extends React.Component<IErrorsProps, {}> {\n  public render() {\n    const className = classNames('errors-component', this.props.className)\n    return <div className={className}>{this.props.children}</div>\n  }\n}\n","export enum CloneRepositoryTab {\n  DotCom = 0,\n  Enterprise,\n  Generic,\n}\n","import * as React from 'react'\n\n/** A component for monospaced text. */\nexport class Monospaced extends React.Component<{}, {}> {\n  public render() {\n    return <span className=\"monospaced\">{this.props.children}</span>\n  }\n}\n","import { shell } from './app-shell'\nimport { Dispatcher } from './dispatcher/dispatcher'\n\nexport async function openFile(\n  fullPath: string,\n  dispatcher: Dispatcher\n): Promise<void> {\n  const result = await shell.openExternal(`file://${fullPath}`)\n\n  if (!result) {\n    const error = {\n      name: 'no-external-program',\n      message: `Unable to open file ${fullPath} in an external program. Please check you have a program associated with this file extension`,\n    }\n    await dispatcher.postError(error)\n  }\n}\n","import * as React from 'react'\nimport * as Path from 'path'\nimport { clamp } from '../../lib/clamp'\n\ninterface IPathTextProps {\n  /**\n   * The file system path which is to be displayed and, if\n   * necessary, truncated.\n   */\n  readonly path: string\n\n  /**\n   * An optional maximum width that the path should fit.\n   * If omitted the available width is calculated at render\n   * though never updated after the initial measurement.\n   */\n  readonly availableWidth?: number\n}\n\ninterface IPathDisplayState {\n  /**\n   * The normalized version of the path prop. Normalization in this\n   * instance refers to formatting of the path in a platform specific\n   * way, see Path.normalize for more information.\n   */\n  readonly normalizedPath: string\n\n  readonly directoryText: string\n  readonly fileText: string\n\n  /**\n   * The current number of characters that the normalizedPath is to\n   * be truncated to.\n   */\n  readonly length: number\n}\n\ninterface IPathTextState extends IPathDisplayState {\n  /**\n   * The maximum available width for the path. This corresponds\n   * to the availableWidth prop if one was specified, if not it's\n   * calculated at render time.\n   */\n  readonly availableWidth?: number\n\n  /**\n   * The measured width of the normalized path without any truncation.\n   * We can use this value to optimize and avoid re-measuring the\n   * string when the width increases.\n   */\n  readonly fullTextWidth?: number\n\n  /**\n   * The smallest number of characters that we've tried and found\n   * to be too wide to fit.\n   */\n  readonly shortestNonFit?: number\n\n  /**\n   * The highest number of characters that we've tried and found\n   * to fit inside the available space.\n   */\n  readonly longestFit: number\n}\n\n/**\n * Truncates the given string to the number of characters given by\n * the length parameter. The value is truncated (if necessary) by\n * removing characters from the middle of the string and inserting\n * an ellipsis in their place until the value fits within the alloted\n * number of characters.\n */\nexport function truncateMid(value: string, length: number) {\n  if (value.length <= length) {\n    return value\n  }\n\n  if (length <= 0) {\n    return ''\n  }\n\n  if (length === 1) {\n    return ''\n  }\n\n  const mid = (length - 1) / 2\n  const pre = value.substr(0, Math.floor(mid))\n  const post = value.substr(value.length - Math.ceil(mid))\n\n  return `${pre}${post}`\n}\n\n/**\n * String truncation for paths.\n *\n * This method takes a path and returns it truncated (if necessary)\n * to the exact number of characters specified by the length\n * parameter.\n */\nexport function truncatePath(path: string, length: number) {\n  if (path.length <= length) {\n    return path\n  }\n\n  if (length <= 0) {\n    return ''\n  }\n\n  if (length === 1) {\n    return ''\n  }\n\n  const lastSeparator = path.lastIndexOf(Path.sep)\n\n  // No directory prefix, fall back to middle ellipsis\n  if (lastSeparator === -1) {\n    return truncateMid(path, length)\n  }\n\n  const filenameLength = path.length - lastSeparator - 1\n\n  // File name prefixed with / would be too long, fall back\n  // to middle ellipsis.\n  if (filenameLength + 2 > length) {\n    return truncateMid(path, length)\n  }\n\n  const pre = path.substr(0, length - filenameLength - 2)\n  const post = path.substr(lastSeparator)\n\n  return `${pre}${post}`\n}\n\n/**\n * Extract the filename and directory from a given normalized path\n *\n * @param normalizedPath The normalized path (i.e. no '.' or '..' characters in path)\n */\nexport function extract(\n  normalizedPath: string\n): { normalizedFileName: string; normalizedDirectory: string } {\n  // for untracked submodules, the status entry is returned as a directory,\n  // with a trailing / which causes the directory to be trimmed in a weird way\n  // below. let's try and resolve this here\n  normalizedPath = normalizedPath.endsWith('/')\n    ? normalizedPath.substr(0, normalizedPath.length - 1)\n    : normalizedPath\n\n  const normalizedFileName = Path.basename(normalizedPath)\n  const normalizedDirectory = normalizedPath.substr(\n    0,\n    normalizedPath.length - normalizedFileName.length\n  )\n\n  return { normalizedFileName, normalizedDirectory }\n}\n\nfunction createPathDisplayState(\n  normalizedPath: string,\n  length?: number\n): IPathDisplayState {\n  length = length === undefined ? normalizedPath.length : length\n\n  if (length <= 0) {\n    return { normalizedPath, directoryText: '', fileText: '', length }\n  }\n\n  const { normalizedFileName, normalizedDirectory } = extract(normalizedPath)\n\n  // Happy path when it already fits, we already know the length of the directory\n  if (length >= normalizedPath.length) {\n    return {\n      normalizedPath,\n      directoryText: normalizedDirectory,\n      fileText: normalizedFileName,\n      length,\n    }\n  }\n\n  const truncatedPath = truncatePath(normalizedPath, length)\n  let directoryLength = 0\n\n  // Attempt to determine how much of the truncated path is the directory prefix\n  // vs the filename (basename). It does so by comparing each character in the\n  // normalized directory prefix to the truncated path, as long as it's a match\n  // we know that it's a directory name.\n  for (\n    let i = 0;\n    i < truncatedPath.length && i < normalizedDirectory.length;\n    i++\n  ) {\n    const normalizedChar = normalizedDirectory[i]\n    const truncatedChar = truncatedPath[i]\n\n    if (normalizedChar === truncatedChar) {\n      directoryLength++\n    } else {\n      // We're no longer matching the directory prefix but if the following\n      // characters is '' or '/' we'll count those towards the directory\n      // as well, this is purely an aesthetic choice.\n      if (truncatedChar === '') {\n        directoryLength++\n        const nextTruncatedIx = i + 1\n\n        // Do we have one more character to read? Is is a path separator?\n        if (truncatedPath.length > nextTruncatedIx) {\n          if (truncatedPath[nextTruncatedIx] === Path.sep) {\n            directoryLength++\n          }\n        }\n      }\n      break\n    }\n  }\n\n  const fileText = truncatedPath.substr(directoryLength)\n  const directoryText = truncatedPath.substr(0, directoryLength)\n\n  return { normalizedPath, directoryText, fileText, length }\n}\n\nfunction createState(path: string, length?: number): IPathTextState {\n  const normalizedPath = Path.normalize(path)\n  return {\n    normalizedPath,\n    longestFit: 0,\n    shortestNonFit: undefined,\n    availableWidth: undefined,\n    fullTextWidth: undefined,\n    ...createPathDisplayState(normalizedPath, length),\n  }\n}\n\n/**\n * A component for displaying a path (rooted or relative) with truncation\n * if necessary.\n *\n * If the path needs to be truncated this component will set its title element\n * to the full path such that it can be seen by hovering the path text.\n */\nexport class PathText extends React.PureComponent<\n  IPathTextProps,\n  IPathTextState\n> {\n  private pathElement: HTMLDivElement | null = null\n  private pathInnerElement: HTMLSpanElement | null = null\n\n  public constructor(props: IPathTextProps) {\n    super(props)\n    this.state = createState(props.path)\n  }\n\n  public componentWillReceiveProps(nextProps: IPathTextProps) {\n    if (nextProps.path !== this.props.path) {\n      this.setState(createState(nextProps.path))\n    }\n  }\n\n  public componentDidMount() {\n    this.resizeIfNecessary()\n  }\n\n  public componentDidUpdate() {\n    this.resizeIfNecessary()\n  }\n\n  private onPathElementRef = (element: HTMLDivElement | null) => {\n    this.pathElement = element\n  }\n\n  private onPathInnerElementRef = (element: HTMLSpanElement | null) => {\n    this.pathInnerElement = element\n  }\n\n  public render() {\n    const directoryElement =\n      this.state.directoryText && this.state.directoryText.length ? (\n        <span className=\"dirname\">{this.state.directoryText}</span>\n      ) : null\n\n    const truncated = this.state.length < this.state.normalizedPath.length\n    const title = truncated ? this.state.normalizedPath : undefined\n\n    return (\n      <div\n        className=\"path-text-component\"\n        ref={this.onPathElementRef}\n        title={title}\n      >\n        <span ref={this.onPathInnerElementRef}>\n          {directoryElement}\n          <span className=\"filename\">{this.state.fileText}</span>\n        </span>\n      </div>\n    )\n  }\n\n  private resizeIfNecessary() {\n    if (!this.pathElement || !this.pathInnerElement) {\n      return\n    }\n\n    const computedAvailableWidth =\n      this.props.availableWidth !== undefined\n        ? this.props.availableWidth\n        : this.pathElement.getBoundingClientRect().width\n\n    const availableWidth = Math.max(computedAvailableWidth, 0)\n\n    // Can we fit the entire path in the available width?\n    if (\n      this.state.fullTextWidth !== undefined &&\n      this.state.fullTextWidth <= availableWidth\n    ) {\n      // Are we already doing so?\n      if (this.state.length === this.state.normalizedPath.length) {\n        // Yeay, happy path, we're already displaying the full path and it\n        // fits in our new available width. Nothing left to do.\n        //\n        // This conditional update isn't strictly necessary but it'll save\n        // us one round of comparisons in the PureComponent shallowCompare\n        if (availableWidth !== this.state.availableWidth) {\n          this.setState({ ...this.state, availableWidth })\n        }\n\n        return\n      } else {\n        // We _can_ fit the entire path inside the available width but we're\n        // not doing so right now. Let's make sure we do by keeping all the\n        // state properties and updating the availableWidth and setting length\n        // to the maximum number of characters available.\n        this.setState({\n          ...this.state,\n          ...createPathDisplayState(this.state.normalizedPath),\n          availableWidth,\n        })\n\n        return\n      }\n    }\n\n    // The available width has changed from underneath us\n    if (\n      this.state.availableWidth !== undefined &&\n      this.state.availableWidth !== availableWidth\n    ) {\n      // Keep the current length as that's likely a good starting point\n      const resetState = createState(this.props.path, this.state.length)\n\n      if (availableWidth < this.state.availableWidth) {\n        // We've gotten less space to work with so we can keep our shortest non-fit since\n        // that's still valid\n        this.setState({\n          ...resetState,\n          fullTextWidth: this.state.fullTextWidth,\n          shortestNonFit: this.state.shortestNonFit,\n          availableWidth,\n        })\n      } else if (availableWidth > this.state.availableWidth) {\n        // We've gotten more space to work with so we can keep our longest fit since\n        // that's still valid.\n        this.setState({\n          ...resetState,\n          fullTextWidth: this.state.fullTextWidth,\n          longestFit: this.state.longestFit,\n          availableWidth,\n        })\n      }\n\n      return\n    }\n\n    // Optimization, if we know that we can't fit anything we can avoid a reflow\n    // by not measuring the actual width.\n    if (availableWidth === 0) {\n      if (this.state.length !== 0) {\n        this.setState({\n          ...this.state,\n          ...createPathDisplayState(this.state.normalizedPath, 0),\n          availableWidth,\n          longestFit: 0,\n          shortestNonFit: 1,\n        })\n      }\n      return\n    }\n\n    const actualWidth = this.pathInnerElement.getBoundingClientRect().width\n\n    // Did we just measure the full path? If so let's persist it in state, if\n    // not we'll just take what we've got (could be nothing) and persist that\n    const fullTextWidth =\n      this.state.length === this.state.normalizedPath.length\n        ? actualWidth\n        : this.state.fullTextWidth\n\n    // We shouldn't get into this state but if we do, guard against division by zero\n    // and use a normal binary search ratio.\n    const ratio = actualWidth === 0 ? 0.5 : availableWidth / actualWidth\n\n    // It fits!\n    if (actualWidth <= availableWidth) {\n      // We're done, the entire path fits\n      if (this.state.length === this.state.normalizedPath.length) {\n        this.setState({ ...this.state, availableWidth, fullTextWidth })\n        return\n      } else {\n        // There might be more space to fill\n        const longestFit = this.state.length\n        const maxChars =\n          this.state.shortestNonFit !== undefined\n            ? this.state.shortestNonFit - 1\n            : this.state.normalizedPath.length\n\n        const minChars = longestFit + 1\n\n        // We've run out of options, it fits here but we can't grow any further, i.e\n        // we're done.\n        if (minChars >= maxChars) {\n          this.setState({\n            ...this.state,\n            longestFit,\n            availableWidth,\n            fullTextWidth,\n          })\n          return\n        }\n\n        // Optimization, if our available space for growth is less than 3px it's unlikely\n        // that we'll be able to fit any more characters in here. Note that this is very\n        // much an optimization for our specific styles and it also assumes that the\n        // directory and file name spans are styled similarly. Another approach could be\n        // to calculated the average width of a character when we're measuring the full\n        // width and use that instead but this works pretty well for now and lets us\n        // avoid one more measure phase.\n        if (availableWidth - actualWidth < 3) {\n          this.setState({\n            ...this.state,\n            longestFit,\n            availableWidth,\n            fullTextWidth,\n          })\n          return\n        }\n\n        const length = clamp(\n          Math.floor(this.state.length * ratio),\n          minChars,\n          maxChars\n        )\n\n        // We could potentially fit more characters, there's room to try so we'll go for it\n        this.setState({\n          ...this.state,\n          ...createPathDisplayState(this.state.normalizedPath, length),\n          longestFit,\n          availableWidth,\n          fullTextWidth,\n        })\n      }\n    } else {\n      // Okay, so it didn't quite fit, let's trim it down a little\n      const shortestNonFit = this.state.length\n\n      const maxChars = shortestNonFit - 1\n      const minChars = this.state.longestFit || 0\n\n      const length = clamp(\n        Math.floor(this.state.length * ratio),\n        minChars,\n        maxChars\n      )\n\n      this.setState({\n        ...this.state,\n        ...createPathDisplayState(this.state.normalizedPath, length),\n        shortestNonFit,\n        availableWidth,\n        fullTextWidth,\n      })\n    }\n  }\n}\n","import * as React from 'react'\n\nimport { AppFileStatus } from '../../models/status'\nimport { Octicon, OcticonSymbol } from '../octicons'\nimport { PathText } from './path-text'\n\ninterface IPathLabelProps {\n  /** the current path of the file */\n  readonly path: string\n  /** the previous path of the file, if applicable */\n  readonly oldPath?: string\n  /** the type of change applied to the file */\n  readonly status: AppFileStatus\n\n  readonly availableWidth?: number\n}\n\n/** The pixel width reserved to give the resize arrow padding on either side. */\nconst ResizeArrowPadding = 10\n\n/**\n * Render the path details for a given file.\n *\n * For renames, this will render the old path as well as the current path.\n * For other scenarios, only the current path is rendered.\n *\n */\nexport class PathLabel extends React.Component<IPathLabelProps, {}> {\n  public render() {\n    const props: React.HTMLProps<HTMLLabelElement> = {\n      className: 'path',\n    }\n\n    const status = this.props.status\n    const renderBothPaths =\n      status === AppFileStatus.Renamed || status === AppFileStatus.Copied\n\n    const availableWidth = this.props.availableWidth\n    if (renderBothPaths && this.props.oldPath) {\n      const segmentWidth = availableWidth\n        ? availableWidth / 2 - ResizeArrowPadding\n        : undefined\n      return (\n        <label {...props}>\n          <PathText path={this.props.oldPath} availableWidth={segmentWidth} />\n          <Octicon className=\"rename-arrow\" symbol={OcticonSymbol.arrowRight} />\n          <PathText path={this.props.path} availableWidth={segmentWidth} />\n        </label>\n      )\n    } else {\n      return (\n        <label {...props}>\n          <PathText path={this.props.path} availableWidth={availableWidth} />\n        </label>\n      )\n    }\n  }\n}\n","import * as React from 'react'\nimport { encodePathAsUrl } from '../../lib/path'\nimport { IAvatarUser } from '../../models/avatar'\nimport { fetchAvatarUrl } from './avatar-in-memory-cache'\n\nconst DefaultAvatarURL = encodePathAsUrl(__dirname, 'static/default-avatar.png')\n\ninterface IAvatarProps {\n  /** The user whose avatar should be displayed. */\n  readonly user?: IAvatarUser\n\n  /**\n   * The title of the avatar.\n   * Defaults to the name and email if undefined and is\n   * skipped completely if title is null\n   */\n  readonly title?: string | null\n}\n\ninterface IAvatarState {\n  readonly dataUrl?: string\n}\n\n/** A component for displaying a user avatar. */\nexport class Avatar extends React.Component<IAvatarProps, IAvatarState> {\n  private cancelFetchingAvatar = false\n\n  public constructor(props: IAvatarProps) {\n    super(props)\n\n    this.state = { dataUrl: DefaultAvatarURL }\n  }\n\n  public shouldComponentUpdate(\n    nextProps: IAvatarProps,\n    nextState: IAvatarState\n  ) {\n    if (nextState.dataUrl !== this.state.dataUrl) {\n      return true\n    }\n\n    if (nextProps.user && this.props.user) {\n      if (\n        nextProps.user.avatarURL !== this.props.user.avatarURL ||\n        nextProps.user.email !== this.props.user.email ||\n        nextProps.user.name !== this.props.user.name ||\n        nextProps.title !== this.props.title\n      ) {\n        return true\n      }\n    }\n\n    if (!nextProps.user && !this.props.user) {\n      return nextProps.title !== this.props.title\n    }\n\n    return false\n  }\n\n  public async componentWillMount() {\n    const dataUrl = await fetchAvatarUrl(DefaultAvatarURL, this.props.user)\n\n    // https://reactjs.org/blog/2015/12/16/ismounted-antipattern.html\n    // We're basically doing isMounted here. Let's look at better ways\n    // in the future\n    if (!this.cancelFetchingAvatar) {\n      this.setState({ dataUrl })\n    }\n  }\n\n  public async componentWillReceiveProps(nextProps: IAvatarProps) {\n    const dataUrl = await fetchAvatarUrl(DefaultAvatarURL, nextProps.user)\n\n    // https://reactjs.org/blog/2015/12/16/ismounted-antipattern.html\n    // We're basically doing isMounted here. Let's look at better ways\n    // in the future\n    if (!this.cancelFetchingAvatar) {\n      this.setState({ dataUrl })\n    }\n  }\n\n  public componentWillUnmount() {\n    this.cancelFetchingAvatar = true\n  }\n\n  private getTitle(): string | undefined {\n    if (this.props.title === null) {\n      return undefined\n    }\n\n    if (this.props.title === undefined) {\n      return this.props.title\n    }\n\n    const user = this.props.user\n    if (user) {\n      const name = user.name\n      if (name) {\n        return `${name} <${user.email}>`\n      } else {\n        return user.email\n      }\n    }\n\n    return 'Unknown user'\n  }\n\n  public render() {\n    const title = this.getTitle()\n    const ariaLabel = this.props.user\n      ? `Avatar for ${this.props.user.name || this.props.user.email}`\n      : `Avatar for unknown user`\n\n    const img = (\n      <img\n        className=\"avatar\"\n        title={title}\n        src={this.state.dataUrl}\n        alt={title}\n        aria-label={ariaLabel}\n      />\n    )\n\n    if (title === undefined) {\n      return img\n    }\n\n    return (\n      <span title={title} className=\"avatar-container\">\n        {img}\n      </span>\n    )\n  }\n}\n","/** A utility class which allows for throttling arbitrary functions */\nexport class ThrottledScheduler {\n  private delay: number\n  private timeoutId: number | null = null\n\n  /**\n   * Initialize a new instance of the ThrottledScheduler class\n   *\n   * @param delay The minimum interval between invocations\n   *                  of callbacks.\n   */\n  public constructor(delay: number) {\n    this.delay = delay\n  }\n\n  /**\n   * Queues a function to be invoked at the end of the timeout\n   * window specified by the {delay} class parameter as long\n   * as no other functions are queued.\n   */\n  public queue(func: Function) {\n    this.clear()\n    this.timeoutId = window.setTimeout(func, this.delay)\n  }\n\n  /** Resets the scheduler and unschedules queued callback (if any) */\n  public clear() {\n    if (this.timeoutId != null) {\n      window.clearTimeout(this.timeoutId)\n    }\n  }\n}\n","(function() {\n  var computeScore, countDir, file_coeff, getExtension, getExtensionScore, isMatch, scorePath, scoreSize, tau_depth, _ref;\n\n  _ref = require('./scorer'), isMatch = _ref.isMatch, computeScore = _ref.computeScore, scoreSize = _ref.scoreSize;\n\n  tau_depth = 20;\n\n  file_coeff = 2.5;\n\n  exports.score = function(string, query, options) {\n    var allowErrors, preparedQuery, score, string_lw;\n    preparedQuery = options.preparedQuery, allowErrors = options.allowErrors;\n    if (!(allowErrors || isMatch(string, preparedQuery.core_lw, preparedQuery.core_up))) {\n      return 0;\n    }\n    string_lw = string.toLowerCase();\n    score = computeScore(string, string_lw, preparedQuery);\n    score = scorePath(string, string_lw, score, options);\n    return Math.ceil(score);\n  };\n\n  scorePath = function(subject, subject_lw, fullPathScore, options) {\n    var alpha, basePathScore, basePos, depth, end, extAdjust, fileLength, pathSeparator, preparedQuery, useExtensionBonus;\n    if (fullPathScore === 0) {\n      return 0;\n    }\n    preparedQuery = options.preparedQuery, useExtensionBonus = options.useExtensionBonus, pathSeparator = options.pathSeparator;\n    end = subject.length - 1;\n    while (subject[end] === pathSeparator) {\n      end--;\n    }\n    basePos = subject.lastIndexOf(pathSeparator, end);\n    fileLength = end - basePos;\n    extAdjust = 1.0;\n    if (useExtensionBonus) {\n      extAdjust += getExtensionScore(subject_lw, preparedQuery.ext, basePos, end, 2);\n      fullPathScore *= extAdjust;\n    }\n    if (basePos === -1) {\n      return fullPathScore;\n    }\n    depth = preparedQuery.depth;\n    while (basePos > -1 && depth-- > 0) {\n      basePos = subject.lastIndexOf(pathSeparator, basePos - 1);\n    }\n    basePathScore = basePos === -1 ? fullPathScore : extAdjust * computeScore(subject.slice(basePos + 1, end + 1), subject_lw.slice(basePos + 1, end + 1), preparedQuery);\n    alpha = 0.5 * tau_depth / (tau_depth + countDir(subject, end + 1, pathSeparator));\n    return alpha * basePathScore + (1 - alpha) * fullPathScore * scoreSize(0, file_coeff * fileLength);\n  };\n\n  exports.countDir = countDir = function(path, end, pathSeparator) {\n    var count, i;\n    if (end < 1) {\n      return 0;\n    }\n    count = 0;\n    i = -1;\n    while (++i < end && path[i] === pathSeparator) {\n      continue;\n    }\n    while (++i < end) {\n      if (path[i] === pathSeparator) {\n        count++;\n        while (++i < end && path[i] === pathSeparator) {\n          continue;\n        }\n      }\n    }\n    return count;\n  };\n\n  exports.getExtension = getExtension = function(str) {\n    var pos;\n    pos = str.lastIndexOf(\".\");\n    if (pos < 0) {\n      return \"\";\n    } else {\n      return str.substr(pos + 1);\n    }\n  };\n\n  getExtensionScore = function(candidate, ext, startPos, endPos, maxDepth) {\n    var m, matched, n, pos;\n    if (!ext.length) {\n      return 0;\n    }\n    pos = candidate.lastIndexOf(\".\", endPos);\n    if (!(pos > startPos)) {\n      return 0;\n    }\n    n = ext.length;\n    m = endPos - pos;\n    if (m < n) {\n      n = m;\n      m = ext.length;\n    }\n    pos++;\n    matched = -1;\n    while (++matched < n) {\n      if (candidate[pos + matched] !== ext[matched]) {\n        break;\n      }\n    }\n    if (matched === 0 && maxDepth > 0) {\n      return 0.9 * getExtensionScore(candidate, ext, startPos, pos - 2, maxDepth - 1);\n    }\n    return matched / m;\n  };\n\n}).call(this);\n","// extracted from underscore, which in itself comes from Python\n// https://github.com/jashkenas/underscore/blob/fc039f6a94fcf388d2b61ced4c02cd1ba116ecfd/underscore.js#L693-L710\n\nexport function range(\n  start: number,\n  stop: number,\n  step?: number\n): ReadonlyArray<number> {\n  if (stop === null) {\n    stop = start || 0\n    start = 0\n  }\n\n  if (!step) {\n    step = stop < start ? -1 : 1\n  }\n\n  const length = Math.max(Math.ceil((stop - start) / step), 0)\n  const range = new Array<number>(length)\n\n  for (let idx = 0; idx < length; idx++, start += step) {\n    range[idx] = start\n  }\n\n  return range\n}\n","import * as React from 'react'\nimport * as classNames from 'classnames'\n\ninterface IFocusContainerProps {\n  readonly className?: string\n  readonly onClick?: (event: React.MouseEvent<HTMLDivElement>) => void\n  readonly onKeyDown?: (event: React.KeyboardEvent<HTMLDivElement>) => void\n\n  /** Callback used when focus is within container */\n  readonly onFocusWithinChanged?: (focusWithin: boolean) => void\n}\n\ninterface IFocusContainerState {\n  readonly focusWithin: boolean\n}\n\n/**\n * A helper component which appends a classname to a wrapper\n * element if any of its descendant nodes currently has\n * keyboard focus.\n *\n * In other words it's a little workaround that lets use\n * use `:focus-within`\n *   https://developer.mozilla.org/en-US/docs/Web/CSS/:focus-within\n * even though it's not supported in our current version\n * of chromium (it'll be in 60 or 61 depending on who you trust)\n */\nexport class FocusContainer extends React.Component<\n  IFocusContainerProps,\n  IFocusContainerState\n> {\n  private wrapperRef: HTMLDivElement | null = null\n  private focusWithinChangedTimeoutId: number | null = null\n\n  public constructor(props: IFocusContainerProps) {\n    super(props)\n    this.state = { focusWithin: false }\n  }\n\n  /**\n   * Update the focus state of the container, aborting any in-flight animation\n   *\n   * @param focusWithin the new focus state of the control\n   */\n  private onFocusWithinChanged(focusWithin: boolean) {\n    this.setState({ focusWithin })\n\n    if (this.focusWithinChangedTimeoutId !== null) {\n      cancelAnimationFrame(this.focusWithinChangedTimeoutId)\n      this.focusWithinChangedTimeoutId = null\n    }\n\n    this.focusWithinChangedTimeoutId = requestAnimationFrame(() => {\n      if (this.props.onFocusWithinChanged) {\n        this.props.onFocusWithinChanged(focusWithin)\n      }\n\n      this.focusWithinChangedTimeoutId = null\n    })\n  }\n\n  private onWrapperRef = (elem: HTMLDivElement) => {\n    if (elem) {\n      elem.addEventListener('focusin', () => {\n        this.onFocusWithinChanged(true)\n      })\n\n      elem.addEventListener('focusout', () => {\n        this.onFocusWithinChanged(false)\n      })\n    }\n\n    this.wrapperRef = elem\n  }\n\n  private onClick = (e: React.MouseEvent<HTMLDivElement>) => {\n    if (this.props.onClick) {\n      this.props.onClick(e)\n    }\n  }\n\n  private onKeyDown = (e: React.KeyboardEvent<HTMLDivElement>) => {\n    if (this.props.onKeyDown) {\n      this.props.onKeyDown(e)\n    }\n  }\n\n  private onMouseDown = (e: React.MouseEvent<HTMLDivElement>) => {\n    // If someone is clicking on the focuscontainer itself we'll\n    // cancel it, that saves us from having a focusout/in cycle\n    // and a janky focus ring toggle.\n    if (e.target === this.wrapperRef) {\n      e.preventDefault()\n    }\n  }\n\n  public render() {\n    const className = classNames('focus-container', this.props.className, {\n      'focus-within': this.state.focusWithin,\n    })\n\n    return (\n      <div\n        className={className}\n        ref={this.onWrapperRef}\n        onClick={this.onClick}\n        onMouseDown={this.onMouseDown}\n        onKeyDown={this.onKeyDown}\n      >\n        {this.props.children}\n      </div>\n    )\n  }\n}\n","var isObject = require('./$.is-object');\nmodule.exports = function(it){\n  if(!isObject(it))throw TypeError(it + ' is not an object!');\n  return it;\n};","var toString = {}.toString;\n\nmodule.exports = function(it){\n  return toString.call(it).slice(8, -1);\n};","require('./es6.array.iterator');\nvar Iterators = require('./$.iterators');\nIterators.NodeList = Iterators.HTMLCollection = Iterators.Array;","var def = require('./$').setDesc\n  , has = require('./$.has')\n  , TAG = require('./$.wks')('toStringTag');\n\nmodule.exports = function(it, tag, stat){\n  if(it && !has(it = stat ? it : it.prototype, TAG))def(it, TAG, {configurable: true, value: tag});\n};","var hasOwnProperty = {}.hasOwnProperty;\nmodule.exports = function(it, key){\n  return hasOwnProperty.call(it, key);\n};","module.exports = function(bitmap, value){\n  return {\n    enumerable  : !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable    : !(bitmap & 4),\n    value       : value\n  };\n};","var $          = require('./$')\n  , createDesc = require('./$.property-desc');\nmodule.exports = require('./$.descriptors') ? function(object, key, value){\n  return $.setDesc(object, key, createDesc(1, value));\n} : function(object, key, value){\n  object[key] = value;\n  return object;\n};","'use strict';\nvar $at  = require('./$.string-at')(true);\n\n// 21.1.3.27 String.prototype[@@iterator]()\nrequire('./$.iter-define')(String, 'String', function(iterated){\n  this._t = String(iterated); // target\n  this._i = 0;                // next index\n// 21.1.5.2.1 %StringIteratorPrototype%.next()\n}, function(){\n  var O     = this._t\n    , index = this._i\n    , point;\n  if(index >= O.length)return {value: undefined, done: true};\n  point = $at(O, index);\n  this._i += point.length;\n  return {value: point, done: false};\n});","// most Object methods by ES6 should accept primitives\nvar $export = require('./$.export')\n  , core    = require('./$.core')\n  , fails   = require('./$.fails');\nmodule.exports = function(KEY, exec){\n  var fn  = (core.Object || {})[KEY] || Object[KEY]\n    , exp = {};\n  exp[KEY] = exec(fn);\n  $export($export.S + $export.F * fails(function(){ fn(1); }), 'Object', exp);\n};","// 7.2.1 RequireObjectCoercible(argument)\nmodule.exports = function(it){\n  if(it == undefined)throw TypeError(\"Can't call method on  \" + it);\n  return it;\n};","// 7.1.13 ToObject(argument)\nvar defined = require('./$.defined');\nmodule.exports = function(it){\n  return Object(defined(it));\n};","/**\n * This is the magic remote name prefix\n * for when we add a remote on behalf of\n * the user.\n */\nexport const ForkedRemotePrefix = 'github-desktop-'\n\nexport function forkPullRequestRemoteName(remoteName: string) {\n  return `${ForkedRemotePrefix}${remoteName}`\n}\n\n/** A remote as defined in Git. */\nexport interface IRemote {\n  readonly name: string\n  readonly url: string\n}\n","import { CommitIdentity } from './commit-identity'\nimport { ITrailer, isCoAuthoredByTrailer } from '../lib/git/interpret-trailers'\nimport { GitAuthor } from './git-author'\nimport { GitHubRepository } from './github-repository'\nimport { getDotComAPIEndpoint } from '../lib/api'\n\n/**\n * Extract any Co-Authored-By trailers from an array of arbitrary\n * trailers.\n */\nfunction extractCoAuthors(trailers: ReadonlyArray<ITrailer>) {\n  const coAuthors = []\n\n  for (const trailer of trailers) {\n    if (isCoAuthoredByTrailer(trailer)) {\n      const author = GitAuthor.parse(trailer.value)\n      if (author) {\n        coAuthors.push(author)\n      }\n    }\n  }\n\n  return coAuthors\n}\n\n/** A git commit. */\nexport class Commit {\n  /**\n   * A list of co-authors parsed from the commit message\n   * trailers.\n   */\n  public readonly coAuthors: ReadonlyArray<GitAuthor>\n\n  /**\n   * A value indicating whether the author and the committer\n   * are the same person.\n   */\n  public readonly authoredByCommitter: boolean\n\n  /**\n   * @param sha The commit's SHA.\n   * @param summary The first line of the commit message.\n   * @param body The commit message without the first line and CR.\n   * @param author Information about the author of this commit.\n   *               Includes name, email and date.\n   * @param committer Information about the committer of this commit.\n   *                 Includes name, email and date.\n   * @param parentSHAS The SHAs for the parents of the commit.\n   * @param trailers Parsed, unfolded trailers from the commit message body,\n   *                 if any, as interpreted by `git interpret-trailers`\n   */\n  public constructor(\n    public readonly sha: string,\n    public readonly summary: string,\n    public readonly body: string,\n    public readonly author: CommitIdentity,\n    public readonly committer: CommitIdentity,\n    public readonly parentSHAs: ReadonlyArray<string>,\n    public readonly trailers: ReadonlyArray<ITrailer>\n  ) {\n    this.coAuthors = extractCoAuthors(trailers)\n\n    this.authoredByCommitter =\n      this.author.name === this.committer.name &&\n      this.author.email === this.committer.email\n  }\n\n  /**\n   * Best-effort attempt to figure out if this commit was committed using\n   * the web flow on GitHub.com or GitHub Enterprise. Web flow\n   * commits (such as PR merges) will have a special GitHub committer\n   * with a noreply email address.\n   *\n   * For GitHub.com we can be spot on but for GitHub Enterprise it's\n   * possible we could fail if they've set up a custom smtp host\n   * that doesn't correspond to the hostname.\n   */\n  public isWebFlowCommitter(gitHubRepository: GitHubRepository) {\n    if (!gitHubRepository) {\n      return false\n    }\n\n    const endpoint = gitHubRepository.owner.endpoint\n    const { name, email } = this.committer\n\n    if (\n      endpoint === getDotComAPIEndpoint() &&\n      name === 'GitHub' &&\n      email === 'noreply@github.com'\n    ) {\n      return true\n    }\n\n    if (this.committer.name === 'GitHub Enterprise') {\n      const host = new URL(endpoint).host.toLowerCase()\n      return email.endsWith(`@${host}`)\n    }\n\n    return false\n  }\n}\n","'use strict'\n\nconst u = require('universalify').fromCallback\nconst jsonFile = require('jsonfile')\n\nmodule.exports = {\n  // jsonfile exports\n  readJson: u(jsonFile.readFile),\n  readJsonSync: jsonFile.readFileSync,\n  writeJson: u(jsonFile.writeFile),\n  writeJsonSync: jsonFile.writeFileSync\n}\n","let measuringPerf = false\nlet markID = 0\n\n/** Start capturing git performance measurements. */\nexport function start() {\n  measuringPerf = true\n}\n\n/** Stop capturing git performance measurements. */\nexport function stop() {\n  measuringPerf = false\n}\n\n/** Measure an async git operation. */\nexport async function measure<T>(\n  cmd: string,\n  fn: () => Promise<T>\n): Promise<T> {\n  const id = ++markID\n\n  log.debug(`Executing ${cmd}`)\n  const startTime = performance && performance.now ? performance.now() : null\n\n  markBegin(id, cmd)\n  try {\n    return await fn()\n  } finally {\n    if (startTime) {\n      const rawTime = performance.now() - startTime\n      if (rawTime > 1000) {\n        const timeInSeconds = (rawTime / 1000).toFixed(3)\n        log.info(`Executing ${cmd} (took ${timeInSeconds}s)`)\n      }\n    }\n\n    markEnd(id, cmd)\n  }\n}\n\n/** Mark the beginning of a git operation. */\nfunction markBegin(id: number, cmd: string) {\n  if (!measuringPerf) {\n    return\n  }\n\n  const markName = `${id}::${cmd}`\n  performance.mark(markName)\n}\n\n/** Mark the end of a git operation. */\nfunction markEnd(id: number, cmd: string) {\n  if (!measuringPerf) {\n    return\n  }\n\n  const markName = `${id}::${cmd}`\n  const measurementName = cmd\n  performance.measure(measurementName, markName)\n\n  performance.clearMarks(markName)\n  performance.clearMeasures(measurementName)\n}\n","import { getTopLevelWorkingDirectory } from '../../git'\n\n/**\n * Get the path to the parent of the .git directory or null if the path isn't a\n * valid repository.\n */\nexport async function validatedRepositoryPath(\n  path: string\n): Promise<string | null> {\n  try {\n    return await getTopLevelWorkingDirectory(path)\n  } catch (e) {\n    return null\n  }\n}\n","import * as OS from 'os'\nimport { UAParser } from 'ua-parser-js'\n\n/** Get the OS we're currently running on. */\nexport function getOS() {\n  if (__DARWIN__) {\n    // On macOS, OS.release() gives us the kernel version which isn't terribly\n    // meaningful to any human being, so we'll parse the User Agent instead.\n    // See https://github.com/desktop/desktop/issues/1130.\n    const parser = new UAParser()\n    const os = parser.getOS()\n    return `${os.name} ${os.version}`\n  } else if (__WIN32__) {\n    return `Windows ${OS.release()}`\n  } else {\n    return `${OS.type()} ${OS.release()}`\n  }\n}\n","module.exports = require(\"util\");","module.exports = require(\"crypto\");","const authenticatorAppWelcomeText =\n  'Open the two-factor authentication app on your device to view your authentication code and verify your identity.'\nconst smsMessageWelcomeText =\n  'We just sent you a message via SMS with your authentication code. Enter the code in the form below to verify your identity.'\n\n/**\n * When authentication is requested via 2FA, the endpoint provides\n * a hint in the response header as to where the user should look\n * to retrieve the token.\n */\nexport enum AuthenticationMode {\n  /*\n   * User should authenticate via a received text message.\n   */\n  Sms,\n  /*\n   * User should open TOTP mobile application and obtain code.\n   */\n  App,\n}\n\nexport function getWelcomeMessage(type: AuthenticationMode): string {\n  return type === AuthenticationMode.Sms\n    ? smsMessageWelcomeText\n    : authenticatorAppWelcomeText\n}\n","module.exports = function(module) {\r\n\tif (!module.webpackPolyfill) {\r\n\t\tmodule.deprecate = function() {};\r\n\t\tmodule.paths = [];\r\n\t\t// module.parent = undefined by default\r\n\t\tif (!module.children) module.children = [];\r\n\t\tObject.defineProperty(module, \"loaded\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.l;\r\n\t\t\t}\r\n\t\t});\r\n\t\tObject.defineProperty(module, \"id\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.i;\r\n\t\t\t}\r\n\t\t});\r\n\t\tmodule.webpackPolyfill = 1;\r\n\t}\r\n\treturn module;\r\n};\r\n","(function() {\n  var Disposable;\n\n  module.exports = Disposable = (function() {\n    Disposable.prototype.disposed = false;\n\n    Disposable.isDisposable = function(object) {\n      return typeof (object != null ? object.dispose : void 0) === \"function\";\n    };\n\n\n    /*\n    Section: Construction and Destruction\n     */\n\n    function Disposable(disposalAction) {\n      this.disposalAction = disposalAction;\n    }\n\n    Disposable.prototype.dispose = function() {\n      if (!this.disposed) {\n        this.disposed = true;\n        if (typeof this.disposalAction === \"function\") {\n          this.disposalAction();\n        }\n        this.disposalAction = null;\n      }\n    };\n\n    return Disposable;\n\n  })();\n\n}).call(this);\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = !!(typeof window !== 'undefined' && window.document && window.document.createElement);\nmodule.exports = exports['default'];","\"use strict\";\n\n/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n */\n\nfunction makeEmptyFunction(arg) {\n  return function () {\n    return arg;\n  };\n}\n\n/**\n * This function accepts and discards inputs; it has no side effects. This is\n * primarily useful idiomatically for overridable function endpoints which\n * always need to be callable, since JS lacks a null-call idiom ala Cocoa.\n */\nvar emptyFunction = function emptyFunction() {};\n\nemptyFunction.thatReturns = makeEmptyFunction;\nemptyFunction.thatReturnsFalse = makeEmptyFunction(false);\nemptyFunction.thatReturnsTrue = makeEmptyFunction(true);\nemptyFunction.thatReturnsNull = makeEmptyFunction(null);\nemptyFunction.thatReturnsThis = function () {\n  return this;\n};\nemptyFunction.thatReturnsArgument = function (arg) {\n  return arg;\n};\n\nmodule.exports = emptyFunction;","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\n'use strict';\n\n/**\n * Use invariant() to assert state which your program assumes to be true.\n *\n * Provide sprintf-style format (only %s is supported) and arguments\n * to provide information about what broke and what you were\n * expecting.\n *\n * The invariant message will be stripped in production, but the invariant\n * will remain to ensure logic does not differ in production.\n */\n\nvar validateFormat = function validateFormat(format) {};\n\nif (process.env.NODE_ENV !== 'production') {\n  validateFormat = function validateFormat(format) {\n    if (format === undefined) {\n      throw new Error('invariant requires an error message argument');\n    }\n  };\n}\n\nfunction invariant(condition, format, a, b, c, d, e, f) {\n  validateFormat(format);\n\n  if (!condition) {\n    var error;\n    if (format === undefined) {\n      error = new Error('Minified exception occurred; use the non-minified dev environment ' + 'for the full error message and additional helpful warnings.');\n    } else {\n      var args = [a, b, c, d, e, f];\n      var argIndex = 0;\n      error = new Error(format.replace(/%s/g, function () {\n        return args[argIndex++];\n      }));\n      error.name = 'Invariant Violation';\n    }\n\n    error.framesToPop = 1; // we don't care about invariant's own frame\n    throw error;\n  }\n}\n\nmodule.exports = invariant;","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","export * from './github-user-database'\nexport * from './issues-database'\nexport * from './repositories-database'\nexport * from './pull-request-database'\n","import * as Fs from 'fs'\nimport * as Path from 'path'\n\nconst runas: (\n  command: string,\n  args: ReadonlyArray<string>,\n  options?: { admin: boolean }\n) => number = require('runas')\n\n/** The path for the installed command line tool. */\nexport const InstalledCLIPath = '/usr/local/bin/github'\n\n/** The path to the packaged CLI. */\nconst PackagedPath = Path.resolve(__dirname, 'static', 'github.sh')\n\n/** Install the command line tool on macOS. */\nexport async function installCLI(): Promise<void> {\n  const installedPath = await getResolvedInstallPath()\n  if (installedPath === PackagedPath) {\n    return\n  }\n\n  try {\n    symlinkCLI(false)\n  } catch (e) {\n    // If we error without running as an admin, try again as an admin.\n    symlinkCLI(true)\n  }\n}\n\nasync function getResolvedInstallPath(): Promise<string | null> {\n  return new Promise<string | null>((resolve, reject) => {\n    Fs.readlink(InstalledCLIPath, (err, realpath) => {\n      if (err) {\n        resolve(null)\n      } else {\n        resolve(realpath)\n      }\n    })\n  })\n}\n\nfunction symlinkCLI(asAdmin: boolean) {\n  let exitCode = runas('/bin/rm', ['-f', InstalledCLIPath], { admin: asAdmin })\n  if (exitCode !== 0) {\n    throw new Error(\n      `Failed to remove file at ${InstalledCLIPath}. Authorization of GitHub Desktop Helper is required.`\n    )\n  }\n\n  exitCode = runas('/bin/mkdir', ['-p', Path.dirname(InstalledCLIPath)], {\n    admin: asAdmin,\n  })\n  if (exitCode !== 0) {\n    throw new Error(\n      `Failed to create intermediate directories to ${InstalledCLIPath}`\n    )\n  }\n\n  exitCode = runas('/bin/ln', ['-s', PackagedPath, InstalledCLIPath], {\n    admin: asAdmin,\n  })\n  if (exitCode !== 0) {\n    throw new Error(`Failed to symlink ${PackagedPath} to ${InstalledCLIPath}`)\n  }\n}\n","import * as Path from 'path'\nimport { getDocumentsPath } from './app-proxy'\n\nconst localStorageKey = 'last-clone-location'\n\n/** The path to the default directory. */\nexport function getDefaultDir(): string {\n  return (\n    localStorage.getItem(localStorageKey) ||\n    Path.join(getDocumentsPath(), 'GitHub')\n  )\n}\n\nexport function setDefaultDir(path: string) {\n  localStorage.setItem(localStorageKey, path)\n}\n","export * from './vertical-segmented-control'\n","import * as React from 'react'\nimport * as classNames from 'classnames'\n\nimport { Octicon, OcticonSymbol } from '../octicons'\nimport { MenuItem } from '../../models/app-menu'\nimport { AccessText } from '../lib/access-text'\n\ninterface IMenuListItemProps {\n  readonly item: MenuItem\n\n  /**\n   * Whether or not to highlight the access key of a menu item (if one exists).\n   *\n   * See the highlight prop of AccessText component for more details.\n   */\n  readonly highlightAccessKey: boolean\n\n  /**\n   * Whether or not to render the accelerator (shortcut) next to the label.\n   * This can be turned off when the menu item is used as a stand-alone item\n   *\n   * Defaults to true if not specified (i.e. undefined)\n   */\n  readonly renderAcceleratorText?: boolean\n\n  /**\n   * Whether or not to render an arrow to the right of the label when the\n   * menu item has a submenu. This can be turned off when the menu item is\n   * used as a stand-alone item or when expanding the submenu doesn't follow\n   * the default conventions (i.e. expanding to the right).\n   *\n   * Defaults to true if not specified (i.e. undefined)\n   */\n  readonly renderSubMenuArrow?: boolean\n}\n\n/**\n * Converts Electron accelerator modifiers to their platform specific\n * name or symbol.\n *\n * Example: CommandOrControl becomes either '' or 'Ctrl' depending on platform.\n *\n * See https://github.com/electron/electron/blob/fb74f55/docs/api/accelerator.md\n */\nfunction getPlatformSpecificNameOrSymbolForModifier(modifier: string): string {\n  switch (modifier.toLowerCase()) {\n    case 'cmdorctrl':\n    case 'commandorcontrol':\n      return __DARWIN__ ? '' : 'Ctrl'\n\n    case 'ctrl':\n    case 'control':\n      return __DARWIN__ ? '' : 'Ctrl'\n\n    case 'shift':\n      return __DARWIN__ ? '' : 'Shift'\n    case 'alt':\n      return __DARWIN__ ? '' : 'Alt'\n\n    // Mac only\n    case 'cmd':\n    case 'command':\n      return ''\n    case 'option':\n      return ''\n\n    // Special case space because no one would be able to see it\n    case ' ':\n      return 'Space'\n  }\n\n  // Not a known modifier, likely a normal key\n  return modifier\n}\n\n/**\n * Returns a platform specific human readable version of an Electron\n * accelerator string. See getPlatformSpecificNameOrSymbolForModifier\n * for more information.\n */\nexport function friendlyAcceleratorText(accelerator: string): string {\n  return accelerator\n    .split('+')\n    .map(getPlatformSpecificNameOrSymbolForModifier)\n    .join(__DARWIN__ ? '' : '+')\n}\n\nexport class MenuListItem extends React.Component<IMenuListItemProps, {}> {\n  private getIcon(item: MenuItem): JSX.Element | null {\n    if (item.type === 'checkbox' && item.checked) {\n      return <Octicon className=\"icon\" symbol={OcticonSymbol.check} />\n    } else if (item.type === 'radio' && item.checked) {\n      return <Octicon className=\"icon\" symbol={OcticonSymbol.primitiveDot} />\n    }\n\n    return null\n  }\n\n  public render() {\n    const item = this.props.item\n\n    if (item.type === 'separator') {\n      return <hr />\n    }\n\n    const arrow =\n      item.type === 'submenuItem' && this.props.renderSubMenuArrow !== false ? (\n        <Octicon\n          className=\"submenu-arrow\"\n          symbol={OcticonSymbol.triangleRight}\n        />\n      ) : null\n\n    const accelerator =\n      item.type !== 'submenuItem' &&\n      item.accelerator &&\n      this.props.renderAcceleratorText !== false ? (\n        <div className=\"accelerator\">\n          {friendlyAcceleratorText(item.accelerator)}\n        </div>\n      ) : null\n\n    const className = classNames(\n      'menu-item',\n      { disabled: !item.enabled },\n      { checkbox: item.type === 'checkbox' },\n      { radio: item.type === 'radio' },\n      {\n        checked:\n          (item.type === 'checkbox' || item.type === 'radio') && item.checked,\n      }\n    )\n\n    return (\n      <div className={className}>\n        {this.getIcon(item)}\n        <div className=\"label\">\n          <AccessText\n            text={item.label}\n            highlight={this.props.highlightAccessKey}\n          />\n        </div>\n        {accelerator}\n        {arrow}\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport * as classNames from 'classnames'\n\nimport { List, ClickSource, SelectionSource } from '../lib/list'\nimport {\n  MenuItem,\n  itemIsSelectable,\n  findItemByAccessKey,\n} from '../../models/app-menu'\nimport { MenuListItem } from './menu-list-item'\n\ninterface IMenuPaneProps {\n  /**\n   * An optional classname which will be appended to the 'menu-pane' class\n   */\n  readonly className?: string\n\n  /**\n   * The current Menu pane depth, starts at zero and increments by one for each\n   * open submenu.\n   */\n  readonly depth: number\n\n  /**\n   * All items available in the current menu. Note that this includes disabled\n   * menu items as well as invisible ones. This list is filtered before\n   * rendering.\n   */\n  readonly items: ReadonlyArray<MenuItem>\n\n  /**\n   * The currently selected item in the menu or undefined if no item is\n   * selected.\n   */\n  readonly selectedItem?: MenuItem\n\n  /**\n   * A callback for when a selectable menu item was clicked by a pointer device\n   * or when the Enter or Space key is pressed on a selected item. The source\n   * parameter can be used to determine whether the click is a result of a\n   * pointer device or keyboard.\n   */\n  readonly onItemClicked: (\n    depth: number,\n    item: MenuItem,\n    source: ClickSource\n  ) => void\n\n  /**\n   * A callback for when a keyboard key is pressed on a menu item. Note that\n   * this only picks up on keyboard events received by a MenuItem and does\n   * not cover keyboard events received on the MenuPane component itself.\n   */\n  readonly onItemKeyDown?: (\n    depth: number,\n    item: MenuItem,\n    event: React.KeyboardEvent<any>\n  ) => void\n\n  /**\n   * A callback for when the MenuPane selection changes (i.e. a new menu item is selected).\n   */\n  readonly onSelectionChanged: (\n    depth: number,\n    item: MenuItem,\n    source: SelectionSource\n  ) => void\n\n  /** Callback for when the mouse enters the menu pane component */\n  readonly onMouseEnter?: (depth: number) => void\n\n  /**\n   * Whether or not the application menu was opened with the Alt key, this\n   * enables access key highlighting for applicable menu items as well as\n   * keyboard navigation by pressing access keys.\n   */\n  readonly enableAccessKeyNavigation: boolean\n\n  /**\n   * If true the MenuPane only takes up as much vertical space needed to\n   * show all menu items. This does not affect maximum height, i.e. if the\n   * visible menu items takes up more space than what is available the menu\n   * will still overflow and be scrollable.\n   *\n   * @default false\n   */\n  readonly autoHeight?: boolean\n}\n\ninterface IMenuPaneState {\n  /**\n   * A list of visible menu items that is to be rendered. This is a derivative\n   * of the props items with invisible items filtered out.\n   */\n  readonly items: ReadonlyArray<MenuItem>\n\n  /** The selected row index or -1 if no selection exists. */\n  readonly selectedIndex: number\n}\n\nconst RowHeight = 30\nconst SeparatorRowHeight = 10\n\nfunction getSelectedIndex(\n  selectedItem: MenuItem | undefined,\n  items: ReadonlyArray<MenuItem>\n) {\n  return selectedItem ? items.findIndex(i => i.id === selectedItem.id) : -1\n}\n\nexport function getListHeight(menuItems: ReadonlyArray<MenuItem>) {\n  return menuItems.reduce((acc, item) => acc + getRowHeight(item), 0)\n}\n\nexport function getRowHeight(item: MenuItem) {\n  if (!item.visible) {\n    return 0\n  }\n\n  return item.type === 'separator' ? SeparatorRowHeight : RowHeight\n}\n\n/**\n * Creates a menu pane state given props. This is intentionally not\n * an instance member in order to avoid mistakenly using any other\n * input data or state than the received props.\n */\nfunction createState(props: IMenuPaneProps): IMenuPaneState {\n  const items = new Array<MenuItem>()\n  const selectedItem = props.selectedItem\n\n  let selectedIndex = -1\n\n  // Filter out all invisible items and maintain the correct\n  // selected index (if possible)\n  for (let i = 0; i < props.items.length; i++) {\n    const item = props.items[i]\n\n    if (item.visible) {\n      items.push(item)\n      if (item === selectedItem) {\n        selectedIndex = items.length - 1\n      }\n    }\n  }\n\n  return { items, selectedIndex }\n}\n\nexport class MenuPane extends React.Component<IMenuPaneProps, IMenuPaneState> {\n  private list: List | null = null\n\n  public constructor(props: IMenuPaneProps) {\n    super(props)\n    this.state = createState(props)\n  }\n\n  public componentWillReceiveProps(nextProps: IMenuPaneProps) {\n    // No need to recreate the filtered list if it hasn't changed,\n    // we only have to update the selected item\n    if (this.props.items === nextProps.items) {\n      // Has the selection changed?\n      if (this.props.selectedItem !== nextProps.selectedItem) {\n        const selectedIndex = getSelectedIndex(\n          nextProps.selectedItem,\n          this.state.items\n        )\n        this.setState({ selectedIndex })\n      }\n    } else {\n      this.setState(createState(nextProps))\n    }\n  }\n\n  private onRowClick = (row: number, source: ClickSource) => {\n    const item = this.state.items[row]\n\n    if (item.type !== 'separator' && item.enabled) {\n      this.props.onItemClicked(this.props.depth, item, source)\n    }\n  }\n\n  private onSelectedRowChanged = (row: number, source: SelectionSource) => {\n    const item = this.state.items[row]\n    this.props.onSelectionChanged(this.props.depth, item, source)\n  }\n\n  private onKeyDown = (event: React.KeyboardEvent<any>) => {\n    if (event.defaultPrevented) {\n      return\n    }\n\n    // Modifier keys are handled elsewhere, we only care about letters and symbols\n    if (event.altKey || event.ctrlKey || event.metaKey) {\n      return\n    }\n\n    // If we weren't opened with the Alt key we ignore key presses other than\n    // arrow keys and Enter/Space etc.\n    if (!this.props.enableAccessKeyNavigation) {\n      return\n    }\n\n    // At this point the list will already have intercepted any arrow keys\n    // and the list items themselves will have caught Enter/Space\n    const item = findItemByAccessKey(event.key, this.state.items)\n    if (item && itemIsSelectable(item)) {\n      event.preventDefault()\n      this.props.onSelectionChanged(this.props.depth, item, {\n        kind: 'keyboard',\n        event: event,\n      })\n      this.props.onItemClicked(this.props.depth, item, {\n        kind: 'keyboard',\n        event: event,\n      })\n    }\n  }\n\n  private onRowKeyDown = (row: number, event: React.KeyboardEvent<any>) => {\n    if (this.props.onItemKeyDown) {\n      const item = this.state.items[row]\n      this.props.onItemKeyDown(this.props.depth, item, event)\n    }\n  }\n\n  private canSelectRow = (row: number) => {\n    const item = this.state.items[row]\n    return itemIsSelectable(item)\n  }\n\n  private onListRef = (list: List | null) => {\n    this.list = list\n  }\n\n  private onMouseEnter = (event: React.MouseEvent<any>) => {\n    if (this.props.onMouseEnter) {\n      this.props.onMouseEnter(this.props.depth)\n    }\n  }\n\n  private renderMenuItem = (row: number) => {\n    const item = this.state.items[row]\n\n    return (\n      <MenuListItem\n        key={item.id}\n        item={item}\n        highlightAccessKey={this.props.enableAccessKeyNavigation}\n      />\n    )\n  }\n\n  private rowHeight = (info: { index: number }) => {\n    const item = this.state.items[info.index]\n    return item.type === 'separator' ? SeparatorRowHeight : RowHeight\n  }\n\n  public render(): JSX.Element {\n    const style: React.CSSProperties =\n      this.props.autoHeight === true\n        ? { height: getListHeight(this.props.items) + 5, maxHeight: '100%' }\n        : {}\n\n    const className = classNames('menu-pane', this.props.className)\n\n    return (\n      <div\n        className={className}\n        onMouseEnter={this.onMouseEnter}\n        onKeyDown={this.onKeyDown}\n        style={style}\n      >\n        <List\n          ref={this.onListRef}\n          rowCount={this.state.items.length}\n          rowHeight={this.rowHeight}\n          rowRenderer={this.renderMenuItem}\n          selectedRows={[this.state.selectedIndex]}\n          onRowClick={this.onRowClick}\n          onSelectedRowChanged={this.onSelectedRowChanged}\n          canSelectRow={this.canSelectRow}\n          onRowKeyDown={this.onRowKeyDown}\n          invalidationProps={this.state.items}\n          selectOnHover={true}\n          ariaMode=\"menu\"\n        />\n      </div>\n    )\n  }\n\n  public focus() {\n    if (this.list) {\n      this.list.focus()\n    }\n  }\n}\n","import * as React from 'react'\nimport { MenuPane } from './menu-pane'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { IMenu, MenuItem, ISubmenuItem } from '../../models/app-menu'\nimport { SelectionSource, ClickSource } from '../lib/list'\n\ninterface IAppMenuProps {\n  /**\n   * A list of open menus to be rendered, each menu may have\n   * a selected item.\n   */\n  readonly state: ReadonlyArray<IMenu>\n  readonly dispatcher: Dispatcher\n\n  /**\n   * A required callback for when the app menu is closed. The menu is explicitly\n   * closed when a menu item has been clicked (executed) or when the user\n   * presses Escape on the top level menu pane.\n   *\n   * @param closeSource An object describing the action that caused the menu\n   *                    to close. This can either be a keyboard event (hitting\n   *                    Escape) or the user executing one of the menu items by\n   *                    clicking on them or pressing enter.\n   */\n  readonly onClose: (closeSource: CloseSource) => void\n\n  /**\n   * Whether or not the application menu was opened with the Alt key, this\n   * enables access key highlighting for applicable menu items as well as\n   * keyboard navigation by pressing access keys.\n   */\n  readonly enableAccessKeyNavigation: boolean\n\n  /**\n   * Whether the menu was opened by pressing Alt (or Alt+X where X is an\n   * access key for one of the top level menu items). This is used as a\n   * one-time signal to the AppMenu to use some special semantics for\n   * selection and focus. Specifically it will ensure that the last opened\n   * menu will receive focus.\n   */\n  readonly openedWithAccessKey: boolean\n\n  /**\n   * If true the MenuPane only takes up as much vertical space needed to\n   * show all menu items. This does not affect maximum height, i.e. if the\n   * visible menu items takes up more space than what is available the menu\n   * will still overflow and be scrollable.\n   *\n   * @default false\n   */\n  readonly autoHeight?: boolean\n}\n\nexport interface IKeyboardCloseSource {\n  type: 'keyboard'\n  event: React.KeyboardEvent<HTMLElement>\n}\n\nexport interface IItemExecutedCloseSource {\n  type: 'item-executed'\n}\n\nexport type CloseSource = IKeyboardCloseSource | IItemExecutedCloseSource\n\nconst expandCollapseTimeout = 300\n\n/**\n * Converts a menu pane id into something that's reasonable to use as\n * a classname by replacing forbidden characters and cleaning it\n * up in general.\n */\nfunction menuPaneClassNameFromId(id: string) {\n  const className = id\n    // Get rid of the leading @. for auto-generated ids\n    .replace(/^@\\./, '')\n    // No accelerator key modifier necessary\n    .replace('&', '')\n    // Get rid of stuff that's not safe for css class names\n    .replace(/[^a-z0-9_]+/gi, '-')\n    // Get rid of redundant underscores\n    .replace(/_+/, '_')\n    .toLowerCase()\n\n  return className.length ? `menu-pane-${className}` : undefined\n}\n\nexport class AppMenu extends React.Component<IAppMenuProps, {}> {\n  /**\n   * The index of the menu pane that should receive focus after the\n   * next render. Default value is -1. This field is cleared after\n   * each successful focus operation.\n   */\n  private focusPane: number = -1\n\n  /**\n   * A mapping between pane index (depth) and actual MenuPane instances.\n   * This is used in order to (indirectly) call the focus method on the\n   * underlying List instances.\n   *\n   * See focusPane and ensurePaneFocus\n   */\n  private paneRefs: MenuPane[] = []\n\n  /**\n   * A numeric reference to a setTimeout timer id which is used for\n   * opening and closing submenus after a delay.\n   *\n   * See scheduleExpand and scheduleCollapse\n   */\n  private expandCollapseTimer: number | null = null\n\n  public constructor(props: IAppMenuProps) {\n    super(props)\n    this.focusPane = props.state.length - 1\n    this.receiveProps(null, props)\n  }\n\n  private receiveProps(\n    currentProps: IAppMenuProps | null,\n    nextProps: IAppMenuProps\n  ) {\n    if (nextProps.openedWithAccessKey) {\n      // We only want to react to the openedWithAccessKey prop once, either\n      // when it goes from false to true or when we receive it as our first\n      // prop. By doing it this way we save ourselves having to go through\n      // the dispatcher and updating the value once we've received it.\n      if (!currentProps || !currentProps.openedWithAccessKey) {\n        // Since we were opened with an access key we auto set focus to the\n        // last pane opened.\n        this.focusPane = nextProps.state.length - 1\n      }\n    }\n  }\n\n  private onItemClicked = (\n    depth: number,\n    item: MenuItem,\n    source: ClickSource\n  ) => {\n    this.clearExpandCollapseTimer()\n\n    if (item.type === 'submenuItem') {\n      // Warning: This is a bit of a hack. When using access keys to navigate\n      // to a submenu item we want it not only to expand but to have its first\n      // child item selected by default. We do that by looking to see if the\n      // selection source was a keyboard press and if it wasn't one of the keys\n      // that we'd expect for a 'normal' click event.\n      const sourceIsAccessKey =\n        this.props.enableAccessKeyNavigation &&\n        source.kind === 'keyboard' &&\n        (source.event.key !== 'Enter' && source.event.key !== ' ')\n\n      this.props.dispatcher.setAppMenuState(menu =>\n        menu.withOpenedMenu(item, sourceIsAccessKey)\n      )\n      if (source.kind === 'keyboard') {\n        this.focusPane = depth + 1\n      }\n    } else if (item.type !== 'separator') {\n      // Send the close event before actually executing the item so that\n      // the menu can restore focus to the previously selected element\n      // (if any).\n      this.props.onClose({ type: 'item-executed' })\n      this.props.dispatcher.executeMenuItem(item)\n    }\n  }\n\n  private onItemKeyDown = (\n    depth: number,\n    item: MenuItem,\n    event: React.KeyboardEvent<any>\n  ) => {\n    if (event.key === 'ArrowLeft' || event.key === 'Escape') {\n      this.clearExpandCollapseTimer()\n\n      // Only actually close the foldout when hitting escape\n      // on the root menu\n      if (depth === 0 && event.key === 'Escape') {\n        this.props.onClose({ type: 'keyboard', event })\n        event.preventDefault()\n      } else if (depth > 0) {\n        this.props.dispatcher.setAppMenuState(menu =>\n          menu.withClosedMenu(this.props.state[depth])\n        )\n\n        this.focusPane = depth - 1\n        event.preventDefault()\n      }\n    } else if (event.key === 'ArrowRight') {\n      this.clearExpandCollapseTimer()\n\n      // Open the submenu and select the first item\n      if (item.type === 'submenuItem') {\n        this.props.dispatcher.setAppMenuState(menu =>\n          menu.withOpenedMenu(item, true)\n        )\n        this.focusPane = depth + 1\n        event.preventDefault()\n      }\n    }\n  }\n\n  private clearExpandCollapseTimer() {\n    if (this.expandCollapseTimer) {\n      window.clearTimeout(this.expandCollapseTimer)\n      this.expandCollapseTimer = null\n    }\n  }\n\n  private scheduleExpand(item: ISubmenuItem) {\n    this.clearExpandCollapseTimer()\n    this.expandCollapseTimer = window.setTimeout(() => {\n      this.props.dispatcher.setAppMenuState(menu => menu.withOpenedMenu(item))\n    }, expandCollapseTimeout)\n  }\n\n  private scheduleCollapseTo(menu: IMenu) {\n    this.clearExpandCollapseTimer()\n    this.expandCollapseTimer = window.setTimeout(() => {\n      this.props.dispatcher.setAppMenuState(am => am.withLastMenu(menu))\n    }, expandCollapseTimeout)\n  }\n\n  private onSelectionChanged = (\n    depth: number,\n    item: MenuItem,\n    source: SelectionSource\n  ) => {\n    this.clearExpandCollapseTimer()\n\n    if (source.kind === 'keyboard') {\n      // Immediately close any open submenus if we're navigating by keyboard.\n      this.props.dispatcher.setAppMenuState(appMenu =>\n        appMenu.withSelectedItem(item).withLastMenu(this.props.state[depth])\n      )\n    } else {\n      // If the newly selected item is a submenu we'll wait a bit and then expand\n      // it unless the user makes another selection in between. If it's not then\n      // we'll make sure to collapse any open menu below this level.\n      if (item.type === 'submenuItem') {\n        this.scheduleExpand(item)\n      } else {\n        this.scheduleCollapseTo(this.props.state[depth])\n      }\n\n      this.props.dispatcher.setAppMenuState(menu => menu.withSelectedItem(item))\n    }\n  }\n\n  private onMenuPaneRef = (pane: MenuPane | null) => {\n    if (pane) {\n      this.paneRefs[pane.props.depth] = pane\n    }\n  }\n\n  private onPaneMouseEnter = (depth: number) => {\n    this.clearExpandCollapseTimer()\n\n    const paneMenu = this.props.state[depth]\n    const selectedItem = paneMenu.selectedItem\n\n    if (selectedItem) {\n      this.props.dispatcher.setAppMenuState(m =>\n        m.withSelectedItem(selectedItem)\n      )\n    } else {\n      // This ensures that the selection to this menu is reset.\n      this.props.dispatcher.setAppMenuState(m => m.withDeselectedMenu(paneMenu))\n    }\n\n    this.focusPane = depth\n  }\n\n  private onKeyDown = (event: React.KeyboardEvent<HTMLElement>) => {\n    if (!event.defaultPrevented && event.key === 'Escape') {\n      event.preventDefault()\n      this.props.onClose({ type: 'keyboard', event })\n    }\n  }\n\n  private renderMenuPane(depth: number, menu: IMenu): JSX.Element {\n    // NB: We use the menu id instead of depth as the key here to force\n    // a new MenuPane instance and List. This is because we used dynamic\n    // row heights and the react-virtualized Grid component isn't able to\n    // recompute row heights accurately. Without this row indices which\n    // previously held a separator item will retain that height and vice-\n    // versa.\n    // If the menu doesn't have an id it's the root menu\n    const key = menu.id || '@'\n    const className = menu.id ? menuPaneClassNameFromId(menu.id) : undefined\n\n    return (\n      <MenuPane\n        key={key}\n        ref={this.onMenuPaneRef}\n        className={className}\n        autoHeight={this.props.autoHeight}\n        depth={depth}\n        items={menu.items}\n        selectedItem={menu.selectedItem}\n        onItemClicked={this.onItemClicked}\n        onMouseEnter={this.onPaneMouseEnter}\n        onItemKeyDown={this.onItemKeyDown}\n        onSelectionChanged={this.onSelectionChanged}\n        enableAccessKeyNavigation={this.props.enableAccessKeyNavigation}\n      />\n    )\n  }\n\n  public render() {\n    const menus = this.props.state\n    const panes = menus.map((m, depth) => this.renderMenuPane(depth, m))\n\n    // Clear out any old references we might have to panes that are\n    // no longer displayed.\n    this.paneRefs = this.paneRefs.slice(0, panes.length)\n\n    return (\n      <div id=\"app-menu-foldout\" onKeyDown={this.onKeyDown}>\n        {panes}\n      </div>\n    )\n  }\n\n  /**\n   * Called after mounting or re-rendering and ensures that the\n   * appropriate (if any) MenuPane list receives keyboard focus.\n   */\n  private ensurePaneFocus() {\n    if (this.focusPane >= 0) {\n      const pane = this.paneRefs[this.focusPane]\n      if (pane) {\n        pane.focus()\n        this.focusPane = -1\n      }\n    }\n  }\n\n  public componentWillReceiveProps(nextProps: IAppMenuProps) {\n    this.receiveProps(this.props, nextProps)\n  }\n\n  public componentDidMount() {\n    this.ensurePaneFocus()\n  }\n\n  public componentDidUpdate() {\n    this.ensurePaneFocus()\n  }\n\n  public componentWillUnmount() {\n    this.clearExpandCollapseTimer()\n  }\n}\n","import { uuid } from '../uuid'\n\n/** The localStorage key for the stats GUID. */\nconst StatsGUIDKey = 'stats-guid'\n\nlet cachedGUID: string | null = null\n\n/** Get the stats GUID. */\nexport function getGUID(): string {\n  if (!cachedGUID) {\n    let guid = localStorage.getItem(StatsGUIDKey)\n    if (!guid) {\n      guid = uuid()\n      localStorage.setItem(StatsGUIDKey, guid)\n    }\n\n    cachedGUID = guid\n  }\n\n  return cachedGUID\n}\n","/*\n * Dexie.js - a minimalistic wrapper for IndexedDB\n * ===============================================\n *\n * By David Fahlander, david.fahlander@gmail.com\n *\n * Version {version}, {date}\n *\n * http://dexie.org\n *\n * Apache License Version 2.0, January 2004, http://www.apache.org/licenses/\n */\n \nvar keys = Object.keys;\nvar isArray = Array.isArray;\nvar _global = typeof self !== 'undefined' ? self :\n    typeof window !== 'undefined' ? window :\n        global;\nfunction extend(obj, extension) {\n    if (typeof extension !== 'object')\n        return obj;\n    keys(extension).forEach(function (key) {\n        obj[key] = extension[key];\n    });\n    return obj;\n}\nvar getProto = Object.getPrototypeOf;\nvar _hasOwn = {}.hasOwnProperty;\nfunction hasOwn(obj, prop) {\n    return _hasOwn.call(obj, prop);\n}\nfunction props(proto, extension) {\n    if (typeof extension === 'function')\n        extension = extension(getProto(proto));\n    keys(extension).forEach(function (key) {\n        setProp(proto, key, extension[key]);\n    });\n}\nvar defineProperty = Object.defineProperty;\nfunction setProp(obj, prop, functionOrGetSet, options) {\n    defineProperty(obj, prop, extend(functionOrGetSet && hasOwn(functionOrGetSet, \"get\") && typeof functionOrGetSet.get === 'function' ?\n        { get: functionOrGetSet.get, set: functionOrGetSet.set, configurable: true } :\n        { value: functionOrGetSet, configurable: true, writable: true }, options));\n}\nfunction derive(Child) {\n    return {\n        from: function (Parent) {\n            Child.prototype = Object.create(Parent.prototype);\n            setProp(Child.prototype, \"constructor\", Child);\n            return {\n                extend: props.bind(null, Child.prototype)\n            };\n        }\n    };\n}\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\nfunction getPropertyDescriptor(obj, prop) {\n    var pd = getOwnPropertyDescriptor(obj, prop), proto;\n    return pd || (proto = getProto(obj)) && getPropertyDescriptor(proto, prop);\n}\nvar _slice = [].slice;\nfunction slice(args, start, end) {\n    return _slice.call(args, start, end);\n}\nfunction override(origFunc, overridedFactory) {\n    return overridedFactory(origFunc);\n}\nfunction assert(b) {\n    if (!b)\n        throw new Error(\"Assertion Failed\");\n}\nfunction asap(fn) {\n    if (_global.setImmediate)\n        setImmediate(fn);\n    else\n        setTimeout(fn, 0);\n}\n\n/** Generate an object (hash map) based on given array.\n * @param extractor Function taking an array item and its index and returning an array of 2 items ([key, value]) to\n *        instert on the resulting object for each item in the array. If this function returns a falsy value, the\n *        current item wont affect the resulting object.\n */\nfunction arrayToObject(array, extractor) {\n    return array.reduce(function (result, item, i) {\n        var nameAndValue = extractor(item, i);\n        if (nameAndValue)\n            result[nameAndValue[0]] = nameAndValue[1];\n        return result;\n    }, {});\n}\nfunction trycatcher(fn, reject) {\n    return function () {\n        try {\n            fn.apply(this, arguments);\n        }\n        catch (e) {\n            reject(e);\n        }\n    };\n}\nfunction tryCatch(fn, onerror, args) {\n    try {\n        fn.apply(null, args);\n    }\n    catch (ex) {\n        onerror && onerror(ex);\n    }\n}\nfunction getByKeyPath(obj, keyPath) {\n    // http://www.w3.org/TR/IndexedDB/#steps-for-extracting-a-key-from-a-value-using-a-key-path\n    if (hasOwn(obj, keyPath))\n        return obj[keyPath]; // This line is moved from last to first for optimization purpose.\n    if (!keyPath)\n        return obj;\n    if (typeof keyPath !== 'string') {\n        var rv = [];\n        for (var i = 0, l = keyPath.length; i < l; ++i) {\n            var val = getByKeyPath(obj, keyPath[i]);\n            rv.push(val);\n        }\n        return rv;\n    }\n    var period = keyPath.indexOf('.');\n    if (period !== -1) {\n        var innerObj = obj[keyPath.substr(0, period)];\n        return innerObj === undefined ? undefined : getByKeyPath(innerObj, keyPath.substr(period + 1));\n    }\n    return undefined;\n}\nfunction setByKeyPath(obj, keyPath, value) {\n    if (!obj || keyPath === undefined)\n        return;\n    if ('isFrozen' in Object && Object.isFrozen(obj))\n        return;\n    if (typeof keyPath !== 'string' && 'length' in keyPath) {\n        assert(typeof value !== 'string' && 'length' in value);\n        for (var i = 0, l = keyPath.length; i < l; ++i) {\n            setByKeyPath(obj, keyPath[i], value[i]);\n        }\n    }\n    else {\n        var period = keyPath.indexOf('.');\n        if (period !== -1) {\n            var currentKeyPath = keyPath.substr(0, period);\n            var remainingKeyPath = keyPath.substr(period + 1);\n            if (remainingKeyPath === \"\")\n                if (value === undefined)\n                    delete obj[currentKeyPath];\n                else\n                    obj[currentKeyPath] = value;\n            else {\n                var innerObj = obj[currentKeyPath];\n                if (!innerObj)\n                    innerObj = (obj[currentKeyPath] = {});\n                setByKeyPath(innerObj, remainingKeyPath, value);\n            }\n        }\n        else {\n            if (value === undefined)\n                delete obj[keyPath];\n            else\n                obj[keyPath] = value;\n        }\n    }\n}\nfunction delByKeyPath(obj, keyPath) {\n    if (typeof keyPath === 'string')\n        setByKeyPath(obj, keyPath, undefined);\n    else if ('length' in keyPath)\n        [].map.call(keyPath, function (kp) {\n            setByKeyPath(obj, kp, undefined);\n        });\n}\nfunction shallowClone(obj) {\n    var rv = {};\n    for (var m in obj) {\n        if (hasOwn(obj, m))\n            rv[m] = obj[m];\n    }\n    return rv;\n}\nvar concat = [].concat;\nfunction flatten(a) {\n    return concat.apply([], a);\n}\n//https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm\nvar intrinsicTypes = \"Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set\"\n    .split(',').concat(flatten([8, 16, 32, 64].map(function (num) { return [\"Int\", \"Uint\", \"Float\"].map(function (t) { return t + num + \"Array\"; }); }))).filter(function (t) { return _global[t]; }).map(function (t) { return _global[t]; });\nfunction deepClone(any) {\n    if (!any || typeof any !== 'object')\n        return any;\n    var rv;\n    if (isArray(any)) {\n        rv = [];\n        for (var i = 0, l = any.length; i < l; ++i) {\n            rv.push(deepClone(any[i]));\n        }\n    }\n    else if (intrinsicTypes.indexOf(any.constructor) >= 0) {\n        rv = any;\n    }\n    else {\n        rv = any.constructor ? Object.create(any.constructor.prototype) : {};\n        for (var prop in any) {\n            if (hasOwn(any, prop)) {\n                rv[prop] = deepClone(any[prop]);\n            }\n        }\n    }\n    return rv;\n}\nfunction getObjectDiff(a, b, rv, prfx) {\n    // Compares objects a and b and produces a diff object.\n    rv = rv || {};\n    prfx = prfx || '';\n    keys(a).forEach(function (prop) {\n        if (!hasOwn(b, prop))\n            rv[prfx + prop] = undefined; // Property removed\n        else {\n            var ap = a[prop], bp = b[prop];\n            if (typeof ap === 'object' && typeof bp === 'object' &&\n                ap && bp &&\n                // Now compare constructors are same (not equal because wont work in Safari)\n                ('' + ap.constructor) === ('' + bp.constructor))\n                // Same type of object but its properties may have changed\n                getObjectDiff(ap, bp, rv, prfx + prop + \".\");\n            else if (ap !== bp)\n                rv[prfx + prop] = b[prop]; // Primitive value changed\n        }\n    });\n    keys(b).forEach(function (prop) {\n        if (!hasOwn(a, prop)) {\n            rv[prfx + prop] = b[prop]; // Property added\n        }\n    });\n    return rv;\n}\n// If first argument is iterable or array-like, return it as an array\nvar iteratorSymbol = typeof Symbol !== 'undefined' && Symbol.iterator;\nvar getIteratorOf = iteratorSymbol ? function (x) {\n    var i;\n    return x != null && (i = x[iteratorSymbol]) && i.apply(x);\n} : function () { return null; };\nvar NO_CHAR_ARRAY = {};\n// Takes one or several arguments and returns an array based on the following criteras:\n// * If several arguments provided, return arguments converted to an array in a way that\n//   still allows javascript engine to optimize the code.\n// * If single argument is an array, return a clone of it.\n// * If this-pointer equals NO_CHAR_ARRAY, don't accept strings as valid iterables as a special\n//   case to the two bullets below.\n// * If single argument is an iterable, convert it to an array and return the resulting array.\n// * If single argument is array-like (has length of type number), convert it to an array.\nfunction getArrayOf(arrayLike) {\n    var i, a, x, it;\n    if (arguments.length === 1) {\n        if (isArray(arrayLike))\n            return arrayLike.slice();\n        if (this === NO_CHAR_ARRAY && typeof arrayLike === 'string')\n            return [arrayLike];\n        if ((it = getIteratorOf(arrayLike))) {\n            a = [];\n            while ((x = it.next()), !x.done)\n                a.push(x.value);\n            return a;\n        }\n        if (arrayLike == null)\n            return [arrayLike];\n        i = arrayLike.length;\n        if (typeof i === 'number') {\n            a = new Array(i);\n            while (i--)\n                a[i] = arrayLike[i];\n            return a;\n        }\n        return [arrayLike];\n    }\n    i = arguments.length;\n    a = new Array(i);\n    while (i--)\n        a[i] = arguments[i];\n    return a;\n}\n\n// By default, debug will be true only if platform is a web platform and its page is served from localhost.\n// When debug = true, error's stacks will contain asyncronic long stacks.\nvar debug = typeof location !== 'undefined' &&\n    // By default, use debug mode if served from localhost.\n    /^(http|https):\\/\\/(localhost|127\\.0\\.0\\.1)/.test(location.href);\nfunction setDebug(value, filter) {\n    debug = value;\n    libraryFilter = filter;\n}\nvar libraryFilter = function () { return true; };\nvar NEEDS_THROW_FOR_STACK = !new Error(\"\").stack;\nfunction getErrorWithStack() {\n    \"use strict\";\n    if (NEEDS_THROW_FOR_STACK)\n        try {\n            // Doing something naughty in strict mode here to trigger a specific error\n            // that can be explicitely ignored in debugger's exception settings.\n            // If we'd just throw new Error() here, IE's debugger's exception settings\n            // will just consider it as \"exception thrown by javascript code\" which is\n            // something you wouldn't want it to ignore.\n            getErrorWithStack.arguments;\n            throw new Error(); // Fallback if above line don't throw.\n        }\n        catch (e) {\n            return e;\n        }\n    return new Error();\n}\nfunction prettyStack(exception, numIgnoredFrames) {\n    var stack = exception.stack;\n    if (!stack)\n        return \"\";\n    numIgnoredFrames = (numIgnoredFrames || 0);\n    if (stack.indexOf(exception.name) === 0)\n        numIgnoredFrames += (exception.name + exception.message).split('\\n').length;\n    return stack.split('\\n')\n        .slice(numIgnoredFrames)\n        .filter(libraryFilter)\n        .map(function (frame) { return \"\\n\" + frame; })\n        .join('');\n}\nfunction deprecated(what, fn) {\n    return function () {\n        console.warn(what + \" is deprecated. See https://github.com/dfahlander/Dexie.js/wiki/Deprecations. \" + prettyStack(getErrorWithStack(), 1));\n        return fn.apply(this, arguments);\n    };\n}\n\nvar dexieErrorNames = [\n    'Modify',\n    'Bulk',\n    'OpenFailed',\n    'VersionChange',\n    'Schema',\n    'Upgrade',\n    'InvalidTable',\n    'MissingAPI',\n    'NoSuchDatabase',\n    'InvalidArgument',\n    'SubTransaction',\n    'Unsupported',\n    'Internal',\n    'DatabaseClosed',\n    'PrematureCommit',\n    'ForeignAwait'\n];\nvar idbDomErrorNames = [\n    'Unknown',\n    'Constraint',\n    'Data',\n    'TransactionInactive',\n    'ReadOnly',\n    'Version',\n    'NotFound',\n    'InvalidState',\n    'InvalidAccess',\n    'Abort',\n    'Timeout',\n    'QuotaExceeded',\n    'Syntax',\n    'DataClone'\n];\nvar errorList = dexieErrorNames.concat(idbDomErrorNames);\nvar defaultTexts = {\n    VersionChanged: \"Database version changed by other database connection\",\n    DatabaseClosed: \"Database has been closed\",\n    Abort: \"Transaction aborted\",\n    TransactionInactive: \"Transaction has already completed or failed\"\n};\n//\n// DexieError - base class of all out exceptions.\n//\nfunction DexieError(name, msg) {\n    // Reason we don't use ES6 classes is because:\n    // 1. It bloats transpiled code and increases size of minified code.\n    // 2. It doesn't give us much in this case.\n    // 3. It would require sub classes to call super(), which\n    //    is not needed when deriving from Error.\n    this._e = getErrorWithStack();\n    this.name = name;\n    this.message = msg;\n}\nderive(DexieError).from(Error).extend({\n    stack: {\n        get: function () {\n            return this._stack ||\n                (this._stack = this.name + \": \" + this.message + prettyStack(this._e, 2));\n        }\n    },\n    toString: function () { return this.name + \": \" + this.message; }\n});\nfunction getMultiErrorMessage(msg, failures) {\n    return msg + \". Errors: \" + failures\n        .map(function (f) { return f.toString(); })\n        .filter(function (v, i, s) { return s.indexOf(v) === i; }) // Only unique error strings\n        .join('\\n');\n}\n//\n// ModifyError - thrown in Collection.modify()\n// Specific constructor because it contains members failures and failedKeys.\n//\nfunction ModifyError(msg, failures, successCount, failedKeys) {\n    this._e = getErrorWithStack();\n    this.failures = failures;\n    this.failedKeys = failedKeys;\n    this.successCount = successCount;\n}\nderive(ModifyError).from(DexieError);\nfunction BulkError(msg, failures) {\n    this._e = getErrorWithStack();\n    this.name = \"BulkError\";\n    this.failures = failures;\n    this.message = getMultiErrorMessage(msg, failures);\n}\nderive(BulkError).from(DexieError);\n//\n//\n// Dynamically generate error names and exception classes based\n// on the names in errorList.\n//\n//\n// Map of {ErrorName -> ErrorName + \"Error\"}\nvar errnames = errorList.reduce(function (obj, name) { return (obj[name] = name + \"Error\", obj); }, {});\n// Need an alias for DexieError because we're gonna create subclasses with the same name.\nvar BaseException = DexieError;\n// Map of {ErrorName -> exception constructor}\nvar exceptions = errorList.reduce(function (obj, name) {\n    // Let the name be \"DexieError\" because this name may\n    // be shown in call stack and when debugging. DexieError is\n    // the most true name because it derives from DexieError,\n    // and we cannot change Function.name programatically without\n    // dynamically create a Function object, which would be considered\n    // 'eval-evil'.\n    var fullName = name + \"Error\";\n    function DexieError(msgOrInner, inner) {\n        this._e = getErrorWithStack();\n        this.name = fullName;\n        if (!msgOrInner) {\n            this.message = defaultTexts[name] || fullName;\n            this.inner = null;\n        }\n        else if (typeof msgOrInner === 'string') {\n            this.message = msgOrInner;\n            this.inner = inner || null;\n        }\n        else if (typeof msgOrInner === 'object') {\n            this.message = msgOrInner.name + \" \" + msgOrInner.message;\n            this.inner = msgOrInner;\n        }\n    }\n    derive(DexieError).from(BaseException);\n    obj[name] = DexieError;\n    return obj;\n}, {});\n// Use ECMASCRIPT standard exceptions where applicable:\nexceptions.Syntax = SyntaxError;\nexceptions.Type = TypeError;\nexceptions.Range = RangeError;\nvar exceptionMap = idbDomErrorNames.reduce(function (obj, name) {\n    obj[name + \"Error\"] = exceptions[name];\n    return obj;\n}, {});\nfunction mapError(domError, message) {\n    if (!domError || domError instanceof DexieError || domError instanceof TypeError || domError instanceof SyntaxError || !domError.name || !exceptionMap[domError.name])\n        return domError;\n    var rv = new exceptionMap[domError.name](message || domError.message, domError);\n    if (\"stack\" in domError) {\n        // Derive stack from inner exception if it has a stack\n        setProp(rv, \"stack\", { get: function () {\n                return this.inner.stack;\n            } });\n    }\n    return rv;\n}\nvar fullNameExceptions = errorList.reduce(function (obj, name) {\n    if ([\"Syntax\", \"Type\", \"Range\"].indexOf(name) === -1)\n        obj[name + \"Error\"] = exceptions[name];\n    return obj;\n}, {});\nfullNameExceptions.ModifyError = ModifyError;\nfullNameExceptions.DexieError = DexieError;\nfullNameExceptions.BulkError = BulkError;\n\nfunction nop() { }\nfunction mirror(val) { return val; }\nfunction pureFunctionChain(f1, f2) {\n    // Enables chained events that takes ONE argument and returns it to the next function in chain.\n    // This pattern is used in the hook(\"reading\") event.\n    if (f1 == null || f1 === mirror)\n        return f2;\n    return function (val) {\n        return f2(f1(val));\n    };\n}\nfunction callBoth(on1, on2) {\n    return function () {\n        on1.apply(this, arguments);\n        on2.apply(this, arguments);\n    };\n}\nfunction hookCreatingChain(f1, f2) {\n    // Enables chained events that takes several arguments and may modify first argument by making a modification and then returning the same instance.\n    // This pattern is used in the hook(\"creating\") event.\n    if (f1 === nop)\n        return f2;\n    return function () {\n        var res = f1.apply(this, arguments);\n        if (res !== undefined)\n            arguments[0] = res;\n        var onsuccess = this.onsuccess, // In case event listener has set this.onsuccess\n        onerror = this.onerror; // In case event listener has set this.onerror\n        this.onsuccess = null;\n        this.onerror = null;\n        var res2 = f2.apply(this, arguments);\n        if (onsuccess)\n            this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n        if (onerror)\n            this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n        return res2 !== undefined ? res2 : res;\n    };\n}\nfunction hookDeletingChain(f1, f2) {\n    if (f1 === nop)\n        return f2;\n    return function () {\n        f1.apply(this, arguments);\n        var onsuccess = this.onsuccess, // In case event listener has set this.onsuccess\n        onerror = this.onerror; // In case event listener has set this.onerror\n        this.onsuccess = this.onerror = null;\n        f2.apply(this, arguments);\n        if (onsuccess)\n            this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n        if (onerror)\n            this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n    };\n}\nfunction hookUpdatingChain(f1, f2) {\n    if (f1 === nop)\n        return f2;\n    return function (modifications) {\n        var res = f1.apply(this, arguments);\n        extend(modifications, res); // If f1 returns new modifications, extend caller's modifications with the result before calling next in chain.\n        var onsuccess = this.onsuccess, // In case event listener has set this.onsuccess\n        onerror = this.onerror; // In case event listener has set this.onerror\n        this.onsuccess = null;\n        this.onerror = null;\n        var res2 = f2.apply(this, arguments);\n        if (onsuccess)\n            this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n        if (onerror)\n            this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n        return res === undefined ?\n            (res2 === undefined ? undefined : res2) :\n            (extend(res, res2));\n    };\n}\nfunction reverseStoppableEventChain(f1, f2) {\n    if (f1 === nop)\n        return f2;\n    return function () {\n        if (f2.apply(this, arguments) === false)\n            return false;\n        return f1.apply(this, arguments);\n    };\n}\n\nfunction promisableChain(f1, f2) {\n    if (f1 === nop)\n        return f2;\n    return function () {\n        var res = f1.apply(this, arguments);\n        if (res && typeof res.then === 'function') {\n            var thiz = this, i = arguments.length, args = new Array(i);\n            while (i--)\n                args[i] = arguments[i];\n            return res.then(function () {\n                return f2.apply(thiz, args);\n            });\n        }\n        return f2.apply(this, arguments);\n    };\n}\n\n/*\n * Copyright (c) 2014-2017 David Fahlander\n * Apache License Version 2.0, January 2004, http://www.apache.org/licenses/LICENSE-2.0\n */\n//\n// Promise and Zone (PSD) for Dexie library\n//\n// I started out writing this Promise class by copying promise-light (https://github.com/taylorhakes/promise-light) by\n// https://github.com/taylorhakes - an A+ and ECMASCRIPT 6 compliant Promise implementation.\n//\n// In previous versions this was fixed by not calling setTimeout when knowing that the resolve() or reject() came from another\n// tick. In Dexie v1.4.0, I've rewritten the Promise class entirely. Just some fragments of promise-light is left. I use\n// another strategy now that simplifies everything a lot: to always execute callbacks in a new micro-task, but have an own micro-task\n// engine that is indexedDB compliant across all browsers.\n// Promise class has also been optimized a lot with inspiration from bluebird - to avoid closures as much as possible.\n// Also with inspiration from bluebird, asyncronic stacks in debug mode.\n//\n// Specific non-standard features of this Promise class:\n// * Custom zone support (a.k.a. PSD) with ability to keep zones also when using native promises as well as\n//   native async / await.\n// * Promise.follow() method built upon the custom zone engine, that allows user to track all promises created from current stack frame\n//   and below + all promises that those promises creates or awaits.\n// * Detect any unhandled promise in a PSD-scope (PSD.onunhandled). \n//\n// David Fahlander, https://github.com/dfahlander\n//\n// Just a pointer that only this module knows about.\n// Used in Promise constructor to emulate a private constructor.\nvar INTERNAL = {};\n// Async stacks (long stacks) must not grow infinitely.\nvar LONG_STACKS_CLIP_LIMIT = 100;\nvar MAX_LONG_STACKS = 20;\nvar ZONE_ECHO_LIMIT = 7;\nvar nativePromiseInstanceAndProto = (function () {\n    try {\n        // Be able to patch native async functions\n        return new Function(\"let F=async ()=>{},p=F();return [p,Object.getPrototypeOf(p),Promise.resolve(),F.constructor];\")();\n    }\n    catch (e) {\n        var P = _global.Promise;\n        return P ?\n            [P.resolve(), P.prototype, P.resolve()] :\n            [];\n    }\n})();\nvar resolvedNativePromise = nativePromiseInstanceAndProto[0];\nvar nativePromiseProto = nativePromiseInstanceAndProto[1];\nvar resolvedGlobalPromise = nativePromiseInstanceAndProto[2];\nvar nativePromiseThen = nativePromiseProto && nativePromiseProto.then;\nvar NativePromise = resolvedNativePromise && resolvedNativePromise.constructor;\nvar AsyncFunction = nativePromiseInstanceAndProto[3];\nvar patchGlobalPromise = !!resolvedGlobalPromise;\nvar stack_being_generated = false;\n/* The default function used only for the very first promise in a promise chain.\n   As soon as then promise is resolved or rejected, all next tasks will be executed in micro ticks\n   emulated in this module. For indexedDB compatibility, this means that every method needs to\n   execute at least one promise before doing an indexedDB operation. Dexie will always call\n   db.ready().then() for every operation to make sure the indexedDB event is started in an\n   indexedDB-compatible emulated micro task loop.\n*/\nvar schedulePhysicalTick = resolvedGlobalPromise ?\n    function () { resolvedGlobalPromise.then(physicalTick); }\n    :\n        _global.setImmediate ?\n            // setImmediate supported. Those modern platforms also supports Function.bind().\n            setImmediate.bind(null, physicalTick) :\n            _global.MutationObserver ?\n                // MutationObserver supported\n                function () {\n                    var hiddenDiv = document.createElement(\"div\");\n                    (new MutationObserver(function () {\n                        physicalTick();\n                        hiddenDiv = null;\n                    })).observe(hiddenDiv, { attributes: true });\n                    hiddenDiv.setAttribute('i', '1');\n                } :\n                // No support for setImmediate or MutationObserver. No worry, setTimeout is only called\n                // once time. Every tick that follows will be our emulated micro tick.\n                // Could have uses setTimeout.bind(null, 0, physicalTick) if it wasnt for that FF13 and below has a bug \n                function () { setTimeout(physicalTick, 0); };\n// Configurable through Promise.scheduler.\n// Don't export because it would be unsafe to let unknown\n// code call it unless they do try..catch within their callback.\n// This function can be retrieved through getter of Promise.scheduler though,\n// but users must not do Promise.scheduler = myFuncThatThrowsException\nvar asap$1 = function (callback, args) {\n    microtickQueue.push([callback, args]);\n    if (needsNewPhysicalTick) {\n        schedulePhysicalTick();\n        needsNewPhysicalTick = false;\n    }\n};\nvar isOutsideMicroTick = true;\nvar needsNewPhysicalTick = true;\nvar unhandledErrors = [];\nvar rejectingErrors = [];\nvar currentFulfiller = null;\nvar rejectionMapper = mirror; // Remove in next major when removing error mapping of DOMErrors and DOMExceptions\nvar globalPSD = {\n    id: 'global',\n    global: true,\n    ref: 0,\n    unhandleds: [],\n    onunhandled: globalError,\n    pgp: false,\n    env: {},\n    finalize: function () {\n        this.unhandleds.forEach(function (uh) {\n            try {\n                globalError(uh[0], uh[1]);\n            }\n            catch (e) { }\n        });\n    }\n};\nvar PSD = globalPSD;\nvar microtickQueue = []; // Callbacks to call in this or next physical tick.\nvar numScheduledCalls = 0; // Number of listener-calls left to do in this physical tick.\nvar tickFinalizers = []; // Finalizers to call when there are no more async calls scheduled within current physical tick.\nfunction Promise(fn) {\n    if (typeof this !== 'object')\n        throw new TypeError('Promises must be constructed via new');\n    this._listeners = [];\n    this.onuncatched = nop; // Deprecate in next major. Not needed. Better to use global error handler.\n    // A library may set `promise._lib = true;` after promise is created to make resolve() or reject()\n    // execute the microtask engine implicitely within the call to resolve() or reject().\n    // To remain A+ compliant, a library must only set `_lib=true` if it can guarantee that the stack\n    // only contains library code when calling resolve() or reject().\n    // RULE OF THUMB: ONLY set _lib = true for promises explicitely resolving/rejecting directly from\n    // global scope (event handler, timer etc)!\n    this._lib = false;\n    // Current async scope\n    var psd = (this._PSD = PSD);\n    if (debug) {\n        this._stackHolder = getErrorWithStack();\n        this._prev = null;\n        this._numPrev = 0; // Number of previous promises (for long stacks)\n    }\n    if (typeof fn !== 'function') {\n        if (fn !== INTERNAL)\n            throw new TypeError('Not a function');\n        // Private constructor (INTERNAL, state, value).\n        // Used internally by Promise.resolve() and Promise.reject().\n        this._state = arguments[1];\n        this._value = arguments[2];\n        if (this._state === false)\n            handleRejection(this, this._value); // Map error, set stack and addPossiblyUnhandledError().\n        return;\n    }\n    this._state = null; // null (=pending), false (=rejected) or true (=resolved)\n    this._value = null; // error or result\n    ++psd.ref; // Refcounting current scope\n    executePromiseTask(this, fn);\n}\n// Prepare a property descriptor to put onto Promise.prototype.then\nvar thenProp = {\n    get: function () {\n        var psd = PSD, microTaskId = totalEchoes;\n        function then(onFulfilled, onRejected) {\n            var _this = this;\n            var possibleAwait = !psd.global && (psd !== PSD || microTaskId !== totalEchoes);\n            if (possibleAwait)\n                decrementExpectedAwaits();\n            var rv = new Promise(function (resolve, reject) {\n                propagateToListener(_this, new Listener(nativeAwaitCompatibleWrap(onFulfilled, psd, possibleAwait), nativeAwaitCompatibleWrap(onRejected, psd, possibleAwait), resolve, reject, psd));\n            });\n            debug && linkToPreviousPromise(rv, this);\n            return rv;\n        }\n        then.prototype = INTERNAL; // For idempotense, see setter below.\n        return then;\n    },\n    // Be idempotent and allow another framework (such as zone.js or another instance of a Dexie.Promise module) to replace Promise.prototype.then\n    // and when that framework wants to restore the original property, we must identify that and restore the original property descriptor.\n    set: function (value) {\n        setProp(this, 'then', value && value.prototype === INTERNAL ?\n            thenProp : // Restore to original property descriptor.\n            {\n                get: function () {\n                    return value; // Getter returning provided value (behaves like value is just changed)\n                },\n                set: thenProp.set // Keep a setter that is prepared to restore original.\n            });\n    }\n};\nprops(Promise.prototype, {\n    then: thenProp,\n    _then: function (onFulfilled, onRejected) {\n        // A little tinier version of then() that don't have to create a resulting promise.\n        propagateToListener(this, new Listener(null, null, onFulfilled, onRejected, PSD));\n    },\n    catch: function (onRejected) {\n        if (arguments.length === 1)\n            return this.then(null, onRejected);\n        // First argument is the Error type to catch\n        var type = arguments[0], handler = arguments[1];\n        return typeof type === 'function' ? this.then(null, function (err) {\n            // Catching errors by its constructor type (similar to java / c++ / c#)\n            // Sample: promise.catch(TypeError, function (e) { ... });\n            return err instanceof type ? handler(err) : PromiseReject(err);\n        })\n            : this.then(null, function (err) {\n                // Catching errors by the error.name property. Makes sense for indexedDB where error type\n                // is always DOMError but where e.name tells the actual error type.\n                // Sample: promise.catch('ConstraintError', function (e) { ... });\n                return err && err.name === type ? handler(err) : PromiseReject(err);\n            });\n    },\n    finally: function (onFinally) {\n        return this.then(function (value) {\n            onFinally();\n            return value;\n        }, function (err) {\n            onFinally();\n            return PromiseReject(err);\n        });\n    },\n    stack: {\n        get: function () {\n            if (this._stack)\n                return this._stack;\n            try {\n                stack_being_generated = true;\n                var stacks = getStack(this, [], MAX_LONG_STACKS);\n                var stack = stacks.join(\"\\nFrom previous: \");\n                if (this._state !== null)\n                    this._stack = stack; // Stack may be updated on reject.\n                return stack;\n            }\n            finally {\n                stack_being_generated = false;\n            }\n        }\n    },\n    timeout: function (ms, msg) {\n        var _this = this;\n        return ms < Infinity ?\n            new Promise(function (resolve, reject) {\n                var handle = setTimeout(function () { return reject(new exceptions.Timeout(msg)); }, ms);\n                _this.then(resolve, reject).finally(clearTimeout.bind(null, handle));\n            }) : this;\n    }\n});\nif (typeof Symbol !== 'undefined' && Symbol.toStringTag)\n    setProp(Promise.prototype, Symbol.toStringTag, 'Promise');\n// Now that Promise.prototype is defined, we have all it takes to set globalPSD.env.\n// Environment globals snapshotted on leaving global zone\nglobalPSD.env = snapShot();\nfunction Listener(onFulfilled, onRejected, resolve, reject, zone) {\n    this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n    this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n    this.resolve = resolve;\n    this.reject = reject;\n    this.psd = zone;\n}\n// Promise Static Properties\nprops(Promise, {\n    all: function () {\n        var values = getArrayOf.apply(null, arguments) // Supports iterables, implicit arguments and array-like.\n            .map(onPossibleParallellAsync); // Handle parallell async/awaits \n        return new Promise(function (resolve, reject) {\n            if (values.length === 0)\n                resolve([]);\n            var remaining = values.length;\n            values.forEach(function (a, i) { return Promise.resolve(a).then(function (x) {\n                values[i] = x;\n                if (!--remaining)\n                    resolve(values);\n            }, reject); });\n        });\n    },\n    resolve: function (value) {\n        if (value instanceof Promise)\n            return value;\n        if (value && typeof value.then === 'function')\n            return new Promise(function (resolve, reject) {\n                value.then(resolve, reject);\n            });\n        var rv = new Promise(INTERNAL, true, value);\n        linkToPreviousPromise(rv, currentFulfiller);\n        return rv;\n    },\n    reject: PromiseReject,\n    race: function () {\n        var values = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n        return new Promise(function (resolve, reject) {\n            values.map(function (value) { return Promise.resolve(value).then(resolve, reject); });\n        });\n    },\n    PSD: {\n        get: function () { return PSD; },\n        set: function (value) { return PSD = value; }\n    },\n    //totalEchoes: {get: ()=>totalEchoes},\n    //task: {get: ()=>task},\n    newPSD: newScope,\n    usePSD: usePSD,\n    scheduler: {\n        get: function () { return asap$1; },\n        set: function (value) { asap$1 = value; }\n    },\n    rejectionMapper: {\n        get: function () { return rejectionMapper; },\n        set: function (value) { rejectionMapper = value; } // Map reject failures\n    },\n    follow: function (fn, zoneProps) {\n        return new Promise(function (resolve, reject) {\n            return newScope(function (resolve, reject) {\n                var psd = PSD;\n                psd.unhandleds = []; // For unhandled standard- or 3rd party Promises. Checked at psd.finalize()\n                psd.onunhandled = reject; // Triggered directly on unhandled promises of this library.\n                psd.finalize = callBoth(function () {\n                    var _this = this;\n                    // Unhandled standard or 3rd part promises are put in PSD.unhandleds and\n                    // examined upon scope completion while unhandled rejections in this Promise\n                    // will trigger directly through psd.onunhandled\n                    run_at_end_of_this_or_next_physical_tick(function () {\n                        _this.unhandleds.length === 0 ? resolve() : reject(_this.unhandleds[0]);\n                    });\n                }, psd.finalize);\n                fn();\n            }, zoneProps, resolve, reject);\n        });\n    }\n});\n/**\n* Take a potentially misbehaving resolver function and make sure\n* onFulfilled and onRejected are only called once.\n*\n* Makes no guarantees about asynchrony.\n*/\nfunction executePromiseTask(promise, fn) {\n    // Promise Resolution Procedure:\n    // https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n    try {\n        fn(function (value) {\n            if (promise._state !== null)\n                return; // Already settled\n            if (value === promise)\n                throw new TypeError('A promise cannot be resolved with itself.');\n            var shouldExecuteTick = promise._lib && beginMicroTickScope();\n            if (value && typeof value.then === 'function') {\n                executePromiseTask(promise, function (resolve, reject) {\n                    value instanceof Promise ?\n                        value._then(resolve, reject) :\n                        value.then(resolve, reject);\n                });\n            }\n            else {\n                promise._state = true;\n                promise._value = value;\n                propagateAllListeners(promise);\n            }\n            if (shouldExecuteTick)\n                endMicroTickScope();\n        }, handleRejection.bind(null, promise)); // If Function.bind is not supported. Exception is handled in catch below\n    }\n    catch (ex) {\n        handleRejection(promise, ex);\n    }\n}\nfunction handleRejection(promise, reason) {\n    rejectingErrors.push(reason);\n    if (promise._state !== null)\n        return;\n    var shouldExecuteTick = promise._lib && beginMicroTickScope();\n    reason = rejectionMapper(reason);\n    promise._state = false;\n    promise._value = reason;\n    debug && reason !== null && typeof reason === 'object' && !reason._promise && tryCatch(function () {\n        var origProp = getPropertyDescriptor(reason, \"stack\");\n        reason._promise = promise;\n        setProp(reason, \"stack\", {\n            get: function () {\n                return stack_being_generated ?\n                    origProp && (origProp.get ?\n                        origProp.get.apply(reason) :\n                        origProp.value) :\n                    promise.stack;\n            }\n        });\n    });\n    // Add the failure to a list of possibly uncaught errors\n    addPossiblyUnhandledError(promise);\n    propagateAllListeners(promise);\n    if (shouldExecuteTick)\n        endMicroTickScope();\n}\nfunction propagateAllListeners(promise) {\n    //debug && linkToPreviousPromise(promise);\n    var listeners = promise._listeners;\n    promise._listeners = [];\n    for (var i = 0, len = listeners.length; i < len; ++i) {\n        propagateToListener(promise, listeners[i]);\n    }\n    var psd = promise._PSD;\n    --psd.ref || psd.finalize(); // if psd.ref reaches zero, call psd.finalize();\n    if (numScheduledCalls === 0) {\n        // If numScheduledCalls is 0, it means that our stack is not in a callback of a scheduled call,\n        // and that no deferreds where listening to this rejection or success.\n        // Since there is a risk that our stack can contain application code that may\n        // do stuff after this code is finished that may generate new calls, we cannot\n        // call finalizers here.\n        ++numScheduledCalls;\n        asap$1(function () {\n            if (--numScheduledCalls === 0)\n                finalizePhysicalTick(); // Will detect unhandled errors\n        }, []);\n    }\n}\nfunction propagateToListener(promise, listener) {\n    if (promise._state === null) {\n        promise._listeners.push(listener);\n        return;\n    }\n    var cb = promise._state ? listener.onFulfilled : listener.onRejected;\n    if (cb === null) {\n        // This Listener doesnt have a listener for the event being triggered (onFulfilled or onReject) so lets forward the event to any eventual listeners on the Promise instance returned by then() or catch()\n        return (promise._state ? listener.resolve : listener.reject)(promise._value);\n    }\n    ++listener.psd.ref;\n    ++numScheduledCalls;\n    asap$1(callListener, [cb, promise, listener]);\n}\nfunction callListener(cb, promise, listener) {\n    try {\n        // Set static variable currentFulfiller to the promise that is being fullfilled,\n        // so that we connect the chain of promises (for long stacks support)\n        currentFulfiller = promise;\n        // Call callback and resolve our listener with it's return value.\n        var ret, value = promise._value;\n        if (promise._state) {\n            // cb is onResolved\n            ret = cb(value);\n        }\n        else {\n            // cb is onRejected\n            if (rejectingErrors.length)\n                rejectingErrors = [];\n            ret = cb(value);\n            if (rejectingErrors.indexOf(value) === -1)\n                markErrorAsHandled(promise); // Callback didnt do Promise.reject(err) nor reject(err) onto another promise.\n        }\n        listener.resolve(ret);\n    }\n    catch (e) {\n        // Exception thrown in callback. Reject our listener.\n        listener.reject(e);\n    }\n    finally {\n        // Restore env and currentFulfiller.\n        currentFulfiller = null;\n        if (--numScheduledCalls === 0)\n            finalizePhysicalTick();\n        --listener.psd.ref || listener.psd.finalize();\n    }\n}\nfunction getStack(promise, stacks, limit) {\n    if (stacks.length === limit)\n        return stacks;\n    var stack = \"\";\n    if (promise._state === false) {\n        var failure = promise._value, errorName, message;\n        if (failure != null) {\n            errorName = failure.name || \"Error\";\n            message = failure.message || failure;\n            stack = prettyStack(failure, 0);\n        }\n        else {\n            errorName = failure; // If error is undefined or null, show that.\n            message = \"\";\n        }\n        stacks.push(errorName + (message ? \": \" + message : \"\") + stack);\n    }\n    if (debug) {\n        stack = prettyStack(promise._stackHolder, 2);\n        if (stack && stacks.indexOf(stack) === -1)\n            stacks.push(stack);\n        if (promise._prev)\n            getStack(promise._prev, stacks, limit);\n    }\n    return stacks;\n}\nfunction linkToPreviousPromise(promise, prev) {\n    // Support long stacks by linking to previous completed promise.\n    var numPrev = prev ? prev._numPrev + 1 : 0;\n    if (numPrev < LONG_STACKS_CLIP_LIMIT) {\n        promise._prev = prev;\n        promise._numPrev = numPrev;\n    }\n}\n/* The callback to schedule with setImmediate() or setTimeout().\n   It runs a virtual microtick and executes any callback registered in microtickQueue.\n */\nfunction physicalTick() {\n    beginMicroTickScope() && endMicroTickScope();\n}\nfunction beginMicroTickScope() {\n    var wasRootExec = isOutsideMicroTick;\n    isOutsideMicroTick = false;\n    needsNewPhysicalTick = false;\n    return wasRootExec;\n}\n/* Executes micro-ticks without doing try..catch.\n   This can be possible because we only use this internally and\n   the registered functions are exception-safe (they do try..catch\n   internally before calling any external method). If registering\n   functions in the microtickQueue that are not exception-safe, this\n   would destroy the framework and make it instable. So we don't export\n   our asap method.\n*/\nfunction endMicroTickScope() {\n    var callbacks, i, l;\n    do {\n        while (microtickQueue.length > 0) {\n            callbacks = microtickQueue;\n            microtickQueue = [];\n            l = callbacks.length;\n            for (i = 0; i < l; ++i) {\n                var item = callbacks[i];\n                item[0].apply(null, item[1]);\n            }\n        }\n    } while (microtickQueue.length > 0);\n    isOutsideMicroTick = true;\n    needsNewPhysicalTick = true;\n}\nfunction finalizePhysicalTick() {\n    var unhandledErrs = unhandledErrors;\n    unhandledErrors = [];\n    unhandledErrs.forEach(function (p) {\n        p._PSD.onunhandled.call(null, p._value, p);\n    });\n    var finalizers = tickFinalizers.slice(0); // Clone first because finalizer may remove itself from list.\n    var i = finalizers.length;\n    while (i)\n        finalizers[--i]();\n}\nfunction run_at_end_of_this_or_next_physical_tick(fn) {\n    function finalizer() {\n        fn();\n        tickFinalizers.splice(tickFinalizers.indexOf(finalizer), 1);\n    }\n    tickFinalizers.push(finalizer);\n    ++numScheduledCalls;\n    asap$1(function () {\n        if (--numScheduledCalls === 0)\n            finalizePhysicalTick();\n    }, []);\n}\nfunction addPossiblyUnhandledError(promise) {\n    // Only add to unhandledErrors if not already there. The first one to add to this list\n    // will be upon the first rejection so that the root cause (first promise in the\n    // rejection chain) is the one listed.\n    if (!unhandledErrors.some(function (p) { return p._value === promise._value; }))\n        unhandledErrors.push(promise);\n}\nfunction markErrorAsHandled(promise) {\n    // Called when a reject handled is actually being called.\n    // Search in unhandledErrors for any promise whos _value is this promise_value (list\n    // contains only rejected promises, and only one item per error)\n    var i = unhandledErrors.length;\n    while (i)\n        if (unhandledErrors[--i]._value === promise._value) {\n            // Found a promise that failed with this same error object pointer,\n            // Remove that since there is a listener that actually takes care of it.\n            unhandledErrors.splice(i, 1);\n            return;\n        }\n}\nfunction PromiseReject(reason) {\n    return new Promise(INTERNAL, false, reason);\n}\nfunction wrap(fn, errorCatcher) {\n    var psd = PSD;\n    return function () {\n        var wasRootExec = beginMicroTickScope(), outerScope = PSD;\n        try {\n            switchToZone(psd, true);\n            return fn.apply(this, arguments);\n        }\n        catch (e) {\n            errorCatcher && errorCatcher(e);\n        }\n        finally {\n            switchToZone(outerScope, false);\n            if (wasRootExec)\n                endMicroTickScope();\n        }\n    };\n}\n//\n// variables used for native await support\n//\nvar task = { awaits: 0, echoes: 0, id: 0 }; // The ongoing macro-task when using zone-echoing.\nvar taskCounter = 0; // ID counter for macro tasks.\nvar zoneStack = []; // Stack of left zones to restore asynchronically.\nvar zoneEchoes = 0; // zoneEchoes is a must in order to persist zones between native await expressions.\nvar totalEchoes = 0; // ID counter for micro-tasks. Used to detect possible native await in our Promise.prototype.then.\nvar zone_id_counter = 0;\nfunction newScope(fn, props$$1, a1, a2) {\n    var parent = PSD, psd = Object.create(parent);\n    psd.parent = parent;\n    psd.ref = 0;\n    psd.global = false;\n    psd.id = ++zone_id_counter;\n    // Prepare for promise patching (done in usePSD):\n    var globalEnv = globalPSD.env;\n    psd.env = patchGlobalPromise ? {\n        Promise: Promise,\n        PromiseProp: { value: Promise, configurable: true, writable: true },\n        all: Promise.all,\n        race: Promise.race,\n        resolve: Promise.resolve,\n        reject: Promise.reject,\n        nthen: getPatchedPromiseThen(globalEnv.nthen, psd),\n        gthen: getPatchedPromiseThen(globalEnv.gthen, psd) // global then\n    } : {};\n    if (props$$1)\n        extend(psd, props$$1);\n    // unhandleds and onunhandled should not be specifically set here.\n    // Leave them on parent prototype.\n    // unhandleds.push(err) will push to parent's prototype\n    // onunhandled() will call parents onunhandled (with this scope's this-pointer though!)\n    ++parent.ref;\n    psd.finalize = function () {\n        --this.parent.ref || this.parent.finalize();\n    };\n    var rv = usePSD(psd, fn, a1, a2);\n    if (psd.ref === 0)\n        psd.finalize();\n    return rv;\n}\n// Function to call if scopeFunc returns NativePromise\n// Also for each NativePromise in the arguments to Promise.all()\nfunction incrementExpectedAwaits() {\n    if (!task.id)\n        task.id = ++taskCounter;\n    ++task.awaits;\n    task.echoes += ZONE_ECHO_LIMIT;\n    return task.id;\n}\n// Function to call when 'then' calls back on a native promise where onAwaitExpected() had been called.\n// Also call this when a native await calls then method on a promise. In that case, don't supply\n// sourceTaskId because we already know it refers to current task.\nfunction decrementExpectedAwaits(sourceTaskId) {\n    if (!task.awaits || (sourceTaskId && sourceTaskId !== task.id))\n        return;\n    if (--task.awaits === 0)\n        task.id = 0;\n    task.echoes = task.awaits * ZONE_ECHO_LIMIT; // Will reset echoes to 0 if awaits is 0.\n}\n// Call from Promise.all() and Promise.race()\nfunction onPossibleParallellAsync(possiblePromise) {\n    if (task.echoes && possiblePromise && possiblePromise.constructor === NativePromise) {\n        incrementExpectedAwaits();\n        return possiblePromise.then(function (x) {\n            decrementExpectedAwaits();\n            return x;\n        }, function (e) {\n            decrementExpectedAwaits();\n            return rejection(e);\n        });\n    }\n    return possiblePromise;\n}\nfunction zoneEnterEcho(targetZone) {\n    ++totalEchoes;\n    if (!task.echoes || --task.echoes === 0) {\n        task.echoes = task.id = 0; // Cancel zone echoing.\n    }\n    zoneStack.push(PSD);\n    switchToZone(targetZone, true);\n}\nfunction zoneLeaveEcho() {\n    var zone = zoneStack[zoneStack.length - 1];\n    zoneStack.pop();\n    switchToZone(zone, false);\n}\nfunction switchToZone(targetZone, bEnteringZone) {\n    var currentZone = PSD;\n    if (bEnteringZone ? task.echoes && (!zoneEchoes++ || targetZone !== PSD) : zoneEchoes && (!--zoneEchoes || targetZone !== PSD)) {\n        // Enter or leave zone asynchronically as well, so that tasks initiated during current tick\n        // will be surrounded by the zone when they are invoked.\n        enqueueNativeMicroTask(bEnteringZone ? zoneEnterEcho.bind(null, targetZone) : zoneLeaveEcho);\n    }\n    if (targetZone === PSD)\n        return;\n    PSD = targetZone; // The actual zone switch occurs at this line.\n    // Snapshot on every leave from global zone.\n    if (currentZone === globalPSD)\n        globalPSD.env = snapShot();\n    if (patchGlobalPromise) {\n        // Let's patch the global and native Promises (may be same or may be different)\n        var GlobalPromise = globalPSD.env.Promise;\n        // Swich environments (may be PSD-zone or the global zone. Both apply.)\n        var targetEnv = targetZone.env;\n        // Change Promise.prototype.then for native and global Promise (they MAY differ on polyfilled environments, but both can be accessed)\n        // Must be done on each zone change because the patched method contains targetZone in its closure.\n        nativePromiseProto.then = targetEnv.nthen;\n        GlobalPromise.prototype.then = targetEnv.gthen;\n        if (currentZone.global || targetZone.global) {\n            // Leaving or entering global zone. It's time to patch / restore global Promise.\n            // Set this Promise to window.Promise so that transiled async functions will work on Firefox, Safari and IE, as well as with Zonejs and angular.\n            Object.defineProperty(_global, 'Promise', targetEnv.PromiseProp);\n            // Support Promise.all() etc to work indexedDB-safe also when people are including es6-promise as a module (they might\n            // not be accessing global.Promise but a local reference to it)\n            GlobalPromise.all = targetEnv.all;\n            GlobalPromise.race = targetEnv.race;\n            GlobalPromise.resolve = targetEnv.resolve;\n            GlobalPromise.reject = targetEnv.reject;\n        }\n    }\n}\nfunction snapShot() {\n    var GlobalPromise = _global.Promise;\n    return patchGlobalPromise ? {\n        Promise: GlobalPromise,\n        PromiseProp: Object.getOwnPropertyDescriptor(_global, \"Promise\"),\n        all: GlobalPromise.all,\n        race: GlobalPromise.race,\n        resolve: GlobalPromise.resolve,\n        reject: GlobalPromise.reject,\n        nthen: nativePromiseProto.then,\n        gthen: GlobalPromise.prototype.then\n    } : {};\n}\nfunction usePSD(psd, fn, a1, a2, a3) {\n    var outerScope = PSD;\n    try {\n        switchToZone(psd, true);\n        return fn(a1, a2, a3);\n    }\n    finally {\n        switchToZone(outerScope, false);\n    }\n}\nfunction enqueueNativeMicroTask(job) {\n    //\n    // Precondition: nativePromiseThen !== undefined\n    //\n    nativePromiseThen.call(resolvedNativePromise, job);\n}\nfunction nativeAwaitCompatibleWrap(fn, zone, possibleAwait) {\n    return typeof fn !== 'function' ? fn : function () {\n        var outerZone = PSD;\n        if (possibleAwait)\n            incrementExpectedAwaits();\n        switchToZone(zone, true);\n        try {\n            return fn.apply(this, arguments);\n        }\n        finally {\n            switchToZone(outerZone, false);\n        }\n    };\n}\nfunction getPatchedPromiseThen(origThen, zone) {\n    return function (onResolved, onRejected) {\n        return origThen.call(this, nativeAwaitCompatibleWrap(onResolved, zone, false), nativeAwaitCompatibleWrap(onRejected, zone, false));\n    };\n}\nvar UNHANDLEDREJECTION = \"unhandledrejection\";\nfunction globalError(err, promise) {\n    var rv;\n    try {\n        rv = promise.onuncatched(err);\n    }\n    catch (e) { }\n    if (rv !== false)\n        try {\n            var event, eventData = { promise: promise, reason: err };\n            if (_global.document && document.createEvent) {\n                event = document.createEvent('Event');\n                event.initEvent(UNHANDLEDREJECTION, true, true);\n                extend(event, eventData);\n            }\n            else if (_global.CustomEvent) {\n                event = new CustomEvent(UNHANDLEDREJECTION, { detail: eventData });\n                extend(event, eventData);\n            }\n            if (event && _global.dispatchEvent) {\n                dispatchEvent(event);\n                if (!_global.PromiseRejectionEvent && _global.onunhandledrejection)\n                    // No native support for PromiseRejectionEvent but user has set window.onunhandledrejection. Manually call it.\n                    try {\n                        _global.onunhandledrejection(event);\n                    }\n                    catch (_) { }\n            }\n            if (!event.defaultPrevented) {\n                console.warn(\"Unhandled rejection: \" + (err.stack || err));\n            }\n        }\n        catch (e) { }\n}\nvar rejection = Promise.reject;\n\nfunction Events(ctx) {\n    var evs = {};\n    var rv = function (eventName, subscriber) {\n        if (subscriber) {\n            // Subscribe. If additional arguments than just the subscriber was provided, forward them as well.\n            var i = arguments.length, args = new Array(i - 1);\n            while (--i)\n                args[i - 1] = arguments[i];\n            evs[eventName].subscribe.apply(null, args);\n            return ctx;\n        }\n        else if (typeof (eventName) === 'string') {\n            // Return interface allowing to fire or unsubscribe from event\n            return evs[eventName];\n        }\n    };\n    rv.addEventType = add;\n    for (var i = 1, l = arguments.length; i < l; ++i) {\n        add(arguments[i]);\n    }\n    return rv;\n    function add(eventName, chainFunction, defaultFunction) {\n        if (typeof eventName === 'object')\n            return addConfiguredEvents(eventName);\n        if (!chainFunction)\n            chainFunction = reverseStoppableEventChain;\n        if (!defaultFunction)\n            defaultFunction = nop;\n        var context = {\n            subscribers: [],\n            fire: defaultFunction,\n            subscribe: function (cb) {\n                if (context.subscribers.indexOf(cb) === -1) {\n                    context.subscribers.push(cb);\n                    context.fire = chainFunction(context.fire, cb);\n                }\n            },\n            unsubscribe: function (cb) {\n                context.subscribers = context.subscribers.filter(function (fn) { return fn !== cb; });\n                context.fire = context.subscribers.reduce(chainFunction, defaultFunction);\n            }\n        };\n        evs[eventName] = rv[eventName] = context;\n        return context;\n    }\n    function addConfiguredEvents(cfg) {\n        // events(this, {reading: [functionChain, nop]});\n        keys(cfg).forEach(function (eventName) {\n            var args = cfg[eventName];\n            if (isArray(args)) {\n                add(eventName, cfg[eventName][0], cfg[eventName][1]);\n            }\n            else if (args === 'asap') {\n                // Rather than approaching event subscription using a functional approach, we here do it in a for-loop where subscriber is executed in its own stack\n                // enabling that any exception that occur wont disturb the initiator and also not nescessary be catched and forgotten.\n                var context = add(eventName, mirror, function fire() {\n                    // Optimazation-safe cloning of arguments into args.\n                    var i = arguments.length, args = new Array(i);\n                    while (i--)\n                        args[i] = arguments[i];\n                    // All each subscriber:\n                    context.subscribers.forEach(function (fn) {\n                        asap(function fireEvent() {\n                            fn.apply(null, args);\n                        });\n                    });\n                });\n            }\n            else\n                throw new exceptions.InvalidArgument(\"Invalid event config\");\n        });\n    }\n}\n\n/*\n * Dexie.js - a minimalistic wrapper for IndexedDB\n * ===============================================\n *\n * Copyright (c) 2014-2017 David Fahlander\n *\n * Version {version}, {date}\n *\n * http://dexie.org\n *\n * Apache License Version 2.0, January 2004, http://www.apache.org/licenses/LICENSE-2.0\n *\n */\nvar DEXIE_VERSION = '{version}';\nvar maxString = String.fromCharCode(65535);\nvar maxKey = (function () { try {\n    IDBKeyRange.only([[]]);\n    return [[]];\n}\ncatch (e) {\n    return maxString;\n} })();\nvar minKey = -Infinity;\nvar INVALID_KEY_ARGUMENT = \"Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.\";\nvar STRING_EXPECTED = \"String expected.\";\nvar connections = [];\nvar isIEOrEdge = typeof navigator !== 'undefined' && /(MSIE|Trident|Edge)/.test(navigator.userAgent);\nvar hasIEDeleteObjectStoreBug = isIEOrEdge;\nvar hangsOnDeleteLargeKeyRange = isIEOrEdge;\nvar dexieStackFrameFilter = function (frame) { return !/(dexie\\.js|dexie\\.min\\.js)/.test(frame); };\nvar dbNamesDB; // Global database for backing Dexie.getDatabaseNames() on browser without indexedDB.webkitGetDatabaseNames() \n// Init debug\nsetDebug(debug, dexieStackFrameFilter);\nfunction Dexie(dbName, options) {\n    /// <param name=\"options\" type=\"Object\" optional=\"true\">Specify only if you wich to control which addons that should run on this instance</param>\n    var deps = Dexie.dependencies;\n    var opts = extend({\n        // Default Options\n        addons: Dexie.addons,\n        autoOpen: true,\n        indexedDB: deps.indexedDB,\n        IDBKeyRange: deps.IDBKeyRange // Backend IDBKeyRange api. Default to browser env.\n    }, options);\n    var addons = opts.addons, autoOpen = opts.autoOpen, indexedDB = opts.indexedDB, IDBKeyRange = opts.IDBKeyRange;\n    var globalSchema = this._dbSchema = {};\n    var versions = [];\n    var dbStoreNames = [];\n    var allTables = {};\n    ///<var type=\"IDBDatabase\" />\n    var idbdb = null; // Instance of IDBDatabase\n    var dbOpenError = null;\n    var isBeingOpened = false;\n    var onReadyBeingFired = null;\n    var openComplete = false;\n    var READONLY = \"readonly\", READWRITE = \"readwrite\";\n    var db = this;\n    var dbReadyResolve, dbReadyPromise = new Promise(function (resolve) {\n        dbReadyResolve = resolve;\n    }), cancelOpen, openCanceller = new Promise(function (_, reject) {\n        cancelOpen = reject;\n    });\n    var autoSchema = true;\n    var hasNativeGetDatabaseNames = !!getNativeGetDatabaseNamesFn(indexedDB), hasGetAll;\n    function init() {\n        // Default subscribers to \"versionchange\" and \"blocked\".\n        // Can be overridden by custom handlers. If custom handlers return false, these default\n        // behaviours will be prevented.\n        db.on(\"versionchange\", function (ev) {\n            // Default behavior for versionchange event is to close database connection.\n            // Caller can override this behavior by doing db.on(\"versionchange\", function(){ return false; });\n            // Let's not block the other window from making it's delete() or open() call.\n            // NOTE! This event is never fired in IE,Edge or Safari.\n            if (ev.newVersion > 0)\n                console.warn(\"Another connection wants to upgrade database '\" + db.name + \"'. Closing db now to resume the upgrade.\");\n            else\n                console.warn(\"Another connection wants to delete database '\" + db.name + \"'. Closing db now to resume the delete request.\");\n            db.close();\n            // In many web applications, it would be recommended to force window.reload()\n            // when this event occurs. To do that, subscribe to the versionchange event\n            // and call window.location.reload(true) if ev.newVersion > 0 (not a deletion)\n            // The reason for this is that your current web app obviously has old schema code that needs\n            // to be updated. Another window got a newer version of the app and needs to upgrade DB but\n            // your window is blocking it unless we close it here.\n        });\n        db.on(\"blocked\", function (ev) {\n            if (!ev.newVersion || ev.newVersion < ev.oldVersion)\n                console.warn(\"Dexie.delete('\" + db.name + \"') was blocked\");\n            else\n                console.warn(\"Upgrade '\" + db.name + \"' blocked by other connection holding version \" + ev.oldVersion / 10);\n        });\n    }\n    //\n    //\n    //\n    // ------------------------- Versioning Framework---------------------------\n    //\n    //\n    //\n    this.version = function (versionNumber) {\n        /// <param name=\"versionNumber\" type=\"Number\"></param>\n        /// <returns type=\"Version\"></returns>\n        if (idbdb || isBeingOpened)\n            throw new exceptions.Schema(\"Cannot add version when database is open\");\n        this.verno = Math.max(this.verno, versionNumber);\n        var versionInstance = versions.filter(function (v) { return v._cfg.version === versionNumber; })[0];\n        if (versionInstance)\n            return versionInstance;\n        versionInstance = new Version(versionNumber);\n        versions.push(versionInstance);\n        versions.sort(lowerVersionFirst);\n        // Disable autoschema mode, as at least one version is specified.\n        autoSchema = false;\n        return versionInstance;\n    };\n    function Version(versionNumber) {\n        this._cfg = {\n            version: versionNumber,\n            storesSource: null,\n            dbschema: {},\n            tables: {},\n            contentUpgrade: null\n        };\n        this.stores({}); // Derive earlier schemas by default.\n    }\n    extend(Version.prototype, {\n        stores: function (stores) {\n            /// <summary>\n            ///   Defines the schema for a particular version\n            /// </summary>\n            /// <param name=\"stores\" type=\"Object\">\n            /// Example: <br/>\n            ///   {users: \"id++,first,last,&amp;username,*email\", <br/>\n            ///   passwords: \"id++,&amp;username\"}<br/>\n            /// <br/>\n            /// Syntax: {Table: \"[primaryKey][++],[&amp;][*]index1,[&amp;][*]index2,...\"}<br/><br/>\n            /// Special characters:<br/>\n            ///  \"&amp;\"  means unique key, <br/>\n            ///  \"*\"  means value is multiEntry, <br/>\n            ///  \"++\" means auto-increment and only applicable for primary key <br/>\n            /// </param>\n            this._cfg.storesSource = this._cfg.storesSource ? extend(this._cfg.storesSource, stores) : stores;\n            // Derive stores from earlier versions if they are not explicitely specified as null or a new syntax.\n            var storesSpec = {};\n            versions.forEach(function (version) {\n                extend(storesSpec, version._cfg.storesSource);\n            });\n            var dbschema = (this._cfg.dbschema = {});\n            this._parseStoresSpec(storesSpec, dbschema);\n            // Update the latest schema to this version\n            // Update API\n            globalSchema = db._dbSchema = dbschema;\n            removeTablesApi([allTables, db, Transaction.prototype]); // Keep Transaction.prototype even though it should be depr.\n            setApiOnPlace([allTables, db, Transaction.prototype, this._cfg.tables], keys(dbschema), dbschema);\n            dbStoreNames = keys(dbschema);\n            return this;\n        },\n        upgrade: function (upgradeFunction) {\n            this._cfg.contentUpgrade = upgradeFunction;\n            return this;\n        },\n        _parseStoresSpec: function (stores, outSchema) {\n            keys(stores).forEach(function (tableName) {\n                if (stores[tableName] !== null) {\n                    var instanceTemplate = {};\n                    var indexes = parseIndexSyntax(stores[tableName]);\n                    var primKey = indexes.shift();\n                    if (primKey.multi)\n                        throw new exceptions.Schema(\"Primary key cannot be multi-valued\");\n                    if (primKey.keyPath)\n                        setByKeyPath(instanceTemplate, primKey.keyPath, primKey.auto ? 0 : primKey.keyPath);\n                    indexes.forEach(function (idx) {\n                        if (idx.auto)\n                            throw new exceptions.Schema(\"Only primary key can be marked as autoIncrement (++)\");\n                        if (!idx.keyPath)\n                            throw new exceptions.Schema(\"Index must have a name and cannot be an empty string\");\n                        setByKeyPath(instanceTemplate, idx.keyPath, idx.compound ? idx.keyPath.map(function () { return \"\"; }) : \"\");\n                    });\n                    outSchema[tableName] = new TableSchema(tableName, primKey, indexes, instanceTemplate);\n                }\n            });\n        }\n    });\n    function runUpgraders(oldVersion, idbtrans, reject) {\n        var trans = db._createTransaction(READWRITE, dbStoreNames, globalSchema);\n        trans.create(idbtrans);\n        trans._completion.catch(reject);\n        var rejectTransaction = trans._reject.bind(trans);\n        newScope(function () {\n            PSD.trans = trans;\n            if (oldVersion === 0) {\n                // Create tables:\n                keys(globalSchema).forEach(function (tableName) {\n                    createTable(idbtrans, tableName, globalSchema[tableName].primKey, globalSchema[tableName].indexes);\n                });\n                Promise.follow(function () { return db.on.populate.fire(trans); }).catch(rejectTransaction);\n            }\n            else\n                updateTablesAndIndexes(oldVersion, trans, idbtrans).catch(rejectTransaction);\n        });\n    }\n    function updateTablesAndIndexes(oldVersion, trans, idbtrans) {\n        // Upgrade version to version, step-by-step from oldest to newest version.\n        // Each transaction object will contain the table set that was current in that version (but also not-yet-deleted tables from its previous version)\n        var queue = [];\n        var oldVersionStruct = versions.filter(function (version) { return version._cfg.version === oldVersion; })[0];\n        if (!oldVersionStruct)\n            throw new exceptions.Upgrade(\"Dexie specification of currently installed DB version is missing\");\n        globalSchema = db._dbSchema = oldVersionStruct._cfg.dbschema;\n        var anyContentUpgraderHasRun = false;\n        var versToRun = versions.filter(function (v) { return v._cfg.version > oldVersion; });\n        versToRun.forEach(function (version) {\n            /// <param name=\"version\" type=\"Version\"></param>\n            queue.push(function () {\n                var oldSchema = globalSchema;\n                var newSchema = version._cfg.dbschema;\n                adjustToExistingIndexNames(oldSchema, idbtrans);\n                adjustToExistingIndexNames(newSchema, idbtrans);\n                globalSchema = db._dbSchema = newSchema;\n                var diff = getSchemaDiff(oldSchema, newSchema);\n                // Add tables           \n                diff.add.forEach(function (tuple) {\n                    createTable(idbtrans, tuple[0], tuple[1].primKey, tuple[1].indexes);\n                });\n                // Change tables\n                diff.change.forEach(function (change) {\n                    if (change.recreate) {\n                        throw new exceptions.Upgrade(\"Not yet support for changing primary key\");\n                    }\n                    else {\n                        var store = idbtrans.objectStore(change.name);\n                        // Add indexes\n                        change.add.forEach(function (idx) {\n                            addIndex(store, idx);\n                        });\n                        // Update indexes\n                        change.change.forEach(function (idx) {\n                            store.deleteIndex(idx.name);\n                            addIndex(store, idx);\n                        });\n                        // Delete indexes\n                        change.del.forEach(function (idxName) {\n                            store.deleteIndex(idxName);\n                        });\n                    }\n                });\n                if (version._cfg.contentUpgrade) {\n                    anyContentUpgraderHasRun = true;\n                    return Promise.follow(function () {\n                        version._cfg.contentUpgrade(trans);\n                    });\n                }\n            });\n            queue.push(function (idbtrans) {\n                if (!anyContentUpgraderHasRun || !hasIEDeleteObjectStoreBug) {\n                    var newSchema = version._cfg.dbschema;\n                    // Delete old tables\n                    deleteRemovedTables(newSchema, idbtrans);\n                }\n            });\n        });\n        // Now, create a queue execution engine\n        function runQueue() {\n            return queue.length ? Promise.resolve(queue.shift()(trans.idbtrans)).then(runQueue) :\n                Promise.resolve();\n        }\n        return runQueue().then(function () {\n            createMissingTables(globalSchema, idbtrans); // At last, make sure to create any missing tables. (Needed by addons that add stores to DB without specifying version)\n        });\n    }\n    function getSchemaDiff(oldSchema, newSchema) {\n        var diff = {\n            del: [],\n            add: [],\n            change: [] // Array of {name: tableName, recreate: newDefinition, del: delIndexNames, add: newIndexDefs, change: changedIndexDefs}\n        };\n        for (var table in oldSchema) {\n            if (!newSchema[table])\n                diff.del.push(table);\n        }\n        for (table in newSchema) {\n            var oldDef = oldSchema[table], newDef = newSchema[table];\n            if (!oldDef) {\n                diff.add.push([table, newDef]);\n            }\n            else {\n                var change = {\n                    name: table,\n                    def: newDef,\n                    recreate: false,\n                    del: [],\n                    add: [],\n                    change: []\n                };\n                if (oldDef.primKey.src !== newDef.primKey.src) {\n                    // Primary key has changed. Remove and re-add table.\n                    change.recreate = true;\n                    diff.change.push(change);\n                }\n                else {\n                    // Same primary key. Just find out what differs:\n                    var oldIndexes = oldDef.idxByName;\n                    var newIndexes = newDef.idxByName;\n                    for (var idxName in oldIndexes) {\n                        if (!newIndexes[idxName])\n                            change.del.push(idxName);\n                    }\n                    for (idxName in newIndexes) {\n                        var oldIdx = oldIndexes[idxName], newIdx = newIndexes[idxName];\n                        if (!oldIdx)\n                            change.add.push(newIdx);\n                        else if (oldIdx.src !== newIdx.src)\n                            change.change.push(newIdx);\n                    }\n                    if (change.del.length > 0 || change.add.length > 0 || change.change.length > 0) {\n                        diff.change.push(change);\n                    }\n                }\n            }\n        }\n        return diff;\n    }\n    function createTable(idbtrans, tableName, primKey, indexes) {\n        /// <param name=\"idbtrans\" type=\"IDBTransaction\"></param>\n        var store = idbtrans.db.createObjectStore(tableName, primKey.keyPath ? { keyPath: primKey.keyPath, autoIncrement: primKey.auto } : { autoIncrement: primKey.auto });\n        indexes.forEach(function (idx) { addIndex(store, idx); });\n        return store;\n    }\n    function createMissingTables(newSchema, idbtrans) {\n        keys(newSchema).forEach(function (tableName) {\n            if (!idbtrans.db.objectStoreNames.contains(tableName)) {\n                createTable(idbtrans, tableName, newSchema[tableName].primKey, newSchema[tableName].indexes);\n            }\n        });\n    }\n    function deleteRemovedTables(newSchema, idbtrans) {\n        for (var i = 0; i < idbtrans.db.objectStoreNames.length; ++i) {\n            var storeName = idbtrans.db.objectStoreNames[i];\n            if (newSchema[storeName] == null) {\n                idbtrans.db.deleteObjectStore(storeName);\n            }\n        }\n    }\n    function addIndex(store, idx) {\n        store.createIndex(idx.name, idx.keyPath, { unique: idx.unique, multiEntry: idx.multi });\n    }\n    //\n    //\n    //      Dexie Protected API\n    //\n    //\n    this._allTables = allTables;\n    this._createTransaction = function (mode, storeNames, dbschema, parentTransaction) {\n        return new Transaction(mode, storeNames, dbschema, parentTransaction);\n    };\n    /* Generate a temporary transaction when db operations are done outside a transaction scope.\n    */\n    function tempTransaction(mode, storeNames, fn) {\n        if (!openComplete && (!PSD.letThrough)) {\n            if (!isBeingOpened) {\n                if (!autoOpen)\n                    return rejection(new exceptions.DatabaseClosed());\n                db.open().catch(nop); // Open in background. If if fails, it will be catched by the final promise anyway.\n            }\n            return dbReadyPromise.then(function () { return tempTransaction(mode, storeNames, fn); });\n        }\n        else {\n            var trans = db._createTransaction(mode, storeNames, globalSchema);\n            try {\n                trans.create();\n            }\n            catch (ex) {\n                return rejection(ex);\n            }\n            return trans._promise(mode, function (resolve, reject) {\n                return newScope(function () {\n                    PSD.trans = trans;\n                    return fn(resolve, reject, trans);\n                });\n            }).then(function (result) {\n                // Instead of resolving value directly, wait with resolving it until transaction has completed.\n                // Otherwise the data would not be in the DB if requesting it in the then() operation.\n                // Specifically, to ensure that the following expression will work:\n                //\n                //   db.friends.put({name: \"Arne\"}).then(function () {\n                //       db.friends.where(\"name\").equals(\"Arne\").count(function(count) {\n                //           assert (count === 1);\n                //       });\n                //   });\n                //\n                return trans._completion.then(function () { return result; });\n            }); /*.catch(err => { // Don't do this as of now. If would affect bulk- and modify methods in a way that could be more intuitive. But wait! Maybe change in next major.\n                trans._reject(err);\n                return rejection(err);\n            });*/\n        }\n    }\n    this._whenReady = function (fn) {\n        return openComplete || PSD.letThrough ? fn() : new Promise(function (resolve, reject) {\n            if (!isBeingOpened) {\n                if (!autoOpen) {\n                    reject(new exceptions.DatabaseClosed());\n                    return;\n                }\n                db.open().catch(nop); // Open in background. If if fails, it will be catched by the final promise anyway.\n            }\n            dbReadyPromise.then(resolve, reject);\n        }).then(fn);\n    };\n    //\n    //\n    //\n    //\n    //      Dexie API\n    //\n    //\n    //\n    this.verno = 0;\n    this.open = function () {\n        if (isBeingOpened || idbdb)\n            return dbReadyPromise.then(function () { return dbOpenError ? rejection(dbOpenError) : db; });\n        debug && (openCanceller._stackHolder = getErrorWithStack()); // Let stacks point to when open() was called rather than where new Dexie() was called.\n        isBeingOpened = true;\n        dbOpenError = null;\n        openComplete = false;\n        // Function pointers to call when the core opening process completes.\n        var resolveDbReady = dbReadyResolve, \n        // upgradeTransaction to abort on failure.\n        upgradeTransaction = null;\n        return Promise.race([openCanceller, new Promise(function (resolve, reject) {\n                // Multiply db.verno with 10 will be needed to workaround upgrading bug in IE:\n                // IE fails when deleting objectStore after reading from it.\n                // A future version of Dexie.js will stopover an intermediate version to workaround this.\n                // At that point, we want to be backward compatible. Could have been multiplied with 2, but by using 10, it is easier to map the number to the real version number.\n                // If no API, throw!\n                if (!indexedDB)\n                    throw new exceptions.MissingAPI(\"indexedDB API not found. If using IE10+, make sure to run your code on a server URL \" +\n                        \"(not locally). If using old Safari versions, make sure to include indexedDB polyfill.\");\n                var req = autoSchema ? indexedDB.open(dbName) : indexedDB.open(dbName, Math.round(db.verno * 10));\n                if (!req)\n                    throw new exceptions.MissingAPI(\"IndexedDB API not available\"); // May happen in Safari private mode, see https://github.com/dfahlander/Dexie.js/issues/134\n                req.onerror = eventRejectHandler(reject);\n                req.onblocked = wrap(fireOnBlocked);\n                req.onupgradeneeded = wrap(function (e) {\n                    upgradeTransaction = req.transaction;\n                    if (autoSchema && !db._allowEmptyDB) {\n                        // Caller did not specify a version or schema. Doing that is only acceptable for opening alread existing databases.\n                        // If onupgradeneeded is called it means database did not exist. Reject the open() promise and make sure that we\n                        // do not create a new database by accident here.\n                        req.onerror = preventDefault; // Prohibit onabort error from firing before we're done!\n                        upgradeTransaction.abort(); // Abort transaction (would hope that this would make DB disappear but it doesnt.)\n                        // Close database and delete it.\n                        req.result.close();\n                        var delreq = indexedDB.deleteDatabase(dbName); // The upgrade transaction is atomic, and javascript is single threaded - meaning that there is no risk that we delete someone elses database here!\n                        delreq.onsuccess = delreq.onerror = wrap(function () {\n                            reject(new exceptions.NoSuchDatabase(\"Database \" + dbName + \" doesnt exist\"));\n                        });\n                    }\n                    else {\n                        upgradeTransaction.onerror = eventRejectHandler(reject);\n                        var oldVer = e.oldVersion > Math.pow(2, 62) ? 0 : e.oldVersion; // Safari 8 fix.\n                        runUpgraders(oldVer / 10, upgradeTransaction, reject, req);\n                    }\n                }, reject);\n                req.onsuccess = wrap(function () {\n                    // Core opening procedure complete. Now let's just record some stuff.\n                    upgradeTransaction = null;\n                    idbdb = req.result;\n                    connections.push(db); // Used for emulating versionchange event on IE/Edge/Safari.\n                    if (autoSchema)\n                        readGlobalSchema();\n                    else if (idbdb.objectStoreNames.length > 0) {\n                        try {\n                            adjustToExistingIndexNames(globalSchema, idbdb.transaction(safariMultiStoreFix(idbdb.objectStoreNames), READONLY));\n                        }\n                        catch (e) {\n                            // Safari may bail out if > 1 store names. However, this shouldnt be a showstopper. Issue #120.\n                        }\n                    }\n                    idbdb.onversionchange = wrap(function (ev) {\n                        db._vcFired = true; // detect implementations that not support versionchange (IE/Edge/Safari)\n                        db.on(\"versionchange\").fire(ev);\n                    });\n                    if (!hasNativeGetDatabaseNames && dbName !== '__dbnames') {\n                        dbNamesDB.dbnames.put({ name: dbName }).catch(nop);\n                    }\n                    resolve();\n                }, reject);\n            })]).then(function () {\n            // Before finally resolving the dbReadyPromise and this promise,\n            // call and await all on('ready') subscribers:\n            // Dexie.vip() makes subscribers able to use the database while being opened.\n            // This is a must since these subscribers take part of the opening procedure.\n            onReadyBeingFired = [];\n            return Promise.resolve(Dexie.vip(db.on.ready.fire)).then(function fireRemainders() {\n                if (onReadyBeingFired.length > 0) {\n                    // In case additional subscribers to db.on('ready') were added during the time db.on.ready.fire was executed.\n                    var remainders = onReadyBeingFired.reduce(promisableChain, nop);\n                    onReadyBeingFired = [];\n                    return Promise.resolve(Dexie.vip(remainders)).then(fireRemainders);\n                }\n            });\n        }).finally(function () {\n            onReadyBeingFired = null;\n        }).then(function () {\n            // Resolve the db.open() with the db instance.\n            isBeingOpened = false;\n            return db;\n        }).catch(function (err) {\n            try {\n                // Did we fail within onupgradeneeded? Make sure to abort the upgrade transaction so it doesnt commit.\n                upgradeTransaction && upgradeTransaction.abort();\n            }\n            catch (e) { }\n            isBeingOpened = false; // Set before calling db.close() so that it doesnt reject openCanceller again (leads to unhandled rejection event).\n            db.close(); // Closes and resets idbdb, removes connections, resets dbReadyPromise and openCanceller so that a later db.open() is fresh.\n            // A call to db.close() may have made on-ready subscribers fail. Use dbOpenError if set, since err could be a follow-up error on that.\n            dbOpenError = err; // Record the error. It will be used to reject further promises of db operations.\n            return rejection(dbOpenError);\n        }).finally(function () {\n            openComplete = true;\n            resolveDbReady(); // dbReadyPromise is resolved no matter if open() rejects or resolved. It's just to wake up waiters.\n        });\n    };\n    this.close = function () {\n        var idx = connections.indexOf(db);\n        if (idx >= 0)\n            connections.splice(idx, 1);\n        if (idbdb) {\n            try {\n                idbdb.close();\n            }\n            catch (e) { }\n            idbdb = null;\n        }\n        autoOpen = false;\n        dbOpenError = new exceptions.DatabaseClosed();\n        if (isBeingOpened)\n            cancelOpen(dbOpenError);\n        // Reset dbReadyPromise promise:\n        dbReadyPromise = new Promise(function (resolve) {\n            dbReadyResolve = resolve;\n        });\n        openCanceller = new Promise(function (_, reject) {\n            cancelOpen = reject;\n        });\n    };\n    this.delete = function () {\n        var hasArguments = arguments.length > 0;\n        return new Promise(function (resolve, reject) {\n            if (hasArguments)\n                throw new exceptions.InvalidArgument(\"Arguments not allowed in db.delete()\");\n            if (isBeingOpened) {\n                dbReadyPromise.then(doDelete);\n            }\n            else {\n                doDelete();\n            }\n            function doDelete() {\n                db.close();\n                var req = indexedDB.deleteDatabase(dbName);\n                req.onsuccess = wrap(function () {\n                    if (!hasNativeGetDatabaseNames) {\n                        dbNamesDB.dbnames.delete(dbName).catch(nop);\n                    }\n                    resolve();\n                });\n                req.onerror = eventRejectHandler(reject);\n                req.onblocked = fireOnBlocked;\n            }\n        });\n    };\n    this.backendDB = function () {\n        return idbdb;\n    };\n    this.isOpen = function () {\n        return idbdb !== null;\n    };\n    this.hasBeenClosed = function () {\n        return dbOpenError && (dbOpenError instanceof exceptions.DatabaseClosed);\n    };\n    this.hasFailed = function () {\n        return dbOpenError !== null;\n    };\n    this.dynamicallyOpened = function () {\n        return autoSchema;\n    };\n    //\n    // Properties\n    //\n    this.name = dbName;\n    // db.tables - an array of all Table instances.\n    props(this, {\n        tables: {\n            get: function () {\n                /// <returns type=\"Array\" elementType=\"Table\" />\n                return keys(allTables).map(function (name) { return allTables[name]; });\n            }\n        }\n    });\n    //\n    // Events\n    //\n    this.on = Events(this, \"populate\", \"blocked\", \"versionchange\", { ready: [promisableChain, nop] });\n    this.on.ready.subscribe = override(this.on.ready.subscribe, function (subscribe) {\n        return function (subscriber, bSticky) {\n            Dexie.vip(function () {\n                if (openComplete) {\n                    // Database already open. Call subscriber asap.\n                    if (!dbOpenError)\n                        Promise.resolve().then(subscriber);\n                    // bSticky: Also subscribe to future open sucesses (after close / reopen) \n                    if (bSticky)\n                        subscribe(subscriber);\n                }\n                else if (onReadyBeingFired) {\n                    // db.on('ready') subscribers are currently being executed and have not yet resolved or rejected\n                    onReadyBeingFired.push(subscriber);\n                    if (bSticky)\n                        subscribe(subscriber);\n                }\n                else {\n                    // Database not yet open. Subscribe to it.\n                    subscribe(subscriber);\n                    // If bSticky is falsy, make sure to unsubscribe subscriber when fired once.\n                    if (!bSticky)\n                        subscribe(function unsubscribe() {\n                            db.on.ready.unsubscribe(subscriber);\n                            db.on.ready.unsubscribe(unsubscribe);\n                        });\n                }\n            });\n        };\n    });\n    this.transaction = function () {\n        /// <summary>\n        ///\n        /// </summary>\n        /// <param name=\"mode\" type=\"String\">\"r\" for readonly, or \"rw\" for readwrite</param>\n        /// <param name=\"tableInstances\">Table instance, Array of Table instances, String or String Array of object stores to include in the transaction</param>\n        /// <param name=\"scopeFunc\" type=\"Function\">Function to execute with transaction</param>\n        var args = extractTransactionArgs.apply(this, arguments);\n        return this._transaction.apply(this, args);\n    };\n    function extractTransactionArgs(mode, _tableArgs_, scopeFunc) {\n        // Let table arguments be all arguments between mode and last argument.\n        var i = arguments.length;\n        if (i < 2)\n            throw new exceptions.InvalidArgument(\"Too few arguments\");\n        // Prevent optimzation killer (https://github.com/petkaantonov/bluebird/wiki/Optimization-killers#32-leaking-arguments)\n        // and clone arguments except the first one into local var 'args'.\n        var args = new Array(i - 1);\n        while (--i)\n            args[i - 1] = arguments[i];\n        // Let scopeFunc be the last argument and pop it so that args now only contain the table arguments.\n        scopeFunc = args.pop();\n        var tables = flatten(args); // Support using array as middle argument, or a mix of arrays and non-arrays.\n        return [mode, tables, scopeFunc];\n    }\n    this._transaction = function (mode, tables, scopeFunc) {\n        var parentTransaction = PSD.trans;\n        // Check if parent transactions is bound to this db instance, and if caller wants to reuse it\n        if (!parentTransaction || parentTransaction.db !== db || mode.indexOf('!') !== -1)\n            parentTransaction = null;\n        var onlyIfCompatible = mode.indexOf('?') !== -1;\n        mode = mode.replace('!', '').replace('?', ''); // Ok. Will change arguments[0] as well but we wont touch arguments henceforth.\n        try {\n            //\n            // Get storeNames from arguments. Either through given table instances, or through given table names.\n            //\n            var storeNames = tables.map(function (table) {\n                var storeName = table instanceof Table ? table.name : table;\n                if (typeof storeName !== 'string')\n                    throw new TypeError(\"Invalid table argument to Dexie.transaction(). Only Table or String are allowed\");\n                return storeName;\n            });\n            //\n            // Resolve mode. Allow shortcuts \"r\" and \"rw\".\n            //\n            if (mode == \"r\" || mode == READONLY)\n                mode = READONLY;\n            else if (mode == \"rw\" || mode == READWRITE)\n                mode = READWRITE;\n            else\n                throw new exceptions.InvalidArgument(\"Invalid transaction mode: \" + mode);\n            if (parentTransaction) {\n                // Basic checks\n                if (parentTransaction.mode === READONLY && mode === READWRITE) {\n                    if (onlyIfCompatible) {\n                        // Spawn new transaction instead.\n                        parentTransaction = null;\n                    }\n                    else\n                        throw new exceptions.SubTransaction(\"Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY\");\n                }\n                if (parentTransaction) {\n                    storeNames.forEach(function (storeName) {\n                        if (parentTransaction && parentTransaction.storeNames.indexOf(storeName) === -1) {\n                            if (onlyIfCompatible) {\n                                // Spawn new transaction instead.\n                                parentTransaction = null;\n                            }\n                            else\n                                throw new exceptions.SubTransaction(\"Table \" + storeName +\n                                    \" not included in parent transaction.\");\n                        }\n                    });\n                }\n                if (onlyIfCompatible && parentTransaction && !parentTransaction.active) {\n                    // '?' mode should not keep using an inactive transaction.\n                    parentTransaction = null;\n                }\n            }\n        }\n        catch (e) {\n            return parentTransaction ?\n                parentTransaction._promise(null, function (_, reject) { reject(e); }) :\n                rejection(e);\n        }\n        // If this is a sub-transaction, lock the parent and then launch the sub-transaction.\n        return (parentTransaction ?\n            parentTransaction._promise(mode, enterTransactionScope, \"lock\") :\n            PSD.trans ?\n                // no parent transaction despite PSD.trans exists. Make sure also\n                // that the zone we create is not a sub-zone of current, because\n                // Promise.follow() should not wait for it if so.\n                usePSD(PSD.transless, function () { return db._whenReady(enterTransactionScope); }) :\n                db._whenReady(enterTransactionScope));\n        function enterTransactionScope() {\n            return Promise.resolve().then(function () {\n                // Keep a pointer to last non-transactional PSD to use if someone calls Dexie.ignoreTransaction().\n                var transless = PSD.transless || PSD;\n                // Our transaction.\n                //return new Promise((resolve, reject) => {\n                var trans = db._createTransaction(mode, storeNames, globalSchema, parentTransaction);\n                // Let the transaction instance be part of a Promise-specific data (PSD) value.\n                var zoneProps = {\n                    trans: trans,\n                    transless: transless\n                };\n                if (parentTransaction) {\n                    // Emulate transaction commit awareness for inner transaction (must 'commit' when the inner transaction has no more operations ongoing)\n                    trans.idbtrans = parentTransaction.idbtrans;\n                }\n                else {\n                    trans.create(); // Create the backend transaction so that complete() or error() will trigger even if no operation is made upon it.\n                }\n                // Support for native async await.\n                if (scopeFunc.constructor === AsyncFunction) {\n                    incrementExpectedAwaits();\n                }\n                var returnValue;\n                var promiseFollowed = Promise.follow(function () {\n                    // Finally, call the scope function with our table and transaction arguments.\n                    returnValue = scopeFunc.call(trans, trans);\n                    if (returnValue) {\n                        if (returnValue.constructor === NativePromise) {\n                            var decrementor = decrementExpectedAwaits.bind(null, null);\n                            returnValue.then(decrementor, decrementor);\n                        }\n                        else if (typeof returnValue.next === 'function' && typeof returnValue.throw === 'function') {\n                            // scopeFunc returned an iterator with throw-support. Handle yield as await.\n                            returnValue = awaitIterator(returnValue);\n                        }\n                    }\n                }, zoneProps);\n                return (returnValue && typeof returnValue.then === 'function' ?\n                    // Promise returned. User uses promise-style transactions.\n                    Promise.resolve(returnValue).then(function (x) { return trans.active ?\n                        x // Transaction still active. Continue.\n                        : rejection(new exceptions.PrematureCommit(\"Transaction committed too early. See http://bit.ly/2kdckMn\")); })\n                    // No promise returned. Wait for all outstanding promises before continuing. \n                    : promiseFollowed.then(function () { return returnValue; })).then(function (x) {\n                    // sub transactions don't react to idbtrans.oncomplete. We must trigger a completion:\n                    if (parentTransaction)\n                        trans._resolve();\n                    // wait for trans._completion\n                    // (if root transaction, this means 'complete' event. If sub-transaction, we've just fired it ourselves)\n                    return trans._completion.then(function () { return x; });\n                }).catch(function (e) {\n                    trans._reject(e); // Yes, above then-handler were maybe not called because of an unhandled rejection in scopeFunc!\n                    return rejection(e);\n                });\n            });\n        }\n    };\n    this.table = function (tableName) {\n        /// <returns type=\"Table\"></returns>\n        if (!hasOwn(allTables, tableName)) {\n            throw new exceptions.InvalidTable(\"Table \" + tableName + \" does not exist\");\n        }\n        return allTables[tableName];\n    };\n    //\n    //\n    //\n    // Table Class\n    //\n    //\n    //\n    function Table(name, tableSchema, optionalTrans) {\n        /// <param name=\"name\" type=\"String\"></param>\n        this.name = name;\n        this.schema = tableSchema;\n        this._tx = optionalTrans;\n        this.hook = allTables[name] ? allTables[name].hook : Events(null, {\n            \"creating\": [hookCreatingChain, nop],\n            \"reading\": [pureFunctionChain, mirror],\n            \"updating\": [hookUpdatingChain, nop],\n            \"deleting\": [hookDeletingChain, nop]\n        });\n    }\n    function BulkErrorHandlerCatchAll(errorList, done, supportHooks) {\n        return (supportHooks ? hookedEventRejectHandler : eventRejectHandler)(function (e) {\n            errorList.push(e);\n            done && done();\n        });\n    }\n    function bulkDelete(idbstore, trans, keysOrTuples, hasDeleteHook, deletingHook) {\n        // If hasDeleteHook, keysOrTuples must be an array of tuples: [[key1, value2],[key2,value2],...],\n        // else keysOrTuples must be just an array of keys: [key1, key2, ...].\n        return new Promise(function (resolve, reject) {\n            var len = keysOrTuples.length, lastItem = len - 1;\n            if (len === 0)\n                return resolve();\n            if (!hasDeleteHook) {\n                for (var i = 0; i < len; ++i) {\n                    var req = idbstore.delete(keysOrTuples[i]);\n                    req.onerror = eventRejectHandler(reject);\n                    if (i === lastItem)\n                        req.onsuccess = wrap(function () { return resolve(); });\n                }\n            }\n            else {\n                var hookCtx, errorHandler = hookedEventRejectHandler(reject), successHandler = hookedEventSuccessHandler(null);\n                tryCatch(function () {\n                    for (var i = 0; i < len; ++i) {\n                        hookCtx = { onsuccess: null, onerror: null };\n                        var tuple = keysOrTuples[i];\n                        deletingHook.call(hookCtx, tuple[0], tuple[1], trans);\n                        var req = idbstore.delete(tuple[0]);\n                        req._hookCtx = hookCtx;\n                        req.onerror = errorHandler;\n                        if (i === lastItem)\n                            req.onsuccess = hookedEventSuccessHandler(resolve);\n                        else\n                            req.onsuccess = successHandler;\n                    }\n                }, function (err) {\n                    hookCtx.onerror && hookCtx.onerror(err);\n                    throw err;\n                });\n            }\n        });\n    }\n    props(Table.prototype, {\n        //\n        // Table Protected Methods\n        //\n        _trans: function getTransaction(mode, fn, writeLocked) {\n            var trans = this._tx || PSD.trans;\n            return trans && trans.db === db ?\n                trans === PSD.trans ?\n                    trans._promise(mode, fn, writeLocked) :\n                    newScope(function () { return trans._promise(mode, fn, writeLocked); }, { trans: trans, transless: PSD.transless || PSD }) :\n                tempTransaction(mode, [this.name], fn);\n        },\n        _idbstore: function getIDBObjectStore(mode, fn, writeLocked) {\n            var tableName = this.name;\n            function supplyIdbStore(resolve, reject, trans) {\n                if (trans.storeNames.indexOf(tableName) === -1)\n                    throw new exceptions.NotFound(\"Table\" + tableName + \" not part of transaction\");\n                return fn(resolve, reject, trans.idbtrans.objectStore(tableName), trans);\n            }\n            return this._trans(mode, supplyIdbStore, writeLocked);\n        },\n        //\n        // Table Public Methods\n        //\n        get: function (keyOrCrit, cb) {\n            if (keyOrCrit && keyOrCrit.constructor === Object)\n                return this.where(keyOrCrit).first(cb);\n            var self = this;\n            return this._idbstore(READONLY, function (resolve, reject, idbstore) {\n                var req = idbstore.get(keyOrCrit);\n                req.onerror = eventRejectHandler(reject);\n                req.onsuccess = wrap(function () {\n                    resolve(self.hook.reading.fire(req.result));\n                }, reject);\n            }).then(cb);\n        },\n        where: function (indexOrCrit) {\n            if (typeof indexOrCrit === 'string')\n                return new WhereClause(this, indexOrCrit);\n            if (isArray(indexOrCrit))\n                return new WhereClause(this, \"[\" + indexOrCrit.join('+') + \"]\");\n            // indexOrCrit is an object map of {[keyPath]:value} \n            var keyPaths = keys(indexOrCrit);\n            if (keyPaths.length === 1)\n                // Only one critera. This was the easy case:\n                return this\n                    .where(keyPaths[0])\n                    .equals(indexOrCrit[keyPaths[0]]);\n            // Multiple criterias.\n            // Let's try finding a compound index that matches all keyPaths in\n            // arbritary order:\n            var compoundIndex = this.schema.indexes.concat(this.schema.primKey).filter(function (ix) {\n                return ix.compound &&\n                    keyPaths.every(function (keyPath) { return ix.keyPath.indexOf(keyPath) >= 0; }) &&\n                    ix.keyPath.every(function (keyPath) { return keyPaths.indexOf(keyPath) >= 0; });\n            })[0];\n            if (compoundIndex && maxKey !== maxString)\n                // Cool! We found such compound index\n                // and this browser supports compound indexes (maxKey !== maxString)!\n                return this\n                    .where(compoundIndex.name)\n                    .equals(compoundIndex.keyPath.map(function (kp) { return indexOrCrit[kp]; }));\n            if (!compoundIndex)\n                console.warn(\"The query \" + JSON.stringify(indexOrCrit) + \" on \" + this.name + \" would benefit of a \" +\n                    (\"compound index [\" + keyPaths.join('+') + \"]\"));\n            // Ok, now let's fallback to finding at least one matching index\n            // and filter the rest.\n            var idxByName = this.schema.idxByName;\n            var simpleIndex = keyPaths.reduce(function (r, keyPath) { return [\n                r[0] || idxByName[keyPath],\n                r[0] || !idxByName[keyPath] ?\n                    combine(r[1], function (x) { return '' + getByKeyPath(x, keyPath) ==\n                        '' + indexOrCrit[keyPath]; })\n                    : r[1]\n            ]; }, [null, null]);\n            var idx = simpleIndex[0];\n            return idx ?\n                this.where(idx.name).equals(indexOrCrit[idx.keyPath])\n                    .filter(simpleIndex[1]) :\n                compoundIndex ?\n                    this.filter(simpleIndex[1]) : // Has compound but browser bad. Allow filter.\n                    this.where(keyPaths).equals(''); // No index at all. Fail lazily.\n        },\n        count: function (cb) {\n            return this.toCollection().count(cb);\n        },\n        offset: function (offset) {\n            return this.toCollection().offset(offset);\n        },\n        limit: function (numRows) {\n            return this.toCollection().limit(numRows);\n        },\n        reverse: function () {\n            return this.toCollection().reverse();\n        },\n        filter: function (filterFunction) {\n            return this.toCollection().and(filterFunction);\n        },\n        each: function (fn) {\n            return this.toCollection().each(fn);\n        },\n        toArray: function (cb) {\n            return this.toCollection().toArray(cb);\n        },\n        orderBy: function (index) {\n            return new Collection(new WhereClause(this, isArray(index) ?\n                \"[\" + index.join('+') + \"]\" :\n                index));\n        },\n        toCollection: function () {\n            return new Collection(new WhereClause(this));\n        },\n        mapToClass: function (constructor, structure) {\n            /// <summary>\n            ///     Map table to a javascript constructor function. Objects returned from the database will be instances of this class, making\n            ///     it possible to the instanceOf operator as well as extending the class using constructor.prototype.method = function(){...}.\n            /// </summary>\n            /// <param name=\"constructor\">Constructor function representing the class.</param>\n            /// <param name=\"structure\" optional=\"true\">Helps IDE code completion by knowing the members that objects contain and not just the indexes. Also\n            /// know what type each member has. Example: {name: String, emailAddresses: [String], password}</param>\n            this.schema.mappedClass = constructor;\n            var instanceTemplate = Object.create(constructor.prototype);\n            if (structure) {\n                // structure and instanceTemplate is for IDE code competion only while constructor.prototype is for actual inheritance.\n                applyStructure(instanceTemplate, structure);\n            }\n            this.schema.instanceTemplate = instanceTemplate;\n            // Now, subscribe to the when(\"reading\") event to make all objects that come out from this table inherit from given class\n            // no matter which method to use for reading (Table.get() or Table.where(...)... )\n            var readHook = function (obj) {\n                if (!obj)\n                    return obj; // No valid object. (Value is null). Return as is.\n                // Create a new object that derives from constructor:\n                var res = Object.create(constructor.prototype);\n                // Clone members:\n                for (var m in obj)\n                    if (hasOwn(obj, m))\n                        try {\n                            res[m] = obj[m];\n                        }\n                        catch (_) { }\n                return res;\n            };\n            if (this.schema.readHook) {\n                this.hook.reading.unsubscribe(this.schema.readHook);\n            }\n            this.schema.readHook = readHook;\n            this.hook(\"reading\", readHook);\n            return constructor;\n        },\n        defineClass: function (structure) {\n            /// <summary>\n            ///     Define all members of the class that represents the table. This will help code completion of when objects are read from the database\n            ///     as well as making it possible to extend the prototype of the returned constructor function.\n            /// </summary>\n            /// <param name=\"structure\">Helps IDE code completion by knowing the members that objects contain and not just the indexes. Also\n            /// know what type each member has. Example: {name: String, emailAddresses: [String], properties: {shoeSize: Number}}</param>\n            return this.mapToClass(Dexie.defineClass(structure), structure);\n        },\n        bulkDelete: function (keys$$1) {\n            if (this.hook.deleting.fire === nop) {\n                return this._idbstore(READWRITE, function (resolve, reject, idbstore, trans) {\n                    resolve(bulkDelete(idbstore, trans, keys$$1, false, nop));\n                });\n            }\n            else {\n                return this\n                    .where(':id')\n                    .anyOf(keys$$1)\n                    .delete()\n                    .then(function () { }); // Resolve with undefined.\n            }\n        },\n        bulkPut: function (objects, keys$$1) {\n            var _this = this;\n            return this._idbstore(READWRITE, function (resolve, reject, idbstore) {\n                if (!idbstore.keyPath && !_this.schema.primKey.auto && !keys$$1)\n                    throw new exceptions.InvalidArgument(\"bulkPut() with non-inbound keys requires keys array in second argument\");\n                if (idbstore.keyPath && keys$$1)\n                    throw new exceptions.InvalidArgument(\"bulkPut(): keys argument invalid on tables with inbound keys\");\n                if (keys$$1 && keys$$1.length !== objects.length)\n                    throw new exceptions.InvalidArgument(\"Arguments objects and keys must have the same length\");\n                if (objects.length === 0)\n                    return resolve(); // Caller provided empty list.\n                var done = function (result) {\n                    if (errorList.length === 0)\n                        resolve(result);\n                    else\n                        reject(new BulkError(_this.name + \".bulkPut(): \" + errorList.length + \" of \" + numObjs + \" operations failed\", errorList));\n                };\n                var req, errorList = [], errorHandler, numObjs = objects.length, table = _this;\n                if (_this.hook.creating.fire === nop && _this.hook.updating.fire === nop) {\n                    //\n                    // Standard Bulk (no 'creating' or 'updating' hooks to care about)\n                    //\n                    errorHandler = BulkErrorHandlerCatchAll(errorList);\n                    for (var i = 0, l = objects.length; i < l; ++i) {\n                        req = keys$$1 ? idbstore.put(objects[i], keys$$1[i]) : idbstore.put(objects[i]);\n                        req.onerror = errorHandler;\n                    }\n                    // Only need to catch success or error on the last operation\n                    // according to the IDB spec.\n                    req.onerror = BulkErrorHandlerCatchAll(errorList, done);\n                    req.onsuccess = eventSuccessHandler(done);\n                }\n                else {\n                    var effectiveKeys = keys$$1 || idbstore.keyPath && objects.map(function (o) { return getByKeyPath(o, idbstore.keyPath); });\n                    // Generate map of {[key]: object}\n                    var objectLookup = effectiveKeys && arrayToObject(effectiveKeys, function (key, i) { return key != null && [key, objects[i]]; });\n                    var promise = !effectiveKeys ?\n                        // Auto-incremented key-less objects only without any keys argument.\n                        table.bulkAdd(objects) :\n                        // Keys provided. Either as inbound in provided objects, or as a keys argument.\n                        // Begin with updating those that exists in DB:\n                        table.where(':id').anyOf(effectiveKeys.filter(function (key) { return key != null; })).modify(function () {\n                            this.value = objectLookup[this.primKey];\n                            objectLookup[this.primKey] = null; // Mark as \"don't add this\"\n                        }).catch(ModifyError, function (e) {\n                            errorList = e.failures; // No need to concat here. These are the first errors added.\n                        }).then(function () {\n                            // Now, let's examine which items didnt exist so we can add them:\n                            var objsToAdd = [], keysToAdd = keys$$1 && [];\n                            // Iterate backwards. Why? Because if same key was used twice, just add the last one.\n                            for (var i = effectiveKeys.length - 1; i >= 0; --i) {\n                                var key = effectiveKeys[i];\n                                if (key == null || objectLookup[key]) {\n                                    objsToAdd.push(objects[i]);\n                                    keys$$1 && keysToAdd.push(key);\n                                    if (key != null)\n                                        objectLookup[key] = null; // Mark as \"dont add again\"\n                                }\n                            }\n                            // The items are in reverse order so reverse them before adding.\n                            // Could be important in order to get auto-incremented keys the way the caller\n                            // would expect. Could have used unshift instead of push()/reverse(),\n                            // but: http://jsperf.com/unshift-vs-reverse\n                            objsToAdd.reverse();\n                            keys$$1 && keysToAdd.reverse();\n                            return table.bulkAdd(objsToAdd, keysToAdd);\n                        }).then(function (lastAddedKey) {\n                            // Resolve with key of the last object in given arguments to bulkPut():\n                            var lastEffectiveKey = effectiveKeys[effectiveKeys.length - 1]; // Key was provided.\n                            return lastEffectiveKey != null ? lastEffectiveKey : lastAddedKey;\n                        });\n                    promise.then(done).catch(BulkError, function (e) {\n                        // Concat failure from ModifyError and reject using our 'done' method.\n                        errorList = errorList.concat(e.failures);\n                        done();\n                    }).catch(reject);\n                }\n            }, \"locked\"); // If called from transaction scope, lock transaction til all steps are done.\n        },\n        bulkAdd: function (objects, keys$$1) {\n            var self = this, creatingHook = this.hook.creating.fire;\n            return this._idbstore(READWRITE, function (resolve, reject, idbstore, trans) {\n                if (!idbstore.keyPath && !self.schema.primKey.auto && !keys$$1)\n                    throw new exceptions.InvalidArgument(\"bulkAdd() with non-inbound keys requires keys array in second argument\");\n                if (idbstore.keyPath && keys$$1)\n                    throw new exceptions.InvalidArgument(\"bulkAdd(): keys argument invalid on tables with inbound keys\");\n                if (keys$$1 && keys$$1.length !== objects.length)\n                    throw new exceptions.InvalidArgument(\"Arguments objects and keys must have the same length\");\n                if (objects.length === 0)\n                    return resolve(); // Caller provided empty list.\n                function done(result) {\n                    if (errorList.length === 0)\n                        resolve(result);\n                    else\n                        reject(new BulkError(self.name + \".bulkAdd(): \" + errorList.length + \" of \" + numObjs + \" operations failed\", errorList));\n                }\n                var req, errorList = [], errorHandler, successHandler, numObjs = objects.length;\n                if (creatingHook !== nop) {\n                    //\n                    // There are subscribers to hook('creating')\n                    // Must behave as documented.\n                    //\n                    var keyPath = idbstore.keyPath, hookCtx;\n                    errorHandler = BulkErrorHandlerCatchAll(errorList, null, true);\n                    successHandler = hookedEventSuccessHandler(null);\n                    tryCatch(function () {\n                        for (var i = 0, l = objects.length; i < l; ++i) {\n                            hookCtx = { onerror: null, onsuccess: null };\n                            var key = keys$$1 && keys$$1[i];\n                            var obj = objects[i], effectiveKey = keys$$1 ? key : keyPath ? getByKeyPath(obj, keyPath) : undefined, keyToUse = creatingHook.call(hookCtx, effectiveKey, obj, trans);\n                            if (effectiveKey == null && keyToUse != null) {\n                                if (keyPath) {\n                                    obj = deepClone(obj);\n                                    setByKeyPath(obj, keyPath, keyToUse);\n                                }\n                                else {\n                                    key = keyToUse;\n                                }\n                            }\n                            req = key != null ? idbstore.add(obj, key) : idbstore.add(obj);\n                            req._hookCtx = hookCtx;\n                            if (i < l - 1) {\n                                req.onerror = errorHandler;\n                                if (hookCtx.onsuccess)\n                                    req.onsuccess = successHandler;\n                            }\n                        }\n                    }, function (err) {\n                        hookCtx.onerror && hookCtx.onerror(err);\n                        throw err;\n                    });\n                    req.onerror = BulkErrorHandlerCatchAll(errorList, done, true);\n                    req.onsuccess = hookedEventSuccessHandler(done);\n                }\n                else {\n                    //\n                    // Standard Bulk (no 'creating' hook to care about)\n                    //\n                    errorHandler = BulkErrorHandlerCatchAll(errorList);\n                    for (var i = 0, l = objects.length; i < l; ++i) {\n                        req = keys$$1 ? idbstore.add(objects[i], keys$$1[i]) : idbstore.add(objects[i]);\n                        req.onerror = errorHandler;\n                    }\n                    // Only need to catch success or error on the last operation\n                    // according to the IDB spec.\n                    req.onerror = BulkErrorHandlerCatchAll(errorList, done);\n                    req.onsuccess = eventSuccessHandler(done);\n                }\n            });\n        },\n        add: function (obj, key) {\n            /// <summary>\n            ///   Add an object to the database. In case an object with same primary key already exists, the object will not be added.\n            /// </summary>\n            /// <param name=\"obj\" type=\"Object\">A javascript object to insert</param>\n            /// <param name=\"key\" optional=\"true\">Primary key</param>\n            var creatingHook = this.hook.creating.fire;\n            return this._idbstore(READWRITE, function (resolve, reject, idbstore, trans) {\n                var hookCtx = { onsuccess: null, onerror: null };\n                if (creatingHook !== nop) {\n                    var effectiveKey = (key != null) ? key : (idbstore.keyPath ? getByKeyPath(obj, idbstore.keyPath) : undefined);\n                    var keyToUse = creatingHook.call(hookCtx, effectiveKey, obj, trans); // Allow subscribers to when(\"creating\") to generate the key.\n                    if (effectiveKey == null && keyToUse != null) {\n                        if (idbstore.keyPath)\n                            setByKeyPath(obj, idbstore.keyPath, keyToUse);\n                        else\n                            key = keyToUse;\n                    }\n                }\n                try {\n                    var req = key != null ? idbstore.add(obj, key) : idbstore.add(obj);\n                    req._hookCtx = hookCtx;\n                    req.onerror = hookedEventRejectHandler(reject);\n                    req.onsuccess = hookedEventSuccessHandler(function (result) {\n                        // TODO: Remove these two lines in next major release (2.0?)\n                        // It's no good practice to have side effects on provided parameters\n                        var keyPath = idbstore.keyPath;\n                        if (keyPath)\n                            setByKeyPath(obj, keyPath, result);\n                        resolve(result);\n                    });\n                }\n                catch (e) {\n                    if (hookCtx.onerror)\n                        hookCtx.onerror(e);\n                    throw e;\n                }\n            });\n        },\n        put: function (obj, key) {\n            var _this = this;\n            /// <summary>\n            ///   Add an object to the database but in case an object with same primary key alread exists, the existing one will get updated.\n            /// </summary>\n            /// <param name=\"obj\" type=\"Object\">A javascript object to insert or update</param>\n            /// <param name=\"key\" optional=\"true\">Primary key</param>\n            var creatingHook = this.hook.creating.fire, updatingHook = this.hook.updating.fire;\n            if (creatingHook !== nop || updatingHook !== nop) {\n                //\n                // People listens to when(\"creating\") or when(\"updating\") events!\n                // We must know whether the put operation results in an CREATE or UPDATE.\n                //\n                var keyPath = this.schema.primKey.keyPath;\n                var effectiveKey = (key !== undefined) ? key : (keyPath && getByKeyPath(obj, keyPath));\n                if (effectiveKey == null)\n                    return this.add(obj);\n                // Since key is optional, make sure we get it from obj if not provided\n                // Primary key exist. Lock transaction and try modifying existing. If nothing modified, call add().\n                // clone obj before this async call. If caller modifies obj the line after put(), the IDB spec requires that it should not affect operation.\n                obj = deepClone(obj);\n                return this._trans(READWRITE, function () {\n                    return _this.where(\":id\").equals(effectiveKey).modify(function () {\n                        // Replace extisting value with our object\n                        // CRUD event firing handled in Collection.modify()\n                        this.value = obj;\n                    }).then(function (count) { return count === 0 ? _this.add(obj, key) : effectiveKey; });\n                }, \"locked\"); // Lock needed because operation is splitted into modify() and add().\n            }\n            else {\n                // Use the standard IDB put() method.\n                return this._idbstore(READWRITE, function (resolve, reject, idbstore) {\n                    var req = key !== undefined ? idbstore.put(obj, key) : idbstore.put(obj);\n                    req.onerror = eventRejectHandler(reject);\n                    req.onsuccess = wrap(function (ev) {\n                        var keyPath = idbstore.keyPath;\n                        if (keyPath)\n                            setByKeyPath(obj, keyPath, ev.target.result);\n                        resolve(req.result);\n                    });\n                });\n            }\n        },\n        'delete': function (key) {\n            /// <param name=\"key\">Primary key of the object to delete</param>\n            if (this.hook.deleting.subscribers.length) {\n                // People listens to when(\"deleting\") event. Must implement delete using Collection.delete() that will\n                // call the CRUD event. Only Collection.delete() will know whether an object was actually deleted.\n                return this.where(\":id\").equals(key).delete();\n            }\n            else {\n                // No one listens. Use standard IDB delete() method.\n                return this._idbstore(READWRITE, function (resolve, reject, idbstore) {\n                    var req = idbstore.delete(key);\n                    req.onerror = eventRejectHandler(reject);\n                    req.onsuccess = wrap(function () {\n                        resolve(req.result);\n                    });\n                });\n            }\n        },\n        clear: function () {\n            if (this.hook.deleting.subscribers.length) {\n                // People listens to when(\"deleting\") event. Must implement delete using Collection.delete() that will\n                // call the CRUD event. Only Collection.delete() will knows which objects that are actually deleted.\n                return this.toCollection().delete();\n            }\n            else {\n                return this._idbstore(READWRITE, function (resolve, reject, idbstore) {\n                    var req = idbstore.clear();\n                    req.onerror = eventRejectHandler(reject);\n                    req.onsuccess = wrap(function () {\n                        resolve(req.result);\n                    });\n                });\n            }\n        },\n        update: function (keyOrObject, modifications) {\n            if (typeof modifications !== 'object' || isArray(modifications))\n                throw new exceptions.InvalidArgument(\"Modifications must be an object.\");\n            if (typeof keyOrObject === 'object' && !isArray(keyOrObject)) {\n                // object to modify. Also modify given object with the modifications:\n                keys(modifications).forEach(function (keyPath) {\n                    setByKeyPath(keyOrObject, keyPath, modifications[keyPath]);\n                });\n                var key = getByKeyPath(keyOrObject, this.schema.primKey.keyPath);\n                if (key === undefined)\n                    return rejection(new exceptions.InvalidArgument(\"Given object does not contain its primary key\"));\n                return this.where(\":id\").equals(key).modify(modifications);\n            }\n            else {\n                // key to modify\n                return this.where(\":id\").equals(keyOrObject).modify(modifications);\n            }\n        }\n    });\n    //\n    //\n    //\n    // Transaction Class\n    //\n    //\n    //\n    function Transaction(mode, storeNames, dbschema, parent) {\n        var _this = this;\n        /// <summary>\n        ///    Transaction class. Represents a database transaction. All operations on db goes through a Transaction.\n        /// </summary>\n        /// <param name=\"mode\" type=\"String\">Any of \"readwrite\" or \"readonly\"</param>\n        /// <param name=\"storeNames\" type=\"Array\">Array of table names to operate on</param>\n        this.db = db;\n        this.mode = mode;\n        this.storeNames = storeNames;\n        this.idbtrans = null;\n        this.on = Events(this, \"complete\", \"error\", \"abort\");\n        this.parent = parent || null;\n        this.active = true;\n        this._reculock = 0;\n        this._blockedFuncs = [];\n        this._resolve = null;\n        this._reject = null;\n        this._waitingFor = null;\n        this._waitingQueue = null;\n        this._spinCount = 0; // Just for debugging waitFor()\n        this._completion = new Promise(function (resolve, reject) {\n            _this._resolve = resolve;\n            _this._reject = reject;\n        });\n        this._completion.then(function () {\n            _this.active = false;\n            _this.on.complete.fire();\n        }, function (e) {\n            var wasActive = _this.active;\n            _this.active = false;\n            _this.on.error.fire(e);\n            _this.parent ?\n                _this.parent._reject(e) :\n                wasActive && _this.idbtrans && _this.idbtrans.abort();\n            return rejection(e); // Indicate we actually DO NOT catch this error.\n        });\n    }\n    props(Transaction.prototype, {\n        //\n        // Transaction Protected Methods (not required by API users, but needed internally and eventually by dexie extensions)\n        //\n        _lock: function () {\n            assert(!PSD.global); // Locking and unlocking reuires to be within a PSD scope.\n            // Temporary set all requests into a pending queue if they are called before database is ready.\n            ++this._reculock; // Recursive read/write lock pattern using PSD (Promise Specific Data) instead of TLS (Thread Local Storage)\n            if (this._reculock === 1 && !PSD.global)\n                PSD.lockOwnerFor = this;\n            return this;\n        },\n        _unlock: function () {\n            assert(!PSD.global); // Locking and unlocking reuires to be within a PSD scope.\n            if (--this._reculock === 0) {\n                if (!PSD.global)\n                    PSD.lockOwnerFor = null;\n                while (this._blockedFuncs.length > 0 && !this._locked()) {\n                    var fnAndPSD = this._blockedFuncs.shift();\n                    try {\n                        usePSD(fnAndPSD[1], fnAndPSD[0]);\n                    }\n                    catch (e) { }\n                }\n            }\n            return this;\n        },\n        _locked: function () {\n            // Checks if any write-lock is applied on this transaction.\n            // To simplify the Dexie API for extension implementations, we support recursive locks.\n            // This is accomplished by using \"Promise Specific Data\" (PSD).\n            // PSD data is bound to a Promise and any child Promise emitted through then() or resolve( new Promise() ).\n            // PSD is local to code executing on top of the call stacks of any of any code executed by Promise():\n            //         * callback given to the Promise() constructor  (function (resolve, reject){...})\n            //         * callbacks given to then()/catch()/finally() methods (function (value){...})\n            // If creating a new independant Promise instance from within a Promise call stack, the new Promise will derive the PSD from the call stack of the parent Promise.\n            // Derivation is done so that the inner PSD __proto__ points to the outer PSD.\n            // PSD.lockOwnerFor will point to current transaction object if the currently executing PSD scope owns the lock.\n            return this._reculock && PSD.lockOwnerFor !== this;\n        },\n        create: function (idbtrans) {\n            var _this = this;\n            if (!this.mode)\n                return this;\n            assert(!this.idbtrans);\n            if (!idbtrans && !idbdb) {\n                switch (dbOpenError && dbOpenError.name) {\n                    case \"DatabaseClosedError\":\n                        // Errors where it is no difference whether it was caused by the user operation or an earlier call to db.open()\n                        throw new exceptions.DatabaseClosed(dbOpenError);\n                    case \"MissingAPIError\":\n                        // Errors where it is no difference whether it was caused by the user operation or an earlier call to db.open()\n                        throw new exceptions.MissingAPI(dbOpenError.message, dbOpenError);\n                    default:\n                        // Make it clear that the user operation was not what caused the error - the error had occurred earlier on db.open()!\n                        throw new exceptions.OpenFailed(dbOpenError);\n                }\n            }\n            if (!this.active)\n                throw new exceptions.TransactionInactive();\n            assert(this._completion._state === null);\n            idbtrans = this.idbtrans = idbtrans || idbdb.transaction(safariMultiStoreFix(this.storeNames), this.mode);\n            idbtrans.onerror = wrap(function (ev) {\n                preventDefault(ev); // Prohibit default bubbling to window.error\n                _this._reject(idbtrans.error);\n            });\n            idbtrans.onabort = wrap(function (ev) {\n                preventDefault(ev);\n                _this.active && _this._reject(new exceptions.Abort(idbtrans.error));\n                _this.active = false;\n                _this.on(\"abort\").fire(ev);\n            });\n            idbtrans.oncomplete = wrap(function () {\n                _this.active = false;\n                _this._resolve();\n            });\n            return this;\n        },\n        _promise: function (mode, fn, bWriteLock) {\n            var _this = this;\n            if (mode === READWRITE && this.mode !== READWRITE)\n                return rejection(new exceptions.ReadOnly(\"Transaction is readonly\"));\n            if (!this.active)\n                return rejection(new exceptions.TransactionInactive());\n            if (this._locked()) {\n                return new Promise(function (resolve, reject) {\n                    _this._blockedFuncs.push([function () {\n                            _this._promise(mode, fn, bWriteLock).then(resolve, reject);\n                        }, PSD]);\n                });\n            }\n            else if (bWriteLock) {\n                return newScope(function () {\n                    var p = new Promise(function (resolve, reject) {\n                        _this._lock();\n                        var rv = fn(resolve, reject, _this);\n                        if (rv && rv.then)\n                            rv.then(resolve, reject);\n                    });\n                    p.finally(function () { return _this._unlock(); });\n                    p._lib = true;\n                    return p;\n                });\n            }\n            else {\n                var p = new Promise(function (resolve, reject) {\n                    var rv = fn(resolve, reject, _this);\n                    if (rv && rv.then)\n                        rv.then(resolve, reject);\n                });\n                p._lib = true;\n                return p;\n            }\n        },\n        _root: function () {\n            return this.parent ? this.parent._root() : this;\n        },\n        waitFor: function (promise) {\n            // Always operate on the root transaction (in case this is a sub stransaction)\n            var root = this._root();\n            // For stability reasons, convert parameter to promise no matter what type is passed to waitFor().\n            // (We must be able to call .then() on it.)\n            promise = Promise.resolve(promise);\n            if (root._waitingFor) {\n                // Already called waitFor(). Wait for both to complete.\n                root._waitingFor = root._waitingFor.then(function () { return promise; });\n            }\n            else {\n                // We're not in waiting state. Start waiting state.\n                root._waitingFor = promise;\n                root._waitingQueue = [];\n                // Start interacting with indexedDB until promise completes:\n                var store = root.idbtrans.objectStore(root.storeNames[0]);\n                (function spin() {\n                    ++root._spinCount; // For debugging only\n                    while (root._waitingQueue.length)\n                        (root._waitingQueue.shift())();\n                    if (root._waitingFor)\n                        store.get(-Infinity).onsuccess = spin;\n                }());\n            }\n            var currentWaitPromise = root._waitingFor;\n            return new Promise(function (resolve, reject) {\n                promise.then(function (res) { return root._waitingQueue.push(wrap(resolve.bind(null, res))); }, function (err) { return root._waitingQueue.push(wrap(reject.bind(null, err))); }).finally(function () {\n                    if (root._waitingFor === currentWaitPromise) {\n                        // No one added a wait after us. Safe to stop the spinning.\n                        root._waitingFor = null;\n                    }\n                });\n            });\n        },\n        //\n        // Transaction Public Properties and Methods\n        //\n        abort: function () {\n            this.active && this._reject(new exceptions.Abort());\n            this.active = false;\n        },\n        tables: {\n            get: deprecated(\"Transaction.tables\", function () { return allTables; })\n        },\n        table: function (name) {\n            var table = db.table(name); // Don't check that table is part of transaction. It must fail lazily!\n            return new Table(name, table.schema, this);\n        }\n    });\n    //\n    //\n    //\n    // WhereClause\n    //\n    //\n    //\n    function WhereClause(table, index, orCollection) {\n        /// <param name=\"table\" type=\"Table\"></param>\n        /// <param name=\"index\" type=\"String\" optional=\"true\"></param>\n        /// <param name=\"orCollection\" type=\"Collection\" optional=\"true\"></param>\n        this._ctx = {\n            table: table,\n            index: index === \":id\" ? null : index,\n            or: orCollection\n        };\n    }\n    props(WhereClause.prototype, function () {\n        // WhereClause private methods\n        function fail(collectionOrWhereClause, err, T) {\n            var collection = collectionOrWhereClause instanceof WhereClause ?\n                new Collection(collectionOrWhereClause) :\n                collectionOrWhereClause;\n            collection._ctx.error = T ? new T(err) : new TypeError(err);\n            return collection;\n        }\n        function emptyCollection(whereClause) {\n            return new Collection(whereClause, function () { return IDBKeyRange.only(\"\"); }).limit(0);\n        }\n        function upperFactory(dir) {\n            return dir === \"next\" ? function (s) { return s.toUpperCase(); } : function (s) { return s.toLowerCase(); };\n        }\n        function lowerFactory(dir) {\n            return dir === \"next\" ? function (s) { return s.toLowerCase(); } : function (s) { return s.toUpperCase(); };\n        }\n        function nextCasing(key, lowerKey, upperNeedle, lowerNeedle, cmp, dir) {\n            var length = Math.min(key.length, lowerNeedle.length);\n            var llp = -1;\n            for (var i = 0; i < length; ++i) {\n                var lwrKeyChar = lowerKey[i];\n                if (lwrKeyChar !== lowerNeedle[i]) {\n                    if (cmp(key[i], upperNeedle[i]) < 0)\n                        return key.substr(0, i) + upperNeedle[i] + upperNeedle.substr(i + 1);\n                    if (cmp(key[i], lowerNeedle[i]) < 0)\n                        return key.substr(0, i) + lowerNeedle[i] + upperNeedle.substr(i + 1);\n                    if (llp >= 0)\n                        return key.substr(0, llp) + lowerKey[llp] + upperNeedle.substr(llp + 1);\n                    return null;\n                }\n                if (cmp(key[i], lwrKeyChar) < 0)\n                    llp = i;\n            }\n            if (length < lowerNeedle.length && dir === \"next\")\n                return key + upperNeedle.substr(key.length);\n            if (length < key.length && dir === \"prev\")\n                return key.substr(0, upperNeedle.length);\n            return (llp < 0 ? null : key.substr(0, llp) + lowerNeedle[llp] + upperNeedle.substr(llp + 1));\n        }\n        function addIgnoreCaseAlgorithm(whereClause, match, needles, suffix) {\n            /// <param name=\"needles\" type=\"Array\" elementType=\"String\"></param>\n            var upper, lower, compare, upperNeedles, lowerNeedles, direction, nextKeySuffix, needlesLen = needles.length;\n            if (!needles.every(function (s) { return typeof s === 'string'; })) {\n                return fail(whereClause, STRING_EXPECTED);\n            }\n            function initDirection(dir) {\n                upper = upperFactory(dir);\n                lower = lowerFactory(dir);\n                compare = (dir === \"next\" ? simpleCompare : simpleCompareReverse);\n                var needleBounds = needles.map(function (needle) {\n                    return { lower: lower(needle), upper: upper(needle) };\n                }).sort(function (a, b) {\n                    return compare(a.lower, b.lower);\n                });\n                upperNeedles = needleBounds.map(function (nb) { return nb.upper; });\n                lowerNeedles = needleBounds.map(function (nb) { return nb.lower; });\n                direction = dir;\n                nextKeySuffix = (dir === \"next\" ? \"\" : suffix);\n            }\n            initDirection(\"next\");\n            var c = new Collection(whereClause, function () {\n                return IDBKeyRange.bound(upperNeedles[0], lowerNeedles[needlesLen - 1] + suffix);\n            });\n            c._ondirectionchange = function (direction) {\n                // This event onlys occur before filter is called the first time.\n                initDirection(direction);\n            };\n            var firstPossibleNeedle = 0;\n            c._addAlgorithm(function (cursor, advance, resolve) {\n                /// <param name=\"cursor\" type=\"IDBCursor\"></param>\n                /// <param name=\"advance\" type=\"Function\"></param>\n                /// <param name=\"resolve\" type=\"Function\"></param>\n                var key = cursor.key;\n                if (typeof key !== 'string')\n                    return false;\n                var lowerKey = lower(key);\n                if (match(lowerKey, lowerNeedles, firstPossibleNeedle)) {\n                    return true;\n                }\n                else {\n                    var lowestPossibleCasing = null;\n                    for (var i = firstPossibleNeedle; i < needlesLen; ++i) {\n                        var casing = nextCasing(key, lowerKey, upperNeedles[i], lowerNeedles[i], compare, direction);\n                        if (casing === null && lowestPossibleCasing === null)\n                            firstPossibleNeedle = i + 1;\n                        else if (lowestPossibleCasing === null || compare(lowestPossibleCasing, casing) > 0) {\n                            lowestPossibleCasing = casing;\n                        }\n                    }\n                    if (lowestPossibleCasing !== null) {\n                        advance(function () { cursor.continue(lowestPossibleCasing + nextKeySuffix); });\n                    }\n                    else {\n                        advance(resolve);\n                    }\n                    return false;\n                }\n            });\n            return c;\n        }\n        //\n        // WhereClause public methods\n        //\n        return {\n            between: function (lower, upper, includeLower, includeUpper) {\n                /// <summary>\n                ///     Filter out records whose where-field lays between given lower and upper values. Applies to Strings, Numbers and Dates.\n                /// </summary>\n                /// <param name=\"lower\"></param>\n                /// <param name=\"upper\"></param>\n                /// <param name=\"includeLower\" optional=\"true\">Whether items that equals lower should be included. Default true.</param>\n                /// <param name=\"includeUpper\" optional=\"true\">Whether items that equals upper should be included. Default false.</param>\n                /// <returns type=\"Collection\"></returns>\n                includeLower = includeLower !== false; // Default to true\n                includeUpper = includeUpper === true; // Default to false\n                try {\n                    if ((cmp(lower, upper) > 0) ||\n                        (cmp(lower, upper) === 0 && (includeLower || includeUpper) && !(includeLower && includeUpper)))\n                        return emptyCollection(this); // Workaround for idiotic W3C Specification that DataError must be thrown if lower > upper. The natural result would be to return an empty collection.\n                    return new Collection(this, function () { return IDBKeyRange.bound(lower, upper, !includeLower, !includeUpper); });\n                }\n                catch (e) {\n                    return fail(this, INVALID_KEY_ARGUMENT);\n                }\n            },\n            equals: function (value) {\n                return new Collection(this, function () { return IDBKeyRange.only(value); });\n            },\n            above: function (value) {\n                return new Collection(this, function () { return IDBKeyRange.lowerBound(value, true); });\n            },\n            aboveOrEqual: function (value) {\n                return new Collection(this, function () { return IDBKeyRange.lowerBound(value); });\n            },\n            below: function (value) {\n                return new Collection(this, function () { return IDBKeyRange.upperBound(value, true); });\n            },\n            belowOrEqual: function (value) {\n                return new Collection(this, function () { return IDBKeyRange.upperBound(value); });\n            },\n            startsWith: function (str) {\n                /// <param name=\"str\" type=\"String\"></param>\n                if (typeof str !== 'string')\n                    return fail(this, STRING_EXPECTED);\n                return this.between(str, str + maxString, true, true);\n            },\n            startsWithIgnoreCase: function (str) {\n                /// <param name=\"str\" type=\"String\"></param>\n                if (str === \"\")\n                    return this.startsWith(str);\n                return addIgnoreCaseAlgorithm(this, function (x, a) { return x.indexOf(a[0]) === 0; }, [str], maxString);\n            },\n            equalsIgnoreCase: function (str) {\n                /// <param name=\"str\" type=\"String\"></param>\n                return addIgnoreCaseAlgorithm(this, function (x, a) { return x === a[0]; }, [str], \"\");\n            },\n            anyOfIgnoreCase: function () {\n                var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n                if (set.length === 0)\n                    return emptyCollection(this);\n                return addIgnoreCaseAlgorithm(this, function (x, a) { return a.indexOf(x) !== -1; }, set, \"\");\n            },\n            startsWithAnyOfIgnoreCase: function () {\n                var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n                if (set.length === 0)\n                    return emptyCollection(this);\n                return addIgnoreCaseAlgorithm(this, function (x, a) {\n                    return a.some(function (n) {\n                        return x.indexOf(n) === 0;\n                    });\n                }, set, maxString);\n            },\n            anyOf: function () {\n                var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n                var compare = ascending;\n                try {\n                    set.sort(compare);\n                }\n                catch (e) {\n                    return fail(this, INVALID_KEY_ARGUMENT);\n                }\n                if (set.length === 0)\n                    return emptyCollection(this);\n                var c = new Collection(this, function () { return IDBKeyRange.bound(set[0], set[set.length - 1]); });\n                c._ondirectionchange = function (direction) {\n                    compare = (direction === \"next\" ? ascending : descending);\n                    set.sort(compare);\n                };\n                var i = 0;\n                c._addAlgorithm(function (cursor, advance, resolve) {\n                    var key = cursor.key;\n                    while (compare(key, set[i]) > 0) {\n                        // The cursor has passed beyond this key. Check next.\n                        ++i;\n                        if (i === set.length) {\n                            // There is no next. Stop searching.\n                            advance(resolve);\n                            return false;\n                        }\n                    }\n                    if (compare(key, set[i]) === 0) {\n                        // The current cursor value should be included and we should continue a single step in case next item has the same key or possibly our next key in set.\n                        return true;\n                    }\n                    else {\n                        // cursor.key not yet at set[i]. Forward cursor to the next key to hunt for.\n                        advance(function () { cursor.continue(set[i]); });\n                        return false;\n                    }\n                });\n                return c;\n            },\n            notEqual: function (value) {\n                return this.inAnyRange([[minKey, value], [value, maxKey]], { includeLowers: false, includeUppers: false });\n            },\n            noneOf: function () {\n                var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n                if (set.length === 0)\n                    return new Collection(this); // Return entire collection.\n                try {\n                    set.sort(ascending);\n                }\n                catch (e) {\n                    return fail(this, INVALID_KEY_ARGUMENT);\n                }\n                // Transform [\"a\",\"b\",\"c\"] to a set of ranges for between/above/below: [[minKey,\"a\"], [\"a\",\"b\"], [\"b\",\"c\"], [\"c\",maxKey]]\n                var ranges = set.reduce(function (res, val) { return res ? res.concat([[res[res.length - 1][1], val]]) : [[minKey, val]]; }, null);\n                ranges.push([set[set.length - 1], maxKey]);\n                return this.inAnyRange(ranges, { includeLowers: false, includeUppers: false });\n            },\n            /** Filter out values withing given set of ranges.\n            * Example, give children and elders a rebate of 50%:\n            *\n            *   db.friends.where('age').inAnyRange([[0,18],[65,Infinity]]).modify({Rebate: 1/2});\n            *\n            * @param {(string|number|Date|Array)[][]} ranges\n            * @param {{includeLowers: boolean, includeUppers: boolean}} options\n            */\n            inAnyRange: function (ranges, options) {\n                if (ranges.length === 0)\n                    return emptyCollection(this);\n                if (!ranges.every(function (range) { return range[0] !== undefined && range[1] !== undefined && ascending(range[0], range[1]) <= 0; })) {\n                    return fail(this, \"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower\", exceptions.InvalidArgument);\n                }\n                var includeLowers = !options || options.includeLowers !== false; // Default to true\n                var includeUppers = options && options.includeUppers === true; // Default to false\n                function addRange(ranges, newRange) {\n                    for (var i = 0, l = ranges.length; i < l; ++i) {\n                        var range = ranges[i];\n                        if (cmp(newRange[0], range[1]) < 0 && cmp(newRange[1], range[0]) > 0) {\n                            range[0] = min(range[0], newRange[0]);\n                            range[1] = max(range[1], newRange[1]);\n                            break;\n                        }\n                    }\n                    if (i === l)\n                        ranges.push(newRange);\n                    return ranges;\n                }\n                var sortDirection = ascending;\n                function rangeSorter(a, b) { return sortDirection(a[0], b[0]); }\n                // Join overlapping ranges\n                var set;\n                try {\n                    set = ranges.reduce(addRange, []);\n                    set.sort(rangeSorter);\n                }\n                catch (ex) {\n                    return fail(this, INVALID_KEY_ARGUMENT);\n                }\n                var i = 0;\n                var keyIsBeyondCurrentEntry = includeUppers ?\n                    function (key) { return ascending(key, set[i][1]) > 0; } :\n                    function (key) { return ascending(key, set[i][1]) >= 0; };\n                var keyIsBeforeCurrentEntry = includeLowers ?\n                    function (key) { return descending(key, set[i][0]) > 0; } :\n                    function (key) { return descending(key, set[i][0]) >= 0; };\n                function keyWithinCurrentRange(key) {\n                    return !keyIsBeyondCurrentEntry(key) && !keyIsBeforeCurrentEntry(key);\n                }\n                var checkKey = keyIsBeyondCurrentEntry;\n                var c = new Collection(this, function () {\n                    return IDBKeyRange.bound(set[0][0], set[set.length - 1][1], !includeLowers, !includeUppers);\n                });\n                c._ondirectionchange = function (direction) {\n                    if (direction === \"next\") {\n                        checkKey = keyIsBeyondCurrentEntry;\n                        sortDirection = ascending;\n                    }\n                    else {\n                        checkKey = keyIsBeforeCurrentEntry;\n                        sortDirection = descending;\n                    }\n                    set.sort(rangeSorter);\n                };\n                c._addAlgorithm(function (cursor, advance, resolve) {\n                    var key = cursor.key;\n                    while (checkKey(key)) {\n                        // The cursor has passed beyond this key. Check next.\n                        ++i;\n                        if (i === set.length) {\n                            // There is no next. Stop searching.\n                            advance(resolve);\n                            return false;\n                        }\n                    }\n                    if (keyWithinCurrentRange(key)) {\n                        // The current cursor value should be included and we should continue a single step in case next item has the same key or possibly our next key in set.\n                        return true;\n                    }\n                    else if (cmp(key, set[i][1]) === 0 || cmp(key, set[i][0]) === 0) {\n                        // includeUpper or includeLower is false so keyWithinCurrentRange() returns false even though we are at range border.\n                        // Continue to next key but don't include this one.\n                        return false;\n                    }\n                    else {\n                        // cursor.key not yet at set[i]. Forward cursor to the next key to hunt for.\n                        advance(function () {\n                            if (sortDirection === ascending)\n                                cursor.continue(set[i][0]);\n                            else\n                                cursor.continue(set[i][1]);\n                        });\n                        return false;\n                    }\n                });\n                return c;\n            },\n            startsWithAnyOf: function () {\n                var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n                if (!set.every(function (s) { return typeof s === 'string'; })) {\n                    return fail(this, \"startsWithAnyOf() only works with strings\");\n                }\n                if (set.length === 0)\n                    return emptyCollection(this);\n                return this.inAnyRange(set.map(function (str) {\n                    return [str, str + maxString];\n                }));\n            }\n        };\n    });\n    //\n    //\n    //\n    // Collection Class\n    //\n    //\n    //\n    function Collection(whereClause, keyRangeGenerator) {\n        /// <summary>\n        ///\n        /// </summary>\n        /// <param name=\"whereClause\" type=\"WhereClause\">Where clause instance</param>\n        /// <param name=\"keyRangeGenerator\" value=\"function(){ return IDBKeyRange.bound(0,1);}\" optional=\"true\"></param>\n        var keyRange = null, error = null;\n        if (keyRangeGenerator)\n            try {\n                keyRange = keyRangeGenerator();\n            }\n            catch (ex) {\n                error = ex;\n            }\n        var whereCtx = whereClause._ctx, table = whereCtx.table;\n        this._ctx = {\n            table: table,\n            index: whereCtx.index,\n            isPrimKey: (!whereCtx.index || (table.schema.primKey.keyPath && whereCtx.index === table.schema.primKey.name)),\n            range: keyRange,\n            keysOnly: false,\n            dir: \"next\",\n            unique: \"\",\n            algorithm: null,\n            filter: null,\n            replayFilter: null,\n            justLimit: true,\n            isMatch: null,\n            offset: 0,\n            limit: Infinity,\n            error: error,\n            or: whereCtx.or,\n            valueMapper: table.hook.reading.fire\n        };\n    }\n    function isPlainKeyRange(ctx, ignoreLimitFilter) {\n        return !(ctx.filter || ctx.algorithm || ctx.or) &&\n            (ignoreLimitFilter ? ctx.justLimit : !ctx.replayFilter);\n    }\n    props(Collection.prototype, function () {\n        //\n        // Collection Private Functions\n        //\n        function addFilter(ctx, fn) {\n            ctx.filter = combine(ctx.filter, fn);\n        }\n        function addReplayFilter(ctx, factory, isLimitFilter) {\n            var curr = ctx.replayFilter;\n            ctx.replayFilter = curr ? function () { return combine(curr(), factory()); } : factory;\n            ctx.justLimit = isLimitFilter && !curr;\n        }\n        function addMatchFilter(ctx, fn) {\n            ctx.isMatch = combine(ctx.isMatch, fn);\n        }\n        /** @param ctx {\n         *      isPrimKey: boolean,\n         *      table: Table,\n         *      index: string\n         * }\n         * @param store IDBObjectStore\n         **/\n        function getIndexOrStore(ctx, store) {\n            if (ctx.isPrimKey)\n                return store;\n            var indexSpec = ctx.table.schema.idxByName[ctx.index];\n            if (!indexSpec)\n                throw new exceptions.Schema(\"KeyPath \" + ctx.index + \" on object store \" + store.name + \" is not indexed\");\n            return store.index(indexSpec.name);\n        }\n        /** @param ctx {\n         *      isPrimKey: boolean,\n         *      table: Table,\n         *      index: string,\n         *      keysOnly: boolean,\n         *      range?: IDBKeyRange,\n         *      dir: \"next\" | \"prev\"\n         * }\n         */\n        function openCursor(ctx, store) {\n            var idxOrStore = getIndexOrStore(ctx, store);\n            return ctx.keysOnly && 'openKeyCursor' in idxOrStore ?\n                idxOrStore.openKeyCursor(ctx.range || null, ctx.dir + ctx.unique) :\n                idxOrStore.openCursor(ctx.range || null, ctx.dir + ctx.unique);\n        }\n        function iter(ctx, fn, resolve, reject, idbstore) {\n            var filter = ctx.replayFilter ? combine(ctx.filter, ctx.replayFilter()) : ctx.filter;\n            if (!ctx.or) {\n                iterate(openCursor(ctx, idbstore), combine(ctx.algorithm, filter), fn, resolve, reject, !ctx.keysOnly && ctx.valueMapper);\n            }\n            else\n                (function () {\n                    var set = {};\n                    var resolved = 0;\n                    function resolveboth() {\n                        if (++resolved === 2)\n                            resolve(); // Seems like we just support or btwn max 2 expressions, but there are no limit because we do recursion.\n                    }\n                    function union(item, cursor, advance) {\n                        if (!filter || filter(cursor, advance, resolveboth, reject)) {\n                            var primaryKey = cursor.primaryKey;\n                            var key = '' + primaryKey;\n                            if (key === '[object ArrayBuffer]')\n                                key = '' + new Uint8Array(primaryKey);\n                            if (!hasOwn(set, key)) {\n                                set[key] = true;\n                                fn(item, cursor, advance);\n                            }\n                        }\n                    }\n                    ctx.or._iterate(union, resolveboth, reject, idbstore);\n                    iterate(openCursor(ctx, idbstore), ctx.algorithm, union, resolveboth, reject, !ctx.keysOnly && ctx.valueMapper);\n                })();\n        }\n        return {\n            //\n            // Collection Protected Functions\n            //\n            _read: function (fn, cb) {\n                var ctx = this._ctx;\n                return ctx.error ?\n                    ctx.table._trans(null, rejection.bind(null, ctx.error)) :\n                    ctx.table._idbstore(READONLY, fn).then(cb);\n            },\n            _write: function (fn) {\n                var ctx = this._ctx;\n                return ctx.error ?\n                    ctx.table._trans(null, rejection.bind(null, ctx.error)) :\n                    ctx.table._idbstore(READWRITE, fn, \"locked\"); // When doing write operations on collections, always lock the operation so that upcoming operations gets queued.\n            },\n            _addAlgorithm: function (fn) {\n                var ctx = this._ctx;\n                ctx.algorithm = combine(ctx.algorithm, fn);\n            },\n            _iterate: function (fn, resolve, reject, idbstore) {\n                return iter(this._ctx, fn, resolve, reject, idbstore);\n            },\n            clone: function (props$$1) {\n                var rv = Object.create(this.constructor.prototype), ctx = Object.create(this._ctx);\n                if (props$$1)\n                    extend(ctx, props$$1);\n                rv._ctx = ctx;\n                return rv;\n            },\n            raw: function () {\n                this._ctx.valueMapper = null;\n                return this;\n            },\n            //\n            // Collection Public methods\n            //\n            each: function (fn) {\n                var ctx = this._ctx;\n                return this._read(function (resolve, reject, idbstore) {\n                    iter(ctx, fn, resolve, reject, idbstore);\n                });\n            },\n            count: function (cb) {\n                var ctx = this._ctx;\n                if (isPlainKeyRange(ctx, true)) {\n                    // This is a plain key range. We can use the count() method if the index.\n                    return this._read(function (resolve, reject, idbstore) {\n                        var idx = getIndexOrStore(ctx, idbstore);\n                        var req = (ctx.range ? idx.count(ctx.range) : idx.count());\n                        req.onerror = eventRejectHandler(reject);\n                        req.onsuccess = function (e) {\n                            resolve(Math.min(e.target.result, ctx.limit));\n                        };\n                    }, cb);\n                }\n                else {\n                    // Algorithms, filters or expressions are applied. Need to count manually.\n                    var count = 0;\n                    return this._read(function (resolve, reject, idbstore) {\n                        iter(ctx, function () { ++count; return false; }, function () { resolve(count); }, reject, idbstore);\n                    }, cb);\n                }\n            },\n            sortBy: function (keyPath, cb) {\n                /// <param name=\"keyPath\" type=\"String\"></param>\n                var parts = keyPath.split('.').reverse(), lastPart = parts[0], lastIndex = parts.length - 1;\n                function getval(obj, i) {\n                    if (i)\n                        return getval(obj[parts[i]], i - 1);\n                    return obj[lastPart];\n                }\n                var order = this._ctx.dir === \"next\" ? 1 : -1;\n                function sorter(a, b) {\n                    var aVal = getval(a, lastIndex), bVal = getval(b, lastIndex);\n                    return aVal < bVal ? -order : aVal > bVal ? order : 0;\n                }\n                return this.toArray(function (a) {\n                    return a.sort(sorter);\n                }).then(cb);\n            },\n            toArray: function (cb) {\n                var ctx = this._ctx;\n                return this._read(function (resolve, reject, idbstore) {\n                    if (hasGetAll && ctx.dir === 'next' && isPlainKeyRange(ctx, true) && ctx.limit > 0) {\n                        // Special optimation if we could use IDBObjectStore.getAll() or\n                        // IDBKeyRange.getAll():\n                        var readingHook = ctx.table.hook.reading.fire;\n                        var idxOrStore = getIndexOrStore(ctx, idbstore);\n                        var req = ctx.limit < Infinity ?\n                            idxOrStore.getAll(ctx.range, ctx.limit) :\n                            idxOrStore.getAll(ctx.range);\n                        req.onerror = eventRejectHandler(reject);\n                        req.onsuccess = readingHook === mirror ?\n                            eventSuccessHandler(resolve) :\n                            eventSuccessHandler(function (res) {\n                                try {\n                                    resolve(res.map(readingHook));\n                                }\n                                catch (e) {\n                                    reject(e);\n                                }\n                            });\n                    }\n                    else {\n                        // Getting array through a cursor.\n                        var a = [];\n                        iter(ctx, function (item) { a.push(item); }, function arrayComplete() {\n                            resolve(a);\n                        }, reject, idbstore);\n                    }\n                }, cb);\n            },\n            offset: function (offset) {\n                var ctx = this._ctx;\n                if (offset <= 0)\n                    return this;\n                ctx.offset += offset; // For count()\n                if (isPlainKeyRange(ctx)) {\n                    addReplayFilter(ctx, function () {\n                        var offsetLeft = offset;\n                        return function (cursor, advance) {\n                            if (offsetLeft === 0)\n                                return true;\n                            if (offsetLeft === 1) {\n                                --offsetLeft;\n                                return false;\n                            }\n                            advance(function () {\n                                cursor.advance(offsetLeft);\n                                offsetLeft = 0;\n                            });\n                            return false;\n                        };\n                    });\n                }\n                else {\n                    addReplayFilter(ctx, function () {\n                        var offsetLeft = offset;\n                        return function () { return (--offsetLeft < 0); };\n                    });\n                }\n                return this;\n            },\n            limit: function (numRows) {\n                this._ctx.limit = Math.min(this._ctx.limit, numRows); // For count()\n                addReplayFilter(this._ctx, function () {\n                    var rowsLeft = numRows;\n                    return function (cursor, advance, resolve) {\n                        if (--rowsLeft <= 0)\n                            advance(resolve); // Stop after this item has been included\n                        return rowsLeft >= 0; // If numRows is already below 0, return false because then 0 was passed to numRows initially. Otherwise we wouldnt come here.\n                    };\n                }, true);\n                return this;\n            },\n            until: function (filterFunction, bIncludeStopEntry) {\n                addFilter(this._ctx, function (cursor, advance, resolve) {\n                    if (filterFunction(cursor.value)) {\n                        advance(resolve);\n                        return bIncludeStopEntry;\n                    }\n                    else {\n                        return true;\n                    }\n                });\n                return this;\n            },\n            first: function (cb) {\n                return this.limit(1).toArray(function (a) { return a[0]; }).then(cb);\n            },\n            last: function (cb) {\n                return this.reverse().first(cb);\n            },\n            filter: function (filterFunction) {\n                /// <param name=\"jsFunctionFilter\" type=\"Function\">function(val){return true/false}</param>\n                addFilter(this._ctx, function (cursor) {\n                    return filterFunction(cursor.value);\n                });\n                // match filters not used in Dexie.js but can be used by 3rd part libraries to test a\n                // collection for a match without querying DB. Used by Dexie.Observable.\n                addMatchFilter(this._ctx, filterFunction);\n                return this;\n            },\n            and: function (filterFunction) {\n                return this.filter(filterFunction);\n            },\n            or: function (indexName) {\n                return new WhereClause(this._ctx.table, indexName, this);\n            },\n            reverse: function () {\n                this._ctx.dir = (this._ctx.dir === \"prev\" ? \"next\" : \"prev\");\n                if (this._ondirectionchange)\n                    this._ondirectionchange(this._ctx.dir);\n                return this;\n            },\n            desc: function () {\n                return this.reverse();\n            },\n            eachKey: function (cb) {\n                var ctx = this._ctx;\n                ctx.keysOnly = !ctx.isMatch;\n                return this.each(function (val, cursor) { cb(cursor.key, cursor); });\n            },\n            eachUniqueKey: function (cb) {\n                this._ctx.unique = \"unique\";\n                return this.eachKey(cb);\n            },\n            eachPrimaryKey: function (cb) {\n                var ctx = this._ctx;\n                ctx.keysOnly = !ctx.isMatch;\n                return this.each(function (val, cursor) { cb(cursor.primaryKey, cursor); });\n            },\n            keys: function (cb) {\n                var ctx = this._ctx;\n                ctx.keysOnly = !ctx.isMatch;\n                var a = [];\n                return this.each(function (item, cursor) {\n                    a.push(cursor.key);\n                }).then(function () {\n                    return a;\n                }).then(cb);\n            },\n            primaryKeys: function (cb) {\n                var ctx = this._ctx;\n                if (hasGetAll && ctx.dir === 'next' && isPlainKeyRange(ctx, true) && ctx.limit > 0) {\n                    // Special optimation if we could use IDBObjectStore.getAllKeys() or\n                    // IDBKeyRange.getAllKeys():\n                    return this._read(function (resolve, reject, idbstore) {\n                        var idxOrStore = getIndexOrStore(ctx, idbstore);\n                        var req = ctx.limit < Infinity ?\n                            idxOrStore.getAllKeys(ctx.range, ctx.limit) :\n                            idxOrStore.getAllKeys(ctx.range);\n                        req.onerror = eventRejectHandler(reject);\n                        req.onsuccess = eventSuccessHandler(resolve);\n                    }).then(cb);\n                }\n                ctx.keysOnly = !ctx.isMatch;\n                var a = [];\n                return this.each(function (item, cursor) {\n                    a.push(cursor.primaryKey);\n                }).then(function () {\n                    return a;\n                }).then(cb);\n            },\n            uniqueKeys: function (cb) {\n                this._ctx.unique = \"unique\";\n                return this.keys(cb);\n            },\n            firstKey: function (cb) {\n                return this.limit(1).keys(function (a) { return a[0]; }).then(cb);\n            },\n            lastKey: function (cb) {\n                return this.reverse().firstKey(cb);\n            },\n            distinct: function () {\n                var ctx = this._ctx, idx = ctx.index && ctx.table.schema.idxByName[ctx.index];\n                if (!idx || !idx.multi)\n                    return this; // distinct() only makes differencies on multiEntry indexes.\n                var set = {};\n                addFilter(this._ctx, function (cursor) {\n                    var strKey = cursor.primaryKey.toString(); // Converts any Date to String, String to String, Number to String and Array to comma-separated string\n                    var found = hasOwn(set, strKey);\n                    set[strKey] = true;\n                    return !found;\n                });\n                return this;\n            },\n            //\n            // Methods that mutate storage\n            //\n            modify: function (changes) {\n                var self = this, ctx = this._ctx, hook = ctx.table.hook, updatingHook = hook.updating.fire, deletingHook = hook.deleting.fire;\n                return this._write(function (resolve, reject, idbstore, trans) {\n                    var modifyer;\n                    if (typeof changes === 'function') {\n                        // Changes is a function that may update, add or delete propterties or even require a deletion the object itself (delete this.item)\n                        if (updatingHook === nop && deletingHook === nop) {\n                            // Noone cares about what is being changed. Just let the modifier function be the given argument as is.\n                            modifyer = changes;\n                        }\n                        else {\n                            // People want to know exactly what is being modified or deleted.\n                            // Let modifyer be a proxy function that finds out what changes the caller is actually doing\n                            // and call the hooks accordingly!\n                            modifyer = function (item) {\n                                var origItem = deepClone(item); // Clone the item first so we can compare laters.\n                                if (changes.call(this, item, this) === false)\n                                    return false; // Call the real modifyer function (If it returns false explicitely, it means it dont want to modify anyting on this object)\n                                if (!hasOwn(this, \"value\")) {\n                                    // The real modifyer function requests a deletion of the object. Inform the deletingHook that a deletion is taking place.\n                                    deletingHook.call(this, this.primKey, item, trans);\n                                }\n                                else {\n                                    // No deletion. Check what was changed\n                                    var objectDiff = getObjectDiff(origItem, this.value);\n                                    var additionalChanges = updatingHook.call(this, objectDiff, this.primKey, origItem, trans);\n                                    if (additionalChanges) {\n                                        // Hook want to apply additional modifications. Make sure to fullfill the will of the hook.\n                                        item = this.value;\n                                        keys(additionalChanges).forEach(function (keyPath) {\n                                            setByKeyPath(item, keyPath, additionalChanges[keyPath]); // Adding {keyPath: undefined} means that the keyPath should be deleted. Handled by setByKeyPath\n                                        });\n                                    }\n                                }\n                            };\n                        }\n                    }\n                    else if (updatingHook === nop) {\n                        // changes is a set of {keyPath: value} and no one is listening to the updating hook.\n                        var keyPaths = keys(changes);\n                        var numKeys = keyPaths.length;\n                        modifyer = function (item) {\n                            var anythingModified = false;\n                            for (var i = 0; i < numKeys; ++i) {\n                                var keyPath = keyPaths[i], val = changes[keyPath];\n                                if (getByKeyPath(item, keyPath) !== val) {\n                                    setByKeyPath(item, keyPath, val); // Adding {keyPath: undefined} means that the keyPath should be deleted. Handled by setByKeyPath\n                                    anythingModified = true;\n                                }\n                            }\n                            return anythingModified;\n                        };\n                    }\n                    else {\n                        // changes is a set of {keyPath: value} and people are listening to the updating hook so we need to call it and\n                        // allow it to add additional modifications to make.\n                        var origChanges = changes;\n                        changes = shallowClone(origChanges); // Let's work with a clone of the changes keyPath/value set so that we can restore it in case a hook extends it.\n                        modifyer = function (item) {\n                            var anythingModified = false;\n                            var additionalChanges = updatingHook.call(this, changes, this.primKey, deepClone(item), trans);\n                            if (additionalChanges)\n                                extend(changes, additionalChanges);\n                            keys(changes).forEach(function (keyPath) {\n                                var val = changes[keyPath];\n                                if (getByKeyPath(item, keyPath) !== val) {\n                                    setByKeyPath(item, keyPath, val);\n                                    anythingModified = true;\n                                }\n                            });\n                            if (additionalChanges)\n                                changes = shallowClone(origChanges); // Restore original changes for next iteration\n                            return anythingModified;\n                        };\n                    }\n                    var count = 0;\n                    var successCount = 0;\n                    var iterationComplete = false;\n                    var failures = [];\n                    var failKeys = [];\n                    var currentKey = null;\n                    function modifyItem(item, cursor) {\n                        currentKey = cursor.primaryKey;\n                        var thisContext = {\n                            primKey: cursor.primaryKey,\n                            value: item,\n                            onsuccess: null,\n                            onerror: null\n                        };\n                        function onerror(e) {\n                            failures.push(e);\n                            failKeys.push(thisContext.primKey);\n                            checkFinished();\n                            return true; // Catch these errors and let a final rejection decide whether or not to abort entire transaction\n                        }\n                        if (modifyer.call(thisContext, item, thisContext) !== false) {\n                            var bDelete = !hasOwn(thisContext, \"value\");\n                            ++count;\n                            tryCatch(function () {\n                                var req = (bDelete ? cursor.delete() : cursor.update(thisContext.value));\n                                req._hookCtx = thisContext;\n                                req.onerror = hookedEventRejectHandler(onerror);\n                                req.onsuccess = hookedEventSuccessHandler(function () {\n                                    ++successCount;\n                                    checkFinished();\n                                });\n                            }, onerror);\n                        }\n                        else if (thisContext.onsuccess) {\n                            // Hook will expect either onerror or onsuccess to always be called!\n                            thisContext.onsuccess(thisContext.value);\n                        }\n                    }\n                    function doReject(e) {\n                        if (e) {\n                            failures.push(e);\n                            failKeys.push(currentKey);\n                        }\n                        return reject(new ModifyError(\"Error modifying one or more objects\", failures, successCount, failKeys));\n                    }\n                    function checkFinished() {\n                        if (iterationComplete && successCount + failures.length === count) {\n                            if (failures.length > 0)\n                                doReject();\n                            else\n                                resolve(successCount);\n                        }\n                    }\n                    self.clone().raw()._iterate(modifyItem, function () {\n                        iterationComplete = true;\n                        checkFinished();\n                    }, doReject, idbstore);\n                });\n            },\n            'delete': function () {\n                var _this = this;\n                var ctx = this._ctx, range = ctx.range, deletingHook = ctx.table.hook.deleting.fire, hasDeleteHook = deletingHook !== nop;\n                if (!hasDeleteHook &&\n                    isPlainKeyRange(ctx) &&\n                    ((ctx.isPrimKey && !hangsOnDeleteLargeKeyRange) || !range)) {\n                    // May use IDBObjectStore.delete(IDBKeyRange) in this case (Issue #208)\n                    // For chromium, this is the way most optimized version.\n                    // For IE/Edge, this could hang the indexedDB engine and make operating system instable\n                    // (https://gist.github.com/dfahlander/5a39328f029de18222cf2125d56c38f7)\n                    return this._write(function (resolve, reject, idbstore) {\n                        // Our API contract is to return a count of deleted items, so we have to count() before delete().\n                        var onerror = eventRejectHandler(reject), countReq = (range ? idbstore.count(range) : idbstore.count());\n                        countReq.onerror = onerror;\n                        countReq.onsuccess = function () {\n                            var count = countReq.result;\n                            tryCatch(function () {\n                                var delReq = (range ? idbstore.delete(range) : idbstore.clear());\n                                delReq.onerror = onerror;\n                                delReq.onsuccess = function () { return resolve(count); };\n                            }, function (err) { return reject(err); });\n                        };\n                    });\n                }\n                // Default version to use when collection is not a vanilla IDBKeyRange on the primary key.\n                // Divide into chunks to not starve RAM.\n                // If has delete hook, we will have to collect not just keys but also objects, so it will use\n                // more memory and need lower chunk size.\n                var CHUNKSIZE = hasDeleteHook ? 2000 : 10000;\n                return this._write(function (resolve, reject, idbstore, trans) {\n                    var totalCount = 0;\n                    // Clone collection and change its table and set a limit of CHUNKSIZE on the cloned Collection instance.\n                    var collection = _this\n                        .clone({\n                        keysOnly: !ctx.isMatch && !hasDeleteHook\n                    }) // load just keys (unless filter() or and() or deleteHook has subscribers)\n                        .distinct() // In case multiEntry is used, never delete same key twice because resulting count\n                        .limit(CHUNKSIZE)\n                        .raw(); // Don't filter through reading-hooks (like mapped classes etc)\n                    var keysOrTuples = [];\n                    // We're gonna do things on as many chunks that are needed.\n                    // Use recursion of nextChunk function:\n                    var nextChunk = function () { return collection.each(hasDeleteHook ? function (val, cursor) {\n                        // Somebody subscribes to hook('deleting'). Collect all primary keys and their values,\n                        // so that the hook can be called with its values in bulkDelete().\n                        keysOrTuples.push([cursor.primaryKey, cursor.value]);\n                    } : function (val, cursor) {\n                        // No one subscribes to hook('deleting'). Collect only primary keys:\n                        keysOrTuples.push(cursor.primaryKey);\n                    }).then(function () {\n                        // Chromium deletes faster when doing it in sort order.\n                        hasDeleteHook ?\n                            keysOrTuples.sort(function (a, b) { return ascending(a[0], b[0]); }) :\n                            keysOrTuples.sort(ascending);\n                        return bulkDelete(idbstore, trans, keysOrTuples, hasDeleteHook, deletingHook);\n                    }).then(function () {\n                        var count = keysOrTuples.length;\n                        totalCount += count;\n                        keysOrTuples = [];\n                        return count < CHUNKSIZE ? totalCount : nextChunk();\n                    }); };\n                    resolve(nextChunk());\n                });\n            }\n        };\n    });\n    //\n    //\n    //\n    // ------------------------- Help functions ---------------------------\n    //\n    //\n    //\n    function lowerVersionFirst(a, b) {\n        return a._cfg.version - b._cfg.version;\n    }\n    function setApiOnPlace(objs, tableNames, dbschema) {\n        tableNames.forEach(function (tableName) {\n            var schema = dbschema[tableName];\n            objs.forEach(function (obj) {\n                if (!(tableName in obj)) {\n                    if (obj === Transaction.prototype || obj instanceof Transaction) {\n                        // obj is a Transaction prototype (or prototype of a subclass to Transaction)\n                        // Make the API a getter that returns this.table(tableName)\n                        setProp(obj, tableName, { get: function () { return this.table(tableName); } });\n                    }\n                    else {\n                        // Table will not be bound to a transaction (will use Dexie.currentTransaction)\n                        obj[tableName] = new Table(tableName, schema);\n                    }\n                }\n            });\n        });\n    }\n    function removeTablesApi(objs) {\n        objs.forEach(function (obj) {\n            for (var key in obj) {\n                if (obj[key] instanceof Table)\n                    delete obj[key];\n            }\n        });\n    }\n    function iterate(req, filter, fn, resolve, reject, valueMapper) {\n        // Apply valueMapper (hook('reading') or mappped class)\n        var mappedFn = valueMapper ? function (x, c, a) { return fn(valueMapper(x), c, a); } : fn;\n        // Wrap fn with PSD and microtick stuff from Promise.\n        var wrappedFn = wrap(mappedFn, reject);\n        if (!req.onerror)\n            req.onerror = eventRejectHandler(reject);\n        if (filter) {\n            req.onsuccess = trycatcher(function filter_record() {\n                var cursor = req.result;\n                if (cursor) {\n                    var c = function () { cursor.continue(); };\n                    if (filter(cursor, function (advancer) { c = advancer; }, resolve, reject))\n                        wrappedFn(cursor.value, cursor, function (advancer) { c = advancer; });\n                    c();\n                }\n                else {\n                    resolve();\n                }\n            }, reject);\n        }\n        else {\n            req.onsuccess = trycatcher(function filter_record() {\n                var cursor = req.result;\n                if (cursor) {\n                    var c = function () { cursor.continue(); };\n                    wrappedFn(cursor.value, cursor, function (advancer) { c = advancer; });\n                    c();\n                }\n                else {\n                    resolve();\n                }\n            }, reject);\n        }\n    }\n    function parseIndexSyntax(indexes) {\n        /// <param name=\"indexes\" type=\"String\"></param>\n        /// <returns type=\"Array\" elementType=\"IndexSpec\"></returns>\n        var rv = [];\n        indexes.split(',').forEach(function (index) {\n            index = index.trim();\n            var name = index.replace(/([&*]|\\+\\+)/g, \"\"); // Remove \"&\", \"++\" and \"*\"\n            // Let keyPath of \"[a+b]\" be [\"a\",\"b\"]:\n            var keyPath = /^\\[/.test(name) ? name.match(/^\\[(.*)\\]$/)[1].split('+') : name;\n            rv.push(new IndexSpec(name, keyPath || null, /\\&/.test(index), /\\*/.test(index), /\\+\\+/.test(index), isArray(keyPath), /\\./.test(index)));\n        });\n        return rv;\n    }\n    function cmp(key1, key2) {\n        return indexedDB.cmp(key1, key2);\n    }\n    function min(a, b) {\n        return cmp(a, b) < 0 ? a : b;\n    }\n    function max(a, b) {\n        return cmp(a, b) > 0 ? a : b;\n    }\n    function ascending(a, b) {\n        return indexedDB.cmp(a, b);\n    }\n    function descending(a, b) {\n        return indexedDB.cmp(b, a);\n    }\n    function simpleCompare(a, b) {\n        return a < b ? -1 : a === b ? 0 : 1;\n    }\n    function simpleCompareReverse(a, b) {\n        return a > b ? -1 : a === b ? 0 : 1;\n    }\n    function combine(filter1, filter2) {\n        return filter1 ?\n            filter2 ?\n                function () { return filter1.apply(this, arguments) && filter2.apply(this, arguments); } :\n                filter1 :\n            filter2;\n    }\n    function readGlobalSchema() {\n        db.verno = idbdb.version / 10;\n        db._dbSchema = globalSchema = {};\n        dbStoreNames = slice(idbdb.objectStoreNames, 0);\n        if (dbStoreNames.length === 0)\n            return; // Database contains no stores.\n        var trans = idbdb.transaction(safariMultiStoreFix(dbStoreNames), 'readonly');\n        dbStoreNames.forEach(function (storeName) {\n            var store = trans.objectStore(storeName), keyPath = store.keyPath, dotted = keyPath && typeof keyPath === 'string' && keyPath.indexOf('.') !== -1;\n            var primKey = new IndexSpec(keyPath, keyPath || \"\", false, false, !!store.autoIncrement, keyPath && typeof keyPath !== 'string', dotted);\n            var indexes = [];\n            for (var j = 0; j < store.indexNames.length; ++j) {\n                var idbindex = store.index(store.indexNames[j]);\n                keyPath = idbindex.keyPath;\n                dotted = keyPath && typeof keyPath === 'string' && keyPath.indexOf('.') !== -1;\n                var index = new IndexSpec(idbindex.name, keyPath, !!idbindex.unique, !!idbindex.multiEntry, false, keyPath && typeof keyPath !== 'string', dotted);\n                indexes.push(index);\n            }\n            globalSchema[storeName] = new TableSchema(storeName, primKey, indexes, {});\n        });\n        setApiOnPlace([allTables], keys(globalSchema), globalSchema);\n    }\n    function adjustToExistingIndexNames(schema, idbtrans) {\n        /// <summary>\n        /// Issue #30 Problem with existing db - adjust to existing index names when migrating from non-dexie db\n        /// </summary>\n        /// <param name=\"schema\" type=\"Object\">Map between name and TableSchema</param>\n        /// <param name=\"idbtrans\" type=\"IDBTransaction\"></param>\n        var storeNames = idbtrans.db.objectStoreNames;\n        for (var i = 0; i < storeNames.length; ++i) {\n            var storeName = storeNames[i];\n            var store = idbtrans.objectStore(storeName);\n            hasGetAll = 'getAll' in store;\n            for (var j = 0; j < store.indexNames.length; ++j) {\n                var indexName = store.indexNames[j];\n                var keyPath = store.index(indexName).keyPath;\n                var dexieName = typeof keyPath === 'string' ? keyPath : \"[\" + slice(keyPath).join('+') + \"]\";\n                if (schema[storeName]) {\n                    var indexSpec = schema[storeName].idxByName[dexieName];\n                    if (indexSpec)\n                        indexSpec.name = indexName;\n                }\n            }\n        }\n        // Bug with getAll() on Safari ver<604 on Workers only, see discussion following PR #579\n        if (/Safari/.test(navigator.userAgent) &&\n            !/(Chrome\\/|Edge\\/)/.test(navigator.userAgent) &&\n            _global.WorkerGlobalScope && _global instanceof _global.WorkerGlobalScope &&\n            [].concat(navigator.userAgent.match(/Safari\\/(\\d*)/))[1] < 604) {\n            hasGetAll = false;\n        }\n    }\n    function fireOnBlocked(ev) {\n        db.on(\"blocked\").fire(ev);\n        // Workaround (not fully*) for missing \"versionchange\" event in IE,Edge and Safari:\n        connections\n            .filter(function (c) { return c.name === db.name && c !== db && !c._vcFired; })\n            .map(function (c) { return c.on(\"versionchange\").fire(ev); });\n    }\n    extend(this, {\n        Collection: Collection,\n        Table: Table,\n        Transaction: Transaction,\n        Version: Version,\n        WhereClause: WhereClause\n    });\n    init();\n    addons.forEach(function (fn) {\n        fn(db);\n    });\n}\nfunction parseType(type) {\n    if (typeof type === 'function') {\n        return new type();\n    }\n    else if (isArray(type)) {\n        return [parseType(type[0])];\n    }\n    else if (type && typeof type === 'object') {\n        var rv = {};\n        applyStructure(rv, type);\n        return rv;\n    }\n    else {\n        return type;\n    }\n}\nfunction applyStructure(obj, structure) {\n    keys(structure).forEach(function (member) {\n        var value = parseType(structure[member]);\n        obj[member] = value;\n    });\n    return obj;\n}\nfunction hookedEventSuccessHandler(resolve) {\n    // wrap() is needed when calling hooks because the rare scenario of:\n    //  * hook does a db operation that fails immediately (IDB throws exception)\n    //    For calling db operations on correct transaction, wrap makes sure to set PSD correctly.\n    //    wrap() will also execute in a virtual tick.\n    //  * If not wrapped in a virtual tick, direct exception will launch a new physical tick.\n    //  * If this was the last event in the bulk, the promise will resolve after a physical tick\n    //    and the transaction will have committed already.\n    // If no hook, the virtual tick will be executed in the reject()/resolve of the final promise,\n    // because it is always marked with _lib = true when created using Transaction._promise().\n    return wrap(function (event) {\n        var req = event.target, ctx = req._hookCtx, // Contains the hook error handler. Put here instead of closure to boost performance.\n        result = ctx.value || req.result, // Pass the object value on updates. The result from IDB is the primary key.\n        hookSuccessHandler = ctx && ctx.onsuccess;\n        hookSuccessHandler && hookSuccessHandler(result);\n        resolve && resolve(result);\n    }, resolve);\n}\nfunction eventRejectHandler(reject) {\n    return wrap(function (event) {\n        preventDefault(event);\n        reject(event.target.error);\n        return false;\n    });\n}\nfunction eventSuccessHandler(resolve) {\n    return wrap(function (event) {\n        resolve(event.target.result);\n    });\n}\nfunction hookedEventRejectHandler(reject) {\n    return wrap(function (event) {\n        // See comment on hookedEventSuccessHandler() why wrap() is needed only when supporting hooks.\n        var req = event.target, err = req.error, ctx = req._hookCtx, // Contains the hook error handler. Put here instead of closure to boost performance.\n        hookErrorHandler = ctx && ctx.onerror;\n        hookErrorHandler && hookErrorHandler(err);\n        preventDefault(event);\n        reject(err);\n        return false;\n    });\n}\nfunction preventDefault(event) {\n    if (event.stopPropagation)\n        event.stopPropagation();\n    if (event.preventDefault)\n        event.preventDefault();\n}\nfunction awaitIterator(iterator) {\n    var callNext = function (result) { return iterator.next(result); }, doThrow = function (error) { return iterator.throw(error); }, onSuccess = step(callNext), onError = step(doThrow);\n    function step(getNext) {\n        return function (val) {\n            var next = getNext(val), value = next.value;\n            return next.done ? value :\n                (!value || typeof value.then !== 'function' ?\n                    isArray(value) ? Promise.all(value).then(onSuccess, onError) : onSuccess(value) :\n                    value.then(onSuccess, onError));\n        };\n    }\n    return step(callNext)();\n}\n//\n// IndexSpec struct\n//\nfunction IndexSpec(name, keyPath, unique, multi, auto, compound, dotted) {\n    /// <param name=\"name\" type=\"String\"></param>\n    /// <param name=\"keyPath\" type=\"String\"></param>\n    /// <param name=\"unique\" type=\"Boolean\"></param>\n    /// <param name=\"multi\" type=\"Boolean\"></param>\n    /// <param name=\"auto\" type=\"Boolean\"></param>\n    /// <param name=\"compound\" type=\"Boolean\"></param>\n    /// <param name=\"dotted\" type=\"Boolean\"></param>\n    this.name = name;\n    this.keyPath = keyPath;\n    this.unique = unique;\n    this.multi = multi;\n    this.auto = auto;\n    this.compound = compound;\n    this.dotted = dotted;\n    var keyPathSrc = typeof keyPath === 'string' ? keyPath : keyPath && ('[' + [].join.call(keyPath, '+') + ']');\n    this.src = (unique ? '&' : '') + (multi ? '*' : '') + (auto ? \"++\" : \"\") + keyPathSrc;\n}\n//\n// TableSchema struct\n//\nfunction TableSchema(name, primKey, indexes, instanceTemplate) {\n    /// <param name=\"name\" type=\"String\"></param>\n    /// <param name=\"primKey\" type=\"IndexSpec\"></param>\n    /// <param name=\"indexes\" type=\"Array\" elementType=\"IndexSpec\"></param>\n    /// <param name=\"instanceTemplate\" type=\"Object\"></param>\n    this.name = name;\n    this.primKey = primKey || new IndexSpec();\n    this.indexes = indexes || [new IndexSpec()];\n    this.instanceTemplate = instanceTemplate;\n    this.mappedClass = null;\n    this.idxByName = arrayToObject(indexes, function (index) { return [index.name, index]; });\n}\nfunction safariMultiStoreFix(storeNames) {\n    return storeNames.length === 1 ? storeNames[0] : storeNames;\n}\nfunction getNativeGetDatabaseNamesFn(indexedDB) {\n    var fn = indexedDB && (indexedDB.getDatabaseNames || indexedDB.webkitGetDatabaseNames);\n    return fn && fn.bind(indexedDB);\n}\n// Export Error classes\nprops(Dexie, fullNameExceptions); // Dexie.XXXError = class XXXError {...};\n//\n// Static methods and properties\n// \nprops(Dexie, {\n    //\n    // Static delete() method.\n    //\n    delete: function (databaseName) {\n        var db = new Dexie(databaseName), promise = db.delete();\n        promise.onblocked = function (fn) {\n            db.on(\"blocked\", fn);\n            return this;\n        };\n        return promise;\n    },\n    //\n    // Static exists() method.\n    //\n    exists: function (name) {\n        return new Dexie(name).open().then(function (db) {\n            db.close();\n            return true;\n        }).catch(Dexie.NoSuchDatabaseError, function () { return false; });\n    },\n    //\n    // Static method for retrieving a list of all existing databases at current host.\n    //\n    getDatabaseNames: function (cb) {\n        var getDatabaseNames = getNativeGetDatabaseNamesFn(Dexie.dependencies.indexedDB);\n        return getDatabaseNames ? new Promise(function (resolve, reject) {\n            var req = getDatabaseNames();\n            req.onsuccess = function (event) {\n                resolve(slice(event.target.result, 0)); // Converst DOMStringList to Array<String>\n            };\n            req.onerror = eventRejectHandler(reject);\n        }).then(cb) : dbNamesDB.dbnames.toCollection().primaryKeys(cb);\n    },\n    defineClass: function () {\n        // Default constructor able to copy given properties into this object.\n        function Class(properties) {\n            /// <param name=\"properties\" type=\"Object\" optional=\"true\">Properties to initialize object with.\n            /// </param>\n            if (properties)\n                extend(this, properties);\n        }\n        return Class;\n    },\n    applyStructure: applyStructure,\n    ignoreTransaction: function (scopeFunc) {\n        // In case caller is within a transaction but needs to create a separate transaction.\n        // Example of usage:\n        //\n        // Let's say we have a logger function in our app. Other application-logic should be unaware of the\n        // logger function and not need to include the 'logentries' table in all transaction it performs.\n        // The logging should always be done in a separate transaction and not be dependant on the current\n        // running transaction context. Then you could use Dexie.ignoreTransaction() to run code that starts a new transaction.\n        //\n        //     Dexie.ignoreTransaction(function() {\n        //         db.logentries.add(newLogEntry);\n        //     });\n        //\n        // Unless using Dexie.ignoreTransaction(), the above example would try to reuse the current transaction\n        // in current Promise-scope.\n        //\n        // An alternative to Dexie.ignoreTransaction() would be setImmediate() or setTimeout(). The reason we still provide an\n        // API for this because\n        //  1) The intention of writing the statement could be unclear if using setImmediate() or setTimeout().\n        //  2) setTimeout() would wait unnescessary until firing. This is however not the case with setImmediate().\n        //  3) setImmediate() is not supported in the ES standard.\n        //  4) You might want to keep other PSD state that was set in a parent PSD, such as PSD.letThrough.\n        return PSD.trans ?\n            usePSD(PSD.transless, scopeFunc) : // Use the closest parent that was non-transactional.\n            scopeFunc(); // No need to change scope because there is no ongoing transaction.\n    },\n    vip: function (fn) {\n        // To be used by subscribers to the on('ready') event.\n        // This will let caller through to access DB even when it is blocked while the db.ready() subscribers are firing.\n        // This would have worked automatically if we were certain that the Provider was using Dexie.Promise for all asyncronic operations. The promise PSD\n        // from the provider.connect() call would then be derived all the way to when provider would call localDatabase.applyChanges(). But since\n        // the provider more likely is using non-promise async APIs or other thenable implementations, we cannot assume that.\n        // Note that this method is only useful for on('ready') subscribers that is returning a Promise from the event. If not using vip()\n        // the database could deadlock since it wont open until the returned Promise is resolved, and any non-VIPed operation started by\n        // the caller will not resolve until database is opened.\n        return newScope(function () {\n            PSD.letThrough = true; // Make sure we are let through if still blocking db due to onready is firing.\n            return fn();\n        });\n    },\n    async: function (generatorFn) {\n        return function () {\n            try {\n                var rv = awaitIterator(generatorFn.apply(this, arguments));\n                if (!rv || typeof rv.then !== 'function')\n                    return Promise.resolve(rv);\n                return rv;\n            }\n            catch (e) {\n                return rejection(e);\n            }\n        };\n    },\n    spawn: function (generatorFn, args, thiz) {\n        try {\n            var rv = awaitIterator(generatorFn.apply(thiz, args || []));\n            if (!rv || typeof rv.then !== 'function')\n                return Promise.resolve(rv);\n            return rv;\n        }\n        catch (e) {\n            return rejection(e);\n        }\n    },\n    // Dexie.currentTransaction property\n    currentTransaction: {\n        get: function () { return PSD.trans || null; }\n    },\n    waitFor: function (promiseOrFunction, optionalTimeout) {\n        // If a function is provided, invoke it and pass the returning value to Transaction.waitFor()\n        var promise = Promise.resolve(typeof promiseOrFunction === 'function' ? Dexie.ignoreTransaction(promiseOrFunction) : promiseOrFunction)\n            .timeout(optionalTimeout || 60000); // Default the timeout to one minute. Caller may specify Infinity if required.       \n        // Run given promise on current transaction. If no current transaction, just return a Dexie promise based\n        // on given value.\n        return PSD.trans ? PSD.trans.waitFor(promise) : promise;\n    },\n    // Export our Promise implementation since it can be handy as a standalone Promise implementation\n    Promise: Promise,\n    // Dexie.debug proptery:\n    // Dexie.debug = false\n    // Dexie.debug = true\n    // Dexie.debug = \"dexie\" - don't hide dexie's stack frames.\n    debug: {\n        get: function () { return debug; },\n        set: function (value) {\n            setDebug(value, value === 'dexie' ? function () { return true; } : dexieStackFrameFilter);\n        }\n    },\n    // Export our derive/extend/override methodology\n    derive: derive,\n    extend: extend,\n    props: props,\n    override: override,\n    // Export our Events() function - can be handy as a toolkit\n    Events: Events,\n    // Utilities\n    getByKeyPath: getByKeyPath,\n    setByKeyPath: setByKeyPath,\n    delByKeyPath: delByKeyPath,\n    shallowClone: shallowClone,\n    deepClone: deepClone,\n    getObjectDiff: getObjectDiff,\n    asap: asap,\n    maxKey: maxKey,\n    minKey: minKey,\n    // Addon registry\n    addons: [],\n    // Global DB connection list\n    connections: connections,\n    MultiModifyError: exceptions.Modify,\n    errnames: errnames,\n    // Export other static classes\n    IndexSpec: IndexSpec,\n    TableSchema: TableSchema,\n    //\n    // Dependencies\n    //\n    // These will automatically work in browsers with indexedDB support, or where an indexedDB polyfill has been included.\n    //\n    // In node.js, however, these properties must be set \"manually\" before instansiating a new Dexie().\n    // For node.js, you need to require indexeddb-js or similar and then set these deps.\n    //\n    dependencies: (function () {\n        try {\n            return {\n                // Required:\n                indexedDB: _global.indexedDB || _global.mozIndexedDB || _global.webkitIndexedDB || _global.msIndexedDB,\n                IDBKeyRange: _global.IDBKeyRange || _global.webkitIDBKeyRange\n            };\n        }\n        catch (e) {\n            return {\n                indexedDB: null,\n                IDBKeyRange: null\n            };\n        }\n    })(),\n    // API Version Number: Type Number, make sure to always set a version number that can be comparable correctly. Example: 0.9, 0.91, 0.92, 1.0, 1.01, 1.1, 1.2, 1.21, etc.\n    semVer: DEXIE_VERSION,\n    version: DEXIE_VERSION.split('.')\n        .map(function (n) { return parseInt(n); })\n        .reduce(function (p, c, i) { return p + (c / Math.pow(10, i * 2)); }),\n    // https://github.com/dfahlander/Dexie.js/issues/186\n    // typescript compiler tsc in mode ts-->es5 & commonJS, will expect require() to return\n    // x.default. Workaround: Set Dexie.default = Dexie.\n    default: Dexie,\n    // Make it possible to import {Dexie} (non-default import)\n    // Reason 1: May switch to that in future.\n    // Reason 2: We declare it both default and named exported in d.ts to make it possible\n    // to let addons extend the Dexie interface with Typescript 2.1 (works only when explicitely\n    // exporting the symbol, not just default exporting)\n    Dexie: Dexie\n});\n// Map DOMErrors and DOMExceptions to corresponding Dexie errors. May change in Dexie v2.0.\nPromise.rejectionMapper = mapError;\n// Initialize dbNamesDB (won't ever be opened on chromium browsers')\ndbNamesDB = new Dexie('__dbnames');\ndbNamesDB.version(1).stores({ dbnames: 'name' });\n(function () {\n    // Migrate from Dexie 1.x database names stored in localStorage:\n    var DBNAMES = 'Dexie.DatabaseNames';\n    try {\n        if (typeof localStorage !== undefined && _global.document !== undefined) {\n            // Have localStorage and is not executing in a worker. Lets migrate from Dexie 1.x.\n            JSON.parse(localStorage.getItem(DBNAMES) || \"[]\")\n                .forEach(function (name) { return dbNamesDB.dbnames.put({ name: name }).catch(nop); });\n            localStorage.removeItem(DBNAMES);\n        }\n    }\n    catch (_e) { }\n})();\n\nexport default Dexie;\n//# sourceMappingURL=dexie.es.js.map\n","import * as React from 'react'\nimport { AuthenticationForm } from './authentication-form'\nimport { assertNever } from '../../lib/fatal-error'\nimport { TwoFactorAuthentication } from '../lib/two-factor-authentication'\nimport { EnterpriseServerEntry } from '../lib/enterprise-server-entry'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport {\n  SignInState,\n  SignInStep,\n  IEndpointEntryState,\n  IAuthenticationState,\n  ITwoFactorAuthenticationState,\n} from '../../lib/stores'\n\ninterface ISignInProps {\n  readonly signInState: SignInState\n  readonly dispatcher: Dispatcher\n}\n\n/**\n * The sign in flow for GitHub.\n *\n * Provide `children` elements to render additional buttons in the active form.\n */\nexport class SignIn extends React.Component<ISignInProps, {}> {\n  private onEndpointEntered = (url: string) => {\n    this.props.dispatcher.setSignInEndpoint(url)\n  }\n\n  private onCredentialsEntered = (username: string, password: string) => {\n    this.props.dispatcher.setSignInCredentials(username, password)\n  }\n\n  private onBrowserSignInRequested = () => {\n    this.props.dispatcher.requestBrowserAuthentication()\n  }\n\n  private onOTPEntered = (otp: string) => {\n    this.props.dispatcher.setSignInOTP(otp)\n  }\n\n  private renderEndpointEntryStep(state: IEndpointEntryState) {\n    const children = this.props.children as ReadonlyArray<JSX.Element>\n    return (\n      <EnterpriseServerEntry\n        loading={state.loading}\n        error={state.error}\n        onSubmit={this.onEndpointEntered}\n        additionalButtons={children}\n      />\n    )\n  }\n\n  private renderAuthenticationStep(state: IAuthenticationState) {\n    const children = this.props.children as ReadonlyArray<JSX.Element>\n\n    return (\n      <AuthenticationForm\n        loading={state.loading}\n        error={state.error}\n        supportsBasicAuth={state.supportsBasicAuth}\n        additionalButtons={children}\n        onBrowserSignInRequested={this.onBrowserSignInRequested}\n        onSubmit={this.onCredentialsEntered}\n        forgotPasswordUrl={state.forgotPasswordUrl}\n      />\n    )\n  }\n\n  private renderTwoFactorAuthenticationStep(\n    state: ITwoFactorAuthenticationState\n  ) {\n    return (\n      <TwoFactorAuthentication\n        loading={state.loading}\n        error={state.error}\n        type={state.type}\n        additionalButtons={this.props.children}\n        onOTPEntered={this.onOTPEntered}\n      />\n    )\n  }\n\n  public render() {\n    const state = this.props.signInState\n    const stepText = this.props.signInState.kind\n\n    switch (state.kind) {\n      case SignInStep.EndpointEntry:\n        return this.renderEndpointEntryStep(state)\n      case SignInStep.Authentication:\n        return this.renderAuthenticationStep(state)\n      case SignInStep.TwoFactorAuthentication:\n        return this.renderTwoFactorAuthenticationStep(state)\n      case SignInStep.Success:\n        return null\n      default:\n        return assertNever(state, `Unknown sign-in step: ${stepText}`)\n    }\n  }\n}\n","import { shell } from './app-shell'\nimport { Account } from '../models/account'\nimport { fatalError } from './fatal-error'\nimport { getOAuthAuthorizationURL, requestOAuthToken, fetchUser } from './api'\nimport { uuid } from './uuid'\n\ninterface IOAuthState {\n  readonly state: string\n  readonly endpoint: string\n  readonly resolve: (account: Account) => void\n  readonly reject: (error: Error) => void\n}\n\nlet oauthState: IOAuthState | null = null\n\n/**\n * Ask the user to auth with the given endpoint. This will open their browser.\n *\n * @param endpoint - The endpoint to auth against.\n *\n * Returns a {Promise} which will resolve when the OAuth flow as been completed.\n * Note that the promise may not complete if the user doesn't complete the OAuth\n * flow.\n */\nexport function askUserToOAuth(endpoint: string) {\n  // Disable the lint warning since we're storing the `resolve` and `reject`\n  // functions.\n  // tslint:disable-next-line:promise-must-complete\n  return new Promise<Account>((resolve, reject) => {\n    oauthState = { state: uuid(), endpoint, resolve, reject }\n\n    const oauthURL = getOAuthAuthorizationURL(endpoint, oauthState.state)\n    shell.openExternal(oauthURL)\n  })\n}\n\n/**\n * Request the authenticated using, using the code given to us by the OAuth\n * callback.\n *\n * @returns `undefined` if there is no valid OAuth state to use, or `null` if\n * the code cannot be used to retrieve a valid GitHub user.\n */\nexport async function requestAuthenticatedUser(\n  code: string,\n  state: string\n): Promise<Account | null | undefined> {\n  if (!oauthState || state !== oauthState.state) {\n    log.warn(\n      'requestAuthenticatedUser was not called with valid OAuth state. This is likely due to a browser reloading the callback URL. Contact GitHub Support if you believe this is an error'\n    )\n    return undefined\n  }\n\n  const token = await requestOAuthToken(oauthState.endpoint, code)\n  if (token) {\n    return fetchUser(oauthState.endpoint, token)\n  } else {\n    return null\n  }\n}\n\n/**\n * Resolve the current OAuth request with the given account.\n *\n * Note that this can only be called after `askUserToOAuth` has been called and\n * must only be called once.\n */\nexport function resolveOAuthRequest(account: Account) {\n  if (!oauthState) {\n    fatalError(\n      '`askUserToOAuth` must be called before resolving an auth request.'\n    )\n    return\n  }\n\n  oauthState.resolve(account)\n\n  oauthState = null\n}\n\n/**\n * Reject the current OAuth request with the given error.\n *\n * Note that this can only be called after `askUserToOAuth` has been called and\n * must only be called once.\n */\nexport function rejectOAuthRequest(error: Error) {\n  if (!oauthState) {\n    fatalError(\n      '`askUserToOAuth` must be called before rejecting an auth request.'\n    )\n    return\n  }\n\n  oauthState.reject(error)\n\n  oauthState = null\n}\n","import { GitHubRepository } from '../../../models/github-repository'\nimport { IRemote } from '../../../models/remote'\nimport { parseRemote } from '../../remote-parsing'\nimport { forceUnwrap } from '../../fatal-error'\n\n/** The name for a fork's upstream remote. */\nexport const UpstreamRemoteName = 'upstream'\n\n/**\n * Find the upstream remote based on the parent repository and the list of\n * remotes.\n */\nexport function findUpstreamRemote(\n  parent: GitHubRepository,\n  remotes: ReadonlyArray<IRemote>\n): IRemote | null {\n  const upstream = remotes.find(r => r.name === UpstreamRemoteName)\n  if (!upstream) {\n    return null\n  }\n\n  const parsedUpstream = parseRemote(upstream.url)\n  if (!parsedUpstream || !parsedUpstream.name || !parsedUpstream.owner) {\n    return null\n  }\n\n  const cloneURL = forceUnwrap(\n    'Parent repositories are fully loaded',\n    parent.cloneURL\n  )\n  const parentURL = new URL(cloneURL)\n  if (\n    parsedUpstream.owner.toLowerCase() === parent.owner.login.toLowerCase() &&\n    parsedUpstream.name.toLowerCase() === parent.name.toLowerCase() &&\n    parsedUpstream.hostname.toLowerCase() === parentURL.hostname.toLowerCase()\n  ) {\n    return upstream\n  } else {\n    return null\n  }\n}\n","import { Repository } from '../../models/repository'\nimport { IRemote } from '../../models/remote'\n\n/**\n * The error thrown when a repository is a fork but its upstream remote isn't\n * the parent.\n */\nexport class UpstreamAlreadyExistsError extends Error {\n  public readonly repository: Repository\n  public readonly existingRemote: IRemote\n\n  public constructor(repository: Repository, existingRemote: IRemote) {\n    super(`The remote '${existingRemote.name}' already exists`)\n\n    this.repository = repository\n    this.existingRemote = existingRemote\n  }\n}\n","/**\n * Wrap a promise in a minimum timeout, so that it only returns after both the\n * timeout and promise have completed.\n *\n * This is ideal for scenarios where a promises may complete quickly, but the\n * caller wants to introduce a minimum latency so that any dependent UI is\n *\n *\n * @param action the promise work to track\n * @param timeout the minimum time to wait before resolving the promise (in milliseconds)\n */\nexport function promiseWithMinimumTimeout<T>(\n  action: () => Promise<T>,\n  timeout: number\n): Promise<T> {\n  return new Promise<T>((resolve, reject) => {\n    let timeoutExpired = false\n    let result: T | null = null\n\n    const resolveIfBothDone = () => {\n      if (result != null && timeoutExpired) {\n        resolve(result)\n        result = null\n      }\n    }\n\n    window.setTimeout(() => {\n      timeoutExpired = true\n      resolveIfBothDone()\n    }, timeout)\n\n    action()\n      .then(r => {\n        result = r\n        resolveIfBothDone()\n      })\n      .catch(reject)\n  })\n}\n","import { IAheadBehind } from '../models/branch'\nimport { revSymmetricDifference } from '../lib/git'\n\nexport class ComparisonCache {\n  private backingStore = new Map<string, IAheadBehind>()\n\n  public set(from: string, to: string, value: IAheadBehind) {\n    const key = revSymmetricDifference(from, to)\n    this.backingStore.set(key, value)\n  }\n\n  public get(from: string, to: string) {\n    const key = revSymmetricDifference(from, to)\n    return this.backingStore.get(key) || null\n  }\n\n  public has(from: string, to: string) {\n    const key = revSymmetricDifference(from, to)\n    return this.backingStore.has(key)\n  }\n\n  public get size() {\n    return this.backingStore.size\n  }\n\n  public clear() {\n    this.backingStore.clear()\n  }\n}\n","/** The `localStorage` key for whether we've shown the Welcome flow yet. */\nconst HasShownWelcomeFlowKey = 'has-shown-welcome-flow'\n\n/**\n * Check if the current user has completed the welcome flow.\n */\nexport function hasShownWelcomeFlow(): boolean {\n  const hasShownWelcomeFlow = localStorage.getItem(HasShownWelcomeFlowKey)\n  if (!hasShownWelcomeFlow) {\n    return false\n  }\n\n  const value = parseInt(hasShownWelcomeFlow, 10)\n  return value === 1\n}\n\n/**\n * Update local storage to indicate the welcome flow has been completed.\n */\nexport function markWelcomeFlowComplete() {\n  localStorage.setItem(HasShownWelcomeFlowKey, '1')\n}\n","export class ShellError extends Error {}\n","import { Repository } from '../models/repository'\nimport { Account } from '../models/account'\nimport { getAccountForEndpoint } from './api'\n\n/** Get the authenticated account for the repository. */\nexport function getAccountForRepository(\n  accounts: ReadonlyArray<Account>,\n  repository: Repository\n): Account | null {\n  const gitHubRepository = repository.gitHubRepository\n  if (!gitHubRepository) {\n    return null\n  }\n\n  return getAccountForEndpoint(accounts, gitHubRepository.endpoint)\n}\n","import * as keytar from 'keytar'\n\nfunction setItem(key: string, login: string, value: string) {\n  return keytar.setPassword(key, login, value)\n}\n\nfunction getItem(key: string, login: string) {\n  return keytar.getPassword(key, login)\n}\n\nfunction deleteItem(key: string, login: string) {\n  return keytar.deletePassword(key, login)\n}\n\nexport const TokenStore = {\n  setItem,\n  getItem,\n  deleteItem,\n}\n","import * as URL from 'url'\nimport { parseRemote } from './remote-parsing'\nimport { getKeyForEndpoint } from './auth'\nimport { TokenStore } from './stores/token-store'\n\n/** Get the hostname to use for the given remote. */\nexport function getGenericHostname(remoteURL: string): string {\n  const parsed = parseRemote(remoteURL)\n  if (parsed) {\n    return parsed.hostname\n  }\n\n  const urlHostname = URL.parse(remoteURL).hostname\n  if (urlHostname) {\n    return urlHostname\n  }\n\n  return remoteURL\n}\n\nfunction getKeyForUsername(hostname: string): string {\n  return `genericGitAuth/username/${hostname}`\n}\n\n/** Get the username for the host. */\nexport function getGenericUsername(hostname: string): string | null {\n  const key = getKeyForUsername(hostname)\n  return localStorage.getItem(key)\n}\n\n/** Set the username for the host. */\nexport function setGenericUsername(hostname: string, username: string) {\n  const key = getKeyForUsername(hostname)\n  return localStorage.setItem(key, username)\n}\n\n/** Set the password for the username and host. */\nexport function setGenericPassword(\n  hostname: string,\n  username: string,\n  password: string\n): Promise<void> {\n  const key = getKeyForEndpoint(hostname)\n  return TokenStore.setItem(key, username, password)\n}\n","import { ITrailer, mergeTrailers } from './git/interpret-trailers'\nimport { Repository } from '../models/repository'\n\n/**\n * Formats a summary and a description into a git-friendly\n * commit message where the summary and (optional) description\n * is separated by a blank line.\n *\n * Also accepts an optional array of commit message trailers,\n * see git-interpret-trailers which, if present, will be merged\n * into the commit message.\n *\n * Always returns commit message with a trailing newline\n *\n * See https://git-scm.com/docs/git-commit#_discussion\n */\nexport async function formatCommitMessage(\n  repository: Repository,\n  summary: string,\n  description: string | null,\n  trailers?: ReadonlyArray<ITrailer>\n) {\n  // Git always trim whitespace at the end of commit messages\n  // so we concatenate the summary with the description, ensuring\n  // that they're separated by two newlines. If we don't have a\n  // description or if it consists solely of whitespace that'll\n  // all get trimmed away and replaced with a single newline (since\n  // all commit messages needs to end with a newline for git\n  // interpret-trailers to work)\n  const message = `${summary}\\n\\n${description || ''}\\n`.replace(/\\s+$/, '\\n')\n\n  return trailers !== undefined && trailers.length > 0\n    ? mergeTrailers(repository, message, trailers)\n    : message\n}\n","import * as URL from 'url'\nimport { getHTMLURL, API, getDotComAPIEndpoint } from './api'\nimport { parseRemote, parseRepositoryIdentifier } from './remote-parsing'\nimport { Account } from '../models/account'\n\ntype RepositoryLookupFunc = (\n  account: Account,\n  owner: string,\n  name: string\n) => Promise<boolean>\n\n/**\n * Check if the repository designated by the owner and name exists and can be\n * accessed by the given account.\n */\nasync function canAccessRepositoryUsingAPI(\n  account: Account,\n  owner: string,\n  name: string\n): Promise<boolean> {\n  const api = API.fromAccount(account)\n  const repository = await api.fetchRepository(owner, name)\n  if (repository) {\n    return true\n  } else {\n    return false\n  }\n}\n\n/**\n * Find the GitHub account associated with a given remote URL.\n *\n * @param urlOrRepositoryAlias - the URL or repository alias whose account\n *                               should be found\n * @param accounts             - the list of active GitHub and GitHub Enterprise\n *                               accounts\n */\nexport async function findAccountForRemoteURL(\n  urlOrRepositoryAlias: string,\n  accounts: ReadonlyArray<Account>,\n  canAccessRepository: RepositoryLookupFunc = canAccessRepositoryUsingAPI\n): Promise<Account | null> {\n  const allAccounts = [...accounts, Account.anonymous()]\n\n  // We have a couple of strategies to try to figure out what account we\n  // should use to authenticate the URL:\n  //\n  //  1. Try to parse a remote out of the URL.\n  //    1. If that works, try to find an account for that host.\n  //    2. If we don't find an account move on to our next strategy.\n  //  2. Try to parse an owner/name.\n  //    1. If that works, find the first account that can access it.\n  //  3. And if all that fails then throw our hands in the air because we\n  //     truly don't care.\n  const parsedURL = parseRemote(urlOrRepositoryAlias)\n  if (parsedURL) {\n    const account =\n      allAccounts.find(a => {\n        const htmlURL = getHTMLURL(a.endpoint)\n        const parsedEndpoint = URL.parse(htmlURL)\n        return parsedURL.hostname === parsedEndpoint.hostname\n      }) || null\n\n    // If we find an account whose hostname matches the URL to be cloned, it's\n    // always gonna be our best bet for success. We're not gonna do better.\n    if (account) {\n      return account\n    }\n  }\n\n  const repositoryIdentifier = parseRepositoryIdentifier(urlOrRepositoryAlias)\n  if (repositoryIdentifier) {\n    const { owner, name, hostname } = repositoryIdentifier\n\n    // This chunk of code is designed to sort the user's accounts in this order:\n    //  - authenticated GitHub account\n    //  - GitHub Enterprise accounts\n    //  - unauthenticated GitHub account (access public repositories)\n    //\n    // As this needs to be done efficiently, we consider endpoints not matching\n    // `getDotComAPIEndpoint()` to be GitHub Enterprise accounts, and accounts\n    // without a token to be unauthenticated.\n    const sortedAccounts = Array.from(allAccounts).sort((a1, a2) => {\n      if (a1.endpoint === getDotComAPIEndpoint()) {\n        return a1.token.length ? -1 : 1\n      } else if (a2.endpoint === getDotComAPIEndpoint()) {\n        return a2.token.length ? 1 : -1\n      } else {\n        return 0\n      }\n    })\n\n    for (const account of sortedAccounts) {\n      if (hostname != null) {\n        const htmlURL = URL.parse(getHTMLURL(account.endpoint))\n        const accountHost = htmlURL.hostname\n        if (accountHost !== hostname) {\n          continue\n        }\n      }\n\n      const canAccess = await canAccessRepository(account, owner, name)\n      if (canAccess) {\n        return account\n      }\n    }\n  }\n\n  return null\n}\n","import { pathExists } from 'fs-extra'\n\nimport { IFoundEditor } from './found-editor'\nimport { assertNever } from '../fatal-error'\n\nexport enum ExternalEditor {\n  Atom = 'Atom',\n  VisualStudioCode = 'Visual Studio Code',\n  VisualStudioCodeInsiders = 'Visual Studio Code (Insiders)',\n  SublimeText = 'Sublime Text',\n  Typora = 'Typora',\n}\n\nexport function parse(label: string): ExternalEditor | null {\n  if (label === ExternalEditor.Atom) {\n    return ExternalEditor.Atom\n  }\n\n  if (label === ExternalEditor.VisualStudioCode) {\n    return ExternalEditor.VisualStudioCode\n  }\n\n  if (label === ExternalEditor.VisualStudioCodeInsiders) {\n    return ExternalEditor.VisualStudioCode\n  }\n\n  if (label === ExternalEditor.SublimeText) {\n    return ExternalEditor.SublimeText\n  }\n\n  if (label === ExternalEditor.Typora) {\n    return ExternalEditor.Typora\n  }\n\n  return null\n}\n\nasync function getPathIfAvailable(path: string): Promise<string | null> {\n  return (await pathExists(path)) ? path : null\n}\n\nfunction getEditorPath(editor: ExternalEditor): Promise<string | null> {\n  switch (editor) {\n    case ExternalEditor.Atom:\n      return getPathIfAvailable('/usr/bin/atom')\n    case ExternalEditor.VisualStudioCode:\n      return getPathIfAvailable('/usr/bin/code')\n    case ExternalEditor.VisualStudioCodeInsiders:\n      return getPathIfAvailable('/usr/bin/code-insiders')\n    case ExternalEditor.SublimeText:\n      return getPathIfAvailable('/usr/bin/subl')\n    case ExternalEditor.Typora:\n      return getPathIfAvailable('/usr/bin/typora')\n    default:\n      return assertNever(editor, `Unknown editor: ${editor}`)\n  }\n}\n\nexport async function getAvailableEditors(): Promise<\n  ReadonlyArray<IFoundEditor<ExternalEditor>>\n> {\n  const results: Array<IFoundEditor<ExternalEditor>> = []\n\n  const [\n    atomPath,\n    codePath,\n    codeInsidersPath,\n    sublimePath,\n    typoraPath,\n  ] = await Promise.all([\n    getEditorPath(ExternalEditor.Atom),\n    getEditorPath(ExternalEditor.VisualStudioCode),\n    getEditorPath(ExternalEditor.VisualStudioCodeInsiders),\n    getEditorPath(ExternalEditor.SublimeText),\n    getEditorPath(ExternalEditor.Typora),\n  ])\n\n  if (atomPath) {\n    results.push({ editor: ExternalEditor.Atom, path: atomPath })\n  }\n\n  if (codePath) {\n    results.push({ editor: ExternalEditor.VisualStudioCode, path: codePath })\n  }\n\n  if (codeInsidersPath) {\n    results.push({\n      editor: ExternalEditor.VisualStudioCode,\n      path: codeInsidersPath,\n    })\n  }\n\n  if (sublimePath) {\n    results.push({ editor: ExternalEditor.SublimeText, path: sublimePath })\n  }\n\n  if (typoraPath) {\n    results.push({ editor: ExternalEditor.Typora, path: typoraPath })\n  }\n\n  return results\n}\n","\"use strict\";\r\nfunction __export(m) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n__export(require(\"./registry\"));\r\n//# sourceMappingURL=index.js.map","import * as Path from 'path'\n\nimport {\n  enumerateValues,\n  HKEY,\n  RegistryValue,\n  RegistryValueType,\n} from 'registry-js'\n\nimport { pathExists } from 'fs-extra'\nimport { IFoundEditor } from './found-editor'\n\nimport { assertNever } from '../fatal-error'\n\nexport enum ExternalEditor {\n  Atom = 'Atom',\n  VisualStudioCode = 'Visual Studio Code',\n  VisualStudioCodeInsiders = 'Visual Studio Code (Insiders)',\n  SublimeText = 'Sublime Text',\n  CFBuilder = 'ColdFusion Builder',\n  Typora = 'Typora',\n}\n\nexport function parse(label: string): ExternalEditor | null {\n  if (label === ExternalEditor.Atom) {\n    return ExternalEditor.Atom\n  }\n  if (label === ExternalEditor.VisualStudioCode) {\n    return ExternalEditor.VisualStudioCode\n  }\n  if (label === ExternalEditor.VisualStudioCodeInsiders) {\n    return ExternalEditor.VisualStudioCodeInsiders\n  }\n  if (label === ExternalEditor.SublimeText) {\n    return ExternalEditor.SublimeText\n  }\n  if (label === ExternalEditor.CFBuilder) {\n    return ExternalEditor.CFBuilder\n  }\n  if (label === ExternalEditor.Typora) {\n    return ExternalEditor.Typora\n  }\n\n  return null\n}\n\n/**\n * Resolve a set of registry keys associated with the installed application.\n *\n * This is because some tools (like VSCode) may support a 64-bit or 32-bit\n * version of the tool - we should use whichever they have installed.\n *\n * @param editor The external editor that may be installed locally.\n */\nfunction getRegistryKeys(\n  editor: ExternalEditor\n): ReadonlyArray<{ key: HKEY; subKey: string }> {\n  switch (editor) {\n    case ExternalEditor.Atom:\n      return [\n        {\n          key: HKEY.HKEY_CURRENT_USER,\n          subKey:\n            'SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\atom',\n        },\n      ]\n    case ExternalEditor.VisualStudioCode:\n      return [\n        // 64-bit version of VSCode (user) - provided by default in 64-bit Windows\n        {\n          key: HKEY.HKEY_CURRENT_USER,\n          subKey:\n            'SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\{771FD6B0-FA20-440A-A002-3B3BAC16DC50}_is1',\n        },\n        // 32-bit version of VSCode (user)\n        {\n          key: HKEY.HKEY_CURRENT_USER,\n          subKey:\n            'SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\{D628A17A-9713-46BF-8D57-E671B46A741E}_is1',\n        },\n        // 64-bit version of VSCode (system) - was default before user scope installation\n        {\n          key: HKEY.HKEY_LOCAL_MACHINE,\n          subKey:\n            'SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\{EA457B21-F73E-494C-ACAB-524FDE069978}_is1',\n        },\n        // 32-bit version of VSCode (system)\n        {\n          key: HKEY.HKEY_LOCAL_MACHINE,\n          subKey:\n            'SOFTWARE\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\{F8A2A208-72B3-4D61-95FC-8A65D340689B}_is1',\n        },\n      ]\n    case ExternalEditor.VisualStudioCodeInsiders:\n      return [\n        // 64-bit version of VSCode (user) - provided by default in 64-bit Windows\n        {\n          key: HKEY.HKEY_CURRENT_USER,\n          subKey:\n            'SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\{217B4C08-948D-4276-BFBB-BEE930AE5A2C}_is1',\n        },\n        // 32-bit version of VSCode (user)\n        {\n          key: HKEY.HKEY_CURRENT_USER,\n          subKey:\n            'SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\{26F4A15E-E392-4887-8C09-7BC55712FD5B}_is1',\n        },\n        // 64-bit version of VSCode (system) - was default before user scope installation\n        {\n          key: HKEY.HKEY_LOCAL_MACHINE,\n          subKey:\n            'SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\{1287CAD5-7C8D-410D-88B9-0D1EE4A83FF2}_is1',\n        },\n        // 32-bit version of VSCode (system)\n        {\n          key: HKEY.HKEY_LOCAL_MACHINE,\n          subKey:\n            'SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\{C26E74D1-022E-4238-8B9D-1E7564A36CC9}_is1',\n        },\n      ]\n    case ExternalEditor.SublimeText:\n      return [\n        {\n          key: HKEY.HKEY_LOCAL_MACHINE,\n          subKey:\n            'SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\Sublime Text 3_is1',\n        },\n      ]\n    case ExternalEditor.CFBuilder:\n      return [\n        // 64-bit version of ColdFusionBuilder3\n        {\n          key: HKEY.HKEY_LOCAL_MACHINE,\n          subKey:\n            'SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\Adobe ColdFusion Builder 3_is1',\n        },\n        // 64-bit version of ColdFusionBuilder2016\n        {\n          key: HKEY.HKEY_LOCAL_MACHINE,\n          subKey:\n            'SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\Adobe ColdFusion Builder 2016',\n        },\n      ]\n    case ExternalEditor.Typora:\n      return [\n        // 64-bit version of Typora\n        {\n          key: HKEY.HKEY_LOCAL_MACHINE,\n          subKey:\n            'SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\{37771A20-7167-44C0-B322-FD3E54C56156}_is1',\n        },\n        // 32-bit version of Typora\n        {\n          key: HKEY.HKEY_LOCAL_MACHINE,\n          subKey:\n            'SOFTWARE\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\{37771A20-7167-44C0-B322-FD3E54C56156}_is1',\n        },\n      ]\n\n    default:\n      return assertNever(editor, `Unknown external editor: ${editor}`)\n  }\n}\n\n/**\n * Resolve the command-line interface for the editor.\n *\n * @param editor The external editor which is installed\n * @param installLocation The known install location of the editor\n */\nfunction getExecutableShim(\n  editor: ExternalEditor,\n  installLocation: string\n): string {\n  switch (editor) {\n    case ExternalEditor.Atom:\n      return Path.join(installLocation, 'bin', 'atom.cmd')\n    case ExternalEditor.VisualStudioCode:\n      return Path.join(installLocation, 'bin', 'code.cmd')\n    case ExternalEditor.VisualStudioCodeInsiders:\n      return Path.join(installLocation, 'bin', 'code-insiders.cmd')\n    case ExternalEditor.SublimeText:\n      return Path.join(installLocation, 'subl.exe')\n    case ExternalEditor.CFBuilder:\n      return Path.join(installLocation, 'CFBuilder.exe')\n    case ExternalEditor.Typora:\n      return Path.join(installLocation, 'bin', 'typora.exe')\n    default:\n      return assertNever(editor, `Unknown external editor: ${editor}`)\n  }\n}\n\n/**\n * Confirm the found installation matches the expected identifier details\n *\n * @param editor The external editor\n * @param displayName The display name as listed in the registry\n * @param publisher The publisher who created the installer\n */\nfunction isExpectedInstallation(\n  editor: ExternalEditor,\n  displayName: string,\n  publisher: string\n): boolean {\n  switch (editor) {\n    case ExternalEditor.Atom:\n      return displayName === 'Atom' && publisher === 'GitHub Inc.'\n    case ExternalEditor.VisualStudioCode:\n      return (\n        displayName.startsWith('Microsoft Visual Studio Code') &&\n        publisher === 'Microsoft Corporation'\n      )\n    case ExternalEditor.VisualStudioCodeInsiders:\n      return (\n        displayName.startsWith('Microsoft Visual Studio Code Insiders') &&\n        publisher === 'Microsoft Corporation'\n      )\n    case ExternalEditor.SublimeText:\n      return (\n        displayName === 'Sublime Text' && publisher === 'Sublime HQ Pty Ltd'\n      )\n    case ExternalEditor.CFBuilder:\n      return (\n        (displayName === 'Adobe ColdFusion Builder 3' ||\n          displayName === 'Adobe ColdFusion Builder 2016') &&\n        publisher === 'Adobe Systems Incorporated'\n      )\n    case ExternalEditor.Typora:\n      return displayName.startsWith('Typora') && publisher === 'typora.io'\n    default:\n      return assertNever(editor, `Unknown external editor: ${editor}`)\n  }\n}\n\nfunction getKeyOrEmpty(\n  keys: ReadonlyArray<RegistryValue>,\n  key: string\n): string {\n  const entry = keys.find(k => k.name === key)\n  return entry && entry.type === RegistryValueType.REG_SZ ? entry.data : ''\n}\n\n/**\n * Map the registry information to a list of known installer fields.\n *\n * @param editor The external editor being resolved\n * @param keys The collection of registry key-value pairs\n */\nfunction extractApplicationInformation(\n  editor: ExternalEditor,\n  keys: ReadonlyArray<RegistryValue>\n): { displayName: string; publisher: string; installLocation: string } {\n  if (editor === ExternalEditor.Atom) {\n    const displayName = getKeyOrEmpty(keys, 'DisplayName')\n    const publisher = getKeyOrEmpty(keys, 'Publisher')\n    const installLocation = getKeyOrEmpty(keys, 'InstallLocation')\n    return { displayName, publisher, installLocation }\n  }\n\n  if (\n    editor === ExternalEditor.VisualStudioCode ||\n    editor === ExternalEditor.VisualStudioCodeInsiders\n  ) {\n    const displayName = getKeyOrEmpty(keys, 'DisplayName')\n    const publisher = getKeyOrEmpty(keys, 'Publisher')\n    const installLocation = getKeyOrEmpty(keys, 'InstallLocation')\n    return { displayName, publisher, installLocation }\n  }\n\n  if (editor === ExternalEditor.SublimeText) {\n    let displayName = ''\n    let publisher = ''\n    let installLocation = ''\n\n    for (const item of keys) {\n      // NOTE:\n      // Sublime Text appends the build number to the DisplayName value, so for\n      // forward-compatibility let's do a simple check for the identifier\n      if (\n        item.name === 'DisplayName' &&\n        item.type === RegistryValueType.REG_SZ &&\n        item.data.startsWith('Sublime Text')\n      ) {\n        displayName = 'Sublime Text'\n      } else if (\n        item.name === 'Publisher' &&\n        item.type === RegistryValueType.REG_SZ\n      ) {\n        publisher = item.data\n      } else if (\n        item.name === 'InstallLocation' &&\n        item.type === RegistryValueType.REG_SZ\n      ) {\n        installLocation = item.data\n      }\n    }\n\n    return { displayName, publisher, installLocation }\n  }\n\n  if (editor === ExternalEditor.CFBuilder) {\n    const displayName = getKeyOrEmpty(keys, 'DisplayName')\n    const publisher = getKeyOrEmpty(keys, 'Publisher')\n    const installLocation = getKeyOrEmpty(keys, 'InstallLocation')\n    return { displayName, publisher, installLocation }\n  }\n\n  if (editor === ExternalEditor.Typora) {\n    const displayName = getKeyOrEmpty(keys, 'DisplayName')\n    const publisher = getKeyOrEmpty(keys, 'Publisher')\n    const installLocation = getKeyOrEmpty(keys, 'InstallLocation')\n    return { displayName, publisher, installLocation }\n  }\n\n  return assertNever(editor, `Unknown external editor: ${editor}`)\n}\n\nasync function findApplication(editor: ExternalEditor): Promise<string | null> {\n  const registryKeys = getRegistryKeys(editor)\n\n  let keys: ReadonlyArray<RegistryValue> = []\n  for (const { key, subKey } of registryKeys) {\n    keys = enumerateValues(key, subKey)\n    if (keys.length > 0) {\n      break\n    }\n  }\n\n  if (keys.length === 0) {\n    return null\n  }\n\n  const {\n    displayName,\n    publisher,\n    installLocation,\n  } = extractApplicationInformation(editor, keys)\n\n  if (!isExpectedInstallation(editor, displayName, publisher)) {\n    log.debug(\n      `Registry entry for ${editor} did not match expected publisher settings`\n    )\n    return null\n  }\n\n  const path = getExecutableShim(editor, installLocation)\n  const exists = await pathExists(path)\n  if (!exists) {\n    log.debug(`Command line interface for ${editor} not found at '${path}'`)\n    return null\n  }\n\n  return path\n}\n\n/**\n * Lookup known external editors using the Windows registry to find installed\n * applications and their location on disk for Desktop to launch.\n */\nexport async function getAvailableEditors(): Promise<\n  ReadonlyArray<IFoundEditor<ExternalEditor>>\n> {\n  const results: Array<IFoundEditor<ExternalEditor>> = []\n\n  const [\n    atomPath,\n    codePath,\n    codeInsidersPath,\n    sublimePath,\n    cfBuilderPath,\n    typoraPath,\n  ] = await Promise.all([\n    findApplication(ExternalEditor.Atom),\n    findApplication(ExternalEditor.VisualStudioCode),\n    findApplication(ExternalEditor.VisualStudioCodeInsiders),\n    findApplication(ExternalEditor.SublimeText),\n    findApplication(ExternalEditor.CFBuilder),\n    findApplication(ExternalEditor.Typora),\n  ])\n\n  if (atomPath) {\n    results.push({\n      editor: ExternalEditor.Atom,\n      path: atomPath,\n    })\n  }\n\n  if (codePath) {\n    results.push({\n      editor: ExternalEditor.VisualStudioCode,\n      path: codePath,\n    })\n  }\n\n  if (codeInsidersPath) {\n    results.push({\n      editor: ExternalEditor.VisualStudioCodeInsiders,\n      path: codeInsidersPath,\n    })\n  }\n\n  if (sublimePath) {\n    results.push({\n      editor: ExternalEditor.SublimeText,\n      path: sublimePath,\n    })\n  }\n\n  if (cfBuilderPath) {\n    results.push({\n      editor: ExternalEditor.CFBuilder,\n      path: cfBuilderPath,\n    })\n  }\n\n  if (typoraPath) {\n    results.push({\n      editor: ExternalEditor.Typora,\n      path: typoraPath,\n    })\n  }\n\n  return results\n}\n","'use strict';\nconst execa = require('execa');\n\nfunction tweakErr(err) {\n\tif (err.code === 2) {\n\t\terr.message = 'Couldn\\'t find the app';\n\t}\n\n\tthrow err;\n}\n\nmodule.exports = app => {\n\tif (process.platform !== 'darwin') {\n\t\treturn Promise.reject(new Error('macOS only'));\n\t}\n\n\tif (typeof app !== 'string') {\n\t\treturn Promise.reject(new Error('Please supply an app name or bundle identifier'));\n\t}\n\n\treturn execa.stdout('./main', [app], {cwd: __dirname}).catch(tweakErr);\n};\n\nmodule.exports.sync = app => {\n\tif (process.platform !== 'darwin') {\n\t\tthrow new Error('macOS only');\n\t}\n\n\tif (typeof app !== 'string') {\n\t\tthrow new Error('Please supply an app name or bundle identifier');\n\t}\n\n\tlet stdout = '';\n\n\ttry {\n\t\tstdout = execa.sync('./main', [app], {cwd: __dirname}).stdout;\n\t} catch (err) {\n\t\ttweakErr(err);\n\t}\n\n\treturn stdout;\n};\n","import * as Path from 'path'\nimport { pathExists } from 'fs-extra'\nimport { IFoundEditor } from './found-editor'\nimport { assertNever } from '../fatal-error'\n\nexport enum ExternalEditor {\n  Atom = 'Atom',\n  MacVim = 'MacVim',\n  VisualStudioCode = 'Visual Studio Code',\n  VisualStudioCodeInsiders = 'Visual Studio Code (Insiders)',\n  SublimeText = 'Sublime Text',\n  BBEdit = 'BBEdit',\n  PhpStorm = 'PhpStorm',\n  RubyMine = 'RubyMine',\n  TextMate = 'TextMate',\n  Brackets = 'Brackets',\n  WebStorm = 'WebStorm',\n  Typora = 'Typora',\n}\n\nexport function parse(label: string): ExternalEditor | null {\n  if (label === ExternalEditor.Atom) {\n    return ExternalEditor.Atom\n  }\n  if (label === ExternalEditor.MacVim) {\n    return ExternalEditor.MacVim\n  }\n  if (label === ExternalEditor.VisualStudioCode) {\n    return ExternalEditor.VisualStudioCode\n  }\n  if (label === ExternalEditor.VisualStudioCodeInsiders) {\n    return ExternalEditor.VisualStudioCodeInsiders\n  }\n  if (label === ExternalEditor.SublimeText) {\n    return ExternalEditor.SublimeText\n  }\n  if (label === ExternalEditor.BBEdit) {\n    return ExternalEditor.BBEdit\n  }\n  if (label === ExternalEditor.PhpStorm) {\n    return ExternalEditor.PhpStorm\n  }\n  if (label === ExternalEditor.RubyMine) {\n    return ExternalEditor.RubyMine\n  }\n  if (label === ExternalEditor.TextMate) {\n    return ExternalEditor.TextMate\n  }\n  if (label === ExternalEditor.Brackets) {\n    return ExternalEditor.Brackets\n  }\n  if (label === ExternalEditor.WebStorm) {\n    return ExternalEditor.WebStorm\n  }\n  if (label === ExternalEditor.Typora) {\n    return ExternalEditor.Typora\n  }\n  return null\n}\n\n/**\n * appPath will raise an error if it cannot find the program.\n */\nconst appPath: (bundleId: string) => Promise<string> = require('app-path')\n\nfunction getBundleIdentifiers(editor: ExternalEditor): ReadonlyArray<string> {\n  switch (editor) {\n    case ExternalEditor.Atom:\n      return ['com.github.atom']\n    case ExternalEditor.MacVim:\n      return ['org.vim.MacVim']\n    case ExternalEditor.VisualStudioCode:\n      return ['com.microsoft.VSCode']\n    case ExternalEditor.VisualStudioCodeInsiders:\n      return ['com.microsoft.VSCodeInsiders']\n    case ExternalEditor.SublimeText:\n      return ['com.sublimetext.3']\n    case ExternalEditor.BBEdit:\n      return ['com.barebones.bbedit']\n    case ExternalEditor.PhpStorm:\n      return ['com.jetbrains.PhpStorm']\n    case ExternalEditor.RubyMine:\n      return ['com.jetbrains.RubyMine']\n    case ExternalEditor.TextMate:\n      return ['com.macromates.TextMate']\n    case ExternalEditor.Brackets:\n      return ['io.brackets.appshell']\n    case ExternalEditor.WebStorm:\n      return ['com.jetbrains.WebStorm']\n    case ExternalEditor.Typora:\n      return ['abnerworks.Typora']\n    default:\n      return assertNever(editor, `Unknown external editor: ${editor}`)\n  }\n}\n\nfunction getExecutableShim(\n  editor: ExternalEditor,\n  installPath: string\n): string {\n  switch (editor) {\n    case ExternalEditor.Atom:\n      return Path.join(installPath, 'Contents', 'Resources', 'app', 'atom.sh')\n    case ExternalEditor.VisualStudioCode:\n    case ExternalEditor.VisualStudioCodeInsiders:\n      return Path.join(\n        installPath,\n        'Contents',\n        'Resources',\n        'app',\n        'bin',\n        'code'\n      )\n    case ExternalEditor.MacVim:\n      return Path.join(installPath, 'Contents', 'MacOS', 'MacVim')\n    case ExternalEditor.SublimeText:\n      return Path.join(installPath, 'Contents', 'SharedSupport', 'bin', 'subl')\n    case ExternalEditor.BBEdit:\n      return Path.join(installPath, 'Contents', 'Helpers', 'bbedit_tool')\n    case ExternalEditor.PhpStorm:\n      return Path.join(installPath, 'Contents', 'MacOS', 'phpstorm')\n    case ExternalEditor.RubyMine:\n      return Path.join(installPath, 'Contents', 'MacOS', 'rubymine')\n    case ExternalEditor.TextMate:\n      return Path.join(installPath, 'Contents', 'Resources', 'mate')\n    case ExternalEditor.Brackets:\n      return Path.join(installPath, 'Contents', 'MacOS', 'Brackets')\n    case ExternalEditor.WebStorm:\n      return Path.join(installPath, 'Contents', 'MacOS', 'WebStorm')\n    case ExternalEditor.Typora:\n      return Path.join(installPath, 'Contents', 'MacOS', 'Typora')\n    default:\n      return assertNever(editor, `Unknown external editor: ${editor}`)\n  }\n}\n\nasync function findApplication(editor: ExternalEditor): Promise<string | null> {\n  const identifiers = getBundleIdentifiers(editor)\n  for (const identifier of identifiers) {\n    try {\n      const installPath = await appPath(identifier)\n      const path = getExecutableShim(editor, installPath)\n      const exists = await pathExists(path)\n      if (exists) {\n        return path\n      }\n\n      log.debug(`Command line interface for ${editor} not found at '${path}'`)\n    } catch (error) {\n      log.debug(`Unable to locate ${editor} installation`, error)\n    }\n  }\n\n  return null\n}\n\n/**\n * Lookup known external editors using the bundle ID that each uses\n * to register itself on a user's machine when installing.\n */\nexport async function getAvailableEditors(): Promise<\n  ReadonlyArray<IFoundEditor<ExternalEditor>>\n> {\n  const results: Array<IFoundEditor<ExternalEditor>> = []\n\n  const [\n    atomPath,\n    macVimPath,\n    codePath,\n    codeInsidersPath,\n    sublimePath,\n    bbeditPath,\n    phpStormPath,\n    rubyMinePath,\n    textMatePath,\n    bracketsPath,\n    webStormPath,\n    typoraPath,\n  ] = await Promise.all([\n    findApplication(ExternalEditor.Atom),\n    findApplication(ExternalEditor.MacVim),\n    findApplication(ExternalEditor.VisualStudioCode),\n    findApplication(ExternalEditor.VisualStudioCodeInsiders),\n    findApplication(ExternalEditor.SublimeText),\n    findApplication(ExternalEditor.BBEdit),\n    findApplication(ExternalEditor.PhpStorm),\n    findApplication(ExternalEditor.RubyMine),\n    findApplication(ExternalEditor.TextMate),\n    findApplication(ExternalEditor.Brackets),\n    findApplication(ExternalEditor.WebStorm),\n    findApplication(ExternalEditor.Typora),\n  ])\n\n  if (atomPath) {\n    results.push({ editor: ExternalEditor.Atom, path: atomPath })\n  }\n\n  if (macVimPath) {\n    results.push({ editor: ExternalEditor.MacVim, path: macVimPath })\n  }\n\n  if (codePath) {\n    results.push({ editor: ExternalEditor.VisualStudioCode, path: codePath })\n  }\n\n  if (codeInsidersPath) {\n    results.push({\n      editor: ExternalEditor.VisualStudioCodeInsiders,\n      path: codeInsidersPath,\n    })\n  }\n\n  if (sublimePath) {\n    results.push({ editor: ExternalEditor.SublimeText, path: sublimePath })\n  }\n\n  if (bbeditPath) {\n    results.push({ editor: ExternalEditor.BBEdit, path: bbeditPath })\n  }\n\n  if (phpStormPath) {\n    results.push({ editor: ExternalEditor.PhpStorm, path: phpStormPath })\n  }\n\n  if (rubyMinePath) {\n    results.push({ editor: ExternalEditor.RubyMine, path: rubyMinePath })\n  }\n\n  if (textMatePath) {\n    results.push({ editor: ExternalEditor.TextMate, path: textMatePath })\n  }\n\n  if (bracketsPath) {\n    results.push({ editor: ExternalEditor.Brackets, path: bracketsPath })\n  }\n\n  if (webStormPath) {\n    results.push({ editor: ExternalEditor.WebStorm, path: webStormPath })\n  }\n\n  if (typoraPath) {\n    results.push({ editor: ExternalEditor.Typora, path: typoraPath })\n  }\n\n  return results\n}\n","import { ExternalEditor, ExternalEditorError } from './shared'\nimport { IFoundEditor } from './found-editor'\nimport { getAvailableEditors as getAvailableEditorsDarwin } from './darwin'\nimport { getAvailableEditors as getAvailableEditorsWindows } from './win32'\nimport { getAvailableEditors as getAvailableEditorsLinux } from './linux'\n\nlet editorCache: ReadonlyArray<IFoundEditor<ExternalEditor>> | null = null\n\n/**\n * Resolve a list of installed editors on the user's machine, using the known\n * install identifiers that each OS supports.\n */\nexport async function getAvailableEditors(): Promise<\n  ReadonlyArray<IFoundEditor<ExternalEditor>>\n> {\n  if (editorCache && editorCache.length > 0) {\n    return editorCache\n  }\n\n  if (__DARWIN__) {\n    editorCache = await getAvailableEditorsDarwin()\n    return editorCache\n  }\n\n  if (__WIN32__) {\n    editorCache = await getAvailableEditorsWindows()\n    return editorCache\n  }\n\n  if (__LINUX__) {\n    editorCache = await getAvailableEditorsLinux()\n    return editorCache\n  }\n\n  log.warn(\n    `Platform not currently supported for resolving editors: ${\n      process.platform\n    }`\n  )\n\n  return []\n}\n\n/**\n * Find an editor installed on the machine using the friendly name, or the\n * first valid editor if `null` is provided.\n *\n * Will throw an error if no editors are found, or if the editor name cannot\n * be found (i.e. it has been removed).\n */\nexport async function findEditorOrDefault(\n  name: string | null\n): Promise<IFoundEditor<ExternalEditor>> {\n  const editors = await getAvailableEditors()\n  if (editors.length === 0) {\n    throw new ExternalEditorError(\n      'No suitable editors installed for GitHub Desktop to launch. Install Atom for your platform and restart GitHub Desktop to try again.',\n      { suggestAtom: true }\n    )\n  }\n\n  if (name) {\n    const match = editors.find(p => p.editor === name) || null\n    if (!match) {\n      const menuItemName = __DARWIN__ ? 'Preferences' : 'Options'\n      const message = `The editor '${name}' could not be found. Please open ${menuItemName} and choose an available editor.`\n\n      throw new ExternalEditorError(message, { openPreferences: true })\n    }\n\n    return match\n  }\n\n  return editors[0]\n}\n","export * from './lookup'\nexport * from './launch'\nexport { ExternalEditor, parse } from './shared'\n","/** The owner of a GitHubRepository. */\nexport class Owner {\n  /**\n   * @param id The database ID. This may be null if the object wasn't retrieved from the database.\n   */\n  public constructor(\n    public readonly login: string,\n    public readonly endpoint: string,\n    public readonly id: number | null\n  ) {}\n\n  /**\n   * A hash of the properties of the object.\n   *\n   * Objects with the same hash are guaranteed to be structurally equal.\n   */\n  public get hash(): string {\n    return `${this.login}+${this.endpoint}+${this.id}`\n  }\n}\n","import { Owner } from './owner'\n\n/** A GitHub repository. */\nexport class GitHubRepository {\n  /**\n   * The ID of the repository in the app's local database. This is no relation\n   * to the API ID.\n   *\n   * May be `null` if it hasn't been inserted or retrieved from the database.\n   */\n  public readonly dbID: number | null\n\n  public readonly name: string\n  public readonly owner: Owner\n  public readonly private: boolean | null\n  public readonly htmlURL: string | null\n  public readonly defaultBranch: string | null\n  public readonly cloneURL: string | null\n  public readonly parent: GitHubRepository | null\n\n  public constructor(\n    name: string,\n    owner: Owner,\n    dbID: number | null,\n    private_: boolean | null = null,\n    htmlURL: string | null = null,\n    defaultBranch: string | null = 'master',\n    cloneURL: string | null = null,\n    parent: GitHubRepository | null = null\n  ) {\n    this.name = name\n    this.owner = owner\n    this.dbID = dbID\n    this.private = private_\n    this.htmlURL = htmlURL\n    this.defaultBranch = defaultBranch\n    this.cloneURL = cloneURL\n    this.parent = parent\n  }\n\n  public get endpoint(): string {\n    return this.owner.endpoint\n  }\n\n  /** Get the owner/name combo. */\n  public get fullName(): string {\n    return `${this.owner.login}/${this.name}`\n  }\n\n  /** Is the repository a fork? */\n  public get fork(): boolean {\n    return !!this.parent\n  }\n\n  /**\n   * A hash of the properties of the object.\n   *\n   * Objects with the same hash are guaranteed to be structurally equal.\n   */\n  public get hash(): string {\n    return `${this.dbID}+\n      ${this.defaultBranch}+\n      ${this.private}+\n      ${this.cloneURL}+\n      ${this.name}+\n      ${this.htmlURL}+\n      ${this.owner.hash}+\n      ${this.parent && this.parent.hash}`\n  }\n}\n","import { Account } from '../models/account'\n\n/** Get the auth key for the user. */\nexport function getKeyForAccount(account: Account): string {\n  return getKeyForEndpoint(account.endpoint)\n}\n\n/** Get the auth key for the endpoint. */\nexport function getKeyForEndpoint(endpoint: string): string {\n  const appName = __DEV__ ? 'GitHub Desktop Dev' : 'GitHub'\n\n  return `${appName} - ${endpoint}`\n}\n","import * as React from 'react'\nimport { Octicon, OcticonSymbol } from '../octicons'\nimport { assertNever } from '../../lib/fatal-error'\nimport { ToolbarButton, ToolbarButtonStyle } from './button'\nimport { rectEquals } from '../lib/rect'\nimport * as classNames from 'classnames'\n\nexport type DropdownState = 'open' | 'closed'\n\nexport interface IToolbarDropdownProps {\n  /** The primary button text, describing its function */\n  readonly title?: string\n\n  /** An optional description of the function of the button */\n  readonly description?: string | JSX.Element\n\n  /** The tooltip for the button. */\n  readonly tooltip?: string\n\n  /** An optional symbol to be displayed next to the button text */\n  readonly icon?: OcticonSymbol\n\n  /**\n   * The state for of the drop down button.\n   */\n  readonly dropdownState: DropdownState\n\n  /**\n   * An event handler for when the drop down is opened, or closed, by a pointer\n   * event or by pressing the space or enter key while focused.\n   *\n   * @param state    - The new state of the drop down\n   * @param source   - Whether the state change was caused by a keyboard or\n   *                   pointer interaction.\n   */\n  readonly onDropdownStateChanged: (\n    state: DropdownState,\n    source: 'keyboard' | 'pointer'\n  ) => void\n\n  /**\n   * A function that's called when the user hovers over the button with\n   * a pointer device. Note that this only fires for mouse events inside\n   * the button and not when hovering content inside the foldout.\n   */\n  readonly onMouseEnter?: (event: React.MouseEvent<HTMLButtonElement>) => void\n\n  /**\n   * A function that's called when a key event is received from the\n   * ToolbarDropDown component or any of its descendants.\n   *\n   * Consumers of this event should not act on the event if the event has\n   * had its default action prevented by an earlier consumer that's called\n   * the preventDefault method on the event instance.\n   */\n  readonly onKeyDown?: (event: React.KeyboardEvent<HTMLDivElement>) => void\n\n  /**\n   * An render callback for when the dropdown is open.\n   * Use this to render the contents of the fold out.\n   */\n  readonly dropdownContentRenderer: () => JSX.Element | null\n\n  /**\n   * An optional classname that will be appended to the default\n   * class name 'toolbar-button dropdown open|closed'\n   */\n  readonly className?: string\n\n  /** The class name for the icon element. */\n  readonly iconClassName?: string\n\n  /** The button's style. Defaults to `ToolbarButtonStyle.Standard`. */\n  readonly style?: ToolbarButtonStyle\n\n  /**\n   * Sets the styles for the dropdown's foldout. Useful for custom positioning\n   * and sizes.\n   */\n  readonly foldoutStyle?: React.CSSProperties\n\n  /**\n   * Whether the button should displays its disclosure arrow. Defaults to true.\n   */\n  readonly showDisclosureArrow?: boolean\n\n  /** Whether the button is disabled. Defaults to false. */\n  readonly disabled?: boolean\n\n  /**\n   * The tab index of the button element.\n   *\n   * A value of 'undefined' means that whether or not the element participates\n   * in sequential keyboard navigation is left to the user agent's default\n   * settings.\n   *\n   * A negative value means that the element can receive focus but not\n   * through sequential keyboard navigation (i.e. only via programmatic\n   * focus)\n   *\n   * A value of zero means that the element can receive focus through\n   * sequential keyboard navigation and that the order should be determined\n   * by the element's position in the DOM.\n   *\n   * A positive value means that the element can receive focus through\n   * sequential keyboard navigation and that it should have the explicit\n   * order provided and not have it be determined by its position in the DOM.\n   *\n   * Note: A positive value should be avoided if at all possible as it's\n   * detrimental to accessibility in most scenarios.\n   */\n  readonly tabIndex?: number\n\n  /**\n   * An optional progress value as a fraction between 0 and 1. Passing a number\n   * greater than zero will render a progress bar background in the toolbar\n   * button. Use this to communicate an ongoing operation.\n   *\n   * Consumers should not rely solely on the visual progress bar, they should\n   * also implement alternative representation such as showing a percentage\n   * text in the description or title along with information about what\n   * operation is currently in flight.\n   */\n  readonly progressValue?: number\n\n  readonly role?: string\n  readonly buttonRole?: string\n}\n\ninterface IToolbarDropdownState {\n  readonly clientRect: ClientRect | null\n}\n\n/**\n * A toolbar dropdown button\n */\nexport class ToolbarDropdown extends React.Component<\n  IToolbarDropdownProps,\n  IToolbarDropdownState\n> {\n  private innerButton: ToolbarButton | null = null\n\n  public constructor(props: IToolbarDropdownProps) {\n    super(props)\n    this.state = { clientRect: null }\n  }\n\n  private get isOpen() {\n    return this.props.dropdownState === 'open'\n  }\n\n  private dropdownIcon(state: DropdownState): OcticonSymbol {\n    // @TODO: Remake triangle octicon in a 12px version,\n    // right now it's scaled badly on normal dpi monitors.\n    if (state === 'open') {\n      return OcticonSymbol.triangleUp\n    } else if (state === 'closed') {\n      return OcticonSymbol.triangleDown\n    } else {\n      return assertNever(state, `Unknown dropdown state ${state}`)\n    }\n  }\n\n  private renderDropdownArrow(): JSX.Element | null {\n    if (this.props.showDisclosureArrow === false) {\n      return null\n    }\n\n    const state = this.props.dropdownState\n\n    return (\n      <Octicon symbol={this.dropdownIcon(state)} className=\"dropdownArrow\" />\n    )\n  }\n\n  private onClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n    const newState: DropdownState =\n      this.props.dropdownState === 'open' ? 'closed' : 'open'\n\n    // This is probably one of the hackiest things I've ever done.\n    // We need to be able to determine whether the button was clicked\n    // using a pointer device or activated by pressing Enter or Space.\n    // The problem is that button onClick events fire with a mouse event\n    // regardless of whether they were activated with a key press or a\n    // pointer device. So far, the only way I've been able to tell the\n    // two apart is that keyboard derived clicks don't have a pointer\n    // position.\n    const source = !event.clientX && !event.clientY ? 'keyboard' : 'pointer'\n\n    this.props.onDropdownStateChanged(newState, source)\n  }\n\n  private updateClientRectIfNecessary() {\n    if (this.props.dropdownState === 'open' && this.innerButton) {\n      const newRect = this.innerButton.getButtonBoundingClientRect()\n      if (newRect) {\n        const currentRect = this.state.clientRect\n\n        if (!currentRect || !rectEquals(currentRect, newRect)) {\n          this.setState({ clientRect: newRect })\n        }\n      }\n    }\n  }\n\n  public componentDidMount() {\n    this.updateClientRectIfNecessary()\n  }\n\n  public componentWillUnmount() {\n    this.innerButton = null\n  }\n\n  public componentDidUpdate() {\n    this.updateClientRectIfNecessary()\n  }\n\n  private handleOverlayClick = () => {\n    this.props.onDropdownStateChanged('closed', 'pointer')\n  }\n\n  private getFoldoutContainerStyle(): React.CSSProperties | undefined {\n    const rect = this.state.clientRect\n    if (!rect) {\n      return undefined\n    }\n\n    return {\n      position: 'absolute',\n      top: rect.bottom,\n      left: 0,\n      width: '100%',\n      height: `calc(100% - ${rect.bottom}px)`,\n    }\n  }\n\n  private getFoldoutStyle(): React.CSSProperties | undefined {\n    if (this.props.foldoutStyle) {\n      return this.props.foldoutStyle\n    }\n\n    const rect = this.state.clientRect\n    if (!rect) {\n      return undefined\n    }\n\n    return {\n      position: 'absolute',\n      marginLeft: rect.left,\n      minWidth: rect.width,\n      height: '100%',\n      top: 0,\n    }\n  }\n\n  private onFoldoutKeyDown = (event: React.KeyboardEvent<HTMLElement>) => {\n    if (!event.defaultPrevented && this.isOpen && event.key === 'Escape') {\n      event.preventDefault()\n      this.props.onDropdownStateChanged('closed', 'keyboard')\n    }\n  }\n\n  private renderDropdownContents = (): JSX.Element | null => {\n    if (this.props.dropdownState !== 'open') {\n      return null\n    }\n\n    // The overlay has a -1 tab index because if it doesn't then focus will be put\n    // on the body element when someone clicks on it and that causes the app menu\n    // bar to instantly close before even receiving the onDropdownStateChanged\n    // event from us.\n    return (\n      <div id=\"foldout-container\" style={this.getFoldoutContainerStyle()}>\n        <div\n          className=\"overlay\"\n          tabIndex={-1}\n          onClick={this.handleOverlayClick}\n        />\n        <div\n          className=\"foldout\"\n          style={this.getFoldoutStyle()}\n          onKeyDown={this.onFoldoutKeyDown}\n        >\n          {this.props.dropdownContentRenderer()}\n        </div>\n      </div>\n    )\n  }\n\n  private onRef = (ref: ToolbarButton | null) => {\n    this.innerButton = ref\n  }\n\n  /**\n   * Programmatically move keyboard focus to the button element.\n   */\n  public focusButton = () => {\n    if (this.innerButton) {\n      this.innerButton.focusButton()\n    }\n  }\n\n  public render() {\n    const className = classNames(\n      'toolbar-dropdown',\n      this.props.dropdownState,\n      this.props.className\n    )\n\n    const ariaExpanded = this.props.dropdownState === 'open' ? 'true' : 'false'\n\n    return (\n      <div\n        className={className}\n        onKeyDown={this.props.onKeyDown}\n        role={this.props.role}\n        aria-expanded={ariaExpanded}\n      >\n        {this.renderDropdownContents()}\n        <ToolbarButton\n          ref={this.onRef}\n          icon={this.props.icon}\n          title={this.props.title}\n          description={this.props.description}\n          tooltip={this.props.tooltip}\n          onClick={this.onClick}\n          onMouseEnter={this.props.onMouseEnter}\n          style={this.props.style}\n          iconClassName={this.props.iconClassName}\n          disabled={this.props.disabled}\n          tabIndex={this.props.tabIndex}\n          progressValue={this.props.progressValue}\n          role={this.props.buttonRole}\n        >\n          {this.props.children}\n          {this.renderDropdownArrow()}\n        </ToolbarButton>\n      </div>\n    )\n  }\n}\n","export * from './toolbar'\nexport * from './button'\nexport * from './dropdown'\nexport * from './push-pull-button'\nexport * from './branch-dropdown'\nexport { RevertProgress } from './revert-progress'\n","import * as React from 'react'\nimport { Branch, BranchType } from '../../models/branch'\n\nimport { Row } from './row'\nimport { Octicon, OcticonSymbol } from '../octicons'\nimport { Ref } from './ref'\n\nexport function renderBranchNameWarning(\n  proposedName: string,\n  sanitizedName: string\n) {\n  if (proposedName.length > 0 && /^\\s*$/.test(sanitizedName)) {\n    return (\n      <Row className=\"warning-helper-text\">\n        <Octicon symbol={OcticonSymbol.alert} />\n        <p>\n          <Ref>{proposedName}</Ref> is not a valid branch name.\n        </p>\n      </Row>\n    )\n  } else if (proposedName !== sanitizedName) {\n    return (\n      <Row className=\"warning-helper-text\">\n        <Octicon symbol={OcticonSymbol.alert} />\n        <p>\n          Will be created as <Ref>{sanitizedName}</Ref>.\n        </p>\n      </Row>\n    )\n  } else {\n    return null\n  }\n}\nexport function renderBranchHasRemoteWarning(branch: Branch) {\n  if (branch.upstream != null) {\n    return (\n      <Row className=\"warning-helper-text\">\n        <Octicon symbol={OcticonSymbol.alert} />\n        <p>\n          This branch is tracking <Ref>{branch.upstream}</Ref> and renaming this\n          branch will not change the branch name on the remote.\n        </p>\n      </Row>\n    )\n  } else {\n    return null\n  }\n}\n\nexport function renderBranchNameExistsOnRemoteWarning(\n  sanitizedName: string,\n  branches: ReadonlyArray<Branch>\n) {\n  const alreadyExistsOnRemote =\n    branches.findIndex(\n      b => b.nameWithoutRemote === sanitizedName && b.type === BranchType.Remote\n    ) > -1\n\n  if (alreadyExistsOnRemote === false) {\n    return null\n  }\n\n  return (\n    <Row className=\"warning-helper-text\">\n      <Octicon symbol={OcticonSymbol.alert} />\n      <p>\n        A branch named <Ref>{sanitizedName}</Ref> already exists on the remote.\n      </p>\n    </Row>\n  )\n}\n","// See https://www.kernel.org/pub/software/scm/git/docs/git-check-ref-format.html\n// ASCII Control chars and space, DEL, ~ ^ : ? * [ \\\n// | \" < and > is technically a valid refname but not on Windows\n// the magic sequence @{, consecutive dots, leading and trailing dot, ref ending in .lock\nconst invalidCharacterRegex = /[\\x00-\\x20\\x7F~^:?*\\[\\\\|\"\"<>]+|@{|\\.\\.+|^\\.|\\.$|\\.lock$|\\/$/g\n\n/** Sanitize a proposed branch name by replacing illegal characters. */\nexport function sanitizedBranchName(name: string): string {\n  return name.replace(invalidCharacterRegex, '-').replace(/^[-\\+]*/g, '')\n}\n\n/** Validate a branch does not contain any invalid characters */\nexport function testForInvalidChars(name: string): boolean {\n  return invalidCharacterRegex.test(name)\n}\n","import * as React from 'react'\nimport { Octicon, OcticonSymbol } from '../octicons'\nimport { assertNever } from '../../lib/fatal-error'\nimport * as classNames from 'classnames'\nimport { MergeResultStatus } from '../../lib/app-state'\nimport { MergeResultKind } from '../../models/merge'\n\ninterface IMergeStatusIconProps {\n  /** The classname for the underlying element. */\n  readonly className?: string\n\n  /** The status to display. */\n  readonly status: MergeResultStatus | null\n}\n\n/** The little CI status indicator. */\nexport class MergeStatusHeader extends React.Component<\n  IMergeStatusIconProps,\n  {}\n> {\n  public render() {\n    const { status } = this.props\n    if (status === null) {\n      return null\n    }\n\n    const state = status.kind\n\n    return (\n      <div className=\"merge-status-icon-container\">\n        <Octicon\n          className={classNames(\n            'merge-status',\n            `merge-status-${state}`,\n            this.props.className\n          )}\n          symbol={getSymbolForState(state)}\n        />\n      </div>\n    )\n  }\n}\n\nfunction getSymbolForState(status: MergeResultKind): OcticonSymbol {\n  switch (status) {\n    case MergeResultKind.Loading:\n      return OcticonSymbol.primitiveDot\n    case MergeResultKind.Conflicts:\n      return OcticonSymbol.alert\n    case MergeResultKind.Invalid:\n      return OcticonSymbol.x\n    case MergeResultKind.Clean:\n      return OcticonSymbol.check\n  }\n\n  return assertNever(status, `Unknown state: ${JSON.stringify(status)}`)\n}\n","import * as React from 'react'\nimport * as moment from 'moment'\n\nimport { IMatches } from '../../lib/fuzzy-find'\n\nimport { Octicon, OcticonSymbol } from '../octicons'\nimport { HighlightText } from '../lib/highlight-text'\n\ninterface IBranchListItemProps {\n  /** The name of the branch */\n  readonly name: string\n\n  /** Specifies whether this item is currently selected */\n  readonly isCurrentBranch: boolean\n\n  /** The date may be null if we haven't loaded the tip commit yet. */\n  readonly lastCommitDate: Date | null\n\n  /** The characters in the branch name to highlight */\n  readonly matches: IMatches\n}\n\n/** The branch component. */\nexport class BranchListItem extends React.Component<IBranchListItemProps, {}> {\n  public render() {\n    const lastCommitDate = this.props.lastCommitDate\n    const isCurrentBranch = this.props.isCurrentBranch\n    const name = this.props.name\n\n    const date = lastCommitDate ? moment(lastCommitDate).fromNow() : ''\n    const icon = isCurrentBranch ? OcticonSymbol.check : OcticonSymbol.gitBranch\n    const infoTitle = isCurrentBranch\n      ? 'Current branch'\n      : lastCommitDate\n        ? lastCommitDate.toString()\n        : ''\n    return (\n      <div className=\"branches-list-item\">\n        <Octicon className=\"icon\" symbol={icon} />\n        <div className=\"name\" title={name}>\n          <HighlightText text={name} highlight={this.props.matches.title} />\n        </div>\n        <div className=\"description\" title={infoTitle}>\n          {date}\n        </div>\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\n\nimport { Branch } from '../../models/branch'\n\nimport { IBranchListItem } from './group-branches'\nimport { BranchListItem } from './branch-list-item'\nimport { IMatches } from '../../lib/fuzzy-find'\n\nexport function renderDefaultBranch(\n  item: IBranchListItem,\n  matches: IMatches,\n  currentBranch: Branch | null\n): JSX.Element {\n  const branch = item.branch\n  const commit = branch.tip\n  const currentBranchName = currentBranch ? currentBranch.name : null\n  return (\n    <BranchListItem\n      name={branch.name}\n      isCurrentBranch={branch.name === currentBranchName}\n      lastCommitDate={commit ? commit.author.date : null}\n      matches={matches}\n    />\n  )\n}\n","import { APIRefState } from '../lib/api'\nimport { GitHubRepository } from './github-repository'\n\nexport class PullRequestRef {\n  /**\n   * @param ref The name of the ref.\n   * @param sha The SHA of the ref.\n   * @param gitHubRepository The GitHub repository in which this ref lives. It could be null if the\n   *                         repository was deleted after the PR was opened.\n   */\n  public constructor(\n    public readonly ref: string,\n    public readonly sha: string,\n    public readonly gitHubRepository: GitHubRepository | null\n  ) {}\n}\n\n/** The commit status and metadata for a given ref */\nexport interface ICommitStatus {\n  readonly id: number\n  readonly state: APIRefState\n  readonly description: string\n}\n\nexport class PullRequestStatus {\n  /**\n   * @param pullRequestNumber The pull request this status is associated with.\n   * @param state The status' state.\n   * @param totalCount The number of statuses represented in this combined status.\n   * @param sha The SHA for which this status applies.\n   * @param statuses The list of all statuses for a specific ref.\n   */\n  public constructor(\n    public readonly pullRequestNumber: number,\n    public readonly state: APIRefState,\n    public readonly totalCount: number,\n    public readonly sha: string,\n    public readonly statuses: ReadonlyArray<ICommitStatus>\n  ) {}\n}\n\nexport class PullRequest {\n  /**\n   * @param id The database ID.\n   * @param created The date on which the PR was created.\n   * @param status The status of the PR. This will be `null` if we haven't looked up its\n   *               status yet or if an error occurred while looking it up.\n   * @param title The title of the PR.\n   * @param number The number.\n   * @param head The ref from which the pull request's changes are coming.\n   * @param base The ref which the pull request is targetting.\n   * @param author The author's login.\n   */\n  public constructor(\n    public readonly id: number,\n    public readonly created: Date,\n    public readonly status: PullRequestStatus | null,\n    public readonly title: string,\n    public readonly pullRequestNumber: number,\n    public readonly head: PullRequestRef,\n    public readonly base: PullRequestRef,\n    public readonly author: string\n  ) {}\n}\n","import * as React from 'react'\nimport { Octicon, OcticonSymbol } from '../octicons'\nimport { APIRefState } from '../../lib/api'\nimport { assertNever } from '../../lib/fatal-error'\nimport * as classNames from 'classnames'\nimport { PullRequestStatus } from '../../models/pull-request'\nimport { getPRStatusSummary } from './pull-request-status'\n\ninterface ICIStatusProps {\n  /** The classname for the underlying element. */\n  readonly className?: string\n\n  /** The status to display. */\n  readonly status: PullRequestStatus\n}\n\n/** The little CI status indicator. */\nexport class CIStatus extends React.Component<ICIStatusProps, {}> {\n  public render() {\n    const status = this.props.status\n    const title = getPRStatusSummary(status)\n    const state = status.state\n\n    return (\n      <Octicon\n        className={classNames(\n          'ci-status',\n          `ci-status-${state}`,\n          this.props.className\n        )}\n        symbol={getSymbolForState(state)}\n        title={title}\n      />\n    )\n  }\n}\n\nfunction getSymbolForState(state: APIRefState): OcticonSymbol {\n  switch (state) {\n    case 'pending':\n      return OcticonSymbol.primitiveDot\n    case 'failure':\n      return OcticonSymbol.x\n    case 'success':\n      return OcticonSymbol.check\n  }\n\n  return assertNever(state, `Unknown state: ${state}`)\n}\n","import * as React from 'react'\nimport * as moment from 'moment'\nimport * as classNames from 'classnames'\nimport { Octicon, OcticonSymbol } from '../octicons'\nimport { CIStatus } from './ci-status'\nimport { PullRequestStatus } from '../../models/pull-request'\nimport { HighlightText } from '../lib/highlight-text'\nimport { IMatches } from '../../lib/fuzzy-find'\n\nexport interface IPullRequestListItemProps {\n  /** The title. */\n  readonly title: string\n\n  /** The number as received from the API. */\n  readonly number: number\n\n  /** The date on which the PR was opened. */\n  readonly created: Date\n\n  /** The author login. */\n  readonly author: string\n\n  /** The CI status. */\n  readonly status: PullRequestStatus | null\n\n  /**\n   * Whether or not this list item is a skeleton item\n   * put in place while the pull request information is\n   * being loaded. This adds a special 'loading' class\n   * to the container and prevents any text from rendering\n   * inside the list item.\n   */\n  readonly loading?: boolean\n\n  /** The characters in the PR title to highlight */\n  readonly matches: IMatches\n}\n\n/** Pull requests as rendered in the Pull Requests list. */\nexport class PullRequestListItem extends React.Component<\n  IPullRequestListItemProps\n> {\n  private getSubtitle() {\n    if (this.props.loading === true) {\n      return undefined\n    }\n\n    const timeAgo = moment(this.props.created).fromNow()\n    return `#${this.props.number} opened ${timeAgo} by ${this.props.author}`\n  }\n\n  public render() {\n    const title = this.props.loading === true ? undefined : this.props.title\n    const subtitle = this.getSubtitle()\n    const matches = this.props.matches\n    const className = classNames('pull-request-item', {\n      loading: this.props.loading === true,\n    })\n\n    return (\n      <div className={className}>\n        <Octicon className=\"icon\" symbol={OcticonSymbol.gitPullRequest} />\n        <div className=\"info\">\n          <div className=\"title\" title={title}>\n            <HighlightText text={title || ''} highlight={matches.title} />\n          </div>\n          <div className=\"subtitle\" title={subtitle}>\n            <HighlightText text={subtitle || ''} highlight={matches.subtitle} />\n          </div>\n        </div>\n        {this.renderPullRequestStatus()}\n      </div>\n    )\n  }\n\n  private renderPullRequestStatus() {\n    const status = this.props.status\n\n    if (!status || status.totalCount === 0) {\n      return null\n    }\n\n    return <CIStatus status={status} />\n  }\n}\n","import * as React from 'react'\nimport * as moment from 'moment'\nimport {\n  FilterList,\n  IFilterListGroup,\n  IFilterListItem,\n  SelectionSource,\n} from '../lib/filter-list'\nimport { PullRequestListItem } from './pull-request-list-item'\nimport { PullRequest, PullRequestStatus } from '../../models/pull-request'\nimport { NoPullRequests } from './no-pull-requests'\nimport { IMatches } from '../../lib/fuzzy-find'\n\ninterface IPullRequestListItem extends IFilterListItem {\n  readonly id: string\n  readonly text: ReadonlyArray<string>\n  readonly pullRequest: PullRequest\n}\n\nexport const RowHeight = 47\n\ninterface IPullRequestListProps {\n  /** The pull requests to display. */\n  readonly pullRequests: ReadonlyArray<PullRequest>\n\n  /** The currently selected pull request */\n  readonly selectedPullRequest: PullRequest | null\n\n  /** The name of the repository. */\n  readonly repositoryName: string\n\n  /** Is the default branch currently checked out? */\n  readonly isOnDefaultBranch: boolean\n\n  /** The current filter text to render */\n  readonly filterText: string\n\n  /** Called when the user clicks on a pull request. */\n  readonly onItemClick: (pullRequest: PullRequest) => void\n\n  /** Called when the user wants to dismiss the foldout. */\n  readonly onDismiss: () => void\n\n  /** Callback to fire when the filter text is changed */\n  readonly onFilterTextChanged: (filterText: string) => void\n\n  /** Called when the user opts to create a branch */\n  readonly onCreateBranch: () => void\n\n  /** Called when the user opts to create a pull request */\n  readonly onCreatePullRequest: () => void\n\n  /** Callback fired when user selects a new pull request */\n  readonly onSelectionChanged?: (\n    pullRequest: PullRequest | null,\n    source: SelectionSource\n  ) => void\n\n  /**\n   * Called when a key down happens in the filter field. Users have a chance to\n   * respond or cancel the default behavior by calling `preventDefault`.\n   */\n  readonly onFilterKeyDown?: (\n    event: React.KeyboardEvent<HTMLInputElement>\n  ) => void\n}\n\ninterface IPullRequestListState {\n  readonly groupedItems: ReadonlyArray<IFilterListGroup<IPullRequestListItem>>\n  readonly selectedItem: IPullRequestListItem | null\n}\n\nfunction resolveSelectedItem(\n  group: IFilterListGroup<IPullRequestListItem>,\n  props: IPullRequestListProps,\n  currentlySelectedItem: IPullRequestListItem | null\n): IPullRequestListItem | null {\n  let selectedItem: IPullRequestListItem | null = null\n\n  if (props.selectedPullRequest != null) {\n    selectedItem = findItemForPullRequest(group, props.selectedPullRequest)\n  }\n\n  if (selectedItem == null && currentlySelectedItem != null) {\n    selectedItem = findItemForPullRequest(\n      group,\n      currentlySelectedItem.pullRequest\n    )\n  }\n\n  return selectedItem\n}\n\n/** The list of open pull requests. */\nexport class PullRequestList extends React.Component<\n  IPullRequestListProps,\n  IPullRequestListState\n> {\n  public constructor(props: IPullRequestListProps) {\n    super(props)\n\n    const group = createListItems(props.pullRequests)\n    const selectedItem = resolveSelectedItem(group, props, null)\n\n    this.state = {\n      groupedItems: [group],\n      selectedItem,\n    }\n  }\n\n  public componentWillReceiveProps(nextProps: IPullRequestListProps) {\n    const group = createListItems(nextProps.pullRequests)\n    const selectedItem = resolveSelectedItem(\n      group,\n      nextProps,\n      this.state.selectedItem\n    )\n    this.setState({ groupedItems: [group], selectedItem })\n  }\n\n  public render() {\n    return (\n      <FilterList<IPullRequestListItem>\n        className=\"pull-request-list\"\n        rowHeight={RowHeight}\n        groups={this.state.groupedItems}\n        selectedItem={this.state.selectedItem}\n        renderItem={this.renderPullRequest}\n        filterText={this.props.filterText}\n        onFilterTextChanged={this.props.onFilterTextChanged}\n        invalidationProps={this.props.pullRequests}\n        onItemClick={this.onItemClick}\n        onSelectionChanged={this.onSelectionChanged}\n        onFilterKeyDown={this.props.onFilterKeyDown}\n        renderNoItems={this.renderNoItems}\n      />\n    )\n  }\n\n  private renderNoItems = () => {\n    return (\n      <NoPullRequests\n        isSearch={this.props.filterText.length > 0}\n        repositoryName={this.props.repositoryName}\n        isOnDefaultBranch={this.props.isOnDefaultBranch}\n        onCreateBranch={this.props.onCreateBranch}\n        onCreatePullRequest={this.props.onCreatePullRequest}\n      />\n    )\n  }\n\n  private renderPullRequest = (\n    item: IPullRequestListItem,\n    matches: IMatches\n  ) => {\n    const pr = item.pullRequest\n    const refStatuses = pr.status != null ? pr.status.statuses : []\n    const status =\n      pr.status != null\n        ? new PullRequestStatus(\n            pr.pullRequestNumber,\n            pr.status.state,\n            pr.status.totalCount,\n            pr.status.sha,\n            refStatuses\n          )\n        : null\n\n    return (\n      <PullRequestListItem\n        title={pr.title}\n        number={pr.pullRequestNumber}\n        created={pr.created}\n        author={pr.author}\n        status={status}\n        matches={matches}\n      />\n    )\n  }\n\n  private onItemClick = (item: IPullRequestListItem) => {\n    if (this.props.onItemClick) {\n      this.props.onItemClick(item.pullRequest)\n    }\n  }\n\n  private onSelectionChanged = (\n    selectedItem: IPullRequestListItem | null,\n    source: SelectionSource\n  ) => {\n    if (this.props.onSelectionChanged) {\n      this.props.onSelectionChanged(\n        selectedItem != null ? selectedItem.pullRequest : null,\n        source\n      )\n    }\n  }\n}\n\nfunction getSubtitle(pr: PullRequest) {\n  const timeAgo = moment(pr.created).fromNow()\n  return `#${pr.pullRequestNumber} opened ${timeAgo} by ${pr.author}`\n}\n\nfunction createListItems(\n  pullRequests: ReadonlyArray<PullRequest>\n): IFilterListGroup<IPullRequestListItem> {\n  const items = pullRequests.map(pr => ({\n    text: [pr.title, getSubtitle(pr)],\n    id: pr.pullRequestNumber.toString(),\n    pullRequest: pr,\n  }))\n\n  return {\n    identifier: 'pull-requests',\n    items,\n  }\n}\n\nfunction findItemForPullRequest(\n  group: IFilterListGroup<IPullRequestListItem>,\n  pullRequest: PullRequest\n): IPullRequestListItem | null {\n  return (\n    group.items.find(\n      i => i.pullRequest.pullRequestNumber === pullRequest.pullRequestNumber\n    ) || null\n  )\n}\n","/** The Branches foldout tabs. */\nexport enum BranchesTab {\n  Branches = 0,\n  PullRequests,\n}\n","import { Branch } from '../../models/branch'\nimport { IFilterListGroup, IFilterListItem } from '../lib/filter-list'\n\nexport type BranchGroupIdentifier = 'default' | 'recent' | 'other'\n\nexport interface IBranchListItem extends IFilterListItem {\n  readonly text: ReadonlyArray<string>\n  readonly id: string\n  readonly branch: Branch\n}\n\nexport function groupBranches(\n  defaultBranch: Branch | null,\n  currentBranch: Branch | null,\n  allBranches: ReadonlyArray<Branch>,\n  recentBranches: ReadonlyArray<Branch>\n): ReadonlyArray<IFilterListGroup<IBranchListItem>> {\n  const groups = new Array<IFilterListGroup<IBranchListItem>>()\n\n  if (defaultBranch) {\n    groups.push({\n      identifier: 'default',\n      items: [\n        {\n          text: [defaultBranch.name],\n          id: defaultBranch.name,\n          branch: defaultBranch,\n        },\n      ],\n    })\n  }\n\n  const recentBranchNames = new Set<string>()\n  const defaultBranchName = defaultBranch ? defaultBranch.name : null\n  const recentBranchesWithoutDefault = recentBranches.filter(\n    b => b.name !== defaultBranchName\n  )\n  if (recentBranchesWithoutDefault.length > 0) {\n    const recentBranches = new Array<IBranchListItem>()\n\n    for (const branch of recentBranchesWithoutDefault) {\n      recentBranches.push({\n        text: [branch.name],\n        id: branch.name,\n        branch,\n      })\n      recentBranchNames.add(branch.name)\n    }\n\n    groups.push({\n      identifier: 'recent',\n      items: recentBranches,\n    })\n  }\n\n  const remainingBranches = allBranches.filter(\n    b => b.name !== defaultBranchName && !recentBranchNames.has(b.name)\n  )\n  const remainingItems = remainingBranches.map(b => ({\n    text: [b.name],\n    id: b.name,\n    branch: b,\n  }))\n  groups.push({\n    identifier: 'other',\n    items: remainingItems,\n  })\n\n  return groups\n}\n","import * as React from 'react'\n\nimport { Branch } from '../../models/branch'\n\nimport { assertNever } from '../../lib/fatal-error'\n\nimport {\n  FilterList,\n  IFilterListGroup,\n  SelectionSource,\n} from '../lib/filter-list'\nimport { IMatches } from '../../lib/fuzzy-find'\nimport { Button } from '../lib/button'\nimport { TextBox } from '../lib/text-box'\n\nimport {\n  groupBranches,\n  IBranchListItem,\n  BranchGroupIdentifier,\n} from './group-branches'\nimport { NoBranches } from './no-branches'\n\nconst RowHeight = 30\n\ninterface IBranchListProps {\n  /**\n   * See IBranchesState.defaultBranch\n   */\n  readonly defaultBranch: Branch | null\n\n  /**\n   * The currently checked out branch or null if HEAD is detached\n   */\n  readonly currentBranch: Branch | null\n\n  /**\n   * See IBranchesState.allBranches\n   */\n  readonly allBranches: ReadonlyArray<Branch>\n\n  /**\n   * See IBranchesState.recentBranches\n   */\n  readonly recentBranches: ReadonlyArray<Branch>\n\n  /**\n   * The currently selected branch in the list, see the onSelectionChanged prop.\n   */\n  readonly selectedBranch: Branch | null\n\n  /**\n   * Called when a key down happens in the filter field. Users have a chance to\n   * respond or cancel the default behavior by calling `preventDefault`.\n   */\n  readonly onFilterKeyDown?: (\n    event: React.KeyboardEvent<HTMLInputElement>\n  ) => void\n\n  /** Called when an item is clicked. */\n  readonly onItemClick?: (item: Branch) => void\n\n  /**\n   * This function will be called when the selection changes as a result of a\n   * user keyboard or mouse action (i.e. not when props change). This function\n   * will not be invoked when an already selected row is clicked on.\n   *\n   * @param selectedItem - The Branch that was just selected\n   * @param source       - The kind of user action that provoked the change,\n   *                       either a pointer device press, or a keyboard event\n   *                       (arrow up/down)\n   */\n  readonly onSelectionChanged?: (\n    selectedItem: Branch | null,\n    source: SelectionSource\n  ) => void\n\n  /** The current filter text to render */\n  readonly filterText: string\n\n  /** Callback to fire when the filter text is changed */\n  readonly onFilterTextChanged: (filterText: string) => void\n\n  /** Can users create a new branch? */\n  readonly canCreateNewBranch: boolean\n\n  /**\n   * Called when the user wants to create a new branch. It will be given a name\n   * to prepopulate the new branch name field.\n   */\n  readonly onCreateNewBranch?: (name: string) => void\n\n  readonly textbox?: TextBox\n\n  /**\n   * Render function to apply to each branch in the list\n   */\n  readonly renderBranch: (\n    item: IBranchListItem,\n    matches: IMatches\n  ) => JSX.Element\n\n  /**\n   * Callback to fire when the items in the filter list are updated\n   */\n  readonly onFilterListResultsChanged?: (resultCount: number) => void\n}\n\ninterface IBranchListState {\n  /**\n   * The grouped list of branches.\n   *\n   * Groups are currently defined as 'default branch', 'current branch',\n   * 'recent branches' and all branches.\n   */\n  readonly groups: ReadonlyArray<IFilterListGroup<IBranchListItem>>\n\n  /** The selected item in the filtered list */\n  readonly selectedItem: IBranchListItem | null\n}\n\nfunction createState(props: IBranchListProps): IBranchListState {\n  const groups = groupBranches(\n    props.defaultBranch,\n    props.currentBranch,\n    props.allBranches,\n    props.recentBranches\n  )\n\n  let selectedItem: IBranchListItem | null = null\n  const selectedBranch = props.selectedBranch\n  if (selectedBranch) {\n    for (const group of groups) {\n      selectedItem =\n        group.items.find(i => {\n          const branch = i.branch\n          return branch.name === selectedBranch.name\n        }) || null\n\n      if (selectedItem) {\n        break\n      }\n    }\n  }\n\n  return { groups, selectedItem }\n}\n\n/** The Branches list component. */\nexport class BranchList extends React.Component<\n  IBranchListProps,\n  IBranchListState\n> {\n  private branchFilterList: FilterList<IBranchListItem> | null = null\n\n  public constructor(props: IBranchListProps) {\n    super(props)\n    this.state = createState(props)\n  }\n\n  public componentWillReceiveProps(nextProps: IBranchListProps) {\n    this.setState(createState(nextProps))\n  }\n\n  public selectFirstItem(focus: boolean = false) {\n    if (this.branchFilterList !== null) {\n      this.branchFilterList.selectFirstItem(focus)\n    }\n  }\n\n  public render() {\n    return (\n      <FilterList<IBranchListItem>\n        ref={this.onBranchesFilterListRef}\n        className=\"branches-list\"\n        rowHeight={RowHeight}\n        filterText={this.props.filterText}\n        onFilterTextChanged={this.props.onFilterTextChanged}\n        onFilterKeyDown={this.props.onFilterKeyDown}\n        selectedItem={this.state.selectedItem}\n        renderItem={this.renderItem}\n        renderGroupHeader={this.renderGroupHeader}\n        onItemClick={this.onItemClick}\n        onSelectionChanged={this.onSelectionChanged}\n        groups={this.state.groups}\n        invalidationProps={this.props.allBranches}\n        renderPostFilter={this.onRenderNewButton}\n        renderNoItems={this.onRenderNoItems}\n        filterTextBox={this.props.textbox}\n        onFilterListResultsChanged={this.props.onFilterListResultsChanged}\n      />\n    )\n  }\n\n  private onBranchesFilterListRef = (\n    filterList: FilterList<IBranchListItem> | null\n  ) => {\n    this.branchFilterList = filterList\n  }\n\n  private renderItem = (item: IBranchListItem, matches: IMatches) => {\n    return this.props.renderBranch(item, matches)\n  }\n\n  private parseHeader(label: string): BranchGroupIdentifier | null {\n    switch (label) {\n      case 'default':\n      case 'recent':\n      case 'other':\n        return label\n      default:\n        return null\n    }\n  }\n\n  private renderGroupHeader = (label: string) => {\n    const identifier = this.parseHeader(label)\n\n    return identifier !== null ? (\n      <div className=\"branches-list-content filter-list-group-header\">\n        {this.getGroupLabel(identifier)}\n      </div>\n    ) : null\n  }\n\n  private getGroupLabel(identifier: BranchGroupIdentifier) {\n    if (identifier === 'default') {\n      return __DARWIN__ ? 'Default Branch' : 'Default branch'\n    } else if (identifier === 'recent') {\n      return __DARWIN__ ? 'Recent Branches' : 'Recent branches'\n    } else if (identifier === 'other') {\n      return __DARWIN__ ? 'Other Branches' : 'Other branches'\n    } else {\n      return assertNever(identifier, `Unknown identifier: ${identifier}`)\n    }\n  }\n\n  private onRenderNoItems = () => {\n    return (\n      <NoBranches\n        onCreateNewBranch={this.onCreateNewBranch}\n        canCreateNewBranch={this.props.canCreateNewBranch}\n      />\n    )\n  }\n\n  private onRenderNewButton = () => {\n    return this.props.canCreateNewBranch ? (\n      <Button className=\"new-branch-button\" onClick={this.onCreateNewBranch}>\n        {__DARWIN__ ? 'New Branch' : 'New branch'}\n      </Button>\n    ) : null\n  }\n\n  private onItemClick = (item: IBranchListItem) => {\n    if (this.props.onItemClick) {\n      this.props.onItemClick(item.branch)\n    }\n  }\n\n  private onSelectionChanged = (\n    selectedItem: IBranchListItem | null,\n    source: SelectionSource\n  ) => {\n    if (this.props.onSelectionChanged) {\n      this.props.onSelectionChanged(\n        selectedItem ? selectedItem.branch : null,\n        source\n      )\n    }\n  }\n\n  private onCreateNewBranch = () => {\n    if (this.props.onCreateNewBranch) {\n      this.props.onCreateNewBranch(this.props.filterText)\n    }\n  }\n}\n","import * as React from 'react'\nimport { Octicon, OcticonSymbol } from '../octicons'\n\ninterface IDialogHeaderProps {\n  /**\n   * The dialog title text. Will be rendered top and center in a dialog.\n   */\n  readonly title: string\n\n  /**\n   * An optional id for the h1 element that contains the title of this\n   * dialog. Used to aid in accessibility by allowing the h1 to be referenced\n   * in an aria-labeledby/aria-describedby attributed\n   */\n  readonly titleId?: string\n\n  /**\n   * Whether or not the implementing dialog is dismissable. This controls\n   * whether or not the dialog header renders a close button or not.\n   */\n  readonly dismissable: boolean\n\n  /**\n   * Event triggered when the dialog is dismissed by the user in the\n   * ways described in the dismissable prop.\n   */\n  readonly onDismissed?: () => void\n\n  /**\n   * Whether or not the dialog contents are currently involved in processing\n   * data, executing an asynchronous operation or by other means working.\n   * Setting this value will render a spinning progress icon in the header.\n   * Note that the spinning icon will temporarily replace the dialog icon\n   * (if present) for the duration of the loading operation.\n   */\n  readonly loading?: boolean\n}\n\n/**\n * A high-level component for Dialog headers.\n *\n * This component should typically not be used by consumers as the title prop\n * of the Dialog component should suffice. There are, however, cases where\n * custom content needs to be rendered in a dialog and in that scenario it\n * might be necessary to use this component directly.\n */\nexport class DialogHeader extends React.Component<IDialogHeaderProps, {}> {\n  private onCloseButtonClick = (e: React.MouseEvent<HTMLAnchorElement>) => {\n    if (this.props.onDismissed) {\n      this.props.onDismissed()\n    }\n  }\n\n  private renderCloseButton() {\n    if (!this.props.dismissable) {\n      return null\n    }\n\n    // We're intentionally using <a> here instead of <button> because\n    // we can't prevent chromium from giving it focus when the the dialog\n    // appears. Setting tabindex to -1 doesn't work. This might be a bug,\n    // I don't know and we may want to revisit it at some point but for\n    // now an anchor will have to do.\n    return (\n      <a className=\"close\" onClick={this.onCloseButtonClick}>\n        <Octicon symbol={OcticonSymbol.x} />\n      </a>\n    )\n  }\n\n  public render() {\n    const spinner = this.props.loading ? (\n      <Octicon className=\"icon spin\" symbol={OcticonSymbol.sync} />\n    ) : null\n\n    return (\n      <header className=\"dialog-header\">\n        <h1 id={this.props.titleId}>{this.props.title}</h1>\n        {spinner}\n        {this.renderCloseButton()}\n        {this.props.children}\n      </header>\n    )\n  }\n}\n","import * as React from 'react'\nimport { Commit } from '../../models/commit'\nimport { GitHubRepository } from '../../models/github-repository'\nimport { IAvatarUser, getAvatarUsersForCommit } from '../../models/avatar'\nimport { RichText } from '../lib/rich-text'\nimport { RelativeTime } from '../relative-time'\nimport { getDotComAPIEndpoint } from '../../lib/api'\nimport { clipboard } from 'electron'\nimport { showContextualMenu } from '../main-process-proxy'\nimport { CommitAttribution } from '../lib/commit-attribution'\nimport { IGitHubUser } from '../../lib/databases/github-user-database'\nimport { AvatarStack } from '../lib/avatar-stack'\nimport { IMenuItem } from '../../lib/menu-item'\n\ninterface ICommitProps {\n  readonly gitHubRepository: GitHubRepository | null\n  readonly commit: Commit\n  readonly emoji: Map<string, string>\n  readonly isLocal: boolean\n  readonly onRevertCommit?: (commit: Commit) => void\n  readonly onViewCommitOnGitHub?: (sha: string) => void\n  readonly gitHubUsers: Map<string, IGitHubUser> | null\n}\n\ninterface ICommitListItemState {\n  readonly avatarUsers: ReadonlyArray<IAvatarUser>\n}\n\n/** A component which displays a single commit in a commit list. */\nexport class CommitListItem extends React.Component<\n  ICommitProps,\n  ICommitListItemState\n> {\n  public constructor(props: ICommitProps) {\n    super(props)\n\n    this.state = {\n      avatarUsers: getAvatarUsersForCommit(\n        props.gitHubRepository,\n        props.gitHubUsers,\n        props.commit\n      ),\n    }\n  }\n\n  public componentWillReceiveProps(nextProps: ICommitProps) {\n    if (nextProps.commit !== this.props.commit) {\n      this.setState({\n        avatarUsers: getAvatarUsersForCommit(\n          nextProps.gitHubRepository,\n          nextProps.gitHubUsers,\n          nextProps.commit\n        ),\n      })\n    }\n  }\n\n  public render() {\n    const commit = this.props.commit\n    const author = commit.author\n\n    return (\n      <div className=\"commit\" onContextMenu={this.onContextMenu}>\n        <div className=\"info\">\n          <RichText\n            className=\"summary\"\n            emoji={this.props.emoji}\n            text={commit.summary}\n            renderUrlsAsLinks={false}\n          />\n          <div className=\"description\">\n            <AvatarStack users={this.state.avatarUsers} />\n            <div className=\"byline\">\n              <CommitAttribution\n                gitHubRepository={this.props.gitHubRepository}\n                commit={commit}\n              />{' '}\n              <RelativeTime date={author.date} />\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  public shouldComponentUpdate(nextProps: ICommitProps): boolean {\n    return this.props.commit.sha !== nextProps.commit.sha\n  }\n\n  private onCopySHA = () => {\n    clipboard.writeText(this.props.commit.sha)\n  }\n\n  private onViewOnGitHub = () => {\n    if (this.props.onViewCommitOnGitHub) {\n      this.props.onViewCommitOnGitHub(this.props.commit.sha)\n    }\n  }\n\n  private onContextMenu = (event: React.MouseEvent<any>) => {\n    event.preventDefault()\n\n    let viewOnGitHubLabel = 'View on GitHub'\n    const gitHubRepository = this.props.gitHubRepository\n\n    if (\n      gitHubRepository &&\n      gitHubRepository.endpoint !== getDotComAPIEndpoint()\n    ) {\n      viewOnGitHubLabel = 'View on GitHub Enterprise'\n    }\n\n    const items: IMenuItem[] = [\n      {\n        label: __DARWIN__ ? 'Revert This Commit' : 'Revert this commit',\n        action: () => {\n          if (this.props.onRevertCommit) {\n            this.props.onRevertCommit(this.props.commit)\n          }\n        },\n      },\n      { type: 'separator' },\n      {\n        label: 'Copy SHA',\n        action: this.onCopySHA,\n      },\n      {\n        label: viewOnGitHubLabel,\n        action: this.onViewOnGitHub,\n        enabled: !this.props.isLocal && !!gitHubRepository,\n      },\n    ]\n\n    showContextualMenu(items)\n  }\n}\n","export * from './resizable'\n","import { Commit } from '../../models/commit'\nimport * as React from 'react'\nimport { CommitIdentity } from '../../models/commit-identity'\nimport { GitAuthor } from '../../models/git-author'\nimport { GitHubRepository } from '../../models/github-repository'\n\ninterface ICommitAttributionProps {\n  /**\n   * The commit from where to extract the author, commiter\n   * and co-authors from.\n   */\n  readonly commit: Commit\n\n  /**\n   * The GitHub hosted repository that the given commit is\n   * associated with or null if repository is local or\n   * not associated with a GitHub account. Used to determine\n   * whether a commit is a special GitHub web flow user.\n   */\n  readonly gitHubRepository: GitHubRepository | null\n}\n\n/**\n * A component used for listing the authors involved in\n * a commit, formatting the content as close to what\n * GitHub.com does as possible.\n */\nexport class CommitAttribution extends React.Component<\n  ICommitAttributionProps,\n  {}\n> {\n  private renderAuthorInline(author: CommitIdentity | GitAuthor) {\n    return <span className=\"author\">{author.name}</span>\n  }\n\n  private renderAuthors(\n    authors: ReadonlyArray<CommitIdentity | GitAuthor>,\n    committerAttribution: boolean\n  ) {\n    if (authors.length === 1) {\n      return (\n        <span className=\"authors\">{this.renderAuthorInline(authors[0])}</span>\n      )\n    } else if (authors.length === 2 && !committerAttribution) {\n      return (\n        <span className=\"authors\">\n          {this.renderAuthorInline(authors[0])}\n          {' and '}\n          {this.renderAuthorInline(authors[1])}\n        </span>\n      )\n    } else {\n      const title = authors.map(a => a.name).join(', ')\n\n      return (\n        <span className=\"authors\" title={title}>\n          {authors.length} people\n        </span>\n      )\n    }\n  }\n\n  private renderCommitter(committer: CommitIdentity) {\n    return (\n      <span className=\"committer\">\n        {' and '}\n        {this.renderAuthorInline(committer)}\n        {' committed'}\n      </span>\n    )\n  }\n\n  public render() {\n    const commit = this.props.commit\n    const { author, committer, coAuthors } = commit\n\n    const authors: Array<CommitIdentity | GitAuthor> = [author, ...coAuthors]\n\n    const committerAttribution =\n      !commit.authoredByCommitter &&\n      !(\n        this.props.gitHubRepository !== null &&\n        commit.isWebFlowCommitter(this.props.gitHubRepository)\n      )\n\n    return (\n      <span className=\"commit-attribution-component\">\n        {this.renderAuthors(authors, committerAttribution)}\n        {committerAttribution ? ' authored' : ' committed'}\n        {committerAttribution ? this.renderCommitter(committer) : null}\n      </span>\n    )\n  }\n}\n","import * as React from 'react'\nimport * as classNames from 'classnames'\nimport { Avatar } from './avatar'\nimport { IAvatarUser } from '../../models/avatar'\n\n/**\n * The maximum number of avatars to stack before hiding\n * the rest behind the hover action. Note that changing this\n * means that the css needs to change as well.\n */\nconst MaxDisplayedAvatars = 3\n\ninterface IAvatarStackProps {\n  readonly users: ReadonlyArray<IAvatarUser>\n}\n\n/**\n * A component which renders one or more avatars into a stacked\n * view which expands on hover, replicated from github.com's\n * avatar stacks.\n */\nexport class AvatarStack extends React.Component<IAvatarStackProps, {}> {\n  public render() {\n    const elems = []\n    const users = this.props.users\n\n    for (let i = 0; i < this.props.users.length; i++) {\n      const user = users[i]\n\n      if (users.length > MaxDisplayedAvatars && i === MaxDisplayedAvatars - 1) {\n        elems.push(<div key=\"more\" className=\"avatar-more avatar\" />)\n      }\n\n      elems.push(\n        <Avatar key={`${i}${user.avatarURL}`} user={user} title={null} />\n      )\n    }\n\n    const className = classNames('AvatarStack', {\n      'AvatarStack--small': true,\n      'AvatarStack--two': users.length === 2,\n      'AvatarStack--three-plus': users.length >= MaxDisplayedAvatars,\n    })\n\n    return (\n      <div className={className}>\n        <div className=\"AvatarStack-body\">{elems}</div>\n      </div>\n    )\n  }\n}\n","import { IGitHubUser } from '../lib/databases/github-user-database'\nimport { Commit } from './commit'\nimport { CommitIdentity } from './commit-identity'\nimport { GitAuthor } from './git-author'\nimport { generateGravatarUrl } from '../lib/gravatar'\nimport { getDotComAPIEndpoint } from '../lib/api'\nimport { GitHubRepository } from './github-repository'\n\n/** The minimum properties we need in order to display a user's avatar. */\nexport interface IAvatarUser {\n  /** The user's email. */\n  readonly email: string\n\n  /** The user's avatar URL. */\n  readonly avatarURL: string\n\n  /** The user's name. */\n  readonly name: string\n}\n\nfunction getFallbackAvatarUrlForAuthor(\n  gitHubRepository: GitHubRepository | null,\n  author: CommitIdentity | GitAuthor\n) {\n  if (\n    gitHubRepository &&\n    gitHubRepository.endpoint === getDotComAPIEndpoint()\n  ) {\n    return `https://avatars.githubusercontent.com/u/e?email=${encodeURIComponent(\n      author.email\n    )}&s=60`\n  }\n\n  return generateGravatarUrl(author.email)\n}\n\nfunction getAvatarUserFromAuthor(\n  gitHubRepository: GitHubRepository | null,\n  gitHubUsers: Map<string, IGitHubUser> | null,\n  author: CommitIdentity | GitAuthor\n) {\n  const gitHubUser =\n    gitHubUsers === null\n      ? null\n      : gitHubUsers.get(author.email.toLowerCase()) || null\n\n  const avatarURL = gitHubUser\n    ? gitHubUser.avatarURL\n    : getFallbackAvatarUrlForAuthor(gitHubRepository, author)\n\n  return {\n    email: author.email,\n    name: author.name,\n    avatarURL,\n  }\n}\n\n/**\n * Attempt to look up avatars for all authors (and committer)\n * of a particular commit.\n *\n * Avatars are returned ordered, starting with the author, followed\n * by all co-authors and finally the committer (if different from\n * author).\n *\n * @param gitHubRepository\n * @param gitHubUsers\n * @param commit\n */\nexport function getAvatarUsersForCommit(\n  gitHubRepository: GitHubRepository | null,\n  gitHubUsers: Map<string, IGitHubUser> | null,\n  commit: Commit\n) {\n  const avatarUsers = []\n\n  avatarUsers.push(\n    getAvatarUserFromAuthor(gitHubRepository, gitHubUsers, commit.author)\n  )\n  avatarUsers.push(\n    ...commit.coAuthors.map(x =>\n      getAvatarUserFromAuthor(gitHubRepository, gitHubUsers, x)\n    )\n  )\n\n  const isWebFlowCommitter =\n    gitHubRepository !== null && commit.isWebFlowCommitter(gitHubRepository)\n\n  if (!commit.authoredByCommitter && !isWebFlowCommitter) {\n    avatarUsers.push(\n      getAvatarUserFromAuthor(gitHubRepository, gitHubUsers, commit.committer)\n    )\n  }\n\n  return avatarUsers\n}\n","/**\n * The area in pixels either side of the right-edge of the diff gutter to\n * detect when a group of lines should be highlighted, instead of a single line.\n */\nexport const RangeSelectionSizePixels = 10\n","import { DiffHunk, DiffLine } from '../../models/diff'\nimport * as CodeMirror from 'codemirror'\nimport { diffLineForIndex } from './diff-explorer'\nimport { ITokens } from '../../lib/highlighter/types'\n\nrequire('codemirror/mode/javascript/javascript')\n\nexport interface IDiffSyntaxModeOptions {\n  /**\n   * The unified diff representing the change\n   */\n  readonly hunks: ReadonlyArray<DiffHunk>\n\n  /**\n   * Tokens returned from the highlighter for the 'before'\n   * version of the change\n   */\n  readonly oldTokens: ITokens\n\n  /**\n   * Tokens returned from the highlighter for the 'after'\n   * version of the change\n   */\n  readonly newTokens: ITokens\n}\n\nexport interface IDiffSyntaxModeSpec extends IDiffSyntaxModeOptions {\n  readonly name: 'github-diff-syntax'\n}\n\nconst TokenNames: { [key: string]: string | null } = {\n  '+': 'diff-add',\n  '-': 'diff-delete',\n  '@': 'diff-hunk',\n  ' ': 'diff-context',\n}\n\ninterface IState {\n  diffLineIndex: number\n}\n\nfunction skipLine(stream: CodeMirror.StringStream, state: IState) {\n  stream.skipToEnd()\n  state.diffLineIndex++\n  return null\n}\n\n/**\n * Attempt to get tokens for a particular diff line. This will attempt\n * to look up tokens in both the old tokens and the new which is\n * important because for context lines we might only have tokens in\n * one version and we need to be resilient about that.\n */\nfunction getTokensForDiffLine(\n  diffLine: DiffLine,\n  oldTokens: ITokens | undefined,\n  newTokens: ITokens | undefined\n) {\n  // Note: Diff lines numbers start at one so we adjust this in order\n  // to get the line _index_ in the before or after file contents.\n  if (\n    oldTokens &&\n    diffLine.oldLineNumber &&\n    oldTokens[diffLine.oldLineNumber - 1]\n  ) {\n    return oldTokens[diffLine.oldLineNumber - 1]\n  }\n\n  if (\n    newTokens &&\n    diffLine.newLineNumber &&\n    newTokens[diffLine.newLineNumber - 1]\n  ) {\n    return newTokens[diffLine.newLineNumber - 1]\n  }\n\n  return null\n}\n\nexport class DiffSyntaxMode {\n  public static readonly ModeName = 'github-diff-syntax'\n\n  private readonly hunks?: ReadonlyArray<DiffHunk>\n  private readonly oldTokens?: ITokens\n  private readonly newTokens?: ITokens\n\n  public constructor(\n    hunks?: ReadonlyArray<DiffHunk>,\n    oldTokens?: ITokens,\n    newTokens?: ITokens\n  ) {\n    this.hunks = hunks\n    this.oldTokens = oldTokens\n    this.newTokens = newTokens\n  }\n\n  public startState(): IState {\n    return { diffLineIndex: 0 }\n  }\n\n  // Should never happen except for blank diffs but\n  // let's play along\n  public blankLine(state: IState) {\n    state.diffLineIndex++\n  }\n\n  public token = (\n    stream: CodeMirror.StringStream,\n    state: IState\n  ): string | null => {\n    // The first character of a line in a diff is always going to\n    // be the diff line marker so we always take care of that first.\n    if (stream.sol()) {\n      const index = stream.next()\n\n      if (stream.eol()) {\n        state.diffLineIndex++\n      }\n\n      const token = index ? TokenNames[index] : null\n\n      return token ? `line-${token} line-background-${token}` : null\n    }\n\n    // This happens when the mode is running without tokens, in this\n    // case there's really nothing more for us to do than what we've\n    // already done above to deal with the diff line marker.\n    if (this.hunks == null) {\n      return skipLine(stream, state)\n    }\n\n    const diffLine = diffLineForIndex(this.hunks, state.diffLineIndex)\n\n    if (!diffLine) {\n      return skipLine(stream, state)\n    }\n\n    const lineTokens = getTokensForDiffLine(\n      diffLine,\n      this.oldTokens,\n      this.newTokens\n    )\n\n    if (!lineTokens) {\n      return skipLine(stream, state)\n    }\n\n    // -1 because the diff line that we're looking at is always prefixed\n    // by +, -, @ or space depending on the type of diff line. Those markers\n    // are obviously not present in the before/after version.\n    const token = lineTokens[stream.pos - stream.lineStart - 1]\n\n    if (!token) {\n      // There's no token at the current position so let's skip ahead\n      // until we find one or we hit the end of the line. Note that we\n      // don't have to worry about already being at the end of the line\n      // as it's a requirement for modes to always advance the stream. In\n      // other words, CodeMirror will never give us a stream already at\n      // the end of a line.\n      do {\n        stream.pos++\n      } while (!stream.eol() && !lineTokens[stream.pos - stream.lineStart - 1])\n    } else {\n      stream.pos += token.length\n    }\n\n    if (stream.eol()) {\n      state.diffLineIndex++\n    }\n\n    return token ? token.token : null\n  }\n}\n\nCodeMirror.defineMode(DiffSyntaxMode.ModeName, function(\n  config: CodeMirror.EditorConfiguration,\n  modeOptions?: IDiffSyntaxModeOptions\n) {\n  if (!modeOptions) {\n    throw new Error('I needs me some options')\n  }\n\n  return new DiffSyntaxMode(\n    modeOptions.hunks,\n    modeOptions.oldTokens,\n    modeOptions.newTokens\n  )\n})\n","import * as React from 'react'\nimport { Editor } from 'codemirror'\n\nimport { assertNever } from '../../lib/fatal-error'\nimport { encodePathAsUrl } from '../../lib/path'\nimport { ImageDiffType } from '../../lib/app-state'\nimport { Dispatcher } from '../../lib/dispatcher/dispatcher'\n\nimport { Repository } from '../../models/repository'\nimport {\n  CommittedFileChange,\n  WorkingDirectoryFileChange,\n  AppFileStatus,\n} from '../../models/status'\nimport {\n  DiffSelection,\n  DiffType,\n  IDiff,\n  IImageDiff,\n  ITextDiff,\n  ILargeTextDiff,\n} from '../../models/diff'\n\nimport { Button } from '../lib/button'\n\nimport {\n  NewImageDiff,\n  ModifiedImageDiff,\n  DeletedImageDiff,\n} from './image-diffs'\nimport { BinaryFile } from './binary-file'\nimport { diffLineForIndex } from './diff-explorer'\nimport { DiffLineGutter } from './diff-line-gutter'\nimport { DiffSyntaxMode } from './diff-syntax-mode'\n\nimport { ISelectionStrategy } from './selection/selection-strategy'\nimport { TextDiff } from './text-diff'\n\n// image used when no diff is displayed\nconst NoDiffImage = encodePathAsUrl(__dirname, 'static/ufo-alert.svg')\n\ntype ChangedFile = WorkingDirectoryFileChange | CommittedFileChange\n\n/** The props for the Diff component. */\ninterface IDiffProps {\n  readonly repository: Repository\n\n  /**\n   * Whether the diff is readonly, e.g., displaying a historical diff, or the\n   * diff's lines can be selected, e.g., displaying a change in the working\n   * directory.\n   */\n  readonly readOnly: boolean\n\n  /** The file whose diff should be displayed. */\n  readonly file: ChangedFile\n\n  /** Called when the includedness of lines or a range of lines has changed. */\n  readonly onIncludeChanged?: (diffSelection: DiffSelection) => void\n\n  /** The diff that should be rendered */\n  readonly diff: IDiff\n\n  /** propagate errors up to the main application */\n  readonly dispatcher: Dispatcher\n\n  /** The type of image diff to display. */\n  readonly imageDiffType: ImageDiffType\n}\n\ninterface IDiffState {\n  readonly forceShowLargeDiff: boolean\n}\n\n/** A component which renders a diff for a file. */\nexport class Diff extends React.Component<IDiffProps, IDiffState> {\n  private codeMirror: Editor | null = null\n\n  /**\n   * Maintain the current state of the user interacting with the diff gutter\n   */\n  private selection: ISelectionStrategy | null = null\n\n  /**\n   *  a local cache of gutter elements, keyed by the row in the diff\n   */\n  private cachedGutterElements = new Map<number, DiffLineGutter>()\n\n  public constructor(props: IDiffProps) {\n    super(props)\n\n    this.state = {\n      forceShowLargeDiff: false,\n    }\n  }\n\n  public componentWillReceiveProps(nextProps: IDiffProps) {\n    const codeMirror = this.codeMirror\n\n    if (\n      codeMirror &&\n      nextProps.diff.kind === DiffType.Text &&\n      (this.props.diff.kind !== DiffType.Text ||\n        this.props.diff.text !== nextProps.diff.text)\n    ) {\n      codeMirror.setOption('mode', { name: DiffSyntaxMode.ModeName })\n    }\n\n    // HACK: This entire section is a hack. Whenever we receive\n    // props we update all currently visible gutter elements with\n    // the selection state from the file.\n    if (nextProps.file instanceof WorkingDirectoryFileChange) {\n      const selection = nextProps.file.selection\n      const oldSelection =\n        this.props.file instanceof WorkingDirectoryFileChange\n          ? this.props.file.selection\n          : null\n\n      // Nothing has changed\n      if (oldSelection === selection) {\n        return\n      }\n\n      const diff = nextProps.diff\n      this.cachedGutterElements.forEach((element, index) => {\n        if (!element) {\n          console.error('expected DOM element for diff gutter not found')\n          return\n        }\n\n        if (diff.kind === DiffType.Text) {\n          const line = diffLineForIndex(diff.hunks, index)\n          const isIncludable = line ? line.isIncludeableLine() : false\n          const isSelected = selection.isSelected(index) && isIncludable\n          element.setSelected(isSelected)\n        }\n      })\n    }\n  }\n\n  public render() {\n    const diff = this.props.diff\n\n    switch (diff.kind) {\n      case DiffType.Text:\n        return this.renderText(diff)\n      case DiffType.Binary:\n        return this.renderBinaryFile()\n      case DiffType.Image:\n        return this.renderImage(diff)\n      case DiffType.LargeText: {\n        return this.state.forceShowLargeDiff\n          ? this.renderLargeText(diff)\n          : this.renderLargeTextDiff()\n      }\n      case DiffType.Unrenderable:\n        return this.renderUnrenderableDiff()\n      default:\n        return assertNever(diff, `Unsupported diff type: ${diff}`)\n    }\n  }\n\n  /**\n   * Helper event listener, registered when starting a selection by\n   * clicking anywhere on or near the gutter. Immediately removes itself\n   * from the mouseup event on the document element and ends any current\n   * selection.\n   *\n   * TODO: Once Electron upgrades to Chrome 55 we can drop this in favor\n   * of the 'once' option in addEventListener, see\n   * https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener\n   */\n  private onDocumentMouseUp = (ev: MouseEvent) => {\n    ev.preventDefault()\n    document.removeEventListener('mouseup', this.onDocumentMouseUp)\n    this.endSelection()\n  }\n\n  /**\n   * complete the selection gesture and apply the change to the diff\n   */\n  private endSelection = () => {\n    if (!this.props.onIncludeChanged || !this.selection) {\n      return\n    }\n\n    this.props.onIncludeChanged(this.selection.done())\n\n    // operation is completed, clean this up\n    this.selection = null\n  }\n\n  private onChangeImageDiffType = (type: ImageDiffType) => {\n    this.props.dispatcher.changeImageDiffType(type)\n  }\n\n  private renderImage(imageDiff: IImageDiff) {\n    if (imageDiff.current && imageDiff.previous) {\n      return (\n        <ModifiedImageDiff\n          onChangeDiffType={this.onChangeImageDiffType}\n          diffType={this.props.imageDiffType}\n          current={imageDiff.current}\n          previous={imageDiff.previous}\n        />\n      )\n    }\n\n    if (imageDiff.current && this.props.file.status === AppFileStatus.New) {\n      return <NewImageDiff current={imageDiff.current} />\n    }\n\n    if (\n      imageDiff.previous &&\n      this.props.file.status === AppFileStatus.Deleted\n    ) {\n      return <DeletedImageDiff previous={imageDiff.previous} />\n    }\n\n    return null\n  }\n\n  private renderLargeTextDiff() {\n    return (\n      <div className=\"panel empty large-diff\">\n        <img src={NoDiffImage} className=\"blankslate-image\" />\n        <p>\n          The diff is too large to be displayed by default.\n          <br />\n          You can try to show it anyways, but performance may be negatively\n          impacted.\n        </p>\n        <Button onClick={this.showLargeDiff}>\n          {__DARWIN__ ? 'Show Diff' : 'Show diff'}\n        </Button>\n      </div>\n    )\n  }\n\n  private renderUnrenderableDiff() {\n    return (\n      <div className=\"panel empty large-diff\">\n        <img src={NoDiffImage} />\n        <p>The diff is too large to be displayed.</p>\n      </div>\n    )\n  }\n\n  private renderLargeText(diff: ILargeTextDiff) {\n    // guaranteed to be set since this function won't be called if text or hunks are null\n    const textDiff: ITextDiff = {\n      text: diff.text,\n      hunks: diff.hunks,\n      kind: DiffType.Text,\n      lineEndingsChange: diff.lineEndingsChange,\n    }\n\n    return this.renderTextDiff(textDiff)\n  }\n\n  private renderText(diff: ITextDiff) {\n    if (diff.hunks.length === 0) {\n      if (this.props.file.status === AppFileStatus.New) {\n        return <div className=\"panel empty\">The file is empty</div>\n      }\n\n      if (this.props.file.status === AppFileStatus.Renamed) {\n        return (\n          <div className=\"panel renamed\">\n            The file was renamed but not changed\n          </div>\n        )\n      }\n\n      return <div className=\"panel empty\">No content changes found</div>\n    }\n\n    return this.renderTextDiff(diff)\n  }\n\n  private renderBinaryFile() {\n    return (\n      <BinaryFile\n        path={this.props.file.path}\n        repository={this.props.repository}\n        dispatcher={this.props.dispatcher}\n      />\n    )\n  }\n\n  private renderTextDiff(diff: ITextDiff) {\n    return (\n      <TextDiff\n        repository={this.props.repository}\n        file={this.props.file}\n        readOnly={this.props.readOnly}\n        onIncludeChanged={this.props.onIncludeChanged}\n        text={diff.text}\n        hunks={diff.hunks}\n      />\n    )\n  }\n\n  private showLargeDiff = () => {\n    this.setState({ forceShowLargeDiff: true })\n  }\n}\n","/**\n * Helper function to coerce a number into a valid range.\n *\n * Ensures that the returned value is at least min and at most\n * (inclusive) max.\n */\nexport function clamp(value: number, min: number, max: number): number {\n  if (value < min) {\n    return min\n  } else if (value > max) {\n    return max\n  } else {\n    return value\n  }\n}\n","export * from './autocompletion-provider'\nexport * from './emoji-autocompletion-provider'\nexport * from './issues-autocompletion-provider'\nexport * from './user-autocompletion-provider'\n","(function() {\n  var Query, coreChars, countDir, getCharCodes, getExtension, opt_char_re, truncatedUpperCase, _ref;\n\n  _ref = require(\"./pathScorer\"), countDir = _ref.countDir, getExtension = _ref.getExtension;\n\n  module.exports = Query = (function() {\n    function Query(query, _arg) {\n      var optCharRegEx, pathSeparator, _ref1;\n      _ref1 = _arg != null ? _arg : {}, optCharRegEx = _ref1.optCharRegEx, pathSeparator = _ref1.pathSeparator;\n      if (!(query && query.length)) {\n        return null;\n      }\n      this.query = query;\n      this.query_lw = query.toLowerCase();\n      this.core = coreChars(query, optCharRegEx);\n      this.core_lw = this.core.toLowerCase();\n      this.core_up = truncatedUpperCase(this.core);\n      this.depth = countDir(query, query.length, pathSeparator);\n      this.ext = getExtension(this.query_lw);\n      this.charCodes = getCharCodes(this.query_lw);\n    }\n\n    return Query;\n\n  })();\n\n  opt_char_re = /[ _\\-:\\/\\\\]/g;\n\n  coreChars = function(query, optCharRegEx) {\n    if (optCharRegEx == null) {\n      optCharRegEx = opt_char_re;\n    }\n    return query.replace(optCharRegEx, '');\n  };\n\n  truncatedUpperCase = function(str) {\n    var char, upper, _i, _len;\n    upper = \"\";\n    for (_i = 0, _len = str.length; _i < _len; _i++) {\n      char = str[_i];\n      upper += char.toUpperCase()[0];\n    }\n    return upper;\n  };\n\n  getCharCodes = function(str) {\n    var charCodes, i, len;\n    len = str.length;\n    i = -1;\n    charCodes = [];\n    while (++i < len) {\n      charCodes[str.charCodeAt(i)] = true;\n    }\n    return charCodes;\n  };\n\n}).call(this);\n","import * as React from 'react'\n\nexport type SelectionDirection = 'up' | 'down'\n\ninterface ISelectRowAction {\n  /**\n   * The vertical direction use when searching for a selectable row.\n   */\n  readonly direction: SelectionDirection\n\n  /**\n   * The starting row index to search from.\n   */\n  readonly row: number\n\n  /**\n   * A flag to indicate or not to look beyond the last or first\n   * row (depending on direction) such that given the last row and\n   * a downward direction will consider the first row as a\n   * candidate or given the first row and an upward direction\n   * will consider the last row as a candidate.\n   *\n   * Defaults to true if not set.\n   */\n  readonly wrap?: boolean\n}\n\n/**\n * Interface describing a user initiated selection change event\n * originating from a pointer device clicking or pressing on an item.\n */\nexport interface IMouseClickSource {\n  readonly kind: 'mouseclick'\n  readonly event: React.MouseEvent<any>\n}\n\n/**\n * Interface describing a user initiated selection change event\n * originating from a pointer device hovering over an item.\n * Only applicable when selectedOnHover is set.\n */\nexport interface IHoverSource {\n  readonly kind: 'hover'\n  readonly event: React.MouseEvent<any>\n}\n\n/**\n * Interface describing a user initiated selection change event\n * originating from a keyboard\n */\nexport interface IKeyboardSource {\n  readonly kind: 'keyboard'\n  readonly event: React.KeyboardEvent<any>\n}\n\n/**\n * Interface describing a user initiated selection of all list\n * items (usually by clicking the Edit > Select all menu item in\n * the application window). This is highly specific to GitHub Desktop\n */\nexport interface ISelectAllSource {\n  readonly kind: 'select-all'\n}\n\n/** A type union of possible sources of a selection changed event */\nexport type SelectionSource =\n  | IMouseClickSource\n  | IHoverSource\n  | IKeyboardSource\n  | ISelectAllSource\n\n/**\n * Determine the next selectable row, given the direction and a starting\n * row index. Whether a row is selectable or not is determined using\n * the `canSelectRow` function, which defaults to true if not provided.\n *\n * Returns null if no row can be selected or if the only selectable row is\n * identical to the given row parameter.\n */\nexport function findNextSelectableRow(\n  rowCount: number,\n  action: ISelectRowAction,\n  canSelectRow: (row: number) => boolean = row => true\n): number | null {\n  if (rowCount === 0) {\n    return null\n  }\n\n  const { direction, row } = action\n  const wrap = action.wrap === undefined ? true : action.wrap\n\n  // Ensure the row value is in the range between 0 and rowCount - 1\n  //\n  // If the row falls outside this range, use the direction\n  // given to choose a suitable value:\n  //\n  //  - move in an upward direction -> select last row\n  //  - move in a downward direction -> select first row\n  //\n  let currentRow =\n    row < 0 || row >= rowCount ? (direction === 'up' ? rowCount - 1 : 0) : row\n\n  // handle specific case from switching from filter text to list\n  //\n  // locking currentRow to [0,rowCount) above means that the below loops\n  // will skip over the first entry\n  if (direction === 'down' && row === -1) {\n    currentRow = -1\n  }\n\n  const delta = direction === 'up' ? -1 : 1\n\n  // Iterate through all rows (starting offset from the\n  // given row and ending on and including the given row)\n  for (let i = 0; i < rowCount; i++) {\n    currentRow += delta\n\n    if (currentRow >= rowCount) {\n      // We've hit rock bottom, wrap around to the top\n      // if we're allowed to or give up.\n      if (wrap) {\n        currentRow = 0\n      } else {\n        break\n      }\n    } else if (currentRow < 0) {\n      // We've reached the top, wrap around to the bottom\n      // if we're allowed to or give up\n      if (wrap) {\n        currentRow = rowCount - 1\n      } else {\n        break\n      }\n    }\n\n    if (row !== currentRow && canSelectRow(currentRow)) {\n      return currentRow\n    }\n  }\n\n  return null\n}\n","// getting tag from 19.1.3.6 Object.prototype.toString()\nvar cof = require('./$.cof')\n  , TAG = require('./$.wks')('toStringTag')\n  // ES3 wrong here\n  , ARG = cof(function(){ return arguments; }()) == 'Arguments';\n\nmodule.exports = function(it){\n  var O, T, B;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (T = (O = Object(it))[TAG]) == 'string' ? T\n    // builtinTag case\n    : ARG ? cof(O)\n    // ES3 arguments fallback\n    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;\n};","module.exports = function(it){\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};","// fallback for non-array-like ES3 and non-enumerable old V8 strings\nvar cof = require('./$.cof');\nmodule.exports = Object('z').propertyIsEnumerable(0) ? Object : function(it){\n  return cof(it) == 'String' ? it.split('') : Object(it);\n};","var id = 0\n  , px = Math.random();\nmodule.exports = function(key){\n  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n};","var global = require('./$.global')\n  , SHARED = '__core-js_shared__'\n  , store  = global[SHARED] || (global[SHARED] = {});\nmodule.exports = function(key){\n  return store[key] || (store[key] = {});\n};","// Thank's IE8 for his funny defineProperty\nmodule.exports = !require('./$.fails')(function(){\n  return Object.defineProperty({}, 'a', {get: function(){ return 7; }}).a != 7;\n});","module.exports = require('./$.hide');","module.exports = true;","'use strict';\nvar LIBRARY        = require('./$.library')\n  , $export        = require('./$.export')\n  , redefine       = require('./$.redefine')\n  , hide           = require('./$.hide')\n  , has            = require('./$.has')\n  , Iterators      = require('./$.iterators')\n  , $iterCreate    = require('./$.iter-create')\n  , setToStringTag = require('./$.set-to-string-tag')\n  , getProto       = require('./$').getProto\n  , ITERATOR       = require('./$.wks')('iterator')\n  , BUGGY          = !([].keys && 'next' in [].keys()) // Safari has buggy iterators w/o `next`\n  , FF_ITERATOR    = '@@iterator'\n  , KEYS           = 'keys'\n  , VALUES         = 'values';\n\nvar returnThis = function(){ return this; };\n\nmodule.exports = function(Base, NAME, Constructor, next, DEFAULT, IS_SET, FORCED){\n  $iterCreate(Constructor, NAME, next);\n  var getMethod = function(kind){\n    if(!BUGGY && kind in proto)return proto[kind];\n    switch(kind){\n      case KEYS: return function keys(){ return new Constructor(this, kind); };\n      case VALUES: return function values(){ return new Constructor(this, kind); };\n    } return function entries(){ return new Constructor(this, kind); };\n  };\n  var TAG        = NAME + ' Iterator'\n    , DEF_VALUES = DEFAULT == VALUES\n    , VALUES_BUG = false\n    , proto      = Base.prototype\n    , $native    = proto[ITERATOR] || proto[FF_ITERATOR] || DEFAULT && proto[DEFAULT]\n    , $default   = $native || getMethod(DEFAULT)\n    , methods, key;\n  // Fix native\n  if($native){\n    var IteratorPrototype = getProto($default.call(new Base));\n    // Set @@toStringTag to native iterators\n    setToStringTag(IteratorPrototype, TAG, true);\n    // FF fix\n    if(!LIBRARY && has(proto, FF_ITERATOR))hide(IteratorPrototype, ITERATOR, returnThis);\n    // fix Array#{values, @@iterator}.name in V8 / FF\n    if(DEF_VALUES && $native.name !== VALUES){\n      VALUES_BUG = true;\n      $default = function values(){ return $native.call(this); };\n    }\n  }\n  // Define iterator\n  if((!LIBRARY || FORCED) && (BUGGY || VALUES_BUG || !proto[ITERATOR])){\n    hide(proto, ITERATOR, $default);\n  }\n  // Plug for library\n  Iterators[NAME] = $default;\n  Iterators[TAG]  = returnThis;\n  if(DEFAULT){\n    methods = {\n      values:  DEF_VALUES  ? $default : getMethod(VALUES),\n      keys:    IS_SET      ? $default : getMethod(KEYS),\n      entries: !DEF_VALUES ? $default : getMethod('entries')\n    };\n    if(FORCED)for(key in methods){\n      if(!(key in proto))redefine(proto, key, methods[key]);\n    } else $export($export.P + $export.F * (BUGGY || VALUES_BUG), NAME, methods);\n  }\n  return methods;\n};","\"use strict\";\n\nexports.__esModule = true;\n\nvar _iterator = require(\"../core-js/symbol/iterator\");\n\nvar _iterator2 = _interopRequireDefault(_iterator);\n\nvar _symbol = require(\"../core-js/symbol\");\n\nvar _symbol2 = _interopRequireDefault(_symbol);\n\nvar _typeof = typeof _symbol2.default === \"function\" && typeof _iterator2.default === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof _symbol2.default === \"function\" && obj.constructor === _symbol2.default && obj !== _symbol2.default.prototype ? \"symbol\" : typeof obj; };\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = typeof _symbol2.default === \"function\" && _typeof(_iterator2.default) === \"symbol\" ? function (obj) {\n  return typeof obj === \"undefined\" ? \"undefined\" : _typeof(obj);\n} : function (obj) {\n  return obj && typeof _symbol2.default === \"function\" && obj.constructor === _symbol2.default && obj !== _symbol2.default.prototype ? \"symbol\" : typeof obj === \"undefined\" ? \"undefined\" : _typeof(obj);\n};","module.exports = { \"default\": require(\"core-js/library/fn/object/define-property\"), __esModule: true };","// optional / simple context binding\nvar aFunction = require('./$.a-function');\nmodule.exports = function(fn, that, length){\n  aFunction(fn);\n  if(that === undefined)return fn;\n  switch(length){\n    case 1: return function(a){\n      return fn.call(that, a);\n    };\n    case 2: return function(a, b){\n      return fn.call(that, a, b);\n    };\n    case 3: return function(a, b, c){\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function(/* ...args */){\n    return fn.apply(that, arguments);\n  };\n};","// The name of the ipc channel over which state changes are communicated.\nexport const windowStateChannelName = 'window-state-changed'\n\nexport type WindowState =\n  | 'minimized'\n  | 'normal'\n  | 'maximized'\n  | 'full-screen'\n  | 'hidden'\n\nexport function getWindowState(window: Electron.BrowserWindow): WindowState {\n  if (window.isFullScreen()) {\n    return 'full-screen'\n  } else if (window.isMaximized()) {\n    return 'maximized'\n  } else if (window.isMinimized()) {\n    return 'minimized'\n  } else if (!window.isVisible()) {\n    return 'hidden'\n  } else {\n    return 'normal'\n  }\n}\n\n/**\n * Registers event handlers for all window state transition events and\n * forwards those to the renderer process for a given window.\n */\nexport function registerWindowStateChangedEvents(\n  window: Electron.BrowserWindow\n) {\n  window.on('enter-full-screen', () =>\n    sendWindowStateEvent(window, 'full-screen')\n  )\n\n  // So this is a bit of a hack. If we call window.isFullScreen directly after\n  // receiving the leave-full-screen event it'll return true which isn't what\n  // we're after. So we'll say that we're transitioning to 'normal' even though\n  // we might be maximized. This works because electron will emit a 'maximized'\n  // event after 'leave-full-screen' if the state prior to full-screen was maximized.\n  window.on('leave-full-screen', () => sendWindowStateEvent(window, 'normal'))\n\n  window.on('maximize', () => sendWindowStateEvent(window, 'maximized'))\n  window.on('minimize', () => sendWindowStateEvent(window, 'minimized'))\n  window.on('unmaximize', () => sendWindowStateEvent(window, 'normal'))\n  window.on('restore', () => sendWindowStateEvent(window, 'normal'))\n  window.on('hide', () => sendWindowStateEvent(window, 'hidden'))\n  window.on('show', () => sendWindowStateEvent(window, 'normal'))\n}\n\n/**\n * Short hand convenience function for sending a window state change event\n * over the window-state-changed channel to the render process.\n */\nfunction sendWindowStateEvent(\n  window: Electron.BrowserWindow,\n  state: WindowState\n) {\n  window.webContents.send(windowStateChannelName, state)\n}\n","export enum PreferencesTab {\n  Accounts = 0,\n  Git = 1,\n  Appearance = 2,\n  Advanced = 3,\n}\n","import * as Path from 'path'\nimport * as FSE from 'fs-extra'\n\nconst GitDescriptionPath = '.git/description'\n\nconst DefaultGitDescription =\n  \"Unnamed repository; edit this file 'description' to name the repository.\\n\"\n\n/** Get the repository's description from the .git/description file. */\nexport async function getGitDescription(\n  repositoryPath: string\n): Promise<string> {\n  const path = Path.join(repositoryPath, GitDescriptionPath)\n\n  try {\n    const data = await FSE.readFile(path, 'utf8')\n    if (data === DefaultGitDescription) {\n      return ''\n    }\n    return data\n  } catch (err) {\n    return ''\n  }\n}\n\n/** Write a .git/description file to the repository. */\nexport async function writeGitDescription(\n  repositoryPath: string,\n  description: string\n): Promise<void> {\n  const fullPath = Path.join(repositoryPath, GitDescriptionPath)\n  await FSE.writeFile(fullPath, description)\n}\n","import { git } from './core'\nimport { Repository } from '../../models/repository'\nimport { assertNever } from '../fatal-error'\n\n/** The reset modes which are supported. */\nexport const enum GitResetMode {\n  /**\n   * Resets the index and working tree. Any changes to tracked files in the\n   * working tree since <commit> are discarded.\n   */\n  Hard = 0,\n  /**\n   * Does not touch the index file or the working tree at all (but resets the\n   * head to <commit>, just like all modes do). This leaves all your changed\n   * files \"Changes to be committed\", as git status would put it.\n   */\n  Soft,\n\n  /**\n   * Resets the index but not the working tree (i.e., the changed files are\n   * preserved but not marked for commit) and reports what has not been updated.\n   * This is the default action for git reset.\n   */\n  Mixed,\n}\n\nfunction resetModeToArgs(mode: GitResetMode, ref: string): string[] {\n  switch (mode) {\n    case GitResetMode.Hard:\n      return ['reset', '--hard', ref]\n    case GitResetMode.Mixed:\n      return ['reset', ref]\n    case GitResetMode.Soft:\n      return ['reset', '--soft', ref]\n    default:\n      return assertNever(mode, `Unknown reset mode: ${mode}`)\n  }\n}\n\n/** Reset with the mode to the ref. */\nexport async function reset(\n  repository: Repository,\n  mode: GitResetMode,\n  ref: string\n): Promise<true> {\n  const args = resetModeToArgs(mode, ref)\n  await git(args, repository.path, 'reset')\n  return true\n}\n\n/**\n * Updates the index with information from a particular tree for a given\n * set of paths.\n *\n * @param repository The repository in which to reset the index.\n *\n * @param mode      Which mode to use when resetting, see the GitResetMode\n *                  enum for more information.\n *\n * @param ref       A string which resolves to a tree, for example 'HEAD' or a\n *                  commit sha.\n *\n * @param paths     The paths that should be updated in the index with information\n *                  from the given tree\n */\nexport async function resetPaths(\n  repository: Repository,\n  mode: GitResetMode,\n  ref: string,\n  paths: ReadonlyArray<string>\n): Promise<void> {\n  if (!paths.length) {\n    return\n  }\n\n  const baseArgs = resetModeToArgs(mode, ref)\n\n  if (__WIN32__ && mode === GitResetMode.Mixed) {\n    // Git for Windows has experimental support for reading paths to reset\n    // from standard input. This is helpful in situations where your file\n    // paths are greater than 32KB in length, because of shell limitations.\n    //\n    // This hasn't made it to Git core, so we fallback to the default behaviour\n    // as macOS and Linux don't have this same shell limitation. See\n    // https://github.com/desktop/desktop/issues/2833#issuecomment-331352952\n    // for more context.\n    const args = [...baseArgs, '--stdin', '-z', '--']\n    await git(args, repository.path, 'resetPaths', {\n      stdin: paths.join('\\0'),\n    })\n  } else {\n    const args = [...baseArgs, '--', ...paths]\n    await git(args, repository.path, 'resetPaths')\n  }\n}\n\n/** Unstage all paths. */\nexport async function unstageAll(repository: Repository): Promise<true> {\n  await git(['reset', '--', '.'], repository.path, 'unstageAll')\n  return true\n}\n","import { ChildProcess } from 'child_process'\nimport * as Fs from 'fs'\nimport * as Path from 'path'\nimport * as byline from 'byline'\n\nimport { GitProgressParser, IGitProgress, IGitOutput } from './git'\nimport { IGitExecutionOptions } from '../git/core'\nimport { merge } from '../merge'\nimport { GitLFSProgressParser, createLFSProgressFile } from './lfs'\nimport { tailByLine } from '../file-system'\n\n/**\n * Merges an instance of IGitExecutionOptions with a process callback provided\n * by createProgressProcessCallback.\n *\n * If the given options object already has a processCallback specified it will\n * be overwritten.\n */\nexport async function executionOptionsWithProgress(\n  options: IGitExecutionOptions,\n  parser: GitProgressParser,\n  progressCallback: (progress: IGitProgress | IGitOutput) => void\n): Promise<IGitExecutionOptions> {\n  let lfsProgressPath = null\n  let env = {}\n  if (options.trackLFSProgress) {\n    try {\n      lfsProgressPath = await createLFSProgressFile()\n      env = { GIT_LFS_PROGRESS: lfsProgressPath }\n    } catch (e) {\n      log.error('Error writing LFS progress file', e)\n      env = { GIT_LFS_PROGRESS: null }\n    }\n  }\n\n  return merge(options, {\n    processCallback: createProgressProcessCallback(\n      parser,\n      lfsProgressPath,\n      progressCallback\n    ),\n    env: merge(options.env, env),\n  })\n}\n\n/**\n * Returns a callback which can be passed along to the processCallback option\n * in IGitExecution. The callback then takes care of reading stderr of the\n * process and parsing its contents using the provided parser.\n */\nfunction createProgressProcessCallback(\n  parser: GitProgressParser,\n  lfsProgressPath: string | null,\n  progressCallback: (progress: IGitProgress | IGitOutput) => void\n): (process: ChildProcess) => void {\n  return process => {\n    if (lfsProgressPath) {\n      const lfsParser = new GitLFSProgressParser()\n      const disposable = tailByLine(lfsProgressPath, line => {\n        const progress = lfsParser.parse(line)\n        progressCallback(progress)\n      })\n\n      process.on('close', () => {\n        disposable.dispose()\n        // the order of these callbacks is important because\n        //  - unlink can only be done on files\n        //  - rmdir can only be done when the directory is empty\n        //  - we don't want to surface errors to the user if something goes\n        //    wrong (these files can stay in TEMP and be cleaned up eventually)\n        Fs.unlink(lfsProgressPath, err => {\n          if (err == null) {\n            const directory = Path.dirname(lfsProgressPath)\n            Fs.rmdir(directory, () => {})\n          }\n        })\n      })\n    }\n\n    byline(process.stderr).on('data', (line: string) => {\n      progressCallback(parser.parse(line))\n    })\n  }\n}\n","export class GitAuthor {\n  public static parse(nameAddr: string): GitAuthor | null {\n    const m = nameAddr.match(/^(.*?)\\s+<(.*?)>/)\n    return m === null ? null : new GitAuthor(m[1], m[2])\n  }\n\n  public constructor(\n    public readonly name: string,\n    public readonly email: string\n  ) {}\n\n  public toString() {\n    return `${this.name} <${this.email}>`\n  }\n}\n","import { git } from './core'\nimport { GitError } from 'dugite'\n\nimport { Repository } from '../../models/repository'\nimport { Commit } from '../../models/commit'\nimport { Branch, BranchType } from '../../models/branch'\nimport { CommitIdentity } from '../../models/commit-identity'\nimport { ForkedRemotePrefix } from '../../models/remote'\nimport {\n  getTrailerSeparatorCharacters,\n  parseRawUnfoldedTrailers,\n} from './interpret-trailers'\n\nconst ForksReferencesPrefix = `refs/remotes/${ForkedRemotePrefix}`\n\n/** Get all the branches. */\nexport async function getBranches(\n  repository: Repository,\n  ...prefixes: string[]\n): Promise<ReadonlyArray<Branch>> {\n  const delimiter = '1F'\n  const delimiterString = String.fromCharCode(parseInt(delimiter, 16))\n\n  const format = [\n    '%(refname)',\n    '%(refname:short)',\n    '%(upstream:short)',\n    '%(objectname)', // SHA\n    '%(author)',\n    '%(committer)',\n    '%(parent)', // parent SHAs\n    '%(symref)',\n    '%(subject)',\n    '%(body)',\n    '%(trailers:unfold,only)',\n    `%${delimiter}`, // indicate end-of-line as %(body) may contain newlines\n  ].join('%00')\n\n  if (!prefixes || !prefixes.length) {\n    prefixes = ['refs/heads', 'refs/remotes']\n  }\n\n  // TODO: use expectedErrors here to handle a specific error\n  // see https://github.com/desktop/desktop/pull/5299#discussion_r206603442 for\n  // discussion about what needs to change\n  const result = await git(\n    ['for-each-ref', `--format=${format}`, ...prefixes],\n    repository.path,\n    'getBranches',\n    { expectedErrors: new Set([GitError.NotAGitRepository]) }\n  )\n\n  if (result.gitError === GitError.NotAGitRepository) {\n    return []\n  }\n\n  const names = result.stdout\n  const lines = names.split(delimiterString)\n\n  // Remove the trailing newline\n  lines.splice(-1, 1)\n\n  if (lines.length === 0) {\n    return []\n  }\n\n  const trailerSeparators = await getTrailerSeparatorCharacters(repository)\n\n  const branches = []\n\n  for (const [ix, line] of lines.entries()) {\n    // preceding newline character after first row\n    const pieces = (ix > 0 ? line.substr(1) : line).split('\\0')\n\n    const ref = pieces[0]\n    const name = pieces[1]\n    const upstream = pieces[2]\n    const sha = pieces[3]\n\n    const authorIdentity = pieces[4]\n    const author = CommitIdentity.parseIdentity(authorIdentity)\n\n    if (!author) {\n      throw new Error(`Couldn't parse author identity ${authorIdentity}`)\n    }\n\n    const committerIdentity = pieces[5]\n    const committer = CommitIdentity.parseIdentity(committerIdentity)\n\n    if (!committer) {\n      throw new Error(`Couldn't parse committer identity ${committerIdentity}`)\n    }\n\n    const parentSHAs = pieces[6].split(' ')\n    const symref = pieces[7]\n    const summary = pieces[8]\n    const body = pieces[9]\n    const trailers = parseRawUnfoldedTrailers(pieces[10], trailerSeparators)\n\n    const tip = new Commit(\n      sha,\n      summary,\n      body,\n      author,\n      committer,\n      parentSHAs,\n      trailers\n    )\n\n    const type = ref.startsWith('refs/head')\n      ? BranchType.Local\n      : BranchType.Remote\n\n    if (symref.length > 0) {\n      // excude symbolic refs from the branch list\n      continue\n    }\n\n    if (ref.startsWith(ForksReferencesPrefix)) {\n      // hide refs from our known remotes as these are considered plumbing\n      // and can add noise to everywhere in the user interface where we\n      // display branches as forks will likely contain duplicates of the same\n      // ref names\n      continue\n    }\n\n    branches.push(\n      new Branch(name, upstream.length > 0 ? upstream : null, tip, type)\n    )\n  }\n\n  return branches\n}\n","import { ChildProcess } from 'child_process'\n\nimport { git } from './core'\nimport { spawnAndComplete } from './spawn'\n\nimport { Repository } from '../../models/repository'\n\n/**\n * Retrieve the binary contents of a blob from the repository at a given\n * reference, commit, or tree.\n *\n * Returns a promise that will produce a Buffer instance containing\n * the binary contents of the blob or an error if the file doesn't\n * exists in the given revision.\n *\n * @param repository - The repository from where to read the blob\n *\n * @param commitish  - A commit SHA or some other identifier that\n *                     ultimately dereferences to a commit/tree.\n *\n * @param path       - The file path, relative to the repository\n *                     root from where to read the blob contents\n */\nexport async function getBlobContents(\n  repository: Repository,\n  commitish: string,\n  path: string\n): Promise<Buffer> {\n  const successExitCodes = new Set([0, 1])\n  const setBinaryEncoding: (process: ChildProcess) => void = cb =>\n    cb.stdout.setEncoding('binary')\n\n  const args = ['show', `${commitish}:${path}`]\n  const opts = {\n    successExitCodes,\n    processCallback: setBinaryEncoding,\n  }\n\n  const blobContents = await git(args, repository.path, 'getBlobContents', opts)\n\n  return Buffer.from(blobContents.stdout, 'binary')\n}\n\n/**\n * Retrieve some or all binary contents of a blob from the repository\n * at a given reference, commit, or tree. This is almost identical\n * to the getBlobContents method except that it supports only reading\n * a maximum number of bytes.\n *\n * Returns a promise that will produce a Buffer instance containing\n * the binary contents of the blob or an error if the file doesn't\n * exists in the given revision.\n *\n * @param repository - The repository from where to read the blob\n *\n * @param commitish  - A commit SHA or some other identifier that\n *                     ultimately dereferences to a commit/tree.\n *\n * @param path       - The file path, relative to the repository\n *                     root from where to read the blob contents\n *\n * @param length     - The maximum number of bytes to read from\n *                     the blob. Note that the number of bytes\n *                     returned may always be less than this number.\n */\nexport async function getPartialBlobContents(\n  repository: Repository,\n  commitish: string,\n  path: string,\n  length: number\n): Promise<Buffer> {\n  const successExitCodes = new Set([0, 1])\n\n  const args = ['show', `${commitish}:${path}`]\n\n  const { output } = await spawnAndComplete(\n    args,\n    repository.path,\n    'getPartialBlobContents',\n    successExitCodes,\n    length\n  )\n\n  return output\n}\n","// Copyright (C) 2011-2015 John Hewson\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to\n// deal in the Software without restriction, including without limitation the\n// rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\n// sell copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n// \n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n// \n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n// FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\n// IN THE SOFTWARE.\n\nvar stream = require('stream'),\n    util = require('util'),\n    timers = require('timers');\n\n// convinience API\nmodule.exports = function(readStream, options) {\n  return module.exports.createStream(readStream, options);\n};\n\n// basic API\nmodule.exports.createStream = function(readStream, options) {\n  if (readStream) {\n    return createLineStream(readStream, options);\n  } else {\n    return new LineStream(options);\n  }\n};\n\n// deprecated API\nmodule.exports.createLineStream = function(readStream) {\n  console.log('WARNING: byline#createLineStream is deprecated and will be removed soon');\n  return createLineStream(readStream);\n};\n\nfunction createLineStream(readStream, options) {\n  if (!readStream) {\n    throw new Error('expected readStream');\n  }\n  if (!readStream.readable) {\n    throw new Error('readStream must be readable');\n  }\n  var ls = new LineStream(options);\n  readStream.pipe(ls);\n  return ls;\n}\n\n//\n// using the new node v0.10 \"streams2\" API\n//\n\nmodule.exports.LineStream = LineStream;\n\nfunction LineStream(options) {\n  stream.Transform.call(this, options);\n  options = options || {};\n\n  // use objectMode to stop the output from being buffered\n  // which re-concatanates the lines, just without newlines.\n  this._readableState.objectMode = true;\n  this._lineBuffer = [];\n  this._keepEmptyLines = options.keepEmptyLines || false;\n  this._lastChunkEndedWithCR = false;\n\n  // take the source's encoding if we don't have one\n  var self = this;\n  this.on('pipe', function(src) {\n    if (!self.encoding) {\n      // but we can't do this for old-style streams\n      if (src instanceof stream.Readable) {\n        self.encoding = src._readableState.encoding;\n      }\n    }\n  });\n}\nutil.inherits(LineStream, stream.Transform);\n\nLineStream.prototype._transform = function(chunk, encoding, done) {\n  // decode binary chunks as UTF-8\n  encoding = encoding || 'utf8';\n  \n  if (Buffer.isBuffer(chunk)) {\n    if (encoding == 'buffer') {\n      chunk = chunk.toString(); // utf8\n      encoding = 'utf8';\n    }\n    else {\n     chunk = chunk.toString(encoding);\n    }\n  }\n  this._chunkEncoding = encoding;\n  \n  // see: http://www.unicode.org/reports/tr18/#Line_Boundaries\n  var lines = chunk.split(/\\r\\n|[\\n\\v\\f\\r\\x85\\u2028\\u2029]/g);\n  \n  // don't split CRLF which spans chunks\n  if (this._lastChunkEndedWithCR && chunk[0] == '\\n') {\n    lines.shift();\n  }\n  \n  if (this._lineBuffer.length > 0) {\n    this._lineBuffer[this._lineBuffer.length - 1] += lines[0];\n    lines.shift();\n  }\n\n  this._lastChunkEndedWithCR = chunk[chunk.length - 1] == '\\r';\n  this._lineBuffer = this._lineBuffer.concat(lines);\n  this._pushBuffer(encoding, 1, done);\n};\n\nLineStream.prototype._pushBuffer = function(encoding, keep, done) {\n  // always buffer the last (possibly partial) line\n  while (this._lineBuffer.length > keep) {\n    var line = this._lineBuffer.shift();\n    // skip empty lines\n    if (this._keepEmptyLines || line.length > 0 ) {\n      if (!this.push(this._reencode(line, encoding))) {\n        // when the high-water mark is reached, defer pushes until the next tick\n        var self = this;\n        timers.setImmediate(function() {\n          self._pushBuffer(encoding, keep, done);\n        });\n        return;\n      }\n    }\n  }\n  done();\n};\n\nLineStream.prototype._flush = function(done) {\n  this._pushBuffer(this._chunkEncoding, 0, done);\n};\n\n// see Readable::push\nLineStream.prototype._reencode = function(line, chunkEncoding) {\n  if (this.encoding && this.encoding != chunkEncoding) {\n    return new Buffer(line, chunkEncoding).toString(this.encoding);\n  }\n  else if (this.encoding) {\n    // this should be the most common case, i.e. we're using an encoded source stream\n    return line;\n  }\n  else {\n    return new Buffer(line, chunkEncoding);\n  }\n};\n","'use strict'\n\nconst u = require('universalify').fromCallback\nmodule.exports = {\n  copy: u(require('./copy'))\n}\n","'use strict'\n/* eslint-disable node/no-deprecated-api */\nmodule.exports = function (size) {\n  if (typeof Buffer.allocUnsafe === 'function') {\n    try {\n      return Buffer.allocUnsafe(size)\n    } catch (e) {\n      return new Buffer(size)\n    }\n  }\n  return new Buffer(size)\n}\n","'use strict'\n\nconst fs = require('graceful-fs')\nconst os = require('os')\nconst path = require('path')\n\n// HFS, ext{2,3}, FAT do not, Node.js v0.10 does not\nfunction hasMillisResSync () {\n  let tmpfile = path.join('millis-test-sync' + Date.now().toString() + Math.random().toString().slice(2))\n  tmpfile = path.join(os.tmpdir(), tmpfile)\n\n  // 550 millis past UNIX epoch\n  const d = new Date(1435410243862)\n  fs.writeFileSync(tmpfile, 'https://github.com/jprichardson/node-fs-extra/pull/141')\n  const fd = fs.openSync(tmpfile, 'r+')\n  fs.futimesSync(fd, d, d)\n  fs.closeSync(fd)\n  return fs.statSync(tmpfile).mtime > 1435410243000\n}\n\nfunction hasMillisRes (callback) {\n  let tmpfile = path.join('millis-test' + Date.now().toString() + Math.random().toString().slice(2))\n  tmpfile = path.join(os.tmpdir(), tmpfile)\n\n  // 550 millis past UNIX epoch\n  const d = new Date(1435410243862)\n  fs.writeFile(tmpfile, 'https://github.com/jprichardson/node-fs-extra/pull/141', err => {\n    if (err) return callback(err)\n    fs.open(tmpfile, 'r+', (err, fd) => {\n      if (err) return callback(err)\n      fs.futimes(fd, d, d, err => {\n        if (err) return callback(err)\n        fs.close(fd, err => {\n          if (err) return callback(err)\n          fs.stat(tmpfile, (err, stats) => {\n            if (err) return callback(err)\n            callback(null, stats.mtime > 1435410243000)\n          })\n        })\n      })\n    })\n  })\n}\n\nfunction timeRemoveMillis (timestamp) {\n  if (typeof timestamp === 'number') {\n    return Math.floor(timestamp / 1000) * 1000\n  } else if (timestamp instanceof Date) {\n    return new Date(Math.floor(timestamp.getTime() / 1000) * 1000)\n  } else {\n    throw new Error('fs-extra: timeRemoveMillis() unknown parameter type')\n  }\n}\n\nfunction utimesMillis (path, atime, mtime, callback) {\n  // if (!HAS_MILLIS_RES) return fs.utimes(path, atime, mtime, callback)\n  fs.open(path, 'r+', (err, fd) => {\n    if (err) return callback(err)\n    fs.futimes(fd, atime, mtime, futimesErr => {\n      fs.close(fd, closeErr => {\n        if (callback) callback(futimesErr || closeErr)\n      })\n    })\n  })\n}\n\nfunction utimesMillisSync (path, atime, mtime) {\n  const fd = fs.openSync(path, 'r+')\n  fs.futimesSync(fd, atime, mtime)\n  return fs.closeSync(fd)\n}\n\nmodule.exports = {\n  hasMillisRes,\n  hasMillisResSync,\n  timeRemoveMillis,\n  utimesMillis,\n  utimesMillisSync\n}\n","'use strict'\n\nconst path = require('path')\n\n// get drive on windows\nfunction getRootPath (p) {\n  p = path.normalize(path.resolve(p)).split(path.sep)\n  if (p.length > 0) return p[0]\n  return null\n}\n\n// http://stackoverflow.com/a/62888/10333 contains more accurate\n// TODO: expand to include the rest\nconst INVALID_PATH_CHARS = /[<>:\"|?*]/\n\nfunction invalidWin32Path (p) {\n  const rp = getRootPath(p)\n  p = p.replace(rp, '')\n  return INVALID_PATH_CHARS.test(p)\n}\n\nmodule.exports = {\n  getRootPath,\n  invalidWin32Path\n}\n","'use strict'\n\nmodule.exports = {\n  copySync: require('./copy-sync')\n}\n","module.exports = require(\"assert\");","module.exports = require(\"stream\");","'use strict'\n\nvar fs = require('fs')\n\nmodule.exports = clone(fs)\n\nfunction clone (obj) {\n  if (obj === null || typeof obj !== 'object')\n    return obj\n\n  if (obj instanceof Object)\n    var copy = { __proto__: obj.__proto__ }\n  else\n    var copy = Object.create(null)\n\n  Object.getOwnPropertyNames(obj).forEach(function (key) {\n    Object.defineProperty(copy, key, Object.getOwnPropertyDescriptor(obj, key))\n  })\n\n  return copy\n}\n","'use strict'\n// This is adapted from https://github.com/normalize/mz\n// Copyright (c) 2014-2016 Jonathan Ong me@jongleberry.com and Contributors\nconst u = require('universalify').fromCallback\nconst fs = require('graceful-fs')\n\nconst api = [\n  'access',\n  'appendFile',\n  'chmod',\n  'chown',\n  'close',\n  'copyFile',\n  'fchmod',\n  'fchown',\n  'fdatasync',\n  'fstat',\n  'fsync',\n  'ftruncate',\n  'futimes',\n  'lchown',\n  'link',\n  'lstat',\n  'mkdir',\n  'mkdtemp',\n  'open',\n  'readFile',\n  'readdir',\n  'readlink',\n  'realpath',\n  'rename',\n  'rmdir',\n  'stat',\n  'symlink',\n  'truncate',\n  'unlink',\n  'utimes',\n  'writeFile'\n].filter(key => {\n  // Some commands are not available on some systems. Ex:\n  // fs.copyFile was added in Node.js v8.5.0\n  // fs.mkdtemp was added in Node.js v5.10.0\n  // fs.lchown is not available on at least some Linux\n  return typeof fs[key] === 'function'\n})\n\n// Export all keys:\nObject.keys(fs).forEach(key => {\n  exports[key] = fs[key]\n})\n\n// Universalify async methods:\napi.forEach(method => {\n  exports[method] = u(fs[method])\n})\n\n// We differ from mz/fs in that we still ship the old, broken, fs.exists()\n// since we are a drop-in replacement for the native module\nexports.exists = function (filename, callback) {\n  if (typeof callback === 'function') {\n    return fs.exists(filename, callback)\n  }\n  return new Promise(resolve => {\n    return fs.exists(filename, resolve)\n  })\n}\n\n// fs.read() & fs.write need special treatment due to multiple callback args\n\nexports.read = function (fd, buffer, offset, length, position, callback) {\n  if (typeof callback === 'function') {\n    return fs.read(fd, buffer, offset, length, position, callback)\n  }\n  return new Promise((resolve, reject) => {\n    fs.read(fd, buffer, offset, length, position, (err, bytesRead, buffer) => {\n      if (err) return reject(err)\n      resolve({ bytesRead, buffer })\n    })\n  })\n}\n\n// Function signature can be\n// fs.write(fd, buffer[, offset[, length[, position]]], callback)\n// OR\n// fs.write(fd, string[, position[, encoding]], callback)\n// We need to handle both cases, so we use ...args\nexports.write = function (fd, buffer, ...args) {\n  if (typeof args[args.length - 1] === 'function') {\n    return fs.write(fd, buffer, ...args)\n  }\n\n  return new Promise((resolve, reject) => {\n    fs.write(fd, buffer, ...args, (err, bytesWritten, buffer) => {\n      if (err) return reject(err)\n      resolve({ bytesWritten, buffer })\n    })\n  })\n}\n","import * as Path from 'path'\nimport * as fileSystem from '../../lib/file-system'\n\nimport { getBlobContents } from './show'\n\nimport { Repository } from '../../models/repository'\nimport {\n  WorkingDirectoryFileChange,\n  FileChange,\n  AppFileStatus,\n} from '../../models/status'\nimport {\n  DiffType,\n  IRawDiff,\n  IDiff,\n  IImageDiff,\n  Image,\n  LineEndingsChange,\n  parseLineEndingText,\n  ILargeTextDiff,\n  IUnrenderableDiff,\n} from '../../models/diff'\n\nimport { spawnAndComplete } from './spawn'\n\nimport { DiffParser } from '../diff-parser'\n\n/**\n * V8 has a limit on the size of string it can create (~256MB), and unless we want to\n * trigger an unhandled exception we need to do the encoding conversion by hand.\n *\n * This is a hard limit on how big a buffer can be and still be converted into\n * a string.\n */\nconst MaxDiffBufferSize = 70e6 // 70MB in decimal\n\n/**\n * Where `MaxDiffBufferSize` is a hard limit, this is a suggested limit. Diffs\n * bigger than this _could_ be displayed but it might cause some slowness.\n */\nconst MaxReasonableDiffSize = MaxDiffBufferSize / 16 // ~4.375MB in decimal\n\n/**\n * The longest line length we should try to display. If a diff has a line longer\n * than this, we probably shouldn't attempt it\n */\nconst MaxCharactersPerLine = 5000\n\n/**\n * Utility function to check whether parsing this buffer is going to cause\n * issues at runtime.\n *\n * @param buffer A buffer of binary text from a spawned process\n */\nfunction isValidBuffer(buffer: Buffer) {\n  return buffer.length <= MaxDiffBufferSize\n}\n\n/** Is the buffer too large for us to reasonably represent? */\nfunction isBufferTooLarge(buffer: Buffer) {\n  return buffer.length >= MaxReasonableDiffSize\n}\n\n/** Is the diff too large for us to reasonably represent? */\nfunction isDiffTooLarge(diff: IRawDiff) {\n  for (const hunk of diff.hunks) {\n    for (const line of hunk.lines) {\n      if (line.text.length > MaxCharactersPerLine) {\n        return true\n      }\n    }\n  }\n\n  return false\n}\n\n/**\n *  Defining the list of known extensions we can render inside the app\n */\nconst imageFileExtensions = new Set([\n  '.png',\n  '.jpg',\n  '.jpeg',\n  '.gif',\n  '.ico',\n  '.webp',\n  '.bmp',\n])\n\n/**\n * Render the difference between a file in the given commit and its parent\n *\n * @param commitish A commit SHA or some other identifier that ultimately dereferences\n *                  to a commit.\n */\nexport async function getCommitDiff(\n  repository: Repository,\n  file: FileChange,\n  commitish: string\n): Promise<IDiff> {\n  const args = [\n    'log',\n    commitish,\n    '-m',\n    '-1',\n    '--first-parent',\n    '--patch-with-raw',\n    '-z',\n    '--no-color',\n    '--',\n    file.path,\n  ]\n\n  if (file.oldPath != null) {\n    args.push(file.oldPath)\n  }\n\n  const { output } = await spawnAndComplete(\n    args,\n    repository.path,\n    'getCommitDiff'\n  )\n\n  return buildDiff(output, repository, file, commitish)\n}\n\n/**\n * Render the diff for a file within the repository working directory. The file will be\n * compared against HEAD if it's tracked, if not it'll be compared to an empty file meaning\n * that all content in the file will be treated as additions.\n */\nexport async function getWorkingDirectoryDiff(\n  repository: Repository,\n  file: WorkingDirectoryFileChange\n): Promise<IDiff> {\n  let successExitCodes: Set<number> | undefined\n  let args: Array<string>\n\n  // `--no-ext-diff` should be provided wherever we invoke `git diff` so that any\n  // diff.external program configured by the user is ignored\n\n  if (file.status === AppFileStatus.New) {\n    // `git diff --no-index` seems to emulate the exit codes from `diff` irrespective of\n    // whether you set --exit-code\n    //\n    // this is the behaviour:\n    // - 0 if no changes found\n    // - 1 if changes found\n    // -   and error otherwise\n    //\n    // citation in source:\n    // https://github.com/git/git/blob/1f66975deb8402131fbf7c14330d0c7cdebaeaa2/diff-no-index.c#L300\n    successExitCodes = new Set([0, 1])\n    args = [\n      'diff',\n      '--no-ext-diff',\n      '--no-index',\n      '--patch-with-raw',\n      '-z',\n      '--no-color',\n      '--',\n      '/dev/null',\n      file.path,\n    ]\n  } else if (file.status === AppFileStatus.Renamed) {\n    // NB: Technically this is incorrect, the best kind of incorrect.\n    // In order to show exactly what will end up in the commit we should\n    // perform a diff between the new file and the old file as it appears\n    // in HEAD. By diffing against the index we won't show any changes\n    // already staged to the renamed file which differs from our other diffs.\n    // The closest I got to that was running hash-object and then using\n    // git diff <blob> <blob> but that seems a bit excessive.\n    args = [\n      'diff',\n      '--no-ext-diff',\n      '--patch-with-raw',\n      '-z',\n      '--no-color',\n      '--',\n      file.path,\n    ]\n  } else {\n    args = [\n      'diff',\n      'HEAD',\n      '--no-ext-diff',\n      '--patch-with-raw',\n      '-z',\n      '--no-color',\n      '--',\n      file.path,\n    ]\n  }\n\n  const { output, error } = await spawnAndComplete(\n    args,\n    repository.path,\n    'getWorkingDirectoryDiff',\n    successExitCodes\n  )\n  const lineEndingsChange = parseLineEndingsWarning(error)\n\n  return buildDiff(output, repository, file, 'HEAD', lineEndingsChange)\n}\n\nasync function getImageDiff(\n  repository: Repository,\n  file: FileChange,\n  commitish: string\n): Promise<IImageDiff> {\n  let current: Image | undefined = undefined\n  let previous: Image | undefined = undefined\n\n  // Are we looking at a file in the working directory or a file in a commit?\n  if (file instanceof WorkingDirectoryFileChange) {\n    // No idea what to do about this, a conflicted binary (presumably) file.\n    // Ideally we'd show all three versions and let the user pick but that's\n    // a bit out of scope for now.\n    if (file.status === AppFileStatus.Conflicted) {\n      return { kind: DiffType.Image }\n    }\n\n    // Does it even exist in the working directory?\n    if (file.status !== AppFileStatus.Deleted) {\n      current = await getWorkingDirectoryImage(repository, file)\n    }\n\n    if (file.status !== AppFileStatus.New) {\n      // If we have file.oldPath that means it's a rename so we'll\n      // look for that file.\n      previous = await getBlobImage(\n        repository,\n        file.oldPath || file.path,\n        'HEAD'\n      )\n    }\n  } else {\n    // File status can't be conflicted for a file in a commit\n    if (file.status !== AppFileStatus.Deleted) {\n      current = await getBlobImage(repository, file.path, commitish)\n    }\n\n    // File status can't be conflicted for a file in a commit\n    if (file.status !== AppFileStatus.New) {\n      // TODO: commitish^ won't work for the first commit\n      //\n      // If we have file.oldPath that means it's a rename so we'll\n      // look for that file.\n      previous = await getBlobImage(\n        repository,\n        file.oldPath || file.path,\n        `${commitish}^`\n      )\n    }\n  }\n\n  return {\n    kind: DiffType.Image,\n    previous: previous,\n    current: current,\n  }\n}\n\nexport async function convertDiff(\n  repository: Repository,\n  file: FileChange,\n  diff: IRawDiff,\n  commitish: string,\n  lineEndingsChange?: LineEndingsChange\n): Promise<IDiff> {\n  const extension = Path.extname(file.path).toLowerCase()\n\n  if (diff.isBinary) {\n    // some extension we don't know how to parse, never mind\n    if (!imageFileExtensions.has(extension)) {\n      return {\n        kind: DiffType.Binary,\n      }\n    } else {\n      return getImageDiff(repository, file, commitish)\n    }\n  }\n\n  return {\n    kind: DiffType.Text,\n    text: diff.contents,\n    hunks: diff.hunks,\n    lineEndingsChange,\n  }\n}\n\n/**\n * Map a given file extension to the related data URL media type\n */\nfunction getMediaType(extension: string) {\n  if (extension === '.png') {\n    return 'image/png'\n  }\n  if (extension === '.jpg' || extension === '.jpeg') {\n    return 'image/jpg'\n  }\n  if (extension === '.gif') {\n    return 'image/gif'\n  }\n  if (extension === '.ico') {\n    return 'image/x-icon'\n  }\n  if (extension === '.webp') {\n    return 'image/webp'\n  }\n  if (extension === '.bmp') {\n    return 'image/bmp'\n  }\n\n  // fallback value as per the spec\n  return 'text/plain'\n}\n\n/**\n * `git diff` will write out messages about the line ending changes it knows\n * about to `stderr` - this rule here will catch this and also the to/from\n * changes based on what the user has configured.\n */\nconst lineEndingsChangeRegex = /warning: (CRLF|CR|LF) will be replaced by (CRLF|CR|LF) in .*/\n\n/**\n * Utility function for inspecting the stderr output for the line endings\n * warning that Git may report.\n *\n * @param error A buffer of binary text from a spawned process\n */\nfunction parseLineEndingsWarning(error: Buffer): LineEndingsChange | undefined {\n  if (error.length === 0) {\n    return undefined\n  }\n\n  const errorText = error.toString('utf-8')\n  const match = lineEndingsChangeRegex.exec(errorText)\n  if (match) {\n    const from = parseLineEndingText(match[1])\n    const to = parseLineEndingText(match[2])\n    if (from && to) {\n      return { from, to }\n    }\n  }\n\n  return undefined\n}\n\n/**\n * Utility function used by get(Commit|WorkingDirectory)Diff.\n *\n * Parses the output from a diff-like command that uses `--path-with-raw`\n */\nfunction diffFromRawDiffOutput(output: Buffer): IRawDiff {\n  // for now we just assume the diff is UTF-8, but given we have the raw buffer\n  // we can try and convert this into other encodings in the future\n  const result = output.toString('utf-8')\n\n  const pieces = result.split('\\0')\n  const parser = new DiffParser()\n  return parser.parse(pieces[pieces.length - 1])\n}\n\nfunction buildDiff(\n  buffer: Buffer,\n  repository: Repository,\n  file: FileChange,\n  commitish: string,\n  lineEndingsChange?: LineEndingsChange\n): Promise<IDiff> {\n  if (!isValidBuffer(buffer)) {\n    // the buffer's diff is too large to be renderable in the UI\n    return Promise.resolve<IUnrenderableDiff>({ kind: DiffType.Unrenderable })\n  }\n\n  const diff = diffFromRawDiffOutput(buffer)\n\n  if (isBufferTooLarge(buffer) || isDiffTooLarge(diff)) {\n    // we don't want to render by default\n    // but we keep it as an option by\n    // passing in text and hunks\n    const largeTextDiff: ILargeTextDiff = {\n      kind: DiffType.LargeText,\n      text: diff.contents,\n      hunks: diff.hunks,\n      lineEndingsChange,\n    }\n\n    return Promise.resolve(largeTextDiff)\n  }\n\n  return convertDiff(repository, file, diff, commitish, lineEndingsChange)\n}\n\n/**\n * Retrieve the binary contents of a blob from the object database\n *\n * Returns an image object containing the base64 encoded string,\n * as <img> tags support the data URI scheme instead of\n * needing to reference a file:// URI\n *\n * https://en.wikipedia.org/wiki/Data_URI_scheme\n */\nexport async function getBlobImage(\n  repository: Repository,\n  path: string,\n  commitish: string\n): Promise<Image> {\n  const extension = Path.extname(path)\n  const contents = await getBlobContents(repository, commitish, path)\n  return new Image(\n    contents.toString('base64'),\n    getMediaType(extension),\n    contents.length\n  )\n}\n/**\n * Retrieve the binary contents of a blob from the working directory\n *\n * Returns an image object containing the base64 encoded string,\n * as <img> tags support the data URI scheme instead of\n * needing to reference a file:// URI\n *\n * https://en.wikipedia.org/wiki/Data_URI_scheme\n */\nexport async function getWorkingDirectoryImage(\n  repository: Repository,\n  file: FileChange\n): Promise<Image> {\n  const contents = await fileSystem.readFile(\n    Path.join(repository.path, file.path)\n  )\n  return new Image(\n    contents.toString('base64'),\n    getMediaType(Path.extname(file.path)),\n    contents.length\n  )\n}\n","/*\n * This file is automatically generated by the generate-octicons tool.\n * Manually changing this file will only lead to sadness.\n */\n\nexport class OcticonSymbol {\n  public constructor(public w: number, public h: number, public d: string) {}\n\n  public static get alert() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M8.865 1.52c-.18-.31-.51-.5-.87-.5s-.69.19-.87.5L.275 13.5c-.18.31-.18.69 0 1 .19.31.52.5.87.5h13.7c.36 0 .69-.19.86-.5.17-.31.18-.69.01-1L8.865 1.52zM8.995 13h-2v-2h2v2zm0-3h-2V6h2v4z'\n    )\n  }\n  public static get arrowDown() {\n    return new OcticonSymbol(10, 16, 'M7 7V3H3v4H0l5 6 5-6z')\n  }\n  public static get arrowLeft() {\n    return new OcticonSymbol(10, 16, 'M6 3L0 8l6 5v-3h4V6H6z')\n  }\n  public static get arrowRight() {\n    return new OcticonSymbol(10, 16, 'M10 8L4 3v3H0v4h4v3z')\n  }\n  public static get arrowSmallDown() {\n    return new OcticonSymbol(6, 16, 'M4 7V5H2v2H0l3 4 3-4z')\n  }\n  public static get arrowSmallLeft() {\n    return new OcticonSymbol(6, 16, 'M4 7V5L0 8l4 3V9h2V7z')\n  }\n  public static get arrowSmallRight() {\n    return new OcticonSymbol(6, 16, 'M6 8L2 5v2H0v2h2v2z')\n  }\n  public static get arrowSmallUp() {\n    return new OcticonSymbol(6, 16, 'M3 5L0 9h2v2h2V9h2z')\n  }\n  public static get arrowUp() {\n    return new OcticonSymbol(10, 16, 'M5 3L0 9h3v4h4V9h3z')\n  }\n  public static get beaker() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M14.38 14.59L11 7V3h1V2H3v1h1v4L.63 14.59A1 1 0 0 0 1.54 16h11.94c.72 0 1.2-.75.91-1.41h-.01zM3.75 10L5 7V3h5v4l1.25 3h-7.5zM8 8h1v1H8V8zM7 7H6V6h1v1zm0-3h1v1H7V4zm0-3H6V0h1v1z'\n    )\n  }\n  public static get bell() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M14 12v1H0v-1l.73-.58c.77-.77.81-2.55 1.19-4.42C2.69 3.23 6 2 6 2c0-.55.45-1 1-1s1 .45 1 1c0 0 3.39 1.23 4.16 5 .38 1.88.42 3.66 1.19 4.42l.66.58H14zm-7 4c1.11 0 2-.89 2-2H5c0 1.11.89 2 2 2z'\n    )\n  }\n  public static get bold() {\n    return new OcticonSymbol(\n      10,\n      16,\n      'M1 2h3.83c2.48 0 4.3.75 4.3 2.95 0 1.14-.63 2.23-1.67 2.61v.06c1.33.3 2.3 1.23 2.3 2.86 0 2.39-1.97 3.52-4.61 3.52H1V2zm3.66 4.95c1.67 0 2.38-.66 2.38-1.69 0-1.17-.78-1.61-2.34-1.61H3.13v3.3h1.53zm.27 5.39c1.77 0 2.75-.64 2.75-1.98 0-1.27-.95-1.81-2.75-1.81h-1.8v3.8h1.8v-.01z'\n    )\n  }\n  public static get book() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M3 5h4v1H3V5zm0 3h4V7H3v1zm0 2h4V9H3v1zm11-5h-4v1h4V5zm0 2h-4v1h4V7zm0 2h-4v1h4V9zm2-6v9c0 .55-.45 1-1 1H9.5l-1 1-1-1H2c-.55 0-1-.45-1-1V3c0-.55.45-1 1-1h5.5l1 1 1-1H15c.55 0 1 .45 1 1zm-8 .5L7.5 3H2v9h6V3.5zm7-.5H9.5l-.5.5V12h6V3z'\n    )\n  }\n  public static get bookmark() {\n    return new OcticonSymbol(\n      10,\n      16,\n      'M9 0H1C.27 0 0 .27 0 1v15l5-3.09L10 16V1c0-.73-.27-1-1-1zm-.78 4.25L6.36 5.61l.72 2.16c.06.22-.02.28-.2.17L5 6.6 3.12 7.94c-.19.11-.25.05-.2-.17l.72-2.16-1.86-1.36c-.17-.16-.14-.23.09-.23l2.3-.03.7-2.16h.25l.7 2.16 2.3.03c.23 0 .27.08.09.23h.01z'\n    )\n  }\n  public static get briefcase() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M9 4V3c0-.55-.45-1-1-1H6c-.55 0-1 .45-1 1v1H1c-.55 0-1 .45-1 1v8c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V5c0-.55-.45-1-1-1H9zM6 3h2v1H6V3zm7 6H8v1H6V9H1V5h1v3h10V5h1v4z'\n    )\n  }\n  public static get broadcast() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M9 9H8c.55 0 1-.45 1-1V7c0-.55-.45-1-1-1H7c-.55 0-1 .45-1 1v1c0 .55.45 1 1 1H6c-.55 0-1 .45-1 1v2h1v3c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-3h1v-2c0-.55-.45-1-1-1zM7 7h1v1H7V7zm2 4H8v4H7v-4H6v-1h3v1zm2.09-3.5c0-1.98-1.61-3.59-3.59-3.59A3.593 3.593 0 0 0 4 8.31v1.98c-.61-.77-1-1.73-1-2.8 0-2.48 2.02-4.5 4.5-4.5S12 5.01 12 7.49c0 1.06-.39 2.03-1 2.8V8.31c.06-.27.09-.53.09-.81zm3.91 0c0 2.88-1.63 5.38-4 6.63v-1.05a6.553 6.553 0 0 0 3.09-5.58A6.59 6.59 0 0 0 7.5.91 6.59 6.59 0 0 0 .91 7.5c0 2.36 1.23 4.42 3.09 5.58v1.05A7.497 7.497 0 0 1 7.5 0C11.64 0 15 3.36 15 7.5z'\n    )\n  }\n  public static get browser() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M5 3h1v1H5V3zM3 3h1v1H3V3zM1 3h1v1H1V3zm12 10H1V5h12v8zm0-9H7V3h6v1zm1-1c0-.55-.45-1-1-1H1c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V3z'\n    )\n  }\n  public static get bug() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M11 10h3V9h-3V8l3.17-1.03-.34-.94L11 7V6c0-.55-.45-1-1-1V4c0-.48-.36-.88-.83-.97L10.2 2H12V1H9.8l-2 2h-.59L5.2 1H3v1h1.8l1.03 1.03C5.36 3.12 5 3.51 5 4v1c-.55 0-1 .45-1 1v1l-2.83-.97-.34.94L4 8v1H1v1h3v1L.83 12.03l.34.94L4 12v1c0 .55.45 1 1 1h1l1-1V6h1v7l1 1h1c.55 0 1-.45 1-1v-1l2.83.97.34-.94L11 11v-1zM9 5H6V4h3v1z'\n    )\n  }\n  public static get calendar() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M13 2h-1v1.5c0 .28-.22.5-.5.5h-2c-.28 0-.5-.22-.5-.5V2H6v1.5c0 .28-.22.5-.5.5h-2c-.28 0-.5-.22-.5-.5V2H2c-.55 0-1 .45-1 1v11c0 .55.45 1 1 1h11c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm0 12H2V5h11v9zM5 3H4V1h1v2zm6 0h-1V1h1v2zM6 7H5V6h1v1zm2 0H7V6h1v1zm2 0H9V6h1v1zm2 0h-1V6h1v1zM4 9H3V8h1v1zm2 0H5V8h1v1zm2 0H7V8h1v1zm2 0H9V8h1v1zm2 0h-1V8h1v1zm-8 2H3v-1h1v1zm2 0H5v-1h1v1zm2 0H7v-1h1v1zm2 0H9v-1h1v1zm2 0h-1v-1h1v1zm-8 2H3v-1h1v1zm2 0H5v-1h1v1zm2 0H7v-1h1v1zm2 0H9v-1h1v1z'\n    )\n  }\n  public static get check() {\n    return new OcticonSymbol(12, 16, 'M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5z')\n  }\n  public static get checklist() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M16 8.5l-6 6-3-3L8.5 10l1.5 1.5L14.5 7 16 8.5zM5.7 12.2l.8.8H2c-.55 0-1-.45-1-1V3c0-.55.45-1 1-1h7c.55 0 1 .45 1 1v6.5l-.8-.8c-.39-.39-1.03-.39-1.42 0L5.7 10.8a.996.996 0 0 0 0 1.41v-.01zM4 4h5V3H4v1zm0 2h5V5H4v1zm0 2h3V7H4v1zM3 9H2v1h1V9zm0-2H2v1h1V7zm0-2H2v1h1V5zm0-2H2v1h1V3z'\n    )\n  }\n  public static get chevronDown() {\n    return new OcticonSymbol(10, 16, 'M5 11L0 6l1.5-1.5L5 8.25 8.5 4.5 10 6z')\n  }\n  public static get chevronLeft() {\n    return new OcticonSymbol(8, 16, 'M5.5 3L7 4.5 3.25 8 7 11.5 5.5 13l-5-5z')\n  }\n  public static get chevronRight() {\n    return new OcticonSymbol(8, 16, 'M7.5 8l-5 5L1 11.5 4.75 8 1 4.5 2.5 3z')\n  }\n  public static get chevronUp() {\n    return new OcticonSymbol(\n      10,\n      16,\n      'M10 10l-1.5 1.5L5 7.75 1.5 11.5 0 10l5-5z'\n    )\n  }\n  public static get circleSlash() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm0 1.3c1.3 0 2.5.44 3.47 1.17l-8 8A5.755 5.755 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zm0 11.41c-1.3 0-2.5-.44-3.47-1.17l8-8c.73.97 1.17 2.17 1.17 3.47 0 3.14-2.56 5.7-5.7 5.7z'\n    )\n  }\n  public static get circuitBoard() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M3 5c0-.55.45-1 1-1s1 .45 1 1-.45 1-1 1-1-.45-1-1zm8 0c0-.55-.45-1-1-1s-1 .45-1 1 .45 1 1 1 1-.45 1-1zm0 6c0-.55-.45-1-1-1s-1 .45-1 1 .45 1 1 1 1-.45 1-1zm2-10H5v2.17c.36.19.64.47.83.83h2.34c.42-.78 1.33-1.28 2.34-1.05.75.19 1.36.8 1.53 1.55.31 1.38-.72 2.59-2.05 2.59-.8 0-1.48-.44-1.83-1.09H5.83c-.42.8-1.33 1.28-2.34 1.03-.73-.17-1.34-.78-1.52-1.52C1.72 4.49 2.2 3.59 3 3.17V1H1c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1l5-5h2.17c.42-.78 1.33-1.28 2.34-1.05.75.19 1.36.8 1.53 1.55.31 1.38-.72 2.59-2.05 2.59-.8 0-1.48-.44-1.83-1.09H6.99L4 15h9c.55 0 1-.45 1-1V2c0-.55-.45-1-1-1z'\n    )\n  }\n  public static get clippy() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M2 13h4v1H2v-1zm5-6H2v1h5V7zm2 3V8l-3 3 3 3v-2h5v-2H9zM4.5 9H2v1h2.5V9zM2 12h2.5v-1H2v1zm9 1h1v2c-.02.28-.11.52-.3.7-.19.18-.42.28-.7.3H1c-.55 0-1-.45-1-1V4c0-.55.45-1 1-1h3c0-1.11.89-2 2-2 1.11 0 2 .89 2 2h3c.55 0 1 .45 1 1v5h-1V6H1v9h10v-2zM2 5h8c0-.55-.45-1-1-1H8c-.55 0-1-.45-1-1s-.45-1-1-1-1 .45-1 1-.45 1-1 1H3c-.55 0-1 .45-1 1z'\n    )\n  }\n  public static get clock() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M8 8h3v2H7c-.55 0-1-.45-1-1V4h2v4zM7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7z'\n    )\n  }\n  public static get cloudDownload() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M9 12h2l-3 3-3-3h2V7h2v5zm3-8c0-.44-.91-3-4.5-3C5.08 1 3 2.92 3 5 1.02 5 0 6.52 0 8c0 1.53 1 3 3 3h3V9.7H3C1.38 9.7 1.3 8.28 1.3 8c0-.17.05-1.7 1.7-1.7h1.3V5c0-1.39 1.56-2.7 3.2-2.7 2.55 0 3.13 1.55 3.2 1.8v1.2H12c.81 0 2.7.22 2.7 2.2 0 2.09-2.25 2.2-2.7 2.2h-2V11h2c2.08 0 4-1.16 4-3.5C16 5.06 14.08 4 12 4z'\n    )\n  }\n  public static get cloudUpload() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M7 9H5l3-3 3 3H9v5H7V9zm5-4c0-.44-.91-3-4.5-3C5.08 2 3 3.92 3 6 1.02 6 0 7.52 0 9c0 1.53 1 3 3 3h3v-1.3H3c-1.62 0-1.7-1.42-1.7-1.7 0-.17.05-1.7 1.7-1.7h1.3V6c0-1.39 1.56-2.7 3.2-2.7 2.55 0 3.13 1.55 3.2 1.8v1.2H12c.81 0 2.7.22 2.7 2.2 0 2.09-2.25 2.2-2.7 2.2h-2V12h2c2.08 0 4-1.16 4-3.5C16 6.06 14.08 5 12 5z'\n    )\n  }\n  public static get code() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M9.5 3L8 4.5 11.5 8 8 11.5 9.5 13 14 8 9.5 3zm-5 0L0 8l4.5 5L6 11.5 2.5 8 6 4.5 4.5 3z'\n    )\n  }\n  public static get comment() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M14 1H2c-.55 0-1 .45-1 1v8c0 .55.45 1 1 1h2v3.5L7.5 11H14c.55 0 1-.45 1-1V2c0-.55-.45-1-1-1zm0 9H7l-2 2v-2H2V2h12v8z'\n    )\n  }\n  public static get commentDiscussion() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M15 1H6c-.55 0-1 .45-1 1v2H1c-.55 0-1 .45-1 1v6c0 .55.45 1 1 1h1v3l3-3h4c.55 0 1-.45 1-1V9h1l3 3V9h1c.55 0 1-.45 1-1V2c0-.55-.45-1-1-1zM9 11H4.5L3 12.5V11H1V5h4v3c0 .55.45 1 1 1h3v2zm6-3h-2v1.5L11.5 8H6V2h9v6z'\n    )\n  }\n  public static get creditCard() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M12 9H2V8h10v1zm4-6v9c0 .55-.45 1-1 1H1c-.55 0-1-.45-1-1V3c0-.55.45-1 1-1h14c.55 0 1 .45 1 1zm-1 3H1v6h14V6zm0-3H1v1h14V3zm-9 7H2v1h4v-1z'\n    )\n  }\n  public static get dash() {\n    return new OcticonSymbol(8, 16, 'M0 7v2h8V7z')\n  }\n  public static get dashboard() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M9 5H8V4h1v1zm4 3h-1v1h1V8zM6 5H5v1h1V5zM5 8H4v1h1V8zm11-5.5l-.5-.5L9 7c-.06-.02-1 0-1 0-.55 0-1 .45-1 1v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-.92l6-5.58zm-1.59 4.09c.19.61.3 1.25.3 1.91 0 3.42-2.78 6.2-6.2 6.2-3.42 0-6.21-2.78-6.21-6.2 0-3.42 2.78-6.2 6.2-6.2 1.2 0 2.31.34 3.27.94l.94-.94A7.459 7.459 0 0 0 8.51 1C4.36 1 1 4.36 1 8.5 1 12.64 4.36 16 8.5 16c4.14 0 7.5-3.36 7.5-7.5 0-1.03-.2-2.02-.59-2.91l-1 1z'\n    )\n  }\n  public static get database() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M6 15c-3.31 0-6-.9-6-2v-2c0-.17.09-.34.21-.5.67.86 3 1.5 5.79 1.5s5.12-.64 5.79-1.5c.13.16.21.33.21.5v2c0 1.1-2.69 2-6 2zm0-4c-3.31 0-6-.9-6-2V7c0-.11.04-.21.09-.31.03-.06.07-.13.12-.19C.88 7.36 3.21 8 6 8s5.12-.64 5.79-1.5c.05.06.09.13.12.19.05.1.09.21.09.31v2c0 1.1-2.69 2-6 2zm0-4c-3.31 0-6-.9-6-2V3c0-1.1 2.69-2 6-2s6 .9 6 2v2c0 1.1-2.69 2-6 2zm0-5c-2.21 0-4 .45-4 1s1.79 1 4 1 4-.45 4-1-1.79-1-4-1z'\n    )\n  }\n  public static get desktopDownload() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M4 6h3V0h2v6h3l-4 4-4-4zm11-4h-4v1h4v8H1V3h4V2H1c-.55 0-1 .45-1 1v9c0 .55.45 1 1 1h5.34c-.25.61-.86 1.39-2.34 2h8c-1.48-.61-2.09-1.39-2.34-2H15c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1z'\n    )\n  }\n  public static get deviceCamera() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M15 3H7c0-.55-.45-1-1-1H2c-.55 0-1 .45-1 1-.55 0-1 .45-1 1v9c0 .55.45 1 1 1h14c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1zM6 5H2V4h4v1zm4.5 7C8.56 12 7 10.44 7 8.5S8.56 5 10.5 5 14 6.56 14 8.5 12.44 12 10.5 12zM13 8.5c0 1.38-1.13 2.5-2.5 2.5S8 9.87 8 8.5 9.13 6 10.5 6 13 7.13 13 8.5z'\n    )\n  }\n  public static get deviceCameraVideo() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M15.2 2.09L10 5.72V3c0-.55-.45-1-1-1H1c-.55 0-1 .45-1 1v9c0 .55.45 1 1 1h8c.55 0 1-.45 1-1V9.28l5.2 3.63c.33.23.8 0 .8-.41v-10c0-.41-.47-.64-.8-.41z'\n    )\n  }\n  public static get deviceDesktop() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M15 2H1c-.55 0-1 .45-1 1v9c0 .55.45 1 1 1h5.34c-.25.61-.86 1.39-2.34 2h8c-1.48-.61-2.09-1.39-2.34-2H15c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm0 9H1V3h14v8z'\n    )\n  }\n  public static get deviceMobile() {\n    return new OcticonSymbol(\n      10,\n      16,\n      'M9 0H1C.45 0 0 .45 0 1v14c0 .55.45 1 1 1h8c.55 0 1-.45 1-1V1c0-.55-.45-1-1-1zM5 15.3c-.72 0-1.3-.58-1.3-1.3 0-.72.58-1.3 1.3-1.3.72 0 1.3.58 1.3 1.3 0 .72-.58 1.3-1.3 1.3zM9 12H1V2h8v10z'\n    )\n  }\n  public static get diff() {\n    return new OcticonSymbol(\n      13,\n      16,\n      'M6 7h2v1H6v2H5V8H3V7h2V5h1v2zm-3 6h5v-1H3v1zM7.5 2L11 5.5V15c0 .55-.45 1-1 1H1c-.55 0-1-.45-1-1V3c0-.55.45-1 1-1h6.5zM10 6L7 3H1v12h9V6zM8.5 0H3v1h5l4 4v8h1V4.5L8.5 0z'\n    )\n  }\n  public static get diffAdded() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M13 1H1c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V2c0-.55-.45-1-1-1zm0 13H1V2h12v12zM6 9H3V7h3V4h2v3h3v2H8v3H6V9z'\n    )\n  }\n  public static get diffIgnored() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M13 1H1c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V2c0-.55-.45-1-1-1zm0 13H1V2h12v12zm-8.5-2H3v-1.5L9.5 4H11v1.5L4.5 12z'\n    )\n  }\n  public static get diffModified() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M13 1H1c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V2c0-.55-.45-1-1-1zm0 13H1V2h12v12zM4 8c0-1.66 1.34-3 3-3s3 1.34 3 3-1.34 3-3 3-3-1.34-3-3z'\n    )\n  }\n  public static get diffRemoved() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M13 1H1c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V2c0-.55-.45-1-1-1zm0 13H1V2h12v12zm-2-5H3V7h8v2z'\n    )\n  }\n  public static get diffRenamed() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M6 9H3V7h3V4l5 4-5 4V9zm8-7v12c0 .55-.45 1-1 1H1c-.55 0-1-.45-1-1V2c0-.55.45-1 1-1h12c.55 0 1 .45 1 1zm-1 0H1v12h12V2z'\n    )\n  }\n  public static get ellipsis() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M11 5H1c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h10c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1zM4 9H2V7h2v2zm3 0H5V7h2v2zm3 0H8V7h2v2z'\n    )\n  }\n  public static get eye() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z'\n    )\n  }\n  public static get file() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M6 5H2V4h4v1zM2 8h7V7H2v1zm0 2h7V9H2v1zm0 2h7v-1H2v1zm10-7.5V14c0 .55-.45 1-1 1H1c-.55 0-1-.45-1-1V2c0-.55.45-1 1-1h7.5L12 4.5zM11 5L8 2H1v12h10V5z'\n    )\n  }\n  public static get fileBinary() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M4 12h1v1H2v-1h1v-2H2V9h2v3zm8-7.5V14c0 .55-.45 1-1 1H1c-.55 0-1-.45-1-1V2c0-.55.45-1 1-1h7.5L12 4.5zM11 5L8 2H1v12h10V5zM8 4H6v1h1v2H6v1h3V7H8V4zM2 4h3v4H2V4zm1 3h1V5H3v2zm3 2h3v4H6V9zm1 3h1v-2H7v2z'\n    )\n  }\n  public static get fileCode() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M8.5 1H1c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h10c.55 0 1-.45 1-1V4.5L8.5 1zM11 14H1V2h7l3 3v9zM5 6.98L3.5 8.5 5 10l-.5 1L2 8.5 4.5 6l.5.98zM7.5 6L10 8.5 7.5 11l-.5-.98L8.5 8.5 7 7l.5-1z'\n    )\n  }\n  public static get fileDirectory() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M13 4H7V3c0-.66-.31-1-1-1H1c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V5c0-.55-.45-1-1-1zM6 4H1V3h5v1z'\n    )\n  }\n  public static get fileMedia() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M6 5h2v2H6V5zm6-.5V14c0 .55-.45 1-1 1H1c-.55 0-1-.45-1-1V2c0-.55.45-1 1-1h7.5L12 4.5zM11 5L8 2H1v11l3-5 2 4 2-2 3 3V5z'\n    )\n  }\n  public static get filePdf() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M8.5 1H1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V4.5L8.5 1zM1 2h4a.68.68 0 0 0-.31.2 1.08 1.08 0 0 0-.23.47 4.22 4.22 0 0 0-.09 1.47c.06.609.173 1.211.34 1.8A21.78 21.78 0 0 1 3.6 8.6c-.5 1-.8 1.66-.91 1.84a7.16 7.16 0 0 0-.69.3 4.19 4.19 0 0 0-1 .64V2zm4.42 4.8a5.65 5.65 0 0 0 1.17 2.09c.275.237.595.417.94.53-.64.09-1.23.2-1.81.33a12.22 12.22 0 0 0-1.81.59c-.587.243.22-.44.61-1.25.365-.74.67-1.51.91-2.3l-.01.01zM11 14H1.5a.74.74 0 0 1-.17 0 2.12 2.12 0 0 0 .73-.44 10.14 10.14 0 0 0 1.78-2.38c.31-.13.58-.23.81-.31l.42-.14c.45-.13.94-.23 1.44-.33s1-.16 1.48-.2a8.65 8.65 0 0 0 1.39.53c.403.11.814.188 1.23.23h.38V14H11zm0-4.86a3.74 3.74 0 0 0-.64-.28 4.22 4.22 0 0 0-.75-.11c-.411.003-.822.03-1.23.08a3 3 0 0 1-1-.64 6.07 6.07 0 0 1-1.29-2.33c.111-.661.178-1.33.2-2 .02-.25.02-.5 0-.75a1.05 1.05 0 0 0-.2-.88.82.82 0 0 0-.61-.23H8l3 3v4.14z'\n    )\n  }\n  public static get fileSubmodule() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M10 7H4v7h9c.55 0 1-.45 1-1V8h-4V7zM9 9H5V8h4v1zm4-5H7V3c0-.66-.31-1-1-1H1c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h2V7c0-.55.45-1 1-1h6c.55 0 1 .45 1 1h3V5c0-.55-.45-1-1-1zM6 4H1V3h5v1z'\n    )\n  }\n  public static get fileSymlinkDirectory() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M13 4H7V3c0-.66-.31-1-1-1H1c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V5c0-.55-.45-1-1-1zM1 3h5v1H1V3zm6 9v-2c-.98-.02-1.84.22-2.55.7-.71.48-1.19 1.25-1.45 2.3.02-1.64.39-2.88 1.13-3.73C4.86 8.43 5.82 8 7.01 8V6l4 3-4 3H7z'\n    )\n  }\n  public static get fileSymlinkFile() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M8.5 1H1c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h10c.55 0 1-.45 1-1V4.5L8.5 1zM11 14H1V2h7l3 3v9zM6 4.5l4 3-4 3v-2c-.98-.02-1.84.22-2.55.7-.71.48-1.19 1.25-1.45 2.3.02-1.64.39-2.88 1.13-3.73.73-.84 1.69-1.27 2.88-1.27v-2H6z'\n    )\n  }\n  public static get fileZip() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M8.5 1H1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V4.5L8.5 1zM11 14H1V2h3v1h1V2h3l3 3v9zM5 4V3h1v1H5zM4 4h1v1H4V4zm1 2V5h1v1H5zM4 6h1v1H4V6zm1 2V7h1v1H5zM4 9.28A2 2 0 0 0 3 11v1h4v-1a2 2 0 0 0-2-2V8H4v1.28zM6 10v1H4v-1h2z'\n    )\n  }\n  public static get flame() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z'\n    )\n  }\n  public static get fold() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M7 9l3 3H8v3H6v-3H4l3-3zm3-6H8V0H6v3H4l3 3 3-3zm4 2c0-.55-.45-1-1-1h-2.5l-1 1h3l-2 2h-7l-2-2h3l-1-1H1c-.55 0-1 .45-1 1l2.5 2.5L0 10c0 .55.45 1 1 1h2.5l1-1h-3l2-2h7l2 2h-3l1 1H13c.55 0 1-.45 1-1l-2.5-2.5L14 5z'\n    )\n  }\n  public static get gear() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M14 8.77v-1.6l-1.94-.64-.45-1.09.88-1.84-1.13-1.13-1.81.91-1.09-.45-.69-1.92h-1.6l-.63 1.94-1.11.45-1.84-.88-1.13 1.13.91 1.81-.45 1.09L0 7.23v1.59l1.94.64.45 1.09-.88 1.84 1.13 1.13 1.81-.91 1.09.45.69 1.92h1.59l.63-1.94 1.11-.45 1.84.88 1.13-1.13-.92-1.81.47-1.09L14 8.75v.02zM7 11c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3z'\n    )\n  }\n  public static get gift() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M13 4h-1.38c.19-.33.33-.67.36-.91.06-.67-.11-1.22-.52-1.61C11.1 1.1 10.65 1 10.1 1h-.11c-.53.02-1.11.25-1.53.58-.42.33-.73.72-.97 1.2-.23-.48-.55-.88-.97-1.2-.42-.32-1-.58-1.53-.58h-.03c-.56 0-1.06.09-1.44.48-.41.39-.58.94-.52 1.61.03.23.17.58.36.91H1.98c-.55 0-1 .45-1 1v3h1v5c0 .55.45 1 1 1h9c.55 0 1-.45 1-1V8h1V5c0-.55-.45-1-1-1H13zm-4.78-.88c.17-.36.42-.67.75-.92.3-.23.72-.39 1.05-.41h.09c.45 0 .66.11.8.25s.33.39.3.95c-.05.19-.25.61-.5 1h-2.9l.41-.88v.01zM4.09 2.04c.13-.13.31-.25.91-.25.31 0 .72.17 1.03.41.33.25.58.55.75.92L7.2 4H4.3c-.25-.39-.45-.81-.5-1-.03-.56.16-.81.3-.95l-.01-.01zM7 12.99H3V8h4v5-.01zm0-6H2V5h5v2-.01zm5 6H8V8h4v5-.01zm1-6H8V5h5v2-.01z'\n    )\n  }\n  public static get gist() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M7.5 5L10 7.5 7.5 10l-.75-.75L8.5 7.5 6.75 5.75 7.5 5zm-3 0L2 7.5 4.5 10l.75-.75L3.5 7.5l1.75-1.75L4.5 5zM0 13V2c0-.55.45-1 1-1h10c.55 0 1 .45 1 1v11c0 .55-.45 1-1 1H1c-.55 0-1-.45-1-1zm1 0h10V2H1v11z'\n    )\n  }\n  public static get gistSecret() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M8 10.5L9 14H5l1-3.5L5.25 9h3.5L8 10.5zM10 6H4L2 7h10l-2-1zM9 2L7 3 5 2 4 5h6L9 2zm4.03 7.75L10 9l1 2-2 3h3.22c.45 0 .86-.31.97-.75l.56-2.28c.14-.53-.19-1.08-.72-1.22zM4 9l-3.03.75c-.53.14-.86.69-.72 1.22l.56 2.28c.11.44.52.75.97.75H5l-2-3 1-2z'\n    )\n  }\n  public static get gitBranch() {\n    return new OcticonSymbol(\n      10,\n      16,\n      'M10 5c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v.3c-.02.52-.23.98-.63 1.38-.4.4-.86.61-1.38.63-.83.02-1.48.16-2 .45V4.72a1.993 1.993 0 0 0-1-3.72C.88 1 0 1.89 0 3a2 2 0 0 0 1 1.72v6.56c-.59.35-1 .99-1 1.72 0 1.11.89 2 2 2 1.11 0 2-.89 2-2 0-.53-.2-1-.53-1.36.09-.06.48-.41.59-.47.25-.11.56-.17.94-.17 1.05-.05 1.95-.45 2.75-1.25S8.95 7.77 9 6.73h-.02C9.59 6.37 10 5.73 10 5zM2 1.8c.66 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2C1.35 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2zm0 12.41c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm6-8c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z'\n    )\n  }\n  public static get gitCommit() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z'\n    )\n  }\n  public static get gitCompare() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M5 12H4c-.27-.02-.48-.11-.69-.31-.21-.2-.3-.42-.31-.69V4.72A1.993 1.993 0 0 0 2 1a1.993 1.993 0 0 0-1 3.72V11c.03.78.34 1.47.94 2.06.6.59 1.28.91 2.06.94h1v2l3-3-3-3v2zM2 1.8c.66 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2C1.35 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2zm11 9.48V5c-.03-.78-.34-1.47-.94-2.06-.6-.59-1.28-.91-2.06-.94H9V0L6 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 12 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z'\n    )\n  }\n  public static get gitMerge() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M10 7c-.73 0-1.38.41-1.73 1.02V8C7.22 7.98 6 7.64 5.14 6.98c-.75-.58-1.5-1.61-1.89-2.44A1.993 1.993 0 0 0 2 .99C.89.99 0 1.89 0 3a2 2 0 0 0 1 1.72v6.56c-.59.35-1 .99-1 1.72 0 1.11.89 2 2 2a1.993 1.993 0 0 0 1-3.72V7.67c.67.7 1.44 1.27 2.3 1.69.86.42 2.03.63 2.97.64v-.02c.36.61 1 1.02 1.73 1.02 1.11 0 2-.89 2-2 0-1.11-.89-2-2-2zm-6.8 6c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm8 6c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z'\n    )\n  }\n  public static get gitPullRequest() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z'\n    )\n  }\n  public static get globe() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M7 1C3.14 1 0 4.14 0 8s3.14 7 7 7c.48 0 .94-.05 1.38-.14-.17-.08-.2-.73-.02-1.09.19-.41.81-1.45.2-1.8-.61-.35-.44-.5-.81-.91-.37-.41-.22-.47-.25-.58-.08-.34.36-.89.39-.94.02-.06.02-.27 0-.33 0-.08-.27-.22-.34-.23-.06 0-.11.11-.2.13-.09.02-.5-.25-.59-.33-.09-.08-.14-.23-.27-.34-.13-.13-.14-.03-.33-.11s-.8-.31-1.28-.48c-.48-.19-.52-.47-.52-.66-.02-.2-.3-.47-.42-.67-.14-.2-.16-.47-.2-.41-.04.06.25.78.2.81-.05.02-.16-.2-.3-.38-.14-.19.14-.09-.3-.95s.14-1.3.17-1.75c.03-.45.38.17.19-.13-.19-.3 0-.89-.14-1.11-.13-.22-.88.25-.88.25.02-.22.69-.58 1.16-.92.47-.34.78-.06 1.16.05.39.13.41.09.28-.05-.13-.13.06-.17.36-.13.28.05.38.41.83.36.47-.03.05.09.11.22s-.06.11-.38.3c-.3.2.02.22.55.61s.38-.25.31-.55c-.07-.3.39-.06.39-.06.33.22.27.02.5.08.23.06.91.64.91.64-.83.44-.31.48-.17.59.14.11-.28.3-.28.3-.17-.17-.19.02-.3.08-.11.06-.02.22-.02.22-.56.09-.44.69-.42.83 0 .14-.38.36-.47.58-.09.2.25.64.06.66-.19.03-.34-.66-1.31-.41-.3.08-.94.41-.59 1.08.36.69.92-.19 1.11-.09.19.1-.06.53-.02.55.04.02.53.02.56.61.03.59.77.53.92.55.17 0 .7-.44.77-.45.06-.03.38-.28 1.03.09.66.36.98.31 1.2.47.22.16.08.47.28.58.2.11 1.06-.03 1.28.31.22.34-.88 2.09-1.22 2.28-.34.19-.48.64-.84.92s-.81.64-1.27.91c-.41.23-.47.66-.66.8 3.14-.7 5.48-3.5 5.48-6.84 0-3.86-3.14-7-7-7L7 1zm1.64 6.56c-.09.03-.28.22-.78-.08-.48-.3-.81-.23-.86-.28 0 0-.05-.11.17-.14.44-.05.98.41 1.11.41.13 0 .19-.13.41-.05.22.08.05.13-.05.14zM6.34 1.7c-.05-.03.03-.08.09-.14.03-.03.02-.11.05-.14.11-.11.61-.25.52.03-.11.27-.58.3-.66.25zm1.23.89c-.19-.02-.58-.05-.52-.14.3-.28-.09-.38-.34-.38-.25-.02-.34-.16-.22-.19.12-.03.61.02.7.08.08.06.52.25.55.38.02.13 0 .25-.17.25zm1.47-.05c-.14.09-.83-.41-.95-.52-.56-.48-.89-.31-1-.41-.11-.1-.08-.19.11-.34.19-.15.69.06 1 .09.3.03.66.27.66.55.02.25.33.5.19.63h-.01z'\n    )\n  }\n  public static get grabber() {\n    return new OcticonSymbol(8, 16, 'M8 4v1H0V4h8zM0 8h8V7H0v1zm0 3h8v-1H0v1z')\n  }\n  public static get graph() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M16 14v1H0V0h1v14h15zM5 13H3V8h2v5zm4 0H7V3h2v10zm4 0h-2V6h2v7z'\n    )\n  }\n  public static get heart() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M11.2 3c-.52-.63-1.25-.95-2.2-1-.97 0-1.69.42-2.2 1-.51.58-.78.92-.8 1-.02-.08-.28-.42-.8-1-.52-.58-1.17-1-2.2-1-.95.05-1.69.38-2.2 1-.52.61-.78 1.28-.8 2 0 .52.09 1.52.67 2.67C1.25 8.82 3.01 10.61 6 13c2.98-2.39 4.77-4.17 5.34-5.33C11.91 6.51 12 5.5 12 5c-.02-.72-.28-1.39-.8-2.02V3z'\n    )\n  }\n  public static get history() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M8 13H6V6h5v2H8v5zM7 1C4.81 1 2.87 2.02 1.59 3.59L0 2v4h4L2.5 4.5C3.55 3.17 5.17 2.3 7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-.34.03-.67.09-1H.08C.03 7.33 0 7.66 0 8c0 3.86 3.14 7 7 7s7-3.14 7-7-3.14-7-7-7z'\n    )\n  }\n  public static get home() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M16 9l-3-3V2h-2v2L8 1 0 9h2l1 5c0 .55.45 1 1 1h8c.55 0 1-.45 1-1l1-5h2zm-4 5H9v-4H7v4H4L2.81 7.69 8 2.5l5.19 5.19L12 14z'\n    )\n  }\n  public static get horizontalRule() {\n    return new OcticonSymbol(\n      10,\n      16,\n      'M1 7h2v2h1V3H3v3H1V3H0v6h1V7zm9 2V7H9v2h1zm0-3V4H9v2h1zM7 6V4h2V3H6v6h1V7h2V6H7zm-7 7h10v-2H0v2z'\n    )\n  }\n  public static get hubot() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M3 6c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1h8c.55 0 1-.45 1-1V7c0-.55-.45-1-1-1H3zm8 1.75L9.75 9h-1.5L7 7.75 5.75 9h-1.5L3 7.75V7h.75L5 8.25 6.25 7h1.5L9 8.25 10.25 7H11v.75zM5 11h4v1H5v-1zm2-9C3.14 2 0 4.91 0 8.5V13c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V8.5C14 4.91 10.86 2 7 2zm6 11H1V8.5c0-3.09 2.64-5.59 6-5.59s6 2.5 6 5.59V13z'\n    )\n  }\n  public static get inbox() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M14 9l-1.13-7.14c-.08-.48-.5-.86-1-.86H2.13c-.5 0-.92.38-1 .86L0 9v5c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V9zm-3.28.55l-.44.89c-.17.34-.52.56-.91.56H4.61c-.38 0-.72-.22-.89-.55l-.44-.91c-.17-.33-.52-.55-.89-.55H1l1-7h10l1 7h-1.38c-.39 0-.73.22-.91.55l.01.01z'\n    )\n  }\n  public static get info() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z'\n    )\n  }\n  public static get issueClosed() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M7 10h2v2H7v-2zm2-6H7v5h2V4zm1.5 1.5l-1 1L12 9l4-4.5-1-1L12 7l-1.5-1.5zM8 13.7A5.71 5.71 0 0 1 2.3 8c0-3.14 2.56-5.7 5.7-5.7 1.83 0 3.45.88 4.5 2.2l.92-.92A6.947 6.947 0 0 0 8 1C4.14 1 1 4.14 1 8s3.14 7 7 7 7-3.14 7-7l-1.52 1.52c-.66 2.41-2.86 4.19-5.48 4.19v-.01z'\n    )\n  }\n  public static get issueOpened() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z'\n    )\n  }\n  public static get issueReopened() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M8 9H6V4h2v5zm-2 3h2v-2H6v2zm6.33-2H10l1.5 1.5c-1.05 1.33-2.67 2.2-4.5 2.2A5.71 5.71 0 0 1 1.3 8c0-.34.03-.67.09-1H.08C.03 7.33 0 7.66 0 8c0 3.86 3.14 7 7 7 2.19 0 4.13-1.02 5.41-2.59L14 14v-4h-1.67zM1.67 6H4L2.5 4.5C3.55 3.17 5.17 2.3 7 2.3c3.14 0 5.7 2.56 5.7 5.7 0 .34-.03.67-.09 1h1.31c.05-.33.08-.66.08-1 0-3.86-3.14-7-7-7-2.19 0-4.13 1.02-5.41 2.59L0 2v4h1.67z'\n    )\n  }\n  public static get italic() {\n    return new OcticonSymbol(\n      6,\n      16,\n      'M2.81 5h1.98L3 14H1l1.81-9zm.36-2.7c0-.7.58-1.3 1.33-1.3.56 0 1.13.38 1.13 1.03 0 .75-.59 1.3-1.33 1.3-.58 0-1.13-.38-1.13-1.03z'\n    )\n  }\n  public static get jersey() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M4.5 6l-.5.5v5l.5.5h2l.5-.5v-5L6.5 6h-2zM6 11H5V7h1v4zm6.27-7.25C12.05 2.37 11.96 1.12 12 0H9.02c0 .27-.13.48-.39.69-.25.2-.63.3-1.13.3-.5 0-.88-.09-1.13-.3-.23-.2-.36-.42-.36-.69H3c.05 1.13-.03 2.38-.25 3.75C2.55 5.13 1.95 5.88 1 6v9c.02.27.11.48.31.69.2.21.42.3.69.31h11c.27-.02.48-.11.69-.31.21-.2.3-.42.31-.69V6c-.95-.13-1.53-.88-1.75-2.25h.02zM13 15H2V7c.89-.5 1.48-1.25 1.72-2.25S4.03 2.5 4 1h1c-.02.78.16 1.47.52 2.06.36.58 1.02.89 2 .94.98-.02 1.64-.33 2-.94.36-.59.5-1.28.48-2.06h1c.02 1.42.13 2.55.33 3.38.2.81.69 2 1.67 2.63v8V15zM8.5 6l-.5.5v5l.5.5h2l.5-.5v-5l-.5-.5h-2zm1.5 5H9V7h1v4z'\n    )\n  }\n  public static get kebabHorizontal() {\n    return new OcticonSymbol(\n      13,\n      16,\n      'M1.5 9a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z'\n    )\n  }\n  public static get kebabVertical() {\n    return new OcticonSymbol(\n      3,\n      16,\n      'M0 2.5a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0zm0 5a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0zm0 5a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0z'\n    )\n  }\n  public static get key() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M12.83 2.17C12.08 1.42 11.14 1.03 10 1c-1.13.03-2.08.42-2.83 1.17S6.04 3.86 6.01 5c0 .3.03.59.09.89L0 12v1l1 1h2l1-1v-1h1v-1h1v-1h2l1.09-1.11c.3.08.59.11.91.11 1.14-.03 2.08-.42 2.83-1.17S13.97 6.14 14 5c-.03-1.14-.42-2.08-1.17-2.83zM11 5.38c-.77 0-1.38-.61-1.38-1.38 0-.77.61-1.38 1.38-1.38.77 0 1.38.61 1.38 1.38 0 .77-.61 1.38-1.38 1.38z'\n    )\n  }\n  public static get keyboard() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M10 5H9V4h1v1zM3 6H2v1h1V6zm5-2H7v1h1V4zM4 4H2v1h2V4zm8 7h2v-1h-2v1zM8 7h1V6H8v1zm-4 3H2v1h2v-1zm8-6h-1v1h1V4zm2 0h-1v1h1V4zm-2 5h2V6h-2v3zm4-6v9c0 .55-.45 1-1 1H1c-.55 0-1-.45-1-1V3c0-.55.45-1 1-1h14c.55 0 1 .45 1 1zm-1 0H1v9h14V3zM6 7h1V6H6v1zm0-3H5v1h1V4zM4 7h1V6H4v1zm1 4h6v-1H5v1zm5-4h1V6h-1v1zM3 8H2v1h1V8zm5 0v1h1V8H8zM6 8v1h1V8H6zM5 8H4v1h1V8zm5 1h1V8h-1v1z'\n    )\n  }\n  public static get law() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M7 4c-.83 0-1.5-.67-1.5-1.5S6.17 1 7 1s1.5.67 1.5 1.5S7.83 4 7 4zm7 6c0 1.11-.89 2-2 2h-1c-1.11 0-2-.89-2-2l2-4h-1c-.55 0-1-.45-1-1H8v8c.42 0 1 .45 1 1h1c.42 0 1 .45 1 1H3c0-.55.58-1 1-1h1c0-.55.58-1 1-1h.03L6 5H5c0 .55-.45 1-1 1H3l2 4c0 1.11-.89 2-2 2H2c-1.11 0-2-.89-2-2l2-4H1V5h3c0-.55.45-1 1-1h4c.55 0 1 .45 1 1h3v1h-1l2 4zM2.5 7L1 10h3L2.5 7zM13 10l-1.5-3-1.5 3h3z'\n    )\n  }\n  public static get lightBulb() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z'\n    )\n  }\n  public static get link() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z'\n    )\n  }\n  public static get linkExternal() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M11 10h1v3c0 .55-.45 1-1 1H1c-.55 0-1-.45-1-1V3c0-.55.45-1 1-1h3v1H1v10h10v-3zM6 2l2.25 2.25L5 7.5 6.5 9l3.25-3.25L12 8V2H6z'\n    )\n  }\n  public static get listOrdered() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M12 13c0 .59 0 1-.59 1H4.59C4 14 4 13.59 4 13c0-.59 0-1 .59-1h6.81c.59 0 .59.41.59 1H12zM4.59 4h6.81c.59 0 .59-.41.59-1 0-.59 0-1-.59-1H4.59C4 2 4 2.41 4 3c0 .59 0 1 .59 1zm6.81 3H4.59C4 7 4 7.41 4 8c0 .59 0 1 .59 1h6.81c.59 0 .59-.41.59-1 0-.59 0-1-.59-1zM2 1h-.72c-.3.19-.58.25-1.03.34V2H1v2.14H.16V5H3v-.86H2V1zm.25 8.13c-.17 0-.45.03-.66.06.53-.56 1.14-1.25 1.14-1.89C2.71 6.52 2.17 6 1.37 6c-.59 0-.97.2-1.38.64l.58.58c.19-.19.38-.38.64-.38.28 0 .48.16.48.52 0 .53-.77 1.2-1.7 2.06V10h3l-.09-.88h-.66l.01.01zm-.08 3.78v-.03c.44-.19.64-.47.64-.86 0-.7-.56-1.11-1.44-1.11-.48 0-.89.19-1.28.52l.55.64c.25-.2.44-.31.69-.31.27 0 .42.13.42.36 0 .27-.2.44-.86.44v.75c.83 0 .98.17.98.47 0 .25-.23.38-.58.38-.28 0-.56-.14-.81-.38l-.48.66c.3.36.77.56 1.41.56.83 0 1.53-.41 1.53-1.16 0-.5-.31-.81-.77-.94v.01z'\n    )\n  }\n  public static get listUnordered() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M2 13c0 .59 0 1-.59 1H.59C0 14 0 13.59 0 13c0-.59 0-1 .59-1h.81c.59 0 .59.41.59 1H2zm2.59-9h6.81c.59 0 .59-.41.59-1 0-.59 0-1-.59-1H4.59C4 2 4 2.41 4 3c0 .59 0 1 .59 1zM1.41 7H.59C0 7 0 7.41 0 8c0 .59 0 1 .59 1h.81c.59 0 .59-.41.59-1 0-.59 0-1-.59-1h.01zm0-5H.59C0 2 0 2.41 0 3c0 .59 0 1 .59 1h.81c.59 0 .59-.41.59-1 0-.59 0-1-.59-1h.01zm10 5H4.59C4 7 4 7.41 4 8c0 .59 0 1 .59 1h6.81c.59 0 .59-.41.59-1 0-.59 0-1-.59-1h.01zm0 5H4.59C4 12 4 12.41 4 13c0 .59 0 1 .59 1h6.81c.59 0 .59-.41.59-1 0-.59 0-1-.59-1h.01z'\n    )\n  }\n  public static get location() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M6 0C2.69 0 0 2.5 0 5.5 0 10.02 6 16 6 16s6-5.98 6-10.5C12 2.5 9.31 0 6 0zm0 14.55C4.14 12.52 1 8.44 1 5.5 1 3.02 3.25 1 6 1c1.34 0 2.61.48 3.56 1.36.92.86 1.44 1.97 1.44 3.14 0 2.94-3.14 7.02-5 9.05zM8 5.5c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z'\n    )\n  }\n  public static get lock() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M4 13H3v-1h1v1zm8-6v7c0 .55-.45 1-1 1H1c-.55 0-1-.45-1-1V7c0-.55.45-1 1-1h1V4c0-2.2 1.8-4 4-4s4 1.8 4 4v2h1c.55 0 1 .45 1 1zM3.8 6h4.41V4c0-1.22-.98-2.2-2.2-2.2-1.22 0-2.2.98-2.2 2.2v2H3.8zM11 7H2v7h9V7zM4 8H3v1h1V8zm0 2H3v1h1v-1z'\n    )\n  }\n  public static get logoGist() {\n    return new OcticonSymbol(\n      25,\n      16,\n      'M4.7 8.73h2.45v4.02c-.55.27-1.64.34-2.53.34-2.56 0-3.47-2.2-3.47-5.05 0-2.85.91-5.06 3.48-5.06 1.28 0 2.06.23 3.28.73V2.66C7.27 2.33 6.25 2 4.63 2 1.13 2 0 4.69 0 8.03c0 3.34 1.11 6.03 4.63 6.03 1.64 0 2.81-.27 3.59-.64V7.73H4.7v1zm6.39 3.72V6.06h-1.05v6.28c0 1.25.58 1.72 1.72 1.72v-.89c-.48 0-.67-.16-.67-.7v-.02zm.25-8.72c0-.44-.33-.78-.78-.78s-.77.34-.77.78.33.78.77.78.78-.34.78-.78zm4.34 5.69c-1.5-.13-1.78-.48-1.78-1.17 0-.77.33-1.34 1.88-1.34 1.05 0 1.66.16 2.27.36v-.94c-.69-.3-1.52-.39-2.25-.39-2.2 0-2.92 1.2-2.92 2.31 0 1.08.47 1.88 2.73 2.08 1.55.13 1.77.63 1.77 1.34 0 .73-.44 1.42-2.06 1.42-1.11 0-1.86-.19-2.33-.36v.94c.5.2 1.58.39 2.33.39 2.38 0 3.14-1.2 3.14-2.41 0-1.28-.53-2.03-2.75-2.23h-.03zm8.58-2.47v-.86h-2.42v-2.5l-1.08.31v2.11l-1.56.44v.48h1.56v5c0 1.53 1.19 2.13 2.5 2.13.19 0 .52-.02.69-.05v-.89c-.19.03-.41.03-.61.03-.97 0-1.5-.39-1.5-1.34V6.94h2.42v.02-.01z'\n    )\n  }\n  public static get logoGithub() {\n    return new OcticonSymbol(\n      45,\n      16,\n      'M18.53 12.03h-.02c.009 0 .015.01.024.011h.006l-.01-.01zm.004.011c-.093.001-.327.05-.574.05-.78 0-1.05-.36-1.05-.83V8.13h1.59c.09 0 .16-.08.16-.19v-1.7c0-.09-.08-.17-.16-.17h-1.59V3.96c0-.08-.05-.13-.14-.13h-2.16c-.09 0-.14.05-.14.13v2.17s-1.09.27-1.16.28c-.08.02-.13.09-.13.17v1.36c0 .11.08.19.17.19h1.11v3.28c0 2.44 1.7 2.69 2.86 2.69.53 0 1.17-.17 1.27-.22.06-.02.09-.09.09-.16v-1.5a.177.177 0 0 0-.146-.18zm23.696-2.2c0-1.81-.73-2.05-1.5-1.97-.6.04-1.08.34-1.08.34v3.52s.49.34 1.22.36c1.03.03 1.36-.34 1.36-2.25zm2.43-.16c0 3.43-1.11 4.41-3.05 4.41-1.64 0-2.52-.83-2.52-.83s-.04.46-.09.52c-.03.06-.08.08-.14.08h-1.48c-.1 0-.19-.08-.19-.17l.02-11.11c0-.09.08-.17.17-.17h2.13c.09 0 .17.08.17.17v3.77s.82-.53 2.02-.53l-.01-.02c1.2 0 2.97.45 2.97 3.88zm-8.72-3.61H33.84c-.11 0-.17.08-.17.19v5.44s-.55.39-1.3.39-.97-.34-.97-1.09V6.25c0-.09-.08-.17-.17-.17h-2.14c-.09 0-.17.08-.17.17v5.11c0 2.2 1.23 2.75 2.92 2.75 1.39 0 2.52-.77 2.52-.77s.05.39.08.45c.02.05.09.09.16.09h1.34c.11 0 .17-.08.17-.17l.02-7.47c0-.09-.08-.17-.19-.17zm-23.7-.01h-2.13c-.09 0-.17.09-.17.2v7.34c0 .2.13.27.3.27h1.92c.2 0 .25-.09.25-.27V6.23c0-.09-.08-.17-.17-.17zm-1.05-3.38c-.77 0-1.38.61-1.38 1.38 0 .77.61 1.38 1.38 1.38.75 0 1.36-.61 1.36-1.38 0-.77-.61-1.38-1.36-1.38zm16.49-.25h-2.11c-.09 0-.17.08-.17.17v4.09h-3.31V2.6c0-.09-.08-.17-.17-.17h-2.13c-.09 0-.17.08-.17.17v11.11c0 .09.09.17.17.17h2.13c.09 0 .17-.08.17-.17V8.96h3.31l-.02 4.75c0 .09.08.17.17.17h2.13c.09 0 .17-.08.17-.17V2.6c0-.09-.08-.17-.17-.17zM8.81 7.35v5.74c0 .04-.01.11-.06.13 0 0-1.25.89-3.31.89-2.49 0-5.44-.78-5.44-5.92S2.58 1.99 5.1 2c2.18 0 3.06.49 3.2.58.04.05.06.09.06.14L7.94 4.5c0 .09-.09.2-.2.17-.36-.11-.9-.33-2.17-.33-1.47 0-3.05.42-3.05 3.73s1.5 3.7 2.58 3.7c.92 0 1.25-.11 1.25-.11v-2.3H4.88c-.11 0-.19-.08-.19-.17V7.35c0-.09.08-.17.19-.17h3.74c.11 0 .19.08.19.17z'\n    )\n  }\n  public static get mail() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M0 4v8c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1H1c-.55 0-1 .45-1 1zm13 0L7 9 1 4h12zM1 5.5l4 3-4 3v-6zM2 12l3.5-3L7 10.5 8.5 9l3.5 3H2zm11-.5l-4-3 4-3v6z'\n    )\n  }\n  public static get mailRead() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M6 5H4V4h2v1zm3 1H4v1h5V6zm5-.48V14c0 .55-.45 1-1 1H1c-.55 0-1-.45-1-1V5.52c0-.33.16-.63.42-.81L2 3.58V3c0-.55.45-1 1-1h1.2L7 0l2.8 2H11c.55 0 1 .45 1 1v.58l1.58 1.13c.27.19.42.48.42.81zM3 7.5L7 10l4-2.5V3H3v4.5zm-2 6l4.5-3-4.5-3v6zm11 .5l-5-3-5 3h10zm1-6.5l-4.5 3 4.5 3v-6z'\n    )\n  }\n  public static get markGithub() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z'\n    )\n  }\n  public static get markdown() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M14.85 3H1.15C.52 3 0 3.52 0 4.15v7.69C0 12.48.52 13 1.15 13h13.69c.64 0 1.15-.52 1.15-1.15v-7.7C16 3.52 15.48 3 14.85 3zM9 11H7V8L5.5 9.92 4 8v3H2V5h2l1.5 2L7 5h2v6zm2.99.5L9.5 8H11V5h2v3h1.5l-2.51 3.5z'\n    )\n  }\n  public static get megaphone() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M10 1c-.17 0-.36.05-.52.14C8.04 2.02 4.5 4.58 3 5c-1.38 0-3 .67-3 2.5S1.63 10 3 10c.3.08.64.23 1 .41V15h2v-3.45c1.34.86 2.69 1.83 3.48 2.31.16.09.34.14.52.14.52 0 1-.42 1-1V2c0-.58-.48-1-1-1zm0 12c-.38-.23-.89-.58-1.5-1-.16-.11-.33-.22-.5-.34V3.31c.16-.11.31-.2.47-.31.61-.41 1.16-.77 1.53-1v11zm2-6h4v1h-4V7zm0 2l4 2v1l-4-2V9zm4-6v1l-4 2V5l4-2z'\n    )\n  }\n  public static get mention() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M6.58 15c1.25 0 2.52-.31 3.56-.94l-.42-.94c-.84.52-1.89.83-3.03.83-3.23 0-5.64-2.08-5.64-5.72 0-4.37 3.23-7.18 6.58-7.18 3.45 0 5.22 2.19 5.22 5.2 0 2.39-1.34 3.86-2.5 3.86-1.05 0-1.36-.73-1.05-2.19l.73-3.75H8.98l-.11.72c-.41-.63-.94-.83-1.56-.83-2.19 0-3.66 2.39-3.66 4.38 0 1.67.94 2.61 2.3 2.61.84 0 1.67-.53 2.3-1.25.11.94.94 1.45 1.98 1.45 1.67 0 3.77-1.67 3.77-5C14 2.61 11.59 0 7.83 0 3.66 0 0 3.33 0 8.33 0 12.71 2.92 15 6.58 15zm-.31-5c-.73 0-1.36-.52-1.36-1.67 0-1.45.94-3.22 2.41-3.22.52 0 .84.2 1.25.83l-.52 3.02c-.63.73-1.25 1.05-1.78 1.05V10z'\n    )\n  }\n  public static get milestone() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M8 2H6V0h2v2zm4 5H2c-.55 0-1-.45-1-1V4c0-.55.45-1 1-1h10l2 2-2 2zM8 4H6v2h2V4zM6 16h2V8H6v8z'\n    )\n  }\n  public static get mirror() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M15.5 4.7L8.5 0l-7 4.7c-.3.19-.5.45-.5.8V16l7.5-4 7.5 4V5.5c0-.34-.2-.61-.5-.8zm-.5 9.8l-6-3.25V10H8v1.25L2 14.5v-9l6-4V6h1V1.5l6 4v9zM6 7h5V5l3 3-3 3V9H6v2L3 8l3-3v2z'\n    )\n  }\n  public static get mortarBoard() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M7.83 9.19L4 8c-4-8 0 1.5 0 2.5S5.8 12 8 12s4-.5 4-1.5V8L8.17 9.19a.73.73 0 0 1-.36 0h.02zm.28-6.39a.34.34 0 0 0-.2 0L.27 5.18a.35.35 0 0 0 0 .67L2 6.4v1.77c-.3.17-.5.5-.5.86 0 .19.05.36.14.5-.08.14-.14.31-.14.5v2.58c0 .55 2 .55 2 0v-2.58c0-.19-.05-.36-.14-.5.08-.14.14-.31.14-.5 0-.38-.2-.69-.5-.86V6.72l4.89 1.53c.06.02.14.02.2 0l7.64-2.38a.35.35 0 0 0 0-.67L8.1 2.81l.01-.01zM8.02 6c-.55 0-1-.22-1-.5s.45-.5 1-.5 1 .22 1 .5-.45.5-1 .5z'\n    )\n  }\n  public static get mute() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M8 2.81v10.38c0 .67-.81 1-1.28.53L3 10H1c-.55 0-1-.45-1-1V7c0-.55.45-1 1-1h2l3.72-3.72C7.19 1.81 8 2.14 8 2.81zm7.53 3.22l-1.06-1.06-1.97 1.97-1.97-1.97-1.06 1.06L11.44 8 9.47 9.97l1.06 1.06 1.97-1.97 1.97 1.97 1.06-1.06L13.56 8l1.97-1.97z'\n    )\n  }\n  public static get noNewline() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M16 5v3c0 .55-.45 1-1 1h-3v2L9 8l3-3v2h2V5h2zM8 8c0 2.2-1.8 4-4 4s-4-1.8-4-4 1.8-4 4-4 4 1.8 4 4zM1.5 9.66L5.66 5.5C5.18 5.19 4.61 5 4 5 2.34 5 1 6.34 1 8c0 .61.19 1.17.5 1.66zM7 8c0-.61-.19-1.17-.5-1.66L2.34 10.5c.48.31 1.05.5 1.66.5 1.66 0 3-1.34 3-3z'\n    )\n  }\n  public static get note() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M3 10h4V9H3v1zm0-2h6V7H3v1zm0-2h8V5H3v1zm10 6H1V3h12v9zM1 2c-.55 0-1 .45-1 1v9c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1H1z'\n    )\n  }\n  public static get octoface() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M14.7 5.34c.13-.32.55-1.59-.13-3.31 0 0-1.05-.33-3.44 1.3-1-.28-2.07-.32-3.13-.32s-2.13.04-3.13.32c-2.39-1.64-3.44-1.3-3.44-1.3-.68 1.72-.26 2.99-.13 3.31C.49 6.21 0 7.33 0 8.69 0 13.84 3.33 15 7.98 15S16 13.84 16 8.69c0-1.36-.49-2.48-1.3-3.35zM8 14.02c-3.3 0-5.98-.15-5.98-3.35 0-.76.38-1.48 1.02-2.07 1.07-.98 2.9-.46 4.96-.46 2.07 0 3.88-.52 4.96.46.65.59 1.02 1.3 1.02 2.07 0 3.19-2.68 3.35-5.98 3.35zM5.49 9.01c-.66 0-1.2.8-1.2 1.78s.54 1.79 1.2 1.79c.66 0 1.2-.8 1.2-1.79s-.54-1.78-1.2-1.78zm5.02 0c-.66 0-1.2.79-1.2 1.78s.54 1.79 1.2 1.79c.66 0 1.2-.8 1.2-1.79s-.53-1.78-1.2-1.78z'\n    )\n  }\n  public static get organization() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M16 12.999c0 .439-.45 1-1 1H7.995c-.539 0-.994-.447-.995-.999H1c-.54 0-1-.561-1-1 0-2.634 3-4 3-4s.229-.409 0-1c-.841-.621-1.058-.59-1-3 .058-2.419 1.367-3 2.5-3s2.442.58 2.5 3c.058 2.41-.159 2.379-1 3-.229.59 0 1 0 1s1.549.711 2.42 2.088C9.196 9.369 10 8.999 10 8.999s.229-.409 0-1c-.841-.62-1.058-.59-1-3 .058-2.419 1.367-3 2.5-3s2.437.581 2.495 3c.059 2.41-.158 2.38-1 3-.229.59 0 1 0 1s3.005 1.366 3.005 4'\n    )\n  }\n  public static get package() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M1 4.27v7.47c0 .45.3.84.75.97l6.5 1.73c.16.05.34.05.5 0l6.5-1.73c.45-.13.75-.52.75-.97V4.27c0-.45-.3-.84-.75-.97l-6.5-1.74a1.4 1.4 0 0 0-.5 0L1.75 3.3c-.45.13-.75.52-.75.97zm7 9.09l-6-1.59V5l6 1.61v6.75zM2 4l2.5-.67L11 5.06l-2.5.67L2 4zm13 7.77l-6 1.59V6.61l2-.55V8.5l2-.53V5.53L15 5v6.77zm-2-7.24L6.5 2.8l2-.53L15 4l-2 .53z'\n    )\n  }\n  public static get paintcan() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M6 0C2.69 0 0 2.69 0 6v1c0 .55.45 1 1 1v5c0 1.1 2.24 2 5 2s5-.9 5-2V8c.55 0 1-.45 1-1V6c0-3.31-2.69-6-6-6zm3 10v.5c0 .28-.22.5-.5.5s-.5-.22-.5-.5V10c0-.28-.22-.5-.5-.5s-.5.22-.5.5v2.5c0 .28-.22.5-.5.5s-.5-.22-.5-.5v-2c0-.28-.22-.5-.5-.5s-.5.22-.5.5v.5c0 .55-.45 1-1 1s-1-.45-1-1v-1c-.55 0-1-.45-1-1V7.2c.91.49 2.36.8 4 .8 1.64 0 3.09-.31 4-.8V9c0 .55-.45 1-1 1zM6 7c-1.68 0-3.12-.41-3.71-1C2.88 5.41 4.32 5 6 5c1.68 0 3.12.41 3.71 1-.59.59-2.03 1-3.71 1zm0-3c-2.76 0-5 .89-5 2 0-2.76 2.24-5 5-5s5 2.24 5 5c0-1.1-2.24-2-5-2z'\n    )\n  }\n  public static get pencil() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M0 12v3h3l8-8-3-3-8 8zm3 2H1v-2h1v1h1v1zm10.3-9.3L12 6 9 3l1.3-1.3a.996.996 0 0 1 1.41 0l1.59 1.59c.39.39.39 1.02 0 1.41z'\n    )\n  }\n  public static get person() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M12 14.002a.998.998 0 0 1-.998.998H1.001A1 1 0 0 1 0 13.999V13c0-2.633 4-4 4-4s.229-.409 0-1c-.841-.62-.944-1.59-1-4 .173-2.413 1.867-3 3-3s2.827.586 3 3c-.056 2.41-.159 3.38-1 4-.229.59 0 1 0 1s4 1.367 4 4v1.002z'\n    )\n  }\n  public static get pin() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M10 1.2V2l.5 1L6 6H2.2c-.44 0-.67.53-.34.86L5 10l-4 5 5-4 3.14 3.14a.5.5 0 0 0 .86-.34V10l3-4.5 1 .5h.8c.44 0 .67-.53.34-.86L10.86.86a.5.5 0 0 0-.86.34z'\n    )\n  }\n  public static get plug() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M14 6V5h-4V3H8v1H6c-1.03 0-1.77.81-2 2L3 7c-1.66 0-3 1.34-3 3v2h1v-2c0-1.11.89-2 2-2l1 1c.25 1.16.98 2 2 2h2v1h2v-2h4V9h-4V6h4z'\n    )\n  }\n  public static get plus() {\n    return new OcticonSymbol(12, 16, 'M12 9H7v5H5V9H0V7h5V2h2v5h5z')\n  }\n  public static get plusSmall() {\n    return new OcticonSymbol(7, 16, 'M4 7V4H3v3H0v1h3v3h1V8h3V7H4z')\n  }\n  public static get primitiveDot() {\n    return new OcticonSymbol(\n      8,\n      16,\n      'M0 8c0-2.2 1.8-4 4-4s4 1.8 4 4-1.8 4-4 4-4-1.8-4-4z'\n    )\n  }\n  public static get primitiveSquare() {\n    return new OcticonSymbol(8, 16, 'M8 12H0V4h8z')\n  }\n  public static get project() {\n    return new OcticonSymbol(\n      15,\n      16,\n      'M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z'\n    )\n  }\n  public static get pulse() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M11.5 8L8.8 5.4 6.6 8.5 5.5 1.6 2.38 8H0v2h3.6l.9-1.8.9 5.4L9 8.5l1.6 1.5H14V8z'\n    )\n  }\n  public static get question() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M6 10h2v2H6v-2zm4-3.5C10 8.64 8 9 8 9H6c0-.55.45-1 1-1h.5c.28 0 .5-.22.5-.5v-1c0-.28-.22-.5-.5-.5h-1c-.28 0-.5.22-.5.5V7H4c0-1.5 1.5-3 3-3s3 1 3 2.5zM7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7z'\n    )\n  }\n  public static get quote() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M6.16 3.5C3.73 5.06 2.55 6.67 2.55 9.36c.16-.05.3-.05.44-.05 1.27 0 2.5.86 2.5 2.41 0 1.61-1.03 2.61-2.5 2.61-1.9 0-2.99-1.52-2.99-4.25 0-3.8 1.75-6.53 5.02-8.42L6.16 3.5zm7 0c-2.43 1.56-3.61 3.17-3.61 5.86.16-.05.3-.05.44-.05 1.27 0 2.5.86 2.5 2.41 0 1.61-1.03 2.61-2.5 2.61-1.89 0-2.98-1.52-2.98-4.25 0-3.8 1.75-6.53 5.02-8.42l1.14 1.84h-.01z'\n    )\n  }\n  public static get radioTower() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M4.79 6.11c.25-.25.25-.67 0-.92-.32-.33-.48-.76-.48-1.19 0-.43.16-.86.48-1.19.25-.26.25-.67 0-.92a.613.613 0 0 0-.45-.19c-.16 0-.33.06-.45.19-.57.58-.85 1.35-.85 2.11 0 .76.29 1.53.85 2.11.25.25.66.25.9 0zM2.33.52a.651.651 0 0 0-.92 0C.48 1.48.01 2.74.01 3.99c0 1.26.47 2.52 1.4 3.48.25.26.66.26.91 0s.25-.68 0-.94c-.68-.7-1.02-1.62-1.02-2.54 0-.92.34-1.84 1.02-2.54a.66.66 0 0 0 .01-.93zm5.69 5.1A1.62 1.62 0 1 0 6.4 4c-.01.89.72 1.62 1.62 1.62zM14.59.53a.628.628 0 0 0-.91 0c-.25.26-.25.68 0 .94.68.7 1.02 1.62 1.02 2.54 0 .92-.34 1.83-1.02 2.54-.25.26-.25.68 0 .94a.651.651 0 0 0 .92 0c.93-.96 1.4-2.22 1.4-3.48A5.048 5.048 0 0 0 14.59.53zM8.02 6.92c-.41 0-.83-.1-1.2-.3l-3.15 8.37h1.49l.86-1h4l.84 1h1.49L9.21 6.62c-.38.2-.78.3-1.19.3zm-.01.48L9.02 11h-2l.99-3.6zm-1.99 5.59l1-1h2l1 1h-4zm5.19-11.1c-.25.25-.25.67 0 .92.32.33.48.76.48 1.19 0 .43-.16.86-.48 1.19-.25.26-.25.67 0 .92a.63.63 0 0 0 .9 0c.57-.58.85-1.35.85-2.11 0-.76-.28-1.53-.85-2.11a.634.634 0 0 0-.9 0z'\n    )\n  }\n  public static get reply() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M6 3.5c3.92.44 8 3.125 8 10-2.312-5.062-4.75-6-8-6V11L.5 5.5 6 0v3.5z'\n    )\n  }\n  public static get repo() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z'\n    )\n  }\n  public static get repoClone() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M15 0H9v7c0 .55.45 1 1 1h1v1h1V8h3c.55 0 1-.45 1-1V1c0-.55-.45-1-1-1zm-4 7h-1V6h1v1zm4 0h-3V6h3v1zm0-2h-4V1h4v4zM4 5H3V4h1v1zm0-2H3V2h1v1zM2 1h6V0H1C.45 0 0 .45 0 1v12c0 .55.45 1 1 1h2v2l1.5-1.5L6 16v-2h5c.55 0 1-.45 1-1v-3H2V1zm9 10v2H6v-1H3v1H1v-2h10zM3 8h1v1H3V8zm1-1H3V6h1v1z'\n    )\n  }\n  public static get repoForcePush() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M10 9H8v7H6V9H4l2.25-3H4l3-4 3 4H7.75L10 9zm1-9H1C.45 0 0 .45 0 1v12c0 .55.45 1 1 1h4v-1H1v-2h4v-1H2V1h9v9H9v1h2v2H9v1h2c.55 0 1-.45 1-1V1c0-.55-.45-1-1-1z'\n    )\n  }\n  public static get repoForked() {\n    return new OcticonSymbol(\n      10,\n      16,\n      'M8 1a1.993 1.993 0 0 0-1 3.72V6L5 8 3 6V4.72A1.993 1.993 0 0 0 2 1a1.993 1.993 0 0 0-1 3.72V6.5l3 3v1.78A1.993 1.993 0 0 0 5 15a1.993 1.993 0 0 0 1-3.72V9.5l3-3V4.72A1.993 1.993 0 0 0 8 1zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3 10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3-10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z'\n    )\n  }\n  public static get repoPull() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M13 8V6H7V4h6V2l3 3-3 3zM4 2H3v1h1V2zm7 5h1v6c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1v2h-1V1H2v9h9V7zm0 4H1v2h2v-1h3v1h5v-2zM4 6H3v1h1V6zm0-2H3v1h1V4zM3 9h1V8H3v1z'\n    )\n  }\n  public static get repoPush() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M4 3H3V2h1v1zM3 5h1V4H3v1zm4 0L4 9h2v7h2V9h2L7 5zm4-5H1C.45 0 0 .45 0 1v12c0 .55.45 1 1 1h4v-1H1v-2h4v-1H2V1h9.02L11 10H9v1h2v2H9v1h2c.55 0 1-.45 1-1V1c0-.55-.45-1-1-1z'\n    )\n  }\n  public static get rocket() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M12.17 3.83c-.27-.27-.47-.55-.63-.88-.16-.31-.27-.66-.34-1.02-.58.33-1.16.7-1.73 1.13-.58.44-1.14.94-1.69 1.48-.7.7-1.33 1.81-1.78 2.45H3L0 10h3l2-2c-.34.77-1.02 2.98-1 3l1 1c.02.02 2.23-.64 3-1l-2 2v3l3-3v-3c.64-.45 1.75-1.09 2.45-1.78.55-.55 1.05-1.13 1.47-1.7.44-.58.81-1.16 1.14-1.72-.36-.08-.7-.19-1.03-.34a3.39 3.39 0 0 1-.86-.63M16 0s-.09.38-.3 1.06c-.2.7-.55 1.58-1.06 2.66-.7-.08-1.27-.33-1.66-.72-.39-.39-.63-.94-.7-1.64C13.36.84 14.23.48 14.92.28 15.62.08 16 0 16 0'\n    )\n  }\n  public static get rss() {\n    return new OcticonSymbol(\n      10,\n      16,\n      'M2 13H0v-2c1.11 0 2 .89 2 2zM0 3v1a9 9 0 0 1 9 9h1C10 7.48 5.52 3 0 3zm0 4v1c2.75 0 5 2.25 5 5h1c0-3.31-2.69-6-6-6z'\n    )\n  }\n  public static get ruby() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M13 6l-5 5V4h3l2 2zm3 0l-8 8-8-8 4-4h8l4 4zm-8 6.5L14.5 6l-3-3h-7l-3 3L8 12.5z'\n    )\n  }\n  public static get screenFull() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M13 10h1v3c0 .547-.453 1-1 1h-3v-1h3v-3zM1 10H0v3c0 .547.453 1 1 1h3v-1H1v-3zm0-7h3V2H1c-.547 0-1 .453-1 1v3h1V3zm1 1h10v8H2V4zm2 6h6V6H4v4zm6-8v1h3v3h1V3c0-.547-.453-1-1-1h-3z'\n    )\n  }\n  public static get screenNormal() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M2 4H0V3h2V1h1v2c0 .547-.453 1-1 1zm0 8H0v1h2v2h1v-2c0-.547-.453-1-1-1zm9-2c0 .547-.453 1-1 1H4c-.547 0-1-.453-1-1V6c0-.547.453-1 1-1h6c.547 0 1 .453 1 1v4zM9 7H5v2h4V7zm2 6v2h1v-2h2v-1h-2c-.547 0-1 .453-1 1zm1-10V1h-1v2c0 .547.453 1 1 1h2V3h-2z'\n    )\n  }\n  public static get search() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z'\n    )\n  }\n  public static get server() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M11 6H1c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1h10c.55 0 1-.45 1-1V7c0-.55-.45-1-1-1zM2 9H1V7h1v2zm2 0H3V7h1v2zm2 0H5V7h1v2zm2 0H7V7h1v2zm3-8H1c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1h10c.55 0 1-.45 1-1V2c0-.55-.45-1-1-1zM2 4H1V2h1v2zm2 0H3V2h1v2zm2 0H5V2h1v2zm2 0H7V2h1v2zm3-1h-1V2h1v1zm0 8H1c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1h10c.55 0 1-.45 1-1v-2c0-.55-.45-1-1-1zm-9 3H1v-2h1v2zm2 0H3v-2h1v2zm2 0H5v-2h1v2zm2 0H7v-2h1v2z'\n    )\n  }\n  public static get settings() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M4 7H3V2h1v5zm-1 7h1v-3H3v3zm5 0h1V8H8v6zm5 0h1v-2h-1v2zm1-12h-1v6h1V2zM9 2H8v2h1V2zM5 8H2c-.55 0-1 .45-1 1s.45 1 1 1h3c.55 0 1-.45 1-1s-.45-1-1-1zm5-3H7c-.55 0-1 .45-1 1s.45 1 1 1h3c.55 0 1-.45 1-1s-.45-1-1-1zm5 4h-3c-.55 0-1 .45-1 1s.45 1 1 1h3c.55 0 1-.45 1-1s-.45-1-1-1z'\n    )\n  }\n  public static get shield() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M7 0L0 2v6.02C0 12.69 5.31 16 7 16c1.69 0 7-3.31 7-7.98V2L7 0zM5 11l1.14-2.8a.568.568 0 0 0-.25-.59C5.33 7.25 5 6.66 5 6c0-1.09.89-2 1.98-2C8.06 4 9 4.91 9 6c0 .66-.33 1.25-.89 1.61-.19.13-.3.36-.25.59L9 11H5z'\n    )\n  }\n  public static get signIn() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M7 6.75V12h4V8h1v4c0 .55-.45 1-1 1H7v3l-5.45-2.72c-.33-.17-.55-.52-.55-.91V1c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v3h-1V1H3l4 2v2.25L10 3v2h4v2h-4v2L7 6.75z'\n    )\n  }\n  public static get signOut() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M12 9V7H8V5h4V3l4 3-4 3zm-2 3H6V3L2 1h8v3h1V1c0-.55-.45-1-1-1H1C.45 0 0 .45 0 1v11.38c0 .39.22.73.55.91L6 16.01V13h4c.55 0 1-.45 1-1V8h-1v4z'\n    )\n  }\n  public static get smiley() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M8 0C3.58 0 0 3.58 0 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm4.81 12.81a6.72 6.72 0 0 1-2.17 1.45c-.83.36-1.72.53-2.64.53-.92 0-1.81-.17-2.64-.53-.81-.34-1.55-.83-2.17-1.45a6.773 6.773 0 0 1-1.45-2.17A6.59 6.59 0 0 1 1.21 8c0-.92.17-1.81.53-2.64.34-.81.83-1.55 1.45-2.17.62-.62 1.36-1.11 2.17-1.45A6.59 6.59 0 0 1 8 1.21c.92 0 1.81.17 2.64.53.81.34 1.55.83 2.17 1.45.62.62 1.11 1.36 1.45 2.17.36.83.53 1.72.53 2.64 0 .92-.17 1.81-.53 2.64-.34.81-.83 1.55-1.45 2.17zM4 6.8v-.59c0-.66.53-1.19 1.2-1.19h.59c.66 0 1.19.53 1.19 1.19v.59c0 .67-.53 1.2-1.19 1.2H5.2C4.53 8 4 7.47 4 6.8zm5 0v-.59c0-.66.53-1.19 1.2-1.19h.59c.66 0 1.19.53 1.19 1.19v.59c0 .67-.53 1.2-1.19 1.2h-.59C9.53 8 9 7.47 9 6.8zm4 3.2c-.72 1.88-2.91 3-5 3s-4.28-1.13-5-3c-.14-.39.23-1 .66-1h8.59c.41 0 .89.61.75 1z'\n    )\n  }\n  public static get squirrel() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M12 1C9.79 1 8 2.31 8 3.92c0 1.94.5 3.03 0 6.08 0-4.5-2.77-6.34-4-6.34.05-.5-.48-.66-.48-.66s-.22.11-.3.34c-.27-.31-.56-.27-.56-.27l-.13.58S.7 4.29.68 6.87c.2.33 1.53.6 2.47.43.89.05.67.79.47.99C2.78 9.13 2 8 1 8S0 9 1 9s1 1 3 1c-3.09 1.2 0 4 0 4H3c-1 0-1 1-1 1h6c3 0 5-1 5-3.47 0-.85-.43-1.79-1-2.53-1.11-1.46.23-2.68 1-2 .77.68 3 1 3-2 0-2.21-1.79-4-4-4zM2.5 6c-.28 0-.5-.22-.5-.5s.22-.5.5-.5.5.22.5.5-.22.5-.5.5z'\n    )\n  }\n  public static get star() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M14 6l-4.9-.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14 7 11.67 11.33 14l-.93-4.74z'\n    )\n  }\n  public static get stop() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M10 1H4L0 5v6l4 4h6l4-4V5l-4-4zm3 9.5L9.5 14h-5L1 10.5v-5L4.5 2h5L13 5.5v5zM6 4h2v5H6V4zm0 6h2v2H6v-2z'\n    )\n  }\n  public static get sync() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M10.24 7.4a4.15 4.15 0 0 1-1.2 3.6 4.346 4.346 0 0 1-5.41.54L4.8 10.4.5 9.8l.6 4.2 1.31-1.26c2.36 1.74 5.7 1.57 7.84-.54a5.876 5.876 0 0 0 1.74-4.46l-1.75-.34zM2.96 5a4.346 4.346 0 0 1 5.41-.54L7.2 5.6l4.3.6-.6-4.2-1.31 1.26c-2.36-1.74-5.7-1.57-7.85.54C.5 5.03-.06 6.65.01 8.26l1.75.35A4.17 4.17 0 0 1 2.96 5z'\n    )\n  }\n  public static get tag() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M7.73 1.73C7.26 1.26 6.62 1 5.96 1H3.5C2.13 1 1 2.13 1 3.5v2.47c0 .66.27 1.3.73 1.77l6.06 6.06c.39.39 1.02.39 1.41 0l4.59-4.59a.996.996 0 0 0 0-1.41L7.73 1.73zM2.38 7.09c-.31-.3-.47-.7-.47-1.13V3.5c0-.88.72-1.59 1.59-1.59h2.47c.42 0 .83.16 1.13.47l6.14 6.13-4.73 4.73-6.13-6.15zM3.01 3h2v2H3V3h.01z'\n    )\n  }\n  public static get tasklist() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M15.41 9H7.59C7 9 7 8.59 7 8c0-.59 0-1 .59-1h7.81c.59 0 .59.41.59 1 0 .59 0 1-.59 1h.01zM9.59 4C9 4 9 3.59 9 3c0-.59 0-1 .59-1h5.81c.59 0 .59.41.59 1 0 .59 0 1-.59 1H9.59zM0 3.91l1.41-1.3L3 4.2 7.09 0 8.5 1.41 3 6.91l-3-3zM7.59 12h7.81c.59 0 .59.41.59 1 0 .59 0 1-.59 1H7.59C7 14 7 13.59 7 13c0-.59 0-1 .59-1z'\n    )\n  }\n  public static get telescope() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M8 9l3 6h-1l-2-4v5H7v-6l-2 5H4l2-5 2-1zM7 0H6v1h1V0zM5 3H4v1h1V3zM2 1H1v1h1V1zM.63 9a.52.52 0 0 0-.16.67l.55.92c.13.23.41.31.64.2l1.39-.66-1.16-2-1.27.86.01.01zm7.89-5.39l-5.8 3.95L3.95 9.7l6.33-3.03-1.77-3.06h.01zm4.22 1.28l-1.47-2.52a.51.51 0 0 0-.72-.17l-1.2.83 1.84 3.2 1.33-.64c.27-.13.36-.44.22-.7z'\n    )\n  }\n  public static get terminal() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M7 10h4v1H7v-1zm-3 1l3-3-3-3-.75.75L5.5 8l-2.25 2.25L4 11zm10-8v10c0 .55-.45 1-1 1H1c-.55 0-1-.45-1-1V3c0-.55.45-1 1-1h12c.55 0 1 .45 1 1zm-1 0H1v10h12V3z'\n    )\n  }\n  public static get textSize() {\n    return new OcticonSymbol(\n      18,\n      16,\n      'M13.62 9.08L12.1 3.66h-.06l-1.5 5.42h3.08zM5.7 10.13S4.68 6.52 4.53 6.02h-.08l-1.13 4.11H5.7zM17.31 14h-2.25l-.95-3.25h-4.07L9.09 14H6.84l-.69-2.33H2.87L2.17 14H0l3.3-9.59h2.5l2.17 6.34L10.86 2h2.52l3.94 12h-.01z'\n    )\n  }\n  public static get threeBars() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M11.41 9H.59C0 9 0 8.59 0 8c0-.59 0-1 .59-1H11.4c.59 0 .59.41.59 1 0 .59 0 1-.59 1h.01zm0-4H.59C0 5 0 4.59 0 4c0-.59 0-1 .59-1H11.4c.59 0 .59.41.59 1 0 .59 0 1-.59 1h.01zM.59 11H11.4c.59 0 .59.41.59 1 0 .59 0 1-.59 1H.59C0 13 0 12.59 0 12c0-.59 0-1 .59-1z'\n    )\n  }\n  public static get thumbsdown() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M15.98 7.83l-.97-5.95C14.84.5 13.13 0 12 0H5.69c-.2 0-.38.05-.53.14L3.72 1H2C.94 1 0 1.94 0 3v4c0 1.06.94 2.02 2 2h2c.91 0 1.39.45 2.39 1.55.91 1 .88 1.8.63 3.27-.08.5.06 1 .42 1.42.39.47.98.77 1.56.77 1.83 0 3-3.72 3-5.02l-.02-.98h2.04c1.16 0 1.95-.8 1.98-1.97 0-.06.02-.13-.02-.2v-.01zm-1.97 1.19h-1.99c-.7 0-1.03.28-1.03.97l.03 1.03c0 1.27-1.17 4-2 4-.5 0-1.08-.5-1-1 .25-1.58.34-2.78-.89-4.14C6.11 8.75 5.36 8 4 8V2l1.67-1H12c.73 0 1.95.31 2 1l.02.02 1 6c-.03.64-.38 1-1 1h-.01z'\n    )\n  }\n  public static get thumbsup() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M14 14c-.05.69-1.27 1-2 1H5.67L4 14V8c1.36 0 2.11-.75 3.13-1.88 1.23-1.36 1.14-2.56.88-4.13-.08-.5.5-1 1-1 .83 0 2 2.73 2 4l-.02 1.03c0 .69.33.97 1.02.97h2c.63 0 .98.36 1 1l-1 6L14 14zm0-8h-2.02l.02-.98C12 3.72 10.83 0 9 0c-.58 0-1.17.3-1.56.77-.36.41-.5.91-.42 1.41.25 1.48.28 2.28-.63 3.28-1 1.09-1.48 1.55-2.39 1.55H2C.94 7 0 7.94 0 9v4c0 1.06.94 2 2 2h1.72l1.44.86c.16.09.33.14.52.14h6.33c1.13 0 2.84-.5 3-1.88l.98-5.95c.02-.08.02-.14.02-.2-.03-1.17-.84-1.97-2-1.97H14z'\n    )\n  }\n  public static get tools() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M4.48 7.27c.26.26 1.28 1.33 1.28 1.33l.56-.58-.88-.91 1.69-1.8s-.76-.74-.43-.45c.32-1.19.03-2.51-.87-3.44C4.93.5 3.66.2 2.52.51l1.93 2-.51 1.96-1.89.52-1.93-2C-.19 4.17.1 5.48 1 6.4c.94.98 2.29 1.26 3.48.87zm6.44 1.94l-2.33 2.3 3.84 3.98c.31.33.73.49 1.14.49.41 0 .82-.16 1.14-.49.63-.65.63-1.7 0-2.35l-3.79-3.93zM16 2.53L13.55 0 6.33 7.46l.88.91-4.31 4.46-.99.53-1.39 2.27.35.37 2.2-1.44.51-1.02L7.9 9.08l.88.91L16 2.53z'\n    )\n  }\n  public static get trashcan() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M11 2H9c0-.55-.45-1-1-1H5c-.55 0-1 .45-1 1H2c-.55 0-1 .45-1 1v1c0 .55.45 1 1 1v9c0 .55.45 1 1 1h7c.55 0 1-.45 1-1V5c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm-1 12H3V5h1v8h1V5h1v8h1V5h1v8h1V5h1v9zm1-10H2V3h9v1z'\n    )\n  }\n  public static get triangleDown() {\n    return new OcticonSymbol(12, 16, 'M0 5l6 6 6-6z')\n  }\n  public static get triangleLeft() {\n    return new OcticonSymbol(6, 16, 'M6 2L0 8l6 6z')\n  }\n  public static get triangleRight() {\n    return new OcticonSymbol(6, 16, 'M0 14l6-6-6-6z')\n  }\n  public static get triangleUp() {\n    return new OcticonSymbol(12, 16, 'M12 11L6 5l-6 6z')\n  }\n  public static get unfold() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M11.5 7.5L14 10c0 .55-.45 1-1 1H9v-1h3.5l-2-2h-7l-2 2H5v1H1c-.55 0-1-.45-1-1l2.5-2.5L0 5c0-.55.45-1 1-1h4v1H1.5l2 2h7l2-2H9V4h4c.55 0 1 .45 1 1l-2.5 2.5zM6 6h2V3h2L7 0 4 3h2v3zm2 3H6v3H4l3 3 3-3H8V9z'\n    )\n  }\n  public static get unmute() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M12 8.02c0 1.09-.45 2.09-1.17 2.83l-.67-.67c.55-.56.89-1.31.89-2.16 0-.85-.34-1.61-.89-2.16l.67-.67A3.99 3.99 0 0 1 12 8.02zM7.72 2.28L4 6H2c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1h2l3.72 3.72c.47.47 1.28.14 1.28-.53V2.81c0-.67-.81-1-1.28-.53zm5.94.08l-.67.67a6.996 6.996 0 0 1 2.06 4.98c0 1.94-.78 3.7-2.06 4.98l.67.67A7.973 7.973 0 0 0 16 8c0-2.22-.89-4.22-2.34-5.66v.02zm-1.41 1.41l-.69.67a5.05 5.05 0 0 1 1.48 3.58c0 1.39-.56 2.66-1.48 3.56l.69.67A5.971 5.971 0 0 0 14 8.02c0-1.65-.67-3.16-1.75-4.25z'\n    )\n  }\n  public static get unverified() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M15.67 7.06l-1.08-1.34c-.17-.22-.28-.48-.31-.77l-.19-1.7a1.51 1.51 0 0 0-1.33-1.33l-1.7-.19c-.3-.03-.56-.16-.78-.33L8.94.32c-.55-.44-1.33-.44-1.88 0L5.72 1.4c-.22.17-.48.28-.77.31l-1.7.19c-.7.08-1.25.63-1.33 1.33l-.19 1.7c-.03.3-.16.56-.33.78L.32 7.05c-.44.55-.44 1.33 0 1.88l1.08 1.34c.17.22.28.48.31.77l.19 1.7c.08.7.63 1.25 1.33 1.33l1.7.19c.3.03.56.16.78.33l1.34 1.08c.55.44 1.33.44 1.88 0l1.34-1.08c.22-.17.48-.28.77-.31l1.7-.19c.7-.08 1.25-.63 1.33-1.33l.19-1.7c.03-.3.16-.56.33-.78l1.08-1.34c.44-.55.44-1.33 0-1.88zM9 11.5c0 .28-.22.5-.5.5h-1c-.27 0-.5-.22-.5-.5v-1c0-.28.23-.5.5-.5h1c.28 0 .5.22.5.5v1zm1.56-4.89c-.06.17-.17.33-.3.47-.13.16-.14.19-.33.38-.16.17-.31.3-.52.45-.11.09-.2.19-.28.27-.08.08-.14.17-.19.27-.05.1-.08.19-.11.3-.03.11-.03.13-.03.25H7.13c0-.22 0-.31.03-.48.03-.19.08-.36.14-.52.06-.14.14-.28.25-.42.11-.13.23-.25.41-.38.27-.19.36-.3.48-.52.12-.22.2-.38.2-.59 0-.27-.06-.45-.2-.58-.13-.13-.31-.19-.58-.19-.09 0-.19.02-.3.05-.11.03-.17.09-.25.16-.08.07-.14.11-.2.2a.41.41 0 0 0-.09.28h-2c0-.38.13-.56.27-.83.16-.27.36-.5.61-.67.25-.17.55-.3.88-.38.33-.08.7-.13 1.09-.13.44 0 .83.05 1.17.13.34.09.63.22.88.39.23.17.41.38.55.63.13.25.19.55.19.88 0 .22 0 .42-.08.59l-.02-.01z'\n    )\n  }\n  public static get verified() {\n    return new OcticonSymbol(\n      16,\n      16,\n      'M15.67 7.06l-1.08-1.34c-.17-.22-.28-.48-.31-.77l-.19-1.7a1.51 1.51 0 0 0-1.33-1.33l-1.7-.19c-.3-.03-.56-.16-.78-.33L8.94.32c-.55-.44-1.33-.44-1.88 0L5.72 1.4c-.22.17-.48.28-.77.31l-1.7.19c-.7.08-1.25.63-1.33 1.33l-.19 1.7c-.03.3-.16.56-.33.78L.32 7.05c-.44.55-.44 1.33 0 1.88l1.08 1.34c.17.22.28.48.31.77l.19 1.7c.08.7.63 1.25 1.33 1.33l1.7.19c.3.03.56.16.78.33l1.34 1.08c.55.44 1.33.44 1.88 0l1.34-1.08c.22-.17.48-.28.77-.31l1.7-.19c.7-.08 1.25-.63 1.33-1.33l.19-1.7c.03-.3.16-.56.33-.78l1.08-1.34c.44-.55.44-1.33 0-1.88zM6.5 12L3 8.5 4.5 7l2 2 5-5L13 5.55 6.5 12z'\n    )\n  }\n  public static get versions() {\n    return new OcticonSymbol(\n      14,\n      16,\n      'M13 3H7c-.55 0-1 .45-1 1v8c0 .55.45 1 1 1h6c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1zm-1 8H8V5h4v6zM4 4h1v1H4v6h1v1H4c-.55 0-1-.45-1-1V5c0-.55.45-1 1-1zM1 5h1v1H1v4h1v1H1c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1z'\n    )\n  }\n  public static get watch() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M6 8h2v1H5V5h1v3zm6 0c0 2.22-1.2 4.16-3 5.19V15c0 .55-.45 1-1 1H4c-.55 0-1-.45-1-1v-1.81C1.2 12.16 0 10.22 0 8s1.2-4.16 3-5.19V1c0-.55.45-1 1-1h4c.55 0 1 .45 1 1v1.81c1.8 1.03 3 2.97 3 5.19zm-1 0c0-2.77-2.23-5-5-5S1 5.23 1 8s2.23 5 5 5 5-2.23 5-5z'\n    )\n  }\n  public static get x() {\n    return new OcticonSymbol(\n      12,\n      16,\n      'M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48z'\n    )\n  }\n  public static get zap() {\n    return new OcticonSymbol(10, 16, 'M10 7H6l3-7-9 9h4l-3 7z')\n  }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/** The git errors which can be parsed from failed git commands. */\nvar GitError;\n(function (GitError) {\n    GitError[GitError[\"SSHKeyAuditUnverified\"] = 0] = \"SSHKeyAuditUnverified\";\n    GitError[GitError[\"SSHAuthenticationFailed\"] = 1] = \"SSHAuthenticationFailed\";\n    GitError[GitError[\"SSHPermissionDenied\"] = 2] = \"SSHPermissionDenied\";\n    GitError[GitError[\"HTTPSAuthenticationFailed\"] = 3] = \"HTTPSAuthenticationFailed\";\n    GitError[GitError[\"RemoteDisconnection\"] = 4] = \"RemoteDisconnection\";\n    GitError[GitError[\"HostDown\"] = 5] = \"HostDown\";\n    GitError[GitError[\"RebaseConflicts\"] = 6] = \"RebaseConflicts\";\n    GitError[GitError[\"MergeConflicts\"] = 7] = \"MergeConflicts\";\n    GitError[GitError[\"HTTPSRepositoryNotFound\"] = 8] = \"HTTPSRepositoryNotFound\";\n    GitError[GitError[\"SSHRepositoryNotFound\"] = 9] = \"SSHRepositoryNotFound\";\n    GitError[GitError[\"PushNotFastForward\"] = 10] = \"PushNotFastForward\";\n    GitError[GitError[\"BranchDeletionFailed\"] = 11] = \"BranchDeletionFailed\";\n    GitError[GitError[\"DefaultBranchDeletionFailed\"] = 12] = \"DefaultBranchDeletionFailed\";\n    GitError[GitError[\"RevertConflicts\"] = 13] = \"RevertConflicts\";\n    GitError[GitError[\"EmptyRebasePatch\"] = 14] = \"EmptyRebasePatch\";\n    GitError[GitError[\"NoMatchingRemoteBranch\"] = 15] = \"NoMatchingRemoteBranch\";\n    GitError[GitError[\"NothingToCommit\"] = 16] = \"NothingToCommit\";\n    GitError[GitError[\"NoSubmoduleMapping\"] = 17] = \"NoSubmoduleMapping\";\n    GitError[GitError[\"SubmoduleRepositoryDoesNotExist\"] = 18] = \"SubmoduleRepositoryDoesNotExist\";\n    GitError[GitError[\"InvalidSubmoduleSHA\"] = 19] = \"InvalidSubmoduleSHA\";\n    GitError[GitError[\"LocalPermissionDenied\"] = 20] = \"LocalPermissionDenied\";\n    GitError[GitError[\"InvalidMerge\"] = 21] = \"InvalidMerge\";\n    GitError[GitError[\"InvalidRebase\"] = 22] = \"InvalidRebase\";\n    GitError[GitError[\"NonFastForwardMergeIntoEmptyHead\"] = 23] = \"NonFastForwardMergeIntoEmptyHead\";\n    GitError[GitError[\"PatchDoesNotApply\"] = 24] = \"PatchDoesNotApply\";\n    GitError[GitError[\"BranchAlreadyExists\"] = 25] = \"BranchAlreadyExists\";\n    GitError[GitError[\"BadRevision\"] = 26] = \"BadRevision\";\n    GitError[GitError[\"NotAGitRepository\"] = 27] = \"NotAGitRepository\";\n    GitError[GitError[\"CannotMergeUnrelatedHistories\"] = 28] = \"CannotMergeUnrelatedHistories\";\n    GitError[GitError[\"LFSAttributeDoesNotMatch\"] = 29] = \"LFSAttributeDoesNotMatch\";\n    GitError[GitError[\"BranchRenameFailed\"] = 30] = \"BranchRenameFailed\";\n    GitError[GitError[\"PathDoesNotExist\"] = 31] = \"PathDoesNotExist\";\n    GitError[GitError[\"InvalidObjectName\"] = 32] = \"InvalidObjectName\";\n    GitError[GitError[\"OutsideRepository\"] = 33] = \"OutsideRepository\";\n    GitError[GitError[\"LockFileAlreadyExists\"] = 34] = \"LockFileAlreadyExists\";\n    GitError[GitError[\"NoMergeToAbort\"] = 35] = \"NoMergeToAbort\";\n    // GitHub-specific error codes\n    GitError[GitError[\"PushWithFileSizeExceedingLimit\"] = 36] = \"PushWithFileSizeExceedingLimit\";\n    GitError[GitError[\"HexBranchNameRejected\"] = 37] = \"HexBranchNameRejected\";\n    GitError[GitError[\"ForcePushRejected\"] = 38] = \"ForcePushRejected\";\n    GitError[GitError[\"InvalidRefLength\"] = 39] = \"InvalidRefLength\";\n    GitError[GitError[\"ProtectedBranchRequiresReview\"] = 40] = \"ProtectedBranchRequiresReview\";\n    GitError[GitError[\"ProtectedBranchForcePush\"] = 41] = \"ProtectedBranchForcePush\";\n    GitError[GitError[\"ProtectedBranchDeleteRejected\"] = 42] = \"ProtectedBranchDeleteRejected\";\n    GitError[GitError[\"ProtectedBranchRequiredStatus\"] = 43] = \"ProtectedBranchRequiredStatus\";\n    GitError[GitError[\"PushWithPrivateEmail\"] = 44] = \"PushWithPrivateEmail\";\n})(GitError = exports.GitError || (exports.GitError = {}));\n/** A mapping from regexes to the git error they identify. */\nexports.GitErrorRegexes = {\n    'ERROR: ([\\\\s\\\\S]+?)\\\\n+\\\\[EPOLICYKEYAGE\\\\]\\\\n+fatal: Could not read from remote repository.': GitError.SSHKeyAuditUnverified,\n    \"fatal: Authentication failed for 'https://\": GitError.HTTPSAuthenticationFailed,\n    'fatal: Authentication failed': GitError.SSHAuthenticationFailed,\n    'fatal: Could not read from remote repository.': GitError.SSHPermissionDenied,\n    'The requested URL returned error: 403': GitError.HTTPSAuthenticationFailed,\n    'fatal: The remote end hung up unexpectedly': GitError.RemoteDisconnection,\n    \"fatal: unable to access '(.+)': Failed to connect to (.+): Host is down\": GitError.HostDown,\n    'Failed to merge in the changes.': GitError.RebaseConflicts,\n    '(Merge conflict|Automatic merge failed; fix conflicts and then commit the result)': GitError.MergeConflicts,\n    \"fatal: repository '(.+)' not found\": GitError.HTTPSRepositoryNotFound,\n    'ERROR: Repository not found': GitError.SSHRepositoryNotFound,\n    \"\\\\((non-fast-forward|fetch first)\\\\)\\nerror: failed to push some refs to '.*'\": GitError.PushNotFastForward,\n    \"error: unable to delete '(.+)': remote ref does not exist\": GitError.BranchDeletionFailed,\n    '\\\\[remote rejected\\\\] (.+) \\\\(deletion of the current branch prohibited\\\\)': GitError.DefaultBranchDeletionFailed,\n    \"error: could not revert .*\\nhint: after resolving the conflicts, mark the corrected paths\\nhint: with 'git add <paths>' or 'git rm <paths>'\\nhint: and commit the result with 'git commit'\": GitError.RevertConflicts,\n    \"Applying: .*\\nNo changes - did you forget to use 'git add'\\\\?\\nIf there is nothing left to stage, chances are that something else\\n.*\": GitError.EmptyRebasePatch,\n    'There are no candidates for (rebasing|merging) among the refs that you just fetched.\\nGenerally this means that you provided a wildcard refspec which had no\\nmatches on the remote end.': GitError.NoMatchingRemoteBranch,\n    'nothing to commit': GitError.NothingToCommit,\n    \"No submodule mapping found in .gitmodules for path '(.+)'\": GitError.NoSubmoduleMapping,\n    \"fatal: repository '(.+)' does not exist\\nfatal: clone of '.+' into submodule path '(.+)' failed\": GitError.SubmoduleRepositoryDoesNotExist,\n    \"Fetched in submodule path '(.+)', but it did not contain (.+). Direct fetching of that commit failed.\": GitError.InvalidSubmoduleSHA,\n    \"fatal: could not create work tree dir '(.+)'.*: Permission denied\": GitError.LocalPermissionDenied,\n    'merge: (.+) - not something we can merge': GitError.InvalidMerge,\n    'invalid upstream (.+)': GitError.InvalidRebase,\n    'fatal: Non-fast-forward commit does not make sense into an empty head': GitError.NonFastForwardMergeIntoEmptyHead,\n    'error: (.+): (patch does not apply|already exists in working directory)': GitError.PatchDoesNotApply,\n    \"fatal: A branch named '(.+)' already exists.\": GitError.BranchAlreadyExists,\n    \"fatal: bad revision '(.*)'\": GitError.BadRevision,\n    'fatal: [Nn]ot a git repository \\\\(or any of the parent directories\\\\): (.*)': GitError.NotAGitRepository,\n    'fatal: refusing to merge unrelated histories': GitError.CannotMergeUnrelatedHistories,\n    'The .+ attribute should be .+ but is .+': GitError.LFSAttributeDoesNotMatch,\n    'fatal: Branch rename failed': GitError.BranchRenameFailed,\n    \"fatal: Path '(.+)' does not exist .+\": GitError.PathDoesNotExist,\n    \"fatal: Invalid object name '(.+)'.\": GitError.InvalidObjectName,\n    \"fatal: .+: '(.+)' is outside repository\": GitError.OutsideRepository,\n    'Another git process seems to be running in this repository, e.g.': GitError.LockFileAlreadyExists,\n    'fatal: There is no merge to abort': GitError.NoMergeToAbort,\n    // GitHub-specific errors\n    'error: GH001: ': GitError.PushWithFileSizeExceedingLimit,\n    'error: GH002: ': GitError.HexBranchNameRejected,\n    'error: GH003: Sorry, force-pushing to (.+) is not allowed.': GitError.ForcePushRejected,\n    'error: GH005: Sorry, refs longer than (.+) bytes are not allowed': GitError.InvalidRefLength,\n    'error: GH006: Protected branch update failed for (.+)\\nremote: error: At least one approved review is required': GitError.ProtectedBranchRequiresReview,\n    'error: GH006: Protected branch update failed for (.+)\\nremote: error: Cannot force-push to a protected branch': GitError.ProtectedBranchForcePush,\n    'error: GH006: Protected branch update failed for (.+)\\nremote: error: Cannot delete a protected branch': GitError.ProtectedBranchDeleteRejected,\n    'error: GH006: Protected branch update failed for (.+).\\nremote: error: Required status check \"(.+)\" is expected': GitError.ProtectedBranchRequiredStatus,\n    'error: GH007: Your push would publish a private email address.': GitError.PushWithPrivateEmail\n};\n/**\n * The error code for when git cannot be found. This most likely indicates a\n * problem with dugite itself.\n */\nexports.GitNotFoundErrorCode = 'git-not-found-error';\n/** The error code for when the path to a repository doesn't exist. */\nexports.RepositoryDoesNotExistErrorCode = 'repository-does-not-exist-error';\n//# sourceMappingURL=errors.js.map","import { git } from './core'\nimport { AppFileStatus, WorkingDirectoryFileChange } from '../../models/status'\nimport { DiffType } from '../../models/diff'\nimport { Repository } from '../../models/repository'\nimport { getWorkingDirectoryDiff } from './diff'\nimport { formatPatch } from '../patch-formatter'\n\nexport async function applyPatchToIndex(\n  repository: Repository,\n  file: WorkingDirectoryFileChange\n): Promise<void> {\n  // If the file was a rename we have to recreate that rename since we've\n  // just blown away the index. Think of this block of weird looking commands\n  // as running `git mv`.\n  if (file.status === AppFileStatus.Renamed && file.oldPath) {\n    // Make sure the index knows of the removed file. We could use\n    // update-index --force-remove here but we're not since it's\n    // possible that someone staged a rename and then recreated the\n    // original file and we don't have any guarantees for in which order\n    // partial stages vs full-file stages happen. By using git add the\n    // worst that could happen is that we re-stage a file already staged\n    // by updateIndex.\n    await git(\n      ['add', '--u', '--', file.oldPath],\n      repository.path,\n      'applyPatchToIndex'\n    )\n\n    // Figure out the blob oid of the removed file\n    // <mode> SP <type> SP <object> TAB <file>\n    const oldFile = await git(\n      ['ls-tree', 'HEAD', '--', file.oldPath],\n      repository.path,\n      'applyPatchToIndex'\n    )\n\n    const [info] = oldFile.stdout.split('\\t', 1)\n    const [mode, , oid] = info.split(' ', 3)\n\n    // Add the old file blob to the index under the new name\n    await git(\n      ['update-index', '--add', '--cacheinfo', mode, oid, file.path],\n      repository.path,\n      'applyPatchToIndex'\n    )\n  }\n\n  const applyArgs: string[] = [\n    'apply',\n    '--cached',\n    '--unidiff-zero',\n    '--whitespace=nowarn',\n    '-',\n  ]\n\n  const diff = await getWorkingDirectoryDiff(repository, file)\n\n  if (diff.kind !== DiffType.Text) {\n    throw new Error(`Unexpected diff result returned: '${diff.kind}'`)\n  }\n\n  const patch = await formatPatch(file, diff)\n  await git(applyArgs, repository.path, 'applyPatchToIndex', { stdin: patch })\n\n  return Promise.resolve()\n}\n","'use strict';\nmodule.exports = function (opts) {\n\topts = opts || {};\n\n\tvar env = opts.env || process.env;\n\tvar platform = opts.platform || process.platform;\n\n\tif (platform !== 'win32') {\n\t\treturn 'PATH';\n\t}\n\n\treturn Object.keys(env).filter(function (x) {\n\t\treturn x.toUpperCase() === 'PATH';\n\t})[0] || 'Path';\n};\n","'use strict'\nmodule.exports = Yallist\n\nYallist.Node = Node\nYallist.create = Yallist\n\nfunction Yallist (list) {\n  var self = this\n  if (!(self instanceof Yallist)) {\n    self = new Yallist()\n  }\n\n  self.tail = null\n  self.head = null\n  self.length = 0\n\n  if (list && typeof list.forEach === 'function') {\n    list.forEach(function (item) {\n      self.push(item)\n    })\n  } else if (arguments.length > 0) {\n    for (var i = 0, l = arguments.length; i < l; i++) {\n      self.push(arguments[i])\n    }\n  }\n\n  return self\n}\n\nYallist.prototype.removeNode = function (node) {\n  if (node.list !== this) {\n    throw new Error('removing node which does not belong to this list')\n  }\n\n  var next = node.next\n  var prev = node.prev\n\n  if (next) {\n    next.prev = prev\n  }\n\n  if (prev) {\n    prev.next = next\n  }\n\n  if (node === this.head) {\n    this.head = next\n  }\n  if (node === this.tail) {\n    this.tail = prev\n  }\n\n  node.list.length--\n  node.next = null\n  node.prev = null\n  node.list = null\n}\n\nYallist.prototype.unshiftNode = function (node) {\n  if (node === this.head) {\n    return\n  }\n\n  if (node.list) {\n    node.list.removeNode(node)\n  }\n\n  var head = this.head\n  node.list = this\n  node.next = head\n  if (head) {\n    head.prev = node\n  }\n\n  this.head = node\n  if (!this.tail) {\n    this.tail = node\n  }\n  this.length++\n}\n\nYallist.prototype.pushNode = function (node) {\n  if (node === this.tail) {\n    return\n  }\n\n  if (node.list) {\n    node.list.removeNode(node)\n  }\n\n  var tail = this.tail\n  node.list = this\n  node.prev = tail\n  if (tail) {\n    tail.next = node\n  }\n\n  this.tail = node\n  if (!this.head) {\n    this.head = node\n  }\n  this.length++\n}\n\nYallist.prototype.push = function () {\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    push(this, arguments[i])\n  }\n  return this.length\n}\n\nYallist.prototype.unshift = function () {\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    unshift(this, arguments[i])\n  }\n  return this.length\n}\n\nYallist.prototype.pop = function () {\n  if (!this.tail) {\n    return undefined\n  }\n\n  var res = this.tail.value\n  this.tail = this.tail.prev\n  if (this.tail) {\n    this.tail.next = null\n  } else {\n    this.head = null\n  }\n  this.length--\n  return res\n}\n\nYallist.prototype.shift = function () {\n  if (!this.head) {\n    return undefined\n  }\n\n  var res = this.head.value\n  this.head = this.head.next\n  if (this.head) {\n    this.head.prev = null\n  } else {\n    this.tail = null\n  }\n  this.length--\n  return res\n}\n\nYallist.prototype.forEach = function (fn, thisp) {\n  thisp = thisp || this\n  for (var walker = this.head, i = 0; walker !== null; i++) {\n    fn.call(thisp, walker.value, i, this)\n    walker = walker.next\n  }\n}\n\nYallist.prototype.forEachReverse = function (fn, thisp) {\n  thisp = thisp || this\n  for (var walker = this.tail, i = this.length - 1; walker !== null; i--) {\n    fn.call(thisp, walker.value, i, this)\n    walker = walker.prev\n  }\n}\n\nYallist.prototype.get = function (n) {\n  for (var i = 0, walker = this.head; walker !== null && i < n; i++) {\n    // abort out of the list early if we hit a cycle\n    walker = walker.next\n  }\n  if (i === n && walker !== null) {\n    return walker.value\n  }\n}\n\nYallist.prototype.getReverse = function (n) {\n  for (var i = 0, walker = this.tail; walker !== null && i < n; i++) {\n    // abort out of the list early if we hit a cycle\n    walker = walker.prev\n  }\n  if (i === n && walker !== null) {\n    return walker.value\n  }\n}\n\nYallist.prototype.map = function (fn, thisp) {\n  thisp = thisp || this\n  var res = new Yallist()\n  for (var walker = this.head; walker !== null;) {\n    res.push(fn.call(thisp, walker.value, this))\n    walker = walker.next\n  }\n  return res\n}\n\nYallist.prototype.mapReverse = function (fn, thisp) {\n  thisp = thisp || this\n  var res = new Yallist()\n  for (var walker = this.tail; walker !== null;) {\n    res.push(fn.call(thisp, walker.value, this))\n    walker = walker.prev\n  }\n  return res\n}\n\nYallist.prototype.reduce = function (fn, initial) {\n  var acc\n  var walker = this.head\n  if (arguments.length > 1) {\n    acc = initial\n  } else if (this.head) {\n    walker = this.head.next\n    acc = this.head.value\n  } else {\n    throw new TypeError('Reduce of empty list with no initial value')\n  }\n\n  for (var i = 0; walker !== null; i++) {\n    acc = fn(acc, walker.value, i)\n    walker = walker.next\n  }\n\n  return acc\n}\n\nYallist.prototype.reduceReverse = function (fn, initial) {\n  var acc\n  var walker = this.tail\n  if (arguments.length > 1) {\n    acc = initial\n  } else if (this.tail) {\n    walker = this.tail.prev\n    acc = this.tail.value\n  } else {\n    throw new TypeError('Reduce of empty list with no initial value')\n  }\n\n  for (var i = this.length - 1; walker !== null; i--) {\n    acc = fn(acc, walker.value, i)\n    walker = walker.prev\n  }\n\n  return acc\n}\n\nYallist.prototype.toArray = function () {\n  var arr = new Array(this.length)\n  for (var i = 0, walker = this.head; walker !== null; i++) {\n    arr[i] = walker.value\n    walker = walker.next\n  }\n  return arr\n}\n\nYallist.prototype.toArrayReverse = function () {\n  var arr = new Array(this.length)\n  for (var i = 0, walker = this.tail; walker !== null; i++) {\n    arr[i] = walker.value\n    walker = walker.prev\n  }\n  return arr\n}\n\nYallist.prototype.slice = function (from, to) {\n  to = to || this.length\n  if (to < 0) {\n    to += this.length\n  }\n  from = from || 0\n  if (from < 0) {\n    from += this.length\n  }\n  var ret = new Yallist()\n  if (to < from || to < 0) {\n    return ret\n  }\n  if (from < 0) {\n    from = 0\n  }\n  if (to > this.length) {\n    to = this.length\n  }\n  for (var i = 0, walker = this.head; walker !== null && i < from; i++) {\n    walker = walker.next\n  }\n  for (; walker !== null && i < to; i++, walker = walker.next) {\n    ret.push(walker.value)\n  }\n  return ret\n}\n\nYallist.prototype.sliceReverse = function (from, to) {\n  to = to || this.length\n  if (to < 0) {\n    to += this.length\n  }\n  from = from || 0\n  if (from < 0) {\n    from += this.length\n  }\n  var ret = new Yallist()\n  if (to < from || to < 0) {\n    return ret\n  }\n  if (from < 0) {\n    from = 0\n  }\n  if (to > this.length) {\n    to = this.length\n  }\n  for (var i = this.length, walker = this.tail; walker !== null && i > to; i--) {\n    walker = walker.prev\n  }\n  for (; walker !== null && i > from; i--, walker = walker.prev) {\n    ret.push(walker.value)\n  }\n  return ret\n}\n\nYallist.prototype.reverse = function () {\n  var head = this.head\n  var tail = this.tail\n  for (var walker = head; walker !== null; walker = walker.prev) {\n    var p = walker.prev\n    walker.prev = walker.next\n    walker.next = p\n  }\n  this.head = tail\n  this.tail = head\n  return this\n}\n\nfunction push (self, item) {\n  self.tail = new Node(item, self.tail, null, self)\n  if (!self.head) {\n    self.head = self.tail\n  }\n  self.length++\n}\n\nfunction unshift (self, item) {\n  self.head = new Node(item, null, self.head, self)\n  if (!self.tail) {\n    self.tail = self.head\n  }\n  self.length++\n}\n\nfunction Node (value, prev, next, list) {\n  if (!(this instanceof Node)) {\n    return new Node(value, prev, next, list)\n  }\n\n  this.list = list\n  this.value = value\n\n  if (prev) {\n    prev.next = this\n    this.prev = prev\n  } else {\n    this.prev = null\n  }\n\n  if (next) {\n    next.prev = this\n    this.next = next\n  } else {\n    this.next = null\n  }\n}\n\ntry {\n  // add if support or Symbol.iterator is present\n  require('./iterator.js')\n} catch (er) {}\n","'use strict'\n\nmodule.exports = LRUCache\n\n// This will be a proper iterable 'Map' in engines that support it,\n// or a fakey-fake PseudoMap in older versions.\nvar Map = require('pseudomap')\nvar util = require('util')\n\n// A linked list to keep track of recently-used-ness\nvar Yallist = require('yallist')\n\n// use symbols if possible, otherwise just _props\nvar hasSymbol = typeof Symbol === 'function'\nvar makeSymbol\nif (hasSymbol) {\n  makeSymbol = function (key) {\n    return Symbol.for(key)\n  }\n} else {\n  makeSymbol = function (key) {\n    return '_' + key\n  }\n}\n\nvar MAX = makeSymbol('max')\nvar LENGTH = makeSymbol('length')\nvar LENGTH_CALCULATOR = makeSymbol('lengthCalculator')\nvar ALLOW_STALE = makeSymbol('allowStale')\nvar MAX_AGE = makeSymbol('maxAge')\nvar DISPOSE = makeSymbol('dispose')\nvar NO_DISPOSE_ON_SET = makeSymbol('noDisposeOnSet')\nvar LRU_LIST = makeSymbol('lruList')\nvar CACHE = makeSymbol('cache')\n\nfunction naiveLength () { return 1 }\n\n// lruList is a yallist where the head is the youngest\n// item, and the tail is the oldest.  the list contains the Hit\n// objects as the entries.\n// Each Hit object has a reference to its Yallist.Node.  This\n// never changes.\n//\n// cache is a Map (or PseudoMap) that matches the keys to\n// the Yallist.Node object.\nfunction LRUCache (options) {\n  if (!(this instanceof LRUCache)) {\n    return new LRUCache(options)\n  }\n\n  if (typeof options === 'number') {\n    options = { max: options }\n  }\n\n  if (!options) {\n    options = {}\n  }\n\n  var max = this[MAX] = options.max\n  // Kind of weird to have a default max of Infinity, but oh well.\n  if (!max ||\n      !(typeof max === 'number') ||\n      max <= 0) {\n    this[MAX] = Infinity\n  }\n\n  var lc = options.length || naiveLength\n  if (typeof lc !== 'function') {\n    lc = naiveLength\n  }\n  this[LENGTH_CALCULATOR] = lc\n\n  this[ALLOW_STALE] = options.stale || false\n  this[MAX_AGE] = options.maxAge || 0\n  this[DISPOSE] = options.dispose\n  this[NO_DISPOSE_ON_SET] = options.noDisposeOnSet || false\n  this.reset()\n}\n\n// resize the cache when the max changes.\nObject.defineProperty(LRUCache.prototype, 'max', {\n  set: function (mL) {\n    if (!mL || !(typeof mL === 'number') || mL <= 0) {\n      mL = Infinity\n    }\n    this[MAX] = mL\n    trim(this)\n  },\n  get: function () {\n    return this[MAX]\n  },\n  enumerable: true\n})\n\nObject.defineProperty(LRUCache.prototype, 'allowStale', {\n  set: function (allowStale) {\n    this[ALLOW_STALE] = !!allowStale\n  },\n  get: function () {\n    return this[ALLOW_STALE]\n  },\n  enumerable: true\n})\n\nObject.defineProperty(LRUCache.prototype, 'maxAge', {\n  set: function (mA) {\n    if (!mA || !(typeof mA === 'number') || mA < 0) {\n      mA = 0\n    }\n    this[MAX_AGE] = mA\n    trim(this)\n  },\n  get: function () {\n    return this[MAX_AGE]\n  },\n  enumerable: true\n})\n\n// resize the cache when the lengthCalculator changes.\nObject.defineProperty(LRUCache.prototype, 'lengthCalculator', {\n  set: function (lC) {\n    if (typeof lC !== 'function') {\n      lC = naiveLength\n    }\n    if (lC !== this[LENGTH_CALCULATOR]) {\n      this[LENGTH_CALCULATOR] = lC\n      this[LENGTH] = 0\n      this[LRU_LIST].forEach(function (hit) {\n        hit.length = this[LENGTH_CALCULATOR](hit.value, hit.key)\n        this[LENGTH] += hit.length\n      }, this)\n    }\n    trim(this)\n  },\n  get: function () { return this[LENGTH_CALCULATOR] },\n  enumerable: true\n})\n\nObject.defineProperty(LRUCache.prototype, 'length', {\n  get: function () { return this[LENGTH] },\n  enumerable: true\n})\n\nObject.defineProperty(LRUCache.prototype, 'itemCount', {\n  get: function () { return this[LRU_LIST].length },\n  enumerable: true\n})\n\nLRUCache.prototype.rforEach = function (fn, thisp) {\n  thisp = thisp || this\n  for (var walker = this[LRU_LIST].tail; walker !== null;) {\n    var prev = walker.prev\n    forEachStep(this, fn, walker, thisp)\n    walker = prev\n  }\n}\n\nfunction forEachStep (self, fn, node, thisp) {\n  var hit = node.value\n  if (isStale(self, hit)) {\n    del(self, node)\n    if (!self[ALLOW_STALE]) {\n      hit = undefined\n    }\n  }\n  if (hit) {\n    fn.call(thisp, hit.value, hit.key, self)\n  }\n}\n\nLRUCache.prototype.forEach = function (fn, thisp) {\n  thisp = thisp || this\n  for (var walker = this[LRU_LIST].head; walker !== null;) {\n    var next = walker.next\n    forEachStep(this, fn, walker, thisp)\n    walker = next\n  }\n}\n\nLRUCache.prototype.keys = function () {\n  return this[LRU_LIST].toArray().map(function (k) {\n    return k.key\n  }, this)\n}\n\nLRUCache.prototype.values = function () {\n  return this[LRU_LIST].toArray().map(function (k) {\n    return k.value\n  }, this)\n}\n\nLRUCache.prototype.reset = function () {\n  if (this[DISPOSE] &&\n      this[LRU_LIST] &&\n      this[LRU_LIST].length) {\n    this[LRU_LIST].forEach(function (hit) {\n      this[DISPOSE](hit.key, hit.value)\n    }, this)\n  }\n\n  this[CACHE] = new Map() // hash of items by key\n  this[LRU_LIST] = new Yallist() // list of items in order of use recency\n  this[LENGTH] = 0 // length of items in the list\n}\n\nLRUCache.prototype.dump = function () {\n  return this[LRU_LIST].map(function (hit) {\n    if (!isStale(this, hit)) {\n      return {\n        k: hit.key,\n        v: hit.value,\n        e: hit.now + (hit.maxAge || 0)\n      }\n    }\n  }, this).toArray().filter(function (h) {\n    return h\n  })\n}\n\nLRUCache.prototype.dumpLru = function () {\n  return this[LRU_LIST]\n}\n\nLRUCache.prototype.inspect = function (n, opts) {\n  var str = 'LRUCache {'\n  var extras = false\n\n  var as = this[ALLOW_STALE]\n  if (as) {\n    str += '\\n  allowStale: true'\n    extras = true\n  }\n\n  var max = this[MAX]\n  if (max && max !== Infinity) {\n    if (extras) {\n      str += ','\n    }\n    str += '\\n  max: ' + util.inspect(max, opts)\n    extras = true\n  }\n\n  var maxAge = this[MAX_AGE]\n  if (maxAge) {\n    if (extras) {\n      str += ','\n    }\n    str += '\\n  maxAge: ' + util.inspect(maxAge, opts)\n    extras = true\n  }\n\n  var lc = this[LENGTH_CALCULATOR]\n  if (lc && lc !== naiveLength) {\n    if (extras) {\n      str += ','\n    }\n    str += '\\n  length: ' + util.inspect(this[LENGTH], opts)\n    extras = true\n  }\n\n  var didFirst = false\n  this[LRU_LIST].forEach(function (item) {\n    if (didFirst) {\n      str += ',\\n  '\n    } else {\n      if (extras) {\n        str += ',\\n'\n      }\n      didFirst = true\n      str += '\\n  '\n    }\n    var key = util.inspect(item.key).split('\\n').join('\\n  ')\n    var val = { value: item.value }\n    if (item.maxAge !== maxAge) {\n      val.maxAge = item.maxAge\n    }\n    if (lc !== naiveLength) {\n      val.length = item.length\n    }\n    if (isStale(this, item)) {\n      val.stale = true\n    }\n\n    val = util.inspect(val, opts).split('\\n').join('\\n  ')\n    str += key + ' => ' + val\n  })\n\n  if (didFirst || extras) {\n    str += '\\n'\n  }\n  str += '}'\n\n  return str\n}\n\nLRUCache.prototype.set = function (key, value, maxAge) {\n  maxAge = maxAge || this[MAX_AGE]\n\n  var now = maxAge ? Date.now() : 0\n  var len = this[LENGTH_CALCULATOR](value, key)\n\n  if (this[CACHE].has(key)) {\n    if (len > this[MAX]) {\n      del(this, this[CACHE].get(key))\n      return false\n    }\n\n    var node = this[CACHE].get(key)\n    var item = node.value\n\n    // dispose of the old one before overwriting\n    // split out into 2 ifs for better coverage tracking\n    if (this[DISPOSE]) {\n      if (!this[NO_DISPOSE_ON_SET]) {\n        this[DISPOSE](key, item.value)\n      }\n    }\n\n    item.now = now\n    item.maxAge = maxAge\n    item.value = value\n    this[LENGTH] += len - item.length\n    item.length = len\n    this.get(key)\n    trim(this)\n    return true\n  }\n\n  var hit = new Entry(key, value, len, now, maxAge)\n\n  // oversized objects fall out of cache automatically.\n  if (hit.length > this[MAX]) {\n    if (this[DISPOSE]) {\n      this[DISPOSE](key, value)\n    }\n    return false\n  }\n\n  this[LENGTH] += hit.length\n  this[LRU_LIST].unshift(hit)\n  this[CACHE].set(key, this[LRU_LIST].head)\n  trim(this)\n  return true\n}\n\nLRUCache.prototype.has = function (key) {\n  if (!this[CACHE].has(key)) return false\n  var hit = this[CACHE].get(key).value\n  if (isStale(this, hit)) {\n    return false\n  }\n  return true\n}\n\nLRUCache.prototype.get = function (key) {\n  return get(this, key, true)\n}\n\nLRUCache.prototype.peek = function (key) {\n  return get(this, key, false)\n}\n\nLRUCache.prototype.pop = function () {\n  var node = this[LRU_LIST].tail\n  if (!node) return null\n  del(this, node)\n  return node.value\n}\n\nLRUCache.prototype.del = function (key) {\n  del(this, this[CACHE].get(key))\n}\n\nLRUCache.prototype.load = function (arr) {\n  // reset the cache\n  this.reset()\n\n  var now = Date.now()\n  // A previous serialized cache has the most recent items first\n  for (var l = arr.length - 1; l >= 0; l--) {\n    var hit = arr[l]\n    var expiresAt = hit.e || 0\n    if (expiresAt === 0) {\n      // the item was created without expiration in a non aged cache\n      this.set(hit.k, hit.v)\n    } else {\n      var maxAge = expiresAt - now\n      // dont add already expired items\n      if (maxAge > 0) {\n        this.set(hit.k, hit.v, maxAge)\n      }\n    }\n  }\n}\n\nLRUCache.prototype.prune = function () {\n  var self = this\n  this[CACHE].forEach(function (value, key) {\n    get(self, key, false)\n  })\n}\n\nfunction get (self, key, doUse) {\n  var node = self[CACHE].get(key)\n  if (node) {\n    var hit = node.value\n    if (isStale(self, hit)) {\n      del(self, node)\n      if (!self[ALLOW_STALE]) hit = undefined\n    } else {\n      if (doUse) {\n        self[LRU_LIST].unshiftNode(node)\n      }\n    }\n    if (hit) hit = hit.value\n  }\n  return hit\n}\n\nfunction isStale (self, hit) {\n  if (!hit || (!hit.maxAge && !self[MAX_AGE])) {\n    return false\n  }\n  var stale = false\n  var diff = Date.now() - hit.now\n  if (hit.maxAge) {\n    stale = diff > hit.maxAge\n  } else {\n    stale = self[MAX_AGE] && (diff > self[MAX_AGE])\n  }\n  return stale\n}\n\nfunction trim (self) {\n  if (self[LENGTH] > self[MAX]) {\n    for (var walker = self[LRU_LIST].tail;\n         self[LENGTH] > self[MAX] && walker !== null;) {\n      // We know that we're about to delete this one, and also\n      // what the next least recently used key will be, so just\n      // go ahead and set it now.\n      var prev = walker.prev\n      del(self, walker)\n      walker = prev\n    }\n  }\n}\n\nfunction del (self, node) {\n  if (node) {\n    var hit = node.value\n    if (self[DISPOSE]) {\n      self[DISPOSE](hit.key, hit.value)\n    }\n    self[LENGTH] -= hit.length\n    self[CACHE].delete(hit.key)\n    self[LRU_LIST].removeNode(node)\n  }\n}\n\n// classy, since V8 prefers predictable objects.\nfunction Entry (key, value, length, now, maxAge) {\n  this.key = key\n  this.value = value\n  this.length = length\n  this.now = now\n  this.maxAge = maxAge || 0\n}\n","'use strict';\nvar childProcess = require('child_process');\nvar crossSpawnAsync = require('cross-spawn-async');\nvar stripEof = require('strip-eof');\nvar objectAssign = require('object-assign');\nvar npmRunPath = require('npm-run-path');\nvar isStream = require('is-stream');\nvar pathKey = require('path-key')();\nvar TEN_MEBIBYTE = 1024 * 1024 * 10;\n\nfunction handleArgs(cmd, args, opts) {\n\tvar parsed;\n\n\tif (opts && opts.__winShell === true) {\n\t\tdelete opts.__winShell;\n\t\tparsed = {\n\t\t\tcommand: cmd,\n\t\t\targs: args,\n\t\t\toptions: opts,\n\t\t\tfile: cmd,\n\t\t\toriginal: cmd\n\t\t};\n\t} else {\n\t\tparsed = crossSpawnAsync._parse(cmd, args, opts);\n\t}\n\n\topts = objectAssign({\n\t\tmaxBuffer: TEN_MEBIBYTE,\n\t\tstripEof: true,\n\t\tpreferLocal: true,\n\t\tencoding: 'utf8'\n\t}, parsed.options);\n\n\tif (opts.preferLocal) {\n\t\topts.env = objectAssign({}, opts.env || process.env);\n\t\topts.env[pathKey] = npmRunPath({\n\t\t\tcwd: opts.cwd,\n\t\t\tpath: opts.env[pathKey]\n\t\t});\n\t}\n\n\treturn {\n\t\tcmd: parsed.command,\n\t\targs: parsed.args,\n\t\topts: opts\n\t};\n}\n\nfunction handleInput(spawned, opts) {\n\tvar input = opts.input;\n\n\tif (input === null || input === undefined) {\n\t\treturn;\n\t}\n\n\tif (isStream(input)) {\n\t\tinput.pipe(spawned.stdin);\n\t} else {\n\t\tspawned.stdin.end(input);\n\t}\n}\n\nfunction handleOutput(opts, val) {\n\tif (opts.stripEof) {\n\t\tval = stripEof(val);\n\t}\n\n\treturn val;\n}\n\nfunction handleShell(fn, cmd, opts) {\n\tvar file;\n\tvar args;\n\n\topts = objectAssign({}, opts);\n\n\tif (process.platform === 'win32') {\n\t\topts.__winShell = true;\n\t\tfile = process.env.comspec || 'cmd.exe';\n\t\targs = ['/s', '/c', '\"' + cmd + '\"'];\n\t\topts.windowsVerbatimArguments = true;\n\t} else {\n\t\tfile = '/bin/sh';\n\t\targs = ['-c', cmd];\n\t}\n\n\tif (opts.shell) {\n\t\tfile = opts.shell;\n\t}\n\n\treturn fn(file, args, opts);\n}\n\nmodule.exports = function (cmd, args, opts) {\n\tvar spawned;\n\n\tvar promise = new Promise(function (resolve, reject) {\n\t\tvar parsed = handleArgs(cmd, args, opts);\n\n\t\tspawned = childProcess.execFile(parsed.cmd, parsed.args, parsed.opts, function (err, stdout, stderr) {\n\t\t\tif (err) {\n\t\t\t\terr.stdout = stdout;\n\t\t\t\terr.stderr = stderr;\n\t\t\t\terr.message += stdout;\n\t\t\t\treject(err);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tresolve({\n\t\t\t\tstdout: handleOutput(parsed.opts, stdout),\n\t\t\t\tstderr: handleOutput(parsed.opts, stderr)\n\t\t\t});\n\t\t});\n\n\t\tcrossSpawnAsync._enoent.hookChildProcess(spawned, parsed);\n\n\t\thandleInput(spawned, parsed.opts);\n\t});\n\n\tspawned.then = promise.then.bind(promise);\n\tspawned.catch = promise.catch.bind(promise);\n\n\treturn spawned;\n};\n\nmodule.exports.stdout = function () {\n\t// TODO: set `stderr: 'ignore'` when that option is implemented\n\treturn module.exports.apply(null, arguments).then(function (x) {\n\t\treturn x.stdout;\n\t});\n};\n\nmodule.exports.stderr = function () {\n\t// TODO: set `stdout: 'ignore'` when that option is implemented\n\treturn module.exports.apply(null, arguments).then(function (x) {\n\t\treturn x.stderr;\n\t});\n};\n\nmodule.exports.shell = function (cmd, opts) {\n\treturn handleShell(module.exports, cmd, opts);\n};\n\nmodule.exports.spawn = function (cmd, args, opts) {\n\tvar parsed = handleArgs(cmd, args, opts);\n\tvar spawned = childProcess.spawn(parsed.cmd, parsed.args, parsed.opts);\n\n\tcrossSpawnAsync._enoent.hookChildProcess(spawned, parsed);\n\n\treturn spawned;\n};\n\nmodule.exports.sync = function (cmd, args, opts) {\n\tvar parsed = handleArgs(cmd, args, opts);\n\n\tif (isStream(parsed.opts.input)) {\n\t\tthrow new TypeError('The `input` option cannot be a stream in sync mode');\n\t}\n\n\tvar result = childProcess.spawnSync(parsed.cmd, parsed.args, parsed.opts);\n\n\tif (parsed.opts.stripEof) {\n\t\tresult.stdout = stripEof(result.stdout);\n\t\tresult.stderr = stripEof(result.stderr);\n\t}\n\n\treturn result;\n};\n\nmodule.exports.shellSync = function (cmd, opts) {\n\treturn handleShell(module.exports.sync, cmd, opts);\n};\n","'use strict';\n\nexports.__esModule = true;\nexports.nameShape = undefined;\nexports.transitionTimeout = transitionTimeout;\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction transitionTimeout(transitionType) {\n  var timeoutPropName = 'transition' + transitionType + 'Timeout';\n  var enabledPropName = 'transition' + transitionType;\n\n  return function (props) {\n    // If the transition is enabled\n    if (props[enabledPropName]) {\n      // If no timeout duration is provided\n      if (props[timeoutPropName] == null) {\n        return new Error(timeoutPropName + ' wasn\\'t supplied to CSSTransitionGroup: ' + 'this can cause unreliable animations and won\\'t be supported in ' + 'a future version of React. See ' + 'https://fb.me/react-animation-transition-group-timeout for more ' + 'information.');\n\n        // If the duration isn't a number\n      } else if (typeof props[timeoutPropName] !== 'number') {\n        return new Error(timeoutPropName + ' must be a number (in milliseconds)');\n      }\n    }\n\n    return null;\n  };\n}\n\nvar nameShape = exports.nameShape = _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.shape({\n  enter: _propTypes2.default.string,\n  leave: _propTypes2.default.string,\n  active: _propTypes2.default.string\n}), _propTypes2.default.shape({\n  enter: _propTypes2.default.string,\n  enterActive: _propTypes2.default.string,\n  leave: _propTypes2.default.string,\n  leaveActive: _propTypes2.default.string,\n  appear: _propTypes2.default.string,\n  appearActive: _propTypes2.default.string\n})]);","'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _chainFunction = require('chain-function');\n\nvar _chainFunction2 = _interopRequireDefault(_chainFunction);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _warning = require('warning');\n\nvar _warning2 = _interopRequireDefault(_warning);\n\nvar _ChildMapping = require('./utils/ChildMapping');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar propTypes = {\n  component: _propTypes2.default.any,\n  childFactory: _propTypes2.default.func,\n  children: _propTypes2.default.node\n};\n\nvar defaultProps = {\n  component: 'span',\n  childFactory: function childFactory(child) {\n    return child;\n  }\n};\n\nvar TransitionGroup = function (_React$Component) {\n  _inherits(TransitionGroup, _React$Component);\n\n  function TransitionGroup(props, context) {\n    _classCallCheck(this, TransitionGroup);\n\n    var _this = _possibleConstructorReturn(this, _React$Component.call(this, props, context));\n\n    _this.performAppear = function (key, component) {\n      _this.currentlyTransitioningKeys[key] = true;\n\n      if (component.componentWillAppear) {\n        component.componentWillAppear(_this._handleDoneAppearing.bind(_this, key, component));\n      } else {\n        _this._handleDoneAppearing(key, component);\n      }\n    };\n\n    _this._handleDoneAppearing = function (key, component) {\n      if (component.componentDidAppear) {\n        component.componentDidAppear();\n      }\n\n      delete _this.currentlyTransitioningKeys[key];\n\n      var currentChildMapping = (0, _ChildMapping.getChildMapping)(_this.props.children);\n\n      if (!currentChildMapping || !currentChildMapping.hasOwnProperty(key)) {\n        // This was removed before it had fully appeared. Remove it.\n        _this.performLeave(key, component);\n      }\n    };\n\n    _this.performEnter = function (key, component) {\n      _this.currentlyTransitioningKeys[key] = true;\n\n      if (component.componentWillEnter) {\n        component.componentWillEnter(_this._handleDoneEntering.bind(_this, key, component));\n      } else {\n        _this._handleDoneEntering(key, component);\n      }\n    };\n\n    _this._handleDoneEntering = function (key, component) {\n      if (component.componentDidEnter) {\n        component.componentDidEnter();\n      }\n\n      delete _this.currentlyTransitioningKeys[key];\n\n      var currentChildMapping = (0, _ChildMapping.getChildMapping)(_this.props.children);\n\n      if (!currentChildMapping || !currentChildMapping.hasOwnProperty(key)) {\n        // This was removed before it had fully entered. Remove it.\n        _this.performLeave(key, component);\n      }\n    };\n\n    _this.performLeave = function (key, component) {\n      _this.currentlyTransitioningKeys[key] = true;\n\n      if (component.componentWillLeave) {\n        component.componentWillLeave(_this._handleDoneLeaving.bind(_this, key, component));\n      } else {\n        // Note that this is somewhat dangerous b/c it calls setState()\n        // again, effectively mutating the component before all the work\n        // is done.\n        _this._handleDoneLeaving(key, component);\n      }\n    };\n\n    _this._handleDoneLeaving = function (key, component) {\n      if (component.componentDidLeave) {\n        component.componentDidLeave();\n      }\n\n      delete _this.currentlyTransitioningKeys[key];\n\n      var currentChildMapping = (0, _ChildMapping.getChildMapping)(_this.props.children);\n\n      if (currentChildMapping && currentChildMapping.hasOwnProperty(key)) {\n        // This entered again before it fully left. Add it again.\n        _this.keysToEnter.push(key);\n      } else {\n        _this.setState(function (state) {\n          var newChildren = _extends({}, state.children);\n          delete newChildren[key];\n          return { children: newChildren };\n        });\n      }\n    };\n\n    _this.childRefs = Object.create(null);\n\n    _this.state = {\n      children: (0, _ChildMapping.getChildMapping)(props.children)\n    };\n    return _this;\n  }\n\n  TransitionGroup.prototype.componentWillMount = function componentWillMount() {\n    this.currentlyTransitioningKeys = {};\n    this.keysToEnter = [];\n    this.keysToLeave = [];\n  };\n\n  TransitionGroup.prototype.componentDidMount = function componentDidMount() {\n    var initialChildMapping = this.state.children;\n    for (var key in initialChildMapping) {\n      if (initialChildMapping[key]) {\n        this.performAppear(key, this.childRefs[key]);\n      }\n    }\n  };\n\n  TransitionGroup.prototype.componentWillReceiveProps = function componentWillReceiveProps(nextProps) {\n    var nextChildMapping = (0, _ChildMapping.getChildMapping)(nextProps.children);\n    var prevChildMapping = this.state.children;\n\n    this.setState({\n      children: (0, _ChildMapping.mergeChildMappings)(prevChildMapping, nextChildMapping)\n    });\n\n    for (var key in nextChildMapping) {\n      var hasPrev = prevChildMapping && prevChildMapping.hasOwnProperty(key);\n      if (nextChildMapping[key] && !hasPrev && !this.currentlyTransitioningKeys[key]) {\n        this.keysToEnter.push(key);\n      }\n    }\n\n    for (var _key in prevChildMapping) {\n      var hasNext = nextChildMapping && nextChildMapping.hasOwnProperty(_key);\n      if (prevChildMapping[_key] && !hasNext && !this.currentlyTransitioningKeys[_key]) {\n        this.keysToLeave.push(_key);\n      }\n    }\n\n    // If we want to someday check for reordering, we could do it here.\n  };\n\n  TransitionGroup.prototype.componentDidUpdate = function componentDidUpdate() {\n    var _this2 = this;\n\n    var keysToEnter = this.keysToEnter;\n    this.keysToEnter = [];\n    keysToEnter.forEach(function (key) {\n      return _this2.performEnter(key, _this2.childRefs[key]);\n    });\n\n    var keysToLeave = this.keysToLeave;\n    this.keysToLeave = [];\n    keysToLeave.forEach(function (key) {\n      return _this2.performLeave(key, _this2.childRefs[key]);\n    });\n  };\n\n  TransitionGroup.prototype.render = function render() {\n    var _this3 = this;\n\n    // TODO: we could get rid of the need for the wrapper node\n    // by cloning a single child\n    var childrenToRender = [];\n\n    var _loop = function _loop(key) {\n      var child = _this3.state.children[key];\n      if (child) {\n        var isCallbackRef = typeof child.ref !== 'string';\n        var factoryChild = _this3.props.childFactory(child);\n        var ref = function ref(r) {\n          _this3.childRefs[key] = r;\n        };\n\n        process.env.NODE_ENV !== 'production' ? (0, _warning2.default)(isCallbackRef, 'string refs are not supported on children of TransitionGroup and will be ignored. ' + 'Please use a callback ref instead: https://facebook.github.io/react/docs/refs-and-the-dom.html#the-ref-callback-attribute') : void 0;\n\n        // Always chaining the refs leads to problems when the childFactory\n        // wraps the child. The child ref callback gets called twice with the\n        // wrapper and the child. So we only need to chain the ref if the\n        // factoryChild is not different from child.\n        if (factoryChild === child && isCallbackRef) {\n          ref = (0, _chainFunction2.default)(child.ref, ref);\n        }\n\n        // You may need to apply reactive updates to a child as it is leaving.\n        // The normal React way to do it won't work since the child will have\n        // already been removed. In case you need this behavior you can provide\n        // a childFactory function to wrap every child, even the ones that are\n        // leaving.\n        childrenToRender.push(_react2.default.cloneElement(factoryChild, {\n          key: key,\n          ref: ref\n        }));\n      }\n    };\n\n    for (var key in this.state.children) {\n      _loop(key);\n    }\n\n    // Do not forward TransitionGroup props to primitive DOM nodes\n    var props = _extends({}, this.props);\n    delete props.transitionLeave;\n    delete props.transitionName;\n    delete props.transitionAppear;\n    delete props.transitionEnter;\n    delete props.childFactory;\n    delete props.transitionLeaveTimeout;\n    delete props.transitionEnterTimeout;\n    delete props.transitionAppearTimeout;\n    delete props.component;\n\n    return _react2.default.createElement(this.props.component, props, childrenToRender);\n  };\n\n  return TransitionGroup;\n}(_react2.default.Component);\n\nTransitionGroup.displayName = 'TransitionGroup';\n\n\nTransitionGroup.propTypes = process.env.NODE_ENV !== \"production\" ? propTypes : {};\nTransitionGroup.defaultProps = defaultProps;\n\nexports.default = TransitionGroup;\nmodule.exports = exports['default'];","import * as React from 'react'\nimport { ipcRenderer, remote } from 'electron'\nimport { CSSTransitionGroup } from 'react-transition-group'\n\nimport {\n  IAppState,\n  RepositorySectionTab,\n  Popup,\n  PopupType,\n  FoldoutType,\n  SelectionType,\n  CompareActionKind,\n} from '../lib/app-state'\nimport { Dispatcher } from '../lib/dispatcher'\nimport { AppStore, GitHubUserStore, IssuesStore } from '../lib/stores'\nimport { assertNever } from '../lib/fatal-error'\nimport { shell } from '../lib/app-shell'\nimport { updateStore, UpdateStatus } from './lib/update-store'\nimport { RetryAction } from '../lib/retry-actions'\nimport { shouldRenderApplicationMenu } from './lib/features'\nimport { matchExistingRepository } from '../lib/repository-matching'\nimport { getDotComAPIEndpoint } from '../lib/api'\nimport { ILaunchStats } from '../lib/stats'\nimport { getVersion, getName } from './lib/app-proxy'\nimport { getOS } from '../lib/get-os'\nimport { validatedRepositoryPath } from '../lib/stores/helpers/validated-repository-path'\n\nimport { MenuEvent } from '../main-process/menu'\n\nimport { Repository } from '../models/repository'\nimport { Branch } from '../models/branch'\nimport { PreferencesTab } from '../models/preferences'\nimport { findItemByAccessKey, itemIsSelectable } from '../models/app-menu'\nimport { Account } from '../models/account'\nimport { TipState } from '../models/tip'\nimport { CloneRepositoryTab } from '../models/clone-repository-tab'\nimport { CloningRepository } from '../models/cloning-repository'\n\nimport { TitleBar, ZoomInfo, FullScreenInfo } from './window'\n\nimport { RepositoriesList } from './repositories-list'\nimport { RepositoryView } from './repository'\nimport { RenameBranch } from './rename-branch'\nimport { DeleteBranch } from './delete-branch'\nimport { CloningRepositoryView } from './cloning-repository'\nimport {\n  Toolbar,\n  ToolbarDropdown,\n  DropdownState,\n  PushPullButton,\n  BranchDropdown,\n  RevertProgress,\n} from './toolbar'\nimport { OcticonSymbol, iconForRepository } from './octicons'\nimport {\n  showCertificateTrustDialog,\n  registerContextualMenuActionDispatcher,\n  sendReady,\n} from './main-process-proxy'\nimport { DiscardChanges } from './discard-changes'\nimport { Welcome } from './welcome'\nimport { AppMenuBar } from './app-menu'\nimport { UpdateAvailable } from './updates'\nimport { Preferences } from './preferences'\nimport { Merge } from './merge-branch'\nimport { RepositorySettings } from './repository-settings'\nimport { AppError } from './app-error'\nimport { MissingRepository } from './missing-repository'\nimport { AddExistingRepository, CreateRepository } from './add-repository'\nimport { CloneRepository } from './clone-repository'\nimport { CreateBranch } from './create-branch'\nimport { SignIn } from './sign-in'\nimport { InstallGit } from './install-git'\nimport { EditorError } from './editor'\nimport { About } from './about'\nimport { Publish } from './publish-repository'\nimport { Acknowledgements } from './acknowledgements'\nimport { UntrustedCertificate } from './untrusted-certificate'\nimport { BlankSlateView } from './blank-slate'\nimport { ConfirmRemoveRepository } from './remove-repository'\nimport { TermsAndConditions } from './terms-and-conditions'\nimport { PushBranchCommits } from './branches'\nimport { CLIInstalled } from './cli-installed'\nimport { GenericGitAuthentication } from './generic-git-auth'\nimport { ShellError } from './shell'\nimport { InitializeLFS, AttributeMismatch } from './lfs'\nimport { UpstreamAlreadyExists } from './upstream-already-exists'\nimport { ReleaseNotes } from './release-notes'\nimport { DeletePullRequest } from './delete-branch/delete-pull-request-dialog'\nimport { MergeConflictsWarning } from './merge-conflicts'\nimport { AppTheme } from './app-theme'\nimport { ApplicationTheme } from './lib/application-theme'\nimport { RepositoryStateCache } from '../lib/stores/repository-state-cache'\n\nconst MinuteInMilliseconds = 1000 * 60\n\n/** The interval at which we should check for updates. */\nconst UpdateCheckInterval = 1000 * 60 * 60 * 4\n\nconst SendStatsInterval = 1000 * 60 * 60 * 4\n\nconst InitialRepositoryIndicatorTimeout = 2 * MinuteInMilliseconds\nconst UpdateRepositoryIndicatorInterval = 15 * MinuteInMilliseconds\n\ninterface IAppProps {\n  readonly dispatcher: Dispatcher\n  readonly repositoryStateManager: RepositoryStateCache\n  readonly appStore: AppStore\n  readonly issuesStore: IssuesStore\n  readonly gitHubUserStore: GitHubUserStore\n  readonly startTime: number\n}\n\nexport const dialogTransitionEnterTimeout = 250\nexport const dialogTransitionLeaveTimeout = 100\n\n/**\n * The time to delay (in ms) from when we've loaded the initial state to showing\n * the window. This is try to give Chromium enough time to flush our latest DOM\n * changes. See https://github.com/desktop/desktop/issues/1398.\n */\nconst ReadyDelay = 100\n\nexport class App extends React.Component<IAppProps, IAppState> {\n  private loading = true\n\n  /**\n   * Used on non-macOS platforms to support the Alt key behavior for\n   * the custom application menu. See the event handlers for window\n   * keyup and keydown.\n   */\n  private lastKeyPressed: string | null = null\n\n  private updateIntervalHandle?: number\n\n  /**\n   * Gets a value indicating whether or not we're currently showing a\n   * modal dialog such as the preferences, or an error dialog.\n   */\n  private get isShowingModal() {\n    return this.state.currentPopup !== null || this.state.errors.length > 0\n  }\n\n  public constructor(props: IAppProps) {\n    super(props)\n\n    registerContextualMenuActionDispatcher()\n\n    props.dispatcher.loadInitialState().then(() => {\n      this.loading = false\n      this.forceUpdate()\n\n      requestIdleCallback(\n        () => {\n          const now = performance.now()\n          sendReady(now - props.startTime)\n\n          requestIdleCallback(() => {\n            this.performDeferredLaunchActions()\n          })\n        },\n        { timeout: ReadyDelay }\n      )\n\n      const initialTimeout = window.setTimeout(async () => {\n        window.clearTimeout(initialTimeout)\n\n        await this.props.appStore.refreshAllIndicators()\n\n        this.updateIntervalHandle = window.setInterval(() => {\n          this.props.appStore.refreshAllIndicators()\n        }, UpdateRepositoryIndicatorInterval)\n      }, InitialRepositoryIndicatorTimeout)\n    })\n\n    this.state = props.appStore.getState()\n    props.appStore.onDidUpdate(state => {\n      this.setState(state)\n    })\n\n    props.appStore.onDidError(error => {\n      props.dispatcher.postError(error)\n    })\n\n    ipcRenderer.on(\n      'menu-event',\n      (event: Electron.IpcMessageEvent, { name }: { name: MenuEvent }) => {\n        this.onMenuEvent(name)\n      }\n    )\n\n    updateStore.onDidChange(state => {\n      const status = state.status\n\n      if (\n        !(\n          __RELEASE_CHANNEL__ === 'development' ||\n          __RELEASE_CHANNEL__ === 'test'\n        ) &&\n        status === UpdateStatus.UpdateReady\n      ) {\n        this.props.dispatcher.setUpdateBannerVisibility(true)\n      }\n    })\n\n    updateStore.onError(error => {\n      log.error(`Error checking for updates`, error)\n\n      this.props.dispatcher.postError(error)\n    })\n\n    ipcRenderer.on(\n      'launch-timing-stats',\n      (event: Electron.IpcMessageEvent, { stats }: { stats: ILaunchStats }) => {\n        console.info(`App ready time: ${stats.mainReadyTime}ms`)\n        console.info(`Load time: ${stats.loadTime}ms`)\n        console.info(`Renderer ready time: ${stats.rendererReadyTime}ms`)\n\n        this.props.dispatcher.recordLaunchStats(stats)\n      }\n    )\n\n    ipcRenderer.on(\n      'certificate-error',\n      (\n        event: Electron.IpcMessageEvent,\n        {\n          certificate,\n          error,\n          url,\n        }: { certificate: Electron.Certificate; error: string; url: string }\n      ) => {\n        this.props.dispatcher.showPopup({\n          type: PopupType.UntrustedCertificate,\n          certificate,\n          url,\n        })\n      }\n    )\n  }\n\n  public componentWillUnmount() {\n    window.clearInterval(this.updateIntervalHandle)\n  }\n\n  private performDeferredLaunchActions() {\n    // Loading emoji is super important but maybe less important that loading\n    // the app. So defer it until we have some breathing space.\n    this.props.appStore.loadEmoji()\n\n    this.props.dispatcher.reportStats()\n    setInterval(() => this.props.dispatcher.reportStats(), SendStatsInterval)\n\n    this.props.dispatcher.installGlobalLFSFilters(false)\n\n    setInterval(() => this.checkForUpdates(true), UpdateCheckInterval)\n    this.checkForUpdates(true)\n\n    log.info(`launching: ${getVersion()} (${getOS()})`)\n    log.info(`execPath: '${process.execPath}'`)\n  }\n\n  private onMenuEvent(name: MenuEvent): any {\n    // Don't react to menu events when an error dialog is shown.\n    if (this.state.errors.length) {\n      return\n    }\n\n    switch (name) {\n      case 'push':\n        return this.push()\n      case 'pull':\n        return this.pull()\n      case 'show-changes':\n        return this.showChanges()\n      case 'show-history':\n        return this.showHistory()\n      case 'choose-repository':\n        return this.chooseRepository()\n      case 'add-local-repository':\n        return this.showAddLocalRepo()\n      case 'create-branch':\n        return this.showCreateBranch()\n      case 'show-branches':\n        return this.showBranches()\n      case 'remove-repository':\n        return this.removeRepository(this.getRepository())\n      case 'create-repository':\n        return this.showCreateRepository()\n      case 'rename-branch':\n        return this.renameBranch()\n      case 'delete-branch':\n        return this.deleteBranch()\n      case 'show-preferences':\n        return this.props.dispatcher.showPopup({ type: PopupType.Preferences })\n      case 'open-working-directory':\n        return this.openCurrentRepositoryWorkingDirectory()\n      case 'update-branch': {\n        this.props.dispatcher.recordMenuInitiatedUpdate()\n        return this.updateBranch()\n      }\n      case 'compare-to-branch': {\n        return this.showHistory(true)\n      }\n      case 'merge-branch': {\n        this.props.dispatcher.recordMenuInitiatedMerge()\n        return this.mergeBranch()\n      }\n      case 'show-repository-settings':\n        return this.showRepositorySettings()\n      case 'view-repository-on-github':\n        return this.viewRepositoryOnGitHub()\n      case 'compare-on-github':\n        return this.compareBranchOnDotcom()\n      case 'open-in-shell':\n        return this.openCurrentRepositoryInShell()\n      case 'clone-repository':\n        return this.showCloneRepo()\n      case 'show-about':\n        return this.showAbout()\n      case 'boomtown':\n        return this.boomtown()\n      case 'open-pull-request': {\n        return this.openPullRequest()\n      }\n      case 'install-cli':\n        return this.props.dispatcher.installCLI()\n      case 'open-external-editor':\n        return this.openCurrentRepositoryInExternalEditor()\n      case 'select-all':\n        return this.selectAll()\n    }\n\n    return assertNever(name, `Unknown menu event name: ${name}`)\n  }\n\n  /**\n   * Handler for the 'select-all' menu event, dispatches\n   * a custom DOM event originating from the element which\n   * currently has keyboard focus. Components have a chance\n   * to intercept this event and implement their own 'select\n   * all' logic.\n   */\n  private selectAll() {\n    const event = new CustomEvent('select-all', {\n      bubbles: true,\n      cancelable: true,\n    })\n\n    if (\n      document.activeElement != null &&\n      document.activeElement.dispatchEvent(event)\n    ) {\n      remote.getCurrentWebContents().selectAll()\n    }\n  }\n\n  private boomtown() {\n    setImmediate(() => {\n      throw new Error('Boomtown!')\n    })\n  }\n\n  private checkForUpdates(inBackground: boolean) {\n    if (__LINUX__) {\n      return\n    }\n\n    if (\n      __RELEASE_CHANNEL__ === 'development' ||\n      __RELEASE_CHANNEL__ === 'test'\n    ) {\n      return\n    }\n\n    updateStore.checkForUpdates(inBackground)\n  }\n\n  private getDotComAccount(): Account | null {\n    const state = this.props.appStore.getState()\n    const accounts = state.accounts\n    const dotComAccount = accounts.find(\n      a => a.endpoint === getDotComAPIEndpoint()\n    )\n    return dotComAccount || null\n  }\n\n  private getEnterpriseAccount(): Account | null {\n    const state = this.props.appStore.getState()\n    const accounts = state.accounts\n    const enterpriseAccount = accounts.find(\n      a => a.endpoint !== getDotComAPIEndpoint()\n    )\n    return enterpriseAccount || null\n  }\n\n  private updateBranch() {\n    const { selectedState } = this.state\n    if (\n      selectedState == null ||\n      selectedState.type !== SelectionType.Repository\n    ) {\n      return\n    }\n\n    const { state } = selectedState\n    const defaultBranch = state.branchesState.defaultBranch\n    if (!defaultBranch) {\n      return\n    }\n\n    const { mergeStatus } = state.compareState\n    this.props.dispatcher.mergeBranch(\n      selectedState.repository,\n      defaultBranch.name,\n      mergeStatus\n    )\n  }\n\n  private mergeBranch() {\n    const state = this.state.selectedState\n    if (state == null || state.type !== SelectionType.Repository) {\n      return\n    }\n\n    this.props.dispatcher.showPopup({\n      type: PopupType.MergeBranch,\n      repository: state.repository,\n    })\n  }\n\n  private compareBranchOnDotcom() {\n    const htmlURL = this.getCurrentRepositoryGitHubURL()\n    if (!htmlURL) {\n      return\n    }\n\n    const state = this.state.selectedState\n    if (state == null || state.type !== SelectionType.Repository) {\n      return\n    }\n\n    const branchTip = state.state.branchesState.tip\n    if (\n      branchTip.kind !== TipState.Valid ||\n      !branchTip.branch.upstreamWithoutRemote\n    ) {\n      return\n    }\n\n    const compareURL = `${htmlURL}/compare/${\n      branchTip.branch.upstreamWithoutRemote\n    }`\n    this.props.dispatcher.openInBrowser(compareURL)\n  }\n\n  private openCurrentRepositoryWorkingDirectory() {\n    const state = this.state.selectedState\n    if (state == null || state.type !== SelectionType.Repository) {\n      return\n    }\n\n    this.showRepository(state.repository)\n  }\n\n  private renameBranch() {\n    const state = this.state.selectedState\n    if (state == null || state.type !== SelectionType.Repository) {\n      return\n    }\n\n    const tip = state.state.branchesState.tip\n    if (tip.kind === TipState.Valid) {\n      this.props.dispatcher.showPopup({\n        type: PopupType.RenameBranch,\n        repository: state.repository,\n        branch: tip.branch,\n      })\n    }\n  }\n\n  private deleteBranch() {\n    const state = this.state.selectedState\n    if (state === null || state.type !== SelectionType.Repository) {\n      return\n    }\n\n    const tip = state.state.branchesState.tip\n\n    if (tip.kind === TipState.Valid) {\n      const currentPullRequest = state.state.branchesState.currentPullRequest\n      if (currentPullRequest !== null) {\n        this.props.dispatcher.showPopup({\n          type: PopupType.DeletePullRequest,\n          repository: state.repository,\n          branch: tip.branch,\n          pullRequest: currentPullRequest,\n        })\n      } else {\n        const existsOnRemote = state.state.aheadBehind !== null\n\n        this.props.dispatcher.showPopup({\n          type: PopupType.DeleteBranch,\n          repository: state.repository,\n          branch: tip.branch,\n          existsOnRemote: existsOnRemote,\n        })\n      }\n    }\n  }\n\n  private showAddLocalRepo = () => {\n    return this.props.dispatcher.showPopup({ type: PopupType.AddRepository })\n  }\n\n  private showCreateRepository = () => {\n    this.props.dispatcher.showPopup({\n      type: PopupType.CreateRepository,\n    })\n  }\n\n  private showCloneRepo = () => {\n    return this.props.dispatcher.showPopup({\n      type: PopupType.CloneRepository,\n      initialURL: null,\n    })\n  }\n\n  private showAbout() {\n    this.props.dispatcher.showPopup({ type: PopupType.About })\n  }\n\n  private async showHistory(showBranchList: boolean = false) {\n    const state = this.state.selectedState\n    if (state == null || state.type !== SelectionType.Repository) {\n      return\n    }\n\n    await this.props.dispatcher.closeCurrentFoldout()\n\n    await this.props.dispatcher.initializeCompare(state.repository, {\n      kind: CompareActionKind.History,\n    })\n\n    await this.props.dispatcher.changeRepositorySection(\n      state.repository,\n      RepositorySectionTab.History\n    )\n\n    await this.props.dispatcher.updateCompareForm(state.repository, {\n      filterText: '',\n      showBranchList,\n    })\n  }\n\n  private showChanges() {\n    const state = this.state.selectedState\n    if (state == null || state.type !== SelectionType.Repository) {\n      return\n    }\n\n    this.props.dispatcher.closeCurrentFoldout()\n    this.props.dispatcher.changeRepositorySection(\n      state.repository,\n      RepositorySectionTab.Changes\n    )\n  }\n\n  private chooseRepository() {\n    if (\n      this.state.currentFoldout &&\n      this.state.currentFoldout.type === FoldoutType.Repository\n    ) {\n      return this.props.dispatcher.closeFoldout(FoldoutType.Repository)\n    }\n\n    return this.props.dispatcher.showFoldout({\n      type: FoldoutType.Repository,\n    })\n  }\n\n  private showBranches() {\n    const state = this.state.selectedState\n    if (state == null || state.type !== SelectionType.Repository) {\n      return\n    }\n\n    if (\n      this.state.currentFoldout &&\n      this.state.currentFoldout.type === FoldoutType.Branch\n    ) {\n      return this.props.dispatcher.closeFoldout(FoldoutType.Branch)\n    }\n\n    return this.props.dispatcher.showFoldout({ type: FoldoutType.Branch })\n  }\n\n  private push() {\n    const state = this.state.selectedState\n    if (state == null || state.type !== SelectionType.Repository) {\n      return\n    }\n\n    this.props.dispatcher.push(state.repository)\n  }\n\n  private async pull() {\n    const state = this.state.selectedState\n    if (state == null || state.type !== SelectionType.Repository) {\n      return\n    }\n\n    this.props.dispatcher.pull(state.repository)\n  }\n\n  public componentDidMount() {\n    document.ondragover = e => {\n      if (e.dataTransfer != null) {\n        if (this.isShowingModal) {\n          e.dataTransfer.dropEffect = 'none'\n        } else {\n          e.dataTransfer.dropEffect = 'copy'\n        }\n      }\n\n      e.preventDefault()\n    }\n\n    document.ondrop = e => {\n      e.preventDefault()\n    }\n\n    document.body.ondrop = e => {\n      if (this.isShowingModal) {\n        return\n      }\n      if (e.dataTransfer != null) {\n        const files = e.dataTransfer.files\n        this.handleDragAndDrop(files)\n      }\n      e.preventDefault()\n    }\n\n    if (shouldRenderApplicationMenu()) {\n      window.addEventListener('keydown', this.onWindowKeyDown)\n      window.addEventListener('keyup', this.onWindowKeyUp)\n    }\n  }\n\n  /**\n   * On Windows pressing the Alt key and holding it down should\n   * highlight the application menu.\n   *\n   * This method in conjunction with the onWindowKeyUp sets the\n   * appMenuToolbarHighlight state when the Alt key (and only the\n   * Alt key) is pressed.\n   */\n  private onWindowKeyDown = (event: KeyboardEvent) => {\n    if (event.defaultPrevented) {\n      return\n    }\n\n    if (this.isShowingModal) {\n      return\n    }\n\n    if (shouldRenderApplicationMenu()) {\n      if (event.key === 'Alt') {\n        // Immediately close the menu if open and the user hits Alt. This is\n        // a Windows convention.\n        if (\n          this.state.currentFoldout &&\n          this.state.currentFoldout.type === FoldoutType.AppMenu\n        ) {\n          // Only close it the menu when the key is pressed if there's an open\n          // menu. If there isn't we should close it when the key is released\n          // instead and that's taken care of in the onWindowKeyUp function.\n          if (this.state.appMenuState.length > 1) {\n            this.props.dispatcher.setAppMenuState(menu => menu.withReset())\n            this.props.dispatcher.closeFoldout(FoldoutType.AppMenu)\n          }\n        }\n\n        this.props.dispatcher.setAccessKeyHighlightState(true)\n      } else if (event.altKey && !event.ctrlKey && !event.metaKey) {\n        if (this.state.appMenuState.length) {\n          const candidates = this.state.appMenuState[0].items\n          const menuItemForAccessKey = findItemByAccessKey(\n            event.key,\n            candidates\n          )\n\n          if (menuItemForAccessKey && itemIsSelectable(menuItemForAccessKey)) {\n            if (menuItemForAccessKey.type === 'submenuItem') {\n              this.props.dispatcher.setAppMenuState(menu =>\n                menu\n                  .withReset()\n                  .withSelectedItem(menuItemForAccessKey)\n                  .withOpenedMenu(menuItemForAccessKey, true)\n              )\n\n              this.props.dispatcher.showFoldout({\n                type: FoldoutType.AppMenu,\n                enableAccessKeyNavigation: true,\n                openedWithAccessKey: true,\n              })\n            } else {\n              this.props.dispatcher.executeMenuItem(menuItemForAccessKey)\n            }\n\n            event.preventDefault()\n          }\n        }\n      } else if (!event.altKey) {\n        this.props.dispatcher.setAccessKeyHighlightState(false)\n      }\n    }\n\n    this.lastKeyPressed = event.key\n  }\n\n  /**\n   * Open the application menu foldout when the Alt key is pressed.\n   *\n   * See onWindowKeyDown for more information.\n   */\n  private onWindowKeyUp = (event: KeyboardEvent) => {\n    if (event.defaultPrevented) {\n      return\n    }\n\n    if (shouldRenderApplicationMenu()) {\n      if (event.key === 'Alt') {\n        this.props.dispatcher.setAccessKeyHighlightState(false)\n\n        if (this.lastKeyPressed === 'Alt') {\n          if (\n            this.state.currentFoldout &&\n            this.state.currentFoldout.type === FoldoutType.AppMenu\n          ) {\n            this.props.dispatcher.setAppMenuState(menu => menu.withReset())\n            this.props.dispatcher.closeFoldout(FoldoutType.AppMenu)\n          } else {\n            this.props.dispatcher.showFoldout({\n              type: FoldoutType.AppMenu,\n              enableAccessKeyNavigation: true,\n              openedWithAccessKey: false,\n            })\n          }\n        }\n      }\n    }\n  }\n\n  private async handleDragAndDrop(fileList: FileList) {\n    const paths: string[] = []\n    for (let i = 0; i < fileList.length; i++) {\n      const file = fileList[i]\n      paths.push(file.path)\n    }\n\n    // If they're bulk adding repositories then just blindly try to add them.\n    // But if they just dragged one, use the dialog so that they can initialize\n    // it if needed.\n    if (paths.length > 1) {\n      const addedRepositories = await this.addRepositories(paths)\n      if (addedRepositories.length) {\n        this.props.dispatcher.recordAddExistingRepository()\n      }\n    } else {\n      // user may accidentally provide a folder within the repository\n      // this ensures we use the repository root, if it is actually a repository\n      // otherwise we consider it an untracked repository\n      const first = paths[0]\n      const path = (await validatedRepositoryPath(first)) || first\n\n      const existingRepository = matchExistingRepository(\n        this.state.repositories,\n        path\n      )\n\n      if (existingRepository) {\n        await this.props.dispatcher.selectRepository(existingRepository)\n      } else {\n        await this.showPopup({\n          type: PopupType.AddRepository,\n          path,\n        })\n      }\n    }\n  }\n\n  private removeRepository = (\n    repository: Repository | CloningRepository | null\n  ) => {\n    if (!repository) {\n      return\n    }\n\n    if (repository instanceof CloningRepository || repository.missing) {\n      this.props.dispatcher.removeRepositories([repository], false)\n      return\n    }\n\n    if (this.state.askForConfirmationOnRepositoryRemoval) {\n      this.props.dispatcher.showPopup({\n        type: PopupType.RemoveRepository,\n        repository,\n      })\n    } else {\n      this.props.dispatcher.removeRepositories([repository], false)\n    }\n  }\n\n  private onConfirmRepoRemoval = (\n    repository: Repository,\n    deleteRepoFromDisk: boolean\n  ) => {\n    this.props.dispatcher.removeRepositories([repository], deleteRepoFromDisk)\n  }\n\n  private getRepository(): Repository | CloningRepository | null {\n    const state = this.state.selectedState\n    if (state == null) {\n      return null\n    }\n\n    return state.repository\n  }\n\n  private async addRepositories(paths: ReadonlyArray<string>) {\n    const repositories = await this.props.dispatcher.addRepositories(paths)\n    if (repositories.length) {\n      this.props.dispatcher.selectRepository(repositories[0])\n    }\n\n    return repositories\n  }\n\n  private showRepositorySettings() {\n    const repository = this.getRepository()\n\n    if (!repository || repository instanceof CloningRepository) {\n      return\n    }\n    this.props.dispatcher.showPopup({\n      type: PopupType.RepositorySettings,\n      repository,\n    })\n  }\n\n  private viewRepositoryOnGitHub() {\n    const url = this.getCurrentRepositoryGitHubURL()\n\n    if (url) {\n      this.props.dispatcher.openInBrowser(url)\n      return\n    }\n  }\n\n  /** Returns the URL to the current repository if hosted on GitHub */\n  private getCurrentRepositoryGitHubURL() {\n    const repository = this.getRepository()\n\n    if (\n      !repository ||\n      repository instanceof CloningRepository ||\n      !repository.gitHubRepository\n    ) {\n      return null\n    }\n\n    return repository.gitHubRepository.htmlURL\n  }\n\n  private openCurrentRepositoryInShell() {\n    const repository = this.getRepository()\n    if (!repository) {\n      return\n    }\n\n    this.openInShell(repository)\n  }\n\n  private openCurrentRepositoryInExternalEditor() {\n    const repository = this.getRepository()\n    if (!repository) {\n      return\n    }\n\n    this.openInExternalEditor(repository)\n  }\n\n  /**\n   * Conditionally renders a menu bar. The menu bar is currently only rendered\n   * on Windows.\n   */\n  private renderAppMenuBar() {\n    // We only render the app menu bar on Windows\n    if (!__WIN32__) {\n      return null\n    }\n\n    // Have we received an app menu from the main process yet?\n    if (!this.state.appMenuState.length) {\n      return null\n    }\n\n    // Don't render the menu bar during the welcome flow\n    if (this.state.showWelcomeFlow) {\n      return null\n    }\n\n    const currentFoldout = this.state.currentFoldout\n\n    // AppMenuBar requires us to pass a strongly typed AppMenuFoldout state or\n    // null if the AppMenu foldout is not currently active.\n    const foldoutState =\n      currentFoldout && currentFoldout.type === FoldoutType.AppMenu\n        ? currentFoldout\n        : null\n\n    return (\n      <AppMenuBar\n        appMenu={this.state.appMenuState}\n        dispatcher={this.props.dispatcher}\n        highlightAppMenuAccessKeys={this.state.highlightAccessKeys}\n        foldoutState={foldoutState}\n        onLostFocus={this.onMenuBarLostFocus}\n      />\n    )\n  }\n\n  private onMenuBarLostFocus = () => {\n    // Note: This event is emitted in an animation frame separate from\n    // that of the AppStore. See onLostFocusWithin inside of the AppMenuBar\n    // for more details. This means that it's possible that the current\n    // app state in this component's state might be out of date so take\n    // caution when considering app state in this method.\n    this.props.dispatcher.closeFoldout(FoldoutType.AppMenu)\n    this.props.dispatcher.setAppMenuState(menu => menu.withReset())\n  }\n\n  private renderTitlebar() {\n    const inFullScreen = this.state.windowState === 'full-screen'\n\n    const menuBarActive =\n      this.state.currentFoldout &&\n      this.state.currentFoldout.type === FoldoutType.AppMenu\n\n    // When we're in full-screen mode on Windows we only need to render\n    // the title bar when the menu bar is active. On other platforms we\n    // never render the title bar while in full-screen mode.\n    if (inFullScreen) {\n      if (!__WIN32__ || !menuBarActive) {\n        return null\n      }\n    }\n\n    const showAppIcon = __WIN32__ && !this.state.showWelcomeFlow\n\n    return (\n      <TitleBar\n        showAppIcon={showAppIcon}\n        titleBarStyle={this.state.titleBarStyle}\n        windowState={this.state.windowState}\n        windowZoomFactor={this.state.windowZoomFactor}\n      >\n        {this.renderAppMenuBar()}\n      </TitleBar>\n    )\n  }\n\n  private onPopupDismissed = () => this.props.dispatcher.closePopup()\n\n  private onSignInDialogDismissed = () => {\n    this.props.dispatcher.resetSignInState()\n    this.onPopupDismissed()\n  }\n\n  private onContinueWithUntrustedCertificate = (\n    certificate: Electron.Certificate\n  ) => {\n    this.props.dispatcher.closePopup()\n    showCertificateTrustDialog(\n      certificate,\n      'Could not securely connect to the server, because its certificate is not trusted. Attackers might be trying to steal your information.\\n\\nTo connect unsafely, which may put your data at risk, you can Always trust the certificate and try again.'\n    )\n  }\n\n  private onUpdateAvailableDismissed = () =>\n    this.props.dispatcher.setUpdateBannerVisibility(false)\n\n  private currentPopupContent(): JSX.Element | null {\n    // Hide any dialogs while we're displaying an error\n    if (this.state.errors.length) {\n      return null\n    }\n\n    const popup = this.state.currentPopup\n\n    if (!popup) {\n      return null\n    }\n\n    switch (popup.type) {\n      case PopupType.RenameBranch:\n        return (\n          <RenameBranch\n            key=\"rename-branch\"\n            dispatcher={this.props.dispatcher}\n            repository={popup.repository}\n            branch={popup.branch}\n          />\n        )\n      case PopupType.DeleteBranch:\n        return (\n          <DeleteBranch\n            key=\"delete-branch\"\n            dispatcher={this.props.dispatcher}\n            repository={popup.repository}\n            branch={popup.branch}\n            existsOnRemote={popup.existsOnRemote}\n            onDismissed={this.onPopupDismissed}\n            onDeleted={this.onBranchDeleted}\n          />\n        )\n      case PopupType.ConfirmDiscardChanges:\n        const showSetting =\n          popup.showDiscardChangesSetting === undefined\n            ? true\n            : popup.showDiscardChangesSetting\n        const discardingAllChanges =\n          popup.discardingAllChanges === undefined\n            ? false\n            : popup.discardingAllChanges\n\n        return (\n          <DiscardChanges\n            key=\"discard-changes\"\n            repository={popup.repository}\n            dispatcher={this.props.dispatcher}\n            files={popup.files}\n            confirmDiscardChanges={\n              this.state.askForConfirmationOnDiscardChanges\n            }\n            showDiscardChangesSetting={showSetting}\n            discardingAllChanges={discardingAllChanges}\n            onDismissed={this.onPopupDismissed}\n            onConfirmDiscardChangesChanged={this.onConfirmDiscardChangesChanged}\n          />\n        )\n      case PopupType.Preferences:\n        return (\n          <Preferences\n            key=\"preferences\"\n            initialSelectedTab={popup.initialSelectedTab}\n            dispatcher={this.props.dispatcher}\n            dotComAccount={this.getDotComAccount()}\n            confirmRepositoryRemoval={\n              this.state.askForConfirmationOnRepositoryRemoval\n            }\n            confirmDiscardChanges={\n              this.state.askForConfirmationOnDiscardChanges\n            }\n            selectedExternalEditor={this.state.selectedExternalEditor}\n            optOutOfUsageTracking={this.props.appStore.getStatsOptOut()}\n            enterpriseAccount={this.getEnterpriseAccount()}\n            onDismissed={this.onPopupDismissed}\n            selectedShell={this.state.selectedShell}\n            selectedTheme={this.state.selectedTheme}\n          />\n        )\n      case PopupType.MergeBranch: {\n        const { repository, branch } = popup\n        const state = this.props.repositoryStateManager.get(repository)\n\n        const tip = state.branchesState.tip\n        const currentBranch = tip.kind === TipState.Valid ? tip.branch : null\n\n        return (\n          <Merge\n            key=\"merge-branch\"\n            dispatcher={this.props.dispatcher}\n            repository={repository}\n            allBranches={state.branchesState.allBranches}\n            defaultBranch={state.branchesState.defaultBranch}\n            recentBranches={state.branchesState.recentBranches}\n            currentBranch={currentBranch}\n            initialBranch={branch}\n            onDismissed={this.onPopupDismissed}\n          />\n        )\n      }\n      case PopupType.RepositorySettings: {\n        const repository = popup.repository\n        const state = this.props.repositoryStateManager.get(repository)\n\n        return (\n          <RepositorySettings\n            key=\"repository-settings\"\n            remote={state.remote}\n            dispatcher={this.props.dispatcher}\n            repository={repository}\n            onDismissed={this.onPopupDismissed}\n          />\n        )\n      }\n      case PopupType.SignIn:\n        return (\n          <SignIn\n            key=\"sign-in\"\n            signInState={this.state.signInState}\n            dispatcher={this.props.dispatcher}\n            onDismissed={this.onSignInDialogDismissed}\n          />\n        )\n      case PopupType.AddRepository:\n        return (\n          <AddExistingRepository\n            key=\"add-existing-repository\"\n            onDismissed={this.onPopupDismissed}\n            dispatcher={this.props.dispatcher}\n            path={popup.path}\n          />\n        )\n      case PopupType.CreateRepository:\n        return (\n          <CreateRepository\n            key=\"create-repository\"\n            onDismissed={this.onPopupDismissed}\n            dispatcher={this.props.dispatcher}\n            initialPath={popup.path}\n          />\n        )\n      case PopupType.CloneRepository:\n        return (\n          <CloneRepository\n            key=\"clone-repository\"\n            dotComAccount={this.getDotComAccount()}\n            enterpriseAccount={this.getEnterpriseAccount()}\n            initialURL={popup.initialURL}\n            onDismissed={this.onPopupDismissed}\n            dispatcher={this.props.dispatcher}\n            selectedTab={this.state.selectedCloneRepositoryTab}\n            onTabSelected={this.onCloneRepositoriesTabSelected}\n          />\n        )\n      case PopupType.CreateBranch: {\n        const state = this.props.repositoryStateManager.get(popup.repository)\n        const branchesState = state.branchesState\n        const repository = popup.repository\n\n        if (branchesState.tip.kind === TipState.Unknown) {\n          this.props.dispatcher.closePopup()\n          return null\n        }\n\n        return (\n          <CreateBranch\n            key=\"create-branch\"\n            tip={branchesState.tip}\n            defaultBranch={branchesState.defaultBranch}\n            allBranches={branchesState.allBranches}\n            repository={repository}\n            onDismissed={this.onPopupDismissed}\n            dispatcher={this.props.dispatcher}\n            initialName={popup.initialName || ''}\n          />\n        )\n      }\n      case PopupType.InstallGit:\n        return (\n          <InstallGit\n            key=\"install-git\"\n            onDismissed={this.onPopupDismissed}\n            onOpenShell={this.onOpenShellIgnoreWarning}\n            path={popup.path}\n          />\n        )\n      case PopupType.About:\n        return (\n          <About\n            key=\"about\"\n            onDismissed={this.onPopupDismissed}\n            applicationName={getName()}\n            applicationVersion={getVersion()}\n            onCheckForUpdates={this.onCheckForUpdates}\n            onShowAcknowledgements={this.showAcknowledgements}\n            onShowTermsAndConditions={this.showTermsAndConditions}\n          />\n        )\n      case PopupType.PublishRepository:\n        return (\n          <Publish\n            key=\"publish\"\n            dispatcher={this.props.dispatcher}\n            repository={popup.repository}\n            accounts={this.state.accounts}\n            onDismissed={this.onPopupDismissed}\n          />\n        )\n      case PopupType.UntrustedCertificate:\n        return (\n          <UntrustedCertificate\n            key=\"untrusted-certificate\"\n            certificate={popup.certificate}\n            url={popup.url}\n            onDismissed={this.onPopupDismissed}\n            onContinue={this.onContinueWithUntrustedCertificate}\n          />\n        )\n      case PopupType.Acknowledgements:\n        return (\n          <Acknowledgements\n            key=\"acknowledgements\"\n            onDismissed={this.onPopupDismissed}\n            applicationVersion={getVersion()}\n          />\n        )\n      case PopupType.RemoveRepository:\n        return (\n          <ConfirmRemoveRepository\n            repository={popup.repository}\n            onConfirmation={this.onConfirmRepoRemoval}\n            onDismissed={this.onPopupDismissed}\n          />\n        )\n      case PopupType.TermsAndConditions:\n        return <TermsAndConditions onDismissed={this.onPopupDismissed} />\n      case PopupType.PushBranchCommits:\n        return (\n          <PushBranchCommits\n            dispatcher={this.props.dispatcher}\n            repository={popup.repository}\n            branch={popup.branch}\n            unPushedCommits={popup.unPushedCommits}\n            onConfirm={this.openCreatePullRequestInBrowser}\n            onDismissed={this.onPopupDismissed}\n          />\n        )\n      case PopupType.CLIInstalled:\n        return <CLIInstalled onDismissed={this.onPopupDismissed} />\n      case PopupType.GenericGitAuthentication:\n        return (\n          <GenericGitAuthentication\n            hostname={popup.hostname}\n            onDismiss={this.onPopupDismissed}\n            onSave={this.onSaveCredentials}\n            retryAction={popup.retryAction}\n          />\n        )\n      case PopupType.ExternalEditorFailed:\n        const openPreferences = popup.openPreferences\n        const suggestAtom = popup.suggestAtom\n\n        return (\n          <EditorError\n            key=\"editor-error\"\n            message={popup.message}\n            onDismissed={this.onPopupDismissed}\n            showPreferencesDialog={this.onShowAdvancedPreferences}\n            viewPreferences={openPreferences}\n            suggestAtom={suggestAtom}\n          />\n        )\n      case PopupType.OpenShellFailed:\n        return (\n          <ShellError\n            key=\"shell-error\"\n            message={popup.message}\n            onDismissed={this.onPopupDismissed}\n            showPreferencesDialog={this.onShowAdvancedPreferences}\n          />\n        )\n      case PopupType.InitializeLFS:\n        return (\n          <InitializeLFS\n            repositories={popup.repositories}\n            onDismissed={this.onPopupDismissed}\n            onInitialize={this.initializeLFS}\n          />\n        )\n      case PopupType.LFSAttributeMismatch:\n        return (\n          <AttributeMismatch\n            onDismissed={this.onPopupDismissed}\n            onUpdateExistingFilters={this.updateExistingLFSFilters}\n          />\n        )\n      case PopupType.UpstreamAlreadyExists:\n        return (\n          <UpstreamAlreadyExists\n            repository={popup.repository}\n            existingRemote={popup.existingRemote}\n            onDismissed={this.onPopupDismissed}\n            onUpdate={this.onUpdateExistingUpstreamRemote}\n            onIgnore={this.onIgnoreExistingUpstreamRemote}\n          />\n        )\n      case PopupType.ReleaseNotes:\n        return (\n          <ReleaseNotes\n            emoji={this.state.emoji}\n            newRelease={popup.newRelease}\n            onDismissed={this.onPopupDismissed}\n          />\n        )\n      case PopupType.DeletePullRequest:\n        return (\n          <DeletePullRequest\n            dispatcher={this.props.dispatcher}\n            repository={popup.repository}\n            branch={popup.branch}\n            onDismissed={this.onPopupDismissed}\n            pullRequest={popup.pullRequest}\n          />\n        )\n      case PopupType.MergeConflicts:\n        return (\n          <MergeConflictsWarning\n            dispatcher={this.props.dispatcher}\n            repository={popup.repository}\n            onDismissed={this.onPopupDismissed}\n          />\n        )\n      default:\n        return assertNever(popup, `Unknown popup type: ${popup}`)\n    }\n  }\n\n  private onUpdateExistingUpstreamRemote = (repository: Repository) => {\n    this.props.dispatcher.updateExistingUpstreamRemote(repository)\n  }\n\n  private onIgnoreExistingUpstreamRemote = (repository: Repository) => {\n    this.props.dispatcher.ignoreExistingUpstreamRemote(repository)\n  }\n\n  private updateExistingLFSFilters = () => {\n    this.props.dispatcher.installGlobalLFSFilters(true)\n    this.onPopupDismissed()\n  }\n\n  private initializeLFS = (repositories: ReadonlyArray<Repository>) => {\n    this.props.dispatcher.installLFSHooks(repositories)\n    this.onPopupDismissed()\n  }\n\n  private onCloneRepositoriesTabSelected = (tab: CloneRepositoryTab) => {\n    this.props.dispatcher.changeCloneRepositoriesTab(tab)\n  }\n\n  private onShowAdvancedPreferences = () => {\n    this.props.dispatcher.showPopup({\n      type: PopupType.Preferences,\n      initialSelectedTab: PreferencesTab.Advanced,\n    })\n  }\n\n  private onOpenShellIgnoreWarning = (path: string) => {\n    this.props.dispatcher.openShell(path, true)\n    this.onPopupDismissed()\n  }\n\n  private onSaveCredentials = async (\n    hostname: string,\n    username: string,\n    password: string,\n    retryAction: RetryAction\n  ) => {\n    this.onPopupDismissed()\n\n    await this.props.dispatcher.saveGenericGitCredentials(\n      hostname,\n      username,\n      password\n    )\n\n    this.props.dispatcher.performRetry(retryAction)\n  }\n\n  private onCheckForUpdates = () => this.checkForUpdates(false)\n\n  private showAcknowledgements = () => {\n    this.props.dispatcher.showPopup({ type: PopupType.Acknowledgements })\n  }\n\n  private showTermsAndConditions = () => {\n    this.props.dispatcher.showPopup({ type: PopupType.TermsAndConditions })\n  }\n\n  private renderPopup() {\n    return (\n      <CSSTransitionGroup\n        transitionName=\"modal\"\n        component=\"div\"\n        transitionEnterTimeout={dialogTransitionEnterTimeout}\n        transitionLeaveTimeout={dialogTransitionLeaveTimeout}\n      >\n        {this.currentPopupContent()}\n      </CSSTransitionGroup>\n    )\n  }\n\n  private renderZoomInfo() {\n    return <ZoomInfo windowZoomFactor={this.state.windowZoomFactor} />\n  }\n\n  private renderFullScreenInfo() {\n    return <FullScreenInfo windowState={this.state.windowState} />\n  }\n\n  private clearError = (error: Error) => this.props.dispatcher.clearError(error)\n\n  private onConfirmDiscardChangesChanged = (value: boolean) => {\n    this.props.dispatcher.setConfirmDiscardChangesSetting(value)\n  }\n\n  private renderAppError() {\n    return (\n      <AppError\n        errors={this.state.errors}\n        onClearError={this.clearError}\n        onShowPopup={this.showPopup}\n      />\n    )\n  }\n\n  private showPopup = (popup: Popup) => {\n    this.props.dispatcher.showPopup(popup)\n  }\n\n  private renderApp() {\n    return (\n      <div id=\"desktop-app-contents\">\n        {this.renderToolbar()}\n        {this.renderUpdateBanner()}\n        {this.renderRepository()}\n        {this.renderPopup()}\n        {this.renderAppError()}\n      </div>\n    )\n  }\n\n  private renderRepositoryList = (): JSX.Element => {\n    const selectedRepository = this.state.selectedState\n      ? this.state.selectedState.repository\n      : null\n    const externalEditorLabel = this.state.selectedExternalEditor\n    const shellLabel = this.state.selectedShell\n    const filterText = this.state.repositoryFilterText\n    return (\n      <RepositoriesList\n        filterText={filterText}\n        onFilterTextChanged={this.onRepositoryFilterTextChanged}\n        selectedRepository={selectedRepository}\n        onSelectionChanged={this.onSelectionChanged}\n        repositories={this.state.repositories}\n        localRepositoryStateLookup={this.state.localRepositoryStateLookup}\n        askForConfirmationOnRemoveRepository={\n          this.state.askForConfirmationOnRepositoryRemoval\n        }\n        onRemoveRepository={this.removeRepository}\n        onOpenInShell={this.openInShell}\n        onShowRepository={this.showRepository}\n        onOpenInExternalEditor={this.openInExternalEditor}\n        externalEditorLabel={externalEditorLabel}\n        shellLabel={shellLabel}\n        dispatcher={this.props.dispatcher}\n      />\n    )\n  }\n\n  private openInShell = (repository: Repository | CloningRepository) => {\n    if (!(repository instanceof Repository)) {\n      return\n    }\n\n    this.props.dispatcher.openShell(repository.path)\n  }\n\n  private openFileInExternalEditor = (fullPath: string) => {\n    this.props.dispatcher.openInExternalEditor(fullPath)\n  }\n\n  private openInExternalEditor = (\n    repository: Repository | CloningRepository\n  ) => {\n    if (!(repository instanceof Repository)) {\n      return\n    }\n\n    this.props.dispatcher.openInExternalEditor(repository.path)\n  }\n\n  private showRepository = (repository: Repository | CloningRepository) => {\n    if (!(repository instanceof Repository)) {\n      return\n    }\n\n    shell.showItemInFolder(repository.path)\n  }\n\n  private onRepositoryDropdownStateChanged = (newState: DropdownState) => {\n    if (newState === 'open') {\n      this.props.dispatcher.showFoldout({ type: FoldoutType.Repository })\n    } else {\n      this.props.dispatcher.closeFoldout(FoldoutType.Repository)\n    }\n  }\n\n  private renderRepositoryToolbarButton() {\n    const selection = this.state.selectedState\n\n    const repository = selection ? selection.repository : null\n\n    let icon: OcticonSymbol\n    let title: string\n    if (repository) {\n      icon = iconForRepository(repository)\n      title = repository.name\n    } else if (this.state.repositories.length > 0) {\n      icon = OcticonSymbol.repo\n      title = __DARWIN__ ? 'Select a Repository' : 'Select a repository'\n    } else {\n      icon = OcticonSymbol.repo\n      title = __DARWIN__ ? 'No Repositories' : 'No repositories'\n    }\n\n    const isOpen =\n      this.state.currentFoldout &&\n      this.state.currentFoldout.type === FoldoutType.Repository\n\n    const currentState: DropdownState = isOpen ? 'open' : 'closed'\n\n    const tooltip = repository && !isOpen ? repository.path : undefined\n\n    const foldoutStyle: React.CSSProperties = {\n      position: 'absolute',\n      marginLeft: 0,\n      minWidth: this.state.sidebarWidth,\n      height: '100%',\n      top: 0,\n    }\n\n    return (\n      <ToolbarDropdown\n        icon={icon}\n        title={title}\n        description={__DARWIN__ ? 'Current Repository' : 'Current repository'}\n        tooltip={tooltip}\n        foldoutStyle={foldoutStyle}\n        onDropdownStateChanged={this.onRepositoryDropdownStateChanged}\n        dropdownContentRenderer={this.renderRepositoryList}\n        dropdownState={currentState}\n      />\n    )\n  }\n\n  private renderPushPullToolbarButton() {\n    const selection = this.state.selectedState\n    if (!selection || selection.type !== SelectionType.Repository) {\n      return null\n    }\n\n    const state = selection.state\n    const revertProgress = state.revertProgress\n    if (revertProgress) {\n      return <RevertProgress progress={revertProgress} />\n    }\n\n    const remoteName = state.remote ? state.remote.name : null\n    const progress = state.pushPullFetchProgress\n\n    const tipState = state.branchesState.tip.kind\n\n    return (\n      <PushPullButton\n        dispatcher={this.props.dispatcher}\n        repository={selection.repository}\n        aheadBehind={state.aheadBehind}\n        remoteName={remoteName}\n        lastFetched={state.lastFetched}\n        networkActionInProgress={state.isPushPullFetchInProgress}\n        progress={progress}\n        tipState={tipState}\n      />\n    )\n  }\n\n  private showCreateBranch = () => {\n    const selection = this.state.selectedState\n\n    // NB: This should never happen but in the case someone\n    // manages to delete the last repository while the drop down is\n    // open we'll just bail here.\n    if (!selection || selection.type !== SelectionType.Repository) {\n      return\n    }\n\n    // We explicitly disable the menu item in this scenario so this\n    // should never happen.\n    if (selection.state.branchesState.tip.kind === TipState.Unknown) {\n      return\n    }\n\n    const repository = selection.repository\n\n    return this.props.dispatcher.showPopup({\n      type: PopupType.CreateBranch,\n      repository,\n    })\n  }\n\n  private openPullRequest = () => {\n    const state = this.state.selectedState\n\n    if (state == null || state.type !== SelectionType.Repository) {\n      return\n    }\n\n    const currentPullRequest = state.state.branchesState.currentPullRequest\n    const dispatcher = this.props.dispatcher\n\n    if (currentPullRequest == null) {\n      dispatcher.createPullRequest(state.repository)\n    } else {\n      dispatcher.showPullRequest(state.repository)\n    }\n  }\n\n  private openCreatePullRequestInBrowser = (\n    repository: Repository,\n    branch: Branch\n  ) => {\n    this.props.dispatcher.openCreatePullRequestInBrowser(repository, branch)\n  }\n\n  private onBranchDropdownStateChanged = (newState: DropdownState) => {\n    if (newState === 'open') {\n      this.props.dispatcher.showFoldout({ type: FoldoutType.Branch })\n    } else {\n      this.props.dispatcher.closeFoldout(FoldoutType.Branch)\n    }\n  }\n\n  private renderBranchToolbarButton(): JSX.Element | null {\n    const selection = this.state.selectedState\n\n    if (selection == null || selection.type !== SelectionType.Repository) {\n      return null\n    }\n\n    const currentFoldout = this.state.currentFoldout\n    const isOpen =\n      !!currentFoldout && currentFoldout.type === FoldoutType.Branch\n\n    const repository = selection.repository\n    const branchesState = selection.state.branchesState\n\n    return (\n      <BranchDropdown\n        dispatcher={this.props.dispatcher}\n        isOpen={isOpen}\n        onDropDownStateChanged={this.onBranchDropdownStateChanged}\n        repository={repository}\n        repositoryState={selection.state}\n        selectedTab={this.state.selectedBranchesTab}\n        pullRequests={branchesState.openPullRequests}\n        currentPullRequest={branchesState.currentPullRequest}\n        isLoadingPullRequests={branchesState.isLoadingPullRequests}\n      />\n    )\n  }\n\n  private renderUpdateBanner() {\n    if (!this.state.isUpdateAvailableBannerVisible) {\n      return null\n    }\n    const releaseNotesUri = 'https://desktop.github.com/release-notes/'\n\n    return (\n      <UpdateAvailable\n        dispatcher={this.props.dispatcher}\n        newRelease={updateStore.state.newRelease}\n        releaseNotesLink={releaseNotesUri}\n        onDismissed={this.onUpdateAvailableDismissed}\n      />\n    )\n  }\n\n  private renderToolbar() {\n    return (\n      <Toolbar id=\"desktop-app-toolbar\">\n        <div\n          className=\"sidebar-section\"\n          style={{ width: this.state.sidebarWidth }}\n        >\n          {this.renderRepositoryToolbarButton()}\n        </div>\n        {this.renderBranchToolbarButton()}\n        {this.renderPushPullToolbarButton()}\n      </Toolbar>\n    )\n  }\n\n  private renderRepository() {\n    const state = this.state\n    if (state.repositories.length < 1) {\n      return (\n        <BlankSlateView\n          onCreate={this.showCreateRepository}\n          onClone={this.showCloneRepo}\n          onAdd={this.showAddLocalRepo}\n        />\n      )\n    }\n\n    const selectedState = state.selectedState\n    if (!selectedState) {\n      return <NoRepositorySelected />\n    }\n\n    if (selectedState.type === SelectionType.Repository) {\n      const externalEditorLabel = state.selectedExternalEditor\n\n      return (\n        <RepositoryView\n          repository={selectedState.repository}\n          state={selectedState.state}\n          dispatcher={this.props.dispatcher}\n          emoji={state.emoji}\n          sidebarWidth={state.sidebarWidth}\n          commitSummaryWidth={state.commitSummaryWidth}\n          issuesStore={this.props.issuesStore}\n          gitHubUserStore={this.props.gitHubUserStore}\n          onViewCommitOnGitHub={this.onViewCommitOnGitHub}\n          imageDiffType={state.imageDiffType}\n          askForConfirmationOnDiscardChanges={\n            state.askForConfirmationOnDiscardChanges\n          }\n          accounts={state.accounts}\n          externalEditorLabel={externalEditorLabel}\n          onOpenInExternalEditor={this.openFileInExternalEditor}\n        />\n      )\n    } else if (selectedState.type === SelectionType.CloningRepository) {\n      return (\n        <CloningRepositoryView\n          repository={selectedState.repository}\n          progress={selectedState.progress}\n        />\n      )\n    } else if (selectedState.type === SelectionType.MissingRepository) {\n      return (\n        <MissingRepository\n          repository={selectedState.repository}\n          dispatcher={this.props.dispatcher}\n        />\n      )\n    } else {\n      return assertNever(selectedState, `Unknown state: ${selectedState}`)\n    }\n  }\n\n  private renderWelcomeFlow() {\n    return (\n      <Welcome\n        dispatcher={this.props.dispatcher}\n        appStore={this.props.appStore}\n        signInState={this.state.signInState}\n      />\n    )\n  }\n\n  public render() {\n    if (this.loading) {\n      return null\n    }\n\n    const className = this.state.appIsFocused ? 'focused' : 'blurred'\n\n    const currentTheme = this.state.showWelcomeFlow\n      ? ApplicationTheme.Light\n      : this.state.selectedTheme\n\n    return (\n      <div id=\"desktop-app-chrome\" className={className}>\n        <AppTheme theme={currentTheme} />\n        {this.renderTitlebar()}\n        {this.state.showWelcomeFlow\n          ? this.renderWelcomeFlow()\n          : this.renderApp()}\n        {this.renderZoomInfo()}\n        {this.renderFullScreenInfo()}\n      </div>\n    )\n  }\n\n  private onRepositoryFilterTextChanged = (text: string) => {\n    this.props.dispatcher.setRepositoryFilterText(text)\n  }\n\n  private onSelectionChanged = (repository: Repository | CloningRepository) => {\n    this.props.dispatcher.selectRepository(repository)\n    this.props.dispatcher.closeFoldout(FoldoutType.Repository)\n  }\n\n  private onViewCommitOnGitHub = async (SHA: string) => {\n    const repository = this.getRepository()\n\n    if (\n      !repository ||\n      repository instanceof CloningRepository ||\n      !repository.gitHubRepository\n    ) {\n      return\n    }\n\n    const baseURL = repository.gitHubRepository.htmlURL\n\n    if (baseURL) {\n      this.props.dispatcher.openInBrowser(`${baseURL}/commit/${SHA}`)\n    }\n  }\n\n  private onBranchDeleted = (repository: Repository) => {\n    // In the event a user is in the middle of a compare\n    // we need to exit out of the compare state after the\n    // branch has been deleted. Calling executeCompare allows\n    // us to do just that.\n    this.props.dispatcher.executeCompare(repository, {\n      kind: CompareActionKind.History,\n    })\n  }\n}\n\nfunction NoRepositorySelected() {\n  return <div className=\"panel blankslate\">No repository selected</div>\n}\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\n'use strict';\n\nvar emptyObject = {};\n\nif (process.env.NODE_ENV !== 'production') {\n  Object.freeze(emptyObject);\n}\n\nmodule.exports = emptyObject;","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nvar util = require('./util');\nvar has = Object.prototype.hasOwnProperty;\nvar hasNativeMap = typeof Map !== \"undefined\";\n\n/**\n * A data structure which is a combination of an array and a set. Adding a new\n * member is O(1), testing for membership is O(1), and finding the index of an\n * element is O(1). Removing elements from the set is not supported. Only\n * strings are supported for membership.\n */\nfunction ArraySet() {\n  this._array = [];\n  this._set = hasNativeMap ? new Map() : Object.create(null);\n}\n\n/**\n * Static method for creating ArraySet instances from an existing array.\n */\nArraySet.fromArray = function ArraySet_fromArray(aArray, aAllowDuplicates) {\n  var set = new ArraySet();\n  for (var i = 0, len = aArray.length; i < len; i++) {\n    set.add(aArray[i], aAllowDuplicates);\n  }\n  return set;\n};\n\n/**\n * Return how many unique items are in this ArraySet. If duplicates have been\n * added, than those do not count towards the size.\n *\n * @returns Number\n */\nArraySet.prototype.size = function ArraySet_size() {\n  return hasNativeMap ? this._set.size : Object.getOwnPropertyNames(this._set).length;\n};\n\n/**\n * Add the given string to this set.\n *\n * @param String aStr\n */\nArraySet.prototype.add = function ArraySet_add(aStr, aAllowDuplicates) {\n  var sStr = hasNativeMap ? aStr : util.toSetString(aStr);\n  var isDuplicate = hasNativeMap ? this.has(aStr) : has.call(this._set, sStr);\n  var idx = this._array.length;\n  if (!isDuplicate || aAllowDuplicates) {\n    this._array.push(aStr);\n  }\n  if (!isDuplicate) {\n    if (hasNativeMap) {\n      this._set.set(aStr, idx);\n    } else {\n      this._set[sStr] = idx;\n    }\n  }\n};\n\n/**\n * Is the given string a member of this set?\n *\n * @param String aStr\n */\nArraySet.prototype.has = function ArraySet_has(aStr) {\n  if (hasNativeMap) {\n    return this._set.has(aStr);\n  } else {\n    var sStr = util.toSetString(aStr);\n    return has.call(this._set, sStr);\n  }\n};\n\n/**\n * What is the index of the given string in the array?\n *\n * @param String aStr\n */\nArraySet.prototype.indexOf = function ArraySet_indexOf(aStr) {\n  if (hasNativeMap) {\n    var idx = this._set.get(aStr);\n    if (idx >= 0) {\n        return idx;\n    }\n  } else {\n    var sStr = util.toSetString(aStr);\n    if (has.call(this._set, sStr)) {\n      return this._set[sStr];\n    }\n  }\n\n  throw new Error('\"' + aStr + '\" is not in the set.');\n};\n\n/**\n * What is the element at the given index?\n *\n * @param Number aIdx\n */\nArraySet.prototype.at = function ArraySet_at(aIdx) {\n  if (aIdx >= 0 && aIdx < this._array.length) {\n    return this._array[aIdx];\n  }\n  throw new Error('No element indexed by ' + aIdx);\n};\n\n/**\n * Returns the array representation of this set (which has the proper indices\n * indicated by indexOf). Note that this is a copy of the internal array used\n * for storing the members so that no one can mess with internal state.\n */\nArraySet.prototype.toArray = function ArraySet_toArray() {\n  return this._array.slice();\n};\n\nexports.ArraySet = ArraySet;\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n *\n * Based on the Base 64 VLQ implementation in Closure Compiler:\n * https://code.google.com/p/closure-compiler/source/browse/trunk/src/com/google/debugging/sourcemap/Base64VLQ.java\n *\n * Copyright 2011 The Closure Compiler Authors. All rights reserved.\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *  * Redistributions of source code must retain the above copyright\n *    notice, this list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above\n *    copyright notice, this list of conditions and the following\n *    disclaimer in the documentation and/or other materials provided\n *    with the distribution.\n *  * Neither the name of Google Inc. nor the names of its\n *    contributors may be used to endorse or promote products derived\n *    from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nvar base64 = require('./base64');\n\n// A single base 64 digit can contain 6 bits of data. For the base 64 variable\n// length quantities we use in the source map spec, the first bit is the sign,\n// the next four bits are the actual value, and the 6th bit is the\n// continuation bit. The continuation bit tells us whether there are more\n// digits in this value following this digit.\n//\n//   Continuation\n//   |    Sign\n//   |    |\n//   V    V\n//   101011\n\nvar VLQ_BASE_SHIFT = 5;\n\n// binary: 100000\nvar VLQ_BASE = 1 << VLQ_BASE_SHIFT;\n\n// binary: 011111\nvar VLQ_BASE_MASK = VLQ_BASE - 1;\n\n// binary: 100000\nvar VLQ_CONTINUATION_BIT = VLQ_BASE;\n\n/**\n * Converts from a two-complement value to a value where the sign bit is\n * placed in the least significant bit.  For example, as decimals:\n *   1 becomes 2 (10 binary), -1 becomes 3 (11 binary)\n *   2 becomes 4 (100 binary), -2 becomes 5 (101 binary)\n */\nfunction toVLQSigned(aValue) {\n  return aValue < 0\n    ? ((-aValue) << 1) + 1\n    : (aValue << 1) + 0;\n}\n\n/**\n * Converts to a two-complement value from a value where the sign bit is\n * placed in the least significant bit.  For example, as decimals:\n *   2 (10 binary) becomes 1, 3 (11 binary) becomes -1\n *   4 (100 binary) becomes 2, 5 (101 binary) becomes -2\n */\nfunction fromVLQSigned(aValue) {\n  var isNegative = (aValue & 1) === 1;\n  var shifted = aValue >> 1;\n  return isNegative\n    ? -shifted\n    : shifted;\n}\n\n/**\n * Returns the base 64 VLQ encoded value.\n */\nexports.encode = function base64VLQ_encode(aValue) {\n  var encoded = \"\";\n  var digit;\n\n  var vlq = toVLQSigned(aValue);\n\n  do {\n    digit = vlq & VLQ_BASE_MASK;\n    vlq >>>= VLQ_BASE_SHIFT;\n    if (vlq > 0) {\n      // There are still more digits in this value, so we must make sure the\n      // continuation bit is marked.\n      digit |= VLQ_CONTINUATION_BIT;\n    }\n    encoded += base64.encode(digit);\n  } while (vlq > 0);\n\n  return encoded;\n};\n\n/**\n * Decodes the next base 64 VLQ value from the given string and returns the\n * value and the rest of the string via the out parameter.\n */\nexports.decode = function base64VLQ_decode(aStr, aIndex, aOutParam) {\n  var strLen = aStr.length;\n  var result = 0;\n  var shift = 0;\n  var continuation, digit;\n\n  do {\n    if (aIndex >= strLen) {\n      throw new Error(\"Expected more digits in base 64 VLQ value.\");\n    }\n\n    digit = base64.decode(aStr.charCodeAt(aIndex++));\n    if (digit === -1) {\n      throw new Error(\"Invalid base64 digit: \" + aStr.charAt(aIndex - 1));\n    }\n\n    continuation = !!(digit & VLQ_CONTINUATION_BIT);\n    digit &= VLQ_BASE_MASK;\n    result = result + (digit << shift);\n    shift += VLQ_BASE_SHIFT;\n  } while (continuation);\n\n  aOutParam.value = fromVLQSigned(result);\n  aOutParam.rest = aIndex;\n};\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nvar base64VLQ = require('./base64-vlq');\nvar util = require('./util');\nvar ArraySet = require('./array-set').ArraySet;\nvar MappingList = require('./mapping-list').MappingList;\n\n/**\n * An instance of the SourceMapGenerator represents a source map which is\n * being built incrementally. You may pass an object with the following\n * properties:\n *\n *   - file: The filename of the generated source.\n *   - sourceRoot: A root for all relative URLs in this source map.\n */\nfunction SourceMapGenerator(aArgs) {\n  if (!aArgs) {\n    aArgs = {};\n  }\n  this._file = util.getArg(aArgs, 'file', null);\n  this._sourceRoot = util.getArg(aArgs, 'sourceRoot', null);\n  this._skipValidation = util.getArg(aArgs, 'skipValidation', false);\n  this._sources = new ArraySet();\n  this._names = new ArraySet();\n  this._mappings = new MappingList();\n  this._sourcesContents = null;\n}\n\nSourceMapGenerator.prototype._version = 3;\n\n/**\n * Creates a new SourceMapGenerator based on a SourceMapConsumer\n *\n * @param aSourceMapConsumer The SourceMap.\n */\nSourceMapGenerator.fromSourceMap =\n  function SourceMapGenerator_fromSourceMap(aSourceMapConsumer) {\n    var sourceRoot = aSourceMapConsumer.sourceRoot;\n    var generator = new SourceMapGenerator({\n      file: aSourceMapConsumer.file,\n      sourceRoot: sourceRoot\n    });\n    aSourceMapConsumer.eachMapping(function (mapping) {\n      var newMapping = {\n        generated: {\n          line: mapping.generatedLine,\n          column: mapping.generatedColumn\n        }\n      };\n\n      if (mapping.source != null) {\n        newMapping.source = mapping.source;\n        if (sourceRoot != null) {\n          newMapping.source = util.relative(sourceRoot, newMapping.source);\n        }\n\n        newMapping.original = {\n          line: mapping.originalLine,\n          column: mapping.originalColumn\n        };\n\n        if (mapping.name != null) {\n          newMapping.name = mapping.name;\n        }\n      }\n\n      generator.addMapping(newMapping);\n    });\n    aSourceMapConsumer.sources.forEach(function (sourceFile) {\n      var content = aSourceMapConsumer.sourceContentFor(sourceFile);\n      if (content != null) {\n        generator.setSourceContent(sourceFile, content);\n      }\n    });\n    return generator;\n  };\n\n/**\n * Add a single mapping from original source line and column to the generated\n * source's line and column for this source map being created. The mapping\n * object should have the following properties:\n *\n *   - generated: An object with the generated line and column positions.\n *   - original: An object with the original line and column positions.\n *   - source: The original source file (relative to the sourceRoot).\n *   - name: An optional original token name for this mapping.\n */\nSourceMapGenerator.prototype.addMapping =\n  function SourceMapGenerator_addMapping(aArgs) {\n    var generated = util.getArg(aArgs, 'generated');\n    var original = util.getArg(aArgs, 'original', null);\n    var source = util.getArg(aArgs, 'source', null);\n    var name = util.getArg(aArgs, 'name', null);\n\n    if (!this._skipValidation) {\n      this._validateMapping(generated, original, source, name);\n    }\n\n    if (source != null) {\n      source = String(source);\n      if (!this._sources.has(source)) {\n        this._sources.add(source);\n      }\n    }\n\n    if (name != null) {\n      name = String(name);\n      if (!this._names.has(name)) {\n        this._names.add(name);\n      }\n    }\n\n    this._mappings.add({\n      generatedLine: generated.line,\n      generatedColumn: generated.column,\n      originalLine: original != null && original.line,\n      originalColumn: original != null && original.column,\n      source: source,\n      name: name\n    });\n  };\n\n/**\n * Set the source content for a source file.\n */\nSourceMapGenerator.prototype.setSourceContent =\n  function SourceMapGenerator_setSourceContent(aSourceFile, aSourceContent) {\n    var source = aSourceFile;\n    if (this._sourceRoot != null) {\n      source = util.relative(this._sourceRoot, source);\n    }\n\n    if (aSourceContent != null) {\n      // Add the source content to the _sourcesContents map.\n      // Create a new _sourcesContents map if the property is null.\n      if (!this._sourcesContents) {\n        this._sourcesContents = Object.create(null);\n      }\n      this._sourcesContents[util.toSetString(source)] = aSourceContent;\n    } else if (this._sourcesContents) {\n      // Remove the source file from the _sourcesContents map.\n      // If the _sourcesContents map is empty, set the property to null.\n      delete this._sourcesContents[util.toSetString(source)];\n      if (Object.keys(this._sourcesContents).length === 0) {\n        this._sourcesContents = null;\n      }\n    }\n  };\n\n/**\n * Applies the mappings of a sub-source-map for a specific source file to the\n * source map being generated. Each mapping to the supplied source file is\n * rewritten using the supplied source map. Note: The resolution for the\n * resulting mappings is the minimium of this map and the supplied map.\n *\n * @param aSourceMapConsumer The source map to be applied.\n * @param aSourceFile Optional. The filename of the source file.\n *        If omitted, SourceMapConsumer's file property will be used.\n * @param aSourceMapPath Optional. The dirname of the path to the source map\n *        to be applied. If relative, it is relative to the SourceMapConsumer.\n *        This parameter is needed when the two source maps aren't in the same\n *        directory, and the source map to be applied contains relative source\n *        paths. If so, those relative source paths need to be rewritten\n *        relative to the SourceMapGenerator.\n */\nSourceMapGenerator.prototype.applySourceMap =\n  function SourceMapGenerator_applySourceMap(aSourceMapConsumer, aSourceFile, aSourceMapPath) {\n    var sourceFile = aSourceFile;\n    // If aSourceFile is omitted, we will use the file property of the SourceMap\n    if (aSourceFile == null) {\n      if (aSourceMapConsumer.file == null) {\n        throw new Error(\n          'SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, ' +\n          'or the source map\\'s \"file\" property. Both were omitted.'\n        );\n      }\n      sourceFile = aSourceMapConsumer.file;\n    }\n    var sourceRoot = this._sourceRoot;\n    // Make \"sourceFile\" relative if an absolute Url is passed.\n    if (sourceRoot != null) {\n      sourceFile = util.relative(sourceRoot, sourceFile);\n    }\n    // Applying the SourceMap can add and remove items from the sources and\n    // the names array.\n    var newSources = new ArraySet();\n    var newNames = new ArraySet();\n\n    // Find mappings for the \"sourceFile\"\n    this._mappings.unsortedForEach(function (mapping) {\n      if (mapping.source === sourceFile && mapping.originalLine != null) {\n        // Check if it can be mapped by the source map, then update the mapping.\n        var original = aSourceMapConsumer.originalPositionFor({\n          line: mapping.originalLine,\n          column: mapping.originalColumn\n        });\n        if (original.source != null) {\n          // Copy mapping\n          mapping.source = original.source;\n          if (aSourceMapPath != null) {\n            mapping.source = util.join(aSourceMapPath, mapping.source)\n          }\n          if (sourceRoot != null) {\n            mapping.source = util.relative(sourceRoot, mapping.source);\n          }\n          mapping.originalLine = original.line;\n          mapping.originalColumn = original.column;\n          if (original.name != null) {\n            mapping.name = original.name;\n          }\n        }\n      }\n\n      var source = mapping.source;\n      if (source != null && !newSources.has(source)) {\n        newSources.add(source);\n      }\n\n      var name = mapping.name;\n      if (name != null && !newNames.has(name)) {\n        newNames.add(name);\n      }\n\n    }, this);\n    this._sources = newSources;\n    this._names = newNames;\n\n    // Copy sourcesContents of applied map.\n    aSourceMapConsumer.sources.forEach(function (sourceFile) {\n      var content = aSourceMapConsumer.sourceContentFor(sourceFile);\n      if (content != null) {\n        if (aSourceMapPath != null) {\n          sourceFile = util.join(aSourceMapPath, sourceFile);\n        }\n        if (sourceRoot != null) {\n          sourceFile = util.relative(sourceRoot, sourceFile);\n        }\n        this.setSourceContent(sourceFile, content);\n      }\n    }, this);\n  };\n\n/**\n * A mapping can have one of the three levels of data:\n *\n *   1. Just the generated position.\n *   2. The Generated position, original position, and original source.\n *   3. Generated and original position, original source, as well as a name\n *      token.\n *\n * To maintain consistency, we validate that any new mapping being added falls\n * in to one of these categories.\n */\nSourceMapGenerator.prototype._validateMapping =\n  function SourceMapGenerator_validateMapping(aGenerated, aOriginal, aSource,\n                                              aName) {\n    // When aOriginal is truthy but has empty values for .line and .column,\n    // it is most likely a programmer error. In this case we throw a very\n    // specific error message to try to guide them the right way.\n    // For example: https://github.com/Polymer/polymer-bundler/pull/519\n    if (aOriginal && typeof aOriginal.line !== 'number' && typeof aOriginal.column !== 'number') {\n        throw new Error(\n            'original.line and original.column are not numbers -- you probably meant to omit ' +\n            'the original mapping entirely and only map the generated position. If so, pass ' +\n            'null for the original mapping instead of an object with empty or null values.'\n        );\n    }\n\n    if (aGenerated && 'line' in aGenerated && 'column' in aGenerated\n        && aGenerated.line > 0 && aGenerated.column >= 0\n        && !aOriginal && !aSource && !aName) {\n      // Case 1.\n      return;\n    }\n    else if (aGenerated && 'line' in aGenerated && 'column' in aGenerated\n             && aOriginal && 'line' in aOriginal && 'column' in aOriginal\n             && aGenerated.line > 0 && aGenerated.column >= 0\n             && aOriginal.line > 0 && aOriginal.column >= 0\n             && aSource) {\n      // Cases 2 and 3.\n      return;\n    }\n    else {\n      throw new Error('Invalid mapping: ' + JSON.stringify({\n        generated: aGenerated,\n        source: aSource,\n        original: aOriginal,\n        name: aName\n      }));\n    }\n  };\n\n/**\n * Serialize the accumulated mappings in to the stream of base 64 VLQs\n * specified by the source map format.\n */\nSourceMapGenerator.prototype._serializeMappings =\n  function SourceMapGenerator_serializeMappings() {\n    var previousGeneratedColumn = 0;\n    var previousGeneratedLine = 1;\n    var previousOriginalColumn = 0;\n    var previousOriginalLine = 0;\n    var previousName = 0;\n    var previousSource = 0;\n    var result = '';\n    var next;\n    var mapping;\n    var nameIdx;\n    var sourceIdx;\n\n    var mappings = this._mappings.toArray();\n    for (var i = 0, len = mappings.length; i < len; i++) {\n      mapping = mappings[i];\n      next = ''\n\n      if (mapping.generatedLine !== previousGeneratedLine) {\n        previousGeneratedColumn = 0;\n        while (mapping.generatedLine !== previousGeneratedLine) {\n          next += ';';\n          previousGeneratedLine++;\n        }\n      }\n      else {\n        if (i > 0) {\n          if (!util.compareByGeneratedPositionsInflated(mapping, mappings[i - 1])) {\n            continue;\n          }\n          next += ',';\n        }\n      }\n\n      next += base64VLQ.encode(mapping.generatedColumn\n                                 - previousGeneratedColumn);\n      previousGeneratedColumn = mapping.generatedColumn;\n\n      if (mapping.source != null) {\n        sourceIdx = this._sources.indexOf(mapping.source);\n        next += base64VLQ.encode(sourceIdx - previousSource);\n        previousSource = sourceIdx;\n\n        // lines are stored 0-based in SourceMap spec version 3\n        next += base64VLQ.encode(mapping.originalLine - 1\n                                   - previousOriginalLine);\n        previousOriginalLine = mapping.originalLine - 1;\n\n        next += base64VLQ.encode(mapping.originalColumn\n                                   - previousOriginalColumn);\n        previousOriginalColumn = mapping.originalColumn;\n\n        if (mapping.name != null) {\n          nameIdx = this._names.indexOf(mapping.name);\n          next += base64VLQ.encode(nameIdx - previousName);\n          previousName = nameIdx;\n        }\n      }\n\n      result += next;\n    }\n\n    return result;\n  };\n\nSourceMapGenerator.prototype._generateSourcesContent =\n  function SourceMapGenerator_generateSourcesContent(aSources, aSourceRoot) {\n    return aSources.map(function (source) {\n      if (!this._sourcesContents) {\n        return null;\n      }\n      if (aSourceRoot != null) {\n        source = util.relative(aSourceRoot, source);\n      }\n      var key = util.toSetString(source);\n      return Object.prototype.hasOwnProperty.call(this._sourcesContents, key)\n        ? this._sourcesContents[key]\n        : null;\n    }, this);\n  };\n\n/**\n * Externalize the source map.\n */\nSourceMapGenerator.prototype.toJSON =\n  function SourceMapGenerator_toJSON() {\n    var map = {\n      version: this._version,\n      sources: this._sources.toArray(),\n      names: this._names.toArray(),\n      mappings: this._serializeMappings()\n    };\n    if (this._file != null) {\n      map.file = this._file;\n    }\n    if (this._sourceRoot != null) {\n      map.sourceRoot = this._sourceRoot;\n    }\n    if (this._sourcesContents) {\n      map.sourcesContent = this._generateSourcesContent(map.sources, map.sourceRoot);\n    }\n\n    return map;\n  };\n\n/**\n * Render the source map being generated to a string.\n */\nSourceMapGenerator.prototype.toString =\n  function SourceMapGenerator_toString() {\n    return JSON.stringify(this.toJSON());\n  };\n\nexports.SourceMapGenerator = SourceMapGenerator;\n","import * as Path from 'path'\nimport * as Fs from 'fs'\n\nconst fileUriToPath: (uri: string) => string = require('file-uri-to-path')\nconst sourceMapSupport = require('source-map-support')\n\n/**\n * This array tells the source map logic which files that we can expect to\n * be able to resolve a source map for and they should reflect the chunks\n * entry names from our webpack config.\n *\n * Note that we explicitly don't enable source maps for the crash process\n * since it's possible that the error which caused us to spawn the crash\n * process was related to source maps.\n */\nconst knownFilesWithSourceMap = ['renderer.js', 'main.js']\n\nfunction retrieveSourceMap(source: string) {\n  // This is a happy path in case we know for certain that we won't be\n  // able to resolve a source map for the given location.\n  if (!knownFilesWithSourceMap.some(file => source.endsWith(file))) {\n    return null\n  }\n\n  // We get a file uri when we're inside a renderer, convert to a path\n  if (source.startsWith('file://')) {\n    source = fileUriToPath(source)\n  }\n\n  // We store our source maps right next to the bundle\n  const path = `${source}.map`\n\n  if (__DEV__ && path.startsWith('http://')) {\n    try {\n      const xhr = new XMLHttpRequest()\n      xhr.open('GET', path, false)\n      xhr.send(null)\n      if (xhr.readyState === 4 && xhr.status === 200) {\n        return { url: Path.basename(path), map: xhr.responseText }\n      }\n    } catch (error) {\n      return\n    }\n    return\n  }\n\n  // We don't have an option here, see\n  //  https://github.com/v8/v8/wiki/Stack-Trace-API#customizing-stack-traces\n  // This happens on-demand when someone accesses the stack\n  // property on an error object and has to be synchronous :/\n  // eslint-disable-next-line no-sync\n  if (!Fs.existsSync(path)) {\n    return\n  }\n\n  try {\n    // eslint-disable-next-line no-sync\n    const map = Fs.readFileSync(path, 'utf8')\n    return { url: Path.basename(path), map }\n  } catch (error) {\n    return\n  }\n}\n\n/** A map from errors to their stack frames. */\nconst stackFrameMap = new WeakMap<Error, ReadonlyArray<any>>()\n\n/**\n * The `prepareStackTrace` that comes from the `source-map-support` module.\n * We'll use this when the user explicitly wants the stack source mapped.\n */\nlet prepareStackTraceWithSourceMap: (\n  error: Error,\n  frames: ReadonlyArray<any>\n) => string\n\n/**\n * Capture the error's stack frames and return a standard, un-source mapped\n * stack trace.\n */\nfunction prepareStackTrace(error: Error, frames: ReadonlyArray<any>) {\n  stackFrameMap.set(error, frames)\n\n  // Ideally we'd use the default `Error.prepareStackTrace` here but it's\n  // undefined so V8 must doing something fancy. Instead we'll do a decent\n  // impression.\n  return error + frames.map(frame => `\\n    at ${frame}`).join('')\n}\n\n/** Enable source map support in the current process. */\nexport function enableSourceMaps() {\n  sourceMapSupport.install({\n    environment: 'node',\n    handleUncaughtExceptions: false,\n    retrieveSourceMap,\n  })\n\n  const AnyError = Error as any\n  // We want to keep `source-map-support`s `prepareStackTrace` around to use\n  // later, but our cheaper `prepareStackTrace` should be the default.\n  prepareStackTraceWithSourceMap = AnyError.prepareStackTrace\n  AnyError.prepareStackTrace = prepareStackTrace\n}\n\n/**\n * Make a copy of the error with a source-mapped stack trace. If it couldn't\n * perform the source mapping, it'll use the original error stack.\n */\nexport function withSourceMappedStack(error: Error): Error {\n  return {\n    name: error.name,\n    message: error.message,\n    stack: sourceMappedStackTrace(error),\n  }\n}\n\n/** Get the source mapped stack trace for the error. */\nfunction sourceMappedStackTrace(error: Error): string | undefined {\n  let frames = stackFrameMap.get(error)\n\n  if (!frames) {\n    // At this point there's no guarantee that anyone has actually retrieved the\n    // stack on this error which means that our custom prepareStackTrace handler\n    // hasn't run and as a result of that we don't have the native frames stored\n    // in our weak map. In order to get around that we'll eagerly access the\n    // stack, forcing our handler to run which should ensure that the native\n    // frames are stored in our weak map.\n    ;(error.stack || '').toString()\n    frames = stackFrameMap.get(error)\n  }\n\n  if (!frames) {\n    return error.stack\n  }\n\n  return prepareStackTraceWithSourceMap(error, frames)\n}\n","\"use strict\";\n\nexports.__esModule = true;\n\nvar _isIterable2 = require(\"../core-js/is-iterable\");\n\nvar _isIterable3 = _interopRequireDefault(_isIterable2);\n\nvar _getIterator2 = require(\"../core-js/get-iterator\");\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = (0, _getIterator3.default)(arr), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if ((0, _isIterable3.default)(Object(arr))) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();","module.exports = { \"default\": require(\"core-js/library/fn/object/get-own-property-descriptor\"), __esModule: true };","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nfunction componentWillMount() {\n  // Call this.constructor.gDSFP to support sub-classes.\n  var state = this.constructor.getDerivedStateFromProps(this.props, this.state);\n  if (state !== null && state !== undefined) {\n    this.setState(state);\n  }\n}\n\nfunction componentWillReceiveProps(nextProps) {\n  // Call this.constructor.gDSFP to support sub-classes.\n  // Use the setState() updater to ensure state isn't stale in certain edge cases.\n  function updater(prevState) {\n    var state = this.constructor.getDerivedStateFromProps(nextProps, prevState);\n    return state !== null && state !== undefined ? state : null;\n  }\n  // Binding \"this\" is important for shallow renderer support.\n  this.setState(updater.bind(this));\n}\n\nfunction componentWillUpdate(nextProps, nextState) {\n  try {\n    var prevProps = this.props;\n    var prevState = this.state;\n    this.props = nextProps;\n    this.state = nextState;\n    this.__reactInternalSnapshotFlag = true;\n    this.__reactInternalSnapshot = this.getSnapshotBeforeUpdate(\n      prevProps,\n      prevState\n    );\n  } finally {\n    this.props = prevProps;\n    this.state = prevState;\n  }\n}\n\n// React may warn about cWM/cWRP/cWU methods being deprecated.\n// Add a flag to suppress these warnings for this special case.\ncomponentWillMount.__suppressDeprecationWarning = true;\ncomponentWillReceiveProps.__suppressDeprecationWarning = true;\ncomponentWillUpdate.__suppressDeprecationWarning = true;\n\nfunction polyfill(Component) {\n  var prototype = Component.prototype;\n\n  if (!prototype || !prototype.isReactComponent) {\n    throw new Error('Can only polyfill class components');\n  }\n\n  if (\n    typeof Component.getDerivedStateFromProps !== 'function' &&\n    typeof prototype.getSnapshotBeforeUpdate !== 'function'\n  ) {\n    return Component;\n  }\n\n  // If new component APIs are defined, \"unsafe\" lifecycles won't be called.\n  // Error if any of these lifecycles are present,\n  // Because they would work differently between older and newer (16.3+) versions of React.\n  var foundWillMountName = null;\n  var foundWillReceivePropsName = null;\n  var foundWillUpdateName = null;\n  if (typeof prototype.componentWillMount === 'function') {\n    foundWillMountName = 'componentWillMount';\n  } else if (typeof prototype.UNSAFE_componentWillMount === 'function') {\n    foundWillMountName = 'UNSAFE_componentWillMount';\n  }\n  if (typeof prototype.componentWillReceiveProps === 'function') {\n    foundWillReceivePropsName = 'componentWillReceiveProps';\n  } else if (typeof prototype.UNSAFE_componentWillReceiveProps === 'function') {\n    foundWillReceivePropsName = 'UNSAFE_componentWillReceiveProps';\n  }\n  if (typeof prototype.componentWillUpdate === 'function') {\n    foundWillUpdateName = 'componentWillUpdate';\n  } else if (typeof prototype.UNSAFE_componentWillUpdate === 'function') {\n    foundWillUpdateName = 'UNSAFE_componentWillUpdate';\n  }\n  if (\n    foundWillMountName !== null ||\n    foundWillReceivePropsName !== null ||\n    foundWillUpdateName !== null\n  ) {\n    var componentName = Component.displayName || Component.name;\n    var newApiName =\n      typeof Component.getDerivedStateFromProps === 'function'\n        ? 'getDerivedStateFromProps()'\n        : 'getSnapshotBeforeUpdate()';\n\n    throw Error(\n      'Unsafe legacy lifecycles will not be called for components using new component APIs.\\n\\n' +\n        componentName +\n        ' uses ' +\n        newApiName +\n        ' but also contains the following legacy lifecycles:' +\n        (foundWillMountName !== null ? '\\n  ' + foundWillMountName : '') +\n        (foundWillReceivePropsName !== null\n          ? '\\n  ' + foundWillReceivePropsName\n          : '') +\n        (foundWillUpdateName !== null ? '\\n  ' + foundWillUpdateName : '') +\n        '\\n\\nThe above lifecycles should be removed. Learn more about this warning here:\\n' +\n        'https://fb.me/react-async-component-lifecycle-hooks'\n    );\n  }\n\n  // React <= 16.2 does not support static getDerivedStateFromProps.\n  // As a workaround, use cWM and cWRP to invoke the new static lifecycle.\n  // Newer versions of React will ignore these lifecycles if gDSFP exists.\n  if (typeof Component.getDerivedStateFromProps === 'function') {\n    prototype.componentWillMount = componentWillMount;\n    prototype.componentWillReceiveProps = componentWillReceiveProps;\n  }\n\n  // React <= 16.2 does not support getSnapshotBeforeUpdate.\n  // As a workaround, use cWU to invoke the new lifecycle.\n  // Newer versions of React will ignore that lifecycle if gSBU exists.\n  if (typeof prototype.getSnapshotBeforeUpdate === 'function') {\n    if (typeof prototype.componentDidUpdate !== 'function') {\n      throw new Error(\n        'Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype'\n      );\n    }\n\n    prototype.componentWillUpdate = componentWillUpdate;\n\n    var componentDidUpdate = prototype.componentDidUpdate;\n\n    prototype.componentDidUpdate = function componentDidUpdatePolyfill(\n      prevProps,\n      prevState,\n      maybeSnapshot\n    ) {\n      // 16.3+ will not execute our will-update method;\n      // It will pass a snapshot value to did-update though.\n      // Older versions will require our polyfilled will-update value.\n      // We need to handle both cases, but can't just check for the presence of \"maybeSnapshot\",\n      // Because for <= 15.x versions this might be a \"prevContext\" object.\n      // We also can't just check \"__reactInternalSnapshot\",\n      // Because get-snapshot might return a falsy value.\n      // So check for the explicit __reactInternalSnapshotFlag flag to determine behavior.\n      var snapshot = this.__reactInternalSnapshotFlag\n        ? this.__reactInternalSnapshot\n        : maybeSnapshot;\n\n      componentDidUpdate.call(this, prevProps, prevState, snapshot);\n    };\n  }\n\n  return Component;\n}\n\nexport { polyfill };\n","/**\n * Detect Element Resize.\n * https://github.com/sdecima/javascript-detect-element-resize\n * Sebastian Decima\n *\n * Forked from version 0.5.3; includes the following modifications:\n * 1)Guard against unsafe 'window' and 'document' references (to support SSR).\n * 2)Defer initialization code via a top-level function wrapper (to support SSR).\n * 3) Avoid unnecessary reflows by not measuring size for scroll events bubbling from children.\n * 4) Add nonce for style element.\n **/\n\nexport default function createDetectElementResize(nonce) {\n  // Check `document` and `window` in case of server-side rendering\n  var _window;\n  if (typeof window !== 'undefined') {\n    _window = window;\n  } else if (typeof self !== 'undefined') {\n    _window = self;\n  } else {\n    _window = global;\n  }\n\n  var attachEvent = typeof document !== 'undefined' && document.attachEvent;\n\n  if (!attachEvent) {\n    var requestFrame = function () {\n      var raf = _window.requestAnimationFrame || _window.mozRequestAnimationFrame || _window.webkitRequestAnimationFrame || function (fn) {\n        return _window.setTimeout(fn, 20);\n      };\n      return function (fn) {\n        return raf(fn);\n      };\n    }();\n\n    var cancelFrame = function () {\n      var cancel = _window.cancelAnimationFrame || _window.mozCancelAnimationFrame || _window.webkitCancelAnimationFrame || _window.clearTimeout;\n      return function (id) {\n        return cancel(id);\n      };\n    }();\n\n    var resetTriggers = function resetTriggers(element) {\n      var triggers = element.__resizeTriggers__,\n          expand = triggers.firstElementChild,\n          contract = triggers.lastElementChild,\n          expandChild = expand.firstElementChild;\n      contract.scrollLeft = contract.scrollWidth;\n      contract.scrollTop = contract.scrollHeight;\n      expandChild.style.width = expand.offsetWidth + 1 + 'px';\n      expandChild.style.height = expand.offsetHeight + 1 + 'px';\n      expand.scrollLeft = expand.scrollWidth;\n      expand.scrollTop = expand.scrollHeight;\n    };\n\n    var checkTriggers = function checkTriggers(element) {\n      return element.offsetWidth != element.__resizeLast__.width || element.offsetHeight != element.__resizeLast__.height;\n    };\n\n    var scrollListener = function scrollListener(e) {\n      // Don't measure (which forces) reflow for scrolls that happen inside of children!\n      if (e.target.className.indexOf('contract-trigger') < 0 && e.target.className.indexOf('expand-trigger') < 0) {\n        return;\n      }\n\n      var element = this;\n      resetTriggers(this);\n      if (this.__resizeRAF__) {\n        cancelFrame(this.__resizeRAF__);\n      }\n      this.__resizeRAF__ = requestFrame(function () {\n        if (checkTriggers(element)) {\n          element.__resizeLast__.width = element.offsetWidth;\n          element.__resizeLast__.height = element.offsetHeight;\n          element.__resizeListeners__.forEach(function (fn) {\n            fn.call(element, e);\n          });\n        }\n      });\n    };\n\n    /* Detect CSS Animations support to detect element display/re-attach */\n    var animation = false,\n        keyframeprefix = '',\n        animationstartevent = 'animationstart',\n        domPrefixes = 'Webkit Moz O ms'.split(' '),\n        startEvents = 'webkitAnimationStart animationstart oAnimationStart MSAnimationStart'.split(' '),\n        pfx = '';\n    {\n      var elm = document.createElement('fakeelement');\n      if (elm.style.animationName !== undefined) {\n        animation = true;\n      }\n\n      if (animation === false) {\n        for (var i = 0; i < domPrefixes.length; i++) {\n          if (elm.style[domPrefixes[i] + 'AnimationName'] !== undefined) {\n            pfx = domPrefixes[i];\n            keyframeprefix = '-' + pfx.toLowerCase() + '-';\n            animationstartevent = startEvents[i];\n            animation = true;\n            break;\n          }\n        }\n      }\n    }\n\n    var animationName = 'resizeanim';\n    var animationKeyframes = '@' + keyframeprefix + 'keyframes ' + animationName + ' { from { opacity: 0; } to { opacity: 0; } } ';\n    var animationStyle = keyframeprefix + 'animation: 1ms ' + animationName + '; ';\n  }\n\n  var createStyles = function createStyles(doc) {\n    if (!doc.getElementById('detectElementResize')) {\n      //opacity:0 works around a chrome bug https://code.google.com/p/chromium/issues/detail?id=286360\n      var css = (animationKeyframes ? animationKeyframes : '') + '.resize-triggers { ' + (animationStyle ? animationStyle : '') + 'visibility: hidden; opacity: 0; } ' + '.resize-triggers, .resize-triggers > div, .contract-trigger:before { content: \" \"; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',\n          head = doc.head || doc.getElementsByTagName('head')[0],\n          style = doc.createElement('style');\n\n      style.id = 'detectElementResize';\n      style.type = 'text/css';\n\n      if (nonce != null) {\n        style.setAttribute('nonce', nonce);\n      }\n\n      if (style.styleSheet) {\n        style.styleSheet.cssText = css;\n      } else {\n        style.appendChild(doc.createTextNode(css));\n      }\n\n      head.appendChild(style);\n    }\n  };\n\n  var addResizeListener = function addResizeListener(element, fn) {\n    if (attachEvent) {\n      element.attachEvent('onresize', fn);\n    } else {\n      if (!element.__resizeTriggers__) {\n        var doc = element.ownerDocument;\n        var elementStyle = _window.getComputedStyle(element);\n        if (elementStyle && elementStyle.position == 'static') {\n          element.style.position = 'relative';\n        }\n        createStyles(doc);\n        element.__resizeLast__ = {};\n        element.__resizeListeners__ = [];\n        (element.__resizeTriggers__ = doc.createElement('div')).className = 'resize-triggers';\n        element.__resizeTriggers__.innerHTML = '<div class=\"expand-trigger\"><div></div></div>' + '<div class=\"contract-trigger\"></div>';\n        element.appendChild(element.__resizeTriggers__);\n        resetTriggers(element);\n        element.addEventListener('scroll', scrollListener, true);\n\n        /* Listen for a css animation to detect element display/re-attach */\n        if (animationstartevent) {\n          element.__resizeTriggers__.__animationListener__ = function animationListener(e) {\n            if (e.animationName == animationName) {\n              resetTriggers(element);\n            }\n          };\n          element.__resizeTriggers__.addEventListener(animationstartevent, element.__resizeTriggers__.__animationListener__);\n        }\n      }\n      element.__resizeListeners__.push(fn);\n    }\n  };\n\n  var removeResizeListener = function removeResizeListener(element, fn) {\n    if (attachEvent) {\n      element.detachEvent('onresize', fn);\n    } else {\n      element.__resizeListeners__.splice(element.__resizeListeners__.indexOf(fn), 1);\n      if (!element.__resizeListeners__.length) {\n        element.removeEventListener('scroll', scrollListener, true);\n        if (element.__resizeTriggers__.__animationListener__) {\n          element.__resizeTriggers__.removeEventListener(animationstartevent, element.__resizeTriggers__.__animationListener__);\n          element.__resizeTriggers__.__animationListener__ = null;\n        }\n        try {\n          element.__resizeTriggers__ = !element.removeChild(element.__resizeTriggers__);\n        } catch (e) {\n          // Preact compat; see developit/preact-compat/issues/228\n        }\n      }\n    }\n  };\n\n  return {\n    addResizeListener: addResizeListener,\n    removeResizeListener: removeResizeListener\n  };\n}","import _extends from 'babel-runtime/helpers/extends';\nimport _Object$getPrototypeOf from 'babel-runtime/core-js/object/get-prototype-of';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport * as React from 'react';\nimport createDetectElementResize from '../vendor/detectElementResize';\n\nvar AutoSizer = function (_React$PureComponent) {\n  _inherits(AutoSizer, _React$PureComponent);\n\n  function AutoSizer() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, AutoSizer);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = AutoSizer.__proto__ || _Object$getPrototypeOf(AutoSizer)).call.apply(_ref, [this].concat(args))), _this), _this.state = {\n      height: _this.props.defaultHeight || 0,\n      width: _this.props.defaultWidth || 0\n    }, _this._onResize = function () {\n      var _this$props = _this.props,\n          disableHeight = _this$props.disableHeight,\n          disableWidth = _this$props.disableWidth,\n          onResize = _this$props.onResize;\n\n\n      if (_this._parentNode) {\n        // Guard against AutoSizer component being removed from the DOM immediately after being added.\n        // This can result in invalid style values which can result in NaN values if we don't handle them.\n        // See issue #150 for more context.\n\n        var _height = _this._parentNode.offsetHeight || 0;\n        var _width = _this._parentNode.offsetWidth || 0;\n\n        var _style = window.getComputedStyle(_this._parentNode) || {};\n        var paddingLeft = parseInt(_style.paddingLeft, 10) || 0;\n        var paddingRight = parseInt(_style.paddingRight, 10) || 0;\n        var paddingTop = parseInt(_style.paddingTop, 10) || 0;\n        var paddingBottom = parseInt(_style.paddingBottom, 10) || 0;\n\n        var newHeight = _height - paddingTop - paddingBottom;\n        var newWidth = _width - paddingLeft - paddingRight;\n\n        if (!disableHeight && _this.state.height !== newHeight || !disableWidth && _this.state.width !== newWidth) {\n          _this.setState({\n            height: _height - paddingTop - paddingBottom,\n            width: _width - paddingLeft - paddingRight\n          });\n\n          onResize({ height: _height, width: _width });\n        }\n      }\n    }, _this._setRef = function (autoSizer) {\n      _this._autoSizer = autoSizer;\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(AutoSizer, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var nonce = this.props.nonce;\n\n      if (this._autoSizer && this._autoSizer.parentNode && this._autoSizer.parentNode.ownerDocument && this._autoSizer.parentNode.ownerDocument.defaultView && this._autoSizer.parentNode instanceof this._autoSizer.parentNode.ownerDocument.defaultView.HTMLElement) {\n        // Delay access of parentNode until mount.\n        // This handles edge-cases where the component has already been unmounted before its ref has been set,\n        // As well as libraries like react-lite which have a slightly different lifecycle.\n        this._parentNode = this._autoSizer.parentNode;\n\n        // Defer requiring resize handler in order to support server-side rendering.\n        // See issue #41\n        this._detectElementResize = createDetectElementResize(nonce);\n        this._detectElementResize.addResizeListener(this._parentNode, this._onResize);\n\n        this._onResize();\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      if (this._detectElementResize && this._parentNode) {\n        this._detectElementResize.removeResizeListener(this._parentNode, this._onResize);\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props = this.props,\n          children = _props.children,\n          className = _props.className,\n          disableHeight = _props.disableHeight,\n          disableWidth = _props.disableWidth,\n          style = _props.style;\n      var _state = this.state,\n          height = _state.height,\n          width = _state.width;\n\n      // Outer div should not force width/height since that may prevent containers from shrinking.\n      // Inner component should overflow and use calculated width/height.\n      // See issue #68 for more information.\n\n      var outerStyle = { overflow: 'visible' };\n      var childParams = {};\n\n      if (!disableHeight) {\n        outerStyle.height = 0;\n        childParams.height = height;\n      }\n\n      if (!disableWidth) {\n        outerStyle.width = 0;\n        childParams.width = width;\n      }\n\n      /**\n       * TODO: Avoid rendering children before the initial measurements have been collected.\n       * At best this would just be wasting cycles.\n       * Add this check into version 10 though as it could break too many ref callbacks in version 9.\n       * Note that if default width/height props were provided this would still work with SSR.\n      if (\n        height !== 0 &&\n        width !== 0\n      ) {\n        child = children({ height, width })\n      }\n      */\n\n      return React.createElement(\n        'div',\n        {\n          className: className,\n          ref: this._setRef,\n          style: _extends({}, outerStyle, style) },\n        children(childParams)\n      );\n    }\n  }]);\n\n  return AutoSizer;\n}(React.PureComponent);\n\nAutoSizer.defaultProps = {\n  onResize: function onResize() {},\n  disableHeight: false,\n  disableWidth: false,\n  style: {}\n};\nAutoSizer.propTypes = process.env.NODE_ENV === 'production' ? null : {\n  /** Function responsible for rendering children.*/\n  children: PropTypes.func.isRequired,\n\n\n  /** Optional custom CSS class name to attach to root AutoSizer element.  */\n  className: PropTypes.string,\n\n\n  /** Default height to use for initial render; useful for SSR */\n  defaultHeight: PropTypes.number,\n\n\n  /** Default width to use for initial render; useful for SSR */\n  defaultWidth: PropTypes.number,\n\n\n  /** Disable dynamic :height property */\n  disableHeight: PropTypes.bool.isRequired,\n\n\n  /** Disable dynamic :width property */\n  disableWidth: PropTypes.bool.isRequired,\n\n\n  /** Nonce of the inlined stylesheet for Content Security Policy */\n  nonce: PropTypes.string,\n\n\n  /** Callback to be invoked on-resize */\n  onResize: PropTypes.func.isRequired,\n\n\n  /** Optional inline style */\n  style: PropTypes.object\n};\nexport default AutoSizer;\nimport PropTypes from 'prop-types';","import _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\n\n\nexport var DEFAULT_HEIGHT = 30;\n\nexport var DEFAULT_WIDTH = 100;\n\n// Enables more intelligent mapping of a given column and row index to an item ID.\n// This prevents a cell cache from being invalidated when its parent collection is modified.\n\n/**\n * Caches measurements for a given cell.\n */\nvar CellMeasurerCache = function () {\n  function CellMeasurerCache() {\n    var _this = this;\n\n    var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, CellMeasurerCache);\n\n    this._cellHeightCache = {};\n    this._cellWidthCache = {};\n    this._columnWidthCache = {};\n    this._rowHeightCache = {};\n    this._columnCount = 0;\n    this._rowCount = 0;\n\n    this.columnWidth = function (_ref) {\n      var index = _ref.index;\n\n      var key = _this._keyMapper(0, index);\n\n      return _this._columnWidthCache.hasOwnProperty(key) ? _this._columnWidthCache[key] : _this._defaultWidth;\n    };\n\n    this.rowHeight = function (_ref2) {\n      var index = _ref2.index;\n\n      var key = _this._keyMapper(index, 0);\n\n      return _this._rowHeightCache.hasOwnProperty(key) ? _this._rowHeightCache[key] : _this._defaultHeight;\n    };\n\n    var defaultHeight = params.defaultHeight,\n        defaultWidth = params.defaultWidth,\n        fixedHeight = params.fixedHeight,\n        fixedWidth = params.fixedWidth,\n        keyMapper = params.keyMapper,\n        minHeight = params.minHeight,\n        minWidth = params.minWidth;\n\n\n    this._hasFixedHeight = fixedHeight === true;\n    this._hasFixedWidth = fixedWidth === true;\n    this._minHeight = minHeight || 0;\n    this._minWidth = minWidth || 0;\n    this._keyMapper = keyMapper || defaultKeyMapper;\n\n    this._defaultHeight = Math.max(this._minHeight, typeof defaultHeight === 'number' ? defaultHeight : DEFAULT_HEIGHT);\n    this._defaultWidth = Math.max(this._minWidth, typeof defaultWidth === 'number' ? defaultWidth : DEFAULT_WIDTH);\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (this._hasFixedHeight === false && this._hasFixedWidth === false) {\n        console.warn(\"CellMeasurerCache should only measure a cell's width or height. \" + 'You have configured CellMeasurerCache to measure both. ' + 'This will result in poor performance.');\n      }\n\n      if (this._hasFixedHeight === false && this._defaultHeight === 0) {\n        console.warn('Fixed height CellMeasurerCache should specify a :defaultHeight greater than 0. ' + 'Failing to do so will lead to unnecessary layout and poor performance.');\n      }\n\n      if (this._hasFixedWidth === false && this._defaultWidth === 0) {\n        console.warn('Fixed width CellMeasurerCache should specify a :defaultWidth greater than 0. ' + 'Failing to do so will lead to unnecessary layout and poor performance.');\n      }\n    }\n  }\n\n  _createClass(CellMeasurerCache, [{\n    key: 'clear',\n    value: function clear(rowIndex) {\n      var columnIndex = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      var key = this._keyMapper(rowIndex, columnIndex);\n\n      delete this._cellHeightCache[key];\n      delete this._cellWidthCache[key];\n\n      this._updateCachedColumnAndRowSizes(rowIndex, columnIndex);\n    }\n  }, {\n    key: 'clearAll',\n    value: function clearAll() {\n      this._cellHeightCache = {};\n      this._cellWidthCache = {};\n      this._columnWidthCache = {};\n      this._rowHeightCache = {};\n      this._rowCount = 0;\n      this._columnCount = 0;\n    }\n  }, {\n    key: 'hasFixedHeight',\n    value: function hasFixedHeight() {\n      return this._hasFixedHeight;\n    }\n  }, {\n    key: 'hasFixedWidth',\n    value: function hasFixedWidth() {\n      return this._hasFixedWidth;\n    }\n  }, {\n    key: 'getHeight',\n    value: function getHeight(rowIndex) {\n      var columnIndex = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      if (this._hasFixedHeight) {\n        return this._defaultHeight;\n      } else {\n        var _key = this._keyMapper(rowIndex, columnIndex);\n\n        return this._cellHeightCache.hasOwnProperty(_key) ? Math.max(this._minHeight, this._cellHeightCache[_key]) : this._defaultHeight;\n      }\n    }\n  }, {\n    key: 'getWidth',\n    value: function getWidth(rowIndex) {\n      var columnIndex = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      if (this._hasFixedWidth) {\n        return this._defaultWidth;\n      } else {\n        var _key2 = this._keyMapper(rowIndex, columnIndex);\n\n        return this._cellWidthCache.hasOwnProperty(_key2) ? Math.max(this._minWidth, this._cellWidthCache[_key2]) : this._defaultWidth;\n      }\n    }\n  }, {\n    key: 'has',\n    value: function has(rowIndex) {\n      var columnIndex = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      var key = this._keyMapper(rowIndex, columnIndex);\n\n      return this._cellHeightCache.hasOwnProperty(key);\n    }\n  }, {\n    key: 'set',\n    value: function set(rowIndex, columnIndex, width, height) {\n      var key = this._keyMapper(rowIndex, columnIndex);\n\n      if (columnIndex >= this._columnCount) {\n        this._columnCount = columnIndex + 1;\n      }\n      if (rowIndex >= this._rowCount) {\n        this._rowCount = rowIndex + 1;\n      }\n\n      // Size is cached per cell so we don't have to re-measure if cells are re-ordered.\n      this._cellHeightCache[key] = height;\n      this._cellWidthCache[key] = width;\n\n      this._updateCachedColumnAndRowSizes(rowIndex, columnIndex);\n    }\n  }, {\n    key: '_updateCachedColumnAndRowSizes',\n    value: function _updateCachedColumnAndRowSizes(rowIndex, columnIndex) {\n      // :columnWidth and :rowHeight are derived based on all cells in a column/row.\n      // Pre-cache these derived values for faster lookup later.\n      // Reads are expected to occur more frequently than writes in this case.\n      // Only update non-fixed dimensions though to avoid doing unnecessary work.\n      if (!this._hasFixedWidth) {\n        var columnWidth = 0;\n        for (var i = 0; i < this._rowCount; i++) {\n          columnWidth = Math.max(columnWidth, this.getWidth(i, columnIndex));\n        }\n        var columnKey = this._keyMapper(0, columnIndex);\n        this._columnWidthCache[columnKey] = columnWidth;\n      }\n      if (!this._hasFixedHeight) {\n        var rowHeight = 0;\n        for (var _i = 0; _i < this._columnCount; _i++) {\n          rowHeight = Math.max(rowHeight, this.getHeight(rowIndex, _i));\n        }\n        var rowKey = this._keyMapper(rowIndex, 0);\n        this._rowHeightCache[rowKey] = rowHeight;\n      }\n    }\n  }, {\n    key: 'defaultHeight',\n    get: function get() {\n      return this._defaultHeight;\n    }\n  }, {\n    key: 'defaultWidth',\n    get: function get() {\n      return this._defaultWidth;\n    }\n  }]);\n\n  return CellMeasurerCache;\n}();\n\nexport default CellMeasurerCache;\n\n\nfunction defaultKeyMapper(rowIndex, columnIndex) {\n  return rowIndex + '-' + columnIndex;\n}\nimport { bpfrpt_proptype_CellMeasureCache } from './types';","import CellMeasurer from './CellMeasurer';\nimport CellMeasurerCache from './CellMeasurerCache';\n\nexport default CellMeasurer;\nexport { CellMeasurer, CellMeasurerCache };","import _Object$keys from 'babel-runtime/core-js/object/keys';\n/**\n * Helper utility that updates the specified callback whenever any of the specified indices have changed.\n */\nexport default function createCallbackMemoizer() {\n  var requireAllKeys = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n\n  var cachedIndices = {};\n\n  return function (_ref) {\n    var callback = _ref.callback,\n        indices = _ref.indices;\n\n    var keys = _Object$keys(indices);\n    var allInitialized = !requireAllKeys || keys.every(function (key) {\n      var value = indices[key];\n      return Array.isArray(value) ? value.length > 0 : value >= 0;\n    });\n    var indexChanged = keys.length !== _Object$keys(cachedIndices).length || keys.some(function (key) {\n      var cachedValue = cachedIndices[key];\n      var value = indices[key];\n\n      return Array.isArray(value) ? cachedValue.join(',') !== value.join(',') : cachedValue !== value;\n    });\n\n    cachedIndices = indices;\n\n    if (allInitialized && indexChanged) {\n      callback(indices);\n    }\n  };\n}","import SectionManager from '../SectionManager';\n\nexport default function calculateSizeAndPositionData(_ref) {\n  var cellCount = _ref.cellCount,\n      cellSizeAndPositionGetter = _ref.cellSizeAndPositionGetter,\n      sectionSize = _ref.sectionSize;\n\n  var cellMetadata = [];\n  var sectionManager = new SectionManager(sectionSize);\n  var height = 0;\n  var width = 0;\n\n  for (var index = 0; index < cellCount; index++) {\n    var cellMetadatum = cellSizeAndPositionGetter({ index: index });\n\n    if (cellMetadatum.height == null || isNaN(cellMetadatum.height) || cellMetadatum.width == null || isNaN(cellMetadatum.width) || cellMetadatum.x == null || isNaN(cellMetadatum.x) || cellMetadatum.y == null || isNaN(cellMetadatum.y)) {\n      throw Error('Invalid metadata returned for cell ' + index + ':\\n        x:' + cellMetadatum.x + ', y:' + cellMetadatum.y + ', width:' + cellMetadatum.width + ', height:' + cellMetadatum.height);\n    }\n\n    height = Math.max(height, cellMetadatum.y + cellMetadatum.height);\n    width = Math.max(width, cellMetadatum.x + cellMetadatum.width);\n\n    cellMetadata[index] = cellMetadatum;\n    sectionManager.registerCell({\n      cellMetadatum: cellMetadatum,\n      index: index\n    });\n  }\n\n  return {\n    cellMetadata: cellMetadata,\n    height: height,\n    sectionManager: sectionManager,\n    width: width\n  };\n}","/**\n * Determines a new offset that ensures a certain cell is visible, given the current offset.\n * If the cell is already visible then the current offset will be returned.\n * If the current offset is too great or small, it will be adjusted just enough to ensure the specified index is visible.\n *\n * @param align Desired alignment within container; one of \"auto\" (default), \"start\", or \"end\"\n * @param cellOffset Offset (x or y) position for cell\n * @param cellSize Size (width or height) of cell\n * @param containerSize Total size (width or height) of the container\n * @param currentOffset Container's current (x or y) offset\n * @return Offset to use to ensure the specified cell is visible\n */\nexport default function getUpdatedOffsetForIndex(_ref) {\n  var _ref$align = _ref.align,\n      align = _ref$align === undefined ? 'auto' : _ref$align,\n      cellOffset = _ref.cellOffset,\n      cellSize = _ref.cellSize,\n      containerSize = _ref.containerSize,\n      currentOffset = _ref.currentOffset;\n\n  var maxOffset = cellOffset;\n  var minOffset = maxOffset - containerSize + cellSize;\n\n  switch (align) {\n    case 'start':\n      return maxOffset;\n    case 'end':\n      return minOffset;\n    case 'center':\n      return maxOffset - (containerSize - cellSize) / 2;\n    default:\n      return Math.max(minOffset, Math.min(maxOffset, currentOffset));\n  }\n}","import _extends from 'babel-runtime/helpers/extends';\nimport _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _Object$getPrototypeOf from 'babel-runtime/core-js/object/get-prototype-of';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport PropTypes from 'prop-types';\nimport * as React from 'react';\nimport CollectionView from './CollectionView';\nimport _calculateSizeAndPositionData from './utils/calculateSizeAndPositionData';\nimport getUpdatedOffsetForIndex from '../utils/getUpdatedOffsetForIndex';\n\n/**\n * Renders scattered or non-linear data.\n * Unlike Grid, which renders checkerboard data, Collection can render arbitrarily positioned- even overlapping- data.\n */\nvar Collection = function (_React$PureComponent) {\n  _inherits(Collection, _React$PureComponent);\n\n  function Collection(props, context) {\n    _classCallCheck(this, Collection);\n\n    var _this = _possibleConstructorReturn(this, (Collection.__proto__ || _Object$getPrototypeOf(Collection)).call(this, props, context));\n\n    _this._cellMetadata = [];\n    _this._lastRenderedCellIndices = [];\n\n    // Cell cache during scroll (for perforamnce)\n    _this._cellCache = [];\n\n    _this._isScrollingChange = _this._isScrollingChange.bind(_this);\n    _this._setCollectionViewRef = _this._setCollectionViewRef.bind(_this);\n    return _this;\n  }\n\n  _createClass(Collection, [{\n    key: 'forceUpdate',\n    value: function forceUpdate() {\n      if (this._collectionView !== undefined) {\n        this._collectionView.forceUpdate();\n      }\n    }\n\n    /** See Collection#recomputeCellSizesAndPositions */\n\n  }, {\n    key: 'recomputeCellSizesAndPositions',\n    value: function recomputeCellSizesAndPositions() {\n      this._cellCache = [];\n      this._collectionView.recomputeCellSizesAndPositions();\n    }\n\n    /** React lifecycle methods */\n\n  }, {\n    key: 'render',\n    value: function render() {\n      var props = _objectWithoutProperties(this.props, []);\n\n      return React.createElement(CollectionView, _extends({\n        cellLayoutManager: this,\n        isScrollingChange: this._isScrollingChange,\n        ref: this._setCollectionViewRef\n      }, props));\n    }\n\n    /** CellLayoutManager interface */\n\n  }, {\n    key: 'calculateSizeAndPositionData',\n    value: function calculateSizeAndPositionData() {\n      var _props = this.props,\n          cellCount = _props.cellCount,\n          cellSizeAndPositionGetter = _props.cellSizeAndPositionGetter,\n          sectionSize = _props.sectionSize;\n\n\n      var data = _calculateSizeAndPositionData({\n        cellCount: cellCount,\n        cellSizeAndPositionGetter: cellSizeAndPositionGetter,\n        sectionSize: sectionSize\n      });\n\n      this._cellMetadata = data.cellMetadata;\n      this._sectionManager = data.sectionManager;\n      this._height = data.height;\n      this._width = data.width;\n    }\n\n    /**\n     * Returns the most recently rendered set of cell indices.\n     */\n\n  }, {\n    key: 'getLastRenderedIndices',\n    value: function getLastRenderedIndices() {\n      return this._lastRenderedCellIndices;\n    }\n\n    /**\n     * Calculates the minimum amount of change from the current scroll position to ensure the specified cell is (fully) visible.\n     */\n\n  }, {\n    key: 'getScrollPositionForCell',\n    value: function getScrollPositionForCell(_ref) {\n      var align = _ref.align,\n          cellIndex = _ref.cellIndex,\n          height = _ref.height,\n          scrollLeft = _ref.scrollLeft,\n          scrollTop = _ref.scrollTop,\n          width = _ref.width;\n      var cellCount = this.props.cellCount;\n\n\n      if (cellIndex >= 0 && cellIndex < cellCount) {\n        var cellMetadata = this._cellMetadata[cellIndex];\n\n        scrollLeft = getUpdatedOffsetForIndex({\n          align: align,\n          cellOffset: cellMetadata.x,\n          cellSize: cellMetadata.width,\n          containerSize: width,\n          currentOffset: scrollLeft,\n          targetIndex: cellIndex\n        });\n\n        scrollTop = getUpdatedOffsetForIndex({\n          align: align,\n          cellOffset: cellMetadata.y,\n          cellSize: cellMetadata.height,\n          containerSize: height,\n          currentOffset: scrollTop,\n          targetIndex: cellIndex\n        });\n      }\n\n      return {\n        scrollLeft: scrollLeft,\n        scrollTop: scrollTop\n      };\n    }\n  }, {\n    key: 'getTotalSize',\n    value: function getTotalSize() {\n      return {\n        height: this._height,\n        width: this._width\n      };\n    }\n  }, {\n    key: 'cellRenderers',\n    value: function cellRenderers(_ref2) {\n      var _this2 = this;\n\n      var height = _ref2.height,\n          isScrolling = _ref2.isScrolling,\n          width = _ref2.width,\n          x = _ref2.x,\n          y = _ref2.y;\n      var _props2 = this.props,\n          cellGroupRenderer = _props2.cellGroupRenderer,\n          cellRenderer = _props2.cellRenderer;\n\n      // Store for later calls to getLastRenderedIndices()\n\n      this._lastRenderedCellIndices = this._sectionManager.getCellIndices({\n        height: height,\n        width: width,\n        x: x,\n        y: y\n      });\n\n      return cellGroupRenderer({\n        cellCache: this._cellCache,\n        cellRenderer: cellRenderer,\n        cellSizeAndPositionGetter: function cellSizeAndPositionGetter(_ref3) {\n          var index = _ref3.index;\n          return _this2._sectionManager.getCellMetadata({ index: index });\n        },\n        indices: this._lastRenderedCellIndices,\n        isScrolling: isScrolling\n      });\n    }\n  }, {\n    key: '_isScrollingChange',\n    value: function _isScrollingChange(isScrolling) {\n      if (!isScrolling) {\n        this._cellCache = [];\n      }\n    }\n  }, {\n    key: '_setCollectionViewRef',\n    value: function _setCollectionViewRef(ref) {\n      this._collectionView = ref;\n    }\n  }]);\n\n  return Collection;\n}(React.PureComponent);\n\nCollection.defaultProps = {\n  'aria-label': 'grid',\n  cellGroupRenderer: defaultCellGroupRenderer\n};\nexport default Collection;\nCollection.propTypes = process.env.NODE_ENV !== \"production\" ? {\n  'aria-label': PropTypes.string,\n\n  /**\n   * Number of cells in Collection.\n   */\n  cellCount: PropTypes.number.isRequired,\n\n  /**\n   * Responsible for rendering a group of cells given their indices.\n   * Should implement the following interface: ({\n   *   cellSizeAndPositionGetter:Function,\n   *   indices: Array<number>,\n   *   cellRenderer: Function\n   * }): Array<PropTypes.node>\n   */\n  cellGroupRenderer: PropTypes.func.isRequired,\n\n  /**\n   * Responsible for rendering a cell given an row and column index.\n   * Should implement the following interface: ({ index: number, key: string, style: object }): PropTypes.element\n   */\n  cellRenderer: PropTypes.func.isRequired,\n\n  /**\n   * Callback responsible for returning size and offset/position information for a given cell (index).\n   * ({ index: number }): { height: number, width: number, x: number, y: number }\n   */\n  cellSizeAndPositionGetter: PropTypes.func.isRequired,\n\n  /**\n   * Optionally override the size of the sections a Collection's cells are split into.\n   */\n  sectionSize: PropTypes.number\n} : {};\n\n\nfunction defaultCellGroupRenderer(_ref4) {\n  var cellCache = _ref4.cellCache,\n      cellRenderer = _ref4.cellRenderer,\n      cellSizeAndPositionGetter = _ref4.cellSizeAndPositionGetter,\n      indices = _ref4.indices,\n      isScrolling = _ref4.isScrolling;\n\n  return indices.map(function (index) {\n    var cellMetadata = cellSizeAndPositionGetter({ index: index });\n\n    var cellRendererProps = {\n      index: index,\n      isScrolling: isScrolling,\n      key: index,\n      style: {\n        height: cellMetadata.height,\n        left: cellMetadata.x,\n        position: 'absolute',\n        top: cellMetadata.y,\n        width: cellMetadata.width\n      }\n    };\n\n    // Avoid re-creating cells while scrolling.\n    // This can lead to the same cell being created many times and can cause performance issues for \"heavy\" cells.\n    // If a scroll is in progress- cache and reuse cells.\n    // This cache will be thrown away once scrolling complets.\n    if (isScrolling) {\n      if (!(index in cellCache)) {\n        cellCache[index] = cellRenderer(cellRendererProps);\n      }\n\n      return cellCache[index];\n    } else {\n      return cellRenderer(cellRendererProps);\n    }\n  }).filter(function (renderedCell) {\n    return !!renderedCell;\n  });\n}\nimport { bpfrpt_proptype_ScrollPosition } from './types';\nimport { bpfrpt_proptype_SizeInfo } from './types';","\n\nexport default function calculateSizeAndPositionDataAndUpdateScrollOffset(_ref) {\n  var cellCount = _ref.cellCount,\n      cellSize = _ref.cellSize,\n      computeMetadataCallback = _ref.computeMetadataCallback,\n      computeMetadataCallbackProps = _ref.computeMetadataCallbackProps,\n      nextCellsCount = _ref.nextCellsCount,\n      nextCellSize = _ref.nextCellSize,\n      nextScrollToIndex = _ref.nextScrollToIndex,\n      scrollToIndex = _ref.scrollToIndex,\n      updateScrollOffsetForScrollToIndex = _ref.updateScrollOffsetForScrollToIndex;\n\n  // Don't compare cell sizes if they are functions because inline functions would cause infinite loops.\n  // In that event users should use the manual recompute methods to inform of changes.\n  if (cellCount !== nextCellsCount || (typeof cellSize === 'number' || typeof nextCellSize === 'number') && cellSize !== nextCellSize) {\n    computeMetadataCallback(computeMetadataCallbackProps);\n\n    // Updated cell metadata may have hidden the previous scrolled-to item.\n    // In this case we should also update the scrollTop to ensure it stays visible.\n    if (scrollToIndex >= 0 && scrollToIndex === nextScrollToIndex) {\n      updateScrollOffsetForScrollToIndex();\n    }\n  }\n}\n\n/**\n * Helper method that determines when to recalculate row or column metadata.\n */","import _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\n\n/**\n * Just-in-time calculates and caches size and position information for a collection of cells.\n */\n\nvar CellSizeAndPositionManager = function () {\n\n  // Used in deferred mode to track which cells have been queued for measurement.\n\n  // Cache of size and position data for cells, mapped by cell index.\n  // Note that invalid values may exist in this map so only rely on cells up to this._lastMeasuredIndex\n  function CellSizeAndPositionManager(_ref) {\n    var cellCount = _ref.cellCount,\n        cellSizeGetter = _ref.cellSizeGetter,\n        estimatedCellSize = _ref.estimatedCellSize;\n\n    _classCallCheck(this, CellSizeAndPositionManager);\n\n    this._cellSizeAndPositionData = {};\n    this._lastMeasuredIndex = -1;\n    this._lastBatchedIndex = -1;\n\n    this._cellSizeGetter = cellSizeGetter;\n    this._cellCount = cellCount;\n    this._estimatedCellSize = estimatedCellSize;\n  }\n\n  // Measurements for cells up to this index can be trusted; cells afterward should be estimated.\n\n\n  _createClass(CellSizeAndPositionManager, [{\n    key: 'areOffsetsAdjusted',\n    value: function areOffsetsAdjusted() {\n      return false;\n    }\n  }, {\n    key: 'configure',\n    value: function configure(_ref2) {\n      var cellCount = _ref2.cellCount,\n          estimatedCellSize = _ref2.estimatedCellSize,\n          cellSizeGetter = _ref2.cellSizeGetter;\n\n      this._cellCount = cellCount;\n      this._estimatedCellSize = estimatedCellSize;\n      this._cellSizeGetter = cellSizeGetter;\n    }\n  }, {\n    key: 'getCellCount',\n    value: function getCellCount() {\n      return this._cellCount;\n    }\n  }, {\n    key: 'getEstimatedCellSize',\n    value: function getEstimatedCellSize() {\n      return this._estimatedCellSize;\n    }\n  }, {\n    key: 'getLastMeasuredIndex',\n    value: function getLastMeasuredIndex() {\n      return this._lastMeasuredIndex;\n    }\n  }, {\n    key: 'getOffsetAdjustment',\n    value: function getOffsetAdjustment() {\n      return 0;\n    }\n\n    /**\n     * This method returns the size and position for the cell at the specified index.\n     * It just-in-time calculates (or used cached values) for cells leading up to the index.\n     */\n\n  }, {\n    key: 'getSizeAndPositionOfCell',\n    value: function getSizeAndPositionOfCell(index) {\n      if (index < 0 || index >= this._cellCount) {\n        throw Error('Requested index ' + index + ' is outside of range 0..' + this._cellCount);\n      }\n\n      if (index > this._lastMeasuredIndex) {\n        var lastMeasuredCellSizeAndPosition = this.getSizeAndPositionOfLastMeasuredCell();\n        var _offset = lastMeasuredCellSizeAndPosition.offset + lastMeasuredCellSizeAndPosition.size;\n\n        for (var i = this._lastMeasuredIndex + 1; i <= index; i++) {\n          var _size = this._cellSizeGetter({ index: i });\n\n          // undefined or NaN probably means a logic error in the size getter.\n          // null means we're using CellMeasurer and haven't yet measured a given index.\n          if (_size === undefined || isNaN(_size)) {\n            throw Error('Invalid size returned for cell ' + i + ' of value ' + _size);\n          } else if (_size === null) {\n            this._cellSizeAndPositionData[i] = {\n              offset: _offset,\n              size: 0\n            };\n\n            this._lastBatchedIndex = index;\n          } else {\n            this._cellSizeAndPositionData[i] = {\n              offset: _offset,\n              size: _size\n            };\n\n            _offset += _size;\n\n            this._lastMeasuredIndex = index;\n          }\n        }\n      }\n\n      return this._cellSizeAndPositionData[index];\n    }\n  }, {\n    key: 'getSizeAndPositionOfLastMeasuredCell',\n    value: function getSizeAndPositionOfLastMeasuredCell() {\n      return this._lastMeasuredIndex >= 0 ? this._cellSizeAndPositionData[this._lastMeasuredIndex] : {\n        offset: 0,\n        size: 0\n      };\n    }\n\n    /**\n     * Total size of all cells being measured.\n     * This value will be completely estimated initially.\n     * As cells are measured, the estimate will be updated.\n     */\n\n  }, {\n    key: 'getTotalSize',\n    value: function getTotalSize() {\n      var lastMeasuredCellSizeAndPosition = this.getSizeAndPositionOfLastMeasuredCell();\n      var totalSizeOfMeasuredCells = lastMeasuredCellSizeAndPosition.offset + lastMeasuredCellSizeAndPosition.size;\n      var numUnmeasuredCells = this._cellCount - this._lastMeasuredIndex - 1;\n      var totalSizeOfUnmeasuredCells = numUnmeasuredCells * this._estimatedCellSize;\n      return totalSizeOfMeasuredCells + totalSizeOfUnmeasuredCells;\n    }\n\n    /**\n     * Determines a new offset that ensures a certain cell is visible, given the current offset.\n     * If the cell is already visible then the current offset will be returned.\n     * If the current offset is too great or small, it will be adjusted just enough to ensure the specified index is visible.\n     *\n     * @param align Desired alignment within container; one of \"auto\" (default), \"start\", or \"end\"\n     * @param containerSize Size (width or height) of the container viewport\n     * @param currentOffset Container's current (x or y) offset\n     * @param totalSize Total size (width or height) of all cells\n     * @return Offset to use to ensure the specified cell is visible\n     */\n\n  }, {\n    key: 'getUpdatedOffsetForIndex',\n    value: function getUpdatedOffsetForIndex(_ref3) {\n      var _ref3$align = _ref3.align,\n          align = _ref3$align === undefined ? 'auto' : _ref3$align,\n          containerSize = _ref3.containerSize,\n          currentOffset = _ref3.currentOffset,\n          targetIndex = _ref3.targetIndex;\n\n      if (containerSize <= 0) {\n        return 0;\n      }\n\n      var datum = this.getSizeAndPositionOfCell(targetIndex);\n      var maxOffset = datum.offset;\n      var minOffset = maxOffset - containerSize + datum.size;\n\n      var idealOffset = void 0;\n\n      switch (align) {\n        case 'start':\n          idealOffset = maxOffset;\n          break;\n        case 'end':\n          idealOffset = minOffset;\n          break;\n        case 'center':\n          idealOffset = maxOffset - (containerSize - datum.size) / 2;\n          break;\n        default:\n          idealOffset = Math.max(minOffset, Math.min(maxOffset, currentOffset));\n          break;\n      }\n\n      var totalSize = this.getTotalSize();\n\n      return Math.max(0, Math.min(totalSize - containerSize, idealOffset));\n    }\n  }, {\n    key: 'getVisibleCellRange',\n    value: function getVisibleCellRange(params) {\n      var containerSize = params.containerSize,\n          offset = params.offset;\n\n\n      var totalSize = this.getTotalSize();\n\n      if (totalSize === 0) {\n        return {};\n      }\n\n      var maxOffset = offset + containerSize;\n      var start = this._findNearestCell(offset);\n\n      var datum = this.getSizeAndPositionOfCell(start);\n      offset = datum.offset + datum.size;\n\n      var stop = start;\n\n      while (offset < maxOffset && stop < this._cellCount - 1) {\n        stop++;\n\n        offset += this.getSizeAndPositionOfCell(stop).size;\n      }\n\n      return {\n        start: start,\n        stop: stop\n      };\n    }\n\n    /**\n     * Clear all cached values for cells after the specified index.\n     * This method should be called for any cell that has changed its size.\n     * It will not immediately perform any calculations; they'll be performed the next time getSizeAndPositionOfCell() is called.\n     */\n\n  }, {\n    key: 'resetCell',\n    value: function resetCell(index) {\n      this._lastMeasuredIndex = Math.min(this._lastMeasuredIndex, index - 1);\n    }\n  }, {\n    key: '_binarySearch',\n    value: function _binarySearch(high, low, offset) {\n      while (low <= high) {\n        var middle = low + Math.floor((high - low) / 2);\n        var _currentOffset = this.getSizeAndPositionOfCell(middle).offset;\n\n        if (_currentOffset === offset) {\n          return middle;\n        } else if (_currentOffset < offset) {\n          low = middle + 1;\n        } else if (_currentOffset > offset) {\n          high = middle - 1;\n        }\n      }\n\n      if (low > 0) {\n        return low - 1;\n      } else {\n        return 0;\n      }\n    }\n  }, {\n    key: '_exponentialSearch',\n    value: function _exponentialSearch(index, offset) {\n      var interval = 1;\n\n      while (index < this._cellCount && this.getSizeAndPositionOfCell(index).offset < offset) {\n        index += interval;\n        interval *= 2;\n      }\n\n      return this._binarySearch(Math.min(index, this._cellCount - 1), Math.floor(index / 2), offset);\n    }\n\n    /**\n     * Searches for the cell (index) nearest the specified offset.\n     *\n     * If no exact match is found the next lowest cell index will be returned.\n     * This allows partially visible cells (with offsets just before/above the fold) to be visible.\n     */\n\n  }, {\n    key: '_findNearestCell',\n    value: function _findNearestCell(offset) {\n      if (isNaN(offset)) {\n        throw Error('Invalid offset ' + offset + ' specified');\n      }\n\n      // Our search algorithms find the nearest match at or below the specified offset.\n      // So make sure the offset is at least 0 or no match will be found.\n      offset = Math.max(0, offset);\n\n      var lastMeasuredCellSizeAndPosition = this.getSizeAndPositionOfLastMeasuredCell();\n      var lastMeasuredIndex = Math.max(0, this._lastMeasuredIndex);\n\n      if (lastMeasuredCellSizeAndPosition.offset >= offset) {\n        // If we've already measured cells within this range just use a binary search as it's faster.\n        return this._binarySearch(lastMeasuredIndex, 0, offset);\n      } else {\n        // If we haven't yet measured this high, fallback to an exponential search with an inner binary search.\n        // The exponential search avoids pre-computing sizes for the full set of cells as a binary search would.\n        // The overall complexity for this approach is O(log n).\n        return this._exponentialSearch(lastMeasuredIndex, offset);\n      }\n    }\n  }]);\n\n  return CellSizeAndPositionManager;\n}();\n\nexport default CellSizeAndPositionManager;\nimport { bpfrpt_proptype_Alignment } from '../types';\nimport { bpfrpt_proptype_CellSizeGetter } from '../types';\nimport { bpfrpt_proptype_VisibleCellRange } from '../types';","\n\nexport var SCROLL_DIRECTION_BACKWARD = -1;\n\nexport var SCROLL_DIRECTION_FORWARD = 1;\n\nexport var SCROLL_DIRECTION_HORIZONTAL = 'horizontal';\nexport var SCROLL_DIRECTION_VERTICAL = 'vertical';\n\n/**\n * Calculates the number of cells to overscan before and after a specified range.\n * This function ensures that overscanning doesn't exceed the available cells.\n */\n\nexport default function defaultOverscanIndicesGetter(_ref) {\n  var cellCount = _ref.cellCount,\n      overscanCellsCount = _ref.overscanCellsCount,\n      scrollDirection = _ref.scrollDirection,\n      startIndex = _ref.startIndex,\n      stopIndex = _ref.stopIndex;\n\n  if (scrollDirection === SCROLL_DIRECTION_FORWARD) {\n    return {\n      overscanStartIndex: Math.max(0, startIndex),\n      overscanStopIndex: Math.min(cellCount - 1, stopIndex + overscanCellsCount)\n    };\n  } else {\n    return {\n      overscanStartIndex: Math.max(0, startIndex - overscanCellsCount),\n      overscanStopIndex: Math.min(cellCount - 1, stopIndex)\n    };\n  }\n}\nimport { bpfrpt_proptype_OverscanIndicesGetterParams } from './types';\nimport { bpfrpt_proptype_OverscanIndices } from './types';","\n\nimport ScalingCellSizeAndPositionManager from './ScalingCellSizeAndPositionManager.js';\n\n/**\n * Helper function that determines when to update scroll offsets to ensure that a scroll-to-index remains visible.\n * This function also ensures that the scroll ofset isn't past the last column/row of cells.\n */\n\nexport default function updateScrollIndexHelper(_ref) {\n  var cellSize = _ref.cellSize,\n      cellSizeAndPositionManager = _ref.cellSizeAndPositionManager,\n      previousCellsCount = _ref.previousCellsCount,\n      previousCellSize = _ref.previousCellSize,\n      previousScrollToAlignment = _ref.previousScrollToAlignment,\n      previousScrollToIndex = _ref.previousScrollToIndex,\n      previousSize = _ref.previousSize,\n      scrollOffset = _ref.scrollOffset,\n      scrollToAlignment = _ref.scrollToAlignment,\n      scrollToIndex = _ref.scrollToIndex,\n      size = _ref.size,\n      sizeJustIncreasedFromZero = _ref.sizeJustIncreasedFromZero,\n      updateScrollIndexCallback = _ref.updateScrollIndexCallback;\n\n  var cellCount = cellSizeAndPositionManager.getCellCount();\n  var hasScrollToIndex = scrollToIndex >= 0 && scrollToIndex < cellCount;\n  var sizeHasChanged = size !== previousSize || sizeJustIncreasedFromZero || !previousCellSize || typeof cellSize === 'number' && cellSize !== previousCellSize;\n\n  // If we have a new scroll target OR if height/row-height has changed,\n  // We should ensure that the scroll target is visible.\n  if (hasScrollToIndex && (sizeHasChanged || scrollToAlignment !== previousScrollToAlignment || scrollToIndex !== previousScrollToIndex)) {\n    updateScrollIndexCallback(scrollToIndex);\n\n    // If we don't have a selected item but list size or number of children have decreased,\n    // Make sure we aren't scrolled too far past the current content.\n  } else if (!hasScrollToIndex && cellCount > 0 && (size < previousSize || cellCount < previousCellsCount)) {\n    // We need to ensure that the current scroll offset is still within the collection's range.\n    // To do this, we don't need to measure everything; CellMeasurer would perform poorly.\n    // Just check to make sure we're still okay.\n    // Only adjust the scroll position if we've scrolled below the last set of rows.\n    if (scrollOffset > cellSizeAndPositionManager.getTotalSize() - size) {\n      updateScrollIndexCallback(cellCount - 1);\n    }\n  }\n}\nimport { bpfrpt_proptype_Alignment } from '../types';\nimport { bpfrpt_proptype_CellSize } from '../types';","\n\n/**\n * Default implementation of cellRangeRenderer used by Grid.\n * This renderer supports cell-caching while the user is scrolling.\n */\n\nexport default function defaultCellRangeRenderer(_ref) {\n  var cellCache = _ref.cellCache,\n      cellRenderer = _ref.cellRenderer,\n      columnSizeAndPositionManager = _ref.columnSizeAndPositionManager,\n      columnStartIndex = _ref.columnStartIndex,\n      columnStopIndex = _ref.columnStopIndex,\n      deferredMeasurementCache = _ref.deferredMeasurementCache,\n      horizontalOffsetAdjustment = _ref.horizontalOffsetAdjustment,\n      isScrolling = _ref.isScrolling,\n      isScrollingOptOut = _ref.isScrollingOptOut,\n      parent = _ref.parent,\n      rowSizeAndPositionManager = _ref.rowSizeAndPositionManager,\n      rowStartIndex = _ref.rowStartIndex,\n      rowStopIndex = _ref.rowStopIndex,\n      styleCache = _ref.styleCache,\n      verticalOffsetAdjustment = _ref.verticalOffsetAdjustment,\n      visibleColumnIndices = _ref.visibleColumnIndices,\n      visibleRowIndices = _ref.visibleRowIndices;\n\n  var renderedCells = [];\n\n  // Browsers have native size limits for elements (eg Chrome 33M pixels, IE 1.5M pixes).\n  // User cannot scroll beyond these size limitations.\n  // In order to work around this, ScalingCellSizeAndPositionManager compresses offsets.\n  // We should never cache styles for compressed offsets though as this can lead to bugs.\n  // See issue #576 for more.\n  var areOffsetsAdjusted = columnSizeAndPositionManager.areOffsetsAdjusted() || rowSizeAndPositionManager.areOffsetsAdjusted();\n\n  var canCacheStyle = !isScrolling && !areOffsetsAdjusted;\n\n  for (var rowIndex = rowStartIndex; rowIndex <= rowStopIndex; rowIndex++) {\n    var rowDatum = rowSizeAndPositionManager.getSizeAndPositionOfCell(rowIndex);\n\n    for (var columnIndex = columnStartIndex; columnIndex <= columnStopIndex; columnIndex++) {\n      var columnDatum = columnSizeAndPositionManager.getSizeAndPositionOfCell(columnIndex);\n      var isVisible = columnIndex >= visibleColumnIndices.start && columnIndex <= visibleColumnIndices.stop && rowIndex >= visibleRowIndices.start && rowIndex <= visibleRowIndices.stop;\n      var key = rowIndex + '-' + columnIndex;\n      var style = void 0;\n\n      // Cache style objects so shallow-compare doesn't re-render unnecessarily.\n      if (canCacheStyle && styleCache[key]) {\n        style = styleCache[key];\n      } else {\n        // In deferred mode, cells will be initially rendered before we know their size.\n        // Don't interfere with CellMeasurer's measurements by setting an invalid size.\n        if (deferredMeasurementCache && !deferredMeasurementCache.has(rowIndex, columnIndex)) {\n          // Position not-yet-measured cells at top/left 0,0,\n          // And give them width/height of 'auto' so they can grow larger than the parent Grid if necessary.\n          // Positioning them further to the right/bottom influences their measured size.\n          style = {\n            height: 'auto',\n            left: 0,\n            position: 'absolute',\n            top: 0,\n            width: 'auto'\n          };\n        } else {\n          style = {\n            height: rowDatum.size,\n            left: columnDatum.offset + horizontalOffsetAdjustment,\n            position: 'absolute',\n            top: rowDatum.offset + verticalOffsetAdjustment,\n            width: columnDatum.size\n          };\n\n          styleCache[key] = style;\n        }\n      }\n\n      var cellRendererParams = {\n        columnIndex: columnIndex,\n        isScrolling: isScrolling,\n        isVisible: isVisible,\n        key: key,\n        parent: parent,\n        rowIndex: rowIndex,\n        style: style\n      };\n\n      var renderedCell = void 0;\n\n      // Avoid re-creating cells while scrolling.\n      // This can lead to the same cell being created many times and can cause performance issues for \"heavy\" cells.\n      // If a scroll is in progress- cache and reuse cells.\n      // This cache will be thrown away once scrolling completes.\n      // However if we are scaling scroll positions and sizes, we should also avoid caching.\n      // This is because the offset changes slightly as scroll position changes and caching leads to stale values.\n      // For more info refer to issue #395\n      //\n      // If isScrollingOptOut is specified, we always cache cells.\n      // For more info refer to issue #1028\n      if ((isScrollingOptOut || isScrolling) && !horizontalOffsetAdjustment && !verticalOffsetAdjustment) {\n        if (!cellCache[key]) {\n          cellCache[key] = cellRenderer(cellRendererParams);\n        }\n\n        renderedCell = cellCache[key];\n\n        // If the user is no longer scrolling, don't cache cells.\n        // This makes dynamic cell content difficult for users and would also lead to a heavier memory footprint.\n      } else {\n        renderedCell = cellRenderer(cellRendererParams);\n      }\n\n      if (renderedCell == null || renderedCell === false) {\n        continue;\n      }\n\n      if (process.env.NODE_ENV !== 'production') {\n        warnAboutMissingStyle(parent, renderedCell);\n      }\n\n      renderedCells.push(renderedCell);\n    }\n  }\n\n  return renderedCells;\n}\n\nfunction warnAboutMissingStyle(parent, renderedCell) {\n  if (process.env.NODE_ENV !== 'production') {\n    if (renderedCell) {\n      // If the direct child is a CellMeasurer, then we should check its child\n      // See issue #611\n      if (renderedCell.type && renderedCell.type.__internalCellMeasurerFlag) {\n        renderedCell = renderedCell.props.children;\n      }\n\n      if (renderedCell && renderedCell.props && renderedCell.props.style === undefined && parent.__warnedAboutMissingStyle !== true) {\n        parent.__warnedAboutMissingStyle = true;\n\n        console.warn('Rendered cell should include style property for positioning.');\n      }\n    }\n  }\n}\nimport { bpfrpt_proptype_CellRangeRendererParams } from './types';","\n\n// Properly handle server-side rendering.\nvar win = void 0;\n\nif (typeof window !== 'undefined') {\n  win = window;\n} else if (typeof self !== 'undefined') {\n  win = self;\n} else {\n  win = {};\n}\n\n// requestAnimationFrame() shim by Paul Irish\n// http://paulirish.com/2011/requestanimationframe-for-smart-animating/\nvar request = win.requestAnimationFrame || win.webkitRequestAnimationFrame || win.mozRequestAnimationFrame || win.oRequestAnimationFrame || win.msRequestAnimationFrame || function (callback) {\n  return win.setTimeout(callback, 1000 / 60);\n};\n\nvar cancel = win.cancelAnimationFrame || win.webkitCancelAnimationFrame || win.mozCancelAnimationFrame || win.oCancelAnimationFrame || win.msCancelAnimationFrame || function (id) {\n  win.clearTimeout(id);\n};\n\nexport var raf = request;\nexport var caf = cancel;","\n\nexport var SCROLL_DIRECTION_BACKWARD = -1;\n\nexport var SCROLL_DIRECTION_FORWARD = 1;\n\nexport var SCROLL_DIRECTION_HORIZONTAL = 'horizontal';\nexport var SCROLL_DIRECTION_VERTICAL = 'vertical';\n\n/**\n * Calculates the number of cells to overscan before and after a specified range.\n * This function ensures that overscanning doesn't exceed the available cells.\n */\n\nexport default function defaultOverscanIndicesGetter(_ref) {\n  var cellCount = _ref.cellCount,\n      overscanCellsCount = _ref.overscanCellsCount,\n      scrollDirection = _ref.scrollDirection,\n      startIndex = _ref.startIndex,\n      stopIndex = _ref.stopIndex;\n\n  // Make sure we render at least 1 cell extra before and after (except near boundaries)\n  // This is necessary in order to support keyboard navigation (TAB/SHIFT+TAB) in some cases\n  // For more info see issues #625\n  overscanCellsCount = Math.max(1, overscanCellsCount);\n\n  if (scrollDirection === SCROLL_DIRECTION_FORWARD) {\n    return {\n      overscanStartIndex: Math.max(0, startIndex - 1),\n      overscanStopIndex: Math.min(cellCount - 1, stopIndex + overscanCellsCount)\n    };\n  } else {\n    return {\n      overscanStartIndex: Math.max(0, startIndex - overscanCellsCount),\n      overscanStopIndex: Math.min(cellCount - 1, stopIndex + 1)\n    };\n  }\n}\nimport { bpfrpt_proptype_OverscanIndicesGetterParams } from './types';\nimport { bpfrpt_proptype_OverscanIndices } from './types';","import _Object$getPrototypeOf from 'babel-runtime/core-js/object/get-prototype-of';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport createCallbackMemoizer from '../utils/createCallbackMemoizer';\n\n/**\n * Higher-order component that manages lazy-loading for \"infinite\" data.\n * This component decorates a virtual component and just-in-time prefetches rows as a user scrolls.\n * It is intended as a convenience component; fork it if you'd like finer-grained control over data-loading.\n */\n\nvar InfiniteLoader = function (_React$PureComponent) {\n  _inherits(InfiniteLoader, _React$PureComponent);\n\n  function InfiniteLoader(props, context) {\n    _classCallCheck(this, InfiniteLoader);\n\n    var _this = _possibleConstructorReturn(this, (InfiniteLoader.__proto__ || _Object$getPrototypeOf(InfiniteLoader)).call(this, props, context));\n\n    _this._loadMoreRowsMemoizer = createCallbackMemoizer();\n\n    _this._onRowsRendered = _this._onRowsRendered.bind(_this);\n    _this._registerChild = _this._registerChild.bind(_this);\n    return _this;\n  }\n\n  _createClass(InfiniteLoader, [{\n    key: 'resetLoadMoreRowsCache',\n    value: function resetLoadMoreRowsCache(autoReload) {\n      this._loadMoreRowsMemoizer = createCallbackMemoizer();\n\n      if (autoReload) {\n        this._doStuff(this._lastRenderedStartIndex, this._lastRenderedStopIndex);\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var children = this.props.children;\n\n\n      return children({\n        onRowsRendered: this._onRowsRendered,\n        registerChild: this._registerChild\n      });\n    }\n  }, {\n    key: '_loadUnloadedRanges',\n    value: function _loadUnloadedRanges(unloadedRanges) {\n      var _this2 = this;\n\n      var loadMoreRows = this.props.loadMoreRows;\n\n\n      unloadedRanges.forEach(function (unloadedRange) {\n        var promise = loadMoreRows(unloadedRange);\n        if (promise) {\n          promise.then(function () {\n            // Refresh the visible rows if any of them have just been loaded.\n            // Otherwise they will remain in their unloaded visual state.\n            if (isRangeVisible({\n              lastRenderedStartIndex: _this2._lastRenderedStartIndex,\n              lastRenderedStopIndex: _this2._lastRenderedStopIndex,\n              startIndex: unloadedRange.startIndex,\n              stopIndex: unloadedRange.stopIndex\n            })) {\n              if (_this2._registeredChild) {\n                forceUpdateReactVirtualizedComponent(_this2._registeredChild, _this2._lastRenderedStartIndex);\n              }\n            }\n          });\n        }\n      });\n    }\n  }, {\n    key: '_onRowsRendered',\n    value: function _onRowsRendered(_ref) {\n      var startIndex = _ref.startIndex,\n          stopIndex = _ref.stopIndex;\n\n      this._lastRenderedStartIndex = startIndex;\n      this._lastRenderedStopIndex = stopIndex;\n\n      this._doStuff(startIndex, stopIndex);\n    }\n  }, {\n    key: '_doStuff',\n    value: function _doStuff(startIndex, stopIndex) {\n      var _this3 = this;\n\n      var _props = this.props,\n          isRowLoaded = _props.isRowLoaded,\n          minimumBatchSize = _props.minimumBatchSize,\n          rowCount = _props.rowCount,\n          threshold = _props.threshold;\n\n\n      var unloadedRanges = scanForUnloadedRanges({\n        isRowLoaded: isRowLoaded,\n        minimumBatchSize: minimumBatchSize,\n        rowCount: rowCount,\n        startIndex: Math.max(0, startIndex - threshold),\n        stopIndex: Math.min(rowCount - 1, stopIndex + threshold)\n      });\n\n      // For memoize comparison\n      var squashedUnloadedRanges = unloadedRanges.reduce(function (reduced, unloadedRange) {\n        return reduced.concat([unloadedRange.startIndex, unloadedRange.stopIndex]);\n      }, []);\n\n      this._loadMoreRowsMemoizer({\n        callback: function callback() {\n          _this3._loadUnloadedRanges(unloadedRanges);\n        },\n        indices: { squashedUnloadedRanges: squashedUnloadedRanges }\n      });\n    }\n  }, {\n    key: '_registerChild',\n    value: function _registerChild(registeredChild) {\n      this._registeredChild = registeredChild;\n    }\n  }]);\n\n  return InfiniteLoader;\n}(React.PureComponent);\n\n/**\n * Determines if the specified start/stop range is visible based on the most recently rendered range.\n */\n\n\nInfiniteLoader.defaultProps = {\n  minimumBatchSize: 10,\n  rowCount: 0,\n  threshold: 15\n};\nexport default InfiniteLoader;\nInfiniteLoader.propTypes = process.env.NODE_ENV !== \"production\" ? {\n  /**\n   * Function responsible for rendering a virtualized component.\n   * This function should implement the following signature:\n   * ({ onRowsRendered, registerChild }) => PropTypes.element\n   *\n   * The specified :onRowsRendered function should be passed through to the child's :onRowsRendered property.\n   * The :registerChild callback should be set as the virtualized component's :ref.\n   */\n  children: PropTypes.func.isRequired,\n\n  /**\n   * Function responsible for tracking the loaded state of each row.\n   * It should implement the following signature: ({ index: number }): boolean\n   */\n  isRowLoaded: PropTypes.func.isRequired,\n\n  /**\n   * Callback to be invoked when more rows must be loaded.\n   * It should implement the following signature: ({ startIndex, stopIndex }): Promise\n   * The returned Promise should be resolved once row data has finished loading.\n   * It will be used to determine when to refresh the list with the newly-loaded data.\n   * This callback may be called multiple times in reaction to a single scroll event.\n   */\n  loadMoreRows: PropTypes.func.isRequired,\n\n  /**\n   * Minimum number of rows to be loaded at a time.\n   * This property can be used to batch requests to reduce HTTP requests.\n   */\n  minimumBatchSize: PropTypes.number.isRequired,\n\n  /**\n   * Number of rows in list; can be arbitrary high number if actual number is unknown.\n   */\n  rowCount: PropTypes.number.isRequired,\n\n  /**\n   * Threshold at which to pre-fetch data.\n   * A threshold X means that data will start loading when a user scrolls within X rows.\n   * This value defaults to 15.\n   */\n  threshold: PropTypes.number.isRequired\n} : {};\nexport function isRangeVisible(_ref2) {\n  var lastRenderedStartIndex = _ref2.lastRenderedStartIndex,\n      lastRenderedStopIndex = _ref2.lastRenderedStopIndex,\n      startIndex = _ref2.startIndex,\n      stopIndex = _ref2.stopIndex;\n\n  return !(startIndex > lastRenderedStopIndex || stopIndex < lastRenderedStartIndex);\n}\n\n/**\n * Returns all of the ranges within a larger range that contain unloaded rows.\n */\nexport function scanForUnloadedRanges(_ref3) {\n  var isRowLoaded = _ref3.isRowLoaded,\n      minimumBatchSize = _ref3.minimumBatchSize,\n      rowCount = _ref3.rowCount,\n      startIndex = _ref3.startIndex,\n      stopIndex = _ref3.stopIndex;\n\n  var unloadedRanges = [];\n\n  var rangeStartIndex = null;\n  var rangeStopIndex = null;\n\n  for (var index = startIndex; index <= stopIndex; index++) {\n    var loaded = isRowLoaded({ index: index });\n\n    if (!loaded) {\n      rangeStopIndex = index;\n      if (rangeStartIndex === null) {\n        rangeStartIndex = index;\n      }\n    } else if (rangeStopIndex !== null) {\n      unloadedRanges.push({\n        startIndex: rangeStartIndex,\n        stopIndex: rangeStopIndex\n      });\n\n      rangeStartIndex = rangeStopIndex = null;\n    }\n  }\n\n  // If :rangeStopIndex is not null it means we haven't ran out of unloaded rows.\n  // Scan forward to try filling our :minimumBatchSize.\n  if (rangeStopIndex !== null) {\n    var potentialStopIndex = Math.min(Math.max(rangeStopIndex, rangeStartIndex + minimumBatchSize - 1), rowCount - 1);\n\n    for (var _index = rangeStopIndex + 1; _index <= potentialStopIndex; _index++) {\n      if (!isRowLoaded({ index: _index })) {\n        rangeStopIndex = _index;\n      } else {\n        break;\n      }\n    }\n\n    unloadedRanges.push({\n      startIndex: rangeStartIndex,\n      stopIndex: rangeStopIndex\n    });\n  }\n\n  // Check to see if our first range ended prematurely.\n  // In this case we should scan backwards to try filling our :minimumBatchSize.\n  if (unloadedRanges.length) {\n    var firstUnloadedRange = unloadedRanges[0];\n\n    while (firstUnloadedRange.stopIndex - firstUnloadedRange.startIndex + 1 < minimumBatchSize && firstUnloadedRange.startIndex > 0) {\n      var _index2 = firstUnloadedRange.startIndex - 1;\n\n      if (!isRowLoaded({ index: _index2 })) {\n        firstUnloadedRange.startIndex = _index2;\n      } else {\n        break;\n      }\n    }\n  }\n\n  return unloadedRanges;\n}\n\n/**\n * Since RV components use shallowCompare we need to force a render (even though props haven't changed).\n * However InfiniteLoader may wrap a Grid or it may wrap a Table or List.\n * In the first case the built-in React forceUpdate() method is sufficient to force a re-render,\n * But in the latter cases we need to use the RV-specific forceUpdateGrid() method.\n * Else the inner Grid will not be re-rendered and visuals may be stale.\n *\n * Additionally, while a Grid is scrolling the cells can be cached,\n * So it's important to invalidate that cache by recalculating sizes\n * before forcing a rerender.\n */\nexport function forceUpdateReactVirtualizedComponent(component) {\n  var currentIndex = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n  var recomputeSize = typeof component.recomputeGridSize === 'function' ? component.recomputeGridSize : component.recomputeRowHeights;\n\n  if (recomputeSize) {\n    recomputeSize.call(component, currentIndex);\n  } else {\n    component.forceUpdate();\n  }\n}","import InfiniteLoader from './InfiniteLoader';\n\nexport default InfiniteLoader;\nexport { InfiniteLoader };","\n\nexport default function createCellPositioner(_ref) {\n  var cellMeasurerCache = _ref.cellMeasurerCache,\n      columnCount = _ref.columnCount,\n      columnWidth = _ref.columnWidth,\n      _ref$spacer = _ref.spacer,\n      spacer = _ref$spacer === undefined ? 0 : _ref$spacer;\n\n  var columnHeights = void 0;\n\n  initOrResetDerivedValues();\n\n  function cellPositioner(index) {\n    // Find the shortest column and use it.\n    var columnIndex = 0;\n    for (var i = 1; i < columnHeights.length; i++) {\n      if (columnHeights[i] < columnHeights[columnIndex]) {\n        columnIndex = i;\n      }\n    }\n\n    var left = columnIndex * (columnWidth + spacer);\n    var top = columnHeights[columnIndex] || 0;\n\n    columnHeights[columnIndex] = top + cellMeasurerCache.getHeight(index) + spacer;\n\n    return {\n      left: left,\n      top: top\n    };\n  }\n\n  function initOrResetDerivedValues() {\n    // Track the height of each column.\n    // Layout algorithm below always inserts into the shortest column.\n    columnHeights = [];\n    for (var i = 0; i < columnCount; i++) {\n      columnHeights[i] = 0;\n    }\n  }\n\n  function reset(params) {\n    columnCount = params.columnCount;\n    columnWidth = params.columnWidth;\n    spacer = params.spacer;\n\n    initOrResetDerivedValues();\n  }\n\n  cellPositioner.reset = reset;\n\n  return cellPositioner;\n}\nimport { bpfrpt_proptype_CellMeasurerCache } from './Masonry';\nimport { bpfrpt_proptype_Positioner } from './Masonry';","/**\n * Binary Search Bounds\n * https://github.com/mikolalysenko/binary-search-bounds\n * Mikola Lysenko\n *\n * Inlined because of Content Security Policy issue caused by the use of `new Function(...)` syntax.\n * Issue reported here: https://github.com/mikolalysenko/binary-search-bounds/issues/5\n **/\n\nfunction _GEA(a, l, h, y) {\n  var i = h + 1;\n  while (l <= h) {\n    var m = l + h >>> 1,\n        x = a[m];\n    if (x >= y) {\n      i = m;\n      h = m - 1;\n    } else {\n      l = m + 1;\n    }\n  }\n  return i;\n}\nfunction _GEP(a, l, h, y, c) {\n  var i = h + 1;\n  while (l <= h) {\n    var m = l + h >>> 1,\n        x = a[m];\n    if (c(x, y) >= 0) {\n      i = m;\n      h = m - 1;\n    } else {\n      l = m + 1;\n    }\n  }\n  return i;\n}\nfunction dispatchBsearchGE(a, y, c, l, h) {\n  if (typeof c === 'function') {\n    return _GEP(a, l === void 0 ? 0 : l | 0, h === void 0 ? a.length - 1 : h | 0, y, c);\n  } else {\n    return _GEA(a, c === void 0 ? 0 : c | 0, l === void 0 ? a.length - 1 : l | 0, y);\n  }\n}\n\nfunction _GTA(a, l, h, y) {\n  var i = h + 1;\n  while (l <= h) {\n    var m = l + h >>> 1,\n        x = a[m];\n    if (x > y) {\n      i = m;\n      h = m - 1;\n    } else {\n      l = m + 1;\n    }\n  }\n  return i;\n}\nfunction _GTP(a, l, h, y, c) {\n  var i = h + 1;\n  while (l <= h) {\n    var m = l + h >>> 1,\n        x = a[m];\n    if (c(x, y) > 0) {\n      i = m;\n      h = m - 1;\n    } else {\n      l = m + 1;\n    }\n  }\n  return i;\n}\nfunction dispatchBsearchGT(a, y, c, l, h) {\n  if (typeof c === 'function') {\n    return _GTP(a, l === void 0 ? 0 : l | 0, h === void 0 ? a.length - 1 : h | 0, y, c);\n  } else {\n    return _GTA(a, c === void 0 ? 0 : c | 0, l === void 0 ? a.length - 1 : l | 0, y);\n  }\n}\n\nfunction _LTA(a, l, h, y) {\n  var i = l - 1;\n  while (l <= h) {\n    var m = l + h >>> 1,\n        x = a[m];\n    if (x < y) {\n      i = m;\n      l = m + 1;\n    } else {\n      h = m - 1;\n    }\n  }\n  return i;\n}\nfunction _LTP(a, l, h, y, c) {\n  var i = l - 1;\n  while (l <= h) {\n    var m = l + h >>> 1,\n        x = a[m];\n    if (c(x, y) < 0) {\n      i = m;\n      l = m + 1;\n    } else {\n      h = m - 1;\n    }\n  }\n  return i;\n}\nfunction dispatchBsearchLT(a, y, c, l, h) {\n  if (typeof c === 'function') {\n    return _LTP(a, l === void 0 ? 0 : l | 0, h === void 0 ? a.length - 1 : h | 0, y, c);\n  } else {\n    return _LTA(a, c === void 0 ? 0 : c | 0, l === void 0 ? a.length - 1 : l | 0, y);\n  }\n}\n\nfunction _LEA(a, l, h, y) {\n  var i = l - 1;\n  while (l <= h) {\n    var m = l + h >>> 1,\n        x = a[m];\n    if (x <= y) {\n      i = m;\n      l = m + 1;\n    } else {\n      h = m - 1;\n    }\n  }\n  return i;\n}\nfunction _LEP(a, l, h, y, c) {\n  var i = l - 1;\n  while (l <= h) {\n    var m = l + h >>> 1,\n        x = a[m];\n    if (c(x, y) <= 0) {\n      i = m;\n      l = m + 1;\n    } else {\n      h = m - 1;\n    }\n  }\n  return i;\n}\nfunction dispatchBsearchLE(a, y, c, l, h) {\n  if (typeof c === 'function') {\n    return _LEP(a, l === void 0 ? 0 : l | 0, h === void 0 ? a.length - 1 : h | 0, y, c);\n  } else {\n    return _LEA(a, c === void 0 ? 0 : c | 0, l === void 0 ? a.length - 1 : l | 0, y);\n  }\n}\n\nfunction _EQA(a, l, h, y) {\n  l - 1;\n  while (l <= h) {\n    var m = l + h >>> 1,\n        x = a[m];\n    if (x === y) {\n      return m;\n    } else if (x <= y) {\n      l = m + 1;\n    } else {\n      h = m - 1;\n    }\n  }\n  return -1;\n}\nfunction _EQP(a, l, h, y, c) {\n  l - 1;\n  while (l <= h) {\n    var m = l + h >>> 1,\n        x = a[m];\n    var p = c(x, y);\n    if (p === 0) {\n      return m;\n    } else if (p <= 0) {\n      l = m + 1;\n    } else {\n      h = m - 1;\n    }\n  }\n  return -1;\n}\nfunction dispatchBsearchEQ(a, y, c, l, h) {\n  if (typeof c === 'function') {\n    return _EQP(a, l === void 0 ? 0 : l | 0, h === void 0 ? a.length - 1 : h | 0, y, c);\n  } else {\n    return _EQA(a, c === void 0 ? 0 : c | 0, l === void 0 ? a.length - 1 : l | 0, y);\n  }\n}\n\nexport default {\n  ge: dispatchBsearchGE,\n  gt: dispatchBsearchGT,\n  lt: dispatchBsearchLT,\n  le: dispatchBsearchLE,\n  eq: dispatchBsearchEQ\n};","/**\n * Binary Search Bounds\n * https://github.com/mikolalysenko/interval-tree-1d\n * Mikola Lysenko\n *\n * Inlined because of Content Security Policy issue caused by the use of `new Function(...)` syntax in an upstream dependency.\n * Issue reported here: https://github.com/mikolalysenko/binary-search-bounds/issues/5\n **/\n\nimport bounds from './binarySearchBounds';\n\nvar NOT_FOUND = 0;\nvar SUCCESS = 1;\nvar EMPTY = 2;\n\nfunction IntervalTreeNode(mid, left, right, leftPoints, rightPoints) {\n  this.mid = mid;\n  this.left = left;\n  this.right = right;\n  this.leftPoints = leftPoints;\n  this.rightPoints = rightPoints;\n  this.count = (left ? left.count : 0) + (right ? right.count : 0) + leftPoints.length;\n}\n\nvar proto = IntervalTreeNode.prototype;\n\nfunction copy(a, b) {\n  a.mid = b.mid;\n  a.left = b.left;\n  a.right = b.right;\n  a.leftPoints = b.leftPoints;\n  a.rightPoints = b.rightPoints;\n  a.count = b.count;\n}\n\nfunction rebuild(node, intervals) {\n  var ntree = createIntervalTree(intervals);\n  node.mid = ntree.mid;\n  node.left = ntree.left;\n  node.right = ntree.right;\n  node.leftPoints = ntree.leftPoints;\n  node.rightPoints = ntree.rightPoints;\n  node.count = ntree.count;\n}\n\nfunction rebuildWithInterval(node, interval) {\n  var intervals = node.intervals([]);\n  intervals.push(interval);\n  rebuild(node, intervals);\n}\n\nfunction rebuildWithoutInterval(node, interval) {\n  var intervals = node.intervals([]);\n  var idx = intervals.indexOf(interval);\n  if (idx < 0) {\n    return NOT_FOUND;\n  }\n  intervals.splice(idx, 1);\n  rebuild(node, intervals);\n  return SUCCESS;\n}\n\nproto.intervals = function (result) {\n  result.push.apply(result, this.leftPoints);\n  if (this.left) {\n    this.left.intervals(result);\n  }\n  if (this.right) {\n    this.right.intervals(result);\n  }\n  return result;\n};\n\nproto.insert = function (interval) {\n  var weight = this.count - this.leftPoints.length;\n  this.count += 1;\n  if (interval[1] < this.mid) {\n    if (this.left) {\n      if (4 * (this.left.count + 1) > 3 * (weight + 1)) {\n        rebuildWithInterval(this, interval);\n      } else {\n        this.left.insert(interval);\n      }\n    } else {\n      this.left = createIntervalTree([interval]);\n    }\n  } else if (interval[0] > this.mid) {\n    if (this.right) {\n      if (4 * (this.right.count + 1) > 3 * (weight + 1)) {\n        rebuildWithInterval(this, interval);\n      } else {\n        this.right.insert(interval);\n      }\n    } else {\n      this.right = createIntervalTree([interval]);\n    }\n  } else {\n    var l = bounds.ge(this.leftPoints, interval, compareBegin);\n    var r = bounds.ge(this.rightPoints, interval, compareEnd);\n    this.leftPoints.splice(l, 0, interval);\n    this.rightPoints.splice(r, 0, interval);\n  }\n};\n\nproto.remove = function (interval) {\n  var weight = this.count - this.leftPoints;\n  if (interval[1] < this.mid) {\n    if (!this.left) {\n      return NOT_FOUND;\n    }\n    var rw = this.right ? this.right.count : 0;\n    if (4 * rw > 3 * (weight - 1)) {\n      return rebuildWithoutInterval(this, interval);\n    }\n    var r = this.left.remove(interval);\n    if (r === EMPTY) {\n      this.left = null;\n      this.count -= 1;\n      return SUCCESS;\n    } else if (r === SUCCESS) {\n      this.count -= 1;\n    }\n    return r;\n  } else if (interval[0] > this.mid) {\n    if (!this.right) {\n      return NOT_FOUND;\n    }\n    var lw = this.left ? this.left.count : 0;\n    if (4 * lw > 3 * (weight - 1)) {\n      return rebuildWithoutInterval(this, interval);\n    }\n    var r = this.right.remove(interval);\n    if (r === EMPTY) {\n      this.right = null;\n      this.count -= 1;\n      return SUCCESS;\n    } else if (r === SUCCESS) {\n      this.count -= 1;\n    }\n    return r;\n  } else {\n    if (this.count === 1) {\n      if (this.leftPoints[0] === interval) {\n        return EMPTY;\n      } else {\n        return NOT_FOUND;\n      }\n    }\n    if (this.leftPoints.length === 1 && this.leftPoints[0] === interval) {\n      if (this.left && this.right) {\n        var p = this;\n        var n = this.left;\n        while (n.right) {\n          p = n;\n          n = n.right;\n        }\n        if (p === this) {\n          n.right = this.right;\n        } else {\n          var l = this.left;\n          var r = this.right;\n          p.count -= n.count;\n          p.right = n.left;\n          n.left = l;\n          n.right = r;\n        }\n        copy(this, n);\n        this.count = (this.left ? this.left.count : 0) + (this.right ? this.right.count : 0) + this.leftPoints.length;\n      } else if (this.left) {\n        copy(this, this.left);\n      } else {\n        copy(this, this.right);\n      }\n      return SUCCESS;\n    }\n    for (var l = bounds.ge(this.leftPoints, interval, compareBegin); l < this.leftPoints.length; ++l) {\n      if (this.leftPoints[l][0] !== interval[0]) {\n        break;\n      }\n      if (this.leftPoints[l] === interval) {\n        this.count -= 1;\n        this.leftPoints.splice(l, 1);\n        for (var r = bounds.ge(this.rightPoints, interval, compareEnd); r < this.rightPoints.length; ++r) {\n          if (this.rightPoints[r][1] !== interval[1]) {\n            break;\n          } else if (this.rightPoints[r] === interval) {\n            this.rightPoints.splice(r, 1);\n            return SUCCESS;\n          }\n        }\n      }\n    }\n    return NOT_FOUND;\n  }\n};\n\nfunction reportLeftRange(arr, hi, cb) {\n  for (var i = 0; i < arr.length && arr[i][0] <= hi; ++i) {\n    var r = cb(arr[i]);\n    if (r) {\n      return r;\n    }\n  }\n}\n\nfunction reportRightRange(arr, lo, cb) {\n  for (var i = arr.length - 1; i >= 0 && arr[i][1] >= lo; --i) {\n    var r = cb(arr[i]);\n    if (r) {\n      return r;\n    }\n  }\n}\n\nfunction reportRange(arr, cb) {\n  for (var i = 0; i < arr.length; ++i) {\n    var r = cb(arr[i]);\n    if (r) {\n      return r;\n    }\n  }\n}\n\nproto.queryPoint = function (x, cb) {\n  if (x < this.mid) {\n    if (this.left) {\n      var r = this.left.queryPoint(x, cb);\n      if (r) {\n        return r;\n      }\n    }\n    return reportLeftRange(this.leftPoints, x, cb);\n  } else if (x > this.mid) {\n    if (this.right) {\n      var r = this.right.queryPoint(x, cb);\n      if (r) {\n        return r;\n      }\n    }\n    return reportRightRange(this.rightPoints, x, cb);\n  } else {\n    return reportRange(this.leftPoints, cb);\n  }\n};\n\nproto.queryInterval = function (lo, hi, cb) {\n  if (lo < this.mid && this.left) {\n    var r = this.left.queryInterval(lo, hi, cb);\n    if (r) {\n      return r;\n    }\n  }\n  if (hi > this.mid && this.right) {\n    var r = this.right.queryInterval(lo, hi, cb);\n    if (r) {\n      return r;\n    }\n  }\n  if (hi < this.mid) {\n    return reportLeftRange(this.leftPoints, hi, cb);\n  } else if (lo > this.mid) {\n    return reportRightRange(this.rightPoints, lo, cb);\n  } else {\n    return reportRange(this.leftPoints, cb);\n  }\n};\n\nfunction compareNumbers(a, b) {\n  return a - b;\n}\n\nfunction compareBegin(a, b) {\n  var d = a[0] - b[0];\n  if (d) {\n    return d;\n  }\n  return a[1] - b[1];\n}\n\nfunction compareEnd(a, b) {\n  var d = a[1] - b[1];\n  if (d) {\n    return d;\n  }\n  return a[0] - b[0];\n}\n\nfunction createIntervalTree(intervals) {\n  if (intervals.length === 0) {\n    return null;\n  }\n  var pts = [];\n  for (var i = 0; i < intervals.length; ++i) {\n    pts.push(intervals[i][0], intervals[i][1]);\n  }\n  pts.sort(compareNumbers);\n\n  var mid = pts[pts.length >> 1];\n\n  var leftIntervals = [];\n  var rightIntervals = [];\n  var centerIntervals = [];\n  for (var i = 0; i < intervals.length; ++i) {\n    var s = intervals[i];\n    if (s[1] < mid) {\n      leftIntervals.push(s);\n    } else if (mid < s[0]) {\n      rightIntervals.push(s);\n    } else {\n      centerIntervals.push(s);\n    }\n  }\n\n  //Split center intervals\n  var leftPoints = centerIntervals;\n  var rightPoints = centerIntervals.slice();\n  leftPoints.sort(compareBegin);\n  rightPoints.sort(compareEnd);\n\n  return new IntervalTreeNode(mid, createIntervalTree(leftIntervals), createIntervalTree(rightIntervals), leftPoints, rightPoints);\n}\n\n//User friendly wrapper that makes it possible to support empty trees\nfunction IntervalTree(root) {\n  this.root = root;\n}\n\nvar tproto = IntervalTree.prototype;\n\ntproto.insert = function (interval) {\n  if (this.root) {\n    this.root.insert(interval);\n  } else {\n    this.root = new IntervalTreeNode(interval[0], null, null, [interval], [interval]);\n  }\n};\n\ntproto.remove = function (interval) {\n  if (this.root) {\n    var r = this.root.remove(interval);\n    if (r === EMPTY) {\n      this.root = null;\n    }\n    return r !== NOT_FOUND;\n  }\n  return false;\n};\n\ntproto.queryPoint = function (p, cb) {\n  if (this.root) {\n    return this.root.queryPoint(p, cb);\n  }\n};\n\ntproto.queryInterval = function (lo, hi, cb) {\n  if (lo <= hi && this.root) {\n    return this.root.queryInterval(lo, hi, cb);\n  }\n};\n\nObject.defineProperty(tproto, 'count', {\n  get: function get() {\n    if (this.root) {\n      return this.root.count;\n    }\n    return 0;\n  }\n});\n\nObject.defineProperty(tproto, 'intervals', {\n  get: function get() {\n    if (this.root) {\n      return this.root.intervals([]);\n    }\n    return [];\n  }\n});\n\nexport default function createWrapper(intervals) {\n  if (!intervals || intervals.length === 0) {\n    return new IntervalTree(null);\n  }\n  return new IntervalTree(createIntervalTree(intervals));\n}","import _slicedToArray from 'babel-runtime/helpers/slicedToArray';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport createIntervalTree from '../vendor/intervalTree';\n\n// Position cache requirements:\n//   O(log(n)) lookup of cells to render for a given viewport size\n//   O(1) lookup of shortest measured column (so we know when to enter phase 1)\nvar PositionCache = function () {\n  function PositionCache() {\n    _classCallCheck(this, PositionCache);\n\n    this._columnSizeMap = {};\n    this._intervalTree = createIntervalTree();\n    this._leftMap = {};\n  }\n  // Tracks the height of each column\n\n\n  // Store tops and bottoms of each cell for fast intersection lookup.\n\n\n  // Maps cell index to x coordinates for quick lookup.\n\n\n  _createClass(PositionCache, [{\n    key: 'estimateTotalHeight',\n    value: function estimateTotalHeight(cellCount, columnCount, defaultCellHeight) {\n      var unmeasuredCellCount = cellCount - this.count;\n      return this.tallestColumnSize + Math.ceil(unmeasuredCellCount / columnCount) * defaultCellHeight;\n    }\n\n    // Render all cells visible within the viewport range defined.\n\n  }, {\n    key: 'range',\n    value: function range(scrollTop, clientHeight, renderCallback) {\n      var _this = this;\n\n      this._intervalTree.queryInterval(scrollTop, scrollTop + clientHeight, function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 3),\n            top = _ref2[0],\n            _ = _ref2[1],\n            index = _ref2[2];\n\n        return renderCallback(index, _this._leftMap[index], top);\n      });\n    }\n  }, {\n    key: 'setPosition',\n    value: function setPosition(index, left, top, height) {\n      this._intervalTree.insert([top, top + height, index]);\n      this._leftMap[index] = left;\n\n      var columnSizeMap = this._columnSizeMap;\n      var columnHeight = columnSizeMap[left];\n      if (columnHeight === undefined) {\n        columnSizeMap[left] = top + height;\n      } else {\n        columnSizeMap[left] = Math.max(columnHeight, top + height);\n      }\n    }\n  }, {\n    key: 'count',\n    get: function get() {\n      return this._intervalTree.count;\n    }\n  }, {\n    key: 'shortestColumnSize',\n    get: function get() {\n      var columnSizeMap = this._columnSizeMap;\n\n      var size = 0;\n\n      for (var i in columnSizeMap) {\n        var height = columnSizeMap[i];\n        size = size === 0 ? height : Math.min(size, height);\n      }\n\n      return size;\n    }\n  }, {\n    key: 'tallestColumnSize',\n    get: function get() {\n      var columnSizeMap = this._columnSizeMap;\n\n      var size = 0;\n\n      for (var i in columnSizeMap) {\n        var height = columnSizeMap[i];\n        size = Math.max(size, height);\n      }\n\n      return size;\n    }\n  }]);\n\n  return PositionCache;\n}();\n\nexport default PositionCache;","import _extends from 'babel-runtime/helpers/extends';\nimport _defineProperty from 'babel-runtime/helpers/defineProperty';\nimport _Object$getPrototypeOf from 'babel-runtime/core-js/object/get-prototype-of';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport cn from 'classnames';\nimport * as React from 'react';\nimport { polyfill } from 'react-lifecycles-compat';\nimport PositionCache from './PositionCache';\nimport { requestAnimationTimeout, cancelAnimationTimeout } from '../utils/requestAnimationTimeout';\n\nvar emptyObject = {};\n\n/**\n * Specifies the number of miliseconds during which to disable pointer events while a scroll is in progress.\n * This improves performance and makes scrolling smoother.\n */\nexport var DEFAULT_SCROLLING_RESET_TIME_INTERVAL = 150;\n\n/**\n * This component efficiently displays arbitrarily positioned cells using windowing techniques.\n * Cell position is determined by an injected `cellPositioner` property.\n * Windowing is vertical; this component does not support horizontal scrolling.\n *\n * Rendering occurs in two phases:\n * 1) First pass uses estimated cell sizes (provided by the cache) to determine how many cells to measure in a batch.\n *    Batch size is chosen using a fast, naive layout algorithm that stacks images in order until the viewport has been filled.\n *    After measurement is complete (componentDidMount or componentDidUpdate) this component evaluates positioned cells\n *    in order to determine if another measurement pass is required (eg if actual cell sizes were less than estimated sizes).\n *    All measurements are permanently cached (keyed by `keyMapper`) for performance purposes.\n * 2) Second pass uses the external `cellPositioner` to layout cells.\n *    At this time the positioner has access to cached size measurements for all cells.\n *    The positions it returns are cached by Masonry for fast access later.\n *    Phase one is repeated if the user scrolls beyond the current layout's bounds.\n *    If the layout is invalidated due to eg a resize, cached positions can be cleared using `recomputeCellPositions()`.\n *\n * Animation constraints:\n *   Simple animations are supported (eg translate/slide into place on initial reveal).\n *   More complex animations are not (eg flying from one position to another on resize).\n *\n * Layout constraints:\n *   This component supports multi-column layout.\n *   The height of each item may vary.\n *   The width of each item must not exceed the width of the column it is \"in\".\n *   The left position of all items within a column must align.\n *   (Items may not span multiple columns.)\n */\n\nvar Masonry = function (_React$PureComponent) {\n  _inherits(Masonry, _React$PureComponent);\n\n  function Masonry() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, Masonry);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = Masonry.__proto__ || _Object$getPrototypeOf(Masonry)).call.apply(_ref, [this].concat(args))), _this), _this.state = {\n      isScrolling: false,\n      scrollTop: 0\n    }, _this._invalidateOnUpdateStartIndex = null, _this._invalidateOnUpdateStopIndex = null, _this._positionCache = new PositionCache(), _this._startIndex = null, _this._startIndexMemoized = null, _this._stopIndex = null, _this._stopIndexMemoized = null, _this._debounceResetIsScrollingCallback = function () {\n      _this.setState({\n        isScrolling: false\n      });\n    }, _this._setScrollingContainerRef = function (ref) {\n      _this._scrollingContainer = ref;\n    }, _this._onScroll = function (event) {\n      var height = _this.props.height;\n\n\n      var eventScrollTop = event.target.scrollTop;\n\n      // When this component is shrunk drastically, React dispatches a series of back-to-back scroll events,\n      // Gradually converging on a scrollTop that is within the bounds of the new, smaller height.\n      // This causes a series of rapid renders that is slow for long lists.\n      // We can avoid that by doing some simple bounds checking to ensure that scroll offsets never exceed their bounds.\n      var scrollTop = Math.min(Math.max(0, _this._getEstimatedTotalHeight() - height), eventScrollTop);\n\n      // On iOS, we can arrive at negative offsets by swiping past the start or end.\n      // Avoid re-rendering in this case as it can cause problems; see #532 for more.\n      if (eventScrollTop !== scrollTop) {\n        return;\n      }\n\n      // Prevent pointer events from interrupting a smooth scroll\n      _this._debounceResetIsScrolling();\n\n      // Certain devices (like Apple touchpad) rapid-fire duplicate events.\n      // Don't force a re-render if this is the case.\n      // The mouse may move faster then the animation frame does.\n      // Use requestAnimationFrame to avoid over-updating.\n      if (_this.state.scrollTop !== scrollTop) {\n        _this.setState({\n          isScrolling: true,\n          scrollTop: scrollTop\n        });\n      }\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(Masonry, [{\n    key: 'clearCellPositions',\n    value: function clearCellPositions() {\n      this._positionCache = new PositionCache();\n      this.forceUpdate();\n    }\n\n    // HACK This method signature was intended for Grid\n\n  }, {\n    key: 'invalidateCellSizeAfterRender',\n    value: function invalidateCellSizeAfterRender(_ref2) {\n      var index = _ref2.rowIndex;\n\n      if (this._invalidateOnUpdateStartIndex === null) {\n        this._invalidateOnUpdateStartIndex = index;\n        this._invalidateOnUpdateStopIndex = index;\n      } else {\n        this._invalidateOnUpdateStartIndex = Math.min(this._invalidateOnUpdateStartIndex, index);\n        this._invalidateOnUpdateStopIndex = Math.max(this._invalidateOnUpdateStopIndex, index);\n      }\n    }\n  }, {\n    key: 'recomputeCellPositions',\n    value: function recomputeCellPositions() {\n      var stopIndex = this._positionCache.count - 1;\n\n      this._positionCache = new PositionCache();\n      this._populatePositionCache(0, stopIndex);\n\n      this.forceUpdate();\n    }\n  }, {\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this._checkInvalidateOnUpdate();\n      this._invokeOnScrollCallback();\n      this._invokeOnCellsRenderedCallback();\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps, prevState) {\n      this._checkInvalidateOnUpdate();\n      this._invokeOnScrollCallback();\n      this._invokeOnCellsRenderedCallback();\n\n      if (this.props.scrollTop !== prevProps.scrollTop) {\n        this._debounceResetIsScrolling();\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      if (this._debounceResetIsScrollingId) {\n        cancelAnimationTimeout(this._debounceResetIsScrollingId);\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var _props = this.props,\n          autoHeight = _props.autoHeight,\n          cellCount = _props.cellCount,\n          cellMeasurerCache = _props.cellMeasurerCache,\n          cellRenderer = _props.cellRenderer,\n          className = _props.className,\n          height = _props.height,\n          id = _props.id,\n          keyMapper = _props.keyMapper,\n          overscanByPixels = _props.overscanByPixels,\n          role = _props.role,\n          style = _props.style,\n          tabIndex = _props.tabIndex,\n          width = _props.width,\n          rowDirection = _props.rowDirection;\n      var _state = this.state,\n          isScrolling = _state.isScrolling,\n          scrollTop = _state.scrollTop;\n\n\n      var children = [];\n\n      var estimateTotalHeight = this._getEstimatedTotalHeight();\n\n      var shortestColumnSize = this._positionCache.shortestColumnSize;\n      var measuredCellCount = this._positionCache.count;\n\n      var startIndex = 0;\n      var stopIndex = void 0;\n\n      this._positionCache.range(Math.max(0, scrollTop - overscanByPixels), height + overscanByPixels * 2, function (index, left, top) {\n        var _style;\n\n        if (typeof stopIndex === 'undefined') {\n          startIndex = index;\n          stopIndex = index;\n        } else {\n          startIndex = Math.min(startIndex, index);\n          stopIndex = Math.max(stopIndex, index);\n        }\n\n        children.push(cellRenderer({\n          index: index,\n          isScrolling: isScrolling,\n          key: keyMapper(index),\n          parent: _this2,\n          style: (_style = {\n            height: cellMeasurerCache.getHeight(index)\n          }, _defineProperty(_style, rowDirection === 'ltr' ? 'left' : 'right', left), _defineProperty(_style, 'position', 'absolute'), _defineProperty(_style, 'top', top), _defineProperty(_style, 'width', cellMeasurerCache.getWidth(index)), _style)\n        }));\n      });\n\n      // We need to measure additional cells for this layout\n      if (shortestColumnSize < scrollTop + height + overscanByPixels && measuredCellCount < cellCount) {\n        var batchSize = Math.min(cellCount - measuredCellCount, Math.ceil((scrollTop + height + overscanByPixels - shortestColumnSize) / cellMeasurerCache.defaultHeight * width / cellMeasurerCache.defaultWidth));\n\n        for (var _index = measuredCellCount; _index < measuredCellCount + batchSize; _index++) {\n          stopIndex = _index;\n\n          children.push(cellRenderer({\n            index: _index,\n            isScrolling: isScrolling,\n            key: keyMapper(_index),\n            parent: this,\n            style: {\n              width: cellMeasurerCache.getWidth(_index)\n            }\n          }));\n        }\n      }\n\n      this._startIndex = startIndex;\n      this._stopIndex = stopIndex;\n\n      return React.createElement(\n        'div',\n        {\n          ref: this._setScrollingContainerRef,\n          'aria-label': this.props['aria-label'],\n          className: cn('ReactVirtualized__Masonry', className),\n          id: id,\n          onScroll: this._onScroll,\n          role: role,\n          style: _extends({\n            boxSizing: 'border-box',\n            direction: 'ltr',\n            height: autoHeight ? 'auto' : height,\n            overflowX: 'hidden',\n            overflowY: estimateTotalHeight < height ? 'hidden' : 'auto',\n            position: 'relative',\n            width: width,\n            WebkitOverflowScrolling: 'touch',\n            willChange: 'transform'\n          }, style),\n          tabIndex: tabIndex },\n        React.createElement(\n          'div',\n          {\n            className: 'ReactVirtualized__Masonry__innerScrollContainer',\n            style: {\n              width: '100%',\n              height: estimateTotalHeight,\n              maxWidth: '100%',\n              maxHeight: estimateTotalHeight,\n              overflow: 'hidden',\n              pointerEvents: isScrolling ? 'none' : '',\n              position: 'relative'\n            } },\n          children\n        )\n      );\n    }\n  }, {\n    key: '_checkInvalidateOnUpdate',\n    value: function _checkInvalidateOnUpdate() {\n      if (typeof this._invalidateOnUpdateStartIndex === 'number') {\n        var _startIndex = this._invalidateOnUpdateStartIndex;\n        var _stopIndex = this._invalidateOnUpdateStopIndex;\n\n        this._invalidateOnUpdateStartIndex = null;\n        this._invalidateOnUpdateStopIndex = null;\n\n        // Query external layout logic for position of newly-measured cells\n        this._populatePositionCache(_startIndex, _stopIndex);\n\n        this.forceUpdate();\n      }\n    }\n  }, {\n    key: '_debounceResetIsScrolling',\n    value: function _debounceResetIsScrolling() {\n      var scrollingResetTimeInterval = this.props.scrollingResetTimeInterval;\n\n\n      if (this._debounceResetIsScrollingId) {\n        cancelAnimationTimeout(this._debounceResetIsScrollingId);\n      }\n\n      this._debounceResetIsScrollingId = requestAnimationTimeout(this._debounceResetIsScrollingCallback, scrollingResetTimeInterval);\n    }\n  }, {\n    key: '_getEstimatedTotalHeight',\n    value: function _getEstimatedTotalHeight() {\n      var _props2 = this.props,\n          cellCount = _props2.cellCount,\n          cellMeasurerCache = _props2.cellMeasurerCache,\n          width = _props2.width;\n\n\n      var estimatedColumnCount = Math.max(1, Math.floor(width / cellMeasurerCache.defaultWidth));\n\n      return this._positionCache.estimateTotalHeight(cellCount, estimatedColumnCount, cellMeasurerCache.defaultHeight);\n    }\n  }, {\n    key: '_invokeOnScrollCallback',\n    value: function _invokeOnScrollCallback() {\n      var _props3 = this.props,\n          height = _props3.height,\n          onScroll = _props3.onScroll;\n      var scrollTop = this.state.scrollTop;\n\n\n      if (this._onScrollMemoized !== scrollTop) {\n        onScroll({\n          clientHeight: height,\n          scrollHeight: this._getEstimatedTotalHeight(),\n          scrollTop: scrollTop\n        });\n\n        this._onScrollMemoized = scrollTop;\n      }\n    }\n  }, {\n    key: '_invokeOnCellsRenderedCallback',\n    value: function _invokeOnCellsRenderedCallback() {\n      if (this._startIndexMemoized !== this._startIndex || this._stopIndexMemoized !== this._stopIndex) {\n        var _onCellsRendered = this.props.onCellsRendered;\n\n\n        _onCellsRendered({\n          startIndex: this._startIndex,\n          stopIndex: this._stopIndex\n        });\n\n        this._startIndexMemoized = this._startIndex;\n        this._stopIndexMemoized = this._stopIndex;\n      }\n    }\n  }, {\n    key: '_populatePositionCache',\n    value: function _populatePositionCache(startIndex, stopIndex) {\n      var _props4 = this.props,\n          cellMeasurerCache = _props4.cellMeasurerCache,\n          cellPositioner = _props4.cellPositioner;\n\n\n      for (var _index2 = startIndex; _index2 <= stopIndex; _index2++) {\n        var _cellPositioner = cellPositioner(_index2),\n            _left = _cellPositioner.left,\n            _top = _cellPositioner.top;\n\n        this._positionCache.setPosition(_index2, _left, _top, cellMeasurerCache.getHeight(_index2));\n      }\n    }\n  }], [{\n    key: 'getDerivedStateFromProps',\n    value: function getDerivedStateFromProps(nextProps, prevState) {\n      if (nextProps.scrollTop !== undefined && prevState.scrollTop !== nextProps.scrollTop) {\n        return {\n          isScrolling: true,\n          scrollTop: nextProps.scrollTop\n        };\n      }\n\n      return null;\n    }\n  }]);\n\n  return Masonry;\n}(React.PureComponent);\n\nMasonry.defaultProps = {\n  autoHeight: false,\n  keyMapper: identity,\n  onCellsRendered: noop,\n  onScroll: noop,\n  overscanByPixels: 20,\n  role: 'grid',\n  scrollingResetTimeInterval: DEFAULT_SCROLLING_RESET_TIME_INTERVAL,\n  style: emptyObject,\n  tabIndex: 0,\n  rowDirection: 'ltr'\n};\nMasonry.propTypes = process.env.NODE_ENV === 'production' ? null : {\n  autoHeight: PropTypes.bool.isRequired,\n  cellCount: PropTypes.number.isRequired,\n  cellMeasurerCache: function cellMeasurerCache() {\n    return (typeof CellMeasurerCache === 'function' ? PropTypes.instanceOf(CellMeasurerCache).isRequired : PropTypes.any.isRequired).apply(this, arguments);\n  },\n  cellPositioner: function cellPositioner() {\n    return (typeof Positioner === 'function' ? PropTypes.instanceOf(Positioner).isRequired : PropTypes.any.isRequired).apply(this, arguments);\n  },\n  cellRenderer: function cellRenderer() {\n    return (typeof CellRenderer === 'function' ? PropTypes.instanceOf(CellRenderer).isRequired : PropTypes.any.isRequired).apply(this, arguments);\n  },\n  className: PropTypes.string,\n  height: PropTypes.number.isRequired,\n  id: PropTypes.string,\n  keyMapper: function keyMapper() {\n    return (typeof KeyMapper === 'function' ? PropTypes.instanceOf(KeyMapper).isRequired : PropTypes.any.isRequired).apply(this, arguments);\n  },\n  onCellsRendered: function onCellsRendered() {\n    return (typeof OnCellsRenderedCallback === 'function' ? PropTypes.instanceOf(OnCellsRenderedCallback) : PropTypes.any).apply(this, arguments);\n  },\n  onScroll: function onScroll() {\n    return (typeof OnScrollCallback === 'function' ? PropTypes.instanceOf(OnScrollCallback) : PropTypes.any).apply(this, arguments);\n  },\n  overscanByPixels: PropTypes.number.isRequired,\n  role: PropTypes.string.isRequired,\n  scrollingResetTimeInterval: PropTypes.number.isRequired,\n  style: function style(props, propName, componentName) {\n    if (!Object.prototype.hasOwnProperty.call(props, propName)) {\n      throw new Error('Prop `' + propName + '` has type \\'any\\' or \\'mixed\\', but was not provided to `' + componentName + '`. Pass undefined or any other value.');\n    }\n  },\n  tabIndex: PropTypes.number.isRequired,\n  width: PropTypes.number.isRequired,\n  rowDirection: PropTypes.string.isRequired\n};\n\n\nfunction identity(value) {\n  return value;\n}\n\nfunction noop() {}\n\nvar bpfrpt_proptype_CellMeasurerCache = process.env.NODE_ENV === 'production' ? null : {\n  defaultHeight: PropTypes.number.isRequired,\n  defaultWidth: PropTypes.number.isRequired,\n  getHeight: PropTypes.func.isRequired,\n  getWidth: PropTypes.func.isRequired\n};\n\n\npolyfill(Masonry);\n\nexport default Masonry;\n\nvar bpfrpt_proptype_Positioner = process.env.NODE_ENV === 'production' ? null : PropTypes.func;\nimport { bpfrpt_proptype_AnimationTimeoutId } from '../utils/requestAnimationTimeout';\nimport PropTypes from 'prop-types';\nexport { bpfrpt_proptype_CellMeasurerCache };\nexport { bpfrpt_proptype_Positioner };","\n\nexport default function createMultiSort(sortCallback) {\n  var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n      defaultSortBy = _ref.defaultSortBy,\n      _ref$defaultSortDirec = _ref.defaultSortDirection,\n      defaultSortDirection = _ref$defaultSortDirec === undefined ? {} : _ref$defaultSortDirec;\n\n  if (!sortCallback) {\n    throw Error('Required parameter \"sortCallback\" not specified');\n  }\n\n  var sortBy = defaultSortBy || [];\n  var sortDirection = {};\n\n  sortBy.forEach(function (dataKey) {\n    sortDirection[dataKey] = defaultSortDirection.hasOwnProperty(dataKey) ? defaultSortDirection[dataKey] : 'ASC';\n  });\n\n  function sort(_ref2) {\n    var defaultSortDirection = _ref2.defaultSortDirection,\n        event = _ref2.event,\n        dataKey = _ref2.sortBy;\n\n    if (event.shiftKey) {\n      // Shift + click appends a column to existing criteria\n      if (sortDirection.hasOwnProperty(dataKey)) {\n        sortDirection[dataKey] = sortDirection[dataKey] === 'ASC' ? 'DESC' : 'ASC';\n      } else {\n        sortDirection[dataKey] = defaultSortDirection;\n        sortBy.push(dataKey);\n      }\n    } else if (event.ctrlKey || event.metaKey) {\n      // Control + click removes column from sort (if pressent)\n      var index = sortBy.indexOf(dataKey);\n      if (index >= 0) {\n        sortBy.splice(index, 1);\n        delete sortDirection[dataKey];\n      }\n    } else {\n      sortBy.length = 0;\n      sortBy.push(dataKey);\n\n      if (sortDirection.hasOwnProperty(dataKey)) {\n        sortDirection[dataKey] = sortDirection[dataKey] === 'ASC' ? 'DESC' : 'ASC';\n      } else {\n        sortDirection[dataKey] = defaultSortDirection;\n      }\n    }\n\n    // Notify application code\n    sortCallback({\n      sortBy: sortBy,\n      sortDirection: sortDirection\n    });\n  }\n\n  return {\n    sort: sort,\n    sortBy: sortBy,\n    sortDirection: sortDirection\n  };\n}","\n\n/**\n * Default accessor for returning a cell value for a given attribute.\n * This function expects to operate on either a vanilla Object or an Immutable Map.\n * You should override the column's cellDataGetter if your data is some other type of object.\n */\nexport default function defaultCellDataGetter(_ref) {\n  var dataKey = _ref.dataKey,\n      rowData = _ref.rowData;\n\n  if (typeof rowData.get === 'function') {\n    return rowData.get(dataKey);\n  } else {\n    return rowData[dataKey];\n  }\n}\nimport { bpfrpt_proptype_CellDataGetterParams } from './types';","\n\n/**\n * Default cell renderer that displays an attribute as a simple string\n * You should override the column's cellRenderer if your data is some other type of object.\n */\nexport default function defaultCellRenderer(_ref) {\n  var cellData = _ref.cellData;\n\n  if (cellData == null) {\n    return '';\n  } else {\n    return String(cellData);\n  }\n}\nimport { bpfrpt_proptype_CellRendererParams } from './types';","import * as React from 'react';\n\n\nexport default function defaultHeaderRowRenderer(_ref) {\n  var className = _ref.className,\n      columns = _ref.columns,\n      style = _ref.style;\n\n  return React.createElement(\n    'div',\n    { className: className, role: 'row', style: style },\n    columns\n  );\n}\ndefaultHeaderRowRenderer.propTypes = process.env.NODE_ENV === 'production' ? null : bpfrpt_proptype_HeaderRowRendererParams === PropTypes.any ? {} : bpfrpt_proptype_HeaderRowRendererParams;\nimport { bpfrpt_proptype_HeaderRowRendererParams } from './types';\nimport PropTypes from 'prop-types';","import cn from 'classnames';\nimport PropTypes from 'prop-types';\nimport * as React from 'react';\nimport SortDirection from './SortDirection';\n\n/**\n * Displayed beside a header to indicate that a Table is currently sorted by this column.\n */\nexport default function SortIndicator(_ref) {\n  var sortDirection = _ref.sortDirection;\n\n  var classNames = cn('ReactVirtualized__Table__sortableHeaderIcon', {\n    'ReactVirtualized__Table__sortableHeaderIcon--ASC': sortDirection === SortDirection.ASC,\n    'ReactVirtualized__Table__sortableHeaderIcon--DESC': sortDirection === SortDirection.DESC\n  });\n\n  return React.createElement(\n    'svg',\n    { className: classNames, width: 18, height: 18, viewBox: '0 0 24 24' },\n    sortDirection === SortDirection.ASC ? React.createElement('path', { d: 'M7 14l5-5 5 5z' }) : React.createElement('path', { d: 'M7 10l5 5 5-5z' }),\n    React.createElement('path', { d: 'M0 0h24v24H0z', fill: 'none' })\n  );\n}\n\nSortIndicator.propTypes = process.env.NODE_ENV !== \"production\" ? {\n  sortDirection: PropTypes.oneOf([SortDirection.ASC, SortDirection.DESC])\n} : {};","import * as React from 'react';\nimport SortIndicator from './SortIndicator';\n\n\n/**\n * Default table header renderer.\n */\nexport default function defaultHeaderRenderer(_ref) {\n  var dataKey = _ref.dataKey,\n      label = _ref.label,\n      sortBy = _ref.sortBy,\n      sortDirection = _ref.sortDirection;\n\n  var showSortIndicator = sortBy === dataKey;\n  var children = [React.createElement(\n    'span',\n    {\n      className: 'ReactVirtualized__Table__headerTruncatedText',\n      key: 'label',\n      title: label },\n    label\n  )];\n\n  if (showSortIndicator) {\n    children.push(React.createElement(SortIndicator, { key: 'SortIndicator', sortDirection: sortDirection }));\n  }\n\n  return children;\n}\ndefaultHeaderRenderer.propTypes = process.env.NODE_ENV === 'production' ? null : bpfrpt_proptype_HeaderRendererParams === PropTypes.any ? {} : bpfrpt_proptype_HeaderRendererParams;\nimport { bpfrpt_proptype_HeaderRendererParams } from './types';\nimport PropTypes from 'prop-types';","import _extends from 'babel-runtime/helpers/extends';\nimport * as React from 'react';\n\n\n/**\n * Default row renderer for Table.\n */\nexport default function defaultRowRenderer(_ref) {\n  var className = _ref.className,\n      columns = _ref.columns,\n      index = _ref.index,\n      key = _ref.key,\n      onRowClick = _ref.onRowClick,\n      onRowDoubleClick = _ref.onRowDoubleClick,\n      onRowMouseOut = _ref.onRowMouseOut,\n      onRowMouseOver = _ref.onRowMouseOver,\n      onRowRightClick = _ref.onRowRightClick,\n      rowData = _ref.rowData,\n      style = _ref.style;\n\n  var a11yProps = {};\n\n  if (onRowClick || onRowDoubleClick || onRowMouseOut || onRowMouseOver || onRowRightClick) {\n    a11yProps['aria-label'] = 'row';\n    a11yProps.tabIndex = 0;\n\n    if (onRowClick) {\n      a11yProps.onClick = function (event) {\n        return onRowClick({ event: event, index: index, rowData: rowData });\n      };\n    }\n    if (onRowDoubleClick) {\n      a11yProps.onDoubleClick = function (event) {\n        return onRowDoubleClick({ event: event, index: index, rowData: rowData });\n      };\n    }\n    if (onRowMouseOut) {\n      a11yProps.onMouseOut = function (event) {\n        return onRowMouseOut({ event: event, index: index, rowData: rowData });\n      };\n    }\n    if (onRowMouseOver) {\n      a11yProps.onMouseOver = function (event) {\n        return onRowMouseOver({ event: event, index: index, rowData: rowData });\n      };\n    }\n    if (onRowRightClick) {\n      a11yProps.onContextMenu = function (event) {\n        return onRowRightClick({ event: event, index: index, rowData: rowData });\n      };\n    }\n  }\n\n  return React.createElement(\n    'div',\n    _extends({}, a11yProps, {\n      className: className,\n      key: key,\n      role: 'row',\n      style: style }),\n    columns\n  );\n}\ndefaultRowRenderer.propTypes = process.env.NODE_ENV === 'production' ? null : bpfrpt_proptype_RowRendererParams === PropTypes.any ? {} : bpfrpt_proptype_RowRendererParams;\nimport { bpfrpt_proptype_RowRendererParams } from './types';\nimport PropTypes from 'prop-types';","import { requestAnimationTimeout, cancelAnimationTimeout } from '../../utils/requestAnimationTimeout';\n\n\nvar mountedInstances = [];\nvar originalBodyPointerEvents = null;\nvar disablePointerEventsTimeoutId = null;\n\nfunction enablePointerEventsIfDisabled() {\n  if (disablePointerEventsTimeoutId) {\n    disablePointerEventsTimeoutId = null;\n\n    if (document.body && originalBodyPointerEvents != null) {\n      document.body.style.pointerEvents = originalBodyPointerEvents;\n    }\n\n    originalBodyPointerEvents = null;\n  }\n}\n\nfunction enablePointerEventsAfterDelayCallback() {\n  enablePointerEventsIfDisabled();\n  mountedInstances.forEach(function (instance) {\n    return instance.__resetIsScrolling();\n  });\n}\n\nfunction enablePointerEventsAfterDelay() {\n  if (disablePointerEventsTimeoutId) {\n    cancelAnimationTimeout(disablePointerEventsTimeoutId);\n  }\n\n  var maximumTimeout = 0;\n  mountedInstances.forEach(function (instance) {\n    maximumTimeout = Math.max(maximumTimeout, instance.props.scrollingResetTimeInterval);\n  });\n\n  disablePointerEventsTimeoutId = requestAnimationTimeout(enablePointerEventsAfterDelayCallback, maximumTimeout);\n}\n\nfunction onScrollWindow(event) {\n  if (event.currentTarget === window && originalBodyPointerEvents == null && document.body) {\n    originalBodyPointerEvents = document.body.style.pointerEvents;\n\n    document.body.style.pointerEvents = 'none';\n  }\n  enablePointerEventsAfterDelay();\n  mountedInstances.forEach(function (instance) {\n    if (instance.props.scrollElement === event.currentTarget) {\n      instance.__handleWindowScrollEvent();\n    }\n  });\n}\n\nexport function registerScrollListener(component, element) {\n  if (!mountedInstances.some(function (instance) {\n    return instance.props.scrollElement === element;\n  })) {\n    element.addEventListener('scroll', onScrollWindow);\n  }\n  mountedInstances.push(component);\n}\n\nexport function unregisterScrollListener(component, element) {\n  mountedInstances = mountedInstances.filter(function (instance) {\n    return instance !== component;\n  });\n  if (!mountedInstances.length) {\n    element.removeEventListener('scroll', onScrollWindow);\n    if (disablePointerEventsTimeoutId) {\n      cancelAnimationTimeout(disablePointerEventsTimeoutId);\n      enablePointerEventsIfDisabled();\n    }\n  }\n}\nimport { bpfrpt_proptype_WindowScroller } from '../WindowScroller.js';","\n\n/**\n * Gets the dimensions of the element, accounting for API differences between\n * `window` and other DOM elements.\n */\n\nvar isWindow = function isWindow(element) {\n  return element === window;\n};\n\n// TODO Move this into WindowScroller and import from there\n\n\nvar getBoundingBox = function getBoundingBox(element) {\n  return element.getBoundingClientRect();\n};\n\nexport function getDimensions(scrollElement, props) {\n  if (!scrollElement) {\n    return {\n      height: props.serverHeight,\n      width: props.serverWidth\n    };\n  } else if (isWindow(scrollElement)) {\n    var _window = window,\n        innerHeight = _window.innerHeight,\n        innerWidth = _window.innerWidth;\n\n    return {\n      height: typeof innerHeight === 'number' ? innerHeight : 0,\n      width: typeof innerWidth === 'number' ? innerWidth : 0\n    };\n  } else {\n    return getBoundingBox(scrollElement);\n  }\n}\n\n/**\n * Gets the vertical and horizontal position of an element within its scroll container.\n * Elements that have been scrolled past return negative values.\n * Handles edge-case where a user is navigating back (history) from an already-scrolled page.\n * In this case the bodys top or left position will be a negative number and this elements top or left will be increased (by that amount).\n */\nexport function getPositionOffset(element, container) {\n  if (isWindow(container) && document.documentElement) {\n    var containerElement = document.documentElement;\n    var elementRect = getBoundingBox(element);\n    var containerRect = getBoundingBox(containerElement);\n    return {\n      top: elementRect.top - containerRect.top,\n      left: elementRect.left - containerRect.left\n    };\n  } else {\n    var scrollOffset = getScrollOffset(container);\n    var _elementRect = getBoundingBox(element);\n    var _containerRect = getBoundingBox(container);\n    return {\n      top: _elementRect.top + scrollOffset.top - _containerRect.top,\n      left: _elementRect.left + scrollOffset.left - _containerRect.left\n    };\n  }\n}\n\n/**\n * Gets the vertical and horizontal scroll amount of the element, accounting for IE compatibility\n * and API differences between `window` and other DOM elements.\n */\nexport function getScrollOffset(element) {\n  if (isWindow(element) && document.documentElement) {\n    return {\n      top: 'scrollY' in window ? window.scrollY : document.documentElement.scrollTop,\n      left: 'scrollX' in window ? window.scrollX : document.documentElement.scrollLeft\n    };\n  } else {\n    return {\n      top: element.scrollTop,\n      left: element.scrollLeft\n    };\n  }\n}","import _extends from 'babel-runtime/helpers/extends';\nimport _Object$getPrototypeOf from 'babel-runtime/core-js/object/get-prototype-of';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport { registerScrollListener, unregisterScrollListener } from './utils/onScroll';\nimport { getDimensions, getPositionOffset, getScrollOffset } from './utils/dimensions';\nimport createDetectElementResize from '../vendor/detectElementResize';\n\n/**\n * Specifies the number of miliseconds during which to disable pointer events while a scroll is in progress.\n * This improves performance and makes scrolling smoother.\n */\nexport var IS_SCROLLING_TIMEOUT = 150;\n\nvar getWindow = function getWindow() {\n  return typeof window !== 'undefined' ? window : undefined;\n};\n\nvar WindowScroller = function (_React$PureComponent) {\n  _inherits(WindowScroller, _React$PureComponent);\n\n  function WindowScroller() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, WindowScroller);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = WindowScroller.__proto__ || _Object$getPrototypeOf(WindowScroller)).call.apply(_ref, [this].concat(args))), _this), _this._window = getWindow(), _this._isMounted = false, _this._positionFromTop = 0, _this._positionFromLeft = 0, _this.state = _extends({}, getDimensions(_this.props.scrollElement, _this.props), {\n      isScrolling: false,\n      scrollLeft: 0,\n      scrollTop: 0\n    }), _this._registerChild = function (element) {\n      if (element && !(element instanceof Element)) {\n        console.warn('WindowScroller registerChild expects to be passed Element or null');\n      }\n      _this._child = element;\n      _this.updatePosition();\n    }, _this._onChildScroll = function (_ref2) {\n      var scrollTop = _ref2.scrollTop;\n\n      if (_this.state.scrollTop === scrollTop) {\n        return;\n      }\n\n      var scrollElement = _this.props.scrollElement;\n      if (scrollElement) {\n        if (typeof scrollElement.scrollTo === 'function') {\n          scrollElement.scrollTo(0, scrollTop + _this._positionFromTop);\n        } else {\n          scrollElement.scrollTop = scrollTop + _this._positionFromTop;\n        }\n      }\n    }, _this._registerResizeListener = function (element) {\n      if (element === window) {\n        window.addEventListener('resize', _this._onResize, false);\n      } else {\n        _this._detectElementResize.addResizeListener(element, _this._onResize);\n      }\n    }, _this._unregisterResizeListener = function (element) {\n      if (element === window) {\n        window.removeEventListener('resize', _this._onResize, false);\n      } else if (element) {\n        _this._detectElementResize.removeResizeListener(element, _this._onResize);\n      }\n    }, _this._onResize = function () {\n      _this.updatePosition();\n    }, _this.__handleWindowScrollEvent = function () {\n      if (!_this._isMounted) {\n        return;\n      }\n\n      var onScroll = _this.props.onScroll;\n\n\n      var scrollElement = _this.props.scrollElement;\n      if (scrollElement) {\n        var scrollOffset = getScrollOffset(scrollElement);\n        var _scrollLeft = Math.max(0, scrollOffset.left - _this._positionFromLeft);\n        var _scrollTop = Math.max(0, scrollOffset.top - _this._positionFromTop);\n\n        _this.setState({\n          isScrolling: true,\n          scrollLeft: _scrollLeft,\n          scrollTop: _scrollTop\n        });\n\n        onScroll({\n          scrollLeft: _scrollLeft,\n          scrollTop: _scrollTop\n        });\n      }\n    }, _this.__resetIsScrolling = function () {\n      _this.setState({\n        isScrolling: false\n      });\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(WindowScroller, [{\n    key: 'updatePosition',\n    value: function updatePosition() {\n      var scrollElement = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.props.scrollElement;\n      var onResize = this.props.onResize;\n      var _state = this.state,\n          height = _state.height,\n          width = _state.width;\n\n\n      var thisNode = this._child || ReactDOM.findDOMNode(this);\n      if (thisNode instanceof Element && scrollElement) {\n        var offset = getPositionOffset(thisNode, scrollElement);\n        this._positionFromTop = offset.top;\n        this._positionFromLeft = offset.left;\n      }\n\n      var dimensions = getDimensions(scrollElement, this.props);\n      if (height !== dimensions.height || width !== dimensions.width) {\n        this.setState({\n          height: dimensions.height,\n          width: dimensions.width\n        });\n        onResize({\n          height: dimensions.height,\n          width: dimensions.width\n        });\n      }\n    }\n  }, {\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var scrollElement = this.props.scrollElement;\n\n      this._detectElementResize = createDetectElementResize();\n\n      this.updatePosition(scrollElement);\n\n      if (scrollElement) {\n        registerScrollListener(this, scrollElement);\n        this._registerResizeListener(scrollElement);\n      }\n\n      this._isMounted = true;\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps, prevState) {\n      var scrollElement = this.props.scrollElement;\n      var prevScrollElement = prevProps.scrollElement;\n\n\n      if (prevScrollElement !== scrollElement && prevScrollElement != null && scrollElement != null) {\n        this.updatePosition(scrollElement);\n\n        unregisterScrollListener(this, prevScrollElement);\n        registerScrollListener(this, scrollElement);\n\n        this._unregisterResizeListener(prevScrollElement);\n        this._registerResizeListener(scrollElement);\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      var scrollElement = this.props.scrollElement;\n      if (scrollElement) {\n        unregisterScrollListener(this, scrollElement);\n        this._unregisterResizeListener(scrollElement);\n      }\n\n      this._isMounted = false;\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var children = this.props.children;\n      var _state2 = this.state,\n          isScrolling = _state2.isScrolling,\n          scrollTop = _state2.scrollTop,\n          scrollLeft = _state2.scrollLeft,\n          height = _state2.height,\n          width = _state2.width;\n\n\n      return children({\n        onChildScroll: this._onChildScroll,\n        registerChild: this._registerChild,\n        height: height,\n        isScrolling: isScrolling,\n        scrollLeft: scrollLeft,\n        scrollTop: scrollTop,\n        width: width\n      });\n    }\n\n    // Referenced by utils/onScroll\n\n\n    // Referenced by utils/onScroll\n\n  }]);\n\n  return WindowScroller;\n}(React.PureComponent);\n\nWindowScroller.defaultProps = {\n  onResize: function onResize() {},\n  onScroll: function onScroll() {},\n  scrollingResetTimeInterval: IS_SCROLLING_TIMEOUT,\n  scrollElement: getWindow(),\n  serverHeight: 0,\n  serverWidth: 0\n};\nWindowScroller.propTypes = process.env.NODE_ENV === 'production' ? null : {\n  /**\n   * Function responsible for rendering children.\n   * This function should implement the following signature:\n   * ({ height, isScrolling, scrollLeft, scrollTop, width }) => PropTypes.element\n   */\n  children: PropTypes.func.isRequired,\n\n\n  /** Callback to be invoked on-resize: ({ height, width }) */\n  onResize: PropTypes.func.isRequired,\n\n\n  /** Callback to be invoked on-scroll: ({ scrollLeft, scrollTop }) */\n  onScroll: PropTypes.func.isRequired,\n\n\n  /** Element to attach scroll event listeners. Defaults to window. */\n  scrollElement: PropTypes.oneOfType([PropTypes.any, function () {\n    return (typeof Element === 'function' ? PropTypes.instanceOf(Element) : PropTypes.any).apply(this, arguments);\n  }]),\n\n  /**\n   * Wait this amount of time after the last scroll event before resetting child `pointer-events`.\n   */\n  scrollingResetTimeInterval: PropTypes.number.isRequired,\n\n\n  /** Height used for server-side rendering */\n  serverHeight: PropTypes.number.isRequired,\n\n\n  /** Width used for server-side rendering */\n  serverWidth: PropTypes.number.isRequired\n};\nexport default WindowScroller;\nimport PropTypes from 'prop-types';","import _Object$getPrototypeOf from 'babel-runtime/core-js/object/get-prototype-of';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport * as React from 'react';\nimport { polyfill } from 'react-lifecycles-compat';\n\n/**\n * This HOC decorates a virtualized component and responds to arrow-key events by scrolling one row or column at a time.\n */\n\nvar ArrowKeyStepper = function (_React$PureComponent) {\n  _inherits(ArrowKeyStepper, _React$PureComponent);\n\n  function ArrowKeyStepper() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, ArrowKeyStepper);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = ArrowKeyStepper.__proto__ || _Object$getPrototypeOf(ArrowKeyStepper)).call.apply(_ref, [this].concat(args))), _this), _this.state = {\n      scrollToColumn: 0,\n      scrollToRow: 0\n    }, _this._columnStartIndex = 0, _this._columnStopIndex = 0, _this._rowStartIndex = 0, _this._rowStopIndex = 0, _this._onKeyDown = function (event) {\n      var _this$props = _this.props,\n          columnCount = _this$props.columnCount,\n          disabled = _this$props.disabled,\n          mode = _this$props.mode,\n          rowCount = _this$props.rowCount;\n\n\n      if (disabled) {\n        return;\n      }\n\n      var _this$_getScrollState = _this._getScrollState(),\n          scrollToColumnPrevious = _this$_getScrollState.scrollToColumn,\n          scrollToRowPrevious = _this$_getScrollState.scrollToRow;\n\n      var _this$_getScrollState2 = _this._getScrollState(),\n          scrollToColumn = _this$_getScrollState2.scrollToColumn,\n          scrollToRow = _this$_getScrollState2.scrollToRow;\n\n      // The above cases all prevent default event event behavior.\n      // This is to keep the grid from scrolling after the snap-to update.\n\n\n      switch (event.key) {\n        case 'ArrowDown':\n          scrollToRow = mode === 'cells' ? Math.min(scrollToRow + 1, rowCount - 1) : Math.min(_this._rowStopIndex + 1, rowCount - 1);\n          break;\n        case 'ArrowLeft':\n          scrollToColumn = mode === 'cells' ? Math.max(scrollToColumn - 1, 0) : Math.max(_this._columnStartIndex - 1, 0);\n          break;\n        case 'ArrowRight':\n          scrollToColumn = mode === 'cells' ? Math.min(scrollToColumn + 1, columnCount - 1) : Math.min(_this._columnStopIndex + 1, columnCount - 1);\n          break;\n        case 'ArrowUp':\n          scrollToRow = mode === 'cells' ? Math.max(scrollToRow - 1, 0) : Math.max(_this._rowStartIndex - 1, 0);\n          break;\n      }\n\n      if (scrollToColumn !== scrollToColumnPrevious || scrollToRow !== scrollToRowPrevious) {\n        event.preventDefault();\n\n        _this._updateScrollState({ scrollToColumn: scrollToColumn, scrollToRow: scrollToRow });\n      }\n    }, _this._onSectionRendered = function (_ref2) {\n      var columnStartIndex = _ref2.columnStartIndex,\n          columnStopIndex = _ref2.columnStopIndex,\n          rowStartIndex = _ref2.rowStartIndex,\n          rowStopIndex = _ref2.rowStopIndex;\n\n      _this._columnStartIndex = columnStartIndex;\n      _this._columnStopIndex = columnStopIndex;\n      _this._rowStartIndex = rowStartIndex;\n      _this._rowStopIndex = rowStopIndex;\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(ArrowKeyStepper, [{\n    key: 'setScrollIndexes',\n    value: function setScrollIndexes(_ref3) {\n      var scrollToColumn = _ref3.scrollToColumn,\n          scrollToRow = _ref3.scrollToRow;\n\n      this.setState({\n        scrollToRow: scrollToRow,\n        scrollToColumn: scrollToColumn\n      });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props = this.props,\n          className = _props.className,\n          children = _props.children;\n\n      var _getScrollState2 = this._getScrollState(),\n          scrollToColumn = _getScrollState2.scrollToColumn,\n          scrollToRow = _getScrollState2.scrollToRow;\n\n      return React.createElement(\n        'div',\n        { className: className, onKeyDown: this._onKeyDown },\n        children({\n          onSectionRendered: this._onSectionRendered,\n          scrollToColumn: scrollToColumn,\n          scrollToRow: scrollToRow\n        })\n      );\n    }\n  }, {\n    key: '_getScrollState',\n    value: function _getScrollState() {\n      return this.props.isControlled ? this.props : this.state;\n    }\n  }, {\n    key: '_updateScrollState',\n    value: function _updateScrollState(_ref4) {\n      var scrollToColumn = _ref4.scrollToColumn,\n          scrollToRow = _ref4.scrollToRow;\n      var _props2 = this.props,\n          isControlled = _props2.isControlled,\n          onScrollToChange = _props2.onScrollToChange;\n\n\n      if (typeof onScrollToChange === 'function') {\n        onScrollToChange({ scrollToColumn: scrollToColumn, scrollToRow: scrollToRow });\n      }\n\n      if (!isControlled) {\n        this.setState({ scrollToColumn: scrollToColumn, scrollToRow: scrollToRow });\n      }\n    }\n  }], [{\n    key: 'getDerivedStateFromProps',\n    value: function getDerivedStateFromProps(nextProps, prevState) {\n      if (nextProps.isControlled) {\n        return null;\n      }\n\n      if (nextProps.scrollToColumn !== prevState.scrollToColumn || nextProps.scrollToRow !== prevState.scrollToRow) {\n        return {\n          scrollToColumn: nextProps.scrollToColumn,\n          scrollToRow: nextProps.scrollToRow\n        };\n      }\n\n      return null;\n    }\n  }]);\n\n  return ArrowKeyStepper;\n}(React.PureComponent);\n\nArrowKeyStepper.defaultProps = {\n  disabled: false,\n  isControlled: false,\n  mode: 'edges',\n  scrollToColumn: 0,\n  scrollToRow: 0\n};\nArrowKeyStepper.propTypes = process.env.NODE_ENV === 'production' ? null : {\n  children: PropTypes.func.isRequired,\n  className: PropTypes.string,\n  columnCount: PropTypes.number.isRequired,\n  disabled: PropTypes.bool.isRequired,\n  isControlled: PropTypes.bool.isRequired,\n  mode: PropTypes.oneOf(['cells', 'edges']).isRequired,\n  onScrollToChange: PropTypes.func,\n  rowCount: PropTypes.number.isRequired,\n  scrollToColumn: PropTypes.number.isRequired,\n  scrollToRow: PropTypes.number.isRequired\n};\n\n\npolyfill(ArrowKeyStepper);\n\nexport default ArrowKeyStepper;\nimport { bpfrpt_proptype_RenderedSection } from '../Grid';\nimport { bpfrpt_proptype_ScrollIndices } from './types';\nimport PropTypes from 'prop-types';","\n\nexport { default } from './ArrowKeyStepper';\n\nexport { default as ArrowKeyStepper } from './ArrowKeyStepper';\nimport { bpfrpt_proptype_ScrollIndices } from './types';\nexport { bpfrpt_proptype_ScrollIndices };","export { default } from './AutoSizer';\nexport { default as AutoSizer } from './AutoSizer';","import _Object$getPrototypeOf from 'babel-runtime/core-js/object/get-prototype-of';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport * as React from 'react';\nimport { findDOMNode } from 'react-dom';\n\n/**\n * Wraps a cell and measures its rendered content.\n * Measurements are stored in a per-cell cache.\n * Cached-content is not be re-measured.\n */\nvar CellMeasurer = function (_React$PureComponent) {\n  _inherits(CellMeasurer, _React$PureComponent);\n\n  function CellMeasurer() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, CellMeasurer);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = CellMeasurer.__proto__ || _Object$getPrototypeOf(CellMeasurer)).call.apply(_ref, [this].concat(args))), _this), _this._measure = function () {\n      var _this$props = _this.props,\n          cache = _this$props.cache,\n          _this$props$columnInd = _this$props.columnIndex,\n          columnIndex = _this$props$columnInd === undefined ? 0 : _this$props$columnInd,\n          parent = _this$props.parent,\n          _this$props$rowIndex = _this$props.rowIndex,\n          rowIndex = _this$props$rowIndex === undefined ? _this.props.index || 0 : _this$props$rowIndex;\n\n      var _this$_getCellMeasure = _this._getCellMeasurements(),\n          height = _this$_getCellMeasure.height,\n          width = _this$_getCellMeasure.width;\n\n      if (height !== cache.getHeight(rowIndex, columnIndex) || width !== cache.getWidth(rowIndex, columnIndex)) {\n        cache.set(rowIndex, columnIndex, width, height);\n\n        if (parent && typeof parent.recomputeGridSize === 'function') {\n          parent.recomputeGridSize({\n            columnIndex: columnIndex,\n            rowIndex: rowIndex\n          });\n        }\n      }\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(CellMeasurer, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this._maybeMeasureCell();\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate() {\n      this._maybeMeasureCell();\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var children = this.props.children;\n\n\n      return typeof children === 'function' ? children({ measure: this._measure }) : children;\n    }\n  }, {\n    key: '_getCellMeasurements',\n    value: function _getCellMeasurements() {\n      var cache = this.props.cache;\n\n\n      var node = findDOMNode(this);\n\n      // TODO Check for a bad combination of fixedWidth and missing numeric width or vice versa with height\n\n      if (node && node.ownerDocument && node.ownerDocument.defaultView && node instanceof node.ownerDocument.defaultView.HTMLElement) {\n        var styleWidth = node.style.width;\n        var styleHeight = node.style.height;\n\n        // If we are re-measuring a cell that has already been measured,\n        // It will have a hard-coded width/height from the previous measurement.\n        // The fact that we are measuring indicates this measurement is probably stale,\n        // So explicitly clear it out (eg set to \"auto\") so we can recalculate.\n        // See issue #593 for more info.\n        // Even if we are measuring initially- if we're inside of a MultiGrid component,\n        // Explicitly clear width/height before measuring to avoid being tainted by another Grid.\n        // eg top/left Grid renders before bottom/right Grid\n        // Since the CellMeasurerCache is shared between them this taints derived cell size values.\n        if (!cache.hasFixedWidth()) {\n          node.style.width = 'auto';\n        }\n        if (!cache.hasFixedHeight()) {\n          node.style.height = 'auto';\n        }\n\n        var height = Math.ceil(node.offsetHeight);\n        var width = Math.ceil(node.offsetWidth);\n\n        // Reset after measuring to avoid breaking styles; see #660\n        if (styleWidth) {\n          node.style.width = styleWidth;\n        }\n        if (styleHeight) {\n          node.style.height = styleHeight;\n        }\n\n        return { height: height, width: width };\n      } else {\n        return { height: 0, width: 0 };\n      }\n    }\n  }, {\n    key: '_maybeMeasureCell',\n    value: function _maybeMeasureCell() {\n      var _props = this.props,\n          cache = _props.cache,\n          _props$columnIndex = _props.columnIndex,\n          columnIndex = _props$columnIndex === undefined ? 0 : _props$columnIndex,\n          parent = _props.parent,\n          _props$rowIndex = _props.rowIndex,\n          rowIndex = _props$rowIndex === undefined ? this.props.index || 0 : _props$rowIndex;\n\n\n      if (!cache.has(rowIndex, columnIndex)) {\n        var _getCellMeasurements2 = this._getCellMeasurements(),\n            height = _getCellMeasurements2.height,\n            width = _getCellMeasurements2.width;\n\n        cache.set(rowIndex, columnIndex, width, height);\n\n        // If size has changed, let Grid know to re-render.\n        if (parent && typeof parent.invalidateCellSizeAfterRender === 'function') {\n          parent.invalidateCellSizeAfterRender({\n            columnIndex: columnIndex,\n            rowIndex: rowIndex\n          });\n        }\n      }\n    }\n  }]);\n\n  return CellMeasurer;\n}(React.PureComponent);\n\n// Used for DEV mode warning check\n\n\nCellMeasurer.__internalCellMeasurerFlag = false;\nCellMeasurer.propTypes = process.env.NODE_ENV === 'production' ? null : {\n  cache: function cache() {\n    return (typeof bpfrpt_proptype_CellMeasureCache === 'function' ? bpfrpt_proptype_CellMeasureCache.isRequired ? bpfrpt_proptype_CellMeasureCache.isRequired : bpfrpt_proptype_CellMeasureCache : PropTypes.shape(bpfrpt_proptype_CellMeasureCache).isRequired).apply(this, arguments);\n  },\n  children: PropTypes.oneOfType([PropTypes.func, PropTypes.node]).isRequired,\n  columnIndex: PropTypes.number,\n  index: PropTypes.number,\n  parent: PropTypes.shape({\n    invalidateCellSizeAfterRender: PropTypes.func,\n    recomputeGridSize: PropTypes.func\n  }).isRequired,\n  rowIndex: PropTypes.number\n};\nexport default CellMeasurer;\nif (process.env.NODE_ENV !== 'production') {\n  CellMeasurer.__internalCellMeasurerFlag = true;\n}\nimport { bpfrpt_proptype_CellMeasureCache } from './types';\nimport PropTypes from 'prop-types';","import _extends from 'babel-runtime/helpers/extends';\nimport _Object$getPrototypeOf from 'babel-runtime/core-js/object/get-prototype-of';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport cn from 'classnames';\nimport PropTypes from 'prop-types';\nimport * as React from 'react';\nimport { polyfill } from 'react-lifecycles-compat';\nimport createCallbackMemoizer from '../utils/createCallbackMemoizer';\nimport getScrollbarSize from 'dom-helpers/util/scrollbarSize';\n\n// @TODO Merge Collection and CollectionView\n\n/**\n * Specifies the number of milliseconds during which to disable pointer events while a scroll is in progress.\n * This improves performance and makes scrolling smoother.\n */\nvar IS_SCROLLING_TIMEOUT = 150;\n\n/**\n * Controls whether the Grid updates the DOM element's scrollLeft/scrollTop based on the current state or just observes it.\n * This prevents Grid from interrupting mouse-wheel animations (see issue #2).\n */\nvar SCROLL_POSITION_CHANGE_REASONS = {\n  OBSERVED: 'observed',\n  REQUESTED: 'requested'\n};\n\n/**\n * Monitors changes in properties (eg. cellCount) and state (eg. scroll offsets) to determine when rendering needs to occur.\n * This component does not render any visible content itself; it defers to the specified :cellLayoutManager.\n */\n\nvar CollectionView = function (_React$PureComponent) {\n  _inherits(CollectionView, _React$PureComponent);\n\n  // Invokes callbacks only when their values have changed.\n  function CollectionView() {\n    var _ref;\n\n    _classCallCheck(this, CollectionView);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    // If this component is being rendered server-side, getScrollbarSize() will return undefined.\n    // We handle this case in componentDidMount()\n    var _this = _possibleConstructorReturn(this, (_ref = CollectionView.__proto__ || _Object$getPrototypeOf(CollectionView)).call.apply(_ref, [this].concat(args)));\n\n    _this.state = {\n      isScrolling: false,\n      scrollLeft: 0,\n      scrollTop: 0\n    };\n    _this._calculateSizeAndPositionDataOnNextUpdate = false;\n    _this._onSectionRenderedMemoizer = createCallbackMemoizer();\n    _this._onScrollMemoizer = createCallbackMemoizer(false);\n\n    _this._invokeOnSectionRenderedHelper = function () {\n      var _this$props = _this.props,\n          cellLayoutManager = _this$props.cellLayoutManager,\n          onSectionRendered = _this$props.onSectionRendered;\n\n\n      _this._onSectionRenderedMemoizer({\n        callback: onSectionRendered,\n        indices: {\n          indices: cellLayoutManager.getLastRenderedIndices()\n        }\n      });\n    };\n\n    _this._setScrollingContainerRef = function (ref) {\n      _this._scrollingContainer = ref;\n    };\n\n    _this._updateScrollPositionForScrollToCell = function () {\n      var _this$props2 = _this.props,\n          cellLayoutManager = _this$props2.cellLayoutManager,\n          height = _this$props2.height,\n          scrollToAlignment = _this$props2.scrollToAlignment,\n          scrollToCell = _this$props2.scrollToCell,\n          width = _this$props2.width;\n      var _this$state = _this.state,\n          scrollLeft = _this$state.scrollLeft,\n          scrollTop = _this$state.scrollTop;\n\n\n      if (scrollToCell >= 0) {\n        var scrollPosition = cellLayoutManager.getScrollPositionForCell({\n          align: scrollToAlignment,\n          cellIndex: scrollToCell,\n          height: height,\n          scrollLeft: scrollLeft,\n          scrollTop: scrollTop,\n          width: width\n        });\n\n        if (scrollPosition.scrollLeft !== scrollLeft || scrollPosition.scrollTop !== scrollTop) {\n          _this._setScrollPosition(scrollPosition);\n        }\n      }\n    };\n\n    _this._onScroll = function (event) {\n      // In certain edge-cases React dispatches an onScroll event with an invalid target.scrollLeft / target.scrollTop.\n      // This invalid event can be detected by comparing event.target to this component's scrollable DOM element.\n      // See issue #404 for more information.\n      if (event.target !== _this._scrollingContainer) {\n        return;\n      }\n\n      // Prevent pointer events from interrupting a smooth scroll\n      _this._enablePointerEventsAfterDelay();\n\n      // When this component is shrunk drastically, React dispatches a series of back-to-back scroll events,\n      // Gradually converging on a scrollTop that is within the bounds of the new, smaller height.\n      // This causes a series of rapid renders that is slow for long lists.\n      // We can avoid that by doing some simple bounds checking to ensure that scrollTop never exceeds the total height.\n      var _this$props3 = _this.props,\n          cellLayoutManager = _this$props3.cellLayoutManager,\n          height = _this$props3.height,\n          isScrollingChange = _this$props3.isScrollingChange,\n          width = _this$props3.width;\n\n      var scrollbarSize = _this._scrollbarSize;\n\n      var _cellLayoutManager$ge = cellLayoutManager.getTotalSize(),\n          totalHeight = _cellLayoutManager$ge.height,\n          totalWidth = _cellLayoutManager$ge.width;\n\n      var scrollLeft = Math.max(0, Math.min(totalWidth - width + scrollbarSize, event.target.scrollLeft));\n      var scrollTop = Math.max(0, Math.min(totalHeight - height + scrollbarSize, event.target.scrollTop));\n\n      // Certain devices (like Apple touchpad) rapid-fire duplicate events.\n      // Don't force a re-render if this is the case.\n      // The mouse may move faster then the animation frame does.\n      // Use requestAnimationFrame to avoid over-updating.\n      if (_this.state.scrollLeft !== scrollLeft || _this.state.scrollTop !== scrollTop) {\n        // Browsers with cancelable scroll events (eg. Firefox) interrupt scrolling animations if scrollTop/scrollLeft is set.\n        // Other browsers (eg. Safari) don't scroll as well without the help under certain conditions (DOM or style changes during scrolling).\n        // All things considered, this seems to be the best current work around that I'm aware of.\n        // For more information see https://github.com/bvaughn/react-virtualized/pull/124\n        var scrollPositionChangeReason = event.cancelable ? SCROLL_POSITION_CHANGE_REASONS.OBSERVED : SCROLL_POSITION_CHANGE_REASONS.REQUESTED;\n\n        // Synchronously set :isScrolling the first time (since _setNextState will reschedule its animation frame each time it's called)\n        if (!_this.state.isScrolling) {\n          isScrollingChange(true);\n        }\n\n        _this.setState({\n          isScrolling: true,\n          scrollLeft: scrollLeft,\n          scrollPositionChangeReason: scrollPositionChangeReason,\n          scrollTop: scrollTop\n        });\n      }\n\n      _this._invokeOnScrollMemoizer({\n        scrollLeft: scrollLeft,\n        scrollTop: scrollTop,\n        totalWidth: totalWidth,\n        totalHeight: totalHeight\n      });\n    };\n\n    _this._scrollbarSize = getScrollbarSize();\n    if (_this._scrollbarSize === undefined) {\n      _this._scrollbarSizeMeasured = false;\n      _this._scrollbarSize = 0;\n    } else {\n      _this._scrollbarSizeMeasured = true;\n    }\n    return _this;\n  }\n\n  /**\n   * Forced recompute of cell sizes and positions.\n   * This function should be called if cell sizes have changed but nothing else has.\n   * Since cell positions are calculated by callbacks, the collection view has no way of detecting when the underlying data has changed.\n   */\n\n\n  _createClass(CollectionView, [{\n    key: 'recomputeCellSizesAndPositions',\n    value: function recomputeCellSizesAndPositions() {\n      this._calculateSizeAndPositionDataOnNextUpdate = true;\n      this.forceUpdate();\n    }\n\n    /* ---------------------------- Component lifecycle methods ---------------------------- */\n\n    /**\n     * @private\n     * This method updates scrollLeft/scrollTop in state for the following conditions:\n     * 1) Empty content (0 rows or columns)\n     * 2) New scroll props overriding the current state\n     * 3) Cells-count or cells-size has changed, making previous scroll offsets invalid\n     */\n\n  }, {\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var _props = this.props,\n          cellLayoutManager = _props.cellLayoutManager,\n          scrollLeft = _props.scrollLeft,\n          scrollToCell = _props.scrollToCell,\n          scrollTop = _props.scrollTop;\n\n      // If this component was first rendered server-side, scrollbar size will be undefined.\n      // In that event we need to remeasure.\n\n      if (!this._scrollbarSizeMeasured) {\n        this._scrollbarSize = getScrollbarSize();\n        this._scrollbarSizeMeasured = true;\n        this.setState({});\n      }\n\n      if (scrollToCell >= 0) {\n        this._updateScrollPositionForScrollToCell();\n      } else if (scrollLeft >= 0 || scrollTop >= 0) {\n        this._setScrollPosition({ scrollLeft: scrollLeft, scrollTop: scrollTop });\n      }\n\n      // Update onSectionRendered callback.\n      this._invokeOnSectionRenderedHelper();\n\n      var _cellLayoutManager$ge2 = cellLayoutManager.getTotalSize(),\n          totalHeight = _cellLayoutManager$ge2.height,\n          totalWidth = _cellLayoutManager$ge2.width;\n\n      // Initialize onScroll callback.\n\n\n      this._invokeOnScrollMemoizer({\n        scrollLeft: scrollLeft || 0,\n        scrollTop: scrollTop || 0,\n        totalHeight: totalHeight,\n        totalWidth: totalWidth\n      });\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps, prevState) {\n      var _props2 = this.props,\n          height = _props2.height,\n          scrollToAlignment = _props2.scrollToAlignment,\n          scrollToCell = _props2.scrollToCell,\n          width = _props2.width;\n      var _state = this.state,\n          scrollLeft = _state.scrollLeft,\n          scrollPositionChangeReason = _state.scrollPositionChangeReason,\n          scrollTop = _state.scrollTop;\n\n      // Make sure requested changes to :scrollLeft or :scrollTop get applied.\n      // Assigning to scrollLeft/scrollTop tells the browser to interrupt any running scroll animations,\n      // And to discard any pending async changes to the scroll position that may have happened in the meantime (e.g. on a separate scrolling thread).\n      // So we only set these when we require an adjustment of the scroll position.\n      // See issue #2 for more information.\n\n      if (scrollPositionChangeReason === SCROLL_POSITION_CHANGE_REASONS.REQUESTED) {\n        if (scrollLeft >= 0 && scrollLeft !== prevState.scrollLeft && scrollLeft !== this._scrollingContainer.scrollLeft) {\n          this._scrollingContainer.scrollLeft = scrollLeft;\n        }\n        if (scrollTop >= 0 && scrollTop !== prevState.scrollTop && scrollTop !== this._scrollingContainer.scrollTop) {\n          this._scrollingContainer.scrollTop = scrollTop;\n        }\n      }\n\n      // Update scroll offsets if the current :scrollToCell values requires it\n      if (height !== prevProps.height || scrollToAlignment !== prevProps.scrollToAlignment || scrollToCell !== prevProps.scrollToCell || width !== prevProps.width) {\n        this._updateScrollPositionForScrollToCell();\n      }\n\n      // Update onRowsRendered callback if start/stop indices have changed\n      this._invokeOnSectionRenderedHelper();\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      if (this._disablePointerEventsTimeoutId) {\n        clearTimeout(this._disablePointerEventsTimeoutId);\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props3 = this.props,\n          autoHeight = _props3.autoHeight,\n          cellCount = _props3.cellCount,\n          cellLayoutManager = _props3.cellLayoutManager,\n          className = _props3.className,\n          height = _props3.height,\n          horizontalOverscanSize = _props3.horizontalOverscanSize,\n          id = _props3.id,\n          noContentRenderer = _props3.noContentRenderer,\n          style = _props3.style,\n          verticalOverscanSize = _props3.verticalOverscanSize,\n          width = _props3.width;\n      var _state2 = this.state,\n          isScrolling = _state2.isScrolling,\n          scrollLeft = _state2.scrollLeft,\n          scrollTop = _state2.scrollTop;\n\n      // Memoization reset\n\n      if (this._lastRenderedCellCount !== cellCount || this._lastRenderedCellLayoutManager !== cellLayoutManager || this._calculateSizeAndPositionDataOnNextUpdate) {\n        this._lastRenderedCellCount = cellCount;\n        this._lastRenderedCellLayoutManager = cellLayoutManager;\n        this._calculateSizeAndPositionDataOnNextUpdate = false;\n\n        cellLayoutManager.calculateSizeAndPositionData();\n      }\n\n      var _cellLayoutManager$ge3 = cellLayoutManager.getTotalSize(),\n          totalHeight = _cellLayoutManager$ge3.height,\n          totalWidth = _cellLayoutManager$ge3.width;\n\n      // Safely expand the rendered area by the specified overscan amount\n\n\n      var left = Math.max(0, scrollLeft - horizontalOverscanSize);\n      var top = Math.max(0, scrollTop - verticalOverscanSize);\n      var right = Math.min(totalWidth, scrollLeft + width + horizontalOverscanSize);\n      var bottom = Math.min(totalHeight, scrollTop + height + verticalOverscanSize);\n\n      var childrenToDisplay = height > 0 && width > 0 ? cellLayoutManager.cellRenderers({\n        height: bottom - top,\n        isScrolling: isScrolling,\n        width: right - left,\n        x: left,\n        y: top\n      }) : [];\n\n      var collectionStyle = {\n        boxSizing: 'border-box',\n        direction: 'ltr',\n        height: autoHeight ? 'auto' : height,\n        position: 'relative',\n        WebkitOverflowScrolling: 'touch',\n        width: width,\n        willChange: 'transform'\n      };\n\n      // Force browser to hide scrollbars when we know they aren't necessary.\n      // Otherwise once scrollbars appear they may not disappear again.\n      // For more info see issue #116\n      var verticalScrollBarSize = totalHeight > height ? this._scrollbarSize : 0;\n      var horizontalScrollBarSize = totalWidth > width ? this._scrollbarSize : 0;\n\n      // Also explicitly init styles to 'auto' if scrollbars are required.\n      // This works around an obscure edge case where external CSS styles have not yet been loaded,\n      // But an initial scroll index of offset is set as an external prop.\n      // Without this style, Grid would render the correct range of cells but would NOT update its internal offset.\n      // This was originally reported via clauderic/react-infinite-calendar/issues/23\n      collectionStyle.overflowX = totalWidth + verticalScrollBarSize <= width ? 'hidden' : 'auto';\n      collectionStyle.overflowY = totalHeight + horizontalScrollBarSize <= height ? 'hidden' : 'auto';\n\n      return React.createElement(\n        'div',\n        {\n          ref: this._setScrollingContainerRef,\n          'aria-label': this.props['aria-label'],\n          className: cn('ReactVirtualized__Collection', className),\n          id: id,\n          onScroll: this._onScroll,\n          role: 'grid',\n          style: _extends({}, collectionStyle, style),\n          tabIndex: 0 },\n        cellCount > 0 && React.createElement(\n          'div',\n          {\n            className: 'ReactVirtualized__Collection__innerScrollContainer',\n            style: {\n              height: totalHeight,\n              maxHeight: totalHeight,\n              maxWidth: totalWidth,\n              overflow: 'hidden',\n              pointerEvents: isScrolling ? 'none' : '',\n              width: totalWidth\n            } },\n          childrenToDisplay\n        ),\n        cellCount === 0 && noContentRenderer()\n      );\n    }\n\n    /* ---------------------------- Helper methods ---------------------------- */\n\n    /**\n     * Sets an :isScrolling flag for a small window of time.\n     * This flag is used to disable pointer events on the scrollable portion of the Collection.\n     * This prevents jerky/stuttery mouse-wheel scrolling.\n     */\n\n  }, {\n    key: '_enablePointerEventsAfterDelay',\n    value: function _enablePointerEventsAfterDelay() {\n      var _this2 = this;\n\n      if (this._disablePointerEventsTimeoutId) {\n        clearTimeout(this._disablePointerEventsTimeoutId);\n      }\n\n      this._disablePointerEventsTimeoutId = setTimeout(function () {\n        var isScrollingChange = _this2.props.isScrollingChange;\n\n\n        isScrollingChange(false);\n\n        _this2._disablePointerEventsTimeoutId = null;\n        _this2.setState({\n          isScrolling: false\n        });\n      }, IS_SCROLLING_TIMEOUT);\n    }\n  }, {\n    key: '_invokeOnScrollMemoizer',\n    value: function _invokeOnScrollMemoizer(_ref2) {\n      var _this3 = this;\n\n      var scrollLeft = _ref2.scrollLeft,\n          scrollTop = _ref2.scrollTop,\n          totalHeight = _ref2.totalHeight,\n          totalWidth = _ref2.totalWidth;\n\n      this._onScrollMemoizer({\n        callback: function callback(_ref3) {\n          var scrollLeft = _ref3.scrollLeft,\n              scrollTop = _ref3.scrollTop;\n          var _props4 = _this3.props,\n              height = _props4.height,\n              onScroll = _props4.onScroll,\n              width = _props4.width;\n\n\n          onScroll({\n            clientHeight: height,\n            clientWidth: width,\n            scrollHeight: totalHeight,\n            scrollLeft: scrollLeft,\n            scrollTop: scrollTop,\n            scrollWidth: totalWidth\n          });\n        },\n        indices: {\n          scrollLeft: scrollLeft,\n          scrollTop: scrollTop\n        }\n      });\n    }\n  }, {\n    key: '_setScrollPosition',\n    value: function _setScrollPosition(_ref4) {\n      var scrollLeft = _ref4.scrollLeft,\n          scrollTop = _ref4.scrollTop;\n\n      var newState = {\n        scrollPositionChangeReason: SCROLL_POSITION_CHANGE_REASONS.REQUESTED\n      };\n\n      if (scrollLeft >= 0) {\n        newState.scrollLeft = scrollLeft;\n      }\n\n      if (scrollTop >= 0) {\n        newState.scrollTop = scrollTop;\n      }\n\n      if (scrollLeft >= 0 && scrollLeft !== this.state.scrollLeft || scrollTop >= 0 && scrollTop !== this.state.scrollTop) {\n        this.setState(newState);\n      }\n    }\n  }], [{\n    key: 'getDerivedStateFromProps',\n    value: function getDerivedStateFromProps(nextProps, prevState) {\n      if (nextProps.cellCount === 0 && (prevState.scrollLeft !== 0 || prevState.scrollTop !== 0)) {\n        return {\n          scrollLeft: 0,\n          scrollTop: 0\n        };\n      } else if (nextProps.scrollLeft !== prevState.scrollLeft || nextProps.scrollTop !== prevState.scrollTop) {\n        return {\n          scrollLeft: nextProps.scrollLeft != null ? nextProps.scrollLeft : prevState.scrollLeft,\n          scrollTop: nextProps.scrollTop != null ? nextProps.scrollTop : prevState.scrollTop\n        };\n      }\n\n      return null;\n    }\n  }]);\n\n  return CollectionView;\n}(React.PureComponent);\n\nCollectionView.defaultProps = {\n  'aria-label': 'grid',\n  horizontalOverscanSize: 0,\n  noContentRenderer: function noContentRenderer() {\n    return null;\n  },\n  onScroll: function onScroll() {\n    return null;\n  },\n  onSectionRendered: function onSectionRendered() {\n    return null;\n  },\n  scrollToAlignment: 'auto',\n  scrollToCell: -1,\n  style: {},\n  verticalOverscanSize: 0\n};\nCollectionView.propTypes = process.env.NODE_ENV !== \"production\" ? {\n  'aria-label': PropTypes.string,\n\n  /**\n   * Removes fixed height from the scrollingContainer so that the total height\n   * of rows can stretch the window. Intended for use with WindowScroller\n   */\n  autoHeight: PropTypes.bool,\n\n  /**\n   * Number of cells in collection.\n   */\n  cellCount: PropTypes.number.isRequired,\n\n  /**\n   * Calculates cell sizes and positions and manages rendering the appropriate cells given a specified window.\n   */\n  cellLayoutManager: PropTypes.object.isRequired,\n\n  /**\n   * Optional custom CSS class name to attach to root Collection element.\n   */\n  className: PropTypes.string,\n\n  /**\n   * Height of Collection; this property determines the number of visible (vs virtualized) rows.\n   */\n  height: PropTypes.number.isRequired,\n\n  /**\n   * Optional custom id to attach to root Collection element.\n   */\n  id: PropTypes.string,\n\n  /**\n   * Enables the `Collection` to horiontally \"overscan\" its content similar to how `Grid` does.\n   * This can reduce flicker around the edges when a user scrolls quickly.\n   */\n  horizontalOverscanSize: PropTypes.number.isRequired,\n\n  isScrollingChange: PropTypes.func,\n\n  /**\n   * Optional renderer to be used in place of rows when either :rowCount or :cellCount is 0.\n   */\n  noContentRenderer: PropTypes.func.isRequired,\n\n  /**\n   * Callback invoked whenever the scroll offset changes within the inner scrollable region.\n   * This callback can be used to sync scrolling between lists, tables, or grids.\n   * ({ clientHeight, clientWidth, scrollHeight, scrollLeft, scrollTop, scrollWidth }): void\n   */\n  onScroll: PropTypes.func.isRequired,\n\n  /**\n   * Callback invoked with information about the section of the Collection that was just rendered.\n   * This callback is passed a named :indices parameter which is an Array of the most recently rendered section indices.\n   */\n  onSectionRendered: PropTypes.func.isRequired,\n\n  /**\n   * Horizontal offset.\n   */\n  scrollLeft: PropTypes.number,\n\n  /**\n   * Controls scroll-to-cell behavior of the Grid.\n   * The default (\"auto\") scrolls the least amount possible to ensure that the specified cell is fully visible.\n   * Use \"start\" to align cells to the top/left of the Grid and \"end\" to align bottom/right.\n   */\n  scrollToAlignment: PropTypes.oneOf(['auto', 'end', 'start', 'center']).isRequired,\n\n  /**\n   * Cell index to ensure visible (by forcefully scrolling if necessary).\n   */\n  scrollToCell: PropTypes.number.isRequired,\n\n  /**\n   * Vertical offset.\n   */\n  scrollTop: PropTypes.number,\n\n  /**\n   * Optional custom inline style to attach to root Collection element.\n   */\n  style: PropTypes.object,\n\n  /**\n   * Enables the `Collection` to vertically \"overscan\" its content similar to how `Grid` does.\n   * This can reduce flicker around the edges when a user scrolls quickly.\n   */\n  verticalOverscanSize: PropTypes.number.isRequired,\n\n  /**\n   * Width of Collection; this property determines the number of visible (vs virtualized) columns.\n   */\n  width: PropTypes.number.isRequired\n} : {};\n\n\npolyfill(CollectionView);\n\nexport default CollectionView;","import _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\n\n/**\n * A section of the Window.\n * Window Sections are used to group nearby cells.\n * This enables us to more quickly determine which cells to display in a given region of the Window.\n * Sections have a fixed size and contain 0 to many cells (tracked by their indices).\n */\nvar Section = function () {\n  function Section(_ref) {\n    var height = _ref.height,\n        width = _ref.width,\n        x = _ref.x,\n        y = _ref.y;\n\n    _classCallCheck(this, Section);\n\n    this.height = height;\n    this.width = width;\n    this.x = x;\n    this.y = y;\n\n    this._indexMap = {};\n    this._indices = [];\n  }\n\n  /** Add a cell to this section. */\n\n\n  _createClass(Section, [{\n    key: 'addCellIndex',\n    value: function addCellIndex(_ref2) {\n      var index = _ref2.index;\n\n      if (!this._indexMap[index]) {\n        this._indexMap[index] = true;\n        this._indices.push(index);\n      }\n    }\n\n    /** Get all cell indices that have been added to this section. */\n\n  }, {\n    key: 'getCellIndices',\n    value: function getCellIndices() {\n      return this._indices;\n    }\n\n    /** Intended for debugger/test purposes only */\n\n  }, {\n    key: 'toString',\n    value: function toString() {\n      return this.x + ',' + this.y + ' ' + this.width + 'x' + this.height;\n    }\n  }]);\n\n  return Section;\n}();\n\nexport default Section;\nimport { bpfrpt_proptype_Index } from './types';\nimport { bpfrpt_proptype_SizeAndPositionInfo } from './types';","import _Object$keys from 'babel-runtime/core-js/object/keys';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\n/**\n * Window Sections are used to group nearby cells.\n * This enables us to more quickly determine which cells to display in a given region of the Window.\n * \n */\nimport Section from './Section';\n\n\nvar SECTION_SIZE = 100;\n\n/**\n * Contains 0 to many Sections.\n * Grows (and adds Sections) dynamically as cells are registered.\n * Automatically adds cells to the appropriate Section(s).\n */\nvar SectionManager = function () {\n  function SectionManager() {\n    var sectionSize = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : SECTION_SIZE;\n\n    _classCallCheck(this, SectionManager);\n\n    this._sectionSize = sectionSize;\n\n    this._cellMetadata = [];\n    this._sections = {};\n  }\n\n  /**\n   * Gets all cell indices contained in the specified region.\n   * A region may encompass 1 or more Sections.\n   */\n\n\n  _createClass(SectionManager, [{\n    key: 'getCellIndices',\n    value: function getCellIndices(_ref) {\n      var height = _ref.height,\n          width = _ref.width,\n          x = _ref.x,\n          y = _ref.y;\n\n      var indices = {};\n\n      this.getSections({ height: height, width: width, x: x, y: y }).forEach(function (section) {\n        return section.getCellIndices().forEach(function (index) {\n          indices[index] = index;\n        });\n      });\n\n      // Object keys are strings; this function returns numbers\n      return _Object$keys(indices).map(function (index) {\n        return indices[index];\n      });\n    }\n\n    /** Get size and position information for the cell specified. */\n\n  }, {\n    key: 'getCellMetadata',\n    value: function getCellMetadata(_ref2) {\n      var index = _ref2.index;\n\n      return this._cellMetadata[index];\n    }\n\n    /** Get all Sections overlapping the specified region. */\n\n  }, {\n    key: 'getSections',\n    value: function getSections(_ref3) {\n      var height = _ref3.height,\n          width = _ref3.width,\n          x = _ref3.x,\n          y = _ref3.y;\n\n      var sectionXStart = Math.floor(x / this._sectionSize);\n      var sectionXStop = Math.floor((x + width - 1) / this._sectionSize);\n      var sectionYStart = Math.floor(y / this._sectionSize);\n      var sectionYStop = Math.floor((y + height - 1) / this._sectionSize);\n\n      var sections = [];\n\n      for (var sectionX = sectionXStart; sectionX <= sectionXStop; sectionX++) {\n        for (var sectionY = sectionYStart; sectionY <= sectionYStop; sectionY++) {\n          var key = sectionX + '.' + sectionY;\n\n          if (!this._sections[key]) {\n            this._sections[key] = new Section({\n              height: this._sectionSize,\n              width: this._sectionSize,\n              x: sectionX * this._sectionSize,\n              y: sectionY * this._sectionSize\n            });\n          }\n\n          sections.push(this._sections[key]);\n        }\n      }\n\n      return sections;\n    }\n\n    /** Total number of Sections based on the currently registered cells. */\n\n  }, {\n    key: 'getTotalSectionCount',\n    value: function getTotalSectionCount() {\n      return _Object$keys(this._sections).length;\n    }\n\n    /** Intended for debugger/test purposes only */\n\n  }, {\n    key: 'toString',\n    value: function toString() {\n      var _this = this;\n\n      return _Object$keys(this._sections).map(function (index) {\n        return _this._sections[index].toString();\n      });\n    }\n\n    /** Adds a cell to the appropriate Sections and registers it metadata for later retrievable. */\n\n  }, {\n    key: 'registerCell',\n    value: function registerCell(_ref4) {\n      var cellMetadatum = _ref4.cellMetadatum,\n          index = _ref4.index;\n\n      this._cellMetadata[index] = cellMetadatum;\n\n      this.getSections(cellMetadatum).forEach(function (section) {\n        return section.addCellIndex({ index: index });\n      });\n    }\n  }]);\n\n  return SectionManager;\n}();\n\nexport default SectionManager;\nimport { bpfrpt_proptype_Index } from './types';\nimport { bpfrpt_proptype_SizeAndPositionInfo } from './types';","import _Object$getPrototypeOf from 'babel-runtime/core-js/object/get-prototype-of';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport PropTypes from 'prop-types';\nimport * as React from 'react';\n\n/**\n * High-order component that auto-calculates column-widths for `Grid` cells.\n */\n\nvar ColumnSizer = function (_React$PureComponent) {\n  _inherits(ColumnSizer, _React$PureComponent);\n\n  function ColumnSizer(props, context) {\n    _classCallCheck(this, ColumnSizer);\n\n    var _this = _possibleConstructorReturn(this, (ColumnSizer.__proto__ || _Object$getPrototypeOf(ColumnSizer)).call(this, props, context));\n\n    _this._registerChild = _this._registerChild.bind(_this);\n    return _this;\n  }\n\n  _createClass(ColumnSizer, [{\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps) {\n      var _props = this.props,\n          columnMaxWidth = _props.columnMaxWidth,\n          columnMinWidth = _props.columnMinWidth,\n          columnCount = _props.columnCount,\n          width = _props.width;\n\n\n      if (columnMaxWidth !== prevProps.columnMaxWidth || columnMinWidth !== prevProps.columnMinWidth || columnCount !== prevProps.columnCount || width !== prevProps.width) {\n        if (this._registeredChild) {\n          this._registeredChild.recomputeGridSize();\n        }\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props2 = this.props,\n          children = _props2.children,\n          columnMaxWidth = _props2.columnMaxWidth,\n          columnMinWidth = _props2.columnMinWidth,\n          columnCount = _props2.columnCount,\n          width = _props2.width;\n\n\n      var safeColumnMinWidth = columnMinWidth || 1;\n\n      var safeColumnMaxWidth = columnMaxWidth ? Math.min(columnMaxWidth, width) : width;\n\n      var columnWidth = width / columnCount;\n      columnWidth = Math.max(safeColumnMinWidth, columnWidth);\n      columnWidth = Math.min(safeColumnMaxWidth, columnWidth);\n      columnWidth = Math.floor(columnWidth);\n\n      var adjustedWidth = Math.min(width, columnWidth * columnCount);\n\n      return children({\n        adjustedWidth: adjustedWidth,\n        columnWidth: columnWidth,\n        getColumnWidth: function getColumnWidth() {\n          return columnWidth;\n        },\n        registerChild: this._registerChild\n      });\n    }\n  }, {\n    key: '_registerChild',\n    value: function _registerChild(child) {\n      if (child && typeof child.recomputeGridSize !== 'function') {\n        throw Error('Unexpected child type registered; only Grid/MultiGrid children are supported.');\n      }\n\n      this._registeredChild = child;\n\n      if (this._registeredChild) {\n        this._registeredChild.recomputeGridSize();\n      }\n    }\n  }]);\n\n  return ColumnSizer;\n}(React.PureComponent);\n\nexport default ColumnSizer;\nColumnSizer.propTypes = process.env.NODE_ENV !== \"production\" ? {\n  /**\n   * Function responsible for rendering a virtualized Grid.\n   * This function should implement the following signature:\n   * ({ adjustedWidth, getColumnWidth, registerChild }) => PropTypes.element\n   *\n   * The specified :getColumnWidth function should be passed to the Grid's :columnWidth property.\n   * The :registerChild should be passed to the Grid's :ref property.\n   * The :adjustedWidth property is optional; it reflects the lesser of the overall width or the width of all columns.\n   */\n  children: PropTypes.func.isRequired,\n\n  /** Optional maximum allowed column width */\n  columnMaxWidth: PropTypes.number,\n\n  /** Optional minimum allowed column width */\n  columnMinWidth: PropTypes.number,\n\n  /** Number of columns in Grid or Table child */\n  columnCount: PropTypes.number.isRequired,\n\n  /** Width of Grid or Table child */\n  width: PropTypes.number.isRequired\n} : {};","import ColumnSizer from './ColumnSizer';\n\nexport default ColumnSizer;\nexport { ColumnSizer };","var DEFAULT_MAX_ELEMENT_SIZE = 1500000;\nvar CHROME_MAX_ELEMENT_SIZE = 1.67771e7;\n\nvar isBrowser = function isBrowser() {\n  return typeof window !== 'undefined';\n};\n\nvar isChrome = function isChrome() {\n  return !!window.chrome && !!window.chrome.webstore;\n};\n\nexport var getMaxElementSize = function getMaxElementSize() {\n  if (isBrowser()) {\n    if (isChrome()) {\n      return CHROME_MAX_ELEMENT_SIZE;\n    }\n  }\n  return DEFAULT_MAX_ELEMENT_SIZE;\n};","import _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\n\n\nimport CellSizeAndPositionManager from './CellSizeAndPositionManager';\n\nimport { getMaxElementSize } from './maxElementSize.js';\n\n/**\n * Browsers have scroll offset limitations (eg Chrome stops scrolling at ~33.5M pixels where as Edge tops out at ~1.5M pixels).\n * After a certain position, the browser won't allow the user to scroll further (even via JavaScript scroll offset adjustments).\n * This util picks a lower ceiling for max size and artificially adjusts positions within to make it transparent for users.\n */\n\n/**\n * Extends CellSizeAndPositionManager and adds scaling behavior for lists that are too large to fit within a browser's native limits.\n */\nvar ScalingCellSizeAndPositionManager = function () {\n  function ScalingCellSizeAndPositionManager(_ref) {\n    var _ref$maxScrollSize = _ref.maxScrollSize,\n        maxScrollSize = _ref$maxScrollSize === undefined ? getMaxElementSize() : _ref$maxScrollSize,\n        params = _objectWithoutProperties(_ref, ['maxScrollSize']);\n\n    _classCallCheck(this, ScalingCellSizeAndPositionManager);\n\n    // Favor composition over inheritance to simplify IE10 support\n    this._cellSizeAndPositionManager = new CellSizeAndPositionManager(params);\n    this._maxScrollSize = maxScrollSize;\n  }\n\n  _createClass(ScalingCellSizeAndPositionManager, [{\n    key: 'areOffsetsAdjusted',\n    value: function areOffsetsAdjusted() {\n      return this._cellSizeAndPositionManager.getTotalSize() > this._maxScrollSize;\n    }\n  }, {\n    key: 'configure',\n    value: function configure(params) {\n      this._cellSizeAndPositionManager.configure(params);\n    }\n  }, {\n    key: 'getCellCount',\n    value: function getCellCount() {\n      return this._cellSizeAndPositionManager.getCellCount();\n    }\n  }, {\n    key: 'getEstimatedCellSize',\n    value: function getEstimatedCellSize() {\n      return this._cellSizeAndPositionManager.getEstimatedCellSize();\n    }\n  }, {\n    key: 'getLastMeasuredIndex',\n    value: function getLastMeasuredIndex() {\n      return this._cellSizeAndPositionManager.getLastMeasuredIndex();\n    }\n\n    /**\n     * Number of pixels a cell at the given position (offset) should be shifted in order to fit within the scaled container.\n     * The offset passed to this function is scaled (safe) as well.\n     */\n\n  }, {\n    key: 'getOffsetAdjustment',\n    value: function getOffsetAdjustment(_ref2) {\n      var containerSize = _ref2.containerSize,\n          offset = _ref2.offset;\n\n      var totalSize = this._cellSizeAndPositionManager.getTotalSize();\n      var safeTotalSize = this.getTotalSize();\n      var offsetPercentage = this._getOffsetPercentage({\n        containerSize: containerSize,\n        offset: offset,\n        totalSize: safeTotalSize\n      });\n\n      return Math.round(offsetPercentage * (safeTotalSize - totalSize));\n    }\n  }, {\n    key: 'getSizeAndPositionOfCell',\n    value: function getSizeAndPositionOfCell(index) {\n      return this._cellSizeAndPositionManager.getSizeAndPositionOfCell(index);\n    }\n  }, {\n    key: 'getSizeAndPositionOfLastMeasuredCell',\n    value: function getSizeAndPositionOfLastMeasuredCell() {\n      return this._cellSizeAndPositionManager.getSizeAndPositionOfLastMeasuredCell();\n    }\n\n    /** See CellSizeAndPositionManager#getTotalSize */\n\n  }, {\n    key: 'getTotalSize',\n    value: function getTotalSize() {\n      return Math.min(this._maxScrollSize, this._cellSizeAndPositionManager.getTotalSize());\n    }\n\n    /** See CellSizeAndPositionManager#getUpdatedOffsetForIndex */\n\n  }, {\n    key: 'getUpdatedOffsetForIndex',\n    value: function getUpdatedOffsetForIndex(_ref3) {\n      var _ref3$align = _ref3.align,\n          align = _ref3$align === undefined ? 'auto' : _ref3$align,\n          containerSize = _ref3.containerSize,\n          currentOffset = _ref3.currentOffset,\n          targetIndex = _ref3.targetIndex;\n\n      currentOffset = this._safeOffsetToOffset({\n        containerSize: containerSize,\n        offset: currentOffset\n      });\n\n      var offset = this._cellSizeAndPositionManager.getUpdatedOffsetForIndex({\n        align: align,\n        containerSize: containerSize,\n        currentOffset: currentOffset,\n        targetIndex: targetIndex\n      });\n\n      return this._offsetToSafeOffset({\n        containerSize: containerSize,\n        offset: offset\n      });\n    }\n\n    /** See CellSizeAndPositionManager#getVisibleCellRange */\n\n  }, {\n    key: 'getVisibleCellRange',\n    value: function getVisibleCellRange(_ref4) {\n      var containerSize = _ref4.containerSize,\n          offset = _ref4.offset;\n\n      offset = this._safeOffsetToOffset({\n        containerSize: containerSize,\n        offset: offset\n      });\n\n      return this._cellSizeAndPositionManager.getVisibleCellRange({\n        containerSize: containerSize,\n        offset: offset\n      });\n    }\n  }, {\n    key: 'resetCell',\n    value: function resetCell(index) {\n      this._cellSizeAndPositionManager.resetCell(index);\n    }\n  }, {\n    key: '_getOffsetPercentage',\n    value: function _getOffsetPercentage(_ref5) {\n      var containerSize = _ref5.containerSize,\n          offset = _ref5.offset,\n          totalSize = _ref5.totalSize;\n\n      return totalSize <= containerSize ? 0 : offset / (totalSize - containerSize);\n    }\n  }, {\n    key: '_offsetToSafeOffset',\n    value: function _offsetToSafeOffset(_ref6) {\n      var containerSize = _ref6.containerSize,\n          offset = _ref6.offset;\n\n      var totalSize = this._cellSizeAndPositionManager.getTotalSize();\n      var safeTotalSize = this.getTotalSize();\n\n      if (totalSize === safeTotalSize) {\n        return offset;\n      } else {\n        var offsetPercentage = this._getOffsetPercentage({\n          containerSize: containerSize,\n          offset: offset,\n          totalSize: totalSize\n        });\n\n        return Math.round(offsetPercentage * (safeTotalSize - containerSize));\n      }\n    }\n  }, {\n    key: '_safeOffsetToOffset',\n    value: function _safeOffsetToOffset(_ref7) {\n      var containerSize = _ref7.containerSize,\n          offset = _ref7.offset;\n\n      var totalSize = this._cellSizeAndPositionManager.getTotalSize();\n      var safeTotalSize = this.getTotalSize();\n\n      if (totalSize === safeTotalSize) {\n        return offset;\n      } else {\n        var offsetPercentage = this._getOffsetPercentage({\n          containerSize: containerSize,\n          offset: offset,\n          totalSize: safeTotalSize\n        });\n\n        return Math.round(offsetPercentage * (totalSize - containerSize));\n      }\n    }\n  }]);\n\n  return ScalingCellSizeAndPositionManager;\n}();\n\nexport default ScalingCellSizeAndPositionManager;\nimport { bpfrpt_proptype_Alignment } from '../types';\nimport { bpfrpt_proptype_CellSizeGetter } from '../types';\nimport { bpfrpt_proptype_VisibleCellRange } from '../types';","import { caf, raf } from './animationFrame';\n\nvar bpfrpt_proptype_AnimationTimeoutId = process.env.NODE_ENV === 'production' ? null : {\n  id: PropTypes.number.isRequired\n};\n\n\nexport var cancelAnimationTimeout = function cancelAnimationTimeout(frame) {\n  return caf(frame.id);\n};\n\n/**\n * Recursively calls requestAnimationFrame until a specified delay has been met or exceeded.\n * When the delay time has been reached the function you're timing out will be called.\n *\n * Credit: Joe Lambert (https://gist.github.com/joelambert/1002116#file-requesttimeout-js)\n */\nexport var requestAnimationTimeout = function requestAnimationTimeout(callback, delay) {\n  var start = Date.now();\n\n  var timeout = function timeout() {\n    if (Date.now() - start >= delay) {\n      callback.call();\n    } else {\n      frame.id = raf(timeout);\n    }\n  };\n\n  var frame = {\n    id: raf(timeout)\n  };\n\n  return frame;\n};\nimport PropTypes from 'prop-types';\nexport { bpfrpt_proptype_AnimationTimeoutId };","import _Object$assign from 'babel-runtime/core-js/object/assign';\nimport _extends from 'babel-runtime/helpers/extends';\nimport _Object$getPrototypeOf from 'babel-runtime/core-js/object/get-prototype-of';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport * as React from 'react';\nimport cn from 'classnames';\nimport calculateSizeAndPositionDataAndUpdateScrollOffset from './utils/calculateSizeAndPositionDataAndUpdateScrollOffset';\nimport ScalingCellSizeAndPositionManager from './utils/ScalingCellSizeAndPositionManager';\nimport createCallbackMemoizer from '../utils/createCallbackMemoizer';\nimport defaultOverscanIndicesGetter, { SCROLL_DIRECTION_BACKWARD, SCROLL_DIRECTION_FORWARD } from './defaultOverscanIndicesGetter';\nimport updateScrollIndexHelper from './utils/updateScrollIndexHelper';\nimport defaultCellRangeRenderer from './defaultCellRangeRenderer';\nimport scrollbarSize from 'dom-helpers/util/scrollbarSize';\nimport { polyfill } from 'react-lifecycles-compat';\nimport { requestAnimationTimeout, cancelAnimationTimeout } from '../utils/requestAnimationTimeout';\n\n/**\n * Specifies the number of milliseconds during which to disable pointer events while a scroll is in progress.\n * This improves performance and makes scrolling smoother.\n */\nexport var DEFAULT_SCROLLING_RESET_TIME_INTERVAL = 150;\n\n/**\n * Controls whether the Grid updates the DOM element's scrollLeft/scrollTop based on the current state or just observes it.\n * This prevents Grid from interrupting mouse-wheel animations (see issue #2).\n */\nvar SCROLL_POSITION_CHANGE_REASONS = {\n  OBSERVED: 'observed',\n  REQUESTED: 'requested'\n};\n\nvar renderNull = function renderNull() {\n  return null;\n};\n\n/**\n * Renders tabular data with virtualization along the vertical and horizontal axes.\n * Row heights and column widths must be known ahead of time and specified as properties.\n */\nvar Grid = function (_React$PureComponent) {\n  _inherits(Grid, _React$PureComponent);\n\n  // Invokes onSectionRendered callback only when start/stop row or column indices change\n  function Grid(props) {\n    _classCallCheck(this, Grid);\n\n    var _this = _possibleConstructorReturn(this, (Grid.__proto__ || _Object$getPrototypeOf(Grid)).call(this, props));\n\n    _this._onGridRenderedMemoizer = createCallbackMemoizer();\n    _this._onScrollMemoizer = createCallbackMemoizer(false);\n    _this._deferredInvalidateColumnIndex = null;\n    _this._deferredInvalidateRowIndex = null;\n    _this._recomputeScrollLeftFlag = false;\n    _this._recomputeScrollTopFlag = false;\n    _this._horizontalScrollBarSize = 0;\n    _this._verticalScrollBarSize = 0;\n    _this._scrollbarPresenceChanged = false;\n    _this._renderedColumnStartIndex = 0;\n    _this._renderedColumnStopIndex = 0;\n    _this._renderedRowStartIndex = 0;\n    _this._renderedRowStopIndex = 0;\n    _this._styleCache = {};\n    _this._cellCache = {};\n\n    _this._debounceScrollEndedCallback = function () {\n      _this._disablePointerEventsTimeoutId = null;\n      // isScrolling is used to determine if we reset styleCache\n      _this.setState({\n        isScrolling: false,\n        needToResetStyleCache: false\n      });\n    };\n\n    _this._invokeOnGridRenderedHelper = function () {\n      var onSectionRendered = _this.props.onSectionRendered;\n\n\n      _this._onGridRenderedMemoizer({\n        callback: onSectionRendered,\n        indices: {\n          columnOverscanStartIndex: _this._columnStartIndex,\n          columnOverscanStopIndex: _this._columnStopIndex,\n          columnStartIndex: _this._renderedColumnStartIndex,\n          columnStopIndex: _this._renderedColumnStopIndex,\n          rowOverscanStartIndex: _this._rowStartIndex,\n          rowOverscanStopIndex: _this._rowStopIndex,\n          rowStartIndex: _this._renderedRowStartIndex,\n          rowStopIndex: _this._renderedRowStopIndex\n        }\n      });\n    };\n\n    _this._setScrollingContainerRef = function (ref) {\n      _this._scrollingContainer = ref;\n    };\n\n    _this._onScroll = function (event) {\n      // In certain edge-cases React dispatches an onScroll event with an invalid target.scrollLeft / target.scrollTop.\n      // This invalid event can be detected by comparing event.target to this component's scrollable DOM element.\n      // See issue #404 for more information.\n      if (event.target === _this._scrollingContainer) {\n        _this.handleScrollEvent(event.target);\n      }\n    };\n\n    var columnSizeAndPositionManager = new ScalingCellSizeAndPositionManager({\n      cellCount: props.columnCount,\n      cellSizeGetter: function cellSizeGetter(params) {\n        return Grid._wrapSizeGetter(props.columnWidth)(params);\n      },\n      estimatedCellSize: Grid._getEstimatedColumnSize(props)\n    });\n    var rowSizeAndPositionManager = new ScalingCellSizeAndPositionManager({\n      cellCount: props.rowCount,\n      cellSizeGetter: function cellSizeGetter(params) {\n        return Grid._wrapSizeGetter(props.rowHeight)(params);\n      },\n      estimatedCellSize: Grid._getEstimatedRowSize(props)\n    });\n\n    _this.state = {\n      instanceProps: {\n        columnSizeAndPositionManager: columnSizeAndPositionManager,\n        rowSizeAndPositionManager: rowSizeAndPositionManager,\n\n        prevColumnWidth: props.columnWidth,\n        prevRowHeight: props.rowHeight,\n        prevColumnCount: props.columnCount,\n        prevRowCount: props.rowCount,\n        prevIsScrolling: props.isScrolling === true,\n        prevScrollToColumn: props.scrollToColumn,\n        prevScrollToRow: props.scrollToRow,\n\n        scrollbarSize: 0,\n        scrollbarSizeMeasured: false\n      },\n      isScrolling: false,\n      scrollDirectionHorizontal: SCROLL_DIRECTION_FORWARD,\n      scrollDirectionVertical: SCROLL_DIRECTION_FORWARD,\n      scrollLeft: 0,\n      scrollTop: 0,\n      scrollPositionChangeReason: null,\n\n      needToResetStyleCache: false\n    };\n\n    if (props.scrollToRow > 0) {\n      _this._initialScrollTop = _this._getCalculatedScrollTop(props, _this.state);\n    }\n    if (props.scrollToColumn > 0) {\n      _this._initialScrollLeft = _this._getCalculatedScrollLeft(props, _this.state);\n    }\n    return _this;\n  }\n\n  /**\n   * Gets offsets for a given cell and alignment.\n   */\n\n\n  _createClass(Grid, [{\n    key: 'getOffsetForCell',\n    value: function getOffsetForCell() {\n      var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          _ref$alignment = _ref.alignment,\n          alignment = _ref$alignment === undefined ? this.props.scrollToAlignment : _ref$alignment,\n          _ref$columnIndex = _ref.columnIndex,\n          columnIndex = _ref$columnIndex === undefined ? this.props.scrollToColumn : _ref$columnIndex,\n          _ref$rowIndex = _ref.rowIndex,\n          rowIndex = _ref$rowIndex === undefined ? this.props.scrollToRow : _ref$rowIndex;\n\n      var offsetProps = _extends({}, this.props, {\n        scrollToAlignment: alignment,\n        scrollToColumn: columnIndex,\n        scrollToRow: rowIndex\n      });\n\n      return {\n        scrollLeft: this._getCalculatedScrollLeft(offsetProps),\n        scrollTop: this._getCalculatedScrollTop(offsetProps)\n      };\n    }\n\n    /**\n     * Gets estimated total rows' height.\n     */\n\n  }, {\n    key: 'getTotalRowsHeight',\n    value: function getTotalRowsHeight() {\n      return this.state.instanceProps.rowSizeAndPositionManager.getTotalSize();\n    }\n\n    /**\n     * Gets estimated total columns' width.\n     */\n\n  }, {\n    key: 'getTotalColumnsWidth',\n    value: function getTotalColumnsWidth() {\n      return this.state.instanceProps.columnSizeAndPositionManager.getTotalSize();\n    }\n\n    /**\n     * This method handles a scroll event originating from an external scroll control.\n     * It's an advanced method and should probably not be used unless you're implementing a custom scroll-bar solution.\n     */\n\n  }, {\n    key: 'handleScrollEvent',\n    value: function handleScrollEvent(_ref2) {\n      var _ref2$scrollLeft = _ref2.scrollLeft,\n          scrollLeftParam = _ref2$scrollLeft === undefined ? 0 : _ref2$scrollLeft,\n          _ref2$scrollTop = _ref2.scrollTop,\n          scrollTopParam = _ref2$scrollTop === undefined ? 0 : _ref2$scrollTop;\n\n      // On iOS, we can arrive at negative offsets by swiping past the start.\n      // To prevent flicker here, we make playing in the negative offset zone cause nothing to happen.\n      if (scrollTopParam < 0) {\n        return;\n      }\n\n      // Prevent pointer events from interrupting a smooth scroll\n      this._debounceScrollEnded();\n\n      var _props = this.props,\n          autoHeight = _props.autoHeight,\n          autoWidth = _props.autoWidth,\n          height = _props.height,\n          width = _props.width;\n      var instanceProps = this.state.instanceProps;\n\n      // When this component is shrunk drastically, React dispatches a series of back-to-back scroll events,\n      // Gradually converging on a scrollTop that is within the bounds of the new, smaller height.\n      // This causes a series of rapid renders that is slow for long lists.\n      // We can avoid that by doing some simple bounds checking to ensure that scroll offsets never exceed their bounds.\n\n      var scrollbarSize = instanceProps.scrollbarSize;\n      var totalRowsHeight = instanceProps.rowSizeAndPositionManager.getTotalSize();\n      var totalColumnsWidth = instanceProps.columnSizeAndPositionManager.getTotalSize();\n      var scrollLeft = Math.min(Math.max(0, totalColumnsWidth - width + scrollbarSize), scrollLeftParam);\n      var scrollTop = Math.min(Math.max(0, totalRowsHeight - height + scrollbarSize), scrollTopParam);\n\n      // Certain devices (like Apple touchpad) rapid-fire duplicate events.\n      // Don't force a re-render if this is the case.\n      // The mouse may move faster then the animation frame does.\n      // Use requestAnimationFrame to avoid over-updating.\n      if (this.state.scrollLeft !== scrollLeft || this.state.scrollTop !== scrollTop) {\n        // Track scrolling direction so we can more efficiently overscan rows to reduce empty space around the edges while scrolling.\n        // Don't change direction for an axis unless scroll offset has changed.\n        var _scrollDirectionHorizontal = scrollLeft !== this.state.scrollLeft ? scrollLeft > this.state.scrollLeft ? SCROLL_DIRECTION_FORWARD : SCROLL_DIRECTION_BACKWARD : this.state.scrollDirectionHorizontal;\n        var _scrollDirectionVertical = scrollTop !== this.state.scrollTop ? scrollTop > this.state.scrollTop ? SCROLL_DIRECTION_FORWARD : SCROLL_DIRECTION_BACKWARD : this.state.scrollDirectionVertical;\n\n        var newState = {\n          isScrolling: true,\n          scrollDirectionHorizontal: _scrollDirectionHorizontal,\n          scrollDirectionVertical: _scrollDirectionVertical,\n          scrollPositionChangeReason: SCROLL_POSITION_CHANGE_REASONS.OBSERVED\n        };\n\n        if (!autoHeight) {\n          newState.scrollTop = scrollTop;\n        }\n\n        if (!autoWidth) {\n          newState.scrollLeft = scrollLeft;\n        }\n\n        newState.needToResetStyleCache = false;\n        this.setState(newState);\n      }\n\n      this._invokeOnScrollMemoizer({\n        scrollLeft: scrollLeft,\n        scrollTop: scrollTop,\n        totalColumnsWidth: totalColumnsWidth,\n        totalRowsHeight: totalRowsHeight\n      });\n    }\n\n    /**\n     * Invalidate Grid size and recompute visible cells.\n     * This is a deferred wrapper for recomputeGridSize().\n     * It sets a flag to be evaluated on cDM/cDU to avoid unnecessary renders.\n     * This method is intended for advanced use-cases like CellMeasurer.\n     */\n    // @TODO (bvaughn) Add automated test coverage for this.\n\n  }, {\n    key: 'invalidateCellSizeAfterRender',\n    value: function invalidateCellSizeAfterRender(_ref3) {\n      var columnIndex = _ref3.columnIndex,\n          rowIndex = _ref3.rowIndex;\n\n      this._deferredInvalidateColumnIndex = typeof this._deferredInvalidateColumnIndex === 'number' ? Math.min(this._deferredInvalidateColumnIndex, columnIndex) : columnIndex;\n      this._deferredInvalidateRowIndex = typeof this._deferredInvalidateRowIndex === 'number' ? Math.min(this._deferredInvalidateRowIndex, rowIndex) : rowIndex;\n    }\n\n    /**\n     * Pre-measure all columns and rows in a Grid.\n     * Typically cells are only measured as needed and estimated sizes are used for cells that have not yet been measured.\n     * This method ensures that the next call to getTotalSize() returns an exact size (as opposed to just an estimated one).\n     */\n\n  }, {\n    key: 'measureAllCells',\n    value: function measureAllCells() {\n      var _props2 = this.props,\n          columnCount = _props2.columnCount,\n          rowCount = _props2.rowCount;\n      var instanceProps = this.state.instanceProps;\n\n      instanceProps.columnSizeAndPositionManager.getSizeAndPositionOfCell(columnCount - 1);\n      instanceProps.rowSizeAndPositionManager.getSizeAndPositionOfCell(rowCount - 1);\n    }\n\n    /**\n     * Forced recompute of row heights and column widths.\n     * This function should be called if dynamic column or row sizes have changed but nothing else has.\n     * Since Grid only receives :columnCount and :rowCount it has no way of detecting when the underlying data changes.\n     */\n\n  }, {\n    key: 'recomputeGridSize',\n    value: function recomputeGridSize() {\n      var _ref4 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          _ref4$columnIndex = _ref4.columnIndex,\n          columnIndex = _ref4$columnIndex === undefined ? 0 : _ref4$columnIndex,\n          _ref4$rowIndex = _ref4.rowIndex,\n          rowIndex = _ref4$rowIndex === undefined ? 0 : _ref4$rowIndex;\n\n      var _props3 = this.props,\n          scrollToColumn = _props3.scrollToColumn,\n          scrollToRow = _props3.scrollToRow;\n      var instanceProps = this.state.instanceProps;\n\n\n      instanceProps.columnSizeAndPositionManager.resetCell(columnIndex);\n      instanceProps.rowSizeAndPositionManager.resetCell(rowIndex);\n\n      // Cell sizes may be determined by a function property.\n      // In this case the cDU handler can't know if they changed.\n      // Store this flag to let the next cDU pass know it needs to recompute the scroll offset.\n      this._recomputeScrollLeftFlag = scrollToColumn >= 0 && columnIndex <= scrollToColumn;\n      this._recomputeScrollTopFlag = scrollToRow >= 0 && rowIndex <= scrollToRow;\n\n      // Clear cell cache in case we are scrolling;\n      // Invalid row heights likely mean invalid cached content as well.\n      this._styleCache = {};\n      this._cellCache = {};\n\n      this.forceUpdate();\n    }\n\n    /**\n     * Ensure column and row are visible.\n     */\n\n  }, {\n    key: 'scrollToCell',\n    value: function scrollToCell(_ref5) {\n      var columnIndex = _ref5.columnIndex,\n          rowIndex = _ref5.rowIndex;\n      var columnCount = this.props.columnCount;\n\n\n      var props = this.props;\n\n      // Don't adjust scroll offset for single-column grids (eg List, Table).\n      // This can cause a funky scroll offset because of the vertical scrollbar width.\n      if (columnCount > 1 && columnIndex !== undefined) {\n        this._updateScrollLeftForScrollToColumn(_extends({}, props, {\n          scrollToColumn: columnIndex\n        }));\n      }\n\n      if (rowIndex !== undefined) {\n        this._updateScrollTopForScrollToRow(_extends({}, props, {\n          scrollToRow: rowIndex\n        }));\n      }\n    }\n  }, {\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var _props4 = this.props,\n          getScrollbarSize = _props4.getScrollbarSize,\n          height = _props4.height,\n          scrollLeft = _props4.scrollLeft,\n          scrollToColumn = _props4.scrollToColumn,\n          scrollTop = _props4.scrollTop,\n          scrollToRow = _props4.scrollToRow,\n          width = _props4.width;\n      var instanceProps = this.state.instanceProps;\n\n      // Reset initial offsets to be ignored in browser\n\n      this._initialScrollTop = 0;\n      this._initialScrollLeft = 0;\n\n      // If cell sizes have been invalidated (eg we are using CellMeasurer) then reset cached positions.\n      // We must do this at the start of the method as we may calculate and update scroll position below.\n      this._handleInvalidatedGridSize();\n\n      // If this component was first rendered server-side, scrollbar size will be undefined.\n      // In that event we need to remeasure.\n      if (!instanceProps.scrollbarSizeMeasured) {\n        this.setState(function (prevState) {\n          var stateUpdate = _extends({}, prevState, { needToResetStyleCache: false });\n          stateUpdate.instanceProps.scrollbarSize = getScrollbarSize();\n          stateUpdate.instanceProps.scrollbarSizeMeasured = true;\n          return stateUpdate;\n        });\n      }\n\n      if (typeof scrollLeft === 'number' && scrollLeft >= 0 || typeof scrollTop === 'number' && scrollTop >= 0) {\n        var stateUpdate = Grid._getScrollToPositionStateUpdate({\n          prevState: this.state,\n          scrollLeft: scrollLeft,\n          scrollTop: scrollTop\n        });\n        if (stateUpdate) {\n          stateUpdate.needToResetStyleCache = false;\n          this.setState(stateUpdate);\n        }\n      }\n\n      // refs don't work in `react-test-renderer`\n      if (this._scrollingContainer) {\n        // setting the ref's scrollLeft and scrollTop.\n        // Somehow in MultiGrid the main grid doesn't trigger a update on mount.\n        if (this._scrollingContainer.scrollLeft !== this.state.scrollLeft) {\n          this._scrollingContainer.scrollLeft = this.state.scrollLeft;\n        }\n        if (this._scrollingContainer.scrollTop !== this.state.scrollTop) {\n          this._scrollingContainer.scrollTop = this.state.scrollTop;\n        }\n      }\n\n      // Don't update scroll offset if the size is 0; we don't render any cells in this case.\n      // Setting a state may cause us to later thing we've updated the offce when we haven't.\n      var sizeIsBiggerThanZero = height > 0 && width > 0;\n      if (scrollToColumn >= 0 && sizeIsBiggerThanZero) {\n        this._updateScrollLeftForScrollToColumn();\n      }\n      if (scrollToRow >= 0 && sizeIsBiggerThanZero) {\n        this._updateScrollTopForScrollToRow();\n      }\n\n      // Update onRowsRendered callback\n      this._invokeOnGridRenderedHelper();\n\n      // Initialize onScroll callback\n      this._invokeOnScrollMemoizer({\n        scrollLeft: scrollLeft || 0,\n        scrollTop: scrollTop || 0,\n        totalColumnsWidth: instanceProps.columnSizeAndPositionManager.getTotalSize(),\n        totalRowsHeight: instanceProps.rowSizeAndPositionManager.getTotalSize()\n      });\n\n      this._maybeCallOnScrollbarPresenceChange();\n    }\n\n    /**\n     * @private\n     * This method updates scrollLeft/scrollTop in state for the following conditions:\n     * 1) New scroll-to-cell props have been set\n     */\n\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps, prevState) {\n      var _this2 = this;\n\n      var _props5 = this.props,\n          autoHeight = _props5.autoHeight,\n          autoWidth = _props5.autoWidth,\n          columnCount = _props5.columnCount,\n          height = _props5.height,\n          rowCount = _props5.rowCount,\n          scrollToAlignment = _props5.scrollToAlignment,\n          scrollToColumn = _props5.scrollToColumn,\n          scrollToRow = _props5.scrollToRow,\n          width = _props5.width;\n      var _state = this.state,\n          scrollLeft = _state.scrollLeft,\n          scrollPositionChangeReason = _state.scrollPositionChangeReason,\n          scrollTop = _state.scrollTop,\n          instanceProps = _state.instanceProps;\n      // If cell sizes have been invalidated (eg we are using CellMeasurer) then reset cached positions.\n      // We must do this at the start of the method as we may calculate and update scroll position below.\n\n      this._handleInvalidatedGridSize();\n\n      // Handle edge case where column or row count has only just increased over 0.\n      // In this case we may have to restore a previously-specified scroll offset.\n      // For more info see bvaughn/react-virtualized/issues/218\n      var columnOrRowCountJustIncreasedFromZero = columnCount > 0 && prevProps.columnCount === 0 || rowCount > 0 && prevProps.rowCount === 0;\n\n      // Make sure requested changes to :scrollLeft or :scrollTop get applied.\n      // Assigning to scrollLeft/scrollTop tells the browser to interrupt any running scroll animations,\n      // And to discard any pending async changes to the scroll position that may have happened in the meantime (e.g. on a separate scrolling thread).\n      // So we only set these when we require an adjustment of the scroll position.\n      // See issue #2 for more information.\n      if (scrollPositionChangeReason === SCROLL_POSITION_CHANGE_REASONS.REQUESTED) {\n        // @TRICKY :autoHeight and :autoWidth properties instructs Grid to leave :scrollTop and :scrollLeft management to an external HOC (eg WindowScroller).\n        // In this case we should avoid checking scrollingContainer.scrollTop and scrollingContainer.scrollLeft since it forces layout/flow.\n        if (!autoWidth && scrollLeft >= 0 && (scrollLeft !== this._scrollingContainer.scrollLeft || columnOrRowCountJustIncreasedFromZero)) {\n          this._scrollingContainer.scrollLeft = scrollLeft;\n        }\n        if (!autoHeight && scrollTop >= 0 && (scrollTop !== this._scrollingContainer.scrollTop || columnOrRowCountJustIncreasedFromZero)) {\n          this._scrollingContainer.scrollTop = scrollTop;\n        }\n      }\n\n      // Special case where the previous size was 0:\n      // In this case we don't show any windowed cells at all.\n      // So we should always recalculate offset afterwards.\n      var sizeJustIncreasedFromZero = (prevProps.width === 0 || prevProps.height === 0) && height > 0 && width > 0;\n\n      // Update scroll offsets if the current :scrollToColumn or :scrollToRow values requires it\n      // @TODO Do we also need this check or can the one in componentWillUpdate() suffice?\n      if (this._recomputeScrollLeftFlag) {\n        this._recomputeScrollLeftFlag = false;\n        this._updateScrollLeftForScrollToColumn(this.props);\n      } else {\n        updateScrollIndexHelper({\n          cellSizeAndPositionManager: instanceProps.columnSizeAndPositionManager,\n          previousCellsCount: prevProps.columnCount,\n          previousCellSize: prevProps.columnWidth,\n          previousScrollToAlignment: prevProps.scrollToAlignment,\n          previousScrollToIndex: prevProps.scrollToColumn,\n          previousSize: prevProps.width,\n          scrollOffset: scrollLeft,\n          scrollToAlignment: scrollToAlignment,\n          scrollToIndex: scrollToColumn,\n          size: width,\n          sizeJustIncreasedFromZero: sizeJustIncreasedFromZero,\n          updateScrollIndexCallback: function updateScrollIndexCallback() {\n            return _this2._updateScrollLeftForScrollToColumn(_this2.props);\n          }\n        });\n      }\n\n      if (this._recomputeScrollTopFlag) {\n        this._recomputeScrollTopFlag = false;\n        this._updateScrollTopForScrollToRow(this.props);\n      } else {\n        updateScrollIndexHelper({\n          cellSizeAndPositionManager: instanceProps.rowSizeAndPositionManager,\n          previousCellsCount: prevProps.rowCount,\n          previousCellSize: prevProps.rowHeight,\n          previousScrollToAlignment: prevProps.scrollToAlignment,\n          previousScrollToIndex: prevProps.scrollToRow,\n          previousSize: prevProps.height,\n          scrollOffset: scrollTop,\n          scrollToAlignment: scrollToAlignment,\n          scrollToIndex: scrollToRow,\n          size: height,\n          sizeJustIncreasedFromZero: sizeJustIncreasedFromZero,\n          updateScrollIndexCallback: function updateScrollIndexCallback() {\n            return _this2._updateScrollTopForScrollToRow(_this2.props);\n          }\n        });\n      }\n\n      // Update onRowsRendered callback if start/stop indices have changed\n      this._invokeOnGridRenderedHelper();\n\n      // Changes to :scrollLeft or :scrollTop should also notify :onScroll listeners\n      if (scrollLeft !== prevState.scrollLeft || scrollTop !== prevState.scrollTop) {\n        var totalRowsHeight = instanceProps.rowSizeAndPositionManager.getTotalSize();\n        var totalColumnsWidth = instanceProps.columnSizeAndPositionManager.getTotalSize();\n\n        this._invokeOnScrollMemoizer({\n          scrollLeft: scrollLeft,\n          scrollTop: scrollTop,\n          totalColumnsWidth: totalColumnsWidth,\n          totalRowsHeight: totalRowsHeight\n        });\n      }\n\n      this._maybeCallOnScrollbarPresenceChange();\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      if (this._disablePointerEventsTimeoutId) {\n        cancelAnimationTimeout(this._disablePointerEventsTimeoutId);\n      }\n    }\n\n    /**\n     * This method updates scrollLeft/scrollTop in state for the following conditions:\n     * 1) Empty content (0 rows or columns)\n     * 2) New scroll props overriding the current state\n     * 3) Cells-count or cells-size has changed, making previous scroll offsets invalid\n     */\n\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props6 = this.props,\n          autoContainerWidth = _props6.autoContainerWidth,\n          autoHeight = _props6.autoHeight,\n          autoWidth = _props6.autoWidth,\n          className = _props6.className,\n          containerProps = _props6.containerProps,\n          containerRole = _props6.containerRole,\n          containerStyle = _props6.containerStyle,\n          height = _props6.height,\n          id = _props6.id,\n          noContentRenderer = _props6.noContentRenderer,\n          role = _props6.role,\n          style = _props6.style,\n          tabIndex = _props6.tabIndex,\n          width = _props6.width;\n      var _state2 = this.state,\n          instanceProps = _state2.instanceProps,\n          needToResetStyleCache = _state2.needToResetStyleCache;\n\n\n      var isScrolling = this._isScrolling();\n\n      var gridStyle = {\n        boxSizing: 'border-box',\n        direction: 'ltr',\n        height: autoHeight ? 'auto' : height,\n        position: 'relative',\n        width: autoWidth ? 'auto' : width,\n        WebkitOverflowScrolling: 'touch',\n        willChange: 'transform'\n      };\n\n      if (needToResetStyleCache) {\n        this._styleCache = {};\n      }\n\n      // calculate _styleCache here\n      // if state.isScrolling (not from _isScrolling) then reset\n      if (!this.state.isScrolling) {\n        this._resetStyleCache();\n      }\n\n      // calculate children to render here\n      this._calculateChildrenToRender(this.props, this.state);\n\n      var totalColumnsWidth = instanceProps.columnSizeAndPositionManager.getTotalSize();\n      var totalRowsHeight = instanceProps.rowSizeAndPositionManager.getTotalSize();\n\n      // Force browser to hide scrollbars when we know they aren't necessary.\n      // Otherwise once scrollbars appear they may not disappear again.\n      // For more info see issue #116\n      var verticalScrollBarSize = totalRowsHeight > height ? instanceProps.scrollbarSize : 0;\n      var horizontalScrollBarSize = totalColumnsWidth > width ? instanceProps.scrollbarSize : 0;\n\n      if (horizontalScrollBarSize !== this._horizontalScrollBarSize || verticalScrollBarSize !== this._verticalScrollBarSize) {\n        this._horizontalScrollBarSize = horizontalScrollBarSize;\n        this._verticalScrollBarSize = verticalScrollBarSize;\n        this._scrollbarPresenceChanged = true;\n      }\n\n      // Also explicitly init styles to 'auto' if scrollbars are required.\n      // This works around an obscure edge case where external CSS styles have not yet been loaded,\n      // But an initial scroll index of offset is set as an external prop.\n      // Without this style, Grid would render the correct range of cells but would NOT update its internal offset.\n      // This was originally reported via clauderic/react-infinite-calendar/issues/23\n      gridStyle.overflowX = totalColumnsWidth + verticalScrollBarSize <= width ? 'hidden' : 'auto';\n      gridStyle.overflowY = totalRowsHeight + horizontalScrollBarSize <= height ? 'hidden' : 'auto';\n\n      var childrenToDisplay = this._childrenToDisplay;\n\n      var showNoContentRenderer = childrenToDisplay.length === 0 && height > 0 && width > 0;\n\n      return React.createElement(\n        'div',\n        _extends({\n          ref: this._setScrollingContainerRef\n        }, containerProps, {\n          'aria-label': this.props['aria-label'],\n          'aria-readonly': this.props['aria-readonly'],\n          className: cn('ReactVirtualized__Grid', className),\n          id: id,\n          onScroll: this._onScroll,\n          role: role,\n          style: _extends({}, gridStyle, style),\n          tabIndex: tabIndex }),\n        childrenToDisplay.length > 0 && React.createElement(\n          'div',\n          {\n            className: 'ReactVirtualized__Grid__innerScrollContainer',\n            role: containerRole,\n            style: _extends({\n              width: autoContainerWidth ? 'auto' : totalColumnsWidth,\n              height: totalRowsHeight,\n              maxWidth: totalColumnsWidth,\n              maxHeight: totalRowsHeight,\n              overflow: 'hidden',\n              pointerEvents: isScrolling ? 'none' : '',\n              position: 'relative'\n            }, containerStyle) },\n          childrenToDisplay\n        ),\n        showNoContentRenderer && noContentRenderer()\n      );\n    }\n\n    /* ---------------------------- Helper methods ---------------------------- */\n\n  }, {\n    key: '_calculateChildrenToRender',\n    value: function _calculateChildrenToRender() {\n      var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.props;\n      var state = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.state;\n      var cellRenderer = props.cellRenderer,\n          cellRangeRenderer = props.cellRangeRenderer,\n          columnCount = props.columnCount,\n          deferredMeasurementCache = props.deferredMeasurementCache,\n          height = props.height,\n          overscanColumnCount = props.overscanColumnCount,\n          overscanIndicesGetter = props.overscanIndicesGetter,\n          overscanRowCount = props.overscanRowCount,\n          rowCount = props.rowCount,\n          width = props.width,\n          isScrollingOptOut = props.isScrollingOptOut;\n      var scrollDirectionHorizontal = state.scrollDirectionHorizontal,\n          scrollDirectionVertical = state.scrollDirectionVertical,\n          instanceProps = state.instanceProps;\n\n\n      var scrollTop = this._initialScrollTop > 0 ? this._initialScrollTop : state.scrollTop;\n      var scrollLeft = this._initialScrollLeft > 0 ? this._initialScrollLeft : state.scrollLeft;\n\n      var isScrolling = this._isScrolling(props, state);\n\n      this._childrenToDisplay = [];\n\n      // Render only enough columns and rows to cover the visible area of the grid.\n      if (height > 0 && width > 0) {\n        var visibleColumnIndices = instanceProps.columnSizeAndPositionManager.getVisibleCellRange({\n          containerSize: width,\n          offset: scrollLeft\n        });\n        var visibleRowIndices = instanceProps.rowSizeAndPositionManager.getVisibleCellRange({\n          containerSize: height,\n          offset: scrollTop\n        });\n\n        var horizontalOffsetAdjustment = instanceProps.columnSizeAndPositionManager.getOffsetAdjustment({\n          containerSize: width,\n          offset: scrollLeft\n        });\n        var verticalOffsetAdjustment = instanceProps.rowSizeAndPositionManager.getOffsetAdjustment({\n          containerSize: height,\n          offset: scrollTop\n        });\n\n        // Store for _invokeOnGridRenderedHelper()\n        this._renderedColumnStartIndex = visibleColumnIndices.start;\n        this._renderedColumnStopIndex = visibleColumnIndices.stop;\n        this._renderedRowStartIndex = visibleRowIndices.start;\n        this._renderedRowStopIndex = visibleRowIndices.stop;\n\n        var overscanColumnIndices = overscanIndicesGetter({\n          direction: 'horizontal',\n          cellCount: columnCount,\n          overscanCellsCount: overscanColumnCount,\n          scrollDirection: scrollDirectionHorizontal,\n          startIndex: typeof visibleColumnIndices.start === 'number' ? visibleColumnIndices.start : 0,\n          stopIndex: typeof visibleColumnIndices.stop === 'number' ? visibleColumnIndices.stop : -1\n        });\n\n        var overscanRowIndices = overscanIndicesGetter({\n          direction: 'vertical',\n          cellCount: rowCount,\n          overscanCellsCount: overscanRowCount,\n          scrollDirection: scrollDirectionVertical,\n          startIndex: typeof visibleRowIndices.start === 'number' ? visibleRowIndices.start : 0,\n          stopIndex: typeof visibleRowIndices.stop === 'number' ? visibleRowIndices.stop : -1\n        });\n\n        // Store for _invokeOnGridRenderedHelper()\n        var columnStartIndex = overscanColumnIndices.overscanStartIndex;\n        var columnStopIndex = overscanColumnIndices.overscanStopIndex;\n        var rowStartIndex = overscanRowIndices.overscanStartIndex;\n        var rowStopIndex = overscanRowIndices.overscanStopIndex;\n\n        // Advanced use-cases (eg CellMeasurer) require batched measurements to determine accurate sizes.\n        if (deferredMeasurementCache) {\n          // If rows have a dynamic height, scan the rows we are about to render.\n          // If any have not yet been measured, then we need to render all columns initially,\n          // Because the height of the row is equal to the tallest cell within that row,\n          // (And so we can't know the height without measuring all column-cells first).\n          if (!deferredMeasurementCache.hasFixedHeight()) {\n            for (var rowIndex = rowStartIndex; rowIndex <= rowStopIndex; rowIndex++) {\n              if (!deferredMeasurementCache.has(rowIndex, 0)) {\n                columnStartIndex = 0;\n                columnStopIndex = columnCount - 1;\n                break;\n              }\n            }\n          }\n\n          // If columns have a dynamic width, scan the columns we are about to render.\n          // If any have not yet been measured, then we need to render all rows initially,\n          // Because the width of the column is equal to the widest cell within that column,\n          // (And so we can't know the width without measuring all row-cells first).\n          if (!deferredMeasurementCache.hasFixedWidth()) {\n            for (var columnIndex = columnStartIndex; columnIndex <= columnStopIndex; columnIndex++) {\n              if (!deferredMeasurementCache.has(0, columnIndex)) {\n                rowStartIndex = 0;\n                rowStopIndex = rowCount - 1;\n                break;\n              }\n            }\n          }\n        }\n\n        this._childrenToDisplay = cellRangeRenderer({\n          cellCache: this._cellCache,\n          cellRenderer: cellRenderer,\n          columnSizeAndPositionManager: instanceProps.columnSizeAndPositionManager,\n          columnStartIndex: columnStartIndex,\n          columnStopIndex: columnStopIndex,\n          deferredMeasurementCache: deferredMeasurementCache,\n          horizontalOffsetAdjustment: horizontalOffsetAdjustment,\n          isScrolling: isScrolling,\n          isScrollingOptOut: isScrollingOptOut,\n          parent: this,\n          rowSizeAndPositionManager: instanceProps.rowSizeAndPositionManager,\n          rowStartIndex: rowStartIndex,\n          rowStopIndex: rowStopIndex,\n          scrollLeft: scrollLeft,\n          scrollTop: scrollTop,\n          styleCache: this._styleCache,\n          verticalOffsetAdjustment: verticalOffsetAdjustment,\n          visibleColumnIndices: visibleColumnIndices,\n          visibleRowIndices: visibleRowIndices\n        });\n\n        // update the indices\n        this._columnStartIndex = columnStartIndex;\n        this._columnStopIndex = columnStopIndex;\n        this._rowStartIndex = rowStartIndex;\n        this._rowStopIndex = rowStopIndex;\n      }\n    }\n\n    /**\n     * Sets an :isScrolling flag for a small window of time.\n     * This flag is used to disable pointer events on the scrollable portion of the Grid.\n     * This prevents jerky/stuttery mouse-wheel scrolling.\n     */\n\n  }, {\n    key: '_debounceScrollEnded',\n    value: function _debounceScrollEnded() {\n      var scrollingResetTimeInterval = this.props.scrollingResetTimeInterval;\n\n\n      if (this._disablePointerEventsTimeoutId) {\n        cancelAnimationTimeout(this._disablePointerEventsTimeoutId);\n      }\n\n      this._disablePointerEventsTimeoutId = requestAnimationTimeout(this._debounceScrollEndedCallback, scrollingResetTimeInterval);\n    }\n  }, {\n    key: '_handleInvalidatedGridSize',\n\n\n    /**\n     * Check for batched CellMeasurer size invalidations.\n     * This will occur the first time one or more previously unmeasured cells are rendered.\n     */\n    value: function _handleInvalidatedGridSize() {\n      if (typeof this._deferredInvalidateColumnIndex === 'number' && typeof this._deferredInvalidateRowIndex === 'number') {\n        var columnIndex = this._deferredInvalidateColumnIndex;\n        var rowIndex = this._deferredInvalidateRowIndex;\n\n        this._deferredInvalidateColumnIndex = null;\n        this._deferredInvalidateRowIndex = null;\n\n        this.recomputeGridSize({ columnIndex: columnIndex, rowIndex: rowIndex });\n      }\n    }\n  }, {\n    key: '_invokeOnScrollMemoizer',\n    value: function _invokeOnScrollMemoizer(_ref6) {\n      var _this3 = this;\n\n      var scrollLeft = _ref6.scrollLeft,\n          scrollTop = _ref6.scrollTop,\n          totalColumnsWidth = _ref6.totalColumnsWidth,\n          totalRowsHeight = _ref6.totalRowsHeight;\n\n      this._onScrollMemoizer({\n        callback: function callback(_ref7) {\n          var scrollLeft = _ref7.scrollLeft,\n              scrollTop = _ref7.scrollTop;\n          var _props7 = _this3.props,\n              height = _props7.height,\n              onScroll = _props7.onScroll,\n              width = _props7.width;\n\n\n          onScroll({\n            clientHeight: height,\n            clientWidth: width,\n            scrollHeight: totalRowsHeight,\n            scrollLeft: scrollLeft,\n            scrollTop: scrollTop,\n            scrollWidth: totalColumnsWidth\n          });\n        },\n        indices: {\n          scrollLeft: scrollLeft,\n          scrollTop: scrollTop\n        }\n      });\n    }\n  }, {\n    key: '_isScrolling',\n    value: function _isScrolling() {\n      var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.props;\n      var state = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.state;\n\n      // If isScrolling is defined in props, use it to override the value in state\n      // This is a performance optimization for WindowScroller + Grid\n      return Object.hasOwnProperty.call(props, 'isScrolling') ? Boolean(props.isScrolling) : Boolean(state.isScrolling);\n    }\n  }, {\n    key: '_maybeCallOnScrollbarPresenceChange',\n    value: function _maybeCallOnScrollbarPresenceChange() {\n      if (this._scrollbarPresenceChanged) {\n        var _onScrollbarPresenceChange = this.props.onScrollbarPresenceChange;\n\n\n        this._scrollbarPresenceChanged = false;\n\n        _onScrollbarPresenceChange({\n          horizontal: this._horizontalScrollBarSize > 0,\n          size: this.state.instanceProps.scrollbarSize,\n          vertical: this._verticalScrollBarSize > 0\n        });\n      }\n    }\n  }, {\n    key: 'scrollToPosition',\n\n\n    /**\n     * Scroll to the specified offset(s).\n     * Useful for animating position changes.\n     */\n    value: function scrollToPosition(_ref8) {\n      var scrollLeft = _ref8.scrollLeft,\n          scrollTop = _ref8.scrollTop;\n\n      var stateUpdate = Grid._getScrollToPositionStateUpdate({\n        prevState: this.state,\n        scrollLeft: scrollLeft,\n        scrollTop: scrollTop\n      });\n\n      if (stateUpdate) {\n        stateUpdate.needToResetStyleCache = false;\n        this.setState(stateUpdate);\n      }\n    }\n  }, {\n    key: '_getCalculatedScrollLeft',\n    value: function _getCalculatedScrollLeft() {\n      var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.props;\n      var state = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.state;\n\n      return Grid._getCalculatedScrollLeft(props, state);\n    }\n  }, {\n    key: '_updateScrollLeftForScrollToColumn',\n    value: function _updateScrollLeftForScrollToColumn() {\n      var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.props;\n      var state = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.state;\n\n      var stateUpdate = Grid._getScrollLeftForScrollToColumnStateUpdate(props, state);\n      if (stateUpdate) {\n        stateUpdate.needToResetStyleCache = false;\n        this.setState(stateUpdate);\n      }\n    }\n  }, {\n    key: '_getCalculatedScrollTop',\n    value: function _getCalculatedScrollTop() {\n      var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.props;\n      var state = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.state;\n\n      return Grid._getCalculatedScrollTop(props, state);\n    }\n  }, {\n    key: '_resetStyleCache',\n    value: function _resetStyleCache() {\n      var styleCache = this._styleCache;\n      var cellCache = this._cellCache;\n      var isScrollingOptOut = this.props.isScrollingOptOut;\n\n      // Reset cell and style caches once scrolling stops.\n      // This makes Grid simpler to use (since cells commonly change).\n      // And it keeps the caches from growing too large.\n      // Performance is most sensitive when a user is scrolling.\n      // Don't clear visible cells from cellCache if isScrollingOptOut is specified.\n      // This keeps the cellCache to a resonable size.\n\n      this._cellCache = {};\n      this._styleCache = {};\n\n      // Copy over the visible cell styles so avoid unnecessary re-render.\n      for (var rowIndex = this._rowStartIndex; rowIndex <= this._rowStopIndex; rowIndex++) {\n        for (var columnIndex = this._columnStartIndex; columnIndex <= this._columnStopIndex; columnIndex++) {\n          var key = rowIndex + '-' + columnIndex;\n          this._styleCache[key] = styleCache[key];\n\n          if (isScrollingOptOut) {\n            this._cellCache[key] = cellCache[key];\n          }\n        }\n      }\n    }\n  }, {\n    key: '_updateScrollTopForScrollToRow',\n    value: function _updateScrollTopForScrollToRow() {\n      var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.props;\n      var state = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.state;\n\n      var stateUpdate = Grid._getScrollTopForScrollToRowStateUpdate(props, state);\n      if (stateUpdate) {\n        stateUpdate.needToResetStyleCache = false;\n        this.setState(stateUpdate);\n      }\n    }\n  }], [{\n    key: 'getDerivedStateFromProps',\n    value: function getDerivedStateFromProps(nextProps, prevState) {\n      var newState = {};\n\n      if (nextProps.columnCount === 0 && prevState.scrollLeft !== 0 || nextProps.rowCount === 0 && prevState.scrollTop !== 0) {\n        newState.scrollLeft = 0;\n        newState.scrollTop = 0;\n\n        // only use scroll{Left,Top} from props if scrollTo{Column,Row} isn't specified\n        // scrollTo{Column,Row} should override scroll{Left,Top}\n      } else if (nextProps.scrollLeft !== prevState.scrollLeft && nextProps.scrollToColumn < 0 || nextProps.scrollTop !== prevState.scrollTop && nextProps.scrollToRow < 0) {\n        _Object$assign(newState, Grid._getScrollToPositionStateUpdate({\n          prevState: prevState,\n          scrollLeft: nextProps.scrollLeft,\n          scrollTop: nextProps.scrollTop\n        }));\n      }\n\n      var instanceProps = prevState.instanceProps;\n\n      // Initially we should not clearStyleCache\n\n      newState.needToResetStyleCache = false;\n      if (nextProps.columnWidth !== instanceProps.prevColumnWidth || nextProps.rowHeight !== instanceProps.prevRowHeight) {\n        // Reset cache. set it to {} in render\n        newState.needToResetStyleCache = true;\n      }\n\n      instanceProps.columnSizeAndPositionManager.configure({\n        cellCount: nextProps.columnCount,\n        estimatedCellSize: Grid._getEstimatedColumnSize(nextProps),\n        cellSizeGetter: Grid._wrapSizeGetter(nextProps.columnWidth)\n      });\n\n      instanceProps.rowSizeAndPositionManager.configure({\n        cellCount: nextProps.rowCount,\n        estimatedCellSize: Grid._getEstimatedRowSize(nextProps),\n        cellSizeGetter: Grid._wrapSizeGetter(nextProps.rowHeight)\n      });\n\n      if (instanceProps.prevColumnCount === 0 || instanceProps.prevRowCount === 0) {\n        instanceProps.prevColumnCount = 0;\n        instanceProps.prevRowCount = 0;\n      }\n\n      // If scrolling is controlled outside this component, clear cache when scrolling stops\n      if (nextProps.autoHeight && nextProps.isScrolling === false && instanceProps.prevIsScrolling === true) {\n        _Object$assign(newState, {\n          isScrolling: false\n        });\n      }\n\n      var maybeStateA = void 0;\n      var maybeStateB = void 0;\n\n      calculateSizeAndPositionDataAndUpdateScrollOffset({\n        cellCount: instanceProps.prevColumnCount,\n        cellSize: typeof instanceProps.prevColumnWidth === 'number' ? instanceProps.prevColumnWidth : null,\n        computeMetadataCallback: function computeMetadataCallback() {\n          return instanceProps.columnSizeAndPositionManager.resetCell(0);\n        },\n        computeMetadataCallbackProps: nextProps,\n        nextCellsCount: nextProps.columnCount,\n        nextCellSize: typeof nextProps.columnWidth === 'number' ? nextProps.columnWidth : null,\n        nextScrollToIndex: nextProps.scrollToColumn,\n        scrollToIndex: instanceProps.prevScrollToColumn,\n        updateScrollOffsetForScrollToIndex: function updateScrollOffsetForScrollToIndex() {\n          maybeStateA = Grid._getScrollLeftForScrollToColumnStateUpdate(nextProps, prevState);\n        }\n      });\n      calculateSizeAndPositionDataAndUpdateScrollOffset({\n        cellCount: instanceProps.prevRowCount,\n        cellSize: typeof instanceProps.prevRowHeight === 'number' ? instanceProps.prevRowHeight : null,\n        computeMetadataCallback: function computeMetadataCallback() {\n          return instanceProps.rowSizeAndPositionManager.resetCell(0);\n        },\n        computeMetadataCallbackProps: nextProps,\n        nextCellsCount: nextProps.rowCount,\n        nextCellSize: typeof nextProps.rowHeight === 'number' ? nextProps.rowHeight : null,\n        nextScrollToIndex: nextProps.scrollToRow,\n        scrollToIndex: instanceProps.prevScrollToRow,\n        updateScrollOffsetForScrollToIndex: function updateScrollOffsetForScrollToIndex() {\n          maybeStateB = Grid._getScrollTopForScrollToRowStateUpdate(nextProps, prevState);\n        }\n      });\n\n      instanceProps.prevColumnCount = nextProps.columnCount;\n      instanceProps.prevColumnWidth = nextProps.columnWidth;\n      instanceProps.prevIsScrolling = nextProps.isScrolling === true;\n      instanceProps.prevRowCount = nextProps.rowCount;\n      instanceProps.prevRowHeight = nextProps.rowHeight;\n      instanceProps.prevScrollToColumn = nextProps.scrollToColumn;\n      instanceProps.prevScrollToRow = nextProps.scrollToRow;\n\n      // getting scrollBarSize (moved from componentWillMount)\n      instanceProps.scrollbarSize = nextProps.getScrollbarSize();\n      if (instanceProps.scrollbarSize === undefined) {\n        instanceProps.scrollbarSizeMeasured = false;\n        instanceProps.scrollbarSize = 0;\n      } else {\n        instanceProps.scrollbarSizeMeasured = true;\n      }\n\n      newState.instanceProps = instanceProps;\n\n      return _extends({}, newState, maybeStateA, maybeStateB);\n    }\n  }, {\n    key: '_getEstimatedColumnSize',\n    value: function _getEstimatedColumnSize(props) {\n      return typeof props.columnWidth === 'number' ? props.columnWidth : props.estimatedColumnSize;\n    }\n  }, {\n    key: '_getEstimatedRowSize',\n    value: function _getEstimatedRowSize(props) {\n      return typeof props.rowHeight === 'number' ? props.rowHeight : props.estimatedRowSize;\n    }\n  }, {\n    key: '_getScrollToPositionStateUpdate',\n\n\n    /**\n     * Get the updated state after scrolling to\n     * scrollLeft and scrollTop\n     */\n    value: function _getScrollToPositionStateUpdate(_ref9) {\n      var prevState = _ref9.prevState,\n          scrollLeft = _ref9.scrollLeft,\n          scrollTop = _ref9.scrollTop;\n\n      var newState = {\n        scrollPositionChangeReason: SCROLL_POSITION_CHANGE_REASONS.REQUESTED\n      };\n\n      if (typeof scrollLeft === 'number' && scrollLeft >= 0) {\n        newState.scrollDirectionHorizontal = scrollLeft > prevState.scrollLeft ? SCROLL_DIRECTION_FORWARD : SCROLL_DIRECTION_BACKWARD;\n        newState.scrollLeft = scrollLeft;\n      }\n\n      if (typeof scrollTop === 'number' && scrollTop >= 0) {\n        newState.scrollDirectionVertical = scrollTop > prevState.scrollTop ? SCROLL_DIRECTION_FORWARD : SCROLL_DIRECTION_BACKWARD;\n        newState.scrollTop = scrollTop;\n      }\n\n      if (typeof scrollLeft === 'number' && scrollLeft >= 0 && scrollLeft !== prevState.scrollLeft || typeof scrollTop === 'number' && scrollTop >= 0 && scrollTop !== prevState.scrollTop) {\n        return newState;\n      }\n      return null;\n    }\n  }, {\n    key: '_wrapSizeGetter',\n    value: function _wrapSizeGetter(value) {\n      return typeof value === 'function' ? value : function () {\n        return value;\n      };\n    }\n  }, {\n    key: '_getCalculatedScrollLeft',\n    value: function _getCalculatedScrollLeft(nextProps, prevState) {\n      var columnCount = nextProps.columnCount,\n          height = nextProps.height,\n          scrollToAlignment = nextProps.scrollToAlignment,\n          scrollToColumn = nextProps.scrollToColumn,\n          width = nextProps.width;\n      var scrollLeft = prevState.scrollLeft,\n          instanceProps = prevState.instanceProps;\n\n\n      if (columnCount > 0) {\n        var finalColumn = columnCount - 1;\n        var targetIndex = scrollToColumn < 0 ? finalColumn : Math.min(finalColumn, scrollToColumn);\n        var totalRowsHeight = instanceProps.rowSizeAndPositionManager.getTotalSize();\n        var scrollBarSize = instanceProps.scrollbarSizeMeasured && totalRowsHeight > height ? instanceProps.scrollbarSize : 0;\n\n        return instanceProps.columnSizeAndPositionManager.getUpdatedOffsetForIndex({\n          align: scrollToAlignment,\n          containerSize: width - scrollBarSize,\n          currentOffset: scrollLeft,\n          targetIndex: targetIndex\n        });\n      }\n      return 0;\n    }\n  }, {\n    key: '_getScrollLeftForScrollToColumnStateUpdate',\n    value: function _getScrollLeftForScrollToColumnStateUpdate(nextProps, prevState) {\n      var scrollLeft = prevState.scrollLeft;\n\n      var calculatedScrollLeft = Grid._getCalculatedScrollLeft(nextProps, prevState);\n\n      if (typeof calculatedScrollLeft === 'number' && calculatedScrollLeft >= 0 && scrollLeft !== calculatedScrollLeft) {\n        return Grid._getScrollToPositionStateUpdate({\n          prevState: prevState,\n          scrollLeft: calculatedScrollLeft,\n          scrollTop: -1\n        });\n      }\n      return null;\n    }\n  }, {\n    key: '_getCalculatedScrollTop',\n    value: function _getCalculatedScrollTop(nextProps, prevState) {\n      var height = nextProps.height,\n          rowCount = nextProps.rowCount,\n          scrollToAlignment = nextProps.scrollToAlignment,\n          scrollToRow = nextProps.scrollToRow,\n          width = nextProps.width;\n      var scrollTop = prevState.scrollTop,\n          instanceProps = prevState.instanceProps;\n\n\n      if (rowCount > 0) {\n        var finalRow = rowCount - 1;\n        var targetIndex = scrollToRow < 0 ? finalRow : Math.min(finalRow, scrollToRow);\n        var totalColumnsWidth = instanceProps.columnSizeAndPositionManager.getTotalSize();\n        var scrollBarSize = instanceProps.scrollbarSizeMeasured && totalColumnsWidth > width ? instanceProps.scrollbarSize : 0;\n\n        return instanceProps.rowSizeAndPositionManager.getUpdatedOffsetForIndex({\n          align: scrollToAlignment,\n          containerSize: height - scrollBarSize,\n          currentOffset: scrollTop,\n          targetIndex: targetIndex\n        });\n      }\n      return 0;\n    }\n  }, {\n    key: '_getScrollTopForScrollToRowStateUpdate',\n    value: function _getScrollTopForScrollToRowStateUpdate(nextProps, prevState) {\n      var scrollTop = prevState.scrollTop;\n\n      var calculatedScrollTop = Grid._getCalculatedScrollTop(nextProps, prevState);\n\n      if (typeof calculatedScrollTop === 'number' && calculatedScrollTop >= 0 && scrollTop !== calculatedScrollTop) {\n        return Grid._getScrollToPositionStateUpdate({\n          prevState: prevState,\n          scrollLeft: -1,\n          scrollTop: calculatedScrollTop\n        });\n      }\n      return null;\n    }\n  }]);\n\n  return Grid;\n}(React.PureComponent);\n\nGrid.defaultProps = {\n  'aria-label': 'grid',\n  'aria-readonly': true,\n  autoContainerWidth: false,\n  autoHeight: false,\n  autoWidth: false,\n  cellRangeRenderer: defaultCellRangeRenderer,\n  containerRole: 'rowgroup',\n  containerStyle: {},\n  estimatedColumnSize: 100,\n  estimatedRowSize: 30,\n  getScrollbarSize: scrollbarSize,\n  noContentRenderer: renderNull,\n  onScroll: function onScroll() {},\n  onScrollbarPresenceChange: function onScrollbarPresenceChange() {},\n  onSectionRendered: function onSectionRendered() {},\n  overscanColumnCount: 0,\n  overscanIndicesGetter: defaultOverscanIndicesGetter,\n  overscanRowCount: 10,\n  role: 'grid',\n  scrollingResetTimeInterval: DEFAULT_SCROLLING_RESET_TIME_INTERVAL,\n  scrollToAlignment: 'auto',\n  scrollToColumn: -1,\n  scrollToRow: -1,\n  style: {},\n  tabIndex: 0,\n  isScrollingOptOut: false\n};\nGrid.propTypes = process.env.NODE_ENV === 'production' ? null : {\n  \"aria-label\": PropTypes.string.isRequired,\n  \"aria-readonly\": PropTypes.bool,\n\n\n  /**\n   * Set the width of the inner scrollable container to 'auto'.\n   * This is useful for single-column Grids to ensure that the column doesn't extend below a vertical scrollbar.\n   */\n  autoContainerWidth: PropTypes.bool.isRequired,\n\n\n  /**\n   * Removes fixed height from the scrollingContainer so that the total height of rows can stretch the window.\n   * Intended for use with WindowScroller\n   */\n  autoHeight: PropTypes.bool.isRequired,\n\n\n  /**\n   * Removes fixed width from the scrollingContainer so that the total width of rows can stretch the window.\n   * Intended for use with WindowScroller\n   */\n  autoWidth: PropTypes.bool.isRequired,\n\n\n  /** Responsible for rendering a cell given an row and column index.  */\n  cellRenderer: function cellRenderer() {\n    return (typeof bpfrpt_proptype_CellRenderer === 'function' ? bpfrpt_proptype_CellRenderer.isRequired ? bpfrpt_proptype_CellRenderer.isRequired : bpfrpt_proptype_CellRenderer : PropTypes.shape(bpfrpt_proptype_CellRenderer).isRequired).apply(this, arguments);\n  },\n\n\n  /** Responsible for rendering a group of cells given their index ranges.  */\n  cellRangeRenderer: function cellRangeRenderer() {\n    return (typeof bpfrpt_proptype_CellRangeRenderer === 'function' ? bpfrpt_proptype_CellRangeRenderer.isRequired ? bpfrpt_proptype_CellRangeRenderer.isRequired : bpfrpt_proptype_CellRangeRenderer : PropTypes.shape(bpfrpt_proptype_CellRangeRenderer).isRequired).apply(this, arguments);\n  },\n\n\n  /** Optional custom CSS class name to attach to root Grid element.  */\n  className: PropTypes.string,\n\n\n  /** Number of columns in grid.  */\n  columnCount: PropTypes.number.isRequired,\n\n\n  /** Either a fixed column width (number) or a function that returns the width of a column given its index.  */\n  columnWidth: function columnWidth() {\n    return (typeof bpfrpt_proptype_CellSize === 'function' ? bpfrpt_proptype_CellSize.isRequired ? bpfrpt_proptype_CellSize.isRequired : bpfrpt_proptype_CellSize : PropTypes.shape(bpfrpt_proptype_CellSize).isRequired).apply(this, arguments);\n  },\n\n\n  /** Unfiltered props for the Grid container. */\n  containerProps: PropTypes.object,\n\n\n  /** ARIA role for the cell-container.  */\n  containerRole: PropTypes.string.isRequired,\n\n\n  /** Optional inline style applied to inner cell-container */\n  containerStyle: PropTypes.object.isRequired,\n\n\n  /**\n   * If CellMeasurer is used to measure this Grid's children, this should be a pointer to its CellMeasurerCache.\n   * A shared CellMeasurerCache reference enables Grid and CellMeasurer to share measurement data.\n   */\n  deferredMeasurementCache: PropTypes.object,\n\n\n  /**\n   * Used to estimate the total width of a Grid before all of its columns have actually been measured.\n   * The estimated total width is adjusted as columns are rendered.\n   */\n  estimatedColumnSize: PropTypes.number.isRequired,\n\n\n  /**\n   * Used to estimate the total height of a Grid before all of its rows have actually been measured.\n   * The estimated total height is adjusted as rows are rendered.\n   */\n  estimatedRowSize: PropTypes.number.isRequired,\n\n\n  /** Exposed for testing purposes only.  */\n  getScrollbarSize: PropTypes.func.isRequired,\n\n\n  /** Height of Grid; this property determines the number of visible (vs virtualized) rows.  */\n  height: PropTypes.number.isRequired,\n\n\n  /** Optional custom id to attach to root Grid element.  */\n  id: PropTypes.string,\n\n\n  /**\n   * Override internal is-scrolling state tracking.\n   * This property is primarily intended for use with the WindowScroller component.\n   */\n  isScrolling: PropTypes.bool,\n\n\n  /**\n   * Opt-out of isScrolling param passed to cellRangeRenderer.\n   * To avoid the extra render when scroll stops.\n   */\n  isScrollingOptOut: PropTypes.bool.isRequired,\n\n\n  /** Optional renderer to be used in place of rows when either :rowCount or :columnCount is 0.  */\n  noContentRenderer: function noContentRenderer() {\n    return (typeof bpfrpt_proptype_NoContentRenderer === 'function' ? bpfrpt_proptype_NoContentRenderer.isRequired ? bpfrpt_proptype_NoContentRenderer.isRequired : bpfrpt_proptype_NoContentRenderer : PropTypes.shape(bpfrpt_proptype_NoContentRenderer).isRequired).apply(this, arguments);\n  },\n\n\n  /**\n   * Callback invoked whenever the scroll offset changes within the inner scrollable region.\n   * This callback can be used to sync scrolling between lists, tables, or grids.\n   */\n  onScroll: PropTypes.func.isRequired,\n\n\n  /**\n   * Called whenever a horizontal or vertical scrollbar is added or removed.\n   * This prop is not intended for end-user use;\n   * It is used by MultiGrid to support fixed-row/fixed-column scroll syncing.\n   */\n  onScrollbarPresenceChange: PropTypes.func.isRequired,\n\n\n  /** Callback invoked with information about the section of the Grid that was just rendered.  */\n  onSectionRendered: PropTypes.func.isRequired,\n\n\n  /**\n   * Number of columns to render before/after the visible section of the grid.\n   * These columns can help for smoother scrolling on touch devices or browsers that send scroll events infrequently.\n   */\n  overscanColumnCount: PropTypes.number.isRequired,\n\n\n  /**\n   * Calculates the number of cells to overscan before and after a specified range.\n   * This function ensures that overscanning doesn't exceed the available cells.\n   */\n  overscanIndicesGetter: function overscanIndicesGetter() {\n    return (typeof bpfrpt_proptype_OverscanIndicesGetter === 'function' ? bpfrpt_proptype_OverscanIndicesGetter.isRequired ? bpfrpt_proptype_OverscanIndicesGetter.isRequired : bpfrpt_proptype_OverscanIndicesGetter : PropTypes.shape(bpfrpt_proptype_OverscanIndicesGetter).isRequired).apply(this, arguments);\n  },\n\n\n  /**\n   * Number of rows to render above/below the visible section of the grid.\n   * These rows can help for smoother scrolling on touch devices or browsers that send scroll events infrequently.\n   */\n  overscanRowCount: PropTypes.number.isRequired,\n\n\n  /** ARIA role for the grid element.  */\n  role: PropTypes.string.isRequired,\n\n\n  /**\n   * Either a fixed row height (number) or a function that returns the height of a row given its index.\n   * Should implement the following interface: ({ index: number }): number\n   */\n  rowHeight: function rowHeight() {\n    return (typeof bpfrpt_proptype_CellSize === 'function' ? bpfrpt_proptype_CellSize.isRequired ? bpfrpt_proptype_CellSize.isRequired : bpfrpt_proptype_CellSize : PropTypes.shape(bpfrpt_proptype_CellSize).isRequired).apply(this, arguments);\n  },\n\n\n  /** Number of rows in grid.  */\n  rowCount: PropTypes.number.isRequired,\n\n\n  /** Wait this amount of time after the last scroll event before resetting Grid `pointer-events`. */\n  scrollingResetTimeInterval: PropTypes.number.isRequired,\n\n\n  /** Horizontal offset. */\n  scrollLeft: PropTypes.number,\n\n\n  /**\n   * Controls scroll-to-cell behavior of the Grid.\n   * The default (\"auto\") scrolls the least amount possible to ensure that the specified cell is fully visible.\n   * Use \"start\" to align cells to the top/left of the Grid and \"end\" to align bottom/right.\n   */\n  scrollToAlignment: function scrollToAlignment() {\n    return (typeof bpfrpt_proptype_Alignment === 'function' ? bpfrpt_proptype_Alignment.isRequired ? bpfrpt_proptype_Alignment.isRequired : bpfrpt_proptype_Alignment : PropTypes.shape(bpfrpt_proptype_Alignment).isRequired).apply(this, arguments);\n  },\n\n\n  /** Column index to ensure visible (by forcefully scrolling if necessary) */\n  scrollToColumn: PropTypes.number.isRequired,\n\n\n  /** Vertical offset. */\n  scrollTop: PropTypes.number,\n\n\n  /** Row index to ensure visible (by forcefully scrolling if necessary) */\n  scrollToRow: PropTypes.number.isRequired,\n\n\n  /** Optional inline style */\n  style: PropTypes.object.isRequired,\n\n\n  /** Tab index for focus */\n  tabIndex: PropTypes.number,\n\n\n  /** Width of Grid; this property determines the number of visible (vs virtualized) columns.  */\n  width: PropTypes.number.isRequired\n};\n\n\npolyfill(Grid);\nexport default Grid;\nimport { bpfrpt_proptype_CellRenderer } from './types';\nimport { bpfrpt_proptype_CellRangeRenderer } from './types';\nimport { bpfrpt_proptype_CellPosition } from './types';\nimport { bpfrpt_proptype_CellSize } from './types';\nimport { bpfrpt_proptype_CellSizeGetter } from './types';\nimport { bpfrpt_proptype_NoContentRenderer } from './types';\nimport { bpfrpt_proptype_Scroll } from './types';\nimport { bpfrpt_proptype_ScrollbarPresenceChange } from './types';\nimport { bpfrpt_proptype_RenderedSection } from './types';\nimport { bpfrpt_proptype_OverscanIndicesGetter } from './types';\nimport { bpfrpt_proptype_Alignment } from './types';\nimport { bpfrpt_proptype_CellCache } from './types';\nimport { bpfrpt_proptype_StyleCache } from './types';\nimport { bpfrpt_proptype_AnimationTimeoutId } from '../utils/requestAnimationTimeout';\nimport PropTypes from 'prop-types';","import _extends from 'babel-runtime/helpers/extends';\nimport _Object$getOwnPropertyDescriptor from 'babel-runtime/core-js/object/get-own-property-descriptor';\nimport _Object$getPrototypeOf from 'babel-runtime/core-js/object/get-prototype-of';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport Grid, { accessibilityOverscanIndicesGetter } from '../Grid';\nimport * as React from 'react';\nimport cn from 'classnames';\n\n/**\n * It is inefficient to create and manage a large list of DOM elements within a scrolling container\n * if only a few of those elements are visible. The primary purpose of this component is to improve\n * performance by only rendering the DOM nodes that a user is able to see based on their current\n * scroll position.\n *\n * This component renders a virtualized list of elements with either fixed or dynamic heights.\n */\n\nvar List = function (_React$PureComponent) {\n  _inherits(List, _React$PureComponent);\n\n  function List() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, List);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = List.__proto__ || _Object$getPrototypeOf(List)).call.apply(_ref, [this].concat(args))), _this), _this._cellRenderer = function (_ref2) {\n      var parent = _ref2.parent,\n          rowIndex = _ref2.rowIndex,\n          style = _ref2.style,\n          isScrolling = _ref2.isScrolling,\n          isVisible = _ref2.isVisible,\n          key = _ref2.key;\n      var rowRenderer = _this.props.rowRenderer;\n\n      // TRICKY The style object is sometimes cached by Grid.\n      // This prevents new style objects from bypassing shallowCompare().\n      // However as of React 16, style props are auto-frozen (at least in dev mode)\n      // Check to make sure we can still modify the style before proceeding.\n      // https://github.com/facebook/react/commit/977357765b44af8ff0cfea327866861073095c12#commitcomment-20648713\n\n      var _Object$getOwnPropert = _Object$getOwnPropertyDescriptor(style, 'width'),\n          writable = _Object$getOwnPropert.writable;\n\n      if (writable) {\n        // By default, List cells should be 100% width.\n        // This prevents them from flowing under a scrollbar (if present).\n        style.width = '100%';\n      }\n\n      return rowRenderer({\n        index: rowIndex,\n        style: style,\n        isScrolling: isScrolling,\n        isVisible: isVisible,\n        key: key,\n        parent: parent\n      });\n    }, _this._setRef = function (ref) {\n      _this.Grid = ref;\n    }, _this._onScroll = function (_ref3) {\n      var clientHeight = _ref3.clientHeight,\n          scrollHeight = _ref3.scrollHeight,\n          scrollTop = _ref3.scrollTop;\n      var onScroll = _this.props.onScroll;\n\n\n      onScroll({ clientHeight: clientHeight, scrollHeight: scrollHeight, scrollTop: scrollTop });\n    }, _this._onSectionRendered = function (_ref4) {\n      var rowOverscanStartIndex = _ref4.rowOverscanStartIndex,\n          rowOverscanStopIndex = _ref4.rowOverscanStopIndex,\n          rowStartIndex = _ref4.rowStartIndex,\n          rowStopIndex = _ref4.rowStopIndex;\n      var onRowsRendered = _this.props.onRowsRendered;\n\n\n      onRowsRendered({\n        overscanStartIndex: rowOverscanStartIndex,\n        overscanStopIndex: rowOverscanStopIndex,\n        startIndex: rowStartIndex,\n        stopIndex: rowStopIndex\n      });\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(List, [{\n    key: 'forceUpdateGrid',\n    value: function forceUpdateGrid() {\n      if (this.Grid) {\n        this.Grid.forceUpdate();\n      }\n    }\n\n    /** See Grid#getOffsetForCell */\n\n  }, {\n    key: 'getOffsetForRow',\n    value: function getOffsetForRow(_ref5) {\n      var alignment = _ref5.alignment,\n          index = _ref5.index;\n\n      if (this.Grid) {\n        var _Grid$getOffsetForCel = this.Grid.getOffsetForCell({\n          alignment: alignment,\n          rowIndex: index,\n          columnIndex: 0\n        }),\n            _scrollTop = _Grid$getOffsetForCel.scrollTop;\n\n        return _scrollTop;\n      }\n      return 0;\n    }\n\n    /** CellMeasurer compatibility */\n\n  }, {\n    key: 'invalidateCellSizeAfterRender',\n    value: function invalidateCellSizeAfterRender(_ref6) {\n      var columnIndex = _ref6.columnIndex,\n          rowIndex = _ref6.rowIndex;\n\n      if (this.Grid) {\n        this.Grid.invalidateCellSizeAfterRender({\n          rowIndex: rowIndex,\n          columnIndex: columnIndex\n        });\n      }\n    }\n\n    /** See Grid#measureAllCells */\n\n  }, {\n    key: 'measureAllRows',\n    value: function measureAllRows() {\n      if (this.Grid) {\n        this.Grid.measureAllCells();\n      }\n    }\n\n    /** CellMeasurer compatibility */\n\n  }, {\n    key: 'recomputeGridSize',\n    value: function recomputeGridSize() {\n      var _ref7 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          _ref7$columnIndex = _ref7.columnIndex,\n          columnIndex = _ref7$columnIndex === undefined ? 0 : _ref7$columnIndex,\n          _ref7$rowIndex = _ref7.rowIndex,\n          rowIndex = _ref7$rowIndex === undefined ? 0 : _ref7$rowIndex;\n\n      if (this.Grid) {\n        this.Grid.recomputeGridSize({\n          rowIndex: rowIndex,\n          columnIndex: columnIndex\n        });\n      }\n    }\n\n    /** See Grid#recomputeGridSize */\n\n  }, {\n    key: 'recomputeRowHeights',\n    value: function recomputeRowHeights() {\n      var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n      if (this.Grid) {\n        this.Grid.recomputeGridSize({\n          rowIndex: index,\n          columnIndex: 0\n        });\n      }\n    }\n\n    /** See Grid#scrollToPosition */\n\n  }, {\n    key: 'scrollToPosition',\n    value: function scrollToPosition() {\n      var scrollTop = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n      if (this.Grid) {\n        this.Grid.scrollToPosition({ scrollTop: scrollTop });\n      }\n    }\n\n    /** See Grid#scrollToCell */\n\n  }, {\n    key: 'scrollToRow',\n    value: function scrollToRow() {\n      var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n      if (this.Grid) {\n        this.Grid.scrollToCell({\n          columnIndex: 0,\n          rowIndex: index\n        });\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props = this.props,\n          className = _props.className,\n          noRowsRenderer = _props.noRowsRenderer,\n          scrollToIndex = _props.scrollToIndex,\n          width = _props.width;\n\n\n      var classNames = cn('ReactVirtualized__List', className);\n\n      return React.createElement(Grid, _extends({}, this.props, {\n        autoContainerWidth: true,\n        cellRenderer: this._cellRenderer,\n        className: classNames,\n        columnWidth: width,\n        columnCount: 1,\n        noContentRenderer: noRowsRenderer,\n        onScroll: this._onScroll,\n        onSectionRendered: this._onSectionRendered,\n        ref: this._setRef,\n        scrollToRow: scrollToIndex\n      }));\n    }\n  }]);\n\n  return List;\n}(React.PureComponent);\n\nList.defaultProps = {\n  autoHeight: false,\n  estimatedRowSize: 30,\n  onScroll: function onScroll() {},\n  noRowsRenderer: function noRowsRenderer() {\n    return null;\n  },\n  onRowsRendered: function onRowsRendered() {},\n  overscanIndicesGetter: accessibilityOverscanIndicesGetter,\n  overscanRowCount: 10,\n  scrollToAlignment: 'auto',\n  scrollToIndex: -1,\n  style: {}\n};\nList.propTypes = process.env.NODE_ENV === 'production' ? null : {\n  \"aria-label\": PropTypes.string,\n\n\n  /**\n   * Removes fixed height from the scrollingContainer so that the total height\n   * of rows can stretch the window. Intended for use with WindowScroller\n   */\n  autoHeight: PropTypes.bool.isRequired,\n\n\n  /** Optional CSS class name */\n  className: PropTypes.string,\n\n\n  /**\n   * Used to estimate the total height of a List before all of its rows have actually been measured.\n   * The estimated total height is adjusted as rows are rendered.\n   */\n  estimatedRowSize: PropTypes.number.isRequired,\n\n\n  /** Height constraint for list (determines how many actual rows are rendered) */\n  height: PropTypes.number.isRequired,\n\n\n  /** Optional renderer to be used in place of rows when rowCount is 0 */\n  noRowsRenderer: function noRowsRenderer() {\n    return (typeof bpfrpt_proptype_NoContentRenderer === 'function' ? bpfrpt_proptype_NoContentRenderer.isRequired ? bpfrpt_proptype_NoContentRenderer.isRequired : bpfrpt_proptype_NoContentRenderer : PropTypes.shape(bpfrpt_proptype_NoContentRenderer).isRequired).apply(this, arguments);\n  },\n\n\n  /** Callback invoked with information about the slice of rows that were just rendered.  */\n\n  onRowsRendered: PropTypes.func.isRequired,\n\n\n  /**\n   * Callback invoked whenever the scroll offset changes within the inner scrollable region.\n   * This callback can be used to sync scrolling between lists, tables, or grids.\n   */\n  onScroll: PropTypes.func.isRequired,\n\n\n  /** See Grid#overscanIndicesGetter */\n  overscanIndicesGetter: function overscanIndicesGetter() {\n    return (typeof bpfrpt_proptype_OverscanIndicesGetter === 'function' ? bpfrpt_proptype_OverscanIndicesGetter.isRequired ? bpfrpt_proptype_OverscanIndicesGetter.isRequired : bpfrpt_proptype_OverscanIndicesGetter : PropTypes.shape(bpfrpt_proptype_OverscanIndicesGetter).isRequired).apply(this, arguments);\n  },\n\n\n  /**\n   * Number of rows to render above/below the visible bounds of the list.\n   * These rows can help for smoother scrolling on touch devices.\n   */\n  overscanRowCount: PropTypes.number.isRequired,\n\n\n  /** Either a fixed row height (number) or a function that returns the height of a row given its index.  */\n  rowHeight: function rowHeight() {\n    return (typeof bpfrpt_proptype_CellSize === 'function' ? bpfrpt_proptype_CellSize.isRequired ? bpfrpt_proptype_CellSize.isRequired : bpfrpt_proptype_CellSize : PropTypes.shape(bpfrpt_proptype_CellSize).isRequired).apply(this, arguments);\n  },\n\n\n  /** Responsible for rendering a row given an index; ({ index: number }): node */\n  rowRenderer: function rowRenderer() {\n    return (typeof bpfrpt_proptype_RowRenderer === 'function' ? bpfrpt_proptype_RowRenderer.isRequired ? bpfrpt_proptype_RowRenderer.isRequired : bpfrpt_proptype_RowRenderer : PropTypes.shape(bpfrpt_proptype_RowRenderer).isRequired).apply(this, arguments);\n  },\n\n\n  /** Number of rows in list. */\n  rowCount: PropTypes.number.isRequired,\n\n\n  /** See Grid#scrollToAlignment */\n  scrollToAlignment: function scrollToAlignment() {\n    return (typeof bpfrpt_proptype_Alignment === 'function' ? bpfrpt_proptype_Alignment.isRequired ? bpfrpt_proptype_Alignment.isRequired : bpfrpt_proptype_Alignment : PropTypes.shape(bpfrpt_proptype_Alignment).isRequired).apply(this, arguments);\n  },\n\n\n  /** Row index to ensure visible (by forcefully scrolling if necessary) */\n  scrollToIndex: PropTypes.number.isRequired,\n\n\n  /** Vertical offset. */\n  scrollTop: PropTypes.number,\n\n\n  /** Optional inline style */\n  style: PropTypes.object.isRequired,\n\n\n  /** Tab index for focus */\n  tabIndex: PropTypes.number,\n\n\n  /** Width of list */\n  width: PropTypes.number.isRequired\n};\nexport default List;\nimport { bpfrpt_proptype_NoContentRenderer } from '../Grid';\nimport { bpfrpt_proptype_Alignment } from '../Grid';\nimport { bpfrpt_proptype_CellSize } from '../Grid';\nimport { bpfrpt_proptype_CellPosition } from '../Grid';\nimport { bpfrpt_proptype_OverscanIndicesGetter } from '../Grid';\nimport { bpfrpt_proptype_RenderedSection } from '../Grid';\nimport { bpfrpt_proptype_CellRendererParams } from '../Grid';\nimport { bpfrpt_proptype_Scroll as bpfrpt_proptype_GridScroll } from '../Grid';\nimport { bpfrpt_proptype_RowRenderer } from './types';\nimport { bpfrpt_proptype_RenderedRows } from './types';\nimport { bpfrpt_proptype_Scroll } from './types';\nimport PropTypes from 'prop-types';","\n\nexport { default } from './List';\n\nexport { default as List } from './List';\nimport { bpfrpt_proptype_RowRendererParams } from './types';\nexport { bpfrpt_proptype_RowRendererParams };","import _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport { CellMeasurerCache } from '../CellMeasurer';\n\n/**\n * Caches measurements for a given cell.\n */\nvar CellMeasurerCacheDecorator = function () {\n  function CellMeasurerCacheDecorator() {\n    var _this = this;\n\n    var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, CellMeasurerCacheDecorator);\n\n    this.columnWidth = function (_ref) {\n      var index = _ref.index;\n\n      _this._cellMeasurerCache.columnWidth({\n        index: index + _this._columnIndexOffset\n      });\n    };\n\n    this.rowHeight = function (_ref2) {\n      var index = _ref2.index;\n\n      _this._cellMeasurerCache.rowHeight({\n        index: index + _this._rowIndexOffset\n      });\n    };\n\n    var cellMeasurerCache = params.cellMeasurerCache,\n        _params$columnIndexOf = params.columnIndexOffset,\n        columnIndexOffset = _params$columnIndexOf === undefined ? 0 : _params$columnIndexOf,\n        _params$rowIndexOffse = params.rowIndexOffset,\n        rowIndexOffset = _params$rowIndexOffse === undefined ? 0 : _params$rowIndexOffse;\n\n\n    this._cellMeasurerCache = cellMeasurerCache;\n    this._columnIndexOffset = columnIndexOffset;\n    this._rowIndexOffset = rowIndexOffset;\n  }\n\n  _createClass(CellMeasurerCacheDecorator, [{\n    key: 'clear',\n    value: function clear(rowIndex, columnIndex) {\n      this._cellMeasurerCache.clear(rowIndex + this._rowIndexOffset, columnIndex + this._columnIndexOffset);\n    }\n  }, {\n    key: 'clearAll',\n    value: function clearAll() {\n      this._cellMeasurerCache.clearAll();\n    }\n  }, {\n    key: 'hasFixedHeight',\n    value: function hasFixedHeight() {\n      return this._cellMeasurerCache.hasFixedHeight();\n    }\n  }, {\n    key: 'hasFixedWidth',\n    value: function hasFixedWidth() {\n      return this._cellMeasurerCache.hasFixedWidth();\n    }\n  }, {\n    key: 'getHeight',\n    value: function getHeight(rowIndex) {\n      var columnIndex = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      return this._cellMeasurerCache.getHeight(rowIndex + this._rowIndexOffset, columnIndex + this._columnIndexOffset);\n    }\n  }, {\n    key: 'getWidth',\n    value: function getWidth(rowIndex) {\n      var columnIndex = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      return this._cellMeasurerCache.getWidth(rowIndex + this._rowIndexOffset, columnIndex + this._columnIndexOffset);\n    }\n  }, {\n    key: 'has',\n    value: function has(rowIndex) {\n      var columnIndex = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      return this._cellMeasurerCache.has(rowIndex + this._rowIndexOffset, columnIndex + this._columnIndexOffset);\n    }\n  }, {\n    key: 'set',\n    value: function set(rowIndex, columnIndex, width, height) {\n      this._cellMeasurerCache.set(rowIndex + this._rowIndexOffset, columnIndex + this._columnIndexOffset, width, height);\n    }\n  }, {\n    key: 'defaultHeight',\n    get: function get() {\n      return this._cellMeasurerCache.defaultHeight;\n    }\n  }, {\n    key: 'defaultWidth',\n    get: function get() {\n      return this._cellMeasurerCache.defaultWidth;\n    }\n  }]);\n\n  return CellMeasurerCacheDecorator;\n}();\n\nexport default CellMeasurerCacheDecorator;","import _extends from 'babel-runtime/helpers/extends';\nimport _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _Object$getPrototypeOf from 'babel-runtime/core-js/object/get-prototype-of';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport PropTypes from 'prop-types';\nimport * as React from 'react';\nimport { polyfill } from 'react-lifecycles-compat';\nimport CellMeasurerCacheDecorator from './CellMeasurerCacheDecorator';\nimport Grid from '../Grid';\n\nvar SCROLLBAR_SIZE_BUFFER = 20;\n\n/**\n * Renders 1, 2, or 4 Grids depending on configuration.\n * A main (body) Grid will always be rendered.\n * Optionally, 1-2 Grids for sticky header rows will also be rendered.\n * If no sticky columns, only 1 sticky header Grid will be rendered.\n * If sticky columns, 2 sticky header Grids will be rendered.\n */\n\nvar MultiGrid = function (_React$PureComponent) {\n  _inherits(MultiGrid, _React$PureComponent);\n\n  function MultiGrid(props, context) {\n    _classCallCheck(this, MultiGrid);\n\n    var _this = _possibleConstructorReturn(this, (MultiGrid.__proto__ || _Object$getPrototypeOf(MultiGrid)).call(this, props, context));\n\n    _initialiseProps.call(_this);\n\n    var deferredMeasurementCache = props.deferredMeasurementCache,\n        fixedColumnCount = props.fixedColumnCount,\n        fixedRowCount = props.fixedRowCount;\n\n\n    _this._maybeCalculateCachedStyles(true);\n\n    if (deferredMeasurementCache) {\n      _this._deferredMeasurementCacheBottomLeftGrid = fixedRowCount > 0 ? new CellMeasurerCacheDecorator({\n        cellMeasurerCache: deferredMeasurementCache,\n        columnIndexOffset: 0,\n        rowIndexOffset: fixedRowCount\n      }) : deferredMeasurementCache;\n\n      _this._deferredMeasurementCacheBottomRightGrid = fixedColumnCount > 0 || fixedRowCount > 0 ? new CellMeasurerCacheDecorator({\n        cellMeasurerCache: deferredMeasurementCache,\n        columnIndexOffset: fixedColumnCount,\n        rowIndexOffset: fixedRowCount\n      }) : deferredMeasurementCache;\n\n      _this._deferredMeasurementCacheTopRightGrid = fixedColumnCount > 0 ? new CellMeasurerCacheDecorator({\n        cellMeasurerCache: deferredMeasurementCache,\n        columnIndexOffset: fixedColumnCount,\n        rowIndexOffset: 0\n      }) : deferredMeasurementCache;\n    }\n    return _this;\n  }\n\n  _createClass(MultiGrid, [{\n    key: 'forceUpdateGrids',\n    value: function forceUpdateGrids() {\n      this._bottomLeftGrid && this._bottomLeftGrid.forceUpdate();\n      this._bottomRightGrid && this._bottomRightGrid.forceUpdate();\n      this._topLeftGrid && this._topLeftGrid.forceUpdate();\n      this._topRightGrid && this._topRightGrid.forceUpdate();\n    }\n\n    /** See Grid#invalidateCellSizeAfterRender */\n\n  }, {\n    key: 'invalidateCellSizeAfterRender',\n    value: function invalidateCellSizeAfterRender() {\n      var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          _ref$columnIndex = _ref.columnIndex,\n          columnIndex = _ref$columnIndex === undefined ? 0 : _ref$columnIndex,\n          _ref$rowIndex = _ref.rowIndex,\n          rowIndex = _ref$rowIndex === undefined ? 0 : _ref$rowIndex;\n\n      this._deferredInvalidateColumnIndex = typeof this._deferredInvalidateColumnIndex === 'number' ? Math.min(this._deferredInvalidateColumnIndex, columnIndex) : columnIndex;\n      this._deferredInvalidateRowIndex = typeof this._deferredInvalidateRowIndex === 'number' ? Math.min(this._deferredInvalidateRowIndex, rowIndex) : rowIndex;\n    }\n\n    /** See Grid#measureAllCells */\n\n  }, {\n    key: 'measureAllCells',\n    value: function measureAllCells() {\n      this._bottomLeftGrid && this._bottomLeftGrid.measureAllCells();\n      this._bottomRightGrid && this._bottomRightGrid.measureAllCells();\n      this._topLeftGrid && this._topLeftGrid.measureAllCells();\n      this._topRightGrid && this._topRightGrid.measureAllCells();\n    }\n\n    /** See Grid#recomputeGridSize */\n\n  }, {\n    key: 'recomputeGridSize',\n    value: function recomputeGridSize() {\n      var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          _ref2$columnIndex = _ref2.columnIndex,\n          columnIndex = _ref2$columnIndex === undefined ? 0 : _ref2$columnIndex,\n          _ref2$rowIndex = _ref2.rowIndex,\n          rowIndex = _ref2$rowIndex === undefined ? 0 : _ref2$rowIndex;\n\n      var _props = this.props,\n          fixedColumnCount = _props.fixedColumnCount,\n          fixedRowCount = _props.fixedRowCount;\n\n\n      var adjustedColumnIndex = Math.max(0, columnIndex - fixedColumnCount);\n      var adjustedRowIndex = Math.max(0, rowIndex - fixedRowCount);\n\n      this._bottomLeftGrid && this._bottomLeftGrid.recomputeGridSize({\n        columnIndex: columnIndex,\n        rowIndex: adjustedRowIndex\n      });\n      this._bottomRightGrid && this._bottomRightGrid.recomputeGridSize({\n        columnIndex: adjustedColumnIndex,\n        rowIndex: adjustedRowIndex\n      });\n      this._topLeftGrid && this._topLeftGrid.recomputeGridSize({\n        columnIndex: columnIndex,\n        rowIndex: rowIndex\n      });\n      this._topRightGrid && this._topRightGrid.recomputeGridSize({\n        columnIndex: adjustedColumnIndex,\n        rowIndex: rowIndex\n      });\n\n      this._leftGridWidth = null;\n      this._topGridHeight = null;\n      this._maybeCalculateCachedStyles(true);\n    }\n  }, {\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var _props2 = this.props,\n          scrollLeft = _props2.scrollLeft,\n          scrollTop = _props2.scrollTop;\n\n\n      if (scrollLeft > 0 || scrollTop > 0) {\n        var newState = {};\n\n        if (scrollLeft > 0) {\n          newState.scrollLeft = scrollLeft;\n        }\n\n        if (scrollTop > 0) {\n          newState.scrollTop = scrollTop;\n        }\n\n        this.setState(newState);\n      }\n      this._handleInvalidatedGridSize();\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate() {\n      this._handleInvalidatedGridSize();\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props3 = this.props,\n          onScroll = _props3.onScroll,\n          onSectionRendered = _props3.onSectionRendered,\n          onScrollbarPresenceChange = _props3.onScrollbarPresenceChange,\n          scrollLeftProp = _props3.scrollLeft,\n          scrollToColumn = _props3.scrollToColumn,\n          scrollTopProp = _props3.scrollTop,\n          scrollToRow = _props3.scrollToRow,\n          rest = _objectWithoutProperties(_props3, ['onScroll', 'onSectionRendered', 'onScrollbarPresenceChange', 'scrollLeft', 'scrollToColumn', 'scrollTop', 'scrollToRow']);\n\n      this._prepareForRender();\n\n      // Don't render any of our Grids if there are no cells.\n      // This mirrors what Grid does,\n      // And prevents us from recording inaccurage measurements when used with CellMeasurer.\n      if (this.props.width === 0 || this.props.height === 0) {\n        return null;\n      }\n\n      // scrollTop and scrollLeft props are explicitly filtered out and ignored\n\n      var _state = this.state,\n          scrollLeft = _state.scrollLeft,\n          scrollTop = _state.scrollTop;\n\n\n      return React.createElement(\n        'div',\n        { style: this._containerOuterStyle },\n        React.createElement(\n          'div',\n          { style: this._containerTopStyle },\n          this._renderTopLeftGrid(rest),\n          this._renderTopRightGrid(_extends({}, rest, {\n            onScroll: onScroll,\n            scrollLeft: scrollLeft\n          }))\n        ),\n        React.createElement(\n          'div',\n          { style: this._containerBottomStyle },\n          this._renderBottomLeftGrid(_extends({}, rest, {\n            onScroll: onScroll,\n            scrollTop: scrollTop\n          })),\n          this._renderBottomRightGrid(_extends({}, rest, {\n            onScroll: onScroll,\n            onSectionRendered: onSectionRendered,\n            scrollLeft: scrollLeft,\n            scrollToColumn: scrollToColumn,\n            scrollToRow: scrollToRow,\n            scrollTop: scrollTop\n          }))\n        )\n      );\n    }\n  }, {\n    key: '_getBottomGridHeight',\n    value: function _getBottomGridHeight(props) {\n      var height = props.height;\n\n\n      var topGridHeight = this._getTopGridHeight(props);\n\n      return height - topGridHeight;\n    }\n  }, {\n    key: '_getLeftGridWidth',\n    value: function _getLeftGridWidth(props) {\n      var fixedColumnCount = props.fixedColumnCount,\n          columnWidth = props.columnWidth;\n\n\n      if (this._leftGridWidth == null) {\n        if (typeof columnWidth === 'function') {\n          var leftGridWidth = 0;\n\n          for (var index = 0; index < fixedColumnCount; index++) {\n            leftGridWidth += columnWidth({ index: index });\n          }\n\n          this._leftGridWidth = leftGridWidth;\n        } else {\n          this._leftGridWidth = columnWidth * fixedColumnCount;\n        }\n      }\n\n      return this._leftGridWidth;\n    }\n  }, {\n    key: '_getRightGridWidth',\n    value: function _getRightGridWidth(props) {\n      var width = props.width;\n\n\n      var leftGridWidth = this._getLeftGridWidth(props);\n\n      return width - leftGridWidth;\n    }\n  }, {\n    key: '_getTopGridHeight',\n    value: function _getTopGridHeight(props) {\n      var fixedRowCount = props.fixedRowCount,\n          rowHeight = props.rowHeight;\n\n\n      if (this._topGridHeight == null) {\n        if (typeof rowHeight === 'function') {\n          var topGridHeight = 0;\n\n          for (var index = 0; index < fixedRowCount; index++) {\n            topGridHeight += rowHeight({ index: index });\n          }\n\n          this._topGridHeight = topGridHeight;\n        } else {\n          this._topGridHeight = rowHeight * fixedRowCount;\n        }\n      }\n\n      return this._topGridHeight;\n    }\n  }, {\n    key: '_handleInvalidatedGridSize',\n    value: function _handleInvalidatedGridSize() {\n      if (typeof this._deferredInvalidateColumnIndex === 'number') {\n        var columnIndex = this._deferredInvalidateColumnIndex;\n        var rowIndex = this._deferredInvalidateRowIndex;\n\n        this._deferredInvalidateColumnIndex = null;\n        this._deferredInvalidateRowIndex = null;\n\n        this.recomputeGridSize({\n          columnIndex: columnIndex,\n          rowIndex: rowIndex\n        });\n        this.forceUpdate();\n      }\n    }\n\n    /**\n     * Avoid recreating inline styles each render; this bypasses Grid's shallowCompare.\n     * This method recalculates styles only when specific props change.\n     */\n\n  }, {\n    key: '_maybeCalculateCachedStyles',\n    value: function _maybeCalculateCachedStyles(resetAll) {\n      var _props4 = this.props,\n          columnWidth = _props4.columnWidth,\n          enableFixedColumnScroll = _props4.enableFixedColumnScroll,\n          enableFixedRowScroll = _props4.enableFixedRowScroll,\n          height = _props4.height,\n          fixedColumnCount = _props4.fixedColumnCount,\n          fixedRowCount = _props4.fixedRowCount,\n          rowHeight = _props4.rowHeight,\n          style = _props4.style,\n          styleBottomLeftGrid = _props4.styleBottomLeftGrid,\n          styleBottomRightGrid = _props4.styleBottomRightGrid,\n          styleTopLeftGrid = _props4.styleTopLeftGrid,\n          styleTopRightGrid = _props4.styleTopRightGrid,\n          width = _props4.width;\n\n\n      var sizeChange = resetAll || height !== this._lastRenderedHeight || width !== this._lastRenderedWidth;\n      var leftSizeChange = resetAll || columnWidth !== this._lastRenderedColumnWidth || fixedColumnCount !== this._lastRenderedFixedColumnCount;\n      var topSizeChange = resetAll || fixedRowCount !== this._lastRenderedFixedRowCount || rowHeight !== this._lastRenderedRowHeight;\n\n      if (resetAll || sizeChange || style !== this._lastRenderedStyle) {\n        this._containerOuterStyle = _extends({\n          height: height,\n          overflow: 'visible', // Let :focus outline show through\n          width: width\n        }, style);\n      }\n\n      if (resetAll || sizeChange || topSizeChange) {\n        this._containerTopStyle = {\n          height: this._getTopGridHeight(this.props),\n          position: 'relative',\n          width: width\n        };\n\n        this._containerBottomStyle = {\n          height: height - this._getTopGridHeight(this.props),\n          overflow: 'visible', // Let :focus outline show through\n          position: 'relative',\n          width: width\n        };\n      }\n\n      if (resetAll || styleBottomLeftGrid !== this._lastRenderedStyleBottomLeftGrid) {\n        this._bottomLeftGridStyle = _extends({\n          left: 0,\n          overflowX: 'hidden',\n          overflowY: enableFixedColumnScroll ? 'auto' : 'hidden',\n          position: 'absolute'\n        }, styleBottomLeftGrid);\n      }\n\n      if (resetAll || leftSizeChange || styleBottomRightGrid !== this._lastRenderedStyleBottomRightGrid) {\n        this._bottomRightGridStyle = _extends({\n          left: this._getLeftGridWidth(this.props),\n          position: 'absolute'\n        }, styleBottomRightGrid);\n      }\n\n      if (resetAll || styleTopLeftGrid !== this._lastRenderedStyleTopLeftGrid) {\n        this._topLeftGridStyle = _extends({\n          left: 0,\n          overflowX: 'hidden',\n          overflowY: 'hidden',\n          position: 'absolute',\n          top: 0\n        }, styleTopLeftGrid);\n      }\n\n      if (resetAll || leftSizeChange || styleTopRightGrid !== this._lastRenderedStyleTopRightGrid) {\n        this._topRightGridStyle = _extends({\n          left: this._getLeftGridWidth(this.props),\n          overflowX: enableFixedRowScroll ? 'auto' : 'hidden',\n          overflowY: 'hidden',\n          position: 'absolute',\n          top: 0\n        }, styleTopRightGrid);\n      }\n\n      this._lastRenderedColumnWidth = columnWidth;\n      this._lastRenderedFixedColumnCount = fixedColumnCount;\n      this._lastRenderedFixedRowCount = fixedRowCount;\n      this._lastRenderedHeight = height;\n      this._lastRenderedRowHeight = rowHeight;\n      this._lastRenderedStyle = style;\n      this._lastRenderedStyleBottomLeftGrid = styleBottomLeftGrid;\n      this._lastRenderedStyleBottomRightGrid = styleBottomRightGrid;\n      this._lastRenderedStyleTopLeftGrid = styleTopLeftGrid;\n      this._lastRenderedStyleTopRightGrid = styleTopRightGrid;\n      this._lastRenderedWidth = width;\n    }\n  }, {\n    key: '_prepareForRender',\n    value: function _prepareForRender() {\n      if (this._lastRenderedColumnWidth !== this.props.columnWidth || this._lastRenderedFixedColumnCount !== this.props.fixedColumnCount) {\n        this._leftGridWidth = null;\n      }\n\n      if (this._lastRenderedFixedRowCount !== this.props.fixedRowCount || this._lastRenderedRowHeight !== this.props.rowHeight) {\n        this._topGridHeight = null;\n      }\n\n      this._maybeCalculateCachedStyles();\n\n      this._lastRenderedColumnWidth = this.props.columnWidth;\n      this._lastRenderedFixedColumnCount = this.props.fixedColumnCount;\n      this._lastRenderedFixedRowCount = this.props.fixedRowCount;\n      this._lastRenderedRowHeight = this.props.rowHeight;\n    }\n  }, {\n    key: '_renderBottomLeftGrid',\n    value: function _renderBottomLeftGrid(props) {\n      var enableFixedColumnScroll = props.enableFixedColumnScroll,\n          fixedColumnCount = props.fixedColumnCount,\n          fixedRowCount = props.fixedRowCount,\n          rowCount = props.rowCount,\n          hideBottomLeftGridScrollbar = props.hideBottomLeftGridScrollbar;\n      var showVerticalScrollbar = this.state.showVerticalScrollbar;\n\n\n      if (!fixedColumnCount) {\n        return null;\n      }\n\n      var additionalRowCount = showVerticalScrollbar ? 1 : 0,\n          height = this._getBottomGridHeight(props),\n          width = this._getLeftGridWidth(props),\n          scrollbarSize = this.state.showVerticalScrollbar ? this.state.scrollbarSize : 0,\n          gridWidth = hideBottomLeftGridScrollbar ? width + scrollbarSize : width;\n\n      var bottomLeftGrid = React.createElement(Grid, _extends({}, props, {\n        cellRenderer: this._cellRendererBottomLeftGrid,\n        className: this.props.classNameBottomLeftGrid,\n        columnCount: fixedColumnCount,\n        deferredMeasurementCache: this._deferredMeasurementCacheBottomLeftGrid,\n        height: height,\n        onScroll: enableFixedColumnScroll ? this._onScrollTop : undefined,\n        ref: this._bottomLeftGridRef,\n        rowCount: Math.max(0, rowCount - fixedRowCount) + additionalRowCount,\n        rowHeight: this._rowHeightBottomGrid,\n        style: this._bottomLeftGridStyle,\n        tabIndex: null,\n        width: gridWidth\n      }));\n\n      if (hideBottomLeftGridScrollbar) {\n        return React.createElement(\n          'div',\n          {\n            className: 'BottomLeftGrid_ScrollWrapper',\n            style: _extends({}, this._bottomLeftGridStyle, {\n              height: height,\n              width: width,\n              overflowY: 'hidden'\n            }) },\n          bottomLeftGrid\n        );\n      }\n      return bottomLeftGrid;\n    }\n  }, {\n    key: '_renderBottomRightGrid',\n    value: function _renderBottomRightGrid(props) {\n      var columnCount = props.columnCount,\n          fixedColumnCount = props.fixedColumnCount,\n          fixedRowCount = props.fixedRowCount,\n          rowCount = props.rowCount,\n          scrollToColumn = props.scrollToColumn,\n          scrollToRow = props.scrollToRow;\n\n\n      return React.createElement(Grid, _extends({}, props, {\n        cellRenderer: this._cellRendererBottomRightGrid,\n        className: this.props.classNameBottomRightGrid,\n        columnCount: Math.max(0, columnCount - fixedColumnCount),\n        columnWidth: this._columnWidthRightGrid,\n        deferredMeasurementCache: this._deferredMeasurementCacheBottomRightGrid,\n        height: this._getBottomGridHeight(props),\n        onScroll: this._onScroll,\n        onScrollbarPresenceChange: this._onScrollbarPresenceChange,\n        ref: this._bottomRightGridRef,\n        rowCount: Math.max(0, rowCount - fixedRowCount),\n        rowHeight: this._rowHeightBottomGrid,\n        scrollToColumn: scrollToColumn - fixedColumnCount,\n        scrollToRow: scrollToRow - fixedRowCount,\n        style: this._bottomRightGridStyle,\n        width: this._getRightGridWidth(props)\n      }));\n    }\n  }, {\n    key: '_renderTopLeftGrid',\n    value: function _renderTopLeftGrid(props) {\n      var fixedColumnCount = props.fixedColumnCount,\n          fixedRowCount = props.fixedRowCount;\n\n\n      if (!fixedColumnCount || !fixedRowCount) {\n        return null;\n      }\n\n      return React.createElement(Grid, _extends({}, props, {\n        className: this.props.classNameTopLeftGrid,\n        columnCount: fixedColumnCount,\n        height: this._getTopGridHeight(props),\n        ref: this._topLeftGridRef,\n        rowCount: fixedRowCount,\n        style: this._topLeftGridStyle,\n        tabIndex: null,\n        width: this._getLeftGridWidth(props)\n      }));\n    }\n  }, {\n    key: '_renderTopRightGrid',\n    value: function _renderTopRightGrid(props) {\n      var columnCount = props.columnCount,\n          enableFixedRowScroll = props.enableFixedRowScroll,\n          fixedColumnCount = props.fixedColumnCount,\n          fixedRowCount = props.fixedRowCount,\n          scrollLeft = props.scrollLeft,\n          hideTopRightGridScrollbar = props.hideTopRightGridScrollbar;\n      var _state2 = this.state,\n          showHorizontalScrollbar = _state2.showHorizontalScrollbar,\n          scrollbarSize = _state2.scrollbarSize;\n\n\n      if (!fixedRowCount) {\n        return null;\n      }\n\n      var additionalColumnCount = showHorizontalScrollbar ? 1 : 0,\n          height = this._getTopGridHeight(props),\n          width = this._getRightGridWidth(props),\n          additionalHeight = showHorizontalScrollbar ? scrollbarSize : 0;\n\n      var gridHeight = height,\n          style = this._topRightGridStyle;\n\n      if (hideTopRightGridScrollbar) {\n        gridHeight = height + additionalHeight;\n        style = _extends({}, this._topRightGridStyle, {\n          left: 0\n        });\n      }\n\n      var topRightGrid = React.createElement(Grid, _extends({}, props, {\n        cellRenderer: this._cellRendererTopRightGrid,\n        className: this.props.classNameTopRightGrid,\n        columnCount: Math.max(0, columnCount - fixedColumnCount) + additionalColumnCount,\n        columnWidth: this._columnWidthRightGrid,\n        deferredMeasurementCache: this._deferredMeasurementCacheTopRightGrid,\n        height: gridHeight,\n        onScroll: enableFixedRowScroll ? this._onScrollLeft : undefined,\n        ref: this._topRightGridRef,\n        rowCount: fixedRowCount,\n        scrollLeft: scrollLeft,\n        style: style,\n        tabIndex: null,\n        width: width\n      }));\n\n      if (hideTopRightGridScrollbar) {\n        return React.createElement(\n          'div',\n          {\n            className: 'TopRightGrid_ScrollWrapper',\n            style: _extends({}, this._topRightGridStyle, {\n              height: height,\n              width: width,\n              overflowX: 'hidden'\n            }) },\n          topRightGrid\n        );\n      }\n      return topRightGrid;\n    }\n  }], [{\n    key: 'getDerivedStateFromProps',\n    value: function getDerivedStateFromProps(nextProps, prevState) {\n      if (nextProps.scrollLeft !== prevState.scrollLeft || nextProps.scrollTop !== prevState.scrollTop) {\n        return {\n          scrollLeft: nextProps.scrollLeft != null && nextProps.scrollLeft >= 0 ? nextProps.scrollLeft : prevState.scrollLeft,\n          scrollTop: nextProps.scrollTop != null && nextProps.scrollTop >= 0 ? nextProps.scrollTop : prevState.scrollTop\n        };\n      }\n\n      return null;\n    }\n  }]);\n\n  return MultiGrid;\n}(React.PureComponent);\n\nMultiGrid.defaultProps = {\n  classNameBottomLeftGrid: '',\n  classNameBottomRightGrid: '',\n  classNameTopLeftGrid: '',\n  classNameTopRightGrid: '',\n  enableFixedColumnScroll: false,\n  enableFixedRowScroll: false,\n  fixedColumnCount: 0,\n  fixedRowCount: 0,\n  scrollToColumn: -1,\n  scrollToRow: -1,\n  style: {},\n  styleBottomLeftGrid: {},\n  styleBottomRightGrid: {},\n  styleTopLeftGrid: {},\n  styleTopRightGrid: {},\n  hideTopRightGridScrollbar: false,\n  hideBottomLeftGridScrollbar: false\n};\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this2 = this;\n\n  this.state = {\n    scrollLeft: 0,\n    scrollTop: 0,\n    scrollbarSize: 0,\n    showHorizontalScrollbar: false,\n    showVerticalScrollbar: false\n  };\n  this._deferredInvalidateColumnIndex = null;\n  this._deferredInvalidateRowIndex = null;\n\n  this._bottomLeftGridRef = function (ref) {\n    _this2._bottomLeftGrid = ref;\n  };\n\n  this._bottomRightGridRef = function (ref) {\n    _this2._bottomRightGrid = ref;\n  };\n\n  this._cellRendererBottomLeftGrid = function (_ref3) {\n    var rowIndex = _ref3.rowIndex,\n        rest = _objectWithoutProperties(_ref3, ['rowIndex']);\n\n    var _props5 = _this2.props,\n        cellRenderer = _props5.cellRenderer,\n        fixedRowCount = _props5.fixedRowCount,\n        rowCount = _props5.rowCount;\n\n\n    if (rowIndex === rowCount - fixedRowCount) {\n      return React.createElement('div', {\n        key: rest.key,\n        style: _extends({}, rest.style, {\n          height: SCROLLBAR_SIZE_BUFFER\n        })\n      });\n    } else {\n      return cellRenderer(_extends({}, rest, {\n        parent: _this2,\n        rowIndex: rowIndex + fixedRowCount\n      }));\n    }\n  };\n\n  this._cellRendererBottomRightGrid = function (_ref4) {\n    var columnIndex = _ref4.columnIndex,\n        rowIndex = _ref4.rowIndex,\n        rest = _objectWithoutProperties(_ref4, ['columnIndex', 'rowIndex']);\n\n    var _props6 = _this2.props,\n        cellRenderer = _props6.cellRenderer,\n        fixedColumnCount = _props6.fixedColumnCount,\n        fixedRowCount = _props6.fixedRowCount;\n\n\n    return cellRenderer(_extends({}, rest, {\n      columnIndex: columnIndex + fixedColumnCount,\n      parent: _this2,\n      rowIndex: rowIndex + fixedRowCount\n    }));\n  };\n\n  this._cellRendererTopRightGrid = function (_ref5) {\n    var columnIndex = _ref5.columnIndex,\n        rest = _objectWithoutProperties(_ref5, ['columnIndex']);\n\n    var _props7 = _this2.props,\n        cellRenderer = _props7.cellRenderer,\n        columnCount = _props7.columnCount,\n        fixedColumnCount = _props7.fixedColumnCount;\n\n\n    if (columnIndex === columnCount - fixedColumnCount) {\n      return React.createElement('div', {\n        key: rest.key,\n        style: _extends({}, rest.style, {\n          width: SCROLLBAR_SIZE_BUFFER\n        })\n      });\n    } else {\n      return cellRenderer(_extends({}, rest, {\n        columnIndex: columnIndex + fixedColumnCount,\n        parent: _this2\n      }));\n    }\n  };\n\n  this._columnWidthRightGrid = function (_ref6) {\n    var index = _ref6.index;\n    var _props8 = _this2.props,\n        columnCount = _props8.columnCount,\n        fixedColumnCount = _props8.fixedColumnCount,\n        columnWidth = _props8.columnWidth;\n    var _state3 = _this2.state,\n        scrollbarSize = _state3.scrollbarSize,\n        showHorizontalScrollbar = _state3.showHorizontalScrollbar;\n\n    // An extra cell is added to the count\n    // This gives the smaller Grid extra room for offset,\n    // In case the main (bottom right) Grid has a scrollbar\n    // If no scrollbar, the extra space is overflow:hidden anyway\n\n    if (showHorizontalScrollbar && index === columnCount - fixedColumnCount) {\n      return scrollbarSize;\n    }\n\n    return typeof columnWidth === 'function' ? columnWidth({ index: index + fixedColumnCount }) : columnWidth;\n  };\n\n  this._onScroll = function (scrollInfo) {\n    var scrollLeft = scrollInfo.scrollLeft,\n        scrollTop = scrollInfo.scrollTop;\n\n    _this2.setState({\n      scrollLeft: scrollLeft,\n      scrollTop: scrollTop\n    });\n    var onScroll = _this2.props.onScroll;\n    if (onScroll) {\n      onScroll(scrollInfo);\n    }\n  };\n\n  this._onScrollbarPresenceChange = function (_ref7) {\n    var horizontal = _ref7.horizontal,\n        size = _ref7.size,\n        vertical = _ref7.vertical;\n    var _state4 = _this2.state,\n        showHorizontalScrollbar = _state4.showHorizontalScrollbar,\n        showVerticalScrollbar = _state4.showVerticalScrollbar;\n\n\n    if (horizontal !== showHorizontalScrollbar || vertical !== showVerticalScrollbar) {\n      _this2.setState({\n        scrollbarSize: size,\n        showHorizontalScrollbar: horizontal,\n        showVerticalScrollbar: vertical\n      });\n\n      var onScrollbarPresenceChange = _this2.props.onScrollbarPresenceChange;\n\n      if (typeof onScrollbarPresenceChange === 'function') {\n        onScrollbarPresenceChange({\n          horizontal: horizontal,\n          size: size,\n          vertical: vertical\n        });\n      }\n    }\n  };\n\n  this._onScrollLeft = function (scrollInfo) {\n    var scrollLeft = scrollInfo.scrollLeft;\n\n    _this2._onScroll({\n      scrollLeft: scrollLeft,\n      scrollTop: _this2.state.scrollTop\n    });\n  };\n\n  this._onScrollTop = function (scrollInfo) {\n    var scrollTop = scrollInfo.scrollTop;\n\n    _this2._onScroll({\n      scrollTop: scrollTop,\n      scrollLeft: _this2.state.scrollLeft\n    });\n  };\n\n  this._rowHeightBottomGrid = function (_ref8) {\n    var index = _ref8.index;\n    var _props9 = _this2.props,\n        fixedRowCount = _props9.fixedRowCount,\n        rowCount = _props9.rowCount,\n        rowHeight = _props9.rowHeight;\n    var _state5 = _this2.state,\n        scrollbarSize = _state5.scrollbarSize,\n        showVerticalScrollbar = _state5.showVerticalScrollbar;\n\n    // An extra cell is added to the count\n    // This gives the smaller Grid extra room for offset,\n    // In case the main (bottom right) Grid has a scrollbar\n    // If no scrollbar, the extra space is overflow:hidden anyway\n\n    if (showVerticalScrollbar && index === rowCount - fixedRowCount) {\n      return scrollbarSize;\n    }\n\n    return typeof rowHeight === 'function' ? rowHeight({ index: index + fixedRowCount }) : rowHeight;\n  };\n\n  this._topLeftGridRef = function (ref) {\n    _this2._topLeftGrid = ref;\n  };\n\n  this._topRightGridRef = function (ref) {\n    _this2._topRightGrid = ref;\n  };\n};\n\nMultiGrid.propTypes = process.env.NODE_ENV !== \"production\" ? {\n  classNameBottomLeftGrid: PropTypes.string.isRequired,\n  classNameBottomRightGrid: PropTypes.string.isRequired,\n  classNameTopLeftGrid: PropTypes.string.isRequired,\n  classNameTopRightGrid: PropTypes.string.isRequired,\n  enableFixedColumnScroll: PropTypes.bool.isRequired,\n  enableFixedRowScroll: PropTypes.bool.isRequired,\n  fixedColumnCount: PropTypes.number.isRequired,\n  fixedRowCount: PropTypes.number.isRequired,\n  onScrollbarPresenceChange: PropTypes.func,\n  style: PropTypes.object.isRequired,\n  styleBottomLeftGrid: PropTypes.object.isRequired,\n  styleBottomRightGrid: PropTypes.object.isRequired,\n  styleTopLeftGrid: PropTypes.object.isRequired,\n  styleTopRightGrid: PropTypes.object.isRequired,\n  hideTopRightGridScrollbar: PropTypes.bool,\n  hideBottomLeftGridScrollbar: PropTypes.bool\n} : {};\n\n\npolyfill(MultiGrid);\n\nexport default MultiGrid;","import _Object$getPrototypeOf from 'babel-runtime/core-js/object/get-prototype-of';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport PropTypes from 'prop-types';\nimport * as React from 'react';\n\n/**\n * HOC that simplifies the process of synchronizing scrolling between two or more virtualized components.\n */\n\nvar ScrollSync = function (_React$PureComponent) {\n  _inherits(ScrollSync, _React$PureComponent);\n\n  function ScrollSync(props, context) {\n    _classCallCheck(this, ScrollSync);\n\n    var _this = _possibleConstructorReturn(this, (ScrollSync.__proto__ || _Object$getPrototypeOf(ScrollSync)).call(this, props, context));\n\n    _this.state = {\n      clientHeight: 0,\n      clientWidth: 0,\n      scrollHeight: 0,\n      scrollLeft: 0,\n      scrollTop: 0,\n      scrollWidth: 0\n    };\n\n    _this._onScroll = _this._onScroll.bind(_this);\n    return _this;\n  }\n\n  _createClass(ScrollSync, [{\n    key: 'render',\n    value: function render() {\n      var children = this.props.children;\n      var _state = this.state,\n          clientHeight = _state.clientHeight,\n          clientWidth = _state.clientWidth,\n          scrollHeight = _state.scrollHeight,\n          scrollLeft = _state.scrollLeft,\n          scrollTop = _state.scrollTop,\n          scrollWidth = _state.scrollWidth;\n\n\n      return children({\n        clientHeight: clientHeight,\n        clientWidth: clientWidth,\n        onScroll: this._onScroll,\n        scrollHeight: scrollHeight,\n        scrollLeft: scrollLeft,\n        scrollTop: scrollTop,\n        scrollWidth: scrollWidth\n      });\n    }\n  }, {\n    key: '_onScroll',\n    value: function _onScroll(_ref) {\n      var clientHeight = _ref.clientHeight,\n          clientWidth = _ref.clientWidth,\n          scrollHeight = _ref.scrollHeight,\n          scrollLeft = _ref.scrollLeft,\n          scrollTop = _ref.scrollTop,\n          scrollWidth = _ref.scrollWidth;\n\n      this.setState({\n        clientHeight: clientHeight,\n        clientWidth: clientWidth,\n        scrollHeight: scrollHeight,\n        scrollLeft: scrollLeft,\n        scrollTop: scrollTop,\n        scrollWidth: scrollWidth\n      });\n    }\n  }]);\n\n  return ScrollSync;\n}(React.PureComponent);\n\nexport default ScrollSync;\nScrollSync.propTypes = process.env.NODE_ENV !== \"production\" ? {\n  /**\n   * Function responsible for rendering 2 or more virtualized components.\n   * This function should implement the following signature:\n   * ({ onScroll, scrollLeft, scrollTop }) => PropTypes.element\n   */\n  children: PropTypes.func.isRequired\n} : {};","import ScrollSync from './ScrollSync';\n\nexport default ScrollSync;\nexport { ScrollSync };","var SortDirection = {\n  /**\n   * Sort items in ascending order.\n   * This means arranging from the lowest value to the highest (e.g. a-z, 0-9).\n   */\n  ASC: 'ASC',\n\n  /**\n   * Sort items in descending order.\n   * This means arranging from the highest value to the lowest (e.g. z-a, 9-0).\n   */\n  DESC: 'DESC'\n};\n\nexport default SortDirection;","import _Object$getPrototypeOf from 'babel-runtime/core-js/object/get-prototype-of';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport PropTypes from 'prop-types';\nimport * as React from 'react';\nimport defaultHeaderRenderer from './defaultHeaderRenderer';\nimport defaultCellRenderer from './defaultCellRenderer';\nimport defaultCellDataGetter from './defaultCellDataGetter';\nimport SortDirection from './SortDirection';\n\n/**\n * Describes the header and cell contents of a table column.\n */\n\nvar Column = function (_React$Component) {\n  _inherits(Column, _React$Component);\n\n  function Column() {\n    _classCallCheck(this, Column);\n\n    return _possibleConstructorReturn(this, (Column.__proto__ || _Object$getPrototypeOf(Column)).apply(this, arguments));\n  }\n\n  return Column;\n}(React.Component);\n\nColumn.defaultProps = {\n  cellDataGetter: defaultCellDataGetter,\n  cellRenderer: defaultCellRenderer,\n  defaultSortDirection: SortDirection.ASC,\n  flexGrow: 0,\n  flexShrink: 1,\n  headerRenderer: defaultHeaderRenderer,\n  style: {}\n};\nexport default Column;\nColumn.propTypes = process.env.NODE_ENV !== \"production\" ? {\n  /** Optional aria-label value to set on the column header */\n  'aria-label': PropTypes.string,\n\n  /**\n   * Callback responsible for returning a cell's data, given its :dataKey\n   * ({ columnData: any, dataKey: string, rowData: any }): any\n   */\n  cellDataGetter: PropTypes.func,\n\n  /**\n   * Callback responsible for rendering a cell's contents.\n   * ({ cellData: any, columnData: any, dataKey: string, rowData: any, rowIndex: number }): node\n   */\n  cellRenderer: PropTypes.func,\n\n  /** Optional CSS class to apply to cell */\n  className: PropTypes.string,\n\n  /** Optional additional data passed to this column's :cellDataGetter */\n  columnData: PropTypes.object,\n\n  /** Uniquely identifies the row-data attribute corresponding to this cell */\n  dataKey: PropTypes.any.isRequired,\n\n  /** Optional direction to be used when clicked the first time */\n  defaultSortDirection: PropTypes.oneOf([SortDirection.ASC, SortDirection.DESC]),\n\n  /** If sort is enabled for the table at large, disable it for this column */\n  disableSort: PropTypes.bool,\n\n  /** Flex grow style; defaults to 0 */\n  flexGrow: PropTypes.number,\n\n  /** Flex shrink style; defaults to 1 */\n  flexShrink: PropTypes.number,\n\n  /** Optional CSS class to apply to this column's header */\n  headerClassName: PropTypes.string,\n\n  /**\n   * Optional callback responsible for rendering a column header contents.\n   * ({ columnData: object, dataKey: string, disableSort: boolean, label: node, sortBy: string, sortDirection: string }): PropTypes.node\n   */\n  headerRenderer: PropTypes.func.isRequired,\n\n  /** Optional inline style to apply to this column's header */\n  headerStyle: PropTypes.object,\n\n  /** Optional id to set on the column header */\n  id: PropTypes.string,\n\n  /** Header label for this column */\n  label: PropTypes.node,\n\n  /** Maximum width of column; this property will only be used if :flexGrow is > 0. */\n  maxWidth: PropTypes.number,\n\n  /** Minimum width of column. */\n  minWidth: PropTypes.number,\n\n  /** Optional inline style to apply to cell */\n  style: PropTypes.object,\n\n  /** Flex basis (width) for this column; This value can grow or shrink based on :flexGrow and :flexShrink properties. */\n  width: PropTypes.number.isRequired\n} : {};","import _extends from 'babel-runtime/helpers/extends';\nimport _Object$getPrototypeOf from 'babel-runtime/core-js/object/get-prototype-of';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n\n\nimport cn from 'classnames';\n\nimport Column from './Column';\nimport PropTypes from 'prop-types';\nimport * as React from 'react';\nimport { findDOMNode } from 'react-dom';\nimport Grid, { accessibilityOverscanIndicesGetter } from '../Grid';\n\nimport defaultRowRenderer from './defaultRowRenderer';\nimport defaultHeaderRowRenderer from './defaultHeaderRowRenderer';\nimport SortDirection from './SortDirection';\n\n/**\n * Table component with fixed headers and virtualized rows for improved performance with large data sets.\n * This component expects explicit width, height, and padding parameters.\n */\n\nvar Table = function (_React$PureComponent) {\n  _inherits(Table, _React$PureComponent);\n\n  function Table(props) {\n    _classCallCheck(this, Table);\n\n    var _this = _possibleConstructorReturn(this, (Table.__proto__ || _Object$getPrototypeOf(Table)).call(this, props));\n\n    _this.state = {\n      scrollbarWidth: 0\n    };\n\n    _this._createColumn = _this._createColumn.bind(_this);\n    _this._createRow = _this._createRow.bind(_this);\n    _this._onScroll = _this._onScroll.bind(_this);\n    _this._onSectionRendered = _this._onSectionRendered.bind(_this);\n    _this._setRef = _this._setRef.bind(_this);\n    return _this;\n  }\n\n  _createClass(Table, [{\n    key: 'forceUpdateGrid',\n    value: function forceUpdateGrid() {\n      if (this.Grid) {\n        this.Grid.forceUpdate();\n      }\n    }\n\n    /** See Grid#getOffsetForCell */\n\n  }, {\n    key: 'getOffsetForRow',\n    value: function getOffsetForRow(_ref) {\n      var alignment = _ref.alignment,\n          index = _ref.index;\n\n      if (this.Grid) {\n        var _Grid$getOffsetForCel = this.Grid.getOffsetForCell({\n          alignment: alignment,\n          rowIndex: index\n        }),\n            scrollTop = _Grid$getOffsetForCel.scrollTop;\n\n        return scrollTop;\n      }\n      return 0;\n    }\n\n    /** CellMeasurer compatibility */\n\n  }, {\n    key: 'invalidateCellSizeAfterRender',\n    value: function invalidateCellSizeAfterRender(_ref2) {\n      var columnIndex = _ref2.columnIndex,\n          rowIndex = _ref2.rowIndex;\n\n      if (this.Grid) {\n        this.Grid.invalidateCellSizeAfterRender({\n          rowIndex: rowIndex,\n          columnIndex: columnIndex\n        });\n      }\n    }\n\n    /** See Grid#measureAllCells */\n\n  }, {\n    key: 'measureAllRows',\n    value: function measureAllRows() {\n      if (this.Grid) {\n        this.Grid.measureAllCells();\n      }\n    }\n\n    /** CellMeasurer compatibility */\n\n  }, {\n    key: 'recomputeGridSize',\n    value: function recomputeGridSize() {\n      var _ref3 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          _ref3$columnIndex = _ref3.columnIndex,\n          columnIndex = _ref3$columnIndex === undefined ? 0 : _ref3$columnIndex,\n          _ref3$rowIndex = _ref3.rowIndex,\n          rowIndex = _ref3$rowIndex === undefined ? 0 : _ref3$rowIndex;\n\n      if (this.Grid) {\n        this.Grid.recomputeGridSize({\n          rowIndex: rowIndex,\n          columnIndex: columnIndex\n        });\n      }\n    }\n\n    /** See Grid#recomputeGridSize */\n\n  }, {\n    key: 'recomputeRowHeights',\n    value: function recomputeRowHeights() {\n      var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n      if (this.Grid) {\n        this.Grid.recomputeGridSize({\n          rowIndex: index\n        });\n      }\n    }\n\n    /** See Grid#scrollToPosition */\n\n  }, {\n    key: 'scrollToPosition',\n    value: function scrollToPosition() {\n      var scrollTop = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n      if (this.Grid) {\n        this.Grid.scrollToPosition({ scrollTop: scrollTop });\n      }\n    }\n\n    /** See Grid#scrollToCell */\n\n  }, {\n    key: 'scrollToRow',\n    value: function scrollToRow() {\n      var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n      if (this.Grid) {\n        this.Grid.scrollToCell({\n          columnIndex: 0,\n          rowIndex: index\n        });\n      }\n    }\n  }, {\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this._setScrollbarWidth();\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate() {\n      this._setScrollbarWidth();\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var _props = this.props,\n          children = _props.children,\n          className = _props.className,\n          disableHeader = _props.disableHeader,\n          gridClassName = _props.gridClassName,\n          gridStyle = _props.gridStyle,\n          headerHeight = _props.headerHeight,\n          headerRowRenderer = _props.headerRowRenderer,\n          height = _props.height,\n          id = _props.id,\n          noRowsRenderer = _props.noRowsRenderer,\n          rowClassName = _props.rowClassName,\n          rowStyle = _props.rowStyle,\n          scrollToIndex = _props.scrollToIndex,\n          style = _props.style,\n          width = _props.width;\n      var scrollbarWidth = this.state.scrollbarWidth;\n\n\n      var availableRowsHeight = disableHeader ? height : height - headerHeight;\n\n      var rowClass = typeof rowClassName === 'function' ? rowClassName({ index: -1 }) : rowClassName;\n      var rowStyleObject = typeof rowStyle === 'function' ? rowStyle({ index: -1 }) : rowStyle;\n\n      // Precompute and cache column styles before rendering rows and columns to speed things up\n      this._cachedColumnStyles = [];\n      React.Children.toArray(children).forEach(function (column, index) {\n        var flexStyles = _this2._getFlexStyleForColumn(column, column.props.style);\n\n        _this2._cachedColumnStyles[index] = _extends({}, flexStyles, {\n          overflow: 'hidden'\n        });\n      });\n\n      // Note that we specify :rowCount, :scrollbarWidth, :sortBy, and :sortDirection as properties on Grid even though these have nothing to do with Grid.\n      // This is done because Grid is a pure component and won't update unless its properties or state has changed.\n      // Any property that should trigger a re-render of Grid then is specified here to avoid a stale display.\n      return React.createElement(\n        'div',\n        {\n          className: cn('ReactVirtualized__Table', className),\n          id: id,\n          role: 'grid',\n          style: style },\n        !disableHeader && headerRowRenderer({\n          className: cn('ReactVirtualized__Table__headerRow', rowClass),\n          columns: this._getHeaderColumns(),\n          style: _extends({}, rowStyleObject, {\n            height: headerHeight,\n            overflow: 'hidden',\n            paddingRight: scrollbarWidth,\n            width: width\n          })\n        }),\n        React.createElement(Grid, _extends({}, this.props, {\n          autoContainerWidth: true,\n          className: cn('ReactVirtualized__Table__Grid', gridClassName),\n          cellRenderer: this._createRow,\n          columnWidth: width,\n          columnCount: 1,\n          height: availableRowsHeight,\n          id: undefined,\n          noContentRenderer: noRowsRenderer,\n          onScroll: this._onScroll,\n          onSectionRendered: this._onSectionRendered,\n          ref: this._setRef,\n          role: 'rowgroup',\n          scrollbarWidth: scrollbarWidth,\n          scrollToRow: scrollToIndex,\n          style: _extends({}, gridStyle, {\n            overflowX: 'hidden'\n          })\n        }))\n      );\n    }\n  }, {\n    key: '_createColumn',\n    value: function _createColumn(_ref4) {\n      var column = _ref4.column,\n          columnIndex = _ref4.columnIndex,\n          isScrolling = _ref4.isScrolling,\n          parent = _ref4.parent,\n          rowData = _ref4.rowData,\n          rowIndex = _ref4.rowIndex;\n      var _column$props = column.props,\n          cellDataGetter = _column$props.cellDataGetter,\n          cellRenderer = _column$props.cellRenderer,\n          className = _column$props.className,\n          columnData = _column$props.columnData,\n          dataKey = _column$props.dataKey,\n          id = _column$props.id;\n\n\n      var cellData = cellDataGetter({ columnData: columnData, dataKey: dataKey, rowData: rowData });\n      var renderedCell = cellRenderer({\n        cellData: cellData,\n        columnData: columnData,\n        columnIndex: columnIndex,\n        dataKey: dataKey,\n        isScrolling: isScrolling,\n        parent: parent,\n        rowData: rowData,\n        rowIndex: rowIndex\n      });\n\n      var style = this._cachedColumnStyles[columnIndex];\n\n      var title = typeof renderedCell === 'string' ? renderedCell : null;\n\n      // Avoid using object-spread syntax with multiple objects here,\n      // Since it results in an extra method call to 'babel-runtime/helpers/extends'\n      // See PR https://github.com/bvaughn/react-virtualized/pull/942\n      return React.createElement(\n        'div',\n        {\n          'aria-describedby': id,\n          className: cn('ReactVirtualized__Table__rowColumn', className),\n          key: 'Row' + rowIndex + '-' + 'Col' + columnIndex,\n          role: 'gridcell',\n          style: style,\n          title: title },\n        renderedCell\n      );\n    }\n  }, {\n    key: '_createHeader',\n    value: function _createHeader(_ref5) {\n      var column = _ref5.column,\n          index = _ref5.index;\n      var _props2 = this.props,\n          headerClassName = _props2.headerClassName,\n          headerStyle = _props2.headerStyle,\n          onHeaderClick = _props2.onHeaderClick,\n          sort = _props2.sort,\n          sortBy = _props2.sortBy,\n          sortDirection = _props2.sortDirection;\n      var _column$props2 = column.props,\n          columnData = _column$props2.columnData,\n          dataKey = _column$props2.dataKey,\n          defaultSortDirection = _column$props2.defaultSortDirection,\n          disableSort = _column$props2.disableSort,\n          headerRenderer = _column$props2.headerRenderer,\n          id = _column$props2.id,\n          label = _column$props2.label;\n\n      var sortEnabled = !disableSort && sort;\n\n      var classNames = cn('ReactVirtualized__Table__headerColumn', headerClassName, column.props.headerClassName, {\n        ReactVirtualized__Table__sortableHeaderColumn: sortEnabled\n      });\n      var style = this._getFlexStyleForColumn(column, _extends({}, headerStyle, column.props.headerStyle));\n\n      var renderedHeader = headerRenderer({\n        columnData: columnData,\n        dataKey: dataKey,\n        disableSort: disableSort,\n        label: label,\n        sortBy: sortBy,\n        sortDirection: sortDirection\n      });\n\n      var headerOnClick = void 0,\n          headerOnKeyDown = void 0,\n          headerTabIndex = void 0,\n          headerAriaSort = void 0,\n          headerAriaLabel = void 0;\n\n      if (sortEnabled || onHeaderClick) {\n        // If this is a sortable header, clicking it should update the table data's sorting.\n        var isFirstTimeSort = sortBy !== dataKey;\n\n        // If this is the firstTime sort of this column, use the column default sort order.\n        // Otherwise, invert the direction of the sort.\n        var newSortDirection = isFirstTimeSort ? defaultSortDirection : sortDirection === SortDirection.DESC ? SortDirection.ASC : SortDirection.DESC;\n\n        var onClick = function onClick(event) {\n          sortEnabled && sort({\n            defaultSortDirection: defaultSortDirection,\n            event: event,\n            sortBy: dataKey,\n            sortDirection: newSortDirection\n          });\n          onHeaderClick && onHeaderClick({ columnData: columnData, dataKey: dataKey, event: event });\n        };\n\n        var onKeyDown = function onKeyDown(event) {\n          if (event.key === 'Enter' || event.key === ' ') {\n            onClick(event);\n          }\n        };\n\n        headerAriaLabel = column.props['aria-label'] || label || dataKey;\n        headerTabIndex = 0;\n        headerOnClick = onClick;\n        headerOnKeyDown = onKeyDown;\n      }\n\n      if (sortBy === dataKey) {\n        headerAriaSort = sortDirection === SortDirection.ASC ? 'ascending' : 'descending';\n      }\n\n      // Avoid using object-spread syntax with multiple objects here,\n      // Since it results in an extra method call to 'babel-runtime/helpers/extends'\n      // See PR https://github.com/bvaughn/react-virtualized/pull/942\n      return React.createElement(\n        'div',\n        {\n          'aria-label': headerAriaLabel,\n          'aria-sort': headerAriaSort,\n          className: classNames,\n          id: id,\n          key: 'Header-Col' + index,\n          onClick: headerOnClick,\n          onKeyDown: headerOnKeyDown,\n          role: 'columnheader',\n          style: style,\n          tabIndex: headerTabIndex },\n        renderedHeader\n      );\n    }\n  }, {\n    key: '_createRow',\n    value: function _createRow(_ref6) {\n      var _this3 = this;\n\n      var index = _ref6.rowIndex,\n          isScrolling = _ref6.isScrolling,\n          key = _ref6.key,\n          parent = _ref6.parent,\n          style = _ref6.style;\n      var _props3 = this.props,\n          children = _props3.children,\n          onRowClick = _props3.onRowClick,\n          onRowDoubleClick = _props3.onRowDoubleClick,\n          onRowRightClick = _props3.onRowRightClick,\n          onRowMouseOver = _props3.onRowMouseOver,\n          onRowMouseOut = _props3.onRowMouseOut,\n          rowClassName = _props3.rowClassName,\n          rowGetter = _props3.rowGetter,\n          rowRenderer = _props3.rowRenderer,\n          rowStyle = _props3.rowStyle;\n      var scrollbarWidth = this.state.scrollbarWidth;\n\n\n      var rowClass = typeof rowClassName === 'function' ? rowClassName({ index: index }) : rowClassName;\n      var rowStyleObject = typeof rowStyle === 'function' ? rowStyle({ index: index }) : rowStyle;\n      var rowData = rowGetter({ index: index });\n\n      var columns = React.Children.toArray(children).map(function (column, columnIndex) {\n        return _this3._createColumn({\n          column: column,\n          columnIndex: columnIndex,\n          isScrolling: isScrolling,\n          parent: parent,\n          rowData: rowData,\n          rowIndex: index,\n          scrollbarWidth: scrollbarWidth\n        });\n      });\n\n      var className = cn('ReactVirtualized__Table__row', rowClass);\n      var flattenedStyle = _extends({}, style, rowStyleObject, {\n        height: this._getRowHeight(index),\n        overflow: 'hidden',\n        paddingRight: scrollbarWidth\n      });\n\n      return rowRenderer({\n        className: className,\n        columns: columns,\n        index: index,\n        isScrolling: isScrolling,\n        key: key,\n        onRowClick: onRowClick,\n        onRowDoubleClick: onRowDoubleClick,\n        onRowRightClick: onRowRightClick,\n        onRowMouseOver: onRowMouseOver,\n        onRowMouseOut: onRowMouseOut,\n        rowData: rowData,\n        style: flattenedStyle\n      });\n    }\n\n    /**\n     * Determines the flex-shrink, flex-grow, and width values for a cell (header or column).\n     */\n\n  }, {\n    key: '_getFlexStyleForColumn',\n    value: function _getFlexStyleForColumn(column) {\n      var customStyle = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      var flexValue = column.props.flexGrow + ' ' + column.props.flexShrink + ' ' + column.props.width + 'px';\n\n      var style = _extends({}, customStyle, {\n        flex: flexValue,\n        msFlex: flexValue,\n        WebkitFlex: flexValue\n      });\n\n      if (column.props.maxWidth) {\n        style.maxWidth = column.props.maxWidth;\n      }\n\n      if (column.props.minWidth) {\n        style.minWidth = column.props.minWidth;\n      }\n\n      return style;\n    }\n  }, {\n    key: '_getHeaderColumns',\n    value: function _getHeaderColumns() {\n      var _this4 = this;\n\n      var _props4 = this.props,\n          children = _props4.children,\n          disableHeader = _props4.disableHeader;\n\n      var items = disableHeader ? [] : React.Children.toArray(children);\n\n      return items.map(function (column, index) {\n        return _this4._createHeader({ column: column, index: index });\n      });\n    }\n  }, {\n    key: '_getRowHeight',\n    value: function _getRowHeight(rowIndex) {\n      var rowHeight = this.props.rowHeight;\n\n\n      return typeof rowHeight === 'function' ? rowHeight({ index: rowIndex }) : rowHeight;\n    }\n  }, {\n    key: '_onScroll',\n    value: function _onScroll(_ref7) {\n      var clientHeight = _ref7.clientHeight,\n          scrollHeight = _ref7.scrollHeight,\n          scrollTop = _ref7.scrollTop;\n      var onScroll = this.props.onScroll;\n\n\n      onScroll({ clientHeight: clientHeight, scrollHeight: scrollHeight, scrollTop: scrollTop });\n    }\n  }, {\n    key: '_onSectionRendered',\n    value: function _onSectionRendered(_ref8) {\n      var rowOverscanStartIndex = _ref8.rowOverscanStartIndex,\n          rowOverscanStopIndex = _ref8.rowOverscanStopIndex,\n          rowStartIndex = _ref8.rowStartIndex,\n          rowStopIndex = _ref8.rowStopIndex;\n      var onRowsRendered = this.props.onRowsRendered;\n\n\n      onRowsRendered({\n        overscanStartIndex: rowOverscanStartIndex,\n        overscanStopIndex: rowOverscanStopIndex,\n        startIndex: rowStartIndex,\n        stopIndex: rowStopIndex\n      });\n    }\n  }, {\n    key: '_setRef',\n    value: function _setRef(ref) {\n      this.Grid = ref;\n    }\n  }, {\n    key: '_setScrollbarWidth',\n    value: function _setScrollbarWidth() {\n      if (this.Grid) {\n        var _Grid = findDOMNode(this.Grid);\n        var clientWidth = _Grid.clientWidth || 0;\n        var offsetWidth = _Grid.offsetWidth || 0;\n        var scrollbarWidth = offsetWidth - clientWidth;\n\n        this.setState({ scrollbarWidth: scrollbarWidth });\n      }\n    }\n  }]);\n\n  return Table;\n}(React.PureComponent);\n\nTable.defaultProps = {\n  disableHeader: false,\n  estimatedRowSize: 30,\n  headerHeight: 0,\n  headerStyle: {},\n  noRowsRenderer: function noRowsRenderer() {\n    return null;\n  },\n  onRowsRendered: function onRowsRendered() {\n    return null;\n  },\n  onScroll: function onScroll() {\n    return null;\n  },\n  overscanIndicesGetter: accessibilityOverscanIndicesGetter,\n  overscanRowCount: 10,\n  rowRenderer: defaultRowRenderer,\n  headerRowRenderer: defaultHeaderRowRenderer,\n  rowStyle: {},\n  scrollToAlignment: 'auto',\n  scrollToIndex: -1,\n  style: {}\n};\nexport default Table;\nTable.propTypes = process.env.NODE_ENV !== \"production\" ? {\n  'aria-label': PropTypes.string,\n\n  /**\n   * Removes fixed height from the scrollingContainer so that the total height\n   * of rows can stretch the window. Intended for use with WindowScroller\n   */\n  autoHeight: PropTypes.bool,\n\n  /** One or more Columns describing the data displayed in this row */\n  children: function children(props) {\n    var children = React.Children.toArray(props.children);\n    for (var i = 0; i < children.length; i++) {\n      var childType = children[i].type;\n      if (childType !== Column && !(childType.prototype instanceof Column)) {\n        return new Error('Table only accepts children of type Column');\n      }\n    }\n  },\n\n  /** Optional CSS class name */\n  className: PropTypes.string,\n\n  /** Disable rendering the header at all */\n  disableHeader: PropTypes.bool,\n\n  /**\n   * Used to estimate the total height of a Table before all of its rows have actually been measured.\n   * The estimated total height is adjusted as rows are rendered.\n   */\n  estimatedRowSize: PropTypes.number.isRequired,\n\n  /** Optional custom CSS class name to attach to inner Grid element. */\n  gridClassName: PropTypes.string,\n\n  /** Optional inline style to attach to inner Grid element. */\n  gridStyle: PropTypes.object,\n\n  /** Optional CSS class to apply to all column headers */\n  headerClassName: PropTypes.string,\n\n  /** Fixed height of header row */\n  headerHeight: PropTypes.number.isRequired,\n\n  /**\n   * Responsible for rendering a table row given an array of columns:\n   * Should implement the following interface: ({\n   *   className: string,\n   *   columns: any[],\n   *   style: any\n   * }): PropTypes.node\n   */\n  headerRowRenderer: PropTypes.func,\n\n  /** Optional custom inline style to attach to table header columns. */\n  headerStyle: PropTypes.object,\n\n  /** Fixed/available height for out DOM element */\n  height: PropTypes.number.isRequired,\n\n  /** Optional id */\n  id: PropTypes.string,\n\n  /** Optional renderer to be used in place of table body rows when rowCount is 0 */\n  noRowsRenderer: PropTypes.func,\n\n  /**\n   * Optional callback when a column's header is clicked.\n   * ({ columnData: any, dataKey: string }): void\n   */\n  onHeaderClick: PropTypes.func,\n\n  /**\n   * Callback invoked when a user clicks on a table row.\n   * ({ index: number }): void\n   */\n  onRowClick: PropTypes.func,\n\n  /**\n   * Callback invoked when a user double-clicks on a table row.\n   * ({ index: number }): void\n   */\n  onRowDoubleClick: PropTypes.func,\n\n  /**\n   * Callback invoked when the mouse leaves a table row.\n   * ({ index: number }): void\n   */\n  onRowMouseOut: PropTypes.func,\n\n  /**\n   * Callback invoked when a user moves the mouse over a table row.\n   * ({ index: number }): void\n   */\n  onRowMouseOver: PropTypes.func,\n\n  /**\n   * Callback invoked when a user right-clicks on a table row.\n   * ({ index: number }): void\n   */\n  onRowRightClick: PropTypes.func,\n\n  /**\n   * Callback invoked with information about the slice of rows that were just rendered.\n   * ({ startIndex, stopIndex }): void\n   */\n  onRowsRendered: PropTypes.func,\n\n  /**\n   * Callback invoked whenever the scroll offset changes within the inner scrollable region.\n   * This callback can be used to sync scrolling between lists, tables, or grids.\n   * ({ clientHeight, scrollHeight, scrollTop }): void\n   */\n  onScroll: PropTypes.func.isRequired,\n\n  /** See Grid#overscanIndicesGetter */\n  overscanIndicesGetter: PropTypes.func.isRequired,\n\n  /**\n   * Number of rows to render above/below the visible bounds of the list.\n   * These rows can help for smoother scrolling on touch devices.\n   */\n  overscanRowCount: PropTypes.number.isRequired,\n\n  /**\n   * Optional CSS class to apply to all table rows (including the header row).\n   * This property can be a CSS class name (string) or a function that returns a class name.\n   * If a function is provided its signature should be: ({ index: number }): string\n   */\n  rowClassName: PropTypes.oneOfType([PropTypes.string, PropTypes.func]),\n\n  /**\n   * Callback responsible for returning a data row given an index.\n   * ({ index: number }): any\n   */\n  rowGetter: PropTypes.func.isRequired,\n\n  /**\n   * Either a fixed row height (number) or a function that returns the height of a row given its index.\n   * ({ index: number }): number\n   */\n  rowHeight: PropTypes.oneOfType([PropTypes.number, PropTypes.func]).isRequired,\n\n  /** Number of rows in table. */\n  rowCount: PropTypes.number.isRequired,\n\n  /**\n   * Responsible for rendering a table row given an array of columns:\n   * Should implement the following interface: ({\n   *   className: string,\n   *   columns: Array,\n   *   index: number,\n   *   isScrolling: boolean,\n   *   onRowClick: ?Function,\n   *   onRowDoubleClick: ?Function,\n   *   onRowMouseOver: ?Function,\n   *   onRowMouseOut: ?Function,\n   *   rowData: any,\n   *   style: any\n   * }): PropTypes.node\n   */\n  rowRenderer: PropTypes.func,\n\n  /** Optional custom inline style to attach to table rows. */\n  rowStyle: PropTypes.oneOfType([PropTypes.object, PropTypes.func]).isRequired,\n\n  /** See Grid#scrollToAlignment */\n  scrollToAlignment: PropTypes.oneOf(['auto', 'end', 'start', 'center']).isRequired,\n\n  /** Row index to ensure visible (by forcefully scrolling if necessary) */\n  scrollToIndex: PropTypes.number.isRequired,\n\n  /** Vertical offset. */\n  scrollTop: PropTypes.number,\n\n  /**\n   * Sort function to be called if a sortable header is clicked.\n   * Should implement the following interface: ({\n   *   defaultSortDirection: 'ASC' | 'DESC',\n   *   event: MouseEvent,\n   *   sortBy: string,\n   *   sortDirection: SortDirection\n   * }): void\n   */\n  sort: PropTypes.func,\n\n  /** Table data is currently sorted by this :dataKey (if it is sorted at all) */\n  sortBy: PropTypes.string,\n\n  /** Table data is currently sorted in this direction (if it is sorted at all) */\n  sortDirection: PropTypes.oneOf([SortDirection.ASC, SortDirection.DESC]),\n\n  /** Optional inline style */\n  style: PropTypes.object,\n\n  /** Tab index for focus */\n  tabIndex: PropTypes.number,\n\n  /** Width of list */\n  width: PropTypes.number.isRequired\n} : {};\nimport { bpfrpt_proptype_CellPosition } from '../Grid';","import createMultiSort from './createMultiSort';\nimport defaultCellDataGetter from './defaultCellDataGetter';\nimport defaultCellRenderer from './defaultCellRenderer';\nimport defaultHeaderRowRenderer from './defaultHeaderRowRenderer.js';\nimport defaultHeaderRenderer from './defaultHeaderRenderer';\nimport defaultRowRenderer from './defaultRowRenderer';\nimport Column from './Column';\nimport SortDirection from './SortDirection';\nimport SortIndicator from './SortIndicator';\nimport Table from './Table';\n\nexport default Table;\nexport { createMultiSort, defaultCellDataGetter, defaultCellRenderer, defaultHeaderRowRenderer, defaultHeaderRenderer, defaultRowRenderer, Column, SortDirection, SortIndicator, Table };","import WindowScroller, { IS_SCROLLING_TIMEOUT } from './WindowScroller';\n\nexport default WindowScroller;\nexport { WindowScroller, IS_SCROLLING_TIMEOUT };","export { ArrowKeyStepper } from './ArrowKeyStepper';\nexport { AutoSizer } from './AutoSizer';\nexport { CellMeasurer, CellMeasurerCache } from './CellMeasurer';\nexport { Collection } from './Collection';\nexport { ColumnSizer } from './ColumnSizer';\nexport { accessibilityOverscanIndicesGetter, defaultCellRangeRenderer, defaultOverscanIndicesGetter, Grid } from './Grid';\nexport { InfiniteLoader } from './InfiniteLoader';\nexport { List } from './List';\nexport { createCellPositioner as createMasonryCellPositioner, Masonry } from './Masonry';\nexport { MultiGrid } from './MultiGrid';\nexport { ScrollSync } from './ScrollSync';\nexport { createMultiSort as createTableMultiSort, defaultCellDataGetter as defaultTableCellDataGetter, defaultCellRenderer as defaultTableCellRenderer, defaultHeaderRenderer as defaultTableHeaderRenderer, defaultHeaderRowRenderer as defaultTableHeaderRowRenderer, defaultRowRenderer as defaultTableRowRenderer, Table, Column, SortDirection, SortIndicator } from './Table';\nexport { WindowScroller } from './WindowScroller';","// extracted by mini-css-extract-plugin","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(factory());\n}(this, (function () { 'use strict';\n\n/**\n * Module export\n *\n * @param {Element} el\n * @return {ClassList}\n */\n\nvar index = function (el) {\n  return new ClassList(el);\n};\n\n/**\n * Initialize a new ClassList for the given element\n *\n * @param {Element} el DOM Element\n */\nfunction ClassList(el) {\n  if (!el || el.nodeType !== 1) {\n    throw new Error('A DOM Element reference is required');\n  }\n\n  this.el = el;\n  this.classList = el.classList;\n}\n\n/**\n * Check token validity\n *\n * @param token\n * @param [method]\n */\nfunction checkToken(token, method) {\n  method = method || 'a method';\n\n  if (typeof token != 'string') {\n    throw new TypeError(\n      'Failed to execute \\'' + method + '\\' on \\'ClassList\\': ' +\n      'the token provided (\\'' + token + '\\') is not a string.'\n    );\n  }\n  if (token === \"\") {\n    throw new SyntaxError(\n      'Failed to execute \\'' + method + '\\' on \\'ClassList\\': ' +\n      'the token provided must not be empty.'\n    );\n  }\n  if (/\\s/.test(token)) {\n    throw new Error(\n      'Failed to execute \\'' + method + '\\' on \\'ClassList\\': ' +\n      'the token provided (\\'' + token + '\\') contains HTML space ' +\n      'characters, which are not valid in tokens.'\n    );\n  }\n}\n\n/**\n * Return an array of the class names on the element.\n *\n * @return {Array}\n */\nClassList.prototype.toArray = function () {\n  var str = (this.el.getAttribute('class') || '').replace(/^\\s+|\\s+$/g, '');\n  var classes = str.split(/\\s+/);\n  if ('' === classes[0]) { classes.shift(); }\n  return classes;\n};\n\n/**\n * Add the given `token` to the class list if it's not already present.\n *\n * @param {String} token\n */\nClassList.prototype.add = function (token) {\n  var classes, index, updated;\n  checkToken(token, 'add');\n\n  if (this.classList) {\n    this.classList.add(token);\n  }\n  else {\n    // fallback\n    classes = this.toArray();\n    index = classes.indexOf(token);\n    if (index === -1) {\n      classes.push(token);\n      this.el.setAttribute('class', classes.join(' '));\n    }\n  }\n\n  return;\n};\n\n/**\n * Check if the given `token` is in the class list.\n *\n * @param {String} token\n * @return {Boolean}\n */\nClassList.prototype.contains = function (token) {\n  checkToken(token, 'contains');\n\n  return this.classList ?\n    this.classList.contains(token) :\n    this.toArray().indexOf(token) > -1;\n};\n\n/**\n * Remove any class names that match the given `token`, when present.\n *\n * @param {String|RegExp} token\n */\nClassList.prototype.remove = function (token) {\n  var arr, classes, i, index, len;\n\n  if ('[object RegExp]' == Object.prototype.toString.call(token)) {\n    arr = this.toArray();\n    for (i = 0, len = arr.length; i < len; i++) {\n      if (token.test(arr[i])) {\n        this.remove(arr[i]);\n      }\n    }\n  }\n  else {\n    checkToken(token, 'remove');\n\n    if (this.classList) {\n      this.classList.remove(token);\n    }\n    else {\n      // fallback\n      classes = this.toArray();\n      index = classes.indexOf(token);\n      if (index > -1) {\n        classes.splice(index, 1);\n        this.el.setAttribute('class', classes.join(' '));\n      }\n    }\n  }\n\n  return;\n};\n\n/**\n * Toggle the `token` in the class list. Optionally force state via `force`.\n *\n * Native `classList` is not used as some browsers that support `classList` do\n * not support `force`. Avoiding `classList` altogether keeps this function\n * simple.\n *\n * @param {String} token\n * @param {Boolean} [force]\n * @return {Boolean}\n */\nClassList.prototype.toggle = function (token, force) {\n  checkToken(token, 'toggle');\n\n  var hasToken = this.contains(token);\n  var method = hasToken ? (force !== true && 'remove') : (force !== false && 'add');\n\n  if (method) {\n    this[method](token);\n  }\n\n  return (typeof force == 'boolean' ? force : !hasToken);\n};\n\n/**\n * Determine if a DOM element matches a CSS selector\n *\n * @param {Element} elem\n * @param {String} selector\n * @return {Boolean}\n * @api public\n */\n\nfunction matches(elem, selector) {\n  // Vendor-specific implementations of `Element.prototype.matches()`.\n  var proto = window.Element.prototype;\n  var nativeMatches = proto.matches ||\n      proto.mozMatchesSelector ||\n      proto.msMatchesSelector ||\n      proto.oMatchesSelector ||\n      proto.webkitMatchesSelector;\n\n  if (!elem || elem.nodeType !== 1) {\n    return false;\n  }\n\n  var parentElem = elem.parentNode;\n\n  // use native 'matches'\n  if (nativeMatches) {\n    return nativeMatches.call(elem, selector);\n  }\n\n  // native support for `matches` is missing and a fallback is required\n  var nodes = parentElem.querySelectorAll(selector);\n  var len = nodes.length;\n\n  for (var i = 0; i < len; i++) {\n    if (nodes[i] === elem) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n/**\n * Expose `matches`\n */\n\nvar index$1 = matches;\n\n/* https://github.com/WICG/focus-ring */\ndocument.addEventListener('DOMContentLoaded', function() {\n  var hadKeyboardEvent = false;\n  var keyboardThrottleTimeoutID = 0;\n\n  // These elements should always have a focus ring drawn, because they are\n  // associated with switching to a keyboard modality.\n  var keyboardModalityWhitelist = [\n    'input:not([type])',\n    'input[type=text]',\n    'input[type=search]',\n    'input[type=url]',\n    'input[type=tel]',\n    'input[type=email]',\n    'input[type=password]',\n    'input[type=number]',\n    'input[type=date]',\n    'input[type=month]',\n    'input[type=week]',\n    'input[type=time]',\n    'input[type=datetime]',\n    'input[type=datetime-local]',\n    'textarea',\n    '[role=textbox]',\n  ].join(',');\n\n  /**\n   * Computes whether the given element should automatically trigger the\n   * `focus-ring` class being added, i.e. whether it should always match\n   * `:focus-ring` when focused.\n   * @param {Element} el\n   * @return {boolean}\n   */\n  function focusTriggersKeyboardModality(el) {\n    return index$1(el, keyboardModalityWhitelist) && index$1(el, ':not([readonly])');\n  }\n\n  /**\n   * Add the `focus-ring` class to the given element if it was not added by\n   * the author.\n   * @param {Element} el\n   */\n  function addFocusRingClass(el) {\n    if (index(el).contains('focus-ring'))\n      return;\n    index(el).add('focus-ring');\n    el.setAttribute('data-focus-ring-added', '');\n  }\n\n  /**\n   * Remove the `focus-ring` class from the given element if it was not\n   * originally added by the author.\n   * @param {Element} el\n   */\n  function removeFocusRingClass(el) {\n    if (!el.hasAttribute('data-focus-ring-added'))\n      return;\n    index(el).remove('focus-ring');\n    el.removeAttribute('data-focus-ring-added');\n  }\n\n  /**\n   * On `keydown`, set `hadKeyboardEvent`, to be removed 100ms later if there\n   * are no further keyboard events.  The 100ms throttle handles cases where\n   * focus is redirected programmatically after a keyboard event, such as\n   * opening a menu or dialog.\n   */\n  function onKeyDown() {\n    hadKeyboardEvent = true;\n    // `activeElement` defaults to document.body if nothing focused,\n    // so check the active element is actually focused.\n    if (index$1(document.activeElement, ':focus'))\n      addFocusRingClass(document.activeElement);\n    if (keyboardThrottleTimeoutID !== 0)\n      clearTimeout(keyboardThrottleTimeoutID);\n    keyboardThrottleTimeoutID = setTimeout(function() {\n      hadKeyboardEvent = false;\n      keyboardThrottleTimeoutID = 0;\n    }, 100);\n  }\n\n  /**\n   * On `focus`, add the `focus-ring` class to the target if:\n   * - a keyboard event happened in the past 100ms, or\n   * - the focus event target triggers \"keyboard modality\" and should always\n   *   have a focus ring drawn.\n   * @param {Event} e\n   */\n  function onFocus(e) {\n    if (hadKeyboardEvent || focusTriggersKeyboardModality(e.target))\n      addFocusRingClass(e.target);\n  }\n\n  /**\n   * On `blur`, remove the `focus-ring` class from the target.\n   * @param {Event} e\n   */\n  function onBlur(e) {\n    removeFocusRingClass(e.target);\n  }\n\n  document.body.addEventListener('keydown', onKeyDown, true);\n  document.body.addEventListener('focus', onFocus, true);\n  document.body.addEventListener('blur', onBlur, true);\n});\n\n})));\n","import { Branch } from '../../models/branch'\nimport { Commit } from '../../models/commit'\nimport { PullRequest } from '../../models/pull-request'\nimport { Repository } from '../../models/repository'\nimport {\n  CommittedFileChange,\n  WorkingDirectoryFileChange,\n  WorkingDirectoryStatus,\n} from '../../models/status'\nimport { TipState } from '../../models/tip'\nimport {\n  ComparisonView,\n  IBranchesState,\n  IChangesState,\n  ICompareState,\n  IRepositoryState,\n  RepositorySectionTab,\n} from '../app-state'\nimport { ComparisonCache } from '../comparison-cache'\nimport { IGitHubUser } from '../databases'\nimport { merge } from '../merge'\n\nexport class RepositoryStateCache {\n  private readonly repositoryState = new Map<string, IRepositoryState>()\n\n  public constructor(\n    private readonly getUsersForRepository: (\n      repository: Repository\n    ) => Map<string, IGitHubUser>\n  ) {}\n\n  /** Get the state for the repository. */\n  public get(repository: Repository): IRepositoryState {\n    const existing = this.repositoryState.get(repository.hash)\n    if (existing != null) {\n      const gitHubUsers = this.getUsersForRepository(repository)\n      return merge(existing, { gitHubUsers })\n    }\n\n    const newItem = getInitialRepositoryState()\n    this.repositoryState.set(repository.hash, newItem)\n    return newItem\n  }\n\n  public update<K extends keyof IRepositoryState>(\n    repository: Repository,\n    fn: (state: IRepositoryState) => Pick<IRepositoryState, K>\n  ) {\n    const currentState = this.get(repository)\n    const newValues = fn(currentState)\n    this.repositoryState.set(repository.hash, merge(currentState, newValues))\n  }\n\n  public updateCompareState<K extends keyof ICompareState>(\n    repository: Repository,\n    fn: (state: ICompareState) => Pick<ICompareState, K>\n  ) {\n    this.update(repository, state => {\n      const compareState = state.compareState\n      const newValues = fn(compareState)\n\n      return { compareState: merge(compareState, newValues) }\n    })\n  }\n\n  public updateChangesState<K extends keyof IChangesState>(\n    repository: Repository,\n    fn: (changesState: IChangesState) => Pick<IChangesState, K>\n  ) {\n    this.update(repository, state => {\n      const changesState = state.changesState\n      const newState = merge(changesState, fn(changesState))\n      return { changesState: newState }\n    })\n  }\n\n  public updateBranchesState<K extends keyof IBranchesState>(\n    repository: Repository,\n    fn: (branchesState: IBranchesState) => Pick<IBranchesState, K>\n  ) {\n    this.update(repository, state => {\n      const changesState = state.branchesState\n      const newState = merge(changesState, fn(changesState))\n      return { branchesState: newState }\n    })\n  }\n}\n\nfunction getInitialRepositoryState(): IRepositoryState {\n  return {\n    commitSelection: {\n      sha: null,\n      file: null,\n      changedFiles: new Array<CommittedFileChange>(),\n      diff: null,\n    },\n    changesState: {\n      workingDirectory: WorkingDirectoryStatus.fromFiles(\n        new Array<WorkingDirectoryFileChange>()\n      ),\n      selectedFileIDs: [],\n      diff: null,\n      contextualCommitMessage: null,\n      commitMessage: null,\n      coAuthors: [],\n      showCoAuthoredBy: false,\n      conflictState: null,\n    },\n    selectedSection: RepositorySectionTab.Changes,\n    branchesState: {\n      tip: { kind: TipState.Unknown },\n      defaultBranch: null,\n      allBranches: new Array<Branch>(),\n      recentBranches: new Array<Branch>(),\n      openPullRequests: new Array<PullRequest>(),\n      currentPullRequest: null,\n      isLoadingPullRequests: false,\n    },\n    compareState: {\n      isDivergingBranchBannerVisible: false,\n      formState: { kind: ComparisonView.None },\n      tip: null,\n      mergeStatus: null,\n      showBranchList: false,\n      filterText: '',\n      commitSHAs: [],\n      aheadBehindCache: new ComparisonCache(),\n      allBranches: new Array<Branch>(),\n      recentBranches: new Array<Branch>(),\n      defaultBranch: null,\n      inferredComparisonBranch: { branch: null, aheadBehind: null },\n    },\n    commitAuthor: null,\n    gitHubUsers: new Map<string, IGitHubUser>(),\n    commitLookup: new Map<string, Commit>(),\n    localCommitSHAs: [],\n    aheadBehind: null,\n    remote: null,\n    isPushPullFetchInProgress: false,\n    isCommitting: false,\n    lastFetched: null,\n    checkoutProgress: null,\n    pushPullFetchProgress: null,\n    revertProgress: null,\n  }\n}\n","import { Emitter, Disposable } from 'event-kit'\nimport { ipcRenderer } from 'electron'\n\n/**\n * Describes the interface of a UI activity monitor.\n *\n * We define a UI activity monitor as an object which can\n * be used to be notified whenever the user interacts with the\n * application.\n */\nexport interface IUiActivityMonitor {\n  /**\n   * Subscribe to get notified when the user interacts\n   * with the application. The first, and only argument\n   * to the event handler will be a value indicating the\n   * kind of action detected (mouse/pointer, keyboard etc).\n   *\n   * @return A disposable object which, when disposed will\n   *         terminate the subscription and prevent any\n   *         further calls to the handler.\n   */\n  onActivity(handler: (kind: UiActivityKind) => void): Disposable\n}\n\n/**\n * A value indicating a user activity type (mouse/pointer, keyboard etc).\n */\nexport type UiActivityKind = 'pointer' | 'keyboard' | 'menu'\n\n/**\n * UI Activity monitor for user interactions within GitHub Desktop.\n */\nexport class UiActivityMonitor implements IUiActivityMonitor {\n  private readonly emitter = new Emitter()\n  private subscriberCount = 0\n\n  /**\n   * Subscribe to get notified when the user interacts\n   * with the application. The first, and only argument\n   * to the event handler will be a value indicating the\n   * kind of action detected (mouse/pointer, keyboard etc).\n   *\n   * @return A disposable object which, when disposed will\n   *         terminate the subscription and prevent any\n   *         further calls to the handler.\n   */\n  public onActivity(handler: (kind: UiActivityKind) => void): Disposable {\n    const emitterDisposable = this.emitter.on('activity', handler)\n\n    if (this.subscriberCount === 0) {\n      this.startTracking()\n    }\n\n    this.subscriberCount++\n\n    return new Disposable(() => {\n      this.subscriberCount--\n\n      if (this.subscriberCount === 0) {\n        this.stopTracking()\n      }\n\n      emitterDisposable.dispose()\n    })\n  }\n\n  private emit(kind: UiActivityKind) {\n    this.emitter.emit('activity', kind)\n  }\n\n  private startTracking() {\n    document.addEventListener('mousedown', this.onMouseDown)\n    document.addEventListener('keydown', this.onKeyDown)\n\n    ipcRenderer.on('menu-event', this.onMenuEvent)\n  }\n\n  private stopTracking() {\n    document.removeEventListener('mousedown', this.onMouseDown)\n    document.removeEventListener('keydown', this.onKeyDown)\n\n    ipcRenderer.removeListener('menu-event', this.onMenuEvent)\n  }\n\n  private onMouseDown = (e: MouseEvent) => {\n    if (e.target === null || !(e.target instanceof HTMLElement)) {\n      return\n    }\n\n    if (!isInteractionTarget(e.target)) {\n      return\n    }\n\n    this.emit('pointer')\n  }\n\n  private onKeyDown = (e: KeyboardEvent) => {\n    this.emit('keyboard')\n  }\n\n  private onMenuEvent = (event: Electron.IpcMessageEvent) => {\n    this.emit('menu')\n  }\n}\n\nconst interactionTargets = new Set(\n  ['button', 'a', 'input', 'textarea', 'label'].map(x => x.toUpperCase())\n)\nconst interactionRoles = new Set([\n  'button',\n  'option',\n  'menuitem',\n  'tab',\n  'radio',\n])\n\n/**\n * Determine if the target of a pointer event is contained within,\n * or is itself, an \"interaction target\".\n *\n * We define an interaction target to be things like buttons, text\n * inputs, links, etc. We don't consider divs, spans, etc to be\n * interaction targets at the moment although they arguable would fit\n * the description when a user selects text within a span.\n */\nfunction isInteractionTarget(target: HTMLElement | null) {\n  while (target !== null) {\n    if (interactionTargets.has(target.nodeName)) {\n      return true\n    }\n\n    const role = target.getAttribute('role')\n\n    if (role !== null && interactionRoles.has(role)) {\n      return true\n    }\n\n    target = target instanceof HTMLElement ? target.parentElement : null\n  }\n\n  return false\n}\n","/** Install some globally available values for dev mode. */\nexport function installDevGlobals() {\n  const g: any = global\n  // Expose GitPerf as a global so it can be started.\n  g.GitPerf = require('./lib/git-perf')\n}\n","/* eslint-disable no-sync */\n\nimport * as ChildProcess from 'child_process'\nimport * as os from 'os'\n\ntype IndexLookup = {\n  [propName: string]: string\n}\n\n/**\n * The names of any env vars that we shouldn't copy from the shell environment.\n */\nconst BlacklistedNames = new Set(['LOCAL_GIT_DIRECTORY'])\n\n/**\n * Inspect whether the current process needs to be patched to get important\n * environment variables for Desktop to work and integrate with other tools\n * the user may invoke as part of their workflow.\n *\n * This is only applied to macOS installations due to how the application\n * is launched.\n *\n * @param process The process to inspect.\n */\nexport function shellNeedsPatching(process: NodeJS.Process): boolean {\n  return __DARWIN__ && !process.env.PWD\n}\n\ntype ShellResult = {\n  stdout: string\n  error: Error | null\n}\n\n/**\n * Gets a dump of the user's configured shell environment.\n *\n * @returns the output of the `env` command or `null` if there was an error.\n */\nasync function getRawShellEnv(): Promise<string | null> {\n  const shell = getUserShell()\n\n  const promise = new Promise<ShellResult>(resolve => {\n    let child: ChildProcess.ChildProcess | null = null\n    let error: Error | null = null\n    let stdout = ''\n    let done = false\n\n    // ensure we clean up eventually, in case things go bad\n    const cleanup = () => {\n      if (!done && child) {\n        child.kill()\n        done = true\n      }\n    }\n    process.once('exit', cleanup)\n    setTimeout(() => {\n      cleanup()\n    }, 5000)\n\n    const options = {\n      detached: true,\n      stdio: ['ignore', 'pipe', process.stderr],\n    }\n\n    child = ChildProcess.spawn(shell, ['-ilc', 'command env'], options)\n\n    const buffers: Array<Buffer> = []\n\n    child.on('error', (e: Error) => {\n      done = true\n      error = e\n    })\n\n    child.stdout.on('data', (data: Buffer) => {\n      buffers.push(data)\n    })\n\n    child.on('close', (code: number, signal) => {\n      done = true\n      process.removeListener('exit', cleanup)\n      if (buffers.length) {\n        stdout = Buffer.concat(buffers).toString('utf8')\n      }\n\n      resolve({ stdout, error })\n    })\n  })\n\n  const { stdout, error } = await promise\n\n  if (error) {\n    // just swallow the error and move on with everything\n    return null\n  }\n\n  return stdout\n}\n\nfunction getUserShell() {\n  if (process.env.SHELL) {\n    return process.env.SHELL\n  }\n\n  return '/bin/bash'\n}\n\n/**\n * Get the environment variables from the user's current shell and update the\n * current environment.\n *\n * @param updateEnvironment a callback to fire if a valid environment is found\n */\nasync function getEnvironmentFromShell(\n  updateEnvironment: (env: IndexLookup) => void\n): Promise<void> {\n  if (__WIN32__) {\n    return\n  }\n\n  const shellEnvText = await getRawShellEnv()\n  if (!shellEnvText) {\n    return\n  }\n\n  const env: IndexLookup = {}\n\n  for (const line of shellEnvText.split(os.EOL)) {\n    if (line.includes('=')) {\n      const components = line.split('=')\n      if (components.length === 2) {\n        env[components[0]] = components[1]\n      } else {\n        const k = components.shift()\n        const v = components.join('=')\n        if (k) {\n          env[k] = v\n        }\n      }\n    }\n  }\n\n  updateEnvironment(env)\n}\n\n/**\n * Apply new environment variables to the current process, ignoring\n * Node-specific environment variables which need to be preserved.\n *\n * @param env The new environment variables from the user's shell.\n */\nfunction mergeEnvironmentVariables(env: IndexLookup) {\n  for (const key in env) {\n    if (BlacklistedNames.has(key)) {\n      continue\n    }\n\n    process.env[key] = env[key]\n  }\n}\n\n/**\n * Update the current process's environment variables using environment\n * variables from the user's shell, if they can be retrieved successfully.\n */\nexport function updateEnvironmentForProcess(): Promise<void> {\n  return getEnvironmentFromShell(mergeEnvironmentVariables)\n}\n","import Dexie from 'dexie'\nimport { APIRefState, IAPIRefStatusItem } from '../api'\nimport { BaseDatabase } from './base-database'\n\nexport interface IPullRequestRef {\n  /**\n   * The database ID of the GitHub repository in which this ref lives. It could\n   * be null if the repository was deleted on the site after the PR was opened.\n   */\n  readonly repoId: number | null\n\n  /** The name of the ref. */\n  readonly ref: string\n\n  /** The SHA of the ref. */\n  readonly sha: string\n}\n\nexport interface IPullRequest {\n  /**\n   * The database ID. This will be undefined if the pull request hasn't been\n   * inserted into the DB.\n   */\n  readonly id?: number\n\n  /** The GitHub PR number. */\n  readonly number: number\n\n  /** The title. */\n  readonly title: string\n\n  /** The string formatted date on which the PR was created. */\n  readonly createdAt: string\n\n  /** The ref from which the pull request's changes are coming. */\n  readonly head: IPullRequestRef\n\n  /** The ref which the pull request is targetting. */\n  readonly base: IPullRequestRef\n\n  /** The login of the author. */\n  readonly author: string\n}\n\nexport interface IPullRequestStatus {\n  /**\n   * The database ID. This will be undefined if the status hasn't been inserted\n   * into the DB.\n   */\n  readonly id?: number\n\n  /** The ID of the pull request in the database. */\n  readonly pullRequestId: number\n\n  /** The status' state. */\n  readonly state: APIRefState\n\n  /** The number of statuses represented in this combined status. */\n  readonly totalCount: number\n\n  /** The SHA for which this status applies. */\n  readonly sha: string\n\n  /**\n   * The list of statuses for this specific ref or undefined\n   * if the database object was created prior to status support\n   * being added in #3588\n   */\n  readonly statuses?: ReadonlyArray<IAPIRefStatusItem>\n}\n\nexport class PullRequestDatabase extends BaseDatabase {\n  public pullRequests!: Dexie.Table<IPullRequest, number>\n  public pullRequestStatus!: Dexie.Table<IPullRequestStatus, number>\n\n  public constructor(name: string, schemaVersion?: number) {\n    super(name, schemaVersion)\n\n    this.conditionalVersion(1, {\n      pullRequests: 'id++, base.repoId',\n    })\n\n    this.conditionalVersion(2, {\n      pullRequestStatus: 'id++, &[sha+pullRequestId]',\n    })\n\n    this.conditionalVersion(3, {\n      pullRequestStatus: 'id++, &[sha+pullRequestId], pullRequestId',\n    })\n\n    // we need to run the upgrade function to ensure we add\n    // a status field to all previous records\n    this.conditionalVersion(4, {}, this.addStatusesField)\n  }\n\n  private addStatusesField = async (transaction: Dexie.Transaction) => {\n    const table = this.pullRequestStatus\n\n    await table.toCollection().modify(async prStatus => {\n      if (prStatus.statuses == null) {\n        const newPrStatus = { statuses: [], ...prStatus }\n\n        await table\n          .where('[sha+pullRequestId]')\n          .equals([prStatus.sha, prStatus.pullRequestId])\n          .delete()\n\n        await table.add(newPrStatus)\n      }\n    })\n  }\n}\n","import Dexie from 'dexie'\nimport { BaseDatabase } from './base-database'\n\nexport interface IDatabaseOwner {\n  readonly id?: number | null\n  readonly login: string\n  readonly endpoint: string\n}\n\nexport interface IDatabaseGitHubRepository {\n  readonly id?: number | null\n  readonly ownerID: number\n  readonly name: string\n  readonly private: boolean | null\n  readonly htmlURL: string | null\n  readonly defaultBranch: string | null\n  readonly cloneURL: string | null\n\n  /** The database ID of the parent repository if the repository is a fork. */\n  readonly parentID: number | null\n}\n\nexport interface IDatabaseRepository {\n  readonly id?: number | null\n  readonly gitHubRepositoryID: number | null\n  readonly path: string\n  readonly missing: boolean\n}\n\n/** The repositories database. */\nexport class RepositoriesDatabase extends BaseDatabase {\n  /** The local repositories table. */\n  public repositories!: Dexie.Table<IDatabaseRepository, number>\n\n  /** The GitHub repositories table. */\n  public gitHubRepositories!: Dexie.Table<IDatabaseGitHubRepository, number>\n\n  /** The GitHub repository owners table. */\n  public owners!: Dexie.Table<IDatabaseOwner, number>\n\n  /**\n   * Initialize a new repository database.\n   *\n   * name          - The name of the database.\n   * schemaVersion - The version of the schema to use. If not provided, the\n   *                 database will be created with the latest version.\n   */\n  public constructor(name: string, schemaVersion?: number) {\n    super(name, schemaVersion)\n\n    this.conditionalVersion(1, {\n      repositories: '++id, &path',\n      gitHubRepositories: '++id, name',\n      owners: '++id, login',\n    })\n\n    this.conditionalVersion(2, {\n      owners: '++id, &[endpoint+login]',\n    })\n\n    // We're adding a new index with a uniqueness constraint in the *next*\n    // version and its upgrade callback only happens *after* the schema's been\n    // changed. So we need to prepare for it by removing any old data now\n    // which will violate it.\n    this.conditionalVersion(3, {}, removeDuplicateGitHubRepositories)\n\n    this.conditionalVersion(4, {\n      gitHubRepositories: '++id, name, &[ownerID+name]',\n    })\n\n    this.conditionalVersion(5, {\n      gitHubRepositories: '++id, name, &[ownerID+name], cloneURL',\n    })\n  }\n}\n\n/**\n * Remove any duplicate GitHub repositories that have the same owner and name.\n */\nfunction removeDuplicateGitHubRepositories(transaction: Dexie.Transaction) {\n  const table = transaction.table<IDatabaseGitHubRepository, number>(\n    'gitHubRepositories'\n  )\n\n  const seenKeys = new Set<string>()\n  return table.toCollection().each(repo => {\n    const key = `${repo.ownerID}+${repo.name}`\n    if (seenKeys.has(key)) {\n      // We can be sure `id` isn't null since we just got it from the\n      // database.\n      const id = repo.id!\n\n      table.delete(id)\n    } else {\n      seenKeys.add(key)\n    }\n  })\n}\n","import Dexie from 'dexie'\nimport { BaseDatabase } from './base-database'\n\nexport interface IIssue {\n  readonly id?: number\n  readonly gitHubRepositoryID: number\n  readonly number: number\n  readonly title: string\n  readonly updated_at?: string\n}\n\nexport class IssuesDatabase extends BaseDatabase {\n  public issues!: Dexie.Table<IIssue, number>\n\n  public constructor(name: string, schemaVersion?: number) {\n    super(name, schemaVersion)\n\n    this.conditionalVersion(1, {\n      issues: '++id, &[gitHubRepositoryID+number], gitHubRepositoryID, number',\n    })\n\n    this.conditionalVersion(\n      2,\n      {\n        issues:\n          '++id, &[gitHubRepositoryID+number], gitHubRepositoryID, number, [gitHubRepositoryID+updated_at]',\n      },\n      clearIssues\n    )\n  }\n}\n\nfunction clearIssues(transaction: Dexie.Transaction) {\n  // Clear deprecated localStorage keys, we compute the since parameter\n  // using the database now.\n  clearDeprecatedKeys()\n\n  // Unfortunately we have to clear the issues in order to maintain\n  // data consistency in the database. The issues table is only supposed\n  // to store 'open' issues and if we kept the existing issues (which)\n  // don't have an updated_at field around the initial query for\n  // max(updated_at) would return null, causing us to fetch all _open_\n  // issues which in turn means we wouldn't be able to detect if we\n  // have any issues in the database that have been closed since the\n  // last time we fetched. Not only that, these closed issues wouldn't\n  // be updated to include the updated_at field unless they were actually\n  // modified at a later date.\n  //\n  // TL;DR; This is the safest approach\n  return transaction.table('issues').clear()\n}\n\nfunction clearDeprecatedKeys() {\n  Object.keys(localStorage)\n    .filter(key => /^IssuesStore\\/\\d+\\/lastFetch$/.test(key))\n    .forEach(key => localStorage.removeItem(key))\n}\n","import Dexie from 'dexie'\nimport { BaseDatabase } from './base-database'\n\nexport interface IGitHubUser {\n  /**\n   * The internal (to desktop) database id for this user or undefined\n   * if not yet inserted into the database.\n   */\n  readonly id?: number\n  readonly endpoint: string\n  readonly email: string\n  readonly login: string\n  readonly avatarURL: string\n\n  /**\n   * The user's real name or null if the user hasn't provided a real\n   * name yet.\n   */\n  readonly name: string | null\n}\n\nexport interface IMentionableAssociation {\n  /**\n   * The internal (to desktop) database id for this association\n   *  or undefined if not yet inserted into the database.\n   */\n  readonly id?: number\n  readonly userID: number\n  readonly repositoryID: number\n}\n\nexport class GitHubUserDatabase extends BaseDatabase {\n  public users!: Dexie.Table<IGitHubUser, number>\n  public mentionables!: Dexie.Table<IMentionableAssociation, number>\n\n  public constructor(name: string, schemaVersion?: number) {\n    super(name, schemaVersion)\n\n    this.conditionalVersion(1, {\n      users: '++id, &[endpoint+email]',\n    })\n\n    this.conditionalVersion(2, {\n      users: '++id, [endpoint+email], [endpoint+login]',\n      mentionables: '++id, repositoryID, &[userID+repositoryID]',\n    })\n  }\n}\n","import { Dispatcher } from './index'\nimport { GitError } from '../git/core'\nimport {\n  GitError as DugiteError,\n  RepositoryDoesNotExistErrorCode,\n} from 'dugite'\nimport { ErrorWithMetadata } from '../error-with-metadata'\nimport { ExternalEditorError } from '../editors/shared'\nimport { AuthenticationErrors } from '../git/authentication'\nimport { Repository } from '../../models/repository'\nimport { PopupType } from '../../lib/app-state'\nimport { ShellError } from '../shells'\nimport { UpstreamAlreadyExistsError } from '../stores/upstream-already-exists-error'\nimport { FetchType } from '../../models/fetch'\n\n/** An error which also has a code property. */\ninterface IErrorWithCode extends Error {\n  readonly code: string\n}\n\n/**\n * Cast the error to an error containing a code if it has a code. Otherwise\n * return null.\n */\nfunction asErrorWithCode(error: Error): IErrorWithCode | null {\n  const e = error as any\n  if (e.code) {\n    return e\n  } else {\n    return null\n  }\n}\n\n/**\n * Cast the error to an error with metadata if possible. Otherwise return null.\n */\nfunction asErrorWithMetadata(error: Error): ErrorWithMetadata | null {\n  if (error instanceof ErrorWithMetadata) {\n    return error\n  } else {\n    return null\n  }\n}\n\n/** Cast the error to a `GitError` if possible. Otherwise return null. */\nfunction asGitError(error: Error): GitError | null {\n  if (error instanceof GitError) {\n    return error\n  } else {\n    return null\n  }\n}\n\nfunction asEditorError(error: Error): ExternalEditorError | null {\n  if (error instanceof ExternalEditorError) {\n    return error\n  }\n  return null\n}\n\n/** Handle errors by presenting them. */\nexport async function defaultErrorHandler(\n  error: Error,\n  dispatcher: Dispatcher\n): Promise<Error | null> {\n  const e = asErrorWithMetadata(error) || error\n  await dispatcher.presentError(e)\n\n  return null\n}\n\n/** Handler for when a repository disappears . */\nexport async function missingRepositoryHandler(\n  error: Error,\n  dispatcher: Dispatcher\n): Promise<Error | null> {\n  const e = asErrorWithMetadata(error)\n  if (!e) {\n    return error\n  }\n\n  const repository = e.metadata.repository\n  if (!repository || !(repository instanceof Repository)) {\n    return error\n  }\n\n  if (repository.missing) {\n    return null\n  }\n\n  const errorWithCode = asErrorWithCode(e.underlyingError)\n  const gitError = asGitError(e.underlyingError)\n  const missing =\n    (gitError && gitError.result.gitError === DugiteError.NotAGitRepository) ||\n    (errorWithCode && errorWithCode.code === RepositoryDoesNotExistErrorCode)\n\n  if (missing) {\n    await dispatcher.updateRepositoryMissing(repository, true)\n    return null\n  }\n\n  return error\n}\n\n/** Handle errors that happen as a result of a background task. */\nexport async function backgroundTaskHandler(\n  error: Error,\n  dispatcher: Dispatcher\n): Promise<Error | null> {\n  const e = asErrorWithMetadata(error)\n  if (!e) {\n    return error\n  }\n\n  const metadata = e.metadata\n  // Ignore errors from background tasks. We might want more nuance here in the\n  // future, but this'll do for now.\n  if (metadata.backgroundTask) {\n    return null\n  } else {\n    return error\n  }\n}\n\n/** Handle git authentication errors in a manner that seems Right And Good. */\nexport async function gitAuthenticationErrorHandler(\n  error: Error,\n  dispatcher: Dispatcher\n): Promise<Error | null> {\n  const e = asErrorWithMetadata(error)\n  if (!e) {\n    return error\n  }\n\n  const gitError = asGitError(e.underlyingError)\n  if (!gitError) {\n    return error\n  }\n\n  const dugiteError = gitError.result.gitError\n  if (!dugiteError) {\n    return error\n  }\n\n  if (!AuthenticationErrors.has(dugiteError)) {\n    return error\n  }\n\n  const repository = e.metadata.repository\n  if (!repository) {\n    return error\n  }\n\n  // If it's a GitHub repository then it's not some generic git server\n  // authentication problem, but more likely a legit permission problem. So let\n  // the error continue to bubble up.\n  if (repository instanceof Repository && repository.gitHubRepository) {\n    return error\n  }\n\n  const retry = e.metadata.retryAction\n  if (!retry) {\n    log.error(`No retry action provided for a git authentication error.`, e)\n    return error\n  }\n\n  await dispatcher.promptForGenericGitAuthentication(repository, retry)\n\n  return null\n}\n\nexport async function externalEditorErrorHandler(\n  error: Error,\n  dispatcher: Dispatcher\n): Promise<Error | null> {\n  const e = asEditorError(error)\n  if (!e) {\n    return error\n  }\n\n  const { suggestAtom, openPreferences } = e.metadata\n\n  await dispatcher.showPopup({\n    type: PopupType.ExternalEditorFailed,\n    message: e.message,\n    suggestAtom,\n    openPreferences,\n  })\n\n  return null\n}\n\nexport async function openShellErrorHandler(\n  error: Error,\n  dispatcher: Dispatcher\n): Promise<Error | null> {\n  if (!(error instanceof ShellError)) {\n    return error\n  }\n\n  await dispatcher.showPopup({\n    type: PopupType.OpenShellFailed,\n    message: error.message,\n  })\n\n  return null\n}\n\n/** Handle errors where they need to pull before pushing. */\nexport async function pushNeedsPullHandler(\n  error: Error,\n  dispatcher: Dispatcher\n): Promise<Error | null> {\n  const e = asErrorWithMetadata(error)\n  if (!e) {\n    return error\n  }\n\n  const gitError = asGitError(e.underlyingError)\n  if (!gitError) {\n    return error\n  }\n\n  const dugiteError = gitError.result.gitError\n  if (!dugiteError) {\n    return error\n  }\n\n  if (dugiteError !== DugiteError.PushNotFastForward) {\n    return error\n  }\n\n  const repository = e.metadata.repository\n  if (!repository) {\n    return error\n  }\n\n  if (!(repository instanceof Repository)) {\n    return error\n  }\n\n  // Since they need to pull, go ahead and do a fetch for them.\n  dispatcher.fetch(repository, FetchType.UserInitiatedTask)\n\n  return error\n}\n\n/**\n * Handler for detecting when a merge conflict is reported to direct the user\n * to a different dialog than the generic Git error dialog.\n */\nexport async function mergeConflictHandler(\n  error: Error,\n  dispatcher: Dispatcher\n): Promise<Error | null> {\n  const e = asErrorWithMetadata(error)\n  if (!e) {\n    return error\n  }\n\n  const gitError = asGitError(e.underlyingError)\n  if (!gitError) {\n    return error\n  }\n\n  const dugiteError = gitError.result.gitError\n  if (!dugiteError) {\n    return error\n  }\n\n  if (dugiteError !== DugiteError.MergeConflicts) {\n    return error\n  }\n\n  const repository = e.metadata.repository\n  if (!repository) {\n    return error\n  }\n\n  if (!(repository instanceof Repository)) {\n    return error\n  }\n\n  const command = e.metadata.command\n\n  if (command != null) {\n    switch (command) {\n      case 'pull':\n        dispatcher.mergeConflictDetectedFromPull()\n        break\n      case 'merge':\n        dispatcher.mergeConflictDetectedFromExplicitMerge()\n        break\n    }\n  }\n\n  dispatcher.showPopup({\n    type: PopupType.MergeConflicts,\n    repository,\n  })\n\n  return null\n}\n\n/**\n * Handler for when we attempt to install the global LFS filters and LFS throws\n * an error.\n */\nexport async function lfsAttributeMismatchHandler(\n  error: Error,\n  dispatcher: Dispatcher\n): Promise<Error | null> {\n  const gitError = asGitError(error)\n  if (!gitError) {\n    return error\n  }\n\n  const dugiteError = gitError.result.gitError\n  if (!dugiteError) {\n    return error\n  }\n\n  if (dugiteError !== DugiteError.LFSAttributeDoesNotMatch) {\n    return error\n  }\n\n  dispatcher.showPopup({ type: PopupType.LFSAttributeMismatch })\n\n  return null\n}\n\n/**\n * Handler for when an upstream remote already exists but doesn't actually match\n * the upstream repository.\n */\nexport async function upstreamAlreadyExistsHandler(\n  error: Error,\n  dispatcher: Dispatcher\n): Promise<Error | null> {\n  if (!(error instanceof UpstreamAlreadyExistsError)) {\n    return error\n  }\n\n  dispatcher.showPopup({\n    type: PopupType.UpstreamAlreadyExists,\n    repository: error.repository,\n    existingRemote: error.existingRemote,\n  })\n\n  return null\n}\n","import { spawn } from 'child_process'\nimport * as Path from 'path'\n\nexport function isGitOnPath(): Promise<boolean> {\n  // Modern versions of macOS ship with a Git shim that guides you through\n  // the process of setting everything up. We trust this is available, so\n  // don't worry about looking for it here.\n  if (__DARWIN__) {\n    return Promise.resolve(true)\n  }\n\n  // adapted from http://stackoverflow.com/a/34953561/1363815\n  if (__WIN32__) {\n    return new Promise<boolean>((resolve, reject) => {\n      const windowsRoot = process.env.SystemRoot || 'C:\\\\Windows'\n      const wherePath = Path.join(windowsRoot, 'System32', 'where.exe')\n\n      const cp = spawn(wherePath, ['git'])\n\n      cp.on('error', error => {\n        log.warn('Unable to spawn where.exe', error)\n        resolve(false)\n      })\n\n      // `where` will return 0 when the executable\n      // is found under PATH, or 1 if it cannot be found\n      cp.on('close', function(code) {\n        resolve(code === 0)\n      })\n      return\n    })\n  }\n\n  if (__LINUX__) {\n    return new Promise<boolean>((resolve, reject) => {\n      const process = spawn('which', ['git'])\n\n      // `which` will return 0 when the executable\n      // is found under PATH, or 1 if it cannot be found\n      process.on('close', function(code) {\n        resolve(code === 0)\n      })\n    })\n  }\n\n  return Promise.resolve(false)\n}\n","import * as Path from 'path'\n\nimport { remote } from 'electron'\nimport { Disposable } from 'event-kit'\n\nimport { Account } from '../../models/account'\nimport { Repository } from '../../models/repository'\nimport {\n  WorkingDirectoryFileChange,\n  CommittedFileChange,\n} from '../../models/status'\nimport { DiffSelection } from '../../models/diff'\nimport {\n  RepositorySectionTab,\n  Popup,\n  PopupType,\n  Foldout,\n  FoldoutType,\n  ImageDiffType,\n  CompareAction,\n  ICompareFormUpdate,\n  MergeResultStatus,\n} from '../app-state'\nimport { AppStore } from '../stores/app-store'\nimport { CloningRepository } from '../../models/cloning-repository'\nimport { Branch } from '../../models/branch'\nimport { Commit } from '../../models/commit'\nimport { ExternalEditor } from '../../lib/editors'\nimport { IAPIUser } from '../../lib/api'\nimport { GitHubRepository } from '../../models/github-repository'\nimport { ICommitMessage } from '../stores/git-store'\nimport { executeMenuItem } from '../../ui/main-process-proxy'\nimport { AppMenu, ExecutableMenuItem } from '../../models/app-menu'\nimport { matchExistingRepository } from '../../lib/repository-matching'\nimport { ILaunchStats, StatsStore } from '../stats'\nimport { fatalError, assertNever } from '../fatal-error'\nimport { isGitOnPath } from '../is-git-on-path'\nimport { shell } from '../app-shell'\nimport {\n  URLActionType,\n  IOpenRepositoryFromURLAction,\n  IUnknownAction,\n} from '../parse-app-url'\nimport {\n  requestAuthenticatedUser,\n  resolveOAuthRequest,\n  rejectOAuthRequest,\n} from '../../lib/oauth'\nimport { installCLI } from '../../ui/lib/install-cli'\nimport { setGenericUsername, setGenericPassword } from '../generic-git-auth'\nimport { RetryAction, RetryActionType } from '../retry-actions'\nimport { Shell } from '../shells'\nimport { CloneRepositoryTab } from '../../models/clone-repository-tab'\nimport { validatedRepositoryPath } from '../../lib/stores/helpers/validated-repository-path'\nimport { BranchesTab } from '../../models/branches-tab'\nimport { FetchType } from '../../models/fetch'\nimport { PullRequest } from '../../models/pull-request'\nimport { IAuthor } from '../../models/author'\nimport { ITrailer } from '../git/interpret-trailers'\nimport { isGitRepository } from '../git'\nimport { ApplicationTheme } from '../../ui/lib/application-theme'\nimport { TipState } from '../../models/tip'\nimport { RepositoryStateCache } from '../stores/repository-state-cache'\n\n/**\n * An error handler function.\n *\n * If the returned {Promise} returns an error, it will be passed to the next\n * error handler. If it returns null, error propagation is halted.\n */\nexport type ErrorHandler = (\n  error: Error,\n  dispatcher: Dispatcher\n) => Promise<Error | null>\n\n/**\n * The Dispatcher acts as the hub for state. The StateHub if you will. It\n * decouples the consumer of state from where/how it is stored.\n */\nexport class Dispatcher {\n  private readonly errorHandlers = new Array<ErrorHandler>()\n\n  public constructor(\n    private readonly appStore: AppStore,\n    private readonly repositoryStateManager: RepositoryStateCache,\n    private readonly statsStore: StatsStore\n  ) {}\n\n  /** Load the initial state for the app. */\n  public loadInitialState(): Promise<void> {\n    return this.appStore.loadInitialState()\n  }\n\n  /**\n   * Add the repositories at the given paths. If a path isn't a repository, then\n   * this will post an error to that affect.\n   */\n  public addRepositories(\n    paths: ReadonlyArray<string>\n  ): Promise<ReadonlyArray<Repository>> {\n    return this.appStore._addRepositories(paths)\n  }\n\n  /** Remove the repositories represented by the given IDs from local storage. */\n  public removeRepositories(\n    repositories: ReadonlyArray<Repository | CloningRepository>,\n    moveToTrash: boolean\n  ): Promise<void> {\n    if (moveToTrash) {\n      repositories.forEach(repository => {\n        shell.moveItemToTrash(repository.path)\n      })\n    }\n\n    return this.appStore._removeRepositories(repositories)\n  }\n\n  /** Update the repository's `missing` flag. */\n  public async updateRepositoryMissing(\n    repository: Repository,\n    missing: boolean\n  ): Promise<Repository> {\n    return this.appStore._updateRepositoryMissing(repository, missing)\n  }\n\n  /** Load the next batch of history for the repository. */\n  public loadNextCommitBatch(repository: Repository): Promise<void> {\n    return this.appStore._loadNextCommitBatch(repository)\n  }\n\n  /** Load the changed files for the current history selection. */\n  public loadChangedFilesForCurrentSelection(\n    repository: Repository\n  ): Promise<void> {\n    return this.appStore._loadChangedFilesForCurrentSelection(repository)\n  }\n\n  /**\n   * Change the selected commit in the history view.\n   *\n   * @param repository The currently active repository instance\n   *\n   * @param sha The object id of one of the commits currently\n   *            the history list, represented as a SHA-1 hash\n   *            digest. This should match exactly that of Commit.Sha\n   */\n  public changeCommitSelection(\n    repository: Repository,\n    sha: string\n  ): Promise<void> {\n    return this.appStore._changeCommitSelection(repository, sha)\n  }\n\n  /**\n   * Change the selected changed file in the history view.\n   *\n   * @param repository The currently active repository instance\n   *\n   * @param file A FileChange instance among those available in\n   *            IHistoryState.changedFiles\n   */\n  public changeFileSelection(\n    repository: Repository,\n    file: CommittedFileChange\n  ): Promise<void> {\n    return this.appStore._changeFileSelection(repository, file)\n  }\n\n  /** Set the repository filter text. */\n  public setRepositoryFilterText(text: string): Promise<void> {\n    return this.appStore._setRepositoryFilterText(text)\n  }\n\n  /** Select the repository. */\n  public selectRepository(\n    repository: Repository | CloningRepository\n  ): Promise<Repository | null> {\n    return this.appStore._selectRepository(repository)\n  }\n\n  /** Load the working directory status. */\n  public loadStatus(repository: Repository): Promise<boolean> {\n    return this.appStore._loadStatus(repository)\n  }\n\n  /** Change the selected section in the repository. */\n  public changeRepositorySection(\n    repository: Repository,\n    section: RepositorySectionTab\n  ): Promise<void> {\n    return this.appStore._changeRepositorySection(repository, section)\n  }\n\n  /** Change the currently selected file in Changes. */\n  public changeChangesSelection(\n    repository: Repository,\n    selectedFiles: WorkingDirectoryFileChange[]\n  ): Promise<void> {\n    return this.appStore._changeChangesSelection(repository, selectedFiles)\n  }\n\n  /**\n   * Commit the changes which were marked for inclusion, using the given commit\n   * summary and description and optionally any number of commit message trailers\n   * which will be merged into the final commit message.\n   */\n  public async commitIncludedChanges(\n    repository: Repository,\n    summary: string,\n    description: string | null,\n    trailers?: ReadonlyArray<ITrailer>\n  ): Promise<boolean> {\n    return this.appStore._commitIncludedChanges(\n      repository,\n      summary,\n      description,\n      trailers\n    )\n  }\n\n  /** Change the file's includedness. */\n  public changeFileIncluded(\n    repository: Repository,\n    file: WorkingDirectoryFileChange,\n    include: boolean\n  ): Promise<void> {\n    return this.appStore._changeFileIncluded(repository, file, include)\n  }\n\n  /** Change the file's line selection state. */\n  public changeFileLineSelection(\n    repository: Repository,\n    file: WorkingDirectoryFileChange,\n    diffSelection: DiffSelection\n  ): Promise<void> {\n    return this.appStore._changeFileLineSelection(\n      repository,\n      file,\n      diffSelection\n    )\n  }\n\n  /** Change the Include All state. */\n  public changeIncludeAllFiles(\n    repository: Repository,\n    includeAll: boolean\n  ): Promise<void> {\n    return this.appStore._changeIncludeAllFiles(repository, includeAll)\n  }\n\n  /**\n   * Refresh the repository. This would be used, e.g., when the app gains focus.\n   */\n  public refreshRepository(repository: Repository): Promise<void> {\n    return this.appStore._refreshRepository(repository)\n  }\n\n  /** Show the popup. This will close any current popup. */\n  public showPopup(popup: Popup): Promise<void> {\n    return this.appStore._showPopup(popup)\n  }\n\n  /** Close the current popup. */\n  public closePopup(): Promise<void> {\n    return this.appStore._closePopup()\n  }\n\n  /** Show the foldout. This will close any current popup. */\n  public showFoldout(foldout: Foldout): Promise<void> {\n    return this.appStore._showFoldout(foldout)\n  }\n\n  /** Close the current foldout. If opening a new foldout use closeFoldout instead. */\n  public closeCurrentFoldout(): Promise<void> {\n    return this.appStore._closeCurrentFoldout()\n  }\n\n  /** Close the specified foldout. */\n  public closeFoldout(foldout: FoldoutType): Promise<void> {\n    return this.appStore._closeFoldout(foldout)\n  }\n\n  /**\n   * Create a new branch from the given starting point and check it out.\n   *\n   * If the startPoint argument is omitted the new branch will be created based\n   * off of the current state of HEAD.\n   */\n  public createBranch(\n    repository: Repository,\n    name: string,\n    startPoint?: string\n  ): Promise<Repository> {\n    return this.appStore._createBranch(repository, name, startPoint)\n  }\n\n  /** Check out the given branch. */\n  public checkoutBranch(\n    repository: Repository,\n    branch: Branch | string\n  ): Promise<Repository> {\n    return this.appStore._checkoutBranch(repository, branch)\n  }\n\n  /** Push the current branch. */\n  public push(repository: Repository): Promise<void> {\n    return this.appStore._push(repository)\n  }\n\n  /** Pull the current branch. */\n  public pull(repository: Repository): Promise<void> {\n    return this.appStore._pull(repository)\n  }\n\n  /** Fetch a specific refspec for the repository. */\n  public fetchRefspec(\n    repository: Repository,\n    fetchspec: string\n  ): Promise<void> {\n    return this.appStore._fetchRefspec(repository, fetchspec)\n  }\n\n  /** Fetch all refs for the repository */\n  public fetch(repository: Repository, fetchType: FetchType): Promise<void> {\n    return this.appStore._fetch(repository, fetchType)\n  }\n\n  /** Publish the repository to GitHub with the given properties. */\n  public publishRepository(\n    repository: Repository,\n    name: string,\n    description: string,\n    private_: boolean,\n    account: Account,\n    org: IAPIUser | null\n  ): Promise<Repository> {\n    return this.appStore._publishRepository(\n      repository,\n      name,\n      description,\n      private_,\n      account,\n      org\n    )\n  }\n\n  /**\n   * Post the given error. This will send the error through the standard error\n   * handler machinery.\n   */\n  public async postError(error: Error): Promise<void> {\n    let currentError: Error | null = error\n    for (let i = this.errorHandlers.length - 1; i >= 0; i--) {\n      const handler = this.errorHandlers[i]\n      currentError = await handler(currentError, this)\n\n      if (!currentError) {\n        break\n      }\n    }\n\n    if (currentError) {\n      fatalError(\n        `Unhandled error ${currentError}. This shouldn't happen! All errors should be handled, even if it's just by the default handler.`\n      )\n    }\n  }\n\n  /**\n   * Post the given error. Note that this bypasses the standard error handler\n   * machinery. You probably don't want that. See `Dispatcher.postError`\n   * instead.\n   */\n  public presentError(error: Error): Promise<void> {\n    return this.appStore._pushError(error)\n  }\n\n  /** Clear the given error. */\n  public clearError(error: Error): Promise<void> {\n    return this.appStore._clearError(error)\n  }\n\n  /**\n   * Clone a missing repository to the previous path, and update it's\n   * state in the repository list if the clone completes without error.\n   */\n  public cloneAgain(url: string, path: string): Promise<void> {\n    return this.appStore._cloneAgain(url, path)\n  }\n\n  /** Clone the repository to the path. */\n  public async clone(\n    url: string,\n    path: string,\n    options?: { branch?: string }\n  ): Promise<Repository | null> {\n    return this.appStore._completeOpenInDesktop(async () => {\n      const { promise, repository } = this.appStore._clone(url, path, options)\n      await this.selectRepository(repository)\n      const success = await promise\n      // TODO: this exit condition is not great, bob\n      if (!success) {\n        return null\n      }\n\n      const addedRepositories = await this.addRepositories([path])\n      const addedRepository = addedRepositories[0]\n      await this.selectRepository(addedRepository)\n\n      return addedRepository\n    })\n  }\n\n  /** Rename the branch to a new name. */\n  public renameBranch(\n    repository: Repository,\n    branch: Branch,\n    newName: string\n  ): Promise<void> {\n    return this.appStore._renameBranch(repository, branch, newName)\n  }\n\n  /**\n   * Delete the branch. This will delete both the local branch and the remote\n   * branch, and then check out the default branch.\n   */\n  public deleteBranch(\n    repository: Repository,\n    branch: Branch,\n    includeRemote: boolean\n  ): Promise<void> {\n    return this.appStore._deleteBranch(repository, branch, includeRemote)\n  }\n\n  /** Discard the changes to the given files. */\n  public discardChanges(\n    repository: Repository,\n    files: ReadonlyArray<WorkingDirectoryFileChange>\n  ): Promise<void> {\n    return this.appStore._discardChanges(repository, files)\n  }\n\n  /** Undo the given commit. */\n  public undoCommit(repository: Repository, commit: Commit): Promise<void> {\n    return this.appStore._undoCommit(repository, commit)\n  }\n\n  /** Revert the commit with the given SHA */\n  public revertCommit(repository: Repository, commit: Commit): Promise<void> {\n    return this.appStore._revertCommit(repository, commit)\n  }\n\n  /**\n   * Set the width of the repository sidebar to the given\n   * value. This affects the changes and history sidebar\n   * as well as the first toolbar section which contains\n   * repo selection on all platforms and repo selection and\n   * app menu on Windows.\n   */\n  public setSidebarWidth(width: number): Promise<void> {\n    return this.appStore._setSidebarWidth(width)\n  }\n\n  /**\n   * Set the update banner's visibility\n   */\n  public setUpdateBannerVisibility(isVisible: boolean) {\n    return this.appStore._setUpdateBannerVisibility(isVisible)\n  }\n\n  /**\n   * Set the divering branch notification banner's visibility\n   */\n  public setDivergingBranchBannerVisibility(\n    repository: Repository,\n    isVisible: boolean\n  ) {\n    return this.appStore._setDivergingBranchBannerVisibility(\n      repository,\n      isVisible\n    )\n  }\n\n  /**\n   * Reset the width of the repository sidebar to its default\n   * value. This affects the changes and history sidebar\n   * as well as the first toolbar section which contains\n   * repo selection on all platforms and repo selection and\n   * app menu on Windows.\n   */\n  public resetSidebarWidth(): Promise<void> {\n    return this.appStore._resetSidebarWidth()\n  }\n\n  /**\n   * Set the width of the commit summary column in the\n   * history view to the given value.\n   */\n  public setCommitSummaryWidth(width: number): Promise<void> {\n    return this.appStore._setCommitSummaryWidth(width)\n  }\n\n  /**\n   * Reset the width of the commit summary column in the\n   * history view to its default value.\n   */\n  public resetCommitSummaryWidth(): Promise<void> {\n    return this.appStore._resetCommitSummaryWidth()\n  }\n\n  /** Update the repository's issues from GitHub. */\n  public refreshIssues(repository: GitHubRepository): Promise<void> {\n    return this.appStore._refreshIssues(repository)\n  }\n\n  /** End the Welcome flow. */\n  public endWelcomeFlow(): Promise<void> {\n    return this.appStore._endWelcomeFlow()\n  }\n\n  /**\n   * Set the commit summary and description for a work-in-progress\n   * commit in the changes view for a particular repository.\n   */\n  public setCommitMessage(\n    repository: Repository,\n    message: ICommitMessage | null\n  ): Promise<void> {\n    return this.appStore._setCommitMessage(repository, message)\n  }\n\n  /** Add the account to the app. */\n  public addAccount(account: Account): Promise<void> {\n    return this.appStore._addAccount(account)\n  }\n\n  /** Remove the given account from the app. */\n  public removeAccount(account: Account): Promise<void> {\n    return this.appStore._removeAccount(account)\n  }\n\n  /**\n   * Ask the dispatcher to apply a transformation function to the current\n   * state of the application menu.\n   *\n   * Since the dispatcher is asynchronous it's possible for components\n   * utilizing the menu state to have an out-of-date view of the state\n   * of the app menu which is why they're not allowed to transform it\n   * directly.\n   *\n   * To work around potential race conditions consumers instead pass a\n   * delegate which receives the updated application menu and allows\n   * them to perform the necessary state transitions. The AppMenu instance\n   * is itself immutable but does offer transformation methods and in\n   * order for the state to be properly updated the delegate _must_ return\n   * the latest transformed instance of the AppMenu.\n   */\n  public setAppMenuState(update: (appMenu: AppMenu) => AppMenu): Promise<void> {\n    return this.appStore._setAppMenuState(update)\n  }\n\n  /**\n   * Tell the main process to execute (i.e. simulate a click of) the given menu item.\n   */\n  public executeMenuItem(item: ExecutableMenuItem): Promise<void> {\n    executeMenuItem(item)\n    return Promise.resolve()\n  }\n\n  /**\n   * Set whether or not to to add a highlight class to the app menu toolbar icon.\n   * Used to highlight the button when the Alt key is pressed.\n   *\n   * Only applicable on non-macOS platforms.\n   */\n  public setAccessKeyHighlightState(highlight: boolean): Promise<void> {\n    return this.appStore._setAccessKeyHighlightState(highlight)\n  }\n\n  /** Merge the named branch into the current branch. */\n  public mergeBranch(\n    repository: Repository,\n    branch: string,\n    mergeStatus: MergeResultStatus | null\n  ): Promise<void> {\n    return this.appStore._mergeBranch(repository, branch, mergeStatus)\n  }\n\n  /** Record the given launch stats. */\n  public recordLaunchStats(stats: ILaunchStats): Promise<void> {\n    return this.appStore._recordLaunchStats(stats)\n  }\n\n  /** Report any stats if needed. */\n  public reportStats(): Promise<void> {\n    return this.appStore._reportStats()\n  }\n\n  /** Changes the URL for the remote that matches the given name  */\n  public setRemoteURL(\n    repository: Repository,\n    name: string,\n    url: string\n  ): Promise<void> {\n    return this.appStore._setRemoteURL(repository, name, url)\n  }\n\n  /** Open the URL in a browser */\n  public openInBrowser(url: string): Promise<boolean> {\n    return this.appStore._openInBrowser(url)\n  }\n\n  /** Add the pattern to the repository's gitignore. */\n  public appendIgnoreRule(\n    repository: Repository,\n    pattern: string | string[]\n  ): Promise<void> {\n    return this.appStore._appendIgnoreRule(repository, pattern)\n  }\n\n  /** Opens a Git-enabled terminal setting the working directory to the repository path */\n  public async openShell(\n    path: string,\n    ignoreWarning: boolean = false\n  ): Promise<void> {\n    const gitFound = await isGitOnPath()\n    if (gitFound || ignoreWarning) {\n      this.appStore._openShell(path)\n    } else {\n      this.appStore._showPopup({ type: PopupType.InstallGit, path })\n    }\n  }\n\n  /**\n   * Opens a path in the external editor selected by the user.\n   */\n  public async openInExternalEditor(fullPath: string): Promise<void> {\n    return this.appStore._openInExternalEditor(fullPath)\n  }\n\n  /**\n   * Persist the given content to the repository's root .gitignore.\n   *\n   * If the repository root doesn't contain a .gitignore file one\n   * will be created, otherwise the current file will be overwritten.\n   */\n  public saveGitIgnore(repository: Repository, text: string): Promise<void> {\n    return this.appStore._saveGitIgnore(repository, text)\n  }\n\n  /** Set whether the user has opted out of stats reporting. */\n  public setStatsOptOut(optOut: boolean): Promise<void> {\n    return this.appStore.setStatsOptOut(optOut)\n  }\n\n  /**\n   * Clear any in-flight sign in state and return to the\n   * initial (no sign-in) state.\n   */\n  public resetSignInState(): Promise<void> {\n    return this.appStore._resetSignInState()\n  }\n\n  /**\n   * Initiate a sign in flow for github.com. This will put the store\n   * in the Authentication step ready to receive user credentials.\n   */\n  public beginDotComSignIn(): Promise<void> {\n    return this.appStore._beginDotComSignIn()\n  }\n\n  /**\n   * Initiate a sign in flow for a GitHub Enterprise instance. This will\n   * put the store in the EndpointEntry step ready to receive the url\n   * to the enterprise instance.\n   */\n  public beginEnterpriseSignIn(): Promise<void> {\n    return this.appStore._beginEnterpriseSignIn()\n  }\n\n  /**\n   * Attempt to advance from the EndpointEntry step with the given endpoint\n   * url. This method must only be called when the store is in the authentication\n   * step or an error will be thrown.\n   *\n   * The provided endpoint url will be validated for syntactic correctness as\n   * well as connectivity before the promise resolves. If the endpoint url is\n   * invalid or the host can't be reached the promise will be rejected and the\n   * sign in state updated with an error to be presented to the user.\n   *\n   * If validation is successful the store will advance to the authentication\n   * step.\n   */\n  public setSignInEndpoint(url: string): Promise<void> {\n    return this.appStore._setSignInEndpoint(url)\n  }\n\n  /**\n   * Attempt to advance from the authentication step using a username\n   * and password. This method must only be called when the store is\n   * in the authentication step or an error will be thrown. If the\n   * provided credentials are valid the store will either advance to\n   * the Success step or to the TwoFactorAuthentication step if the\n   * user has enabled two factor authentication.\n   *\n   * If an error occurs during sign in (such as invalid credentials)\n   * the authentication state will be updated with that error so that\n   * the responsible component can present it to the user.\n   */\n  public setSignInCredentials(\n    username: string,\n    password: string\n  ): Promise<void> {\n    return this.appStore._setSignInCredentials(username, password)\n  }\n\n  /**\n   * Initiate an OAuth sign in using the system configured browser.\n   * This method must only be called when the store is in the authentication\n   * step or an error will be thrown.\n   *\n   * The promise returned will only resolve once the user has successfully\n   * authenticated. If the user terminates the sign-in process by closing\n   * their browser before the protocol handler is invoked, by denying the\n   * protocol handler to execute or by providing the wrong credentials\n   * this promise will never complete.\n   */\n  public requestBrowserAuthentication(): Promise<void> {\n    return this.appStore._requestBrowserAuthentication()\n  }\n\n  /**\n   * Attempt to complete the sign in flow with the given OTP token.\\\n   * This method must only be called when the store is in the\n   * TwoFactorAuthentication step or an error will be thrown.\n   *\n   * If the provided token is valid the store will advance to\n   * the Success step.\n   *\n   * If an error occurs during sign in (such as invalid credentials)\n   * the authentication state will be updated with that error so that\n   * the responsible component can present it to the user.\n   */\n  public setSignInOTP(otp: string): Promise<void> {\n    return this.appStore._setSignInOTP(otp)\n  }\n\n  /**\n   * Launch a sign in dialog for authenticating a user with\n   * GitHub.com.\n   */\n  public async showDotComSignInDialog(): Promise<void> {\n    await this.appStore._beginDotComSignIn()\n    await this.appStore._showPopup({ type: PopupType.SignIn })\n  }\n\n  /**\n   * Launch a sign in dialog for authenticating a user with\n   * a GitHub Enterprise instance.\n   */\n  public async showEnterpriseSignInDialog(): Promise<void> {\n    await this.appStore._beginEnterpriseSignIn()\n    await this.appStore._showPopup({ type: PopupType.SignIn })\n  }\n\n  /**\n   * Register a new error handler.\n   *\n   * Error handlers are called in order starting with the most recently\n   * registered handler. The error which the returned {Promise} resolves to is\n   * passed to the next handler, etc. If the handler's {Promise} resolves to\n   * null, error propagation is halted.\n   */\n  public registerErrorHandler(handler: ErrorHandler): Disposable {\n    this.errorHandlers.push(handler)\n\n    return new Disposable(() => {\n      const i = this.errorHandlers.indexOf(handler)\n      if (i >= 0) {\n        this.errorHandlers.splice(i, 1)\n      }\n    })\n  }\n\n  /**\n   * Update the location of an existing repository and clear the missing flag.\n   */\n  public async relocateRepository(repository: Repository): Promise<void> {\n    const directories = remote.dialog.showOpenDialog({\n      properties: ['openDirectory'],\n    })\n\n    if (directories && directories.length > 0) {\n      const newPath = directories[0]\n      await this.updateRepositoryPath(repository, newPath)\n    }\n  }\n\n  /** Update the repository's path. */\n  private async updateRepositoryPath(\n    repository: Repository,\n    path: string\n  ): Promise<void> {\n    await this.appStore._updateRepositoryPath(repository, path)\n  }\n\n  public async setAppFocusState(isFocused: boolean): Promise<void> {\n    await this.appStore._setAppFocusState(isFocused)\n  }\n\n  public async dispatchURLAction(action: URLActionType): Promise<void> {\n    switch (action.name) {\n      case 'oauth':\n        try {\n          log.info(`[Dispatcher] requesting authenticated user`)\n          const user = await requestAuthenticatedUser(action.code, action.state)\n          if (user) {\n            resolveOAuthRequest(user)\n          } else if (user === null) {\n            rejectOAuthRequest(new Error('Unable to fetch authenticated user.'))\n          }\n        } catch (e) {\n          rejectOAuthRequest(e)\n        }\n\n        if (__DARWIN__) {\n          // workaround for user reports that the application doesn't receive focus\n          // after completing the OAuth signin in the browser\n          const window = remote.getCurrentWindow()\n          if (!window.isFocused()) {\n            log.info(\n              `refocusing the main window after the OAuth flow is completed`\n            )\n            window.focus()\n          }\n        }\n        break\n\n      case 'open-repository-from-url':\n        const { url } = action\n        const repository = await this.openRepository(url)\n        if (repository) {\n          await this.handleCloneInDesktopOptions(repository, action)\n        } else {\n          log.warn(\n            `Open Repository from URL failed, did not find repository: ${url} - payload: ${JSON.stringify(\n              action\n            )}`\n          )\n        }\n        break\n\n      case 'open-repository-from-path':\n        // user may accidentally provide a folder within the repository\n        // this ensures we use the repository root, if it is actually a repository\n        // otherwise we consider it an untracked repository\n        const path = (await validatedRepositoryPath(action.path)) || action.path\n        const state = this.appStore.getState()\n        let existingRepository = matchExistingRepository(\n          state.repositories,\n          path\n        )\n\n        // in case this is valid git repository, there is no need to ask\n        // user for confirmation and it can be added automatically\n        if (existingRepository == null) {\n          const isRepository = await isGitRepository(path)\n          if (isRepository) {\n            const addedRepositories = await this.addRepositories([path])\n            existingRepository = addedRepositories[0]\n          }\n        }\n\n        if (existingRepository) {\n          await this.selectRepository(existingRepository)\n          this.statsStore.recordAddExistingRepository()\n        } else {\n          await this.showPopup({\n            type: PopupType.AddRepository,\n            path,\n          })\n        }\n        break\n\n      default:\n        const unknownAction: IUnknownAction = action\n        log.warn(\n          `Unknown URL action: ${\n            unknownAction.name\n          } - payload: ${JSON.stringify(unknownAction)}`\n        )\n    }\n  }\n\n  /**\n   * Sets the user's preference so that confirmation to remove repo is not asked\n   */\n  public setConfirmRepoRemovalSetting(value: boolean): Promise<void> {\n    return this.appStore._setConfirmRepositoryRemovalSetting(value)\n  }\n\n  /**\n   * Sets the user's preference so that confirmation to discard changes is not asked\n   */\n  public setConfirmDiscardChangesSetting(value: boolean): Promise<void> {\n    return this.appStore._setConfirmDiscardChangesSetting(value)\n  }\n\n  /**\n   * Sets the user's preference for an external program to open repositories in.\n   */\n  public setExternalEditor(editor: ExternalEditor): Promise<void> {\n    return this.appStore._setExternalEditor(editor)\n  }\n\n  /**\n   * Sets the user's preferred shell.\n   */\n  public setShell(shell: Shell): Promise<void> {\n    return this.appStore._setShell(shell)\n  }\n\n  private async handleCloneInDesktopOptions(\n    repository: Repository,\n    action: IOpenRepositoryFromURLAction\n  ): Promise<void> {\n    const { filepath, pr, branch } = action\n\n    if (pr != null && branch != null) {\n      // we need to refetch for a forked PR and check that out\n      await this.fetchRefspec(repository, `pull/${pr}/head:${branch}`)\n    }\n\n    const state = this.repositoryStateManager.get(repository)\n\n    if (pr == null && branch != null) {\n      const branches = state.branchesState.allBranches\n\n      // I don't want to invoke Git functionality from the dispatcher, which\n      // would help by using getDefaultRemote here to get the definitive ref,\n      // so this falls back to finding any remote branch matching the name\n      // received from the \"Clone in Desktop\" action\n      const localBranch =\n        branches.find(b => b.upstreamWithoutRemote === branch) || null\n\n      if (localBranch == null) {\n        await this.fetch(repository, FetchType.BackgroundTask)\n      }\n    }\n\n    if (branch != null) {\n      let shouldCheckoutBranch = true\n\n      const { tip } = state.branchesState\n\n      if (tip.kind === TipState.Valid) {\n        shouldCheckoutBranch = tip.branch.nameWithoutRemote !== branch\n      }\n\n      if (shouldCheckoutBranch) {\n        await this.checkoutBranch(repository, branch)\n      }\n    }\n\n    if (filepath != null) {\n      const fullPath = Path.join(repository.path, filepath)\n      // because Windows uses different path separators here\n      const normalized = Path.normalize(fullPath)\n      shell.showItemInFolder(normalized)\n    }\n  }\n\n  private async openRepository(url: string): Promise<Repository | null> {\n    const state = this.appStore.getState()\n    const repositories = state.repositories\n    const existingRepository = repositories.find(r => {\n      if (r instanceof Repository) {\n        const gitHubRepository = r.gitHubRepository\n        if (!gitHubRepository) {\n          return false\n        }\n        return gitHubRepository.cloneURL === url\n      } else {\n        return false\n      }\n    })\n\n    if (existingRepository) {\n      return await this.selectRepository(existingRepository)\n    }\n\n    return this.appStore._startOpenInDesktop(() => {\n      this.changeCloneRepositoriesTab(CloneRepositoryTab.Generic)\n      this.showPopup({\n        type: PopupType.CloneRepository,\n        initialURL: url,\n      })\n    })\n  }\n\n  /**\n   * Install the CLI tool.\n   *\n   * This is used only on macOS.\n   */\n  public async installCLI() {\n    try {\n      await installCLI()\n\n      this.showPopup({ type: PopupType.CLIInstalled })\n    } catch (e) {\n      log.error('Error installing CLI', e)\n\n      this.postError(e)\n    }\n  }\n\n  /** Prompt the user to authenticate for a generic git server. */\n  public promptForGenericGitAuthentication(\n    repository: Repository | CloningRepository,\n    retry: RetryAction\n  ): Promise<void> {\n    return this.appStore.promptForGenericGitAuthentication(repository, retry)\n  }\n\n  /** Save the generic git credentials. */\n  public async saveGenericGitCredentials(\n    hostname: string,\n    username: string,\n    password: string\n  ): Promise<void> {\n    log.info(`storing generic credentials for '${hostname}' and '${username}'`)\n    setGenericUsername(hostname, username)\n\n    try {\n      await setGenericPassword(hostname, username, password)\n    } catch (e) {\n      log.error(\n        `Error saving generic git credentials: ${username}@${hostname}`,\n        e\n      )\n\n      this.postError(e)\n    }\n  }\n\n  /** Perform the given retry action. */\n  public async performRetry(retryAction: RetryAction): Promise<void> {\n    switch (retryAction.type) {\n      case RetryActionType.Push:\n        return this.push(retryAction.repository)\n\n      case RetryActionType.Pull:\n        return this.pull(retryAction.repository)\n\n      case RetryActionType.Fetch:\n        return this.fetch(retryAction.repository, FetchType.UserInitiatedTask)\n\n      case RetryActionType.Clone:\n        await this.clone(retryAction.url, retryAction.path, retryAction.options)\n        break\n\n      default:\n        return assertNever(retryAction, `Unknown retry action: ${retryAction}`)\n    }\n  }\n\n  /** Change the selected image diff type. */\n  public changeImageDiffType(type: ImageDiffType): Promise<void> {\n    return this.appStore._changeImageDiffType(type)\n  }\n\n  /** Install the global Git LFS filters. */\n  public installGlobalLFSFilters(force: boolean): Promise<void> {\n    return this.appStore._installGlobalLFSFilters(force)\n  }\n\n  /** Install the LFS filters */\n  public installLFSHooks(\n    repositories: ReadonlyArray<Repository>\n  ): Promise<void> {\n    return this.appStore._installLFSHooks(repositories)\n  }\n\n  /** Change the selected Clone Repository tab. */\n  public changeCloneRepositoriesTab(tab: CloneRepositoryTab): Promise<void> {\n    return this.appStore._changeCloneRepositoriesTab(tab)\n  }\n\n  /** Open the merge tool for the given file. */\n  public openMergeTool(repository: Repository, path: string): Promise<void> {\n    return this.appStore._openMergeTool(repository, path)\n  }\n\n  /** Change the selected Branches foldout tab. */\n  public changeBranchesTab(tab: BranchesTab): Promise<void> {\n    return this.appStore._changeBranchesTab(tab)\n  }\n\n  /**\n   * Open the Create Pull Request page on GitHub after verifying ahead/behind.\n   *\n   * Note that this method will present the user with a dialog in case the\n   * current branch in the repository is ahead or behind the remote.\n   * The dialog lets the user choose whether get in sync with the remote\n   * or open the PR anyway. This is distinct from the\n   * openCreatePullRequestInBrowser method which immediately opens the\n   * create pull request page without showing a dialog.\n   */\n  public createPullRequest(repository: Repository): Promise<void> {\n    return this.appStore._createPullRequest(repository)\n  }\n\n  /**\n   * Show the current pull request on github.com\n   */\n  public showPullRequest(repository: Repository): Promise<void> {\n    return this.appStore._showPullRequest(repository)\n  }\n\n  /**\n   * Immediately open the Create Pull Request page on GitHub.\n   *\n   * See the createPullRequest method for more details.\n   */\n  public openCreatePullRequestInBrowser(\n    repository: Repository,\n    branch: Branch\n  ): Promise<void> {\n    return this.appStore._openCreatePullRequestInBrowser(repository, branch)\n  }\n\n  /**\n   * Update the existing `upstream` remote to point to the repository's parent.\n   */\n  public updateExistingUpstreamRemote(repository: Repository): Promise<void> {\n    return this.appStore._updateExistingUpstreamRemote(repository)\n  }\n\n  /** Ignore the existing `upstream` remote. */\n  public ignoreExistingUpstreamRemote(repository: Repository): Promise<void> {\n    return this.appStore._ignoreExistingUpstreamRemote(repository)\n  }\n\n  /** Checks out a PR whose ref exists locally or in a forked repo. */\n  public async checkoutPullRequest(\n    repository: Repository,\n    pullRequest: PullRequest\n  ): Promise<void> {\n    return this.appStore._checkoutPullRequest(repository, pullRequest)\n  }\n\n  /**\n   * Set whether the user has chosen to hide or show the\n   * co-authors field in the commit message component\n   *\n   * @param repository Co-author settings are per-repository\n   */\n  public setShowCoAuthoredBy(\n    repository: Repository,\n    showCoAuthoredBy: boolean\n  ) {\n    return this.appStore._setShowCoAuthoredBy(repository, showCoAuthoredBy)\n  }\n\n  /**\n   * Update the per-repository co-authors list\n   *\n   * @param repository Co-author settings are per-repository\n   * @param coAuthors  Zero or more authors\n   */\n  public setCoAuthors(\n    repository: Repository,\n    coAuthors: ReadonlyArray<IAuthor>\n  ) {\n    return this.appStore._setCoAuthors(repository, coAuthors)\n  }\n\n  /**\n   * Initialze the compare state for the current repository.\n   */\n  public initializeCompare(\n    repository: Repository,\n    initialAction?: CompareAction\n  ) {\n    return this.appStore._initializeCompare(repository, initialAction)\n  }\n\n  /**\n   * Update the compare state for the current repository\n   */\n  public executeCompare(repository: Repository, action: CompareAction) {\n    return this.appStore._executeCompare(repository, action)\n  }\n\n  /** Update the compare form state for the current repository */\n  public updateCompareForm<K extends keyof ICompareFormUpdate>(\n    repository: Repository,\n    newState: Pick<ICompareFormUpdate, K>\n  ) {\n    return this.appStore._updateCompareForm(repository, newState)\n  }\n\n  /**\n   * Updates the application state to indicate a conflict is in-progress\n   * as a result of a pull and increments the relevant metric.\n   */\n  public mergeConflictDetectedFromPull() {\n    this.appStore._mergeConflictDetected()\n    return this.statsStore.recordMergeConflictFromPull()\n  }\n\n  /**\n   * Updates the application state to indicate a conflict is in-progress\n   * as a result of a merge and increments the relevant metric.\n   */\n  public mergeConflictDetectedFromExplicitMerge() {\n    this.appStore._mergeConflictDetected()\n    return this.statsStore.recordMergeConflictFromExplicitMerge()\n  }\n\n  /**\n   * Increments the `mergeIntoCurrentBranchMenuCount` metric\n   */\n  public recordMenuInitiatedMerge() {\n    return this.statsStore.recordMenuInitiatedMerge()\n  }\n\n  /**\n   * Increments the `updateFromDefaultBranchMenuCount` metric\n   */\n  public recordMenuInitiatedUpdate() {\n    return this.statsStore.recordMenuInitiatedUpdate()\n  }\n\n  /**\n   * Increments the `mergesInitiatedFromComparison` metric\n   */\n  public recordCompareInitiatedMerge() {\n    return this.statsStore.recordCompareInitiatedMerge()\n  }\n\n  /**\n   * Set the application-wide theme\n   */\n  public setSelectedTheme(theme: ApplicationTheme) {\n    return this.appStore._setSelectedTheme(theme)\n  }\n\n  /**\n   * Increments either the `repoWithIndicatorClicked` or\n   * the `repoWithoutIndicatorClicked` metric\n   */\n  public recordRepoClicked(repoHasIndicator: boolean) {\n    return this.statsStore.recordRepoClicked(repoHasIndicator)\n  }\n\n  /** The number of times the user dismisses the diverged branch notification\n   * Increments the `divergingBranchBannerDismissal` metric\n   */\n  public recordDivergingBranchBannerDismissal() {\n    return this.statsStore.recordDivergingBranchBannerDismissal()\n  }\n\n  /**\n   * Increments the `dotcomPushCount` metric\n   */\n  public recordPushToGitHub() {\n    return this.statsStore.recordPushToGitHub()\n  }\n\n  /**\n   * Increments the `enterprisePushCount` metric\n   */\n  public recordPushToGitHubEnterprise() {\n    return this.statsStore.recordPushToGitHubEnterprise()\n  }\n\n  /**\n   * Increments the `externalPushCount` metric\n   */\n  public recordPushToGenericRemote() {\n    return this.statsStore.recordPushToGenericRemote()\n  }\n\n  /**\n   * Increments the `divergingBranchBannerInitiatedCompare` metric\n   */\n  public recordDivergingBranchBannerInitiatedCompare() {\n    return this.statsStore.recordDivergingBranchBannerInitiatedCompare()\n  }\n\n  /**\n   * Increments the `divergingBranchBannerInfluencedMerge` metric\n   */\n  public recordDivergingBranchBannerInfluencedMerge() {\n    return this.statsStore.recordDivergingBranchBannerInfluencedMerge()\n  }\n\n  /**\n   * Increments the `divergingBranchBannerInitatedMerge` metric\n   */\n  public recordDivergingBranchBannerInitatedMerge() {\n    return this.statsStore.recordDivergingBranchBannerInitatedMerge()\n  }\n\n  public recordWelcomeWizardInitiated() {\n    return this.statsStore.recordWelcomeWizardInitiated()\n  }\n\n  public recordCreateRepository() {\n    this.statsStore.recordCreateRepository()\n  }\n\n  public recordAddExistingRepository() {\n    this.statsStore.recordAddExistingRepository()\n  }\n\n  /**\n   * Increments the `recordMergeSuccesfulAfterConflicts` metric\n   */\n  public recordMergeSuccesfulAfterConflicts() {\n    return this.statsStore.recordMergeSuccesAfterConflicts()\n  }\n\n  /**\n   * Increments the `recordMergeAbortedAfterConflicts` metric\n   */\n  public recordMergeAbortedAfterConflicts() {\n    return this.statsStore.recordMergeAbortedAfterConflicts()\n  }\n}\n","export * from './dispatcher'\nexport * from './error-handlers'\n","import * as React from 'react'\nimport { ApplicationTheme, getThemeName } from './lib/application-theme'\n\ninterface IAppThemeProps {\n  readonly theme: ApplicationTheme\n}\n\n/**\n * A pseudo-component responsible for adding the applicable CSS\n * class names to the body tag in order to apply the currently\n * selected theme.\n *\n * This component is a PureComponent, meaning that it'll only\n * render when its props changes (shallow comparison).\n *\n * This component does not render anything into the DOM, it's\n * purely (a)busing the component lifecycle to manipulate the\n * body class list.\n */\nexport class AppTheme extends React.PureComponent<IAppThemeProps> {\n  public componentDidMount() {\n    this.ensureTheme()\n  }\n\n  public componentDidUpdate() {\n    this.ensureTheme()\n  }\n\n  public componentWillUnmount() {\n    this.clearThemes()\n  }\n\n  private ensureTheme() {\n    const newThemeClassName = `theme-${getThemeName(this.props.theme)}`\n    const body = document.body\n\n    if (body.classList.contains(newThemeClassName)) {\n      return\n    }\n\n    this.clearThemes()\n\n    body.classList.add(newThemeClassName)\n  }\n\n  private clearThemes() {\n    const body = document.body\n\n    for (const className of body.classList) {\n      if (className.startsWith('theme-')) {\n        body.classList.remove(className)\n      }\n    }\n  }\n\n  public render() {\n    return null\n  }\n}\n","import * as React from 'react'\nimport { Button } from '../lib/button'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Dialog, DialogContent, DialogFooter } from '../dialog'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { RepositorySectionTab } from '../../lib/app-state'\nimport { Repository } from '../../models/repository'\n\ninterface IMergeConflictsWarningProps {\n  readonly dispatcher: Dispatcher\n  readonly repository: Repository\n  readonly onDismissed: () => void\n}\n\nexport class MergeConflictsWarning extends React.Component<\n  IMergeConflictsWarningProps,\n  {}\n> {\n  private onSubmit = () => {\n    this.props.dispatcher.changeRepositorySection(\n      this.props.repository,\n      RepositorySectionTab.Changes\n    )\n    this.props.onDismissed()\n  }\n\n  public render() {\n    return (\n      <Dialog\n        id=\"merge-conflicts-warning\"\n        title={__DARWIN__ ? 'Merge Conflicts Found' : 'Merge conflicts found'}\n        onDismissed={this.props.onDismissed}\n        onSubmit={this.onSubmit}\n      >\n        <DialogContent>\n          <p>Conflicts were detected as part of the last merge operation.</p>\n          <p>\n            You will need to view and resolve these conflicts via your editor or\n            shell before finishing and creating the merge commit.\n          </p>\n        </DialogContent>\n\n        <DialogFooter>\n          <ButtonGroup>\n            <Button type=\"submit\">\n              {__DARWIN__ ? 'View Conflicts' : 'View conflicts'}\n            </Button>\n            <Button onClick={this.props.onDismissed}>Close</Button>\n          </ButtonGroup>\n        </DialogFooter>\n      </Dialog>\n    )\n  }\n}\n","export * from './merge-conflicts-warning'\n","import * as React from 'react'\n\nimport { Dispatcher } from '../../lib/dispatcher'\n\nimport { Repository } from '../../models/repository'\nimport { Branch } from '../../models/branch'\nimport { PullRequest } from '../../models/pull-request'\n\nimport { Dialog, DialogContent, DialogFooter } from '../dialog'\nimport { Button } from '../lib/button'\nimport { ButtonGroup } from '../lib/button-group'\nimport { LinkButton } from '../lib/link-button'\n\ninterface IDeleteBranchProps {\n  readonly dispatcher: Dispatcher\n  readonly repository: Repository\n  readonly branch: Branch\n  readonly pullRequest: PullRequest\n  readonly onDismissed: () => void\n}\n\nexport class DeletePullRequest extends React.Component<IDeleteBranchProps, {}> {\n  public render() {\n    return (\n      <Dialog\n        id=\"delete-branch\"\n        title={__DARWIN__ ? 'Delete Branch' : 'Delete branch'}\n        type=\"warning\"\n        onDismissed={this.props.onDismissed}\n      >\n        <DialogContent>\n          <p>This branch has an open pull request associated with it.</p>\n          <p>\n            If{' '}\n            <LinkButton onClick={this.openPullRequest}>\n              #{this.props.pullRequest.pullRequestNumber}\n            </LinkButton>{' '}\n            has been merged, you can also remove the remote branch on GitHub.\n          </p>\n        </DialogContent>\n        <DialogFooter>\n          <ButtonGroup destructive={true}>\n            <Button type=\"submit\">Cancel</Button>\n            <Button onClick={this.deleteBranch}>Delete</Button>\n          </ButtonGroup>\n        </DialogFooter>\n      </Dialog>\n    )\n  }\n\n  private openPullRequest = () => {\n    this.props.dispatcher.showPullRequest(this.props.repository)\n  }\n\n  private deleteBranch = () => {\n    this.props.dispatcher.deleteBranch(\n      this.props.repository,\n      this.props.branch,\n      false\n    )\n\n    return this.props.dispatcher.closePopup()\n  }\n}\n","import * as React from 'react'\n\nimport { Octicon, OcticonSymbol } from '../octicons'\nimport { encodePathAsUrl } from '../../lib/path'\n\nimport { ReleaseNote, ReleaseSummary } from '../../models/release-notes'\n\nimport { updateStore } from '../lib/update-store'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Button } from '../lib/button'\n\nimport { Dialog, DialogContent, DialogFooter } from '../dialog'\nimport { DialogHeader } from '../dialog/header'\n\nimport { RichText } from '../lib/rich-text'\nimport { Repository } from '../../models/repository'\nimport { getDotComAPIEndpoint } from '../../lib/api'\n\n// HACK: This is needed because the `Rich`Text` component\n// needs to know what repo to link issues against.\n// Since release notes are Desktop specific, we can't\n// reley on the repo info we keep in state, so we've\n// stubbed out this repo\nconst repository = new Repository(\n  '',\n  -1,\n  {\n    dbID: null,\n    name: 'desktop',\n    owner: {\n      id: null,\n      login: 'desktop',\n      endpoint: getDotComAPIEndpoint(),\n      hash: '',\n    },\n    private: false,\n    parent: null,\n    htmlURL: 'https://github.com/desktop/desktop',\n    defaultBranch: 'master',\n    cloneURL: 'https://github.com/desktop/desktop',\n    endpoint: getDotComAPIEndpoint(),\n    fullName: 'desktop/desktop',\n    fork: false,\n    hash: '',\n  },\n  true\n)\n\nconst ReleaseNoteHeaderLeftUri = encodePathAsUrl(\n  __dirname,\n  'static/release-note-header-left.svg'\n)\nconst ReleaseNoteHeaderRightUri = encodePathAsUrl(\n  __dirname,\n  'static/release-note-header-right.svg'\n)\n\ninterface IReleaseNotesProps {\n  readonly onDismissed: () => void\n  readonly emoji: Map<string, string>\n  readonly newRelease: ReleaseSummary\n}\n\n/**\n * The dialog to show with details about the newest release\n */\nexport class ReleaseNotes extends React.Component<IReleaseNotesProps, {}> {\n  private onCloseButtonClick = (e: React.MouseEvent<HTMLAnchorElement>) => {\n    if (this.props.onDismissed) {\n      this.props.onDismissed()\n    }\n  }\n\n  private renderCloseButton() {\n    // We're intentionally using <a> here instead of <button> because\n    // we can't prevent chromium from giving it focus when the the dialog\n    // appears. Setting tabindex to -1 doesn't work. This might be a bug,\n    // I don't know and we may want to revisit it at some point but for\n    // now an anchor will have to do.\n    return (\n      <a className=\"close\" onClick={this.onCloseButtonClick}>\n        <Octicon symbol={OcticonSymbol.x} />\n      </a>\n    )\n  }\n\n  private renderList(\n    releaseEntries: ReadonlyArray<ReleaseNote>,\n    header: string\n  ): JSX.Element | null {\n    if (releaseEntries.length === 0) {\n      return null\n    }\n\n    const options = new Array<JSX.Element>()\n\n    for (const [i, entry] of releaseEntries.entries()) {\n      options.push(\n        <li key={i}>\n          <RichText\n            text={entry.message}\n            emoji={this.props.emoji}\n            renderUrlsAsLinks={true}\n            repository={repository}\n          />\n        </li>\n      )\n    }\n\n    return (\n      <div className=\"section\">\n        <p className=\"header\">\n          <strong>{header}</strong>\n        </p>\n        <ul className=\"entries\">{options}</ul>\n      </div>\n    )\n  }\n\n  private drawSingleColumnLayout(release: ReleaseSummary): JSX.Element {\n    return (\n      <div className=\"container\">\n        <div className=\"column\">\n          {this.renderList(release.bugfixes, 'Bugfixes')}\n          {this.renderList(release.enhancements, 'Enhancements')}\n          {this.renderList(release.other, 'Other')}\n        </div>\n      </div>\n    )\n  }\n\n  private drawTwoColumnLayout(release: ReleaseSummary): JSX.Element {\n    return (\n      <div className=\"container\">\n        <div className=\"column\">\n          {this.renderList(release.enhancements, 'Enhancements')}\n          {this.renderList(release.other, 'Other')}\n        </div>\n        <div className=\"column\">\n          {this.renderList(release.bugfixes, 'Bugfixes')}\n        </div>\n      </div>\n    )\n  }\n\n  public render() {\n    const release = this.props.newRelease\n\n    const contents =\n      release.enhancements.length > 0 && release.bugfixes.length > 0\n        ? this.drawTwoColumnLayout(release)\n        : this.drawSingleColumnLayout(release)\n\n    return (\n      <Dialog id=\"release-notes\" onDismissed={this.props.onDismissed}>\n        <DialogHeader title={` `} dismissable={false}>\n          <div className=\"release-notes-header\">\n            <img\n              className=\"release-note-graphic-left\"\n              src={ReleaseNoteHeaderLeftUri}\n            />\n            <div className=\"title\">\n              <p className=\"version\">Version {release.latestVersion}</p>\n              <p className=\"date\">{release.datePublished}</p>\n            </div>\n            <img\n              className=\"release-note-graphic-right\"\n              src={ReleaseNoteHeaderRightUri}\n            />\n            {this.renderCloseButton()}\n          </div>\n        </DialogHeader>\n\n        <DialogContent>{contents}</DialogContent>\n        <DialogFooter>\n          <ButtonGroup destructive={true}>\n            <Button type=\"submit\">Close</Button>\n            <Button onClick={this.updateNow}>\n              {__DARWIN__ ? 'Install and Restart' : 'Install and restart'}\n            </Button>\n          </ButtonGroup>\n        </DialogFooter>\n      </Dialog>\n    )\n  }\n\n  private updateNow = () => {\n    updateStore.quitAndInstallUpdate()\n  }\n}\n","export { ReleaseNotes } from './release-notes-dialog'\n","import * as React from 'react'\nimport { Dialog, DialogContent, DialogFooter } from '../dialog'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Button } from '../lib/button'\nimport { Repository } from '../../models/repository'\nimport { IRemote } from '../../models/remote'\nimport { Ref } from '../lib/ref'\nimport { forceUnwrap } from '../../lib/fatal-error'\nimport { UpstreamRemoteName } from '../../lib/stores'\n\ninterface IUpstreamAlreadyExistsProps {\n  readonly repository: Repository\n  readonly existingRemote: IRemote\n\n  readonly onDismissed: () => void\n\n  /** Called when the user chooses to update the existing remote. */\n  readonly onUpdate: (repository: Repository) => void\n\n  /** Called when the user chooses to ignore the warning. */\n  readonly onIgnore: (repository: Repository) => void\n}\n\n/**\n * The dialog shown when a repository is a fork but its upstream remote doesn't\n * point to the parent repository.\n */\nexport class UpstreamAlreadyExists extends React.Component<\n  IUpstreamAlreadyExistsProps\n> {\n  public render() {\n    const name = this.props.repository.name\n    const gitHubRepository = forceUnwrap(\n      'A repository must have a GitHub repository to add an upstream remote',\n      this.props.repository.gitHubRepository\n    )\n    const parent = forceUnwrap(\n      'A repository must have a parent repository to add an upstream remote',\n      gitHubRepository.parent\n    )\n    const parentName = parent.fullName\n    const existingURL = this.props.existingRemote.url\n    const replacementURL = parent.cloneURL\n    return (\n      <Dialog\n        title={\n          __DARWIN__ ? 'Upstream Already Exists' : 'Upstream already exists'\n        }\n        onDismissed={this.props.onDismissed}\n        onSubmit={this.onIgnore}\n        type=\"warning\"\n      >\n        <DialogContent>\n          <p>\n            The repository <Ref>{name}</Ref> is a fork of{' '}\n            <Ref>{parentName}</Ref>, but its <Ref>{UpstreamRemoteName}</Ref>{' '}\n            remote points elsewhere.\n          </p>\n          <ul>\n            <li>\n              Current: <Ref>{existingURL}</Ref>\n            </li>\n            <li>\n              Expected: <Ref>{replacementURL}</Ref>\n            </li>\n          </ul>\n          <p>Would you like to update the remote to use the expected URL?</p>\n        </DialogContent>\n        <DialogFooter>\n          <ButtonGroup destructive={true}>\n            <Button type=\"submit\">Ignore</Button>\n            <Button onClick={this.onUpdate}>Update</Button>\n          </ButtonGroup>\n        </DialogFooter>\n      </Dialog>\n    )\n  }\n\n  private onUpdate = () => {\n    this.props.onUpdate(this.props.repository)\n    this.props.onDismissed()\n  }\n\n  private onIgnore = () => {\n    this.props.onIgnore(this.props.repository)\n    this.props.onDismissed()\n  }\n}\n","export { UpstreamAlreadyExists } from './upstream-already-exists'\n","import * as React from 'react'\nimport { Button } from '../lib/button'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Dialog, DialogContent, DialogFooter } from '../dialog'\nimport { LinkButton } from '../lib/link-button'\nimport { getGlobalConfigPath } from '../../lib/git'\nimport { shell } from '../../lib/app-shell'\n\ninterface IAttributeMismatchProps {\n  /** Called when the dialog should be dismissed. */\n  readonly onDismissed: () => void\n\n  /** Called when the user has chosen to replace the update filters. */\n  readonly onUpdateExistingFilters: () => void\n}\n\ninterface IAttributeMismatchState {\n  readonly globalGitConfigPath: string | null\n}\n\nexport class AttributeMismatch extends React.Component<\n  IAttributeMismatchProps,\n  IAttributeMismatchState\n> {\n  public constructor(props: IAttributeMismatchProps) {\n    super(props)\n\n    this.state = {\n      globalGitConfigPath: null,\n    }\n  }\n\n  public async componentDidMount() {\n    try {\n      const path = await getGlobalConfigPath()\n      this.setState({ globalGitConfigPath: path })\n    } catch (error) {\n      log.warn(`Couldn't get the global git config path`, error)\n    }\n  }\n\n  private renderGlobalGitConfigLink() {\n    const path = this.state.globalGitConfigPath\n    const msg = 'your global git config'\n    if (path) {\n      return <LinkButton onClick={this.showGlobalGitConfig}>{msg}</LinkButton>\n    } else {\n      return msg\n    }\n  }\n\n  private showGlobalGitConfig = () => {\n    const path = this.state.globalGitConfigPath\n    if (path) {\n      shell.openItem(path)\n    }\n  }\n\n  public render() {\n    return (\n      <Dialog\n        id=\"lfs-attribute-mismatch\"\n        title={\n          __DARWIN__\n            ? 'Update Existing Git LFS Filters?'\n            : 'Update existing Git LFS filters?'\n        }\n        onDismissed={this.props.onDismissed}\n        onSubmit={this.props.onUpdateExistingFilters}\n      >\n        <DialogContent>\n          <p>\n            Git LFS filters are already configured in{' '}\n            {this.renderGlobalGitConfigLink()} but are not the values it\n            expects. Would you like to update them now?\n          </p>\n        </DialogContent>\n\n        <DialogFooter>\n          <ButtonGroup>\n            <Button type=\"submit\">\n              {__DARWIN__\n                ? 'Update Existing Filters'\n                : 'Update existing filters'}\n            </Button>\n            <Button onClick={this.props.onDismissed}>\n              {__DARWIN__ ? 'Not Now' : 'Not now'}\n            </Button>\n          </ButtonGroup>\n        </DialogFooter>\n      </Dialog>\n    )\n  }\n}\n","import * as React from 'react'\nimport { Repository } from '../../models/repository'\nimport { Button } from '../lib/button'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Dialog, DialogContent, DialogFooter } from '../dialog'\nimport { Monospaced } from '../lib/monospaced'\nimport { PathText } from '../lib/path-text'\nimport { LinkButton } from '../lib/link-button'\n\nconst LFSURL = 'https://git-lfs.github.com/'\n\n/**\n * If we're initializing any more than this number, we won't bother listing them\n * all.\n */\nconst MaxRepositoriesToList = 10\n\ninterface IInitializeLFSProps {\n  /** The repositories in which LFS needs to be initialized. */\n  readonly repositories: ReadonlyArray<Repository>\n\n  /**\n   * Event triggered when the dialog is dismissed by the user in the\n   * ways described in the Dialog component's dismissable prop.\n   */\n  readonly onDismissed: () => void\n\n  /**\n   * Called when the user chooses to initialize LFS in the repositories.\n   */\n  readonly onInitialize: (repositories: ReadonlyArray<Repository>) => void\n}\n\nexport class InitializeLFS extends React.Component<IInitializeLFSProps, {}> {\n  public render() {\n    return (\n      <Dialog\n        id=\"initialize-lfs\"\n        title=\"Initialize Git LFS\"\n        onDismissed={this.props.onDismissed}\n        onSubmit={this.onInitialize}\n      >\n        <DialogContent>{this.renderRepositories()}</DialogContent>\n\n        <DialogFooter>\n          <ButtonGroup>\n            <Button type=\"submit\">Initialize Git LFS</Button>\n            <Button onClick={this.props.onDismissed}>\n              {__DARWIN__ ? 'Not Now' : 'Not now'}\n            </Button>\n          </ButtonGroup>\n        </DialogFooter>\n      </Dialog>\n    )\n  }\n\n  private onInitialize = () => {\n    this.props.onInitialize(this.props.repositories)\n  }\n\n  private renderRepositories() {\n    if (this.props.repositories.length > MaxRepositoriesToList) {\n      return (\n        <p>\n          {this.props.repositories.length} repositories use{' '}\n          <LinkButton uri={LFSURL}>Git LFS</LinkButton>. To contribute to them,\n          Git LFS must first be initialized. Would you like to do so now?\n        </p>\n      )\n    } else {\n      const plural = this.props.repositories.length !== 1\n      const pluralizedRepositories = plural\n        ? 'The repositories use'\n        : 'This repository uses'\n      const pluralizedUse = plural ? 'them' : 'it'\n      return (\n        <div>\n          <p>\n            {pluralizedRepositories}{' '}\n            <LinkButton uri={LFSURL}>Git LFS</LinkButton>. To contribute to{' '}\n            {pluralizedUse}, Git LFS must first be initialized. Would you like\n            to do so now?\n          </p>\n          <ul>\n            {this.props.repositories.map(r => (\n              <li key={r.id}>\n                <Monospaced>\n                  <PathText path={r.path} />\n                </Monospaced>\n              </li>\n            ))}\n          </ul>\n        </div>\n      )\n    }\n  }\n}\n","export { InitializeLFS } from './initialize-lfs'\nexport { AttributeMismatch } from './attribute-mismatch'\n","import * as React from 'react'\n\nimport { Button } from '../lib/button'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Dialog, DialogContent, DialogFooter } from '../dialog'\n\ninterface IShellErrorProps {\n  /**\n   * Event triggered when the dialog is dismissed by the user in the\n   * ways described in the Dialog component's dismissable prop.\n   */\n  readonly onDismissed: () => void\n\n  /**\n   * Event to trigger if the user navigates to the Preferences dialog\n   */\n  readonly showPreferencesDialog: () => void\n\n  /**\n   * The text to display to the user relating to this error.\n   */\n  readonly message: string\n}\n\n/**\n * A dialog indicating something went wrong with launching their preferred\n * shell.\n */\nexport class ShellError extends React.Component<IShellErrorProps, {}> {\n  private onShowPreferencesDialog = () => {\n    this.props.onDismissed()\n    this.props.showPreferencesDialog()\n  }\n\n  public render() {\n    const title = __DARWIN__ ? 'Unable to Open Shell' : 'Unable to open shell'\n    return (\n      <Dialog\n        id=\"shell-error\"\n        type=\"error\"\n        title={title}\n        onSubmit={this.props.onDismissed}\n        onDismissed={this.props.onDismissed}\n      >\n        <DialogContent>\n          <p>{this.props.message}</p>\n        </DialogContent>\n        <DialogFooter>\n          <ButtonGroup>\n            <Button type=\"submit\" onClick={this.props.onDismissed}>\n              Close\n            </Button>\n            <Button onClick={this.onShowPreferencesDialog}>\n              {__DARWIN__ ? 'Open Preferences' : 'Open options'}\n            </Button>\n          </ButtonGroup>\n        </DialogFooter>\n      </Dialog>\n    )\n  }\n}\n","export { ShellError } from './shell-error'\n","import * as React from 'react'\n\nimport { TextBox } from '../lib/text-box'\nimport { Row } from '../lib/row'\nimport { Button } from '../lib/button'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Dialog, DialogContent, DialogFooter } from '../dialog'\nimport { Monospaced } from '../lib/monospaced'\nimport { RetryAction } from '../../lib/retry-actions'\n\ninterface IGenericGitAuthenticationProps {\n  /** The hostname with which the user tried to authenticate. */\n  readonly hostname: string\n\n  /** The function to call when the user saves their credentials. */\n  readonly onSave: (\n    hostname: string,\n    username: string,\n    password: string,\n    retryAction: RetryAction\n  ) => void\n\n  /** The function to call when the user dismisses the dialog. */\n  readonly onDismiss: () => void\n\n  /** The action to retry after getting credentials. */\n  readonly retryAction: RetryAction\n}\n\ninterface IGenericGitAuthenticationState {\n  readonly username: string\n  readonly password: string\n}\n\n/** Shown to enter the credentials to authenticate to a generic git server. */\nexport class GenericGitAuthentication extends React.Component<\n  IGenericGitAuthenticationProps,\n  IGenericGitAuthenticationState\n> {\n  public constructor(props: IGenericGitAuthenticationProps) {\n    super(props)\n\n    this.state = { username: '', password: '' }\n  }\n\n  public render() {\n    const disabled = !this.state.password.length && !this.state.username.length\n    return (\n      <Dialog\n        id=\"generic-git-auth\"\n        title={__DARWIN__ ? `Authentication Failed` : `Authentication failed`}\n        onDismissed={this.props.onDismiss}\n        onSubmit={this.save}\n      >\n        <DialogContent>\n          <p>\n            We were unable to authenticate with{' '}\n            <Monospaced>{this.props.hostname}</Monospaced>. Please enter your\n            username and password to try again.\n          </p>\n\n          <Row>\n            <TextBox\n              label=\"Username\"\n              autoFocus={true}\n              value={this.state.username}\n              onValueChanged={this.onUsernameChange}\n            />\n          </Row>\n\n          <Row>\n            <TextBox\n              label=\"Password\"\n              type=\"password\"\n              value={this.state.password}\n              onValueChanged={this.onPasswordChange}\n            />\n          </Row>\n        </DialogContent>\n\n        <DialogFooter>\n          <ButtonGroup>\n            <Button type=\"submit\" disabled={disabled}>\n              {__DARWIN__ ? 'Save and Retry' : 'Save and retry'}\n            </Button>\n            <Button onClick={this.props.onDismiss}>Cancel</Button>\n          </ButtonGroup>\n        </DialogFooter>\n      </Dialog>\n    )\n  }\n\n  private onUsernameChange = (value: string) => {\n    this.setState({ username: value })\n  }\n\n  private onPasswordChange = (value: string) => {\n    this.setState({ password: value })\n  }\n\n  private save = () => {\n    this.props.onSave(\n      this.props.hostname,\n      this.state.username,\n      this.state.password,\n      this.props.retryAction\n    )\n  }\n}\n","export { GenericGitAuthentication } from './generic-git-auth'\n","const path = require('path');const filePath = path.join(__dirname, \"runas.node\");try { global.process.dlopen(module, filePath); } catch(exception) { throw new Error('Cannot open ' + filePath + ': ' + exception); }","(function() {\n  var runas, searchCommand;\n\n  runas = require('../build/Release/runas.node');\n\n  searchCommand = function(command) {\n    var e, filename, fs, p, path, paths, _i, _len;\n    if (command[0] === '/') {\n      return command;\n    }\n    fs = require('fs');\n    path = require('path');\n    paths = process.env.PATH.split(path.delimiter);\n    for (_i = 0, _len = paths.length; _i < _len; _i++) {\n      p = paths[_i];\n      try {\n        filename = path.join(p, command);\n        if (fs.statSync(filename).isFile()) {\n          return filename;\n        }\n      } catch (_error) {\n        e = _error;\n      }\n    }\n    return '';\n  };\n\n  module.exports = function(command, args, options) {\n    if (args == null) {\n      args = [];\n    }\n    if (options == null) {\n      options = {};\n    }\n    if (options.hide == null) {\n      options.hide = true;\n    }\n    if (options.admin == null) {\n      options.admin = false;\n    }\n    if (process.platform === 'darwin' && options.admin === true) {\n      command = searchCommand(command);\n    }\n    return runas.runas(command, args, options);\n  };\n\n}).call(this);\n","import * as React from 'react'\nimport { Button } from '../lib/button'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Dialog, DialogContent, DialogFooter } from '../dialog'\nimport { InstalledCLIPath } from '../lib/install-cli'\n\ninterface ICLIInstalledProps {\n  /** Called when the popup should be dismissed. */\n  readonly onDismissed: () => void\n}\n\n/** Tell the user the CLI tool was successfully installed. */\nexport class CLIInstalled extends React.Component<ICLIInstalledProps, {}> {\n  public render() {\n    return (\n      <Dialog\n        title={\n          __DARWIN__\n            ? 'Command Line Tool Installed'\n            : 'Command line tool installed'\n        }\n        onDismissed={this.props.onDismissed}\n        onSubmit={this.props.onDismissed}\n      >\n        <DialogContent>\n          <div>\n            The command line tool has been installed at{' '}\n            <strong>{InstalledCLIPath}</strong>.\n          </div>\n        </DialogContent>\n        <DialogFooter>\n          <ButtonGroup>\n            <Button type=\"submit\">OK</Button>\n          </ButtonGroup>\n        </DialogFooter>\n      </Dialog>\n    )\n  }\n}\n","export { CLIInstalled } from './cli-installed'\n","import * as React from 'react'\nimport { Dialog, DialogContent, DialogFooter } from '../dialog'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Button } from '../lib/button'\nimport { LinkButton } from '../lib/link-button'\n\ninterface ITermsAndConditionsProps {\n  /** A function called when the dialog is dismissed. */\n  readonly onDismissed: () => void\n}\n\nconst contact = 'https://github.com/contact'\nconst logos = 'https://github.com/logos'\nconst privacyStatement =\n  'https://help.github.com/articles/github-privacy-statement/'\nconst license = 'https://creativecommons.org/licenses/by/4.0/'\n\nexport class TermsAndConditions extends React.Component<\n  ITermsAndConditionsProps,\n  {}\n> {\n  private dialogContainerRef: HTMLDivElement | null = null\n  private closeButtonRef: HTMLButtonElement | null = null\n\n  private onDialogContainerRef = (element: HTMLDivElement | null) => {\n    this.dialogContainerRef = element\n  }\n\n  private onCloseButtonRef = (element: HTMLButtonElement | null) => {\n    this.closeButtonRef = element\n  }\n\n  public componentDidMount() {\n    // When the dialog is mounted it automatically moves focus to the first\n    // focusable element which in this case is a link far down in the terms\n    // and conditions which will cause the contents to scroll down. We don't\n    // want that so let's just reset it.\n    if (this.dialogContainerRef) {\n      this.dialogContainerRef.scrollTop = 0\n    }\n\n    // And let's just move focus to the close button.\n    if (this.closeButtonRef) {\n      this.closeButtonRef.focus()\n    }\n  }\n\n  public render() {\n    return (\n      <Dialog\n        id=\"terms-and-conditions\"\n        title=\"GitHub Open Source Applications Terms and Conditions\"\n        onSubmit={this.props.onDismissed}\n        onDismissed={this.props.onDismissed}\n      >\n        <DialogContent onRef={this.onDialogContainerRef}>\n          <p>\n            These GitHub Open Source Applications Terms and Conditions\n            (\"Application Terms\") are a legal agreement between you (either as\n            an individual or on behalf of an entity) and GitHub, Inc. regarding\n            your use of GitHub's applications, such as GitHub Desktop and\n            associated documentation (\"Software\"). These Application Terms apply\n            to the executable code version of the Software. Source code for the\n            Software is available separately and free of charge under open\n            source software license agreements. If you do not agree to all of\n            the terms in these Application Terms, do not download, install, use,\n            or copy the Software.\n          </p>\n\n          <h2>Connecting to GitHub</h2>\n\n          <p>\n            If you configure the Software to work with one or more accounts on\n            the GitHub.com website or with an instance of GitHub Enterprise,\n            your use of the Software will also be governed your applicable\n            GitHub.com website Terms of Service and/or the license agreement\n            applicable to your instance of GitHub Enterprise (\"GitHub Terms\").\n          </p>\n\n          <p>\n            Any use of the Software that violates your applicable GitHub Terms\n            will also be a violation of these Application Terms.\n          </p>\n\n          <h2>Open Source Licenses and Notices</h2>\n\n          <p>\n            The open source license for the Software is included in the \"Open\n            Source Notices\" documentation that is included with the Software.\n            That documentation also includes copies of all applicable open\n            source licenses.\n          </p>\n\n          <p>\n            To the extent the terms of the licenses applicable to open source\n            components require GitHub to make an offer to provide source code in\n            connection with the Software, such offer is hereby made, and you may\n            exercise it by contacting GitHub:{' '}\n            <LinkButton uri={contact}>contact</LinkButton>.\n          </p>\n\n          <p>\n            Unless otherwise agreed to in writing with GitHub, your agreement\n            with GitHub will always include, at a minimum, these Application\n            Terms. Open source software licenses for the Software's source code\n            constitute separate written agreements. To the limited extent that\n            the open source software licenses expressly supersede these\n            Application Terms, the open source licenses govern your agreement\n            with GitHub for the use of the Software or specific included\n            components of the Software.\n          </p>\n\n          <h2>GitHub's Logos</h2>\n\n          <p>\n            The license grant included with the Software is not for GitHub's\n            trademarks, which include the Software logo designs. GitHub reserves\n            all trademark and copyright rights in and to all GitHub trademarks.\n            GitHub's logos include, for instance, the stylized designs that\n            include \"logo\" in the file title in the \"logos\" folder.\n          </p>\n\n          <p>\n            The names GitHub, GitHub Desktop, GitHub for Mac, GitHub for\n            Windows, Atom, the Octocat, and related GitHub logos and/or stylized\n            names are trademarks of GitHub. You agree not to display or use\n            these trademarks in any manner without GitHub's prior, written\n            permission, except as allowed by GitHub's Logos and Usage Policy:{' '}\n            <LinkButton uri={logos}>logos</LinkButton>.\n          </p>\n\n          <h2>Privacy</h2>\n\n          <p>\n            The Software may collect personal information. You may control what\n            information the Software collects in the settings panel. If the\n            Software does collect personal information on GitHub's behalf,\n            GitHub will process that information in accordance with the\n            <LinkButton uri={privacyStatement}>\n              GitHub Privacy Statement\n            </LinkButton>\n            .\n          </p>\n\n          <h2>Additional Services</h2>\n\n          <h3>Auto-Update Services</h3>\n\n          <p>\n            The Software may include an auto-update service (\"Service\"). If you\n            choose to use the Service or you download Software that\n            automatically enables the Service, GitHub will automatically update\n            the Software when a new version is available.\n          </p>\n\n          <h3>Disclaimers and Limitations of Liability</h3>\n\n          <p>\n            THE SERVICE IS PROVIDED ON AN \"AS IS\" BASIS, AND NO WARRANTY, EITHER\n            EXPRESS OR IMPLIED, IS GIVEN. YOUR USE OF THE SERVICE IS AT YOUR\n            SOLE RISK. GitHub does not warrant that (i) the Service will meet\n            your specific requirements; (ii) the Service is fully compatible\n            with any particular platform; (iii) your use of the Service will be\n            uninterrupted, timely, secure, or error-free; (iv) the results that\n            may be obtained from the use of the Service will be accurate or\n            reliable; (v) the quality of any products, services, information, or\n            other material purchased or obtained by you through the Service will\n            meet your expectations; or (vi) any errors in the Service will be\n            corrected.\n          </p>\n\n          <p>\n            YOU EXPRESSLY UNDERSTAND AND AGREE THAT GITHUB SHALL NOT BE LIABLE\n            FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, CONSEQUENTIAL OR\n            EXEMPLARY DAMAGES, INCLUDING BUT NOT LIMITED TO, DAMAGES FOR LOSS OF\n            PROFITS, GOODWILL, USE, DATA OR OTHER INTANGIBLE LOSSES (EVEN IF\n            GITHUB HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES) RELATED\n            TO THE SERVICE, including, for example: (i) the use or the inability\n            to use the Service; (ii) the cost of procurement of substitute goods\n            and services resulting from any goods, data, information or services\n            purchased or obtained or messages received or transactions entered\n            into through or from the Service; (iii) unauthorized access to or\n            alteration of your transmissions or data; (iv) statements or conduct\n            of any third-party on the Service; (v) or any other matter relating\n            to the Service.\n          </p>\n\n          <p>\n            GitHub reserves the right at any time and from time to time to\n            modify or discontinue, temporarily or permanently, the Service (or\n            any part thereof) with or without notice. GitHub shall not be liable\n            to you or to any third-party for any price change, suspension or\n            discontinuance of the Service.\n          </p>\n\n          <h2>Miscellanea</h2>\n\n          <ol>\n            <li>\n              No Waiver. The failure of GitHub to exercise or enforce any right\n              or provision of these Application Terms shall not constitute a\n              waiver of such right or provision.\n            </li>\n\n            <li>\n              Entire Agreement. These Application Terms, together with any\n              applicable Privacy Notices, constitutes the entire agreement\n              between you and GitHub and governs your use of the Software,\n              superseding any prior agreements between you and GitHub\n              (including, but not limited to, any prior versions of the\n              Application Terms).\n            </li>\n\n            <li>\n              Governing Law. You agree that these Application Terms and your use\n              of the Software are governed under California law and any dispute\n              related to the Software must be brought in a tribunal of competent\n              jurisdiction located in or near San Francisco, California.\n            </li>\n\n            <li>\n              Third-Party Packages. The Software supports third-party \"Packages\"\n              which may modify, add, remove, or alter the functionality of the\n              Software. These Packages are not covered by these Application\n              Terms and may include their own license which governs your use of\n              that particular package.\n            </li>\n\n            <li>\n              No Modifications; Complete Agreement. These Application Terms may\n              only be modified by a written amendment signed by an authorized\n              representative of GitHub, or by the posting by GitHub of a revised\n              version. These Application Terms, together with any applicable\n              Open Source Licenses and Notices and GitHub's Privacy Statement,\n              represent the complete and exclusive statement of the agreement\n              between you and us. These Application Terms supersede any proposal\n              or prior agreement oral or written, and any other communications\n              between you and GitHub relating to the subject matter of these\n              terms.\n            </li>\n\n            <li>\n              License to GitHub Policies. These Application Terms are licensed\n              under the{' '}\n              <LinkButton uri={license}>\n                Creative Commons Attribution license\n              </LinkButton>\n              . You may use it freely under the terms of the Creative Commons\n              license.\n            </li>\n\n            <li>\n              Contact Us. Please send any questions about these Application\n              Terms to <LinkButton uri={contact}>support@github.com</LinkButton>\n              .\n            </li>\n          </ol>\n        </DialogContent>\n\n        <DialogFooter>\n          <ButtonGroup>\n            <Button type=\"submit\" onButtonRef={this.onCloseButtonRef}>\n              Close\n            </Button>\n          </ButtonGroup>\n        </DialogFooter>\n      </Dialog>\n    )\n  }\n}\n","export { TermsAndConditions } from './terms-and-conditions'\n","import * as React from 'react'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Button } from '../lib/button'\nimport { Checkbox, CheckboxValue } from '../lib/checkbox'\nimport { Dialog, DialogContent, DialogFooter } from '../dialog'\nimport { Ref } from '../lib/ref'\nimport { Repository } from '../../models/repository'\nimport { TrashNameLabel } from '../lib/context-menu'\n\ninterface IConfirmRemoveRepositoryProps {\n  /** The repository to be removed */\n  readonly repository: Repository\n\n  /** The action to execute when the user confirms */\n  readonly onConfirmation: (\n    repo: Repository,\n    deleteRepoFromDisk: boolean\n  ) => void\n\n  /** The action to execute when the user cancels */\n  readonly onDismissed: () => void\n}\n\ninterface IConfirmRemoveRepositoryState {\n  readonly deleteRepoFromDisk: boolean\n}\n\nexport class ConfirmRemoveRepository extends React.Component<\n  IConfirmRemoveRepositoryProps,\n  IConfirmRemoveRepositoryState\n> {\n  public constructor(props: IConfirmRemoveRepositoryProps) {\n    super(props)\n\n    this.state = {\n      deleteRepoFromDisk: false,\n    }\n  }\n\n  private cancel = () => {\n    this.props.onDismissed()\n  }\n\n  private onConfirmed = () => {\n    this.props.onConfirmation(\n      this.props.repository,\n      this.state.deleteRepoFromDisk\n    )\n\n    this.props.onDismissed()\n  }\n\n  public render() {\n    return (\n      <Dialog\n        id=\"confirm-remove-repository\"\n        key=\"remove-repository-confirmation\"\n        type=\"warning\"\n        title={__DARWIN__ ? 'Remove Repository' : 'Remove repository'}\n        onDismissed={this.cancel}\n        onSubmit={this.cancel}\n      >\n        <DialogContent>\n          <p>\n            Are you sure you want to remove the repository \"\n            {this.props.repository.name}\n            \"?\n          </p>\n          <p className=\"description\">\n            The repository will be removed from GitHub Desktop:\n            <br />\n            <Ref>{this.props.repository.path}</Ref>\n          </p>\n\n          <div>\n            <Checkbox\n              label={'Also move this repository to ' + TrashNameLabel}\n              value={\n                this.state.deleteRepoFromDisk\n                  ? CheckboxValue.On\n                  : CheckboxValue.Off\n              }\n              onChange={this.onConfirmRepositoryDeletion}\n            />\n          </div>\n        </DialogContent>\n        <DialogFooter>\n          <ButtonGroup destructive={true}>\n            <Button type=\"submit\">Cancel</Button>\n            <Button onClick={this.onConfirmed}>Remove</Button>\n          </ButtonGroup>\n        </DialogFooter>\n      </Dialog>\n    )\n  }\n\n  private onConfirmRepositoryDeletion = (\n    event: React.FormEvent<HTMLInputElement>\n  ) => {\n    const value = event.currentTarget.checked\n\n    this.setState({ deleteRepoFromDisk: value })\n  }\n}\n","export { ConfirmRemoveRepository } from './confirm-remove-repository'\n","import * as React from 'react'\nimport { encodePathAsUrl } from '../../lib/path'\nimport { UiView } from '../ui-view'\nimport { Button } from '../lib/button'\nimport { Octicon, OcticonSymbol } from '../octicons'\n\ninterface IBlankSlateProps {\n  /** A function to call when the user chooses to create a repository. */\n  readonly onCreate: () => void\n\n  /** A function to call when the user chooses to clone a repository. */\n  readonly onClone: () => void\n\n  /** A function to call when the user chooses to add a local repository. */\n  readonly onAdd: () => void\n}\n\nconst BlankSlateImageUrl = encodePathAsUrl(\n  __dirname,\n  'static/empty-no-repo.svg'\n)\n\nconst ImageStyle: React.CSSProperties = {\n  backgroundImage: `url(${BlankSlateImageUrl})`,\n}\n\n/**\n * The blank slate view. This is shown when the user hasn't added any\n * repositories to the app.\n */\nexport class BlankSlateView extends React.Component<IBlankSlateProps, {}> {\n  public render() {\n    return (\n      <UiView id=\"blank-slate\">\n        <div className=\"blankslate-image\" style={ImageStyle} />\n\n        <div className=\"content\">\n          <div className=\"title\">\n            {__DARWIN__ ? 'No Repositories Found' : 'No repositories found'}\n          </div>\n\n          <div className=\"callouts\">\n            <div className=\"callout\">\n              <Octicon symbol={OcticonSymbol.plus} />\n              <div>Create a new project and publish it to GitHub</div>\n              <Button onClick={this.props.onCreate}>\n                {__DARWIN__ ? 'Create New Repository' : 'Create new repository'}\n              </Button>\n            </div>\n\n            <div className=\"callout\">\n              <Octicon symbol={OcticonSymbol.deviceDesktop} />\n              <div>\n                Add an existing project on your computer and publish it to\n                GitHub\n              </div>\n              <Button onClick={this.props.onAdd}>\n                {__DARWIN__\n                  ? 'Add a Local Repository'\n                  : 'Add a local repository'}\n              </Button>\n            </div>\n\n            <div className=\"callout\">\n              <Octicon symbol={OcticonSymbol.repoClone} />\n              <div>Clone an existing project from GitHub to your computer</div>\n              <Button onClick={this.props.onClone}>\n                {__DARWIN__ ? 'Clone a Repository' : 'Clone a repository'}\n              </Button>\n            </div>\n          </div>\n        </div>\n\n        <p className=\"footer\">\n          Alternatively, you can drag and drop a local repository here to add\n          it.\n        </p>\n      </UiView>\n    )\n  }\n}\n","export { BlankSlateView } from './blank-slate'\n","import * as React from 'react'\nimport * as URL from 'url'\nimport { Button } from '../lib/button'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Dialog, DialogContent, DialogFooter } from '../dialog'\n\ninterface IUntrustedCertificateProps {\n  /** The untrusted certificate. */\n  readonly certificate: Electron.Certificate\n\n  /** The URL which was being accessed. */\n  readonly url: string\n\n  /** The function to call when the user chooses to dismiss the dialog. */\n  readonly onDismissed: () => void\n\n  /**\n   * The function to call when the user chooses to continue in the process of\n   * trusting the certificate.\n   */\n  readonly onContinue: (certificate: Electron.Certificate) => void\n}\n\n/**\n * The dialog we display when an API request encounters an untrusted\n * certificate.\n */\nexport class UntrustedCertificate extends React.Component<\n  IUntrustedCertificateProps,\n  {}\n> {\n  public render() {\n    const host = URL.parse(this.props.url).hostname\n    const type = __DARWIN__ ? 'warning' : 'error'\n    const buttonGroup = __DARWIN__ ? (\n      <ButtonGroup destructive={true}>\n        <Button type=\"submit\">Cancel</Button>\n        <Button onClick={this.onContinue}>View Certificate</Button>\n      </ButtonGroup>\n    ) : (\n      <ButtonGroup>\n        <Button type=\"submit\">Close</Button>\n        <Button onClick={this.onContinue}>Add certificate</Button>\n      </ButtonGroup>\n    )\n    return (\n      <Dialog\n        title={__DARWIN__ ? 'Untrusted Server' : 'Untrusted server'}\n        onDismissed={this.props.onDismissed}\n        onSubmit={this.props.onDismissed}\n        type={type}\n      >\n        <DialogContent>\n          <p>\n            GitHub Desktop cannot verify the identity of {host}. The certificate\n            ({this.props.certificate.subjectName}) is invalid or untrusted.{' '}\n            <strong>\n              This may indicate attackers are trying to steal your data.\n            </strong>\n          </p>\n          <p>In some cases, this may be expected. For example:</p>\n          <ul>\n            <li>If this is a GitHub Enterprise trial.</li>\n            <li>\n              If your GitHub Enterprise instance is run on an unusual top-level\n              domain.\n            </li>\n          </ul>\n          <p>\n            If you are unsure of what to do, cancel and contact your system\n            administrator.\n          </p>\n        </DialogContent>\n        <DialogFooter>{buttonGroup}</DialogFooter>\n      </Dialog>\n    )\n  }\n\n  private onContinue = () => {\n    this.props.onContinue(this.props.certificate)\n  }\n}\n","export { UntrustedCertificate } from './untrusted-certificate'\n","import * as Path from 'path'\nimport * as Fs from 'fs'\nimport * as React from 'react'\nimport { getAppPath } from '../lib/app-proxy'\nimport { Loading } from '../lib/loading'\nimport { Button } from '../lib/button'\nimport { LinkButton } from '../lib/link-button'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Dialog, DialogContent, DialogFooter } from '../dialog'\n\nconst WebsiteURL = 'https://desktop.github.com'\nconst RepositoryURL = 'https://github.com/desktop/desktop'\n\ninterface IAcknowledgementsProps {\n  /** The function to call when the dialog should be dismissed. */\n  readonly onDismissed: () => void\n\n  /**\n   * The currently installed (and running) version of the app.\n   */\n  readonly applicationVersion: string\n}\n\ninterface ILicense {\n  readonly repository?: string\n  readonly sourceText?: string\n  readonly license?: string\n}\n\ntype Licenses = { [key: string]: ILicense }\n\ninterface IAcknowledgementsState {\n  readonly licenses: Licenses | null\n}\n\n/** The component which displays the licenses for packages used in the app. */\nexport class Acknowledgements extends React.Component<\n  IAcknowledgementsProps,\n  IAcknowledgementsState\n> {\n  public constructor(props: IAcknowledgementsProps) {\n    super(props)\n\n    this.state = { licenses: null }\n  }\n\n  public componentDidMount() {\n    const path = Path.join(getAppPath(), 'static', 'licenses.json')\n    Fs.readFile(path, 'utf8', (err, data) => {\n      if (err) {\n        console.error('Error loading licenses')\n        console.error(err)\n        return\n      }\n\n      const parsed = JSON.parse(data)\n      if (!parsed) {\n        console.error(`Couldn't parse licenses!`)\n        return\n      }\n\n      this.setState({ licenses: parsed })\n    })\n  }\n\n  private renderLicenses(licenses: Licenses) {\n    const elements = []\n    for (const [index, key] of Object.keys(licenses)\n      .sort()\n      .entries()) {\n      // The first entry is Desktop itself. We don't need to thank us.\n      if (index === 0) {\n        continue\n      }\n\n      const license = licenses[key]\n      const repository = license.repository\n      let nameElement\n\n      if (repository) {\n        const uri = normalizedGitHubURL(repository)\n        nameElement = <LinkButton uri={uri}>{key}</LinkButton>\n      } else {\n        nameElement = key\n      }\n\n      let licenseText\n\n      if (license.sourceText) {\n        licenseText = license.sourceText\n      } else if (license.license) {\n        licenseText = `License: ${license.license}`\n      } else {\n        licenseText = 'Unknown license'\n      }\n\n      const nameHeader = <h2 key={`${key}-header`}>{nameElement}</h2>\n      const licenseParagraph = (\n        <p key={`${key}-text`} className=\"license-text\">\n          {licenseText}\n        </p>\n      )\n\n      elements.push(nameHeader, licenseParagraph)\n    }\n\n    return elements\n  }\n\n  public render() {\n    const licenses = this.state.licenses\n\n    let desktopLicense: JSX.Element | null = null\n    if (licenses) {\n      const key = `desktop@${this.props.applicationVersion}`\n      const entry = licenses[key]\n      desktopLicense = <p className=\"license-text\">{entry.sourceText}</p>\n    }\n\n    return (\n      <Dialog\n        id=\"acknowledgements\"\n        title=\"License and Open Source Notices\"\n        onSubmit={this.props.onDismissed}\n        onDismissed={this.props.onDismissed}\n      >\n        <DialogContent>\n          <p>\n            <LinkButton uri={WebsiteURL}>GitHub Desktop</LinkButton> is an open\n            source project published under the MIT License. You can view the\n            source code and contribute to this project on{' '}\n            <LinkButton uri={RepositoryURL}>GitHub</LinkButton>.\n          </p>\n\n          {desktopLicense}\n\n          <p>GitHub Desktop also distributes these libraries:</p>\n\n          {licenses ? this.renderLicenses(licenses) : <Loading />}\n        </DialogContent>\n\n        <DialogFooter>\n          <ButtonGroup>\n            <Button type=\"submit\">Close</Button>\n          </ButtonGroup>\n        </DialogFooter>\n      </Dialog>\n    )\n  }\n}\n\n/** Normalize a package URL to a GitHub URL. */\nfunction normalizedGitHubURL(url: string): string {\n  let newURL = url\n  newURL = newURL.replace('git+https://github.com', 'https://github.com')\n  newURL = newURL.replace('git+ssh://git@github.com', 'https://github.com')\n  return newURL\n}\n","export { Acknowledgements } from './acknowledgements'\n","import * as React from 'react'\nimport { Account } from '../../models/account'\nimport { API, IAPIUser } from '../../lib/api'\nimport { TextBox } from '../lib/text-box'\nimport { Select } from '../lib/select'\nimport { DialogContent } from '../dialog'\nimport { Row } from '../lib/row'\nimport { merge } from '../../lib/merge'\nimport { caseInsensitiveCompare } from '../../lib/compare'\n\ninterface IPublishRepositoryProps {\n  /** The user to use for publishing. */\n  readonly account: Account\n\n  /** The settings to use when publishing the repository. */\n  readonly settings: IPublishRepositorySettings\n\n  /** The function called when any of the publish settings are changed. */\n  readonly onSettingsChanged: (settings: IPublishRepositorySettings) => void\n}\n\nexport interface IPublishRepositorySettings {\n  /** The name to use when publishing the repository. */\n  readonly name: string\n\n  /** The repository's description. */\n  readonly description: string\n\n  /** Should the repository be private? */\n  readonly private: boolean\n\n  /**\n   * The org to which this repository belongs. If null, the repository should be\n   * published as a personal repository.\n   */\n  readonly org: IAPIUser | null\n}\n\ninterface IPublishRepositoryState {\n  readonly orgs: ReadonlyArray<IAPIUser>\n}\n\n/** The Publish Repository component. */\nexport class PublishRepository extends React.Component<\n  IPublishRepositoryProps,\n  IPublishRepositoryState\n> {\n  public constructor(props: IPublishRepositoryProps) {\n    super(props)\n\n    this.state = { orgs: [] }\n  }\n\n  public async componentWillMount() {\n    this.fetchOrgs(this.props.account)\n  }\n\n  public componentWillReceiveProps(nextProps: IPublishRepositoryProps) {\n    if (this.props.account !== nextProps.account) {\n      this.setState({ orgs: [] })\n\n      this.fetchOrgs(nextProps.account)\n    }\n  }\n\n  private async fetchOrgs(account: Account) {\n    const api = API.fromAccount(account)\n    const orgs = (await api.fetchOrgs()) as Array<IAPIUser>\n    orgs.sort((a, b) => caseInsensitiveCompare(a.login, b.login))\n    this.setState({ orgs })\n  }\n\n  private updateSettings<K extends keyof IPublishRepositorySettings>(\n    subset: Pick<IPublishRepositorySettings, K>\n  ) {\n    const existingSettings = this.props.settings\n    const newSettings = merge(existingSettings, subset)\n    this.props.onSettingsChanged(newSettings)\n  }\n\n  private onNameChange = (name: string) => {\n    this.updateSettings({ name })\n  }\n\n  private onDescriptionChange = (description: string) => {\n    this.updateSettings({ description })\n  }\n\n  private onPrivateChange = (event: React.FormEvent<HTMLInputElement>) => {\n    this.updateSettings({ private: event.currentTarget.checked })\n  }\n\n  private onOrgChange = (event: React.FormEvent<HTMLSelectElement>) => {\n    const value = event.currentTarget.value\n    const index = parseInt(value, 10)\n    if (index < 0 || isNaN(index)) {\n      this.updateSettings({ org: null })\n    } else {\n      const org = this.state.orgs[index]\n      this.updateSettings({ org })\n    }\n  }\n\n  private renderOrgs(): JSX.Element | null {\n    if (this.state.orgs.length === 0) {\n      return null\n    }\n\n    const options = new Array<JSX.Element>()\n    options.push(\n      <option value={-1} key={-1}>\n        None\n      </option>\n    )\n\n    let selectedIndex = -1\n    const selectedOrg = this.props.settings.org\n    for (const [index, org] of this.state.orgs.entries()) {\n      if (selectedOrg && selectedOrg.id === org.id) {\n        selectedIndex = index\n      }\n\n      options.push(\n        <option value={index} key={index}>\n          {org.login}\n        </option>\n      )\n    }\n\n    return (\n      <Select\n        label=\"Organization\"\n        value={selectedIndex.toString()}\n        onChange={this.onOrgChange}\n      >\n        {options}\n      </Select>\n    )\n  }\n\n  public render() {\n    return (\n      <DialogContent>\n        <Row>\n          <TextBox\n            label=\"Name\"\n            value={this.props.settings.name}\n            autoFocus={true}\n            onValueChanged={this.onNameChange}\n          />\n        </Row>\n\n        <Row>\n          <TextBox\n            label=\"Description\"\n            value={this.props.settings.description}\n            onValueChanged={this.onDescriptionChange}\n          />\n        </Row>\n\n        <Row>\n          <label>\n            <input\n              type=\"checkbox\"\n              checked={this.props.settings.private}\n              onChange={this.onPrivateChange}\n            />\n            Keep this code private\n          </label>\n        </Row>\n\n        {this.renderOrgs()}\n      </DialogContent>\n    )\n  }\n}\n","import * as React from 'react'\nimport {\n  PublishRepository,\n  IPublishRepositorySettings,\n} from './publish-repository'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { Account } from '../../models/account'\nimport { Repository } from '../../models/repository'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Button } from '../lib/button'\nimport { Dialog, DialogFooter, DialogContent, DialogError } from '../dialog'\nimport { TabBar } from '../tab-bar'\nimport { getDotComAPIEndpoint } from '../../lib/api'\nimport { assertNever, fatalError } from '../../lib/fatal-error'\nimport { CallToAction } from '../lib/call-to-action'\nimport { getGitDescription } from '../../lib/git'\n\nenum PublishTab {\n  DotCom = 0,\n  Enterprise,\n}\n\ninterface IPublishProps {\n  readonly dispatcher: Dispatcher\n\n  /** The repository being published. */\n  readonly repository: Repository\n\n  /** The signed in accounts. */\n  readonly accounts: ReadonlyArray<Account>\n\n  /** The function to call when the dialog should be dismissed. */\n  readonly onDismissed: () => void\n}\n\ninterface IPublishState {\n  /** The currently selected tab. */\n  readonly currentTab: PublishTab\n\n  /** The settings for publishing the repository. */\n  readonly publishSettings: IPublishRepositorySettings\n\n  /**\n   * An error which, if present, is presented to the\n   * user in close proximity to the actions or input fields\n   * related to the current step.\n   */\n  readonly error: Error | null\n\n  /**\n   * The error pertaining to the tab the user is not\n   * actively using. It is swapped when the user changes\n   * the current tab.\n   */\n  readonly inactiveTabError: Error | null\n\n  /** Is the repository currently being published? */\n  readonly publishing: boolean\n}\n\n/**\n * The Publish component.\n */\nexport class Publish extends React.Component<IPublishProps, IPublishState> {\n  public constructor(props: IPublishProps) {\n    super(props)\n\n    const dotComAccount = this.getAccountForTab(PublishTab.DotCom)\n    const enterpriseAccount = this.getAccountForTab(PublishTab.Enterprise)\n    let startingTab = PublishTab.DotCom\n    if (!dotComAccount && enterpriseAccount) {\n      startingTab = PublishTab.Enterprise\n    }\n\n    const publishSettings = {\n      name: props.repository.name,\n      description: '',\n      private: true,\n      org: null,\n    }\n\n    this.state = {\n      currentTab: startingTab,\n      publishSettings,\n      error: null,\n      inactiveTabError: null,\n      publishing: false,\n    }\n  }\n\n  public render() {\n    return (\n      <Dialog\n        id=\"publish-repository\"\n        title={__DARWIN__ ? 'Publish Repository' : 'Publish repository'}\n        onDismissed={this.props.onDismissed}\n        onSubmit={this.publishRepository}\n        disabled={this.state.publishing}\n        loading={this.state.publishing}\n      >\n        <TabBar\n          onTabClicked={this.onTabClicked}\n          selectedIndex={this.state.currentTab}\n        >\n          <span>GitHub.com</span>\n          <span>Enterprise</span>\n        </TabBar>\n\n        {this.state.error ? (\n          <DialogError>{this.state.error.message}</DialogError>\n        ) : null}\n\n        {this.renderContent()}\n        {this.renderFooter()}\n      </Dialog>\n    )\n  }\n\n  public async componentDidMount() {\n    try {\n      const description = await getGitDescription(this.props.repository.path)\n      const settings = {\n        ...this.state.publishSettings,\n        description,\n      }\n\n      this.setState({ publishSettings: settings })\n    } catch (error) {\n      log.warn(`Couldn't get the repository's description`, error)\n    }\n  }\n\n  private renderContent() {\n    const tab = this.state.currentTab\n    const account = this.getAccountForTab(tab)\n    if (account) {\n      return (\n        <PublishRepository\n          account={account}\n          settings={this.state.publishSettings}\n          onSettingsChanged={this.onSettingsChanged}\n        />\n      )\n    } else {\n      return <DialogContent>{this.renderSignInTab(tab)}</DialogContent>\n    }\n  }\n\n  private onSettingsChanged = (settings: IPublishRepositorySettings) => {\n    this.setState({ publishSettings: settings })\n  }\n\n  private getAccountForTab(tab: PublishTab): Account | null {\n    const accounts = this.props.accounts\n    switch (tab) {\n      case PublishTab.DotCom:\n        return accounts.find(a => a.endpoint === getDotComAPIEndpoint()) || null\n      case PublishTab.Enterprise:\n        return accounts.find(a => a.endpoint !== getDotComAPIEndpoint()) || null\n      default:\n        return assertNever(tab, `Unknown tab: ${tab}`)\n    }\n  }\n\n  private renderSignInTab(tab: PublishTab) {\n    const signInTitle = __DARWIN__ ? 'Sign In' : 'Sign in'\n    switch (tab) {\n      case PublishTab.DotCom:\n        return (\n          <CallToAction actionTitle={signInTitle} onAction={this.signInDotCom}>\n            <div>\n              Sign in to your GitHub.com account to access your repositories.\n            </div>\n          </CallToAction>\n        )\n      case PublishTab.Enterprise:\n        return (\n          <CallToAction\n            actionTitle={signInTitle}\n            onAction={this.signInEnterprise}\n          >\n            <div>\n              If you have a GitHub Enterprise account at work, sign in to it to\n              get access to your repositories.\n            </div>\n          </CallToAction>\n        )\n      default:\n        return assertNever(tab, `Unknown tab: ${tab}`)\n    }\n  }\n\n  private renderFooter() {\n    const disabled = !this.state.publishSettings.name.length\n    const tab = this.state.currentTab\n    const user = this.getAccountForTab(tab)\n    if (user) {\n      return (\n        <DialogFooter>\n          <ButtonGroup>\n            <Button type=\"submit\" disabled={disabled}>\n              {__DARWIN__ ? 'Publish Repository' : 'Publish repository'}\n            </Button>\n            <Button onClick={this.props.onDismissed}>Cancel</Button>\n          </ButtonGroup>\n        </DialogFooter>\n      )\n    } else {\n      return null\n    }\n  }\n\n  private signInDotCom = () => {\n    this.props.dispatcher.showDotComSignInDialog()\n  }\n\n  private signInEnterprise = () => {\n    this.props.dispatcher.showEnterpriseSignInDialog()\n  }\n\n  private publishRepository = async () => {\n    this.setState({ error: null, publishing: true })\n\n    const tab = this.state.currentTab\n    const account = this.getAccountForTab(tab)\n    if (!account) {\n      fatalError(`Tried to publish with no user. That seems impossible!`)\n      return\n    }\n\n    const settings = this.state.publishSettings\n\n    try {\n      await this.props.dispatcher.publishRepository(\n        this.props.repository,\n        settings.name,\n        settings.description,\n        settings.private,\n        account,\n        settings.org\n      )\n\n      this.props.onDismissed()\n    } catch (e) {\n      this.setState({ error: e, publishing: false })\n    }\n  }\n\n  private onTabClicked = (index: PublishTab) => {\n    const isTabChanging = index !== this.state.currentTab\n    if (isTabChanging) {\n      // Clear the selected org since dot com and Enterprise will have a different\n      // set of orgs.\n      const settings = { ...this.state.publishSettings, org: null }\n      this.setState({ currentTab: index, publishSettings: settings })\n      // Swap the current stored error from the active tab with the error from\n      // the inactive tab. So that each tab saves and displays their own error.\n      const temporaryError: Error | null = this.state.error\n      this.setState({ error: this.state.inactiveTabError })\n      this.setState({ inactiveTabError: temporaryError })\n    }\n  }\n}\n","export { Publish } from './publish'\n","import * as React from 'react'\nimport { clipboard } from 'electron'\n\nimport { Row } from '../lib/row'\nimport { Button } from '../lib/button'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Dialog, DialogError, DialogContent, DialogFooter } from '../dialog'\nimport { Octicon, OcticonSymbol } from '../octicons'\nimport { LinkButton } from '../lib/link-button'\nimport { updateStore, IUpdateState, UpdateStatus } from '../lib/update-store'\nimport { Disposable } from 'event-kit'\nimport { Loading } from '../lib/loading'\nimport { RelativeTime } from '../relative-time'\nimport { assertNever } from '../../lib/fatal-error'\n\ninterface IAboutProps {\n  /**\n   * Event triggered when the dialog is dismissed by the user in the\n   * ways described in the Dialog component's dismissable prop.\n   */\n  readonly onDismissed: () => void\n\n  /**\n   * The name of the currently installed (and running) application\n   */\n  readonly applicationName: string\n\n  /**\n   * The currently installed (and running) version of the app.\n   */\n  readonly applicationVersion: string\n\n  /** A function to call to kick off an update check. */\n  readonly onCheckForUpdates: () => void\n\n  readonly onShowAcknowledgements: () => void\n\n  /** A function to call when the user wants to see Terms and Conditions. */\n  readonly onShowTermsAndConditions: () => void\n}\n\ninterface IAboutState {\n  readonly updateState: IUpdateState\n}\n\nconst releaseNotesUri = 'https://desktop.github.com/release-notes/'\n\n/**\n * A dialog that presents information about the\n * running application such as name and version.\n */\nexport class About extends React.Component<IAboutProps, IAboutState> {\n  private closeButton: Button | null = null\n  private updateStoreEventHandle: Disposable | null = null\n\n  public constructor(props: IAboutProps) {\n    super(props)\n\n    this.state = {\n      updateState: updateStore.state,\n    }\n  }\n\n  private onCloseButtonRef = (button: Button | null) => {\n    this.closeButton = button\n  }\n\n  private onUpdateStateChanged = (updateState: IUpdateState) => {\n    this.setState({ updateState })\n  }\n\n  private onClickVersion = () => {\n    clipboard.writeText(this.props.applicationVersion)\n  }\n\n  public componentDidMount() {\n    this.updateStoreEventHandle = updateStore.onDidChange(\n      this.onUpdateStateChanged\n    )\n    this.setState({ updateState: updateStore.state })\n\n    // A modal dialog autofocuses the first element that can receive\n    // focus (and our dialog even uses the autofocus attribute on its\n    // fieldset). In our case that's the release notes link button and\n    // we don't want that to have focus so we'll move it over to the\n    // close button instead.\n    if (this.closeButton) {\n      this.closeButton.focus()\n    }\n  }\n\n  public componentWillUnmount() {\n    if (this.updateStoreEventHandle) {\n      this.updateStoreEventHandle.dispose()\n      this.updateStoreEventHandle = null\n    }\n  }\n\n  private onQuitAndInstall = () => {\n    updateStore.quitAndInstallUpdate()\n  }\n\n  private renderUpdateButton() {\n    if (\n      __RELEASE_CHANNEL__ === 'development' ||\n      __RELEASE_CHANNEL__ === 'test'\n    ) {\n      return null\n    }\n\n    const updateStatus = this.state.updateState.status\n\n    switch (updateStatus) {\n      case UpdateStatus.UpdateReady:\n        return (\n          <Row>\n            <Button onClick={this.onQuitAndInstall}>\n              Quit and Install Update\n            </Button>\n          </Row>\n        )\n      case UpdateStatus.UpdateNotAvailable:\n      case UpdateStatus.CheckingForUpdates:\n      case UpdateStatus.UpdateAvailable:\n        const disabled = updateStatus !== UpdateStatus.UpdateNotAvailable\n\n        return (\n          <Row>\n            <Button disabled={disabled} onClick={this.props.onCheckForUpdates}>\n              Check for Updates\n            </Button>\n          </Row>\n        )\n      default:\n        return assertNever(\n          updateStatus,\n          `Unknown update status ${updateStatus}`\n        )\n    }\n  }\n\n  private renderCheckingForUpdate() {\n    return (\n      <Row className=\"update-status\">\n        <Loading />\n        <span>Checking for updates</span>\n      </Row>\n    )\n  }\n\n  private renderUpdateAvailable() {\n    return (\n      <Row className=\"update-status\">\n        <Loading />\n        <span>Downloading update</span>\n      </Row>\n    )\n  }\n\n  private renderUpdateNotAvailable() {\n    const lastCheckedDate = this.state.updateState.lastSuccessfulCheck\n\n    // This case is rendered as an error\n    if (!lastCheckedDate) {\n      return null\n    }\n\n    return (\n      <p className=\"update-status\">\n        You have the latest version (last checked{' '}\n        <RelativeTime date={lastCheckedDate} />)\n      </p>\n    )\n  }\n\n  private renderUpdateReady() {\n    return (\n      <p className=\"update-status\">\n        An update has been downloaded and is ready to be installed.\n      </p>\n    )\n  }\n\n  private renderUpdateDetails() {\n    if (__LINUX__) {\n      return null\n    }\n\n    if (\n      __RELEASE_CHANNEL__ === 'development' ||\n      __RELEASE_CHANNEL__ === 'test'\n    ) {\n      return (\n        <p>\n          The application is currently running in development or test mode and\n          will not receive any updates.\n        </p>\n      )\n    }\n\n    const updateState = this.state.updateState\n\n    switch (updateState.status) {\n      case UpdateStatus.CheckingForUpdates:\n        return this.renderCheckingForUpdate()\n      case UpdateStatus.UpdateAvailable:\n        return this.renderUpdateAvailable()\n      case UpdateStatus.UpdateNotAvailable:\n        return this.renderUpdateNotAvailable()\n      case UpdateStatus.UpdateReady:\n        return this.renderUpdateReady()\n      default:\n        return assertNever(\n          updateState.status,\n          `Unknown update status ${updateState.status}`\n        )\n    }\n  }\n\n  private renderUpdateErrors() {\n    if (__LINUX__) {\n      return null\n    }\n\n    if (\n      __RELEASE_CHANNEL__ === 'development' ||\n      __RELEASE_CHANNEL__ === 'test'\n    ) {\n      return null\n    }\n\n    if (!this.state.updateState.lastSuccessfulCheck) {\n      return (\n        <DialogError>\n          Couldn't determine the last time an update check was performed. You\n          may be running an old version. Please try manually checking for\n          updates and contact GitHub Support if the problem persists\n        </DialogError>\n      )\n    }\n\n    return null\n  }\n\n  public render() {\n    const name = this.props.applicationName\n    const version = this.props.applicationVersion\n    const releaseNotesLink = (\n      <LinkButton uri={releaseNotesUri}>release notes</LinkButton>\n    )\n\n    return (\n      <Dialog\n        id=\"about\"\n        onSubmit={this.props.onDismissed}\n        onDismissed={this.props.onDismissed}\n      >\n        {this.renderUpdateErrors()}\n        <DialogContent>\n          <Row className=\"logo\">\n            <Octicon symbol={OcticonSymbol.markGithub} />\n          </Row>\n          <h2>{name}</h2>\n          <p className=\"no-padding\">\n            <LinkButton\n              title=\"Click to copy\"\n              className=\"version-text\"\n              onClick={this.onClickVersion}\n            >\n              Version {version}\n            </LinkButton>{' '}\n            ({releaseNotesLink})\n          </p>\n          <p className=\"no-padding\">\n            <LinkButton onClick={this.props.onShowTermsAndConditions}>\n              Terms and Conditions\n            </LinkButton>\n          </p>\n          <p>\n            <LinkButton onClick={this.props.onShowAcknowledgements}>\n              License and Open Source Notices\n            </LinkButton>\n          </p>\n          {this.renderUpdateDetails()}\n          {this.renderUpdateButton()}\n        </DialogContent>\n\n        <DialogFooter>\n          <ButtonGroup>\n            <Button\n              ref={this.onCloseButtonRef}\n              onClick={this.props.onDismissed}\n            >\n              Close\n            </Button>\n          </ButtonGroup>\n        </DialogFooter>\n      </Dialog>\n    )\n  }\n}\n","export * from './about'\n","import * as React from 'react'\n\nimport { Button } from '../lib/button'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Dialog, DialogContent, DialogFooter } from '../dialog'\nimport { shell } from '../../lib/app-shell'\n\ninterface IEditorErrorProps {\n  /**\n   * Event triggered when the dialog is dismissed by the user in the\n   * ways described in the Dialog component's dismissable prop.\n   */\n  readonly onDismissed: () => void\n\n  /**\n   * Event to trigger if the user navigates to the Preferences dialog\n   */\n  readonly showPreferencesDialog: () => void\n\n  /**\n   * The text to display to the user relating to this error.\n   */\n  readonly message: string\n\n  /** Render the \"Install Atom\" link as the default action */\n  readonly suggestAtom?: boolean\n\n  /** Render the \"Open Preferences\" link as the default action */\n  readonly viewPreferences?: boolean\n}\n\n/**\n * A dialog indicating something went wrong with launching an external editor,\n * with guidance to get the user back to a happy places\n */\nexport class EditorError extends React.Component<IEditorErrorProps, {}> {\n  public constructor(props: IEditorErrorProps) {\n    super(props)\n  }\n\n  private onExternalLink = () => {\n    const url = `https://atom.io/`\n    shell.openExternal(url)\n  }\n\n  private onShowPreferencesDialog = () => {\n    this.props.onDismissed()\n    this.props.showPreferencesDialog()\n  }\n\n  public render() {\n    const title = __DARWIN__\n      ? 'Unable to Open External Editor'\n      : 'Unable to open external editor'\n\n    let buttonGroup: JSX.Element | null = null\n    if (this.props.viewPreferences) {\n      buttonGroup = (\n        <ButtonGroup>\n          <Button type=\"submit\" onClick={this.props.onDismissed}>\n            Close\n          </Button>\n          <Button onClick={this.onShowPreferencesDialog}>\n            {__DARWIN__ ? 'Open Preferences' : 'Open options'}\n          </Button>\n        </ButtonGroup>\n      )\n    } else if (this.props.suggestAtom) {\n      buttonGroup = (\n        <ButtonGroup>\n          <Button type=\"submit\" onClick={this.props.onDismissed}>\n            Close\n          </Button>\n          <Button onClick={this.onExternalLink}>Download Atom</Button>\n        </ButtonGroup>\n      )\n    }\n\n    return (\n      <Dialog\n        id=\"external-editor-error\"\n        type=\"error\"\n        title={title}\n        onSubmit={this.props.onDismissed}\n        onDismissed={this.props.onDismissed}\n      >\n        <DialogContent>\n          <p>{this.props.message}</p>\n        </DialogContent>\n        <DialogFooter>{buttonGroup}</DialogFooter>\n      </Dialog>\n    )\n  }\n}\n","export * from './editor-error'\n","import * as React from 'react'\n\nimport { Button } from '../lib/button'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Dialog, DialogContent, DialogFooter } from '../dialog'\nimport { shell } from '../../lib/app-shell'\n\ninterface IInstallGitProps {\n  /**\n   * Event triggered when the dialog is dismissed by the user in the\n   * ways described in the Dialog component's dismissable prop.\n   */\n  readonly onDismissed: () => void\n\n  /**\n   * The path to the current repository, in case the user wants to continue\n   * doing whatever they're doing.\n   */\n  readonly path: string\n\n  /** Called when the user chooses to open the shell. */\n  readonly onOpenShell: (path: string) => void\n}\n\n/**\n * A dialog indicating that Git wasn't found, to direct the user to an\n * external resource for more information about setting up their environment.\n */\nexport class InstallGit extends React.Component<IInstallGitProps, {}> {\n  public constructor(props: IInstallGitProps) {\n    super(props)\n  }\n\n  private onContinue = () => {\n    this.props.onOpenShell(this.props.path)\n  }\n\n  private onExternalLink = () => {\n    const url = `https://help.github.com/articles/set-up-git/#setting-up-git`\n    shell.openExternal(url)\n  }\n\n  public render() {\n    return (\n      <Dialog\n        id=\"install-git\"\n        type=\"warning\"\n        title={__DARWIN__ ? 'Unable to Locate Git' : 'Unable to locate Git'}\n        onSubmit={this.props.onDismissed}\n        onDismissed={this.props.onDismissed}\n      >\n        <DialogContent>\n          <p>\n            We were unable to locate Git on your system. This means you won't be\n            able to execute any Git commands in the{' '}\n            {__DARWIN__ ? 'Terminal window' : 'command prompt'}.\n          </p>\n          <p>\n            To help you get Git installed and configured for your operating\n            system, we have some external resources available.\n          </p>\n        </DialogContent>\n        <DialogFooter>\n          <ButtonGroup>\n            <Button type=\"submit\" onClick={this.onContinue}>\n              Open without Git\n            </Button>\n            <Button onClick={this.onExternalLink}>Install Git</Button>\n          </ButtonGroup>\n        </DialogFooter>\n      </Dialog>\n    )\n  }\n}\n","export * from './install'\n","import * as React from 'react'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport {\n  SignInState,\n  SignInStep,\n  IEndpointEntryState,\n  IAuthenticationState,\n  ITwoFactorAuthenticationState,\n} from '../../lib/stores'\nimport { assertNever } from '../../lib/fatal-error'\nimport { Button } from '../lib/button'\nimport { LinkButton } from '../lib/link-button'\nimport { Octicon, OcticonSymbol } from '../octicons'\nimport { Row } from '../lib/row'\nimport { TextBox } from '../lib/text-box'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Dialog, DialogError, DialogContent, DialogFooter } from '../dialog'\n\nimport { getWelcomeMessage } from '../../lib/2fa'\n\ninterface ISignInProps {\n  readonly dispatcher: Dispatcher\n  readonly signInState: SignInState | null\n  readonly onDismissed: () => void\n}\n\ninterface ISignInState {\n  readonly endpoint: string\n  readonly username: string\n  readonly password: string\n  readonly otpToken: string\n}\n\nexport class SignIn extends React.Component<ISignInProps, ISignInState> {\n  public constructor(props: ISignInProps) {\n    super(props)\n\n    this.state = {\n      endpoint: '',\n      username: '',\n      password: '',\n      otpToken: '',\n    }\n  }\n\n  public componentWillReceiveProps(nextProps: ISignInProps) {\n    if (nextProps.signInState !== this.props.signInState) {\n      if (\n        nextProps.signInState &&\n        nextProps.signInState.kind === SignInStep.Success\n      ) {\n        this.props.onDismissed()\n      }\n    }\n  }\n\n  private onSubmit = () => {\n    const state = this.props.signInState\n\n    if (!state) {\n      return\n    }\n\n    const stepKind = state.kind\n\n    switch (state.kind) {\n      case SignInStep.EndpointEntry:\n        this.props.dispatcher.setSignInEndpoint(this.state.endpoint)\n        break\n      case SignInStep.Authentication:\n        if (!state.supportsBasicAuth) {\n          this.props.dispatcher.requestBrowserAuthentication()\n        } else {\n          this.props.dispatcher.setSignInCredentials(\n            this.state.username,\n            this.state.password\n          )\n        }\n        break\n      case SignInStep.TwoFactorAuthentication:\n        this.props.dispatcher.setSignInOTP(this.state.otpToken)\n        break\n      case SignInStep.Success:\n        this.props.onDismissed()\n        break\n      default:\n        assertNever(state, `Unknown sign in step ${stepKind}`)\n    }\n  }\n\n  private onEndpointChanged = (endpoint: string) => {\n    this.setState({ endpoint })\n  }\n\n  private onUsernameChanged = (username: string) => {\n    this.setState({ username })\n  }\n\n  private onPasswordChanged = (password: string) => {\n    this.setState({ password })\n  }\n\n  private onOTPTokenChanged = (otpToken: string) => {\n    this.setState({ otpToken })\n  }\n\n  private onSignInWithBrowser = () => {\n    this.props.dispatcher.requestBrowserAuthentication()\n  }\n\n  private renderFooter(): JSX.Element | null {\n    const state = this.props.signInState\n\n    if (!state || state.kind === SignInStep.Success) {\n      return null\n    }\n\n    let disableSubmit = false\n\n    let primaryButtonText: string\n    const stepKind = state.kind\n\n    switch (state.kind) {\n      case SignInStep.EndpointEntry:\n        disableSubmit = this.state.endpoint.length === 0\n        primaryButtonText = 'Continue'\n        break\n      case SignInStep.TwoFactorAuthentication:\n        // ensure user has entered non-whitespace characters\n        const codeProvided = /\\S+/.test(this.state.otpToken)\n        disableSubmit = !codeProvided\n        primaryButtonText = 'Sign in'\n        break\n      case SignInStep.Authentication:\n        if (!state.supportsBasicAuth) {\n          primaryButtonText = __DARWIN__\n            ? 'Continue With Browser'\n            : 'Continue with browser'\n        } else {\n          const validUserName = this.state.username.length > 0\n          const validPassword = this.state.password.length > 0\n          disableSubmit = !validUserName || !validPassword\n          primaryButtonText = 'Sign in'\n        }\n        break\n      default:\n        return assertNever(state, `Unknown sign in step ${stepKind}`)\n    }\n\n    return (\n      <DialogFooter>\n        <ButtonGroup>\n          <Button disabled={disableSubmit} type=\"submit\">\n            {primaryButtonText}\n          </Button>\n          <Button onClick={this.props.onDismissed}>Cancel</Button>\n        </ButtonGroup>\n      </DialogFooter>\n    )\n  }\n\n  private renderEndpointEntryStep(state: IEndpointEntryState) {\n    return (\n      <DialogContent>\n        <Row>\n          <TextBox\n            label=\"Enterprise server address\"\n            value={this.state.endpoint}\n            onValueChanged={this.onEndpointChanged}\n            placeholder=\"https://github.example.com\"\n          />\n        </Row>\n      </DialogContent>\n    )\n  }\n\n  private renderAuthenticationStep(state: IAuthenticationState) {\n    if (!state.supportsBasicAuth) {\n      return (\n        <DialogContent>\n          <p>\n            Your GitHub Enterprise instance requires you to sign in with your\n            browser.\n          </p>\n        </DialogContent>\n      )\n    }\n\n    const disableSubmit = state.loading\n\n    return (\n      <DialogContent>\n        <Row>\n          <TextBox\n            label=\"Username or email address\"\n            value={this.state.username}\n            onValueChanged={this.onUsernameChanged}\n          />\n        </Row>\n        <Row>\n          <TextBox\n            label=\"Password\"\n            value={this.state.password}\n            type=\"password\"\n            onValueChanged={this.onPasswordChanged}\n          />\n        </Row>\n        <Row>\n          <LinkButton\n            className=\"forgot-password-link-sign-in\"\n            uri={state.forgotPasswordUrl}\n          >\n            Forgot password?\n          </LinkButton>\n        </Row>\n\n        <div className=\"horizontal-rule\">\n          <span className=\"horizontal-rule-content\">or</span>\n        </div>\n\n        <Row className=\"sign-in-with-browser\">\n          <LinkButton\n            className=\"link-with-icon\"\n            onClick={this.onSignInWithBrowser}\n            disabled={disableSubmit}\n          >\n            Sign in using your browser\n            <Octicon symbol={OcticonSymbol.linkExternal} />\n          </LinkButton>\n        </Row>\n      </DialogContent>\n    )\n  }\n\n  private renderTwoFactorAuthenticationStep(\n    state: ITwoFactorAuthenticationState\n  ) {\n    return (\n      <DialogContent>\n        <p>{getWelcomeMessage(state.type)}</p>\n        <Row>\n          <TextBox\n            label=\"Authentication code\"\n            value={this.state.otpToken}\n            onValueChanged={this.onOTPTokenChanged}\n            labelLinkText={`What's this?`}\n            labelLinkUri=\"https://help.github.com/articles/providing-your-2fa-authentication-code/\"\n            autoFocus={true}\n          />\n        </Row>\n      </DialogContent>\n    )\n  }\n\n  private renderStep(): JSX.Element | null {\n    const state = this.props.signInState\n\n    if (!state) {\n      return null\n    }\n\n    const stepKind = state.kind\n\n    switch (state.kind) {\n      case SignInStep.EndpointEntry:\n        return this.renderEndpointEntryStep(state)\n      case SignInStep.Authentication:\n        return this.renderAuthenticationStep(state)\n      case SignInStep.TwoFactorAuthentication:\n        return this.renderTwoFactorAuthenticationStep(state)\n      case SignInStep.Success:\n        return null\n      default:\n        return assertNever(state, `Unknown sign in step ${stepKind}`)\n    }\n  }\n\n  public render() {\n    const state = this.props.signInState\n\n    if (!state || state.kind === SignInStep.Success) {\n      return null\n    }\n\n    const disabled = state.loading\n\n    const errors = state.error ? (\n      <DialogError>{state.error.message}</DialogError>\n    ) : null\n\n    return (\n      <Dialog\n        id=\"sign-in\"\n        title=\"Sign in\"\n        disabled={disabled}\n        onDismissed={this.props.onDismissed}\n        onSubmit={this.onSubmit}\n        loading={state.loading}\n      >\n        {errors}\n        {this.renderStep()}\n        {this.renderFooter()}\n      </Dialog>\n    )\n  }\n}\n","export * from './sign-in'\n","import * as React from 'react'\n\nimport { Repository } from '../../models/repository'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { sanitizedBranchName } from '../../lib/sanitize-branch'\nimport { Branch } from '../../models/branch'\nimport { TextBox } from '../lib/text-box'\nimport { Row } from '../lib/row'\nimport { Ref } from '../lib/ref'\nimport { Button } from '../lib/button'\nimport { LinkButton } from '../lib/link-button'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Dialog, DialogError, DialogContent, DialogFooter } from '../dialog'\nimport { VerticalSegmentedControl } from '../lib/vertical-segmented-control'\nimport {\n  TipState,\n  IUnbornRepository,\n  IDetachedHead,\n  IValidBranch,\n} from '../../models/tip'\nimport { assertNever } from '../../lib/fatal-error'\nimport {\n  renderBranchNameWarning,\n  renderBranchNameExistsOnRemoteWarning,\n} from '../lib/branch-name-warnings'\n\ninterface ICreateBranchProps {\n  readonly repository: Repository\n  readonly dispatcher: Dispatcher\n  readonly onDismissed: () => void\n  readonly tip: IUnbornRepository | IDetachedHead | IValidBranch\n  readonly defaultBranch: Branch | null\n  readonly allBranches: ReadonlyArray<Branch>\n  readonly initialName: string\n}\n\nenum StartPoint {\n  CurrentBranch,\n  DefaultBranch,\n  Head,\n}\n\ninterface ICreateBranchState {\n  readonly currentError: Error | null\n  readonly proposedName: string\n  readonly sanitizedName: string\n  readonly startPoint: StartPoint\n\n  /**\n   * Whether or not the dialog is currently creating a branch. This affects\n   * the dialog loading state as well as the rendering of the branch selector.\n   *\n   * When the dialog is creating a branch we take the tip and defaultBranch\n   * as they were in props at the time of creation and stick them in state\n   * so that we can maintain the layout of the branch selection parts even\n   * as the Tip changes during creation.\n   *\n   * Note: once branch creation has been initiated this value stays at true\n   * and will never revert to being false. If the branch creation operation\n   * fails this dialog will still be dismissed and an error dialog will be\n   * shown in its place.\n   */\n  readonly isCreatingBranch: boolean\n\n  /**\n   * The tip of the current repository, captured from props at the start\n   * of the create branch operation.\n   */\n  readonly tipAtCreateStart: IUnbornRepository | IDetachedHead | IValidBranch\n\n  /**\n   * The default branch of the current repository, captured from props at the\n   * start of the create branch operation.\n   */\n  readonly defaultBranchAtCreateStart: Branch | null\n}\n\nenum SelectedBranch {\n  DefaultBranch = 0,\n  CurrentBranch = 1,\n}\n\nfunction getStartPoint(\n  props: ICreateBranchProps,\n  preferred: StartPoint\n): StartPoint {\n  if (preferred === StartPoint.DefaultBranch && props.defaultBranch) {\n    return preferred\n  }\n\n  if (\n    preferred === StartPoint.CurrentBranch &&\n    props.tip.kind === TipState.Valid\n  ) {\n    return preferred\n  }\n\n  if (preferred === StartPoint.Head) {\n    return preferred\n  }\n\n  if (props.defaultBranch) {\n    return StartPoint.DefaultBranch\n  } else if (props.tip.kind === TipState.Valid) {\n    return StartPoint.CurrentBranch\n  } else {\n    return StartPoint.Head\n  }\n}\n\n/** The Create Branch component. */\nexport class CreateBranch extends React.Component<\n  ICreateBranchProps,\n  ICreateBranchState\n> {\n  public constructor(props: ICreateBranchProps) {\n    super(props)\n\n    this.state = {\n      currentError: null,\n      proposedName: props.initialName,\n      sanitizedName: '',\n      startPoint: getStartPoint(props, StartPoint.DefaultBranch),\n      isCreatingBranch: false,\n      tipAtCreateStart: props.tip,\n      defaultBranchAtCreateStart: props.defaultBranch,\n    }\n  }\n\n  public componentDidMount() {\n    if (this.state.proposedName.length) {\n      this.updateBranchName(this.state.proposedName)\n    }\n  }\n\n  public componentWillReceiveProps(nextProps: ICreateBranchProps) {\n    this.setState({\n      startPoint: getStartPoint(nextProps, this.state.startPoint),\n    })\n\n    if (!this.state.isCreatingBranch) {\n      this.setState({\n        tipAtCreateStart: nextProps.tip,\n        defaultBranchAtCreateStart: nextProps.defaultBranch,\n      })\n    }\n  }\n\n  private renderBranchSelection() {\n    const tip = this.state.isCreatingBranch\n      ? this.state.tipAtCreateStart\n      : this.props.tip\n\n    const tipKind = tip.kind\n\n    if (tip.kind === TipState.Detached) {\n      return (\n        <p>\n          You do not currently have any branch checked out (your HEAD reference\n          is detached). As such your new branch will be based on your currently\n          checked out commit ({tip.currentSha.substr(0, 7)}\n          ).\n        </p>\n      )\n    } else if (tip.kind === TipState.Unborn) {\n      return (\n        <p>\n          Your current branch is unborn (does not contain any commits). Creating\n          a new branch will rename the current branch.\n        </p>\n      )\n    } else if (tip.kind === TipState.Valid) {\n      const currentBranch = tip.branch\n      const defaultBranch = this.state.isCreatingBranch\n        ? this.props.defaultBranch\n        : this.state.defaultBranchAtCreateStart\n\n      if (!defaultBranch || defaultBranch.name === currentBranch.name) {\n        const defaultBranchLink = (\n          <LinkButton uri=\"https://help.github.com/articles/setting-the-default-branch/\">\n            default branch\n          </LinkButton>\n        )\n        return (\n          <p>\n            Your new branch will be based on your currently checked out branch (\n            <Ref>{currentBranch.name}</Ref>\n            ). <Ref>{currentBranch.name}</Ref> is the {defaultBranchLink} for\n            your repository.\n          </p>\n        )\n      } else {\n        const items = [\n          {\n            title: defaultBranch.name,\n            description:\n              \"The default branch in your repository. Pick this to start on something new that's not dependent on your current branch.\",\n          },\n          {\n            title: currentBranch.name,\n            description:\n              'The currently checked out branch. Pick this if you need to build on work done in this branch.',\n          },\n        ]\n\n        const startPoint = this.state.startPoint\n        const selectedIndex = startPoint === StartPoint.DefaultBranch ? 0 : 1\n\n        return (\n          <Row>\n            <VerticalSegmentedControl\n              label=\"Create branch based on\"\n              items={items}\n              selectedIndex={selectedIndex}\n              onSelectionChanged={this.onBaseBranchChanged}\n            />\n          </Row>\n        )\n      }\n    } else {\n      return assertNever(tip, `Unknown tip kind ${tipKind}`)\n    }\n  }\n\n  private onBaseBranchChanged = (selection: SelectedBranch) => {\n    if (selection === SelectedBranch.DefaultBranch) {\n      this.setState({ startPoint: StartPoint.DefaultBranch })\n    } else if (selection === SelectedBranch.CurrentBranch) {\n      this.setState({ startPoint: StartPoint.CurrentBranch })\n    } else {\n      throw new Error(`Unknown branch selection: ${selection}`)\n    }\n  }\n\n  public render() {\n    const disabled =\n      this.state.proposedName.length <= 0 ||\n      !!this.state.currentError ||\n      /^\\s*$/.test(this.state.sanitizedName)\n    const error = this.state.currentError\n\n    return (\n      <Dialog\n        id=\"create-branch\"\n        title={__DARWIN__ ? 'Create a Branch' : 'Create a branch'}\n        onSubmit={this.createBranch}\n        onDismissed={this.props.onDismissed}\n        loading={this.state.isCreatingBranch}\n        disabled={this.state.isCreatingBranch}\n      >\n        {error ? <DialogError>{error.message}</DialogError> : null}\n\n        <DialogContent>\n          <Row>\n            <TextBox\n              label=\"Name\"\n              value={this.state.proposedName}\n              autoFocus={true}\n              onValueChanged={this.onBranchNameChange}\n            />\n          </Row>\n\n          {renderBranchNameWarning(\n            this.state.proposedName,\n            this.state.sanitizedName\n          )}\n\n          {renderBranchNameExistsOnRemoteWarning(\n            this.state.sanitizedName,\n            this.props.allBranches\n          )}\n\n          {this.renderBranchSelection()}\n        </DialogContent>\n\n        <DialogFooter>\n          <ButtonGroup>\n            <Button type=\"submit\" disabled={disabled}>\n              {__DARWIN__ ? 'Create Branch' : 'Create branch'}\n            </Button>\n            <Button onClick={this.props.onDismissed}>Cancel</Button>\n          </ButtonGroup>\n        </DialogFooter>\n      </Dialog>\n    )\n  }\n\n  private onBranchNameChange = (name: string) => {\n    this.updateBranchName(name)\n  }\n\n  private updateBranchName(name: string) {\n    const sanitizedName = sanitizedBranchName(name)\n    const alreadyExists =\n      this.props.allBranches.findIndex(b => b.name === sanitizedName) > -1\n\n    const currentError = alreadyExists\n      ? new Error(`A branch named ${sanitizedName} already exists`)\n      : null\n\n    this.setState({\n      proposedName: name,\n      sanitizedName,\n      currentError,\n    })\n  }\n\n  private createBranch = async () => {\n    const name = this.state.sanitizedName\n\n    let startPoint = undefined\n\n    if (this.state.startPoint === StartPoint.DefaultBranch) {\n      // This really shouldn't happen, we take all kinds of precautions\n      // to make sure the startPoint state is valid given the current props.\n      if (!this.props.defaultBranch) {\n        this.setState({\n          currentError: new Error('Could not determine the default branch'),\n        })\n        return\n      }\n\n      startPoint = this.props.defaultBranch.name\n    }\n\n    if (name.length > 0) {\n      this.setState({ isCreatingBranch: true })\n      await this.props.dispatcher.createBranch(\n        this.props.repository,\n        name,\n        startPoint\n      )\n      this.props.onDismissed()\n    }\n  }\n}\n","export { CreateBranch } from './create-branch-dialog'\n","import { IAPIRepository } from '../../lib/api'\nimport { IFilterListGroup, IFilterListItem } from '../lib/filter-list'\nimport { caseInsensitiveCompare } from '../../lib/compare'\nimport { OcticonSymbol } from '../octicons'\n\n/** The identifier for the \"Your Repositories\" grouping. */\nexport const YourRepositoriesIdentifier = 'your-repositories'\n\nexport interface IClonableRepositoryListItem extends IFilterListItem {\n  /** The identifier for the item. */\n  readonly id: string\n\n  /** The search text. */\n  readonly text: ReadonlyArray<string>\n\n  /** The name of the repository. */\n  readonly name: string\n\n  /** The icon for the repo. */\n  readonly icon: OcticonSymbol\n\n  /** The clone URL. */\n  readonly url: string\n}\n\nfunction getIcon(gitHubRepo: IAPIRepository): OcticonSymbol {\n  if (gitHubRepo.private) {\n    return OcticonSymbol.lock\n  }\n  if (gitHubRepo.fork) {\n    return OcticonSymbol.repoForked\n  }\n\n  return OcticonSymbol.repo\n}\n\nfunction convert(\n  repositories: ReadonlyArray<IAPIRepository>\n): ReadonlyArray<IClonableRepositoryListItem> {\n  const repos: ReadonlyArray<IClonableRepositoryListItem> = repositories.map(\n    repo => {\n      const icon = getIcon(repo)\n\n      return {\n        id: repo.html_url,\n        text: [`${repo.owner.login}/${repo.name}`],\n        url: repo.clone_url,\n        name: repo.name,\n        icon,\n      }\n    }\n  )\n\n  return repos\n}\n\nexport function groupRepositories(\n  repositories: ReadonlyArray<IAPIRepository>,\n  login: string\n): ReadonlyArray<IFilterListGroup<IClonableRepositoryListItem>> {\n  const userRepos = repositories.filter(repo => repo.owner.type === 'User')\n  const orgRepos = repositories.filter(\n    repo => repo.owner.type === 'Organization'\n  )\n\n  const groups = [\n    {\n      identifier: YourRepositoriesIdentifier,\n      items: convert(userRepos),\n    },\n  ]\n\n  const orgs = orgRepos.map(repo => repo.owner.login)\n  const distinctOrgs = Array.from(new Set(orgs))\n\n  for (const org of distinctOrgs.sort(caseInsensitiveCompare)) {\n    const orgRepositories = orgRepos.filter(repo => repo.owner.login === org)\n\n    groups.push({\n      identifier: org,\n      items: convert(orgRepositories),\n    })\n  }\n\n  return groups\n}\n","import * as React from 'react'\n\nimport { Account } from '../../models/account'\nimport { DialogContent } from '../dialog'\nimport { TextBox } from '../lib/text-box'\nimport { Row } from '../lib/row'\nimport { Button } from '../lib/button'\nimport { Loading } from '../lib/loading'\nimport { Octicon } from '../octicons'\nimport { FilterList } from '../lib/filter-list'\nimport { API } from '../../lib/api'\nimport { IFilterListGroup } from '../lib/filter-list'\nimport { IMatches } from '../../lib/fuzzy-find'\nimport {\n  IClonableRepositoryListItem,\n  groupRepositories,\n  YourRepositoriesIdentifier,\n} from './group-repositories'\nimport { HighlightText } from '../lib/highlight-text'\n\ninterface ICloneGithubRepositoryProps {\n  /** The account to clone from. */\n  readonly account: Account\n\n  /** The path to clone to. */\n  readonly path: string\n\n  /** Called when the destination path changes. */\n  readonly onPathChanged: (path: string) => void\n\n  /**\n   * Called when the user should be prompted to choose a destination directory.\n   */\n  readonly onChooseDirectory: () => Promise<string | undefined>\n\n  /** Called when a repository is selected. */\n  readonly onGitHubRepositorySelected: (url: string) => void\n\n  /** Should the component clear the filter text on render? */\n  readonly shouldClearFilter: boolean\n}\n\ninterface ICloneGithubRepositoryState {\n  /** Are we currently loading the repositories list? */\n  readonly loading: boolean\n\n  /** The list of clonable repositories. */\n  readonly repositories: ReadonlyArray<\n    IFilterListGroup<IClonableRepositoryListItem>\n  >\n\n  /** The currently selected item. */\n  readonly selectedItem: IClonableRepositoryListItem | null\n\n  /** The currently entered filter text. */\n  readonly filterText: string\n}\n\nconst ClonableRepositoryFilterList: new () => FilterList<\n  IClonableRepositoryListItem\n> = FilterList as any\nconst RowHeight = 31\n\nexport class CloneGithubRepository extends React.Component<\n  ICloneGithubRepositoryProps,\n  ICloneGithubRepositoryState\n> {\n  private mounted = false\n\n  public constructor(props: ICloneGithubRepositoryProps) {\n    super(props)\n\n    this.state = {\n      loading: false,\n      repositories: [],\n      selectedItem: null,\n      filterText: '',\n    }\n  }\n\n  public componentDidMount() {\n    this.mounted = true\n\n    this.loadRepositories(this.props.account)\n  }\n\n  public componentWillUnmount() {\n    this.mounted = false\n  }\n\n  private async loadRepositories(account: Account) {\n    this.setState({\n      loading: true,\n    })\n\n    const api = API.fromAccount(account)\n    const result = await api.fetchRepositories()\n\n    // The account could have changed while we were working. Bail if it did.\n    if (account.id !== this.props.account.id) {\n      return\n    }\n\n    if (!this.mounted) {\n      return\n    }\n\n    const repositories = result\n      ? groupRepositories(result, this.props.account.login)\n      : []\n\n    this.setState({\n      repositories,\n      loading: false,\n    })\n  }\n\n  public componentWillReceiveProps(nextProps: ICloneGithubRepositoryProps) {\n    if (nextProps.shouldClearFilter) {\n      this.setState({\n        filterText: '',\n      })\n    }\n\n    if (nextProps.account.id !== this.props.account.id) {\n      this.loadRepositories(nextProps.account)\n    }\n  }\n\n  public render() {\n    return (\n      <DialogContent className=\"clone-github-repository-content\">\n        <Row>{this.renderRepositoryList()}</Row>\n\n        <Row className=\"local-path-field\">\n          <TextBox\n            value={this.props.path}\n            label={__DARWIN__ ? 'Local Path' : 'Local path'}\n            placeholder=\"repository path\"\n            onValueChanged={this.onPathChanged}\n          />\n          <Button onClick={this.onChooseDirectory}>Choose</Button>\n        </Row>\n      </DialogContent>\n    )\n  }\n\n  private renderRepositoryList() {\n    if (this.state.loading) {\n      return (\n        <div className=\"clone-github-repo clone-loading\">\n          <Loading /> Loading repositories\n        </div>\n      )\n    }\n\n    return (\n      <ClonableRepositoryFilterList\n        className=\"clone-github-repo\"\n        rowHeight={RowHeight}\n        selectedItem={this.state.selectedItem}\n        renderItem={this.renderItem}\n        renderGroupHeader={this.renderGroupHeader}\n        onItemClick={this.onItemClicked}\n        invalidationProps={this.state.repositories}\n        groups={this.state.repositories}\n        filterText={this.state.filterText}\n        onFilterTextChanged={this.onFilterTextChanged}\n        renderNoItems={this.noMatchingRepositories}\n      />\n    )\n  }\n\n  private noMatchingRepositories = function() {\n    return (\n      <div className=\"no-results-found\">\n        Sorry, I can't find that repository.\n      </div>\n    )\n  }\n\n  private onFilterTextChanged = (filterText: string) => {\n    this.setState({ filterText })\n  }\n\n  private onItemClicked = (item: IClonableRepositoryListItem) => {\n    this.setState({ selectedItem: item })\n    this.props.onGitHubRepositorySelected(item.url)\n  }\n\n  private onChooseDirectory = async () => {\n    const path = await this.props.onChooseDirectory()\n\n    if (path) {\n      this.props.onPathChanged(path)\n    }\n  }\n\n  private onPathChanged = (path: string) => {\n    this.props.onPathChanged(path)\n  }\n\n  private renderGroupHeader = (identifier: string) => {\n    let header = identifier\n    if (identifier === YourRepositoriesIdentifier) {\n      header = __DARWIN__ ? 'Your Repositories' : 'Your repositories'\n    }\n    return (\n      <div className=\"clone-repository-list-content clone-repository-list-group-header\">\n        {header}\n      </div>\n    )\n  }\n\n  private renderItem = (\n    item: IClonableRepositoryListItem,\n    matches: IMatches\n  ) => {\n    return (\n      <div className=\"clone-repository-list-item\">\n        <Octicon className=\"icon\" symbol={item.icon} />\n        <div className=\"name\" title={item.text[0]}>\n          <HighlightText text={item.text[0]} highlight={matches.title} />\n        </div>\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport { TextBox } from '../lib/text-box'\nimport { Button } from '../lib/button'\nimport { Row } from '../lib/row'\nimport { DialogContent } from '../dialog'\nimport { Ref } from '../lib/ref'\n\ninterface ICloneGenericRepositoryProps {\n  /** The URL to clone. */\n  readonly url: string\n\n  /** The path to which the repository should be cloned. */\n  readonly path: string\n\n  /** Called when the destination path changes. */\n  readonly onPathChanged: (path: string) => void\n\n  /** Called when the URL to clone changes. */\n  readonly onUrlChanged: (url: string) => void\n\n  /**\n   * Called when the user should be prompted to choose a directory to clone to.\n   */\n  readonly onChooseDirectory: () => Promise<string | undefined>\n}\n\n/** The component for cloning a repository. */\nexport class CloneGenericRepository extends React.Component<\n  ICloneGenericRepositoryProps,\n  {}\n> {\n  public render() {\n    return (\n      <DialogContent className=\"clone-generic-repository-content\">\n        <Row>\n          <TextBox\n            placeholder=\"URL or username/repository\"\n            value={this.props.url}\n            onValueChanged={this.onUrlChanged}\n            autoFocus={true}\n            label={\n              <span>\n                Repository URL or GitHub username and repository\n                <br />(<Ref>hubot/cool-repo</Ref>)\n              </span>\n            }\n          />\n        </Row>\n\n        <Row>\n          <TextBox\n            value={this.props.path}\n            label={__DARWIN__ ? 'Local Path' : 'Local path'}\n            placeholder=\"repository path\"\n            onValueChanged={this.props.onPathChanged}\n          />\n          <Button onClick={this.onChooseDirectory}>Choose</Button>\n        </Row>\n      </DialogContent>\n    )\n  }\n\n  private onChooseDirectory = async () => {\n    const path = await this.props.onChooseDirectory()\n\n    if (path) {\n      this.props.onPathChanged(path)\n    }\n  }\n\n  private onUrlChanged = (url: string) => {\n    this.props.onUrlChanged(url)\n  }\n}\n","import * as Path from 'path'\nimport * as React from 'react'\nimport { remote } from 'electron'\nimport { pathExists } from 'fs-extra'\n\nimport { Button } from '../lib/button'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { getDefaultDir, setDefaultDir } from '../lib/default-dir'\nimport { Account } from '../../models/account'\nimport {\n  IRepositoryIdentifier,\n  parseRepositoryIdentifier,\n  parseRemote,\n} from '../../lib/remote-parsing'\nimport { findAccountForRemoteURL } from '../../lib/find-account'\nimport { API } from '../../lib/api'\nimport { Dialog, DialogError, DialogFooter, DialogContent } from '../dialog'\nimport { TabBar } from '../tab-bar'\nimport { CloneRepositoryTab } from '../../models/clone-repository-tab'\nimport { CloneGenericRepository } from './clone-generic-repository'\nimport { CloneGithubRepository } from './clone-github-repository'\n\nimport { assertNever } from '../../lib/fatal-error'\nimport { CallToAction } from '../lib/call-to-action'\n\n/** The name for the error when the destination already exists. */\nconst DestinationExistsErrorName = 'DestinationExistsError'\n\ninterface ICloneRepositoryProps {\n  readonly dispatcher: Dispatcher\n  readonly onDismissed: () => void\n\n  /** The logged in accounts. */\n  readonly dotComAccount: Account | null\n\n  /** The logged in Enterprise account. */\n  readonly enterpriseAccount: Account | null\n\n  /** The initial URL or `owner/name` shortcut to use. */\n  readonly initialURL: string | null\n\n  /** The currently select tab. */\n  readonly selectedTab: CloneRepositoryTab\n\n  /** Called when the user selects a tab. */\n  readonly onTabSelected: (tab: CloneRepositoryTab) => void\n}\n\ninterface ICloneRepositoryState {\n  /** The user-entered URL or `owner/name` shortcut. */\n  readonly url: string\n\n  /** The local path to clone to. */\n  readonly path: string\n\n  /** A copy of the path state field which is set when the component initializes.\n   *\n   *  This value, as opposed to the path state variable, doesn't change for the\n   *  lifetime of the component. Used to keep track of whether the user has\n   *  modified the path state field which influences whether we show a\n   *  warning about the directory already existing or not.\n   *\n   *  See the onWindowFocus method for more information.\n   */\n  readonly initialPath: string\n\n  /** Are we currently trying to load the entered repository? */\n  readonly loading: boolean\n\n  /** The current error if one occurred. */\n  readonly error: Error | null\n\n  /**\n   * The repository identifier that was last parsed from the user-entered URL.\n   */\n  readonly lastParsedIdentifier: IRepositoryIdentifier | null\n\n  /** Should the component clear the filter text on render? */\n  readonly shouldClearFilter: boolean\n}\n\n/** The component for cloning a repository. */\nexport class CloneRepository extends React.Component<\n  ICloneRepositoryProps,\n  ICloneRepositoryState\n> {\n  public constructor(props: ICloneRepositoryProps) {\n    super(props)\n\n    const defaultDirectory = getDefaultDir()\n    this.state = {\n      url: this.props.initialURL || '',\n      path: defaultDirectory,\n      initialPath: defaultDirectory,\n      loading: false,\n      error: null,\n      lastParsedIdentifier: null,\n      shouldClearFilter: false,\n    }\n  }\n\n  public componentWillReceiveProps(nextProps: ICloneRepositoryProps) {\n    this.setState({\n      shouldClearFilter: this.props.selectedTab !== nextProps.selectedTab,\n    })\n  }\n\n  public componentDidMount() {\n    const initialURL = this.props.initialURL\n    if (initialURL) {\n      this.updateUrl(initialURL)\n    }\n\n    window.addEventListener('focus', this.onWindowFocus)\n  }\n\n  public componentWillUnmount() {\n    window.removeEventListener('focus', this.onWindowFocus)\n  }\n\n  public render() {\n    const error = this.state.error\n    return (\n      <Dialog\n        className=\"clone-repository\"\n        title={__DARWIN__ ? 'Clone a Repository' : 'Clone a repository'}\n        onSubmit={this.clone}\n        onDismissed={this.props.onDismissed}\n        loading={this.state.loading}\n      >\n        <TabBar\n          onTabClicked={this.onTabClicked}\n          selectedIndex={this.props.selectedTab}\n        >\n          <span>GitHub.com</span>\n          <span>Enterprise</span>\n          <span>URL</span>\n        </TabBar>\n\n        {error ? <DialogError>{error.message}</DialogError> : null}\n\n        {this.renderActiveTab()}\n\n        {this.renderFooter()}\n      </Dialog>\n    )\n  }\n\n  private renderFooter() {\n    const selectedTab = this.props.selectedTab\n    if (\n      selectedTab !== CloneRepositoryTab.Generic &&\n      !this.getAccountForTab(selectedTab)\n    ) {\n      return null\n    }\n\n    const error = this.state.error\n    const disabled =\n      this.state.url.length === 0 ||\n      this.state.path.length === 0 ||\n      this.state.loading ||\n      (!!error && error.name === DestinationExistsErrorName)\n\n    return (\n      <DialogFooter>\n        <ButtonGroup>\n          <Button disabled={disabled} type=\"submit\">\n            Clone\n          </Button>\n          <Button onClick={this.props.onDismissed}>Cancel</Button>\n        </ButtonGroup>\n      </DialogFooter>\n    )\n  }\n\n  private onTabClicked = (tab: CloneRepositoryTab) => {\n    this.props.onTabSelected(tab)\n  }\n\n  private renderActiveTab() {\n    const tab = this.props.selectedTab\n\n    switch (tab) {\n      case CloneRepositoryTab.Generic:\n        return (\n          <CloneGenericRepository\n            path={this.state.path}\n            url={this.state.url}\n            onPathChanged={this.updateAndValidatePath}\n            onUrlChanged={this.updateUrl}\n            onChooseDirectory={this.onChooseDirectory}\n          />\n        )\n\n      case CloneRepositoryTab.DotCom:\n      case CloneRepositoryTab.Enterprise: {\n        const account = this.getAccountForTab(tab)\n        if (!account) {\n          return <DialogContent>{this.renderSignIn(tab)}</DialogContent>\n        } else {\n          return (\n            <CloneGithubRepository\n              path={this.state.path}\n              account={account}\n              onPathChanged={this.updateAndValidatePath}\n              onGitHubRepositorySelected={this.updateUrl}\n              onChooseDirectory={this.onChooseDirectory}\n              shouldClearFilter={this.state.shouldClearFilter}\n            />\n          )\n        }\n      }\n    }\n\n    return assertNever(tab, `Unknown tab: ${tab}`)\n  }\n\n  private getAccountForTab(tab: CloneRepositoryTab): Account | null {\n    switch (tab) {\n      case CloneRepositoryTab.DotCom:\n        return this.props.dotComAccount\n      case CloneRepositoryTab.Enterprise:\n        return this.props.enterpriseAccount\n      default:\n        return null\n    }\n  }\n\n  private renderSignIn(tab: CloneRepositoryTab) {\n    const signInTitle = __DARWIN__ ? 'Sign In' : 'Sign in'\n    switch (tab) {\n      case CloneRepositoryTab.DotCom:\n        return (\n          <CallToAction actionTitle={signInTitle} onAction={this.signInDotCom}>\n            <div>\n              Sign in to your GitHub.com account to access your repositories.\n            </div>\n          </CallToAction>\n        )\n      case CloneRepositoryTab.Enterprise:\n        return (\n          <CallToAction\n            actionTitle={signInTitle}\n            onAction={this.signInEnterprise}\n          >\n            <div>\n              If you have a GitHub Enterprise account at work, sign in to it to\n              get access to your repositories.\n            </div>\n          </CallToAction>\n        )\n      case CloneRepositoryTab.Generic:\n        return null\n      default:\n        return assertNever(tab, `Unknown sign in tab: ${tab}`)\n    }\n  }\n\n  private signInDotCom = () => {\n    this.props.dispatcher.showDotComSignInDialog()\n  }\n\n  private signInEnterprise = () => {\n    this.props.dispatcher.showEnterpriseSignInDialog()\n  }\n\n  private updateAndValidatePath = async (path: string) => {\n    this.setState({ path })\n\n    const doesDirectoryExist = await this.doesPathExist(path)\n\n    if (doesDirectoryExist) {\n      const error: Error = new Error('The destination already exists.')\n      error.name = DestinationExistsErrorName\n\n      this.setState({ error })\n    } else {\n      this.setState({ error: null })\n    }\n  }\n\n  private onChooseDirectory = async () => {\n    const directories = remote.dialog.showOpenDialog({\n      properties: ['createDirectory', 'openDirectory'],\n    })\n\n    if (!directories) {\n      return\n    }\n\n    const lastParsedIdentifier = this.state.lastParsedIdentifier\n    const directory = lastParsedIdentifier\n      ? Path.join(directories[0], lastParsedIdentifier.name)\n      : directories[0]\n\n    this.updateAndValidatePath(directory)\n\n    return directory\n  }\n\n  private updateUrl = async (url: string) => {\n    const parsed = parseRepositoryIdentifier(url)\n    const lastParsedIdentifier = this.state.lastParsedIdentifier\n\n    let newPath: string\n\n    if (lastParsedIdentifier) {\n      if (parsed) {\n        newPath = Path.join(Path.dirname(this.state.path), parsed.name)\n      } else {\n        newPath = Path.dirname(this.state.path)\n      }\n    } else if (parsed) {\n      newPath = Path.join(this.state.path, parsed.name)\n    } else {\n      newPath = this.state.path\n    }\n\n    this.setState({\n      url,\n      lastParsedIdentifier: parsed,\n    })\n\n    this.updateAndValidatePath(newPath)\n  }\n\n  private async doesPathExist(path: string) {\n    const exists = await pathExists(path)\n    // If the path changed while we were checking, we don't care anymore.\n    if (this.state.path !== path) {\n      return\n    }\n\n    return exists\n  }\n\n  /**\n   * Lookup the account associated with the clone (if applicable) and resolve\n   * the repository alias to the clone URL.\n   */\n  private async resolveCloneURL(): Promise<string | null> {\n    const identifier = this.state.lastParsedIdentifier\n    let url = this.state.url\n    const accounts: Array<Account> = []\n    if (this.props.dotComAccount) {\n      accounts.push(this.props.dotComAccount)\n    }\n\n    if (this.props.enterpriseAccount) {\n      accounts.push(this.props.enterpriseAccount)\n    }\n\n    const account = await findAccountForRemoteURL(url, accounts)\n    if (identifier && account) {\n      const api = API.fromAccount(account)\n      const repo = await api.fetchRepository(identifier.owner, identifier.name)\n      if (repo) {\n        // respect the user's preference if they pasted an SSH URL into the\n        // Clone Generic Repository tab\n        const parsedUrl = parseRemote(url)\n        if (parsedUrl && parsedUrl.protocol === 'ssh') {\n          url = repo.ssh_url\n        } else {\n          url = repo.clone_url\n        }\n      }\n    }\n\n    return url\n  }\n\n  private clone = async () => {\n    this.setState({ loading: true })\n\n    const url = await this.resolveCloneURL()\n    const path = this.state.path\n\n    if (!url) {\n      const error = new Error(\n        `We couldn't find that repository. Check that you are logged in, the network is accessible, and the URL or repository alias are spelled correctly.`\n      )\n      this.setState({ loading: false, error })\n      return\n    }\n\n    try {\n      this.cloneImpl(url.trim(), path)\n    } catch (e) {\n      log.error(`CloneRepostiory: clone failed to complete to ${path}`, e)\n      this.setState({ loading: false, error: e })\n    }\n  }\n\n  private cloneImpl(url: string, path: string) {\n    this.props.dispatcher.clone(url, path)\n    this.props.onDismissed()\n\n    setDefaultDir(Path.resolve(path, '..'))\n  }\n\n  private onWindowFocus = () => {\n    // Verify the path after focus has been regained in case changes have been made.\n    const isDefaultPath = this.state.initialPath === this.state.path\n    const isURLNotEntered = this.state.url === ''\n\n    if (isDefaultPath && isURLNotEntered) {\n      if (\n        this.state.error !== null &&\n        this.state.error.name === DestinationExistsErrorName\n      ) {\n        this.setState({ error: null })\n      }\n    } else {\n      this.updateAndValidatePath(this.state.path)\n    }\n  }\n}\n","export * from './clone-repository'\n","import { writeFile } from 'fs-extra'\nimport { join } from 'path'\n\n/**\n * Write the .gitAttributes file to the given repository\n */\nexport async function writeGitAttributes(path: string): Promise<void> {\n  const fullPath = join(path, '.gitattributes')\n  const contents =\n    '# Auto detect text files and perform LF normalization\\n* text=auto\\n'\n  await writeFile(fullPath, contents)\n}\n","import * as Path from 'path'\nimport { writeFile, readFile } from 'fs-extra'\n\nexport interface ILicense {\n  /** The human-readable name. */\n  readonly name: string\n  /** Is the license featured? */\n  readonly featured: boolean\n  /** The actual text of the license. */\n  readonly body: string\n  /** Whether to hide the license from the standard list */\n  readonly hidden: boolean\n}\n\ninterface ILicenseFields {\n  readonly fullname: string\n  readonly email: string\n  readonly project: string\n  readonly description: string\n  readonly year: string\n}\n\nlet cachedLicenses: ReadonlyArray<ILicense> | null = null\n\n/** Get the available licenses. */\nexport async function getLicenses(): Promise<ReadonlyArray<ILicense>> {\n  if (cachedLicenses != null) {\n    return cachedLicenses\n  } else {\n    const licensesMetadataPath = Path.join(\n      __dirname,\n      'static',\n      'available-licenses.json'\n    )\n    const json = await readFile(licensesMetadataPath, 'utf8')\n    const licenses: Array<ILicense> = JSON.parse(json)\n\n    cachedLicenses = licenses.sort((a, b) => {\n      if (a.featured) {\n        return -1\n      }\n      if (b.featured) {\n        return 1\n      }\n      return a.name.localeCompare(b.name)\n    })\n\n    return cachedLicenses\n  }\n}\n\nfunction replaceToken(body: string, token: string, value: string): string {\n  // The license templates are inconsitent :( Sometimes they use [token] and\n  // sometimes {token}. So we'll standardize first to {token} and then do\n  // replacements.\n  const oldPattern = new RegExp(`\\\\[${token}\\\\]`, 'g')\n  const newBody = body.replace(oldPattern, `{${token}}`)\n\n  const newPattern = new RegExp(`\\\\{${token}\\\\}`, 'g')\n  return newBody.replace(newPattern, value)\n}\n\nfunction replaceTokens(\n  body: string,\n  tokens: ReadonlyArray<keyof ILicenseFields>,\n  fields: ILicenseFields\n): string {\n  let newBody = body\n  for (const token of tokens) {\n    const value = fields[token]\n    newBody = replaceToken(newBody, token, value)\n  }\n\n  return newBody\n}\n\n/** Write the license to the the repository at the given path. */\nexport async function writeLicense(\n  repositoryPath: string,\n  license: ILicense,\n  fields: ILicenseFields\n): Promise<void> {\n  const fullPath = Path.join(repositoryPath, 'LICENSE')\n\n  const tokens: ReadonlyArray<keyof ILicenseFields> = [\n    'fullname',\n    'email',\n    'project',\n    'description',\n    'year',\n  ]\n\n  const body = replaceTokens(license.body, tokens, fields)\n  await writeFile(fullPath, body)\n}\n","import * as Path from 'path'\nimport { readdir, writeFile, readFile } from 'fs-extra'\n\nconst GitIgnoreExtension = '.gitignore'\n\nconst root = Path.join(__dirname, 'static', 'gitignore')\n\nlet cachedGitIgnores: Map<string, string> | null = null\n\nasync function getCachedGitIgnores(): Promise<Map<string, string>> {\n  if (cachedGitIgnores != null) {\n    return cachedGitIgnores\n  } else {\n    const files = await readdir(root)\n    const ignoreFiles = files.filter(file => file.endsWith(GitIgnoreExtension))\n\n    cachedGitIgnores = new Map()\n    for (const file of ignoreFiles) {\n      cachedGitIgnores.set(\n        Path.basename(file, GitIgnoreExtension),\n        Path.join(root, file)\n      )\n    }\n\n    return cachedGitIgnores\n  }\n}\n\n/** Get the names of the available gitignores. */\nexport async function getGitIgnoreNames(): Promise<ReadonlyArray<string>> {\n  const gitIgnores = await getCachedGitIgnores()\n  return Array.from(gitIgnores.keys())\n}\n\n/** Get the gitignore based on a name from `getGitIgnoreNames()`. */\nasync function getGitIgnoreText(name: string): Promise<string> {\n  const gitIgnores = await getCachedGitIgnores()\n\n  const path = gitIgnores.get(name)\n  if (!path) {\n    throw new Error(\n      `Unknown gitignore: ${name}. Only names returned from getGitIgnoreNames() can be used.`\n    )\n  }\n\n  return await readFile(path, 'utf8')\n}\n\n/** Write the named gitignore to the repository. */\nexport async function writeGitIgnore(\n  repositoryPath: string,\n  name: string\n): Promise<void> {\n  const fullPath = Path.join(repositoryPath, '.gitignore')\n  const text = await getGitIgnoreText(name)\n  await writeFile(fullPath, text)\n}\n","import { writeFile } from 'fs-extra'\nimport * as Path from 'path'\n\nconst DefaultReadmeName = 'README.md'\n\nfunction defaultReadmeContents(name: string): string {\n  return `# ${name}\\n`\n}\n\n/**\n * Write the default README to the repository with the given name at the path.\n */\nexport async function writeDefaultReadme(\n  path: string,\n  name: string\n): Promise<void> {\n  const fullPath = Path.join(path, DefaultReadmeName)\n  const contents = defaultReadmeContents(name)\n  await writeFile(fullPath, contents)\n}\n","/** Sanitize a proposed repository name by replacing illegal characters. */\nexport function sanitizedRepositoryName(name: string): string {\n  return name.replace(/[^\\w.-]/g, '-')\n}\n","import { remote } from 'electron'\nimport * as React from 'react'\nimport * as Path from 'path'\nimport * as FSE from 'fs-extra'\n\nimport { Dispatcher } from '../../lib/dispatcher'\nimport {\n  initGitRepository,\n  createCommit,\n  getStatus,\n  getAuthorIdentity,\n  isGitRepository,\n} from '../../lib/git'\nimport { sanitizedRepositoryName } from './sanitized-repository-name'\nimport { TextBox } from '../lib/text-box'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Button } from '../lib/button'\nimport { Row } from '../lib/row'\nimport { Checkbox, CheckboxValue } from '../lib/checkbox'\nimport { writeDefaultReadme } from './write-default-readme'\nimport { Select } from '../lib/select'\nimport { writeGitDescription } from '../../lib/git/description'\nimport { getGitIgnoreNames, writeGitIgnore } from './gitignores'\nimport { ILicense, getLicenses, writeLicense } from './licenses'\nimport { writeGitAttributes } from './git-attributes'\nimport { getDefaultDir, setDefaultDir } from '../lib/default-dir'\nimport { Dialog, DialogContent, DialogFooter, DialogError } from '../dialog'\nimport { Octicon, OcticonSymbol } from '../octicons'\nimport { LinkButton } from '../lib/link-button'\nimport { PopupType } from '../../lib/app-state'\n\n/** The sentinel value used to indicate no gitignore should be used. */\nconst NoGitIgnoreValue = 'None'\n\n/** The sentinel value used to indicate no license should be used. */\nconst NoLicenseValue: ILicense = {\n  name: 'None',\n  featured: false,\n  body: '',\n  hidden: false,\n}\n\ninterface ICreateRepositoryProps {\n  readonly dispatcher: Dispatcher\n  readonly onDismissed: () => void\n\n  /** Prefills path input so user doesn't have to. */\n  readonly initialPath?: string\n}\n\ninterface ICreateRepositoryState {\n  readonly path: string\n  readonly name: string\n  readonly description: string\n\n  /** Is the given path able to be written to? */\n  readonly isValidPath: boolean | null\n\n  /** Is the given path already a repository? */\n  readonly isRepository: boolean\n\n  /** Should the repository be created with a default README? */\n  readonly createWithReadme: boolean\n\n  /** Is the repository currently in the process of being created? */\n  readonly creating: boolean\n\n  /** The names for the available gitignores. */\n  readonly gitIgnoreNames: ReadonlyArray<string> | null\n\n  /** The gitignore to include in the repository. */\n  readonly gitIgnore: string\n\n  /** The available licenses. */\n  readonly licenses: ReadonlyArray<ILicense> | null\n\n  /** The license to include in the repository. */\n  readonly license: string\n}\n\n/** The Create New Repository component. */\nexport class CreateRepository extends React.Component<\n  ICreateRepositoryProps,\n  ICreateRepositoryState\n> {\n  public constructor(props: ICreateRepositoryProps) {\n    super(props)\n\n    const path = this.props.initialPath\n      ? this.props.initialPath\n      : getDefaultDir()\n\n    const name = this.props.initialPath\n      ? sanitizedRepositoryName(Path.basename(this.props.initialPath))\n      : ''\n\n    this.state = {\n      path,\n      name,\n      description: '',\n      createWithReadme: false,\n      creating: false,\n      gitIgnoreNames: null,\n      gitIgnore: NoGitIgnoreValue,\n      licenses: null,\n      license: NoLicenseValue.name,\n      isValidPath: null,\n      isRepository: false,\n    }\n  }\n\n  public async componentDidMount() {\n    const gitIgnoreNames = await getGitIgnoreNames()\n    this.setState({ gitIgnoreNames })\n\n    const licenses = await getLicenses()\n    this.setState({ licenses })\n\n    const isRepository = await isGitRepository(this.state.path)\n    this.setState({ isRepository })\n  }\n\n  private onPathChanged = async (path: string) => {\n    const isRepository = await isGitRepository(path)\n\n    this.setState({ isRepository, path, isValidPath: null })\n  }\n\n  private onNameChanged = (name: string) => {\n    this.setState({ name })\n  }\n\n  private onDescriptionChanged = (description: string) => {\n    this.setState({ description })\n  }\n\n  private showFilePicker = async () => {\n    const directory: string[] | null = remote.dialog.showOpenDialog({\n      properties: ['createDirectory', 'openDirectory'],\n    })\n\n    if (!directory) {\n      return\n    }\n\n    const path = directory[0]\n    const isRepository = await isGitRepository(path)\n\n    this.setState({ isRepository, path })\n  }\n\n  private resolveRepositoryRoot = async (): Promise<string> => {\n    const currentPath = this.state.path\n    if (this.props.initialPath && this.props.initialPath === currentPath) {\n      // if the user provided an initial path and didn't change it, we should\n      // validate it is an existing path and use that for the repository\n      try {\n        await FSE.ensureDir(currentPath)\n        return currentPath\n      } catch {}\n    }\n\n    return Path.join(currentPath, sanitizedRepositoryName(this.state.name))\n  }\n\n  private createRepository = async () => {\n    const fullPath = await this.resolveRepositoryRoot()\n\n    try {\n      await FSE.ensureDir(fullPath)\n      this.setState({ isValidPath: true })\n    } catch (e) {\n      if (e.code === 'EACCES' && e.errno === -13) {\n        return this.setState({ isValidPath: false })\n      }\n\n      log.error(\n        `createRepository: the directory at ${fullPath} is not valid`,\n        e\n      )\n      return this.props.dispatcher.postError(e)\n    }\n\n    this.setState({ creating: true })\n\n    try {\n      await initGitRepository(fullPath)\n    } catch (e) {\n      this.setState({ creating: false })\n      log.error(\n        `createRepository: unable to initialize a Git repository at ${fullPath}`,\n        e\n      )\n      return this.props.dispatcher.postError(e)\n    }\n\n    const repositories = await this.props.dispatcher.addRepositories([fullPath])\n    if (repositories.length < 1) {\n      return\n    }\n\n    const repository = repositories[0]\n\n    if (this.state.createWithReadme) {\n      try {\n        await writeDefaultReadme(fullPath, this.state.name)\n      } catch (e) {\n        log.error(`createRepository: unable to write README at ${fullPath}`, e)\n        this.props.dispatcher.postError(e)\n      }\n    }\n\n    const gitIgnore = this.state.gitIgnore\n    if (gitIgnore !== NoGitIgnoreValue) {\n      try {\n        await writeGitIgnore(fullPath, gitIgnore)\n      } catch (e) {\n        log.error(\n          `createRepository: unable to write .gitignore file at ${fullPath}`,\n          e\n        )\n        this.props.dispatcher.postError(e)\n      }\n    }\n\n    const description = this.state.description\n    if (description) {\n      try {\n        await writeGitDescription(fullPath, description)\n      } catch (e) {\n        log.error(\n          `createRepository: unable to write .git/description file at ${fullPath}`,\n          e\n        )\n        this.props.dispatcher.postError(e)\n      }\n    }\n\n    const licenseName =\n      this.state.license === NoLicenseValue.name ? null : this.state.license\n    const license = (this.state.licenses || []).find(\n      l => l.name === licenseName\n    )\n\n    if (license) {\n      try {\n        const author = await getAuthorIdentity(repository)\n\n        await writeLicense(fullPath, license, {\n          fullname: author ? author.name : '',\n          email: author ? author.email : '',\n          year: new Date().getFullYear().toString(),\n          description: '',\n          project: this.state.name,\n        })\n      } catch (e) {\n        log.error(`createRepository: unable to write LICENSE at ${fullPath}`, e)\n        this.props.dispatcher.postError(e)\n      }\n    }\n\n    try {\n      const gitAttributes = Path.join(fullPath, '.gitattributes')\n      const gitAttributesExists = await FSE.pathExists(gitAttributes)\n      if (!gitAttributesExists) {\n        await writeGitAttributes(fullPath)\n      }\n    } catch (e) {\n      log.error(\n        `createRepository: unable to write .gitattributes at ${fullPath}`,\n        e\n      )\n      this.props.dispatcher.postError(e)\n    }\n\n    const status = await getStatus(repository)\n    if (status === null) {\n      this.props.dispatcher.postError(\n        new Error(\n          `Unable to create the new repository because there are too many new files in this directory`\n        )\n      )\n\n      return\n    }\n\n    try {\n      const wd = status.workingDirectory\n      const files = wd.files\n      if (files.length > 0) {\n        await createCommit(repository, 'Initial commit', files)\n      }\n    } catch (e) {\n      log.error(`createRepository: initial commit failed at ${fullPath}`, e)\n      this.props.dispatcher.postError(e)\n    }\n\n    this.setState({ creating: false })\n\n    this.updateDefaultDirectory()\n\n    this.props.dispatcher.selectRepository(repository)\n    this.props.dispatcher.recordCreateRepository()\n    this.props.onDismissed()\n  }\n\n  private updateDefaultDirectory = () => {\n    // don't update the default directory as a result of creating the\n    // repository from an empty folder, because this value will be the\n    // repository path itself\n    if (!this.props.initialPath) {\n      setDefaultDir(this.state.path)\n    }\n  }\n\n  private onCreateWithReadmeChange = (\n    event: React.FormEvent<HTMLInputElement>\n  ) => {\n    this.setState({\n      createWithReadme: event.currentTarget.checked,\n    })\n  }\n\n  private renderSanitizedName() {\n    const sanitizedName = sanitizedRepositoryName(this.state.name)\n    if (this.state.name === sanitizedName) {\n      return null\n    }\n\n    return (\n      <Row className=\"warning-helper-text\">\n        <Octicon symbol={OcticonSymbol.alert} />\n        Will be created as {sanitizedName}\n      </Row>\n    )\n  }\n\n  private onGitIgnoreChange = (event: React.FormEvent<HTMLSelectElement>) => {\n    const gitIgnore = event.currentTarget.value\n    this.setState({ gitIgnore })\n  }\n\n  private onLicenseChange = (event: React.FormEvent<HTMLSelectElement>) => {\n    const license = event.currentTarget.value\n    this.setState({ license })\n  }\n\n  private renderGitIgnores() {\n    const gitIgnores = this.state.gitIgnoreNames || []\n    const options = [NoGitIgnoreValue, ...gitIgnores]\n\n    return (\n      <Row>\n        <Select\n          label={__DARWIN__ ? 'Git Ignore' : 'Git ignore'}\n          value={this.state.gitIgnore}\n          onChange={this.onGitIgnoreChange}\n        >\n          {options.map(n => (\n            <option key={n} value={n}>\n              {n}\n            </option>\n          ))}\n        </Select>\n      </Row>\n    )\n  }\n\n  private renderLicenses() {\n    const licenses = this.state.licenses || []\n    const featuredLicenses = [\n      NoLicenseValue,\n      ...licenses.filter(l => l.featured),\n    ]\n    const nonFeaturedLicenses = licenses.filter(l => !l.featured)\n\n    return (\n      <Row>\n        <Select\n          label=\"License\"\n          value={this.state.license}\n          onChange={this.onLicenseChange}\n        >\n          {featuredLicenses.map(l => (\n            <option key={l.name} value={l.name}>\n              {l.name}\n            </option>\n          ))}\n          <option disabled={true}></option>\n          {nonFeaturedLicenses.map(l => (\n            <option key={l.name} value={l.name}>\n              {l.name}\n            </option>\n          ))}\n        </Select>\n      </Row>\n    )\n  }\n\n  private renderInvalidPathError() {\n    const isValidPath = this.state.isValidPath\n    const pathSet = isValidPath !== null\n\n    if (!pathSet || isValidPath) {\n      return null\n    }\n\n    return (\n      <DialogError>\n        Directory could not be created at this path. You may not have\n        permissions to create a directory here.\n      </DialogError>\n    )\n  }\n\n  private renderGitRepositoryWarning() {\n    const isRepo = this.state.isRepository\n\n    if (this.state.path.length && !isRepo) {\n      return null\n    }\n\n    return (\n      <Row className=\"warning-helper-text\">\n        <Octicon symbol={OcticonSymbol.alert} />\n        <p>\n          This directory appears to be a Git repository. Would you like to{' '}\n          <LinkButton onClick={this.onAddRepositoryClicked}>\n            add this repository\n          </LinkButton>{' '}\n          instead?\n        </p>\n      </Row>\n    )\n  }\n\n  private onAddRepositoryClicked = () => {\n    return this.props.dispatcher.showPopup({\n      type: PopupType.AddRepository,\n      path: this.state.path,\n    })\n  }\n\n  public render() {\n    const disabled =\n      this.state.path.length === 0 ||\n      this.state.name.length === 0 ||\n      this.state.creating ||\n      this.state.isRepository\n\n    const readOnlyPath = !!this.props.initialPath\n\n    return (\n      <Dialog\n        id=\"create-repository\"\n        title={\n          __DARWIN__ ? 'Create a New Repository' : 'Create a new repository'\n        }\n        loading={this.state.creating}\n        onSubmit={this.createRepository}\n        onDismissed={this.props.onDismissed}\n      >\n        {this.renderInvalidPathError()}\n\n        <DialogContent>\n          <Row>\n            <TextBox\n              value={this.state.name}\n              label=\"Name\"\n              placeholder=\"repository name\"\n              onValueChanged={this.onNameChanged}\n              autoFocus={true}\n            />\n          </Row>\n\n          {this.renderSanitizedName()}\n\n          <Row>\n            <TextBox\n              value={this.state.description}\n              label=\"Description\"\n              onValueChanged={this.onDescriptionChanged}\n            />\n          </Row>\n\n          <Row>\n            <TextBox\n              value={this.state.path}\n              label={__DARWIN__ ? 'Local Path' : 'Local path'}\n              placeholder=\"repository path\"\n              onValueChanged={this.onPathChanged}\n              disabled={readOnlyPath}\n            />\n            <Button onClick={this.showFilePicker} disabled={readOnlyPath}>\n              Choose\n            </Button>\n          </Row>\n\n          {this.renderGitRepositoryWarning()}\n\n          <Row>\n            <Checkbox\n              label=\"Initialize this repository with a README\"\n              value={\n                this.state.createWithReadme\n                  ? CheckboxValue.On\n                  : CheckboxValue.Off\n              }\n              onChange={this.onCreateWithReadmeChange}\n            />\n          </Row>\n\n          {this.renderGitIgnores()}\n          {this.renderLicenses()}\n        </DialogContent>\n\n        <DialogFooter>\n          <ButtonGroup>\n            <Button type=\"submit\" disabled={disabled}>\n              {__DARWIN__ ? 'Create Repository' : 'Create repository'}\n            </Button>\n\n            <Button onClick={this.props.onDismissed}>Cancel</Button>\n          </ButtonGroup>\n        </DialogFooter>\n      </Dialog>\n    )\n  }\n}\n","'use strict';\nconst os = require('os');\nconst home = os.homedir();\n\nmodule.exports = str => {\n\tif (typeof str !== 'string') {\n\t\tthrow new TypeError(`Expected a string, got ${typeof str}`);\n\t}\n\n\treturn home ? str.replace(/^~($|\\/|\\\\)/, `${home}$1`) : str;\n};\n","import { remote } from 'electron'\nimport * as React from 'react'\n\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { isGitRepository } from '../../lib/git'\nimport { isBareRepository } from '../../lib/git'\nimport { Button } from '../lib/button'\nimport { ButtonGroup } from '../lib/button-group'\nimport { TextBox } from '../lib/text-box'\nimport { Row } from '../lib/row'\nimport { Dialog, DialogContent, DialogFooter } from '../dialog'\nimport { Octicon, OcticonSymbol } from '../octicons'\nimport { LinkButton } from '../lib/link-button'\nimport { PopupType } from '../../lib/app-state'\nimport * as Path from 'path'\n\nimport untildify = require('untildify')\n\ninterface IAddExistingRepositoryProps {\n  readonly dispatcher: Dispatcher\n  readonly onDismissed: () => void\n\n  /** An optional path to prefill the path text box with.\n   * Defaults to the empty string if not defined.\n   */\n  readonly path?: string\n}\n\ninterface IAddExistingRepositoryState {\n  readonly path: string\n\n  /**\n   * Indicates whether or not the path provided in the path state field exists and\n   * is a valid Git repository. This value is immediately switched\n   * to false when the path changes and updated (if necessary) by the\n   * function, checkIfPathIsRepository.\n   *\n   * If set to false the user will be prevented from submitting this dialog\n   * and given the option to create a new repository instead.\n   */\n  readonly isRepository: boolean\n\n  /**\n   * Indicates whether or not to render a warning message about the entered path\n   * not containing a valid Git repository. This value differs from `isGitRepository` in that it holds\n   * its value when the path changes until we've gotten a definitive answer from the asynchronous\n   * method that the path is, or isn't, a valid repository path. Separating the two means that\n   * we don't toggle visibility of the warning message until it's really necessary, preventing\n   * flickering for our users as they type in a path.\n   */\n  readonly showNonGitRepositoryWarning: boolean\n  readonly isRepositoryBare: boolean\n}\n\n/** The component for adding an existing local repository. */\nexport class AddExistingRepository extends React.Component<\n  IAddExistingRepositoryProps,\n  IAddExistingRepositoryState\n> {\n  public constructor(props: IAddExistingRepositoryProps) {\n    super(props)\n\n    const path = this.props.path ? this.props.path : ''\n\n    this.state = {\n      path,\n      isRepository: false,\n      showNonGitRepositoryWarning: false,\n      isRepositoryBare: false,\n    }\n  }\n\n  public async componentDidMount() {\n    const pathToCheck = this.state.path\n    // We'll only have a path at this point if the dialog was opened with a path\n    // to prefill.\n    if (pathToCheck.length < 1) {\n      return\n    }\n\n    const isRepository = await isGitRepository(pathToCheck)\n    // The path might have changed while we were checking, in which case we\n    // don't care about the result anymore.\n    if (this.state.path !== pathToCheck) {\n      return\n    }\n\n    const isBare = await isBareRepository(this.state.path)\n    if (isBare === true) {\n      this.setState({ isRepositoryBare: true })\n      return\n    }\n\n    this.setState({ isRepository, showNonGitRepositoryWarning: !isRepository })\n    this.setState({ isRepositoryBare: false })\n  }\n\n  private renderWarning() {\n    if (!this.state.path.length || !this.state.showNonGitRepositoryWarning) {\n      return null\n    }\n\n    if (this.state.isRepositoryBare) {\n      return (\n        <Row className=\"warning-helper-text\">\n          <Octicon symbol={OcticonSymbol.alert} />\n          <p>\n            This directory appears to be a bare repository. Bare repositories\n            are not currently supported.\n          </p>\n        </Row>\n      )\n    }\n\n    return (\n      <Row className=\"warning-helper-text\">\n        <Octicon symbol={OcticonSymbol.alert} />\n        <p>\n          This directory does not appear to be a Git repository.\n          <br />\n          Would you like to{' '}\n          <LinkButton onClick={this.onCreateRepositoryClicked}>\n            create a repository\n          </LinkButton>{' '}\n          here instead?\n        </p>\n      </Row>\n    )\n  }\n\n  public render() {\n    const disabled =\n      this.state.path.length === 0 ||\n      !this.state.isRepository ||\n      this.state.isRepositoryBare\n\n    return (\n      <Dialog\n        id=\"add-existing-repository\"\n        title={__DARWIN__ ? 'Add Local Repository' : 'Add local repository'}\n        onSubmit={this.addRepository}\n        onDismissed={this.props.onDismissed}\n      >\n        <DialogContent>\n          <Row>\n            <TextBox\n              value={this.state.path}\n              label={__DARWIN__ ? 'Local Path' : 'Local path'}\n              placeholder=\"repository path\"\n              onValueChanged={this.onPathChanged}\n              autoFocus={true}\n            />\n            <Button onClick={this.showFilePicker}>Choose</Button>\n          </Row>\n          {this.renderWarning()}\n        </DialogContent>\n\n        <DialogFooter>\n          <ButtonGroup>\n            <Button disabled={disabled} type=\"submit\">\n              {__DARWIN__ ? 'Add Repository' : 'Add repository'}\n            </Button>\n            <Button onClick={this.props.onDismissed}>Cancel</Button>\n          </ButtonGroup>\n        </DialogFooter>\n      </Dialog>\n    )\n  }\n\n  private onPathChanged = async (path: string) => {\n    const isRepository = await isGitRepository(path)\n\n    this.setState({ path, isRepository })\n  }\n\n  private showFilePicker = async () => {\n    const directory: string[] | null = remote.dialog.showOpenDialog({\n      properties: ['createDirectory', 'openDirectory'],\n    })\n    if (!directory) {\n      return\n    }\n\n    const path = directory[0]\n    const isRepository = await isGitRepository(path)\n    const isRepositoryBare = await isBareRepository(path)\n\n    this.setState({\n      path,\n      isRepository,\n      showNonGitRepositoryWarning: !isRepository || isRepositoryBare,\n      isRepositoryBare,\n    })\n  }\n\n  private resolvedPath(path: string): string {\n    return Path.resolve('/', untildify(path))\n  }\n\n  private addRepository = async () => {\n    this.props.onDismissed()\n\n    const resolvedPath = this.resolvedPath(this.state.path)\n    const repositories = await this.props.dispatcher.addRepositories([\n      resolvedPath,\n    ])\n\n    if (repositories && repositories.length) {\n      const repository = repositories[0]\n      this.props.dispatcher.selectRepository(repository)\n      this.props.dispatcher.recordAddExistingRepository()\n    }\n  }\n\n  private onCreateRepositoryClicked = () => {\n    const resolvedPath = this.resolvedPath(this.state.path)\n\n    return this.props.dispatcher.showPopup({\n      type: PopupType.CreateRepository,\n      path: resolvedPath,\n    })\n  }\n}\n","export * from './add-existing-repository'\nexport * from './create-repository'\n","import * as React from 'react'\n\nimport { UiView } from './ui-view'\nimport { Dispatcher } from '../lib/dispatcher'\nimport { Repository } from '../models/repository'\n\nimport { Button } from './lib/button'\nimport { Row } from './lib/row'\n\ninterface IMissingRepositoryProps {\n  readonly dispatcher: Dispatcher\n  readonly repository: Repository\n}\n\n/** The view displayed when a repository is missing. */\nexport class MissingRepository extends React.Component<\n  IMissingRepositoryProps,\n  {}\n> {\n  public render() {\n    const buttons = new Array<JSX.Element>()\n    buttons.push(\n      <Button key=\"locate\" onClick={this.locate} type=\"submit\">\n        Locate\n      </Button>\n    )\n\n    if (this.canCloneAgain()) {\n      buttons.push(\n        <Button key=\"clone-again\" onClick={this.cloneAgain}>\n          Clone Again\n        </Button>\n      )\n    }\n\n    buttons.push(\n      <Button key=\"remove\" onClick={this.remove}>\n        Remove\n      </Button>\n    )\n\n    return (\n      <UiView id=\"missing-repository-view\">\n        <div className=\"title-container\">\n          <div className=\"title\">Can't find \"{this.props.repository.name}\"</div>\n          <div className=\"details\">\n            It was last seen at{' '}\n            <span className=\"path\">{this.props.repository.path}</span>\n          </div>\n        </div>\n\n        <Row>{buttons}</Row>\n      </UiView>\n    )\n  }\n\n  private canCloneAgain() {\n    const gitHubRepository = this.props.repository.gitHubRepository\n    return gitHubRepository && gitHubRepository.cloneURL\n  }\n\n  private remove = () => {\n    this.props.dispatcher.removeRepositories([this.props.repository], false)\n  }\n\n  private locate = () => {\n    this.props.dispatcher.relocateRepository(this.props.repository)\n  }\n\n  private cloneAgain = async () => {\n    const gitHubRepository = this.props.repository.gitHubRepository\n    if (!gitHubRepository) {\n      return\n    }\n\n    const cloneURL = gitHubRepository.cloneURL\n    if (!cloneURL) {\n      return\n    }\n\n    try {\n      await this.props.dispatcher.cloneAgain(\n        cloneURL,\n        this.props.repository.path\n      )\n    } catch (error) {\n      this.props.dispatcher.postError(error)\n    }\n  }\n}\n","import * as React from 'react'\n\nimport { Button } from './lib/button'\nimport { ButtonGroup } from './lib/button-group'\nimport { Dialog, DialogContent, DialogFooter } from './dialog'\nimport {\n  dialogTransitionEnterTimeout,\n  dialogTransitionLeaveTimeout,\n} from './app'\nimport { GitError } from '../lib/git/core'\nimport { GitError as GitErrorType } from 'dugite'\nimport { Popup, PopupType } from '../lib/app-state'\nimport { CSSTransitionGroup } from 'react-transition-group'\n\ninterface IAppErrorProps {\n  /** The list of queued, app-wide, errors  */\n  readonly errors: ReadonlyArray<Error>\n\n  /**\n   * A callback which is used whenever a particular error\n   * has been shown to, and been dismissed by, the user.\n   */\n  readonly onClearError: (error: Error) => void\n  readonly onShowPopup: (popupType: Popup) => void | undefined\n}\n\ninterface IAppErrorState {\n  /** The currently displayed error or null if no error is shown */\n  readonly error: Error | null\n\n  /**\n   * Whether or not the dialog and its buttons are disabled.\n   * This is used when the dialog is transitioning out of view.\n   */\n  readonly disabled: boolean\n}\n\n/**\n * A component which renders application-wide errors as dialogs. Only one error\n * is shown per dialog and if multiple errors are queued up they will be shown\n * in the order they were queued.\n */\nexport class AppError extends React.Component<IAppErrorProps, IAppErrorState> {\n  public constructor(props: IAppErrorProps) {\n    super(props)\n    this.state = {\n      error: props.errors[0] || null,\n      disabled: false,\n    }\n  }\n\n  public componentWillReceiveProps(nextProps: IAppErrorProps) {\n    const error = nextProps.errors[0] || null\n\n    // We keep the currently shown error until it has disappeared\n    // from the first spot in the application error queue.\n    if (error !== this.state.error) {\n      this.setState({ error, disabled: false })\n    }\n  }\n\n  private onDismissed = () => {\n    const currentError = this.state.error\n\n    if (currentError) {\n      this.setState({ error: null, disabled: true })\n\n      // Give some time for the dialog to nicely transition\n      // out before we clear the error and, potentially, deal\n      // with the next error in the queue.\n      window.setTimeout(() => {\n        this.props.onClearError(currentError)\n      }, dialogTransitionLeaveTimeout)\n    }\n  }\n\n  private showPreferencesDialog = () => {\n    this.onDismissed()\n\n    //This is a hacky solution to resolve multiple dialog windows\n    //being open at the same time.\n    window.setTimeout(() => {\n      this.props.onShowPopup({ type: PopupType.Preferences })\n    }, dialogTransitionLeaveTimeout)\n  }\n\n  private renderGitErrorFooter(error: GitError) {\n    const gitErrorType = error.result.gitError\n\n    switch (gitErrorType) {\n      case GitErrorType.HTTPSAuthenticationFailed: {\n        return (\n          <ButtonGroup>\n            <Button type=\"submit\" onClick={this.onCloseButtonClick}>\n              Close\n            </Button>\n            <Button onClick={this.showPreferencesDialog}>\n              {__DARWIN__ ? 'Open Preferences' : 'Open options'}\n            </Button>\n          </ButtonGroup>\n        )\n      }\n      default:\n        return (\n          <ButtonGroup>\n            <Button type=\"submit\" onClick={this.onCloseButtonClick}>\n              Close\n            </Button>\n          </ButtonGroup>\n        )\n    }\n  }\n\n  private renderErrorMessage(error: Error) {\n    let monospace = false\n\n    if (error instanceof GitError) {\n      // See getResultMessage in core.ts\n      // If the error message is the same as stderr or stdout then we know\n      // it's output from git and we'll display it in fixed-width font\n      if (\n        error.message === error.result.stderr ||\n        error.message === error.result.stdout\n      ) {\n        monospace = true\n      }\n    }\n\n    const className = monospace ? 'monospace' : undefined\n\n    return <p className={className}>{error.message}</p>\n  }\n\n  private renderDialog() {\n    const error = this.state.error\n\n    if (!error) {\n      return null\n    }\n\n    return (\n      <Dialog\n        id=\"app-error\"\n        type=\"error\"\n        key=\"error\"\n        title=\"Error\"\n        dismissable={false}\n        onDismissed={this.onDismissed}\n        disabled={this.state.disabled}\n      >\n        <DialogContent>{this.renderErrorMessage(error)}</DialogContent>\n        <DialogFooter>{this.renderFooter(error)}</DialogFooter>\n      </Dialog>\n    )\n  }\n\n  private onCloseButtonClick = (e: React.MouseEvent<HTMLButtonElement>) => {\n    e.preventDefault()\n    this.onDismissed()\n  }\n\n  private renderFooter(error: Error) {\n    if (error instanceof GitError) {\n      return this.renderGitErrorFooter(error)\n    }\n\n    return (\n      <ButtonGroup>\n        <Button type=\"submit\" onClick={this.onCloseButtonClick}>\n          Close\n        </Button>\n      </ButtonGroup>\n    )\n  }\n\n  public render() {\n    return (\n      <CSSTransitionGroup\n        transitionName=\"modal\"\n        component=\"div\"\n        transitionEnterTimeout={dialogTransitionEnterTimeout}\n        transitionLeaveTimeout={dialogTransitionLeaveTimeout}\n      >\n        {this.renderDialog()}\n      </CSSTransitionGroup>\n    )\n  }\n}\n","import * as React from 'react'\nimport { DialogContent } from '../dialog'\nimport { LinkButton } from '../lib/link-button'\nimport { CallToAction } from '../lib/call-to-action'\n\nconst HelpURL = 'https://help.github.com/articles/about-remote-repositories/'\n\ninterface INoRemoteProps {\n  /** The function to call when the users chooses to publish. */\n  readonly onPublish: () => void\n}\n\n/** The component for when a repository has no remote. */\nexport class NoRemote extends React.Component<INoRemoteProps, {}> {\n  public render() {\n    return (\n      <DialogContent>\n        <CallToAction actionTitle=\"Publish\" onAction={this.props.onPublish}>\n          <div>\n            Publish your repository to GitHub. Need help?{' '}\n            <LinkButton uri={HelpURL}>Learn more</LinkButton> about remote\n            repositories.\n          </div>\n        </CallToAction>\n      </DialogContent>\n    )\n  }\n}\n","import * as React from 'react'\nimport * as classNames from 'classnames'\nimport { showContextualMenu } from '../main-process-proxy'\n\ninterface ITextAreaProps {\n  /** The label for the textarea field. */\n  readonly label?: string\n\n  /** The class name for the label. */\n  readonly labelClassName?: string\n\n  /** The class name for the textarea field. */\n  readonly textareaClassName?: string\n\n  /** The placeholder for the textarea field. */\n  readonly placeholder?: string\n\n  readonly rows?: number\n\n  /** The current value of the textarea field. */\n  readonly value?: string\n\n  /** Whether the textarea field should auto focus when mounted. */\n  readonly autoFocus?: boolean\n\n  /** Whether the textarea field is disabled. */\n  readonly disabled?: boolean\n\n  /** Called when the user changes the value in the textarea field. */\n  readonly onChange?: (event: React.FormEvent<HTMLTextAreaElement>) => void\n\n  /**\n   * Called when the user changes the value in the textarea.\n   *\n   * This differs from the onChange event in that it passes only the new\n   * value and not the event itself. Subscribe to the onChange event if you\n   * need the ability to prevent the action from occurring.\n   *\n   * This callback will not be invoked if the callback from onChange calls\n   * preventDefault.\n   */\n  readonly onValueChanged?: (value: string) => void\n\n  /** Called on key down. */\n  readonly onKeyDown?: (event: React.KeyboardEvent<HTMLTextAreaElement>) => void\n\n  /** A callback to receive the underlying `textarea` instance. */\n  readonly onTextAreaRef?: (instance: HTMLTextAreaElement | null) => void\n}\n\n/** A textarea element with app-standard styles. */\nexport class TextArea extends React.Component<ITextAreaProps, {}> {\n  private onChange = (event: React.FormEvent<HTMLTextAreaElement>) => {\n    if (this.props.onChange) {\n      this.props.onChange(event)\n    }\n\n    if (this.props.onValueChanged && !event.defaultPrevented) {\n      this.props.onValueChanged(event.currentTarget.value)\n    }\n  }\n  private onContextMenu = (event: React.MouseEvent<any>) => {\n    event.preventDefault()\n    showContextualMenu([{ role: 'editMenu' }])\n  }\n\n  public render() {\n    const className = classNames(\n      'text-area-component',\n      this.props.labelClassName\n    )\n    return (\n      <label className={className}>\n        {this.props.label}\n\n        <textarea\n          autoFocus={this.props.autoFocus}\n          className={this.props.textareaClassName}\n          disabled={this.props.disabled}\n          rows={this.props.rows || 3}\n          placeholder={this.props.placeholder}\n          value={this.props.value}\n          onChange={this.onChange}\n          onKeyDown={this.props.onKeyDown}\n          ref={this.props.onTextAreaRef}\n          onContextMenu={this.onContextMenu}\n        />\n      </label>\n    )\n  }\n}\n","import * as React from 'react'\nimport { DialogContent } from '../dialog'\nimport { TextArea } from '../lib/text-area'\nimport { LinkButton } from '../lib/link-button'\nimport { Ref } from '../lib/ref'\n\ninterface IGitIgnoreProps {\n  readonly text: string | null\n  readonly onIgnoreTextChanged: (text: string) => void\n  readonly onShowExamples: () => void\n}\n\n/** A view for creating or modifying the repository's gitignore file */\nexport class GitIgnore extends React.Component<IGitIgnoreProps, {}> {\n  public render() {\n    return (\n      <DialogContent>\n        <p>\n          Editing <Ref>.gitignore</Ref>. This file specifies intentionally\n          untracked files that Git should ignore. Files already tracked by Git\n          are not affected.{' '}\n          <LinkButton onClick={this.props.onShowExamples}>\n            Learn more\n          </LinkButton>\n        </p>\n\n        <TextArea\n          placeholder=\"Ignored files\"\n          value={this.props.text || ''}\n          onValueChanged={this.props.onIgnoreTextChanged}\n          rows={6}\n        />\n      </DialogContent>\n    )\n  }\n}\n","import * as React from 'react'\nimport { IRemote } from '../../models/remote'\nimport { TextBox } from '../lib/text-box'\nimport { DialogContent } from '../dialog'\n\ninterface IRemoteProps {\n  /** The remote being shown. */\n  readonly remote: IRemote\n\n  /** The function to call when the remote URL is changed by the user. */\n  readonly onRemoteUrlChanged: (url: string) => void\n}\n\n/** The Remote component. */\nexport class Remote extends React.Component<IRemoteProps, {}> {\n  public render() {\n    const remote = this.props.remote\n    return (\n      <DialogContent>\n        <div>Primary remote repository ({remote.name})</div>\n        <TextBox\n          placeholder=\"Remote URL\"\n          value={remote.url}\n          onValueChanged={this.props.onRemoteUrlChanged}\n        />\n      </DialogContent>\n    )\n  }\n}\n","import * as React from 'react'\nimport { TabBar } from '../tab-bar'\nimport { Remote } from './remote'\nimport { GitIgnore } from './git-ignore'\nimport { assertNever } from '../../lib/fatal-error'\nimport { IRemote } from '../../models/remote'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { PopupType } from '../../lib/app-state'\nimport { Repository } from '../../models/repository'\nimport { Button } from '../lib/button'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Dialog, DialogError, DialogFooter } from '../dialog'\nimport { NoRemote } from './no-remote'\nimport { readGitIgnoreAtRoot } from '../../lib/git'\n\ninterface IRepositorySettingsProps {\n  readonly dispatcher: Dispatcher\n  readonly remote: IRemote | null\n  readonly repository: Repository\n  readonly onDismissed: () => void\n}\n\nenum RepositorySettingsTab {\n  Remote = 0,\n  IgnoredFiles,\n}\n\ninterface IRepositorySettingsState {\n  readonly selectedTab: RepositorySettingsTab\n  readonly remote: IRemote | null\n  readonly ignoreText: string | null\n  readonly ignoreTextHasChanged: boolean\n  readonly disabled: boolean\n  readonly errors?: ReadonlyArray<JSX.Element | string>\n}\n\nexport class RepositorySettings extends React.Component<\n  IRepositorySettingsProps,\n  IRepositorySettingsState\n> {\n  public constructor(props: IRepositorySettingsProps) {\n    super(props)\n\n    this.state = {\n      selectedTab: RepositorySettingsTab.Remote,\n      remote: props.remote,\n      ignoreText: null,\n      ignoreTextHasChanged: false,\n      disabled: false,\n    }\n  }\n\n  public async componentWillMount() {\n    try {\n      const ignoreText = await readGitIgnoreAtRoot(this.props.repository)\n      this.setState({ ignoreText })\n    } catch (e) {\n      log.error(\n        `RepositorySettings: unable to read root .gitignore file for ${\n          this.props.repository.path\n        }`,\n        e\n      )\n      this.setState({ errors: [`Could not read root .gitignore: ${e}`] })\n    }\n  }\n\n  private renderErrors(): JSX.Element[] | null {\n    const errors = this.state.errors\n\n    if (!errors || !errors.length) {\n      return null\n    }\n\n    return errors.map((err, ix) => {\n      const key = `err-${ix}`\n      return <DialogError key={key}>{err}</DialogError>\n    })\n  }\n\n  public render() {\n    return (\n      <Dialog\n        id=\"repository-settings\"\n        title={__DARWIN__ ? 'Repository Settings' : 'Repository settings'}\n        onDismissed={this.props.onDismissed}\n        onSubmit={this.onSubmit}\n        disabled={this.state.disabled}\n      >\n        {this.renderErrors()}\n\n        <TabBar\n          onTabClicked={this.onTabClicked}\n          selectedIndex={this.state.selectedTab}\n        >\n          <span>Remote</span>\n          <span>{__DARWIN__ ? 'Ignored Files' : 'Ignored files'}</span>\n        </TabBar>\n\n        {this.renderActiveTab()}\n        {this.renderFooter()}\n      </Dialog>\n    )\n  }\n\n  private renderFooter() {\n    const tab = this.state.selectedTab\n    const remote = this.state.remote\n    if (tab === RepositorySettingsTab.Remote && !remote) {\n      return null\n    }\n\n    return (\n      <DialogFooter>\n        <ButtonGroup>\n          <Button type=\"submit\">Save</Button>\n          <Button onClick={this.props.onDismissed}>Cancel</Button>\n        </ButtonGroup>\n      </DialogFooter>\n    )\n  }\n\n  private renderActiveTab() {\n    const tab = this.state.selectedTab\n    switch (tab) {\n      case RepositorySettingsTab.Remote: {\n        const remote = this.state.remote\n        if (remote) {\n          return (\n            <Remote\n              remote={remote}\n              onRemoteUrlChanged={this.onRemoteUrlChanged}\n            />\n          )\n        } else {\n          return <NoRemote onPublish={this.onPublish} />\n        }\n      }\n      case RepositorySettingsTab.IgnoredFiles: {\n        return (\n          <GitIgnore\n            text={this.state.ignoreText}\n            onIgnoreTextChanged={this.onIgnoreTextChanged}\n            onShowExamples={this.onShowGitIgnoreExamples}\n          />\n        )\n      }\n    }\n\n    return assertNever(tab, `Unknown tab type: ${tab}`)\n  }\n\n  private onPublish = () => {\n    this.props.dispatcher.showPopup({\n      type: PopupType.PublishRepository,\n      repository: this.props.repository,\n    })\n  }\n\n  private onShowGitIgnoreExamples = () => {\n    this.props.dispatcher.openInBrowser('https://git-scm.com/docs/gitignore')\n  }\n\n  private onSubmit = async () => {\n    this.setState({ disabled: true, errors: undefined })\n    const errors = new Array<JSX.Element | string>()\n\n    if (this.state.remote && this.props.remote) {\n      if (this.state.remote.url !== this.props.remote.url) {\n        try {\n          await this.props.dispatcher.setRemoteURL(\n            this.props.repository,\n            this.props.remote.name,\n            this.state.remote.url\n          )\n        } catch (e) {\n          log.error(\n            `RepositorySettings: unable to set remote URL at ${\n              this.props.repository.path\n            }`,\n            e\n          )\n          errors.push(`Failed setting the remote URL: ${e}`)\n        }\n      }\n    }\n\n    if (this.state.ignoreTextHasChanged && this.state.ignoreText !== null) {\n      try {\n        await this.props.dispatcher.saveGitIgnore(\n          this.props.repository,\n          this.state.ignoreText\n        )\n      } catch (e) {\n        log.error(\n          `RepositorySettings: unable to save gitignore at ${\n            this.props.repository.path\n          }`,\n          e\n        )\n        errors.push(`Failed saving the .gitignore file: ${e}`)\n      }\n    }\n\n    if (!errors.length) {\n      this.props.onDismissed()\n    } else {\n      this.setState({ disabled: false, errors })\n    }\n  }\n\n  private onRemoteUrlChanged = (url: string) => {\n    const remote = this.props.remote\n\n    if (!remote) {\n      return\n    }\n\n    const newRemote = { ...remote, url }\n    this.setState({ remote: newRemote })\n  }\n\n  private onIgnoreTextChanged = (text: string) => {\n    this.setState({ ignoreText: text, ignoreTextHasChanged: true })\n  }\n\n  private onTabClicked = (index: number) => {\n    this.setState({ selectedTab: index })\n  }\n}\n","export { RepositorySettings } from './repository-settings'\n","import * as React from 'react'\n\nimport { getAheadBehind, mergeTree } from '../../lib/git'\nimport { Dispatcher } from '../../lib/dispatcher'\n\nimport { Branch } from '../../models/branch'\nimport { Repository } from '../../models/repository'\n\nimport { Button } from '../lib/button'\nimport { ButtonGroup } from '../lib/button-group'\n\nimport { Dialog, DialogContent, DialogFooter } from '../dialog'\nimport { BranchList, IBranchListItem, renderDefaultBranch } from '../branches'\nimport { revSymmetricDifference } from '../../lib/git'\nimport { IMatches } from '../../lib/fuzzy-find'\nimport { enableMergeConflictDetection } from '../../lib/feature-flag'\nimport { MergeResultStatus } from '../../lib/app-state'\nimport { MergeResultKind } from '../../models/merge'\nimport { MergeStatusHeader } from '../history/merge-status-header'\nimport { promiseWithMinimumTimeout } from '../../lib/promise'\n\ninterface IMergeProps {\n  readonly dispatcher: Dispatcher\n  readonly repository: Repository\n\n  /**\n   * See IBranchesState.defaultBranch\n   */\n  readonly defaultBranch: Branch | null\n\n  /**\n   * The currently checked out branch or null if HEAD is detached\n   */\n  readonly currentBranch: Branch | null\n\n  /**\n   * See IBranchesState.allBranches\n   */\n  readonly allBranches: ReadonlyArray<Branch>\n\n  /**\n   * See IBranchesState.recentBranches\n   */\n  readonly recentBranches: ReadonlyArray<Branch>\n\n  /**\n   * The branch to select when the merge dialog is opened\n   */\n  readonly initialBranch?: Branch\n\n  /**\n   * A function that's called when the dialog is dismissed by the user in the\n   * ways described in the Dialog component's dismissable prop.\n   */\n  readonly onDismissed: () => void\n}\n\ninterface IMergeState {\n  /** The currently selected branch. */\n  readonly selectedBranch: Branch | null\n\n  /** The merge result of comparing the selected branch to the current branch */\n  readonly mergeStatus: MergeResultStatus | null\n\n  /**\n   * The number of commits that would be brought in by the merge.\n   * undefined if no branch is selected or still calculating the\n   * number of commits.\n   */\n  readonly commitCount?: number\n\n  /** The filter text to use in the branch selector */\n  readonly filterText: string\n}\n\n/** A component for merging a branch into the current branch. */\nexport class Merge extends React.Component<IMergeProps, IMergeState> {\n  public constructor(props: IMergeProps) {\n    super(props)\n\n    const selectedBranch = this.resolveSelectedBranch()\n\n    this.state = {\n      selectedBranch,\n      commitCount: undefined,\n      filterText: '',\n      mergeStatus: null,\n    }\n  }\n\n  public componentDidMount() {\n    const branch = this.state.selectedBranch\n    if (!branch) {\n      return\n    }\n\n    this.updateMergeStatus(branch)\n  }\n\n  private onFilterTextChanged = (filterText: string) => {\n    this.setState({ filterText })\n  }\n\n  private onSelectionChanged = async (selectedBranch: Branch | null) => {\n    if (selectedBranch != null) {\n      this.setState({ selectedBranch })\n      await this.updateMergeStatus(selectedBranch)\n    } else {\n      this.setState({ selectedBranch, commitCount: 0, mergeStatus: null })\n    }\n  }\n\n  private renderNewMergeInfo() {\n    const { currentBranch } = this.props\n    const { selectedBranch, mergeStatus, commitCount } = this.state\n\n    if (\n      mergeStatus == null ||\n      currentBranch == null ||\n      selectedBranch == null ||\n      currentBranch.name === selectedBranch.name ||\n      commitCount == null\n    ) {\n      return null\n    }\n\n    return (\n      <div className=\"merge-status-component\">\n        <MergeStatusHeader status={this.state.mergeStatus} />\n        <p className=\"merge-info\">\n          {this.renderMergeStatusMessage(\n            mergeStatus,\n            selectedBranch,\n            currentBranch,\n            commitCount\n          )}\n        </p>\n      </div>\n    )\n  }\n\n  private renderMergeStatusMessage(\n    mergeStatus: MergeResultStatus,\n    branch: Branch,\n    currentBranch: Branch,\n    commitCount: number\n  ): JSX.Element {\n    if (mergeStatus.kind === MergeResultKind.Loading) {\n      return this.renderLoadingMergeMessage()\n    }\n\n    if (mergeStatus.kind === MergeResultKind.Clean) {\n      return this.renderCleanMergeMessage(branch, currentBranch, commitCount)\n    }\n\n    if (mergeStatus.kind === MergeResultKind.Invalid) {\n      return this.renderInvalidMergeMessage()\n    }\n\n    return this.renderConflictedMergeMessage(\n      branch,\n      currentBranch,\n      mergeStatus.conflictedFiles\n    )\n  }\n\n  private renderLoadingMergeMessage() {\n    return (\n      <React.Fragment>\n        Checking for ability to merge automatically...\n      </React.Fragment>\n    )\n  }\n\n  private renderCleanMergeMessage(\n    branch: Branch,\n    currentBranch: Branch,\n    commitCount: number\n  ) {\n    const pluralized = commitCount === 1 ? 'commit' : 'commits'\n    return (\n      <React.Fragment>\n        This will merge\n        <strong>{` ${commitCount} ${pluralized}`}</strong>\n        {` from `}\n        <strong>{branch.name}</strong>\n        {` into `}\n        <strong>{currentBranch.name}</strong>\n      </React.Fragment>\n    )\n  }\n\n  private renderInvalidMergeMessage() {\n    return (\n      <React.Fragment>\n        Unable to merge unrelated histories in this repository\n      </React.Fragment>\n    )\n  }\n\n  private renderConflictedMergeMessage(\n    branch: Branch,\n    currentBranch: Branch,\n    count: number\n  ) {\n    const pluralized = count === 1 ? 'file' : 'files'\n    return (\n      <React.Fragment>\n        There will be\n        <strong>{` ${count} conflicted ${pluralized}`}</strong>\n        {` when merging `}\n        <strong>{branch.name}</strong>\n        {` into `}\n        <strong>{currentBranch.name}</strong>\n      </React.Fragment>\n    )\n  }\n\n  private renderOldMergeMessage() {\n    const commitCount = this.state.commitCount\n    const selectedBranch = this.state.selectedBranch\n    const currentBranch = this.props.currentBranch\n\n    if (\n      selectedBranch === null ||\n      currentBranch === null ||\n      currentBranch.name === selectedBranch.name\n    ) {\n      return null\n    }\n\n    if (commitCount === 0) {\n      return <p className=\"merge-info\">Nothing to merge</p>\n    }\n\n    const countPlural = commitCount === 1 ? 'commit' : 'commits'\n    const countText =\n      commitCount === undefined ? (\n        'commits'\n      ) : (\n        <strong>\n          {commitCount} {countPlural}\n        </strong>\n      )\n\n    return (\n      <p className=\"merge-info\">\n        This will bring in {countText}\n        {' from '}\n        <strong>{selectedBranch ? selectedBranch.name : 'HEAD'}</strong>\n      </p>\n    )\n  }\n\n  private renderBranch = (item: IBranchListItem, matches: IMatches) => {\n    return renderDefaultBranch(item, matches, this.props.currentBranch)\n  }\n\n  public render() {\n    const selectedBranch = this.state.selectedBranch\n    const currentBranch = this.props.currentBranch\n\n    const selectedBranchIsNotCurrentBranch =\n      selectedBranch === null ||\n      currentBranch === null ||\n      currentBranch.name === selectedBranch.name\n\n    const invalidBranchState =\n      selectedBranchIsNotCurrentBranch || this.state.commitCount === 0\n\n    const cannotMergeBranch =\n      this.state.mergeStatus != null &&\n      this.state.mergeStatus.kind === MergeResultKind.Invalid\n\n    const disabled = invalidBranchState || cannotMergeBranch\n\n    return (\n      <Dialog\n        id=\"merge\"\n        title={__DARWIN__ ? 'Merge Branch' : 'Merge branch'}\n        onDismissed={this.props.onDismissed}\n        onSubmit={this.merge}\n      >\n        <DialogContent>\n          <BranchList\n            allBranches={this.props.allBranches}\n            currentBranch={currentBranch}\n            defaultBranch={this.props.defaultBranch}\n            recentBranches={this.props.recentBranches}\n            filterText={this.state.filterText}\n            onFilterTextChanged={this.onFilterTextChanged}\n            selectedBranch={selectedBranch}\n            onSelectionChanged={this.onSelectionChanged}\n            canCreateNewBranch={false}\n            renderBranch={this.renderBranch}\n          />\n        </DialogContent>\n        <DialogFooter>\n          <ButtonGroup>\n            <Button type=\"submit\" disabled={disabled}>\n              Merge into{' '}\n              <strong>{currentBranch ? currentBranch.name : ''}</strong>\n            </Button>\n          </ButtonGroup>\n\n          {enableMergeConflictDetection()\n            ? this.renderNewMergeInfo()\n            : this.renderOldMergeMessage()}\n        </DialogFooter>\n      </Dialog>\n    )\n  }\n\n  private async updateMergeStatus(branch: Branch) {\n    this.setState({ mergeStatus: { kind: MergeResultKind.Loading } })\n\n    const { currentBranch } = this.props\n\n    if (enableMergeConflictDetection() && currentBranch != null) {\n      const mergeStatus = await promiseWithMinimumTimeout(\n        () => mergeTree(this.props.repository, currentBranch, branch),\n        500\n      )\n\n      this.setState({ mergeStatus })\n    }\n\n    const range = revSymmetricDifference('', branch.name)\n    const aheadBehind = await getAheadBehind(this.props.repository, range)\n    const commitCount = aheadBehind ? aheadBehind.behind : 0\n\n    if (this.state.selectedBranch !== branch) {\n      // The branch changed while we were waiting on the result of `getAheadBehind`.\n      this.setState({ commitCount: undefined })\n    } else {\n      this.setState({ commitCount })\n    }\n  }\n\n  private merge = () => {\n    const branch = this.state.selectedBranch\n    if (!branch) {\n      return\n    }\n\n    this.props.dispatcher.mergeBranch(\n      this.props.repository,\n      branch.name,\n      this.state.mergeStatus\n    )\n    this.props.dispatcher.closePopup()\n  }\n\n  /**\n   * Returns the branch to use as the selected branch\n   *\n   * The initial branch is used if passed\n   * otherwise, the default branch will be used iff it's\n   * not the currently checked out branch\n   */\n  private resolveSelectedBranch() {\n    const { currentBranch, defaultBranch, initialBranch } = this.props\n\n    if (initialBranch !== undefined) {\n      return initialBranch\n    }\n\n    return currentBranch === defaultBranch ? null : defaultBranch\n  }\n}\n","export { Merge } from './merge'\n","import * as React from 'react'\n\ninterface ISegmentedItemProps {\n  /**\n   * An id for the item, used to assist in accessibility\n   */\n  readonly id: string\n\n  /**\n   * The index of the item among the other choices in the segmented\n   * control. This is passed along to the onClick handler to differentiate\n   * between clicked items.\n   */\n  readonly index: number\n\n  /**\n   * The title for the segmented item. This should be kept short.\n   */\n  readonly title: string\n\n  /**\n   * An optional description which explains the consequences of\n   * selecting this item.\n   */\n  readonly description?: string\n\n  /**\n   * Whether or not the item is currently the active selection among the\n   * other choices in the segmented control.\n   */\n  readonly isSelected: boolean\n\n  /**\n   * A function that's called when a user clicks on the item using\n   * a pointer device.\n   */\n  readonly onClick: (index: number) => void\n}\n\nexport class SegmentedItem extends React.Component<ISegmentedItemProps, {}> {\n  private onClick = () => {\n    this.props.onClick(this.props.index)\n  }\n\n  public render() {\n    const description = this.props.description ? (\n      <p>{this.props.description}</p>\n    ) : (\n      undefined\n    )\n\n    const isSelected = this.props.isSelected\n    const className = isSelected ? 'selected' : undefined\n\n    return (\n      <li\n        className={className}\n        onClick={this.onClick}\n        role=\"radio\"\n        id={this.props.id}\n        aria-checked={isSelected ? 'true' : 'false'}\n      >\n        <div className=\"title\">{this.props.title}</div>\n        {description}\n      </li>\n    )\n  }\n}\n","import * as React from 'react'\nimport { createUniqueId, releaseUniqueId } from '../id-pool'\nimport { SegmentedItem } from './segmented-item'\n\n/**\n * An item which is rendered as a choice in the segmented control.\n */\nexport interface ISegmentedItem {\n  /**\n   * The title for the segmented item. This should be kept short.\n   */\n  readonly title: string\n\n  /**\n   * An optional description which explains the consequences of\n   * selecting this item.\n   */\n  readonly description?: string\n}\n\ninterface IVerticalSegmentedControlProps {\n  /**\n   * An optional label for the segmented control. Will be rendered\n   * as a legend element inside a field group. Consumers are strongly\n   * encouraged to use this in order to aid accessibility.\n   */\n  readonly label?: string\n\n  /**\n   * A set of items to be rendered as choices in the segmented control.\n   * An item must have a title and may (encouraged) also have a description\n   * which explains what the consequences of selecting the items are.\n   */\n  readonly items: ReadonlyArray<ISegmentedItem>\n\n  /**\n   * The currently selected item, denoted by its position in the items\n   * array.\n   */\n  readonly selectedIndex: number\n\n  /**\n   * A function that's called whenever the selected item index changes, either\n   * as a result of a click using a pointer device or as a result of the user\n   * hitting an up/down while the component has focus.\n   */\n  readonly onSelectionChanged: (selectedIndex: number) => void\n}\n\ninterface IVerticalSegmentedControlState {\n  /**\n   * An automatically generated id for the list element used to reference\n   * it from the label element. This is generated once via the id pool when the\n   * component is mounted and then released once the component unmounts.\n   */\n  readonly listId?: string\n}\n\n/**\n * A component for presenting a small number of choices to the user. Equivalent\n * of a radio button group but styled as a vertically oriented segmented control.\n */\nexport class VerticalSegmentedControl extends React.Component<\n  IVerticalSegmentedControlProps,\n  IVerticalSegmentedControlState\n> {\n  private listRef: HTMLUListElement | null = null\n  private formRef: HTMLFormElement | null = null\n\n  public constructor(props: IVerticalSegmentedControlProps) {\n    super(props)\n    this.state = {}\n  }\n\n  private updateListId(label: string | undefined) {\n    if (this.state.listId) {\n      releaseUniqueId(this.state.listId)\n      this.setState({ listId: undefined })\n    }\n\n    if (label) {\n      this.setState({\n        listId: createUniqueId(`VerticalSegmentedControl_${label}`),\n      })\n    }\n  }\n\n  public componentWillMount() {\n    this.updateListId(this.props.label)\n  }\n\n  public componentWillUnmount() {\n    if (this.state.listId) {\n      releaseUniqueId(this.state.listId)\n    }\n  }\n\n  public componentWillReceiveProps(nextProps: IVerticalSegmentedControlProps) {\n    if (this.props.label !== nextProps.label) {\n      this.updateListId(nextProps.label)\n    }\n  }\n\n  private onItemClick = (index: number) => {\n    if (index !== this.props.selectedIndex) {\n      this.props.onSelectionChanged(index)\n    }\n  }\n\n  private getListItemId(index: number) {\n    return `${this.state.listId}_Item_${index}`\n  }\n\n  private renderItem(item: ISegmentedItem, index: number, selected: boolean) {\n    return (\n      <SegmentedItem\n        id={this.getListItemId(index)}\n        key={index}\n        title={item.title}\n        description={item.description}\n        index={index}\n        isSelected={selected}\n        onClick={this.onItemClick}\n      />\n    )\n  }\n\n  private onKeyDown = (event: React.KeyboardEvent<HTMLUListElement>) => {\n    if (event.key === 'ArrowUp') {\n      if (this.props.selectedIndex > 0) {\n        this.props.onSelectionChanged(this.props.selectedIndex - 1)\n      }\n      event.preventDefault()\n    } else if (event.key === 'ArrowDown') {\n      if (this.props.selectedIndex < this.props.items.length - 1) {\n        this.props.onSelectionChanged(this.props.selectedIndex + 1)\n      }\n      event.preventDefault()\n    } else if (event.key === 'Enter') {\n      const form = this.formRef\n      if (form) {\n        // NB: In order to play nicely with React's custom event dispatching,\n        // we dispatch an event instead of calling `submit` directly on the\n        // form.\n        form.dispatchEvent(new Event('submit'))\n      }\n    }\n  }\n\n  private onListRef = (ref: HTMLUListElement | null) => {\n    this.listRef = ref\n  }\n\n  private onFieldsetRef = (ref: HTMLFieldSetElement | null) => {\n    this.formRef = ref ? ref.form : null\n  }\n\n  private onLegendClick = () => {\n    if (this.listRef) {\n      this.listRef.focus()\n    }\n  }\n\n  public render() {\n    if (!this.props.items.length) {\n      return null\n    }\n\n    const selectedIndex = this.props.selectedIndex\n    const label = this.props.label ? (\n      <legend onClick={this.onLegendClick}>{this.props.label}</legend>\n    ) : (\n      undefined\n    )\n\n    const activeDescendant = this.getListItemId(selectedIndex)\n\n    // Using a fieldset with a legend seems to be the way to go here since\n    // we can't use a label to point to a list (https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Content_categories#Form_labelable).\n    // See http://stackoverflow.com/a/13273907/2114\n    return (\n      <fieldset className=\"vertical-segmented-control\" ref={this.onFieldsetRef}>\n        {label}\n        <ul\n          ref={this.onListRef}\n          id={this.state.listId}\n          className=\"vertical-segmented-control\"\n          tabIndex={0}\n          onKeyDown={this.onKeyDown}\n          role=\"radiogroup\"\n          aria-activedescendant={activeDescendant}\n        >\n          {this.props.items.map((item, index) =>\n            this.renderItem(item, index, index === selectedIndex)\n          )}\n        </ul>\n      </fieldset>\n    )\n  }\n}\n","import * as React from 'react'\nimport { DialogContent } from '../dialog'\nimport {\n  VerticalSegmentedControl,\n  ISegmentedItem,\n} from '../lib/vertical-segmented-control'\nimport { ApplicationTheme } from '../lib/application-theme'\nimport { fatalError } from '../../lib/fatal-error'\n\ninterface IAppearanceProps {\n  readonly selectedTheme: ApplicationTheme\n  readonly onSelectedThemeChanged: (theme: ApplicationTheme) => void\n}\n\nconst themes: ReadonlyArray<ISegmentedItem> = [\n  { title: 'Light', description: 'The default theme of GitHub Desktop' },\n  {\n    title: 'Dark (beta)',\n    description:\n      'A beta version of our dark theme. Still under development. Please report any issues you may find to our issue tracker.',\n  },\n]\n\nexport class Appearance extends React.Component<IAppearanceProps, {}> {\n  private onSelectedThemeChanged = (index: number) => {\n    if (index === 0) {\n      this.props.onSelectedThemeChanged(ApplicationTheme.Light)\n    } else if (index === 1) {\n      this.props.onSelectedThemeChanged(ApplicationTheme.Dark)\n    } else {\n      fatalError(`Unknown theme index ${index}`)\n    }\n  }\n\n  public render() {\n    const selectedIndex =\n      this.props.selectedTheme === ApplicationTheme.Dark ? 1 : 0\n\n    return (\n      <DialogContent>\n        <VerticalSegmentedControl\n          items={themes}\n          selectedIndex={selectedIndex}\n          onSelectionChanged={this.onSelectedThemeChanged}\n        />\n      </DialogContent>\n    )\n  }\n}\n","import { fatalError } from '../../lib/fatal-error'\n\nexport function disallowedCharacters(values: string): string | null {\n  if (values.length === 0) {\n    return null\n  }\n\n  for (const value of values) {\n    if (disallowedCharacter(value) === false) {\n      return null\n    }\n  }\n  return values\n}\n\nfunction disallowedCharacter(value: string): boolean {\n  if (value.length !== 1) {\n    return fatalError('`value` must be a single character')\n  }\n\n  const disallowedCharacters = [\n    '.',\n    ',',\n    ':',\n    ';',\n    '<',\n    '>',\n    '\"',\n    '\\\\',\n    \"'\",\n    ' ',\n  ]\n  const hasDisallowedCharacter = disallowedCharacters.indexOf(value) >= 0\n  const hasDisallowedAsciiCharacter = value.charCodeAt(0) <= 32\n\n  return hasDisallowedCharacter || hasDisallowedAsciiCharacter\n}\n","import * as React from 'react'\nimport { TextBox } from '../lib/text-box'\nimport { Row } from '../lib/row'\nimport { DialogContent } from '../dialog'\n\ninterface IGitProps {\n  readonly name: string\n  readonly email: string\n\n  readonly onNameChanged: (name: string) => void\n  readonly onEmailChanged: (email: string) => void\n}\n\nexport class Git extends React.Component<IGitProps, {}> {\n  public render() {\n    return (\n      <DialogContent>\n        <Row>\n          <TextBox\n            label=\"Name\"\n            value={this.props.name}\n            onValueChanged={this.props.onNameChanged}\n            autoFocus={true}\n          />\n        </Row>\n        <Row>\n          <TextBox\n            label=\"Email\"\n            value={this.props.email}\n            onValueChanged={this.props.onEmailChanged}\n          />\n        </Row>\n      </DialogContent>\n    )\n  }\n}\n","import * as React from 'react'\nimport { DialogContent } from '../dialog'\nimport { Checkbox, CheckboxValue } from '../lib/checkbox'\nimport { LinkButton } from '../lib/link-button'\nimport { Row } from '../../ui/lib/row'\nimport { SamplesURL } from '../../lib/stats'\nimport { Select } from '../lib/select'\nimport { ExternalEditor, parse as parseEditor } from '../../lib/editors'\nimport { Shell, parse as parseShell } from '../../lib/shells'\nimport { TextBox } from '../lib/text-box'\nimport { enableMergeTool } from '../../lib/feature-flag'\nimport { IMergeTool } from '../../lib/git/config'\n\ninterface IAdvancedPreferencesProps {\n  readonly optOutOfUsageTracking: boolean\n  readonly confirmRepositoryRemoval: boolean\n  readonly confirmDiscardChanges: boolean\n  readonly availableEditors: ReadonlyArray<ExternalEditor>\n  readonly selectedExternalEditor?: ExternalEditor\n  readonly availableShells: ReadonlyArray<Shell>\n  readonly selectedShell: Shell\n  readonly onOptOutofReportingchanged: (checked: boolean) => void\n  readonly onConfirmDiscardChangesChanged: (checked: boolean) => void\n  readonly onConfirmRepositoryRemovalChanged: (checked: boolean) => void\n  readonly onSelectedEditorChanged: (editor: ExternalEditor) => void\n  readonly onSelectedShellChanged: (shell: Shell) => void\n\n  readonly mergeTool: IMergeTool | null\n  readonly onMergeToolNameChanged: (name: string) => void\n  readonly onMergeToolCommandChanged: (command: string) => void\n}\n\ninterface IAdvancedPreferencesState {\n  readonly optOutOfUsageTracking: boolean\n  readonly selectedExternalEditor?: ExternalEditor\n  readonly selectedShell: Shell\n  readonly confirmRepositoryRemoval: boolean\n  readonly confirmDiscardChanges: boolean\n}\n\nexport class Advanced extends React.Component<\n  IAdvancedPreferencesProps,\n  IAdvancedPreferencesState\n> {\n  public constructor(props: IAdvancedPreferencesProps) {\n    super(props)\n\n    this.state = {\n      optOutOfUsageTracking: this.props.optOutOfUsageTracking,\n      confirmRepositoryRemoval: this.props.confirmRepositoryRemoval,\n      confirmDiscardChanges: this.props.confirmDiscardChanges,\n      selectedExternalEditor: this.props.selectedExternalEditor,\n      selectedShell: this.props.selectedShell,\n    }\n  }\n\n  public async componentWillReceiveProps(nextProps: IAdvancedPreferencesProps) {\n    const editors = nextProps.availableEditors\n    let selectedExternalEditor = nextProps.selectedExternalEditor\n    if (editors.length) {\n      const indexOf = selectedExternalEditor\n        ? editors.indexOf(selectedExternalEditor)\n        : -1\n      if (indexOf === -1) {\n        selectedExternalEditor = editors[0]\n        nextProps.onSelectedEditorChanged(selectedExternalEditor)\n      }\n    }\n\n    const shells = nextProps.availableShells\n    let selectedShell = nextProps.selectedShell\n    if (shells.length) {\n      const indexOf = shells.indexOf(selectedShell)\n      if (indexOf === -1) {\n        selectedShell = shells[0]\n        nextProps.onSelectedShellChanged(selectedShell)\n      }\n    }\n\n    this.setState({\n      selectedExternalEditor,\n      selectedShell,\n    })\n  }\n\n  private onReportingOptOutChanged = (\n    event: React.FormEvent<HTMLInputElement>\n  ) => {\n    const value = !event.currentTarget.checked\n\n    this.setState({ optOutOfUsageTracking: value })\n    this.props.onOptOutofReportingchanged(value)\n  }\n\n  private onConfirmDiscardChangesChanged = (\n    event: React.FormEvent<HTMLInputElement>\n  ) => {\n    const value = event.currentTarget.checked\n\n    this.setState({ confirmDiscardChanges: value })\n    this.props.onConfirmDiscardChangesChanged(value)\n  }\n\n  private onConfirmRepositoryRemovalChanged = (\n    event: React.FormEvent<HTMLInputElement>\n  ) => {\n    const value = event.currentTarget.checked\n\n    this.setState({ confirmRepositoryRemoval: value })\n    this.props.onConfirmRepositoryRemovalChanged(value)\n  }\n\n  private onSelectedEditorChanged = (\n    event: React.FormEvent<HTMLSelectElement>\n  ) => {\n    const value = parseEditor(event.currentTarget.value)\n    if (value) {\n      this.setState({ selectedExternalEditor: value })\n      this.props.onSelectedEditorChanged(value)\n    }\n  }\n\n  private onSelectedShellChanged = (\n    event: React.FormEvent<HTMLSelectElement>\n  ) => {\n    const value = parseShell(event.currentTarget.value)\n    this.setState({ selectedShell: value })\n    this.props.onSelectedShellChanged(value)\n  }\n\n  public reportDesktopUsageLabel() {\n    return (\n      <span>\n        Help GitHub Desktop improve by submitting{' '}\n        <LinkButton uri={SamplesURL}>anonymous usage data</LinkButton>\n      </span>\n    )\n  }\n\n  private renderExternalEditor() {\n    const options = this.props.availableEditors\n    const label = __DARWIN__ ? 'External Editor' : 'External editor'\n\n    if (options.length === 0) {\n      // this is emulating the <Select/> component's UI so the styles are\n      // consistent for either case.\n      //\n      // TODO: see whether it makes sense to have a fallback UI\n      // which we display when the select list is empty\n      return (\n        <div className=\"select-component no-options-found\">\n          <label>{label}</label>\n          <span>\n            No editors found.{' '}\n            <LinkButton uri=\"https://atom.io/\">Install Atom?</LinkButton>\n          </span>\n        </div>\n      )\n    }\n\n    return (\n      <Select\n        label={label}\n        value={this.state.selectedExternalEditor}\n        onChange={this.onSelectedEditorChanged}\n      >\n        {options.map(n => (\n          <option key={n} value={n}>\n            {n}\n          </option>\n        ))}\n      </Select>\n    )\n  }\n\n  private renderSelectedShell() {\n    const options = this.props.availableShells\n\n    return (\n      <Select\n        label=\"Shell\"\n        value={this.state.selectedShell}\n        onChange={this.onSelectedShellChanged}\n      >\n        {options.map(n => (\n          <option key={n} value={n}>\n            {n}\n          </option>\n        ))}\n      </Select>\n    )\n  }\n\n  private renderMergeTool() {\n    if (!enableMergeTool()) {\n      return null\n    }\n\n    const mergeTool = this.props.mergeTool\n\n    return (\n      <div className=\"brutalism\">\n        <strong>{__DARWIN__ ? 'Merge Tool' : 'Merge tool'}</strong>\n\n        <Row>\n          <TextBox\n            placeholder=\"Name\"\n            value={mergeTool ? mergeTool.name : ''}\n            onValueChanged={this.props.onMergeToolNameChanged}\n          />\n        </Row>\n\n        <Row>\n          <TextBox\n            placeholder=\"Command\"\n            value={mergeTool && mergeTool.command ? mergeTool.command : ''}\n            onValueChanged={this.props.onMergeToolCommandChanged}\n          />\n        </Row>\n      </div>\n    )\n  }\n\n  public render() {\n    return (\n      <DialogContent>\n        <Row>{this.renderExternalEditor()}</Row>\n        <Row>{this.renderSelectedShell()}</Row>\n        {this.renderMergeTool()}\n        <Row>\n          <Checkbox\n            label={this.reportDesktopUsageLabel()}\n            value={\n              this.state.optOutOfUsageTracking\n                ? CheckboxValue.Off\n                : CheckboxValue.On\n            }\n            onChange={this.onReportingOptOutChanged}\n          />\n        </Row>\n        <Row>\n          <Checkbox\n            label=\"Show confirmation dialog before removing repositories\"\n            value={\n              this.state.confirmRepositoryRemoval\n                ? CheckboxValue.On\n                : CheckboxValue.Off\n            }\n            onChange={this.onConfirmRepositoryRemovalChanged}\n          />\n        </Row>\n        <Row>\n          <Checkbox\n            label=\"Show confirmation dialog before discarding changes\"\n            value={\n              this.state.confirmDiscardChanges\n                ? CheckboxValue.On\n                : CheckboxValue.Off\n            }\n            onChange={this.onConfirmDiscardChangesChanged}\n          />\n        </Row>\n      </DialogContent>\n    )\n  }\n}\n","import * as React from 'react'\nimport { Account } from '../../models/account'\nimport { IAvatarUser } from '../../models/avatar'\nimport { lookupPreferredEmail } from '../../lib/email'\nimport { assertNever } from '../../lib/fatal-error'\nimport { Button } from '../lib/button'\nimport { Row } from '../lib/row'\nimport { DialogContent } from '../dialog'\nimport { Avatar } from '../lib/avatar'\nimport { CallToAction } from '../lib/call-to-action'\n\ninterface IAccountsProps {\n  readonly dotComAccount: Account | null\n  readonly enterpriseAccount: Account | null\n\n  readonly onDotComSignIn: () => void\n  readonly onEnterpriseSignIn: () => void\n  readonly onLogout: (account: Account) => void\n}\n\nenum SignInType {\n  DotCom,\n  Enterprise,\n}\n\nexport class Accounts extends React.Component<IAccountsProps, {}> {\n  public render() {\n    return (\n      <DialogContent className=\"accounts-tab\">\n        <h2>GitHub.com</h2>\n        {this.props.dotComAccount\n          ? this.renderAccount(this.props.dotComAccount)\n          : this.renderSignIn(SignInType.DotCom)}\n\n        <h2>Enterprise</h2>\n        {this.props.enterpriseAccount\n          ? this.renderAccount(this.props.enterpriseAccount)\n          : this.renderSignIn(SignInType.Enterprise)}\n      </DialogContent>\n    )\n  }\n\n  private renderAccount(account: Account) {\n    const found = lookupPreferredEmail(account.emails)\n    const email = found ? found.email : ''\n\n    const avatarUser: IAvatarUser = {\n      name: account.name,\n      email: email,\n      avatarURL: account.avatarURL,\n    }\n\n    return (\n      <Row className=\"account-info\">\n        <Avatar user={avatarUser} />\n        <div className=\"user-info\">\n          <div className=\"name\">{account.name}</div>\n          <div className=\"login\">@{account.login}</div>\n        </div>\n        <Button onClick={this.logout(account)}>\n          {__DARWIN__ ? 'Sign Out' : 'Sign out'}\n        </Button>\n      </Row>\n    )\n  }\n\n  private onDotComSignIn = () => {\n    this.props.onDotComSignIn()\n  }\n\n  private onEnterpriseSignIn = () => {\n    this.props.onEnterpriseSignIn()\n  }\n\n  private renderSignIn(type: SignInType) {\n    const signInTitle = __DARWIN__ ? 'Sign In' : 'Sign in'\n    switch (type) {\n      case SignInType.DotCom: {\n        return (\n          <CallToAction\n            actionTitle={signInTitle}\n            onAction={this.onDotComSignIn}\n          >\n            <div>\n              Sign in to your GitHub.com account to access your repositories.\n            </div>\n          </CallToAction>\n        )\n      }\n      case SignInType.Enterprise:\n        return (\n          <CallToAction\n            actionTitle={signInTitle}\n            onAction={this.onEnterpriseSignIn}\n          >\n            <div>\n              If you have a GitHub Enterprise account at work, sign in to it to\n              get access to your repositories.\n            </div>\n          </CallToAction>\n        )\n      default:\n        return assertNever(type, `Unknown sign in type: ${type}`)\n    }\n  }\n\n  private logout = (account: Account) => {\n    return () => {\n      this.props.onLogout(account)\n    }\n  }\n}\n","import * as React from 'react'\nimport { Account } from '../../models/account'\nimport { PreferencesTab } from '../../models/preferences'\nimport { ExternalEditor } from '../../lib/editors'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { TabBar } from '../tab-bar'\nimport { Accounts } from './accounts'\nimport { Advanced } from './advanced'\nimport { Git } from './git'\nimport { assertNever } from '../../lib/fatal-error'\nimport { Button } from '../lib/button'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Dialog, DialogFooter, DialogError } from '../dialog'\nimport {\n  getGlobalConfigValue,\n  setGlobalConfigValue,\n  getMergeTool,\n  IMergeTool,\n} from '../../lib/git/config'\nimport { lookupPreferredEmail } from '../../lib/email'\nimport { Shell, getAvailableShells } from '../../lib/shells'\nimport { getAvailableEditors } from '../../lib/editors/lookup'\nimport { disallowedCharacters } from './identifier-rules'\nimport { Appearance } from './appearance'\nimport { ApplicationTheme } from '../lib/application-theme'\n\ninterface IPreferencesProps {\n  readonly dispatcher: Dispatcher\n  readonly dotComAccount: Account | null\n  readonly enterpriseAccount: Account | null\n  readonly onDismissed: () => void\n  readonly optOutOfUsageTracking: boolean\n  readonly initialSelectedTab?: PreferencesTab\n  readonly confirmRepositoryRemoval: boolean\n  readonly confirmDiscardChanges: boolean\n  readonly selectedExternalEditor?: ExternalEditor\n  readonly selectedShell: Shell\n  readonly selectedTheme: ApplicationTheme\n}\n\ninterface IPreferencesState {\n  readonly selectedIndex: PreferencesTab\n  readonly committerName: string\n  readonly committerEmail: string\n  readonly disallowedCharactersMessage: string | null\n  readonly optOutOfUsageTracking: boolean\n  readonly confirmRepositoryRemoval: boolean\n  readonly confirmDiscardChanges: boolean\n  readonly availableEditors: ReadonlyArray<ExternalEditor>\n  readonly selectedExternalEditor?: ExternalEditor\n  readonly availableShells: ReadonlyArray<Shell>\n  readonly selectedShell: Shell\n  readonly mergeTool: IMergeTool | null\n}\n\n/** The app-level preferences component. */\nexport class Preferences extends React.Component<\n  IPreferencesProps,\n  IPreferencesState\n> {\n  public constructor(props: IPreferencesProps) {\n    super(props)\n\n    this.state = {\n      selectedIndex: this.props.initialSelectedTab || PreferencesTab.Accounts,\n      committerName: '',\n      committerEmail: '',\n      disallowedCharactersMessage: null,\n      availableEditors: [],\n      optOutOfUsageTracking: false,\n      confirmRepositoryRemoval: false,\n      confirmDiscardChanges: false,\n      selectedExternalEditor: this.props.selectedExternalEditor,\n      availableShells: [],\n      selectedShell: this.props.selectedShell,\n      mergeTool: null,\n    }\n  }\n\n  public async componentWillMount() {\n    let committerName = await getGlobalConfigValue('user.name')\n    let committerEmail = await getGlobalConfigValue('user.email')\n\n    if (!committerName || !committerEmail) {\n      const account = this.props.dotComAccount || this.props.enterpriseAccount\n\n      if (account) {\n        if (!committerName) {\n          committerName = account.login\n        }\n\n        if (!committerEmail) {\n          const found = lookupPreferredEmail(account.emails)\n          if (found) {\n            committerEmail = found.email\n          }\n        }\n      }\n    }\n\n    committerName = committerName || ''\n    committerEmail = committerEmail || ''\n\n    const [editors, shells, mergeTool] = await Promise.all([\n      getAvailableEditors(),\n      getAvailableShells(),\n      getMergeTool(),\n    ])\n\n    const availableEditors = editors.map(e => e.editor)\n    const availableShells = shells.map(e => e.shell)\n\n    this.setState({\n      committerName,\n      committerEmail,\n      optOutOfUsageTracking: this.props.optOutOfUsageTracking,\n      confirmRepositoryRemoval: this.props.confirmRepositoryRemoval,\n      confirmDiscardChanges: this.props.confirmDiscardChanges,\n      availableShells,\n      availableEditors,\n      mergeTool,\n    })\n  }\n\n  public render() {\n    return (\n      <Dialog\n        id=\"preferences\"\n        title={__DARWIN__ ? 'Preferences' : 'Options'}\n        onDismissed={this.props.onDismissed}\n        onSubmit={this.onSave}\n      >\n        {this.renderDisallowedCharactersError()}\n        <TabBar\n          onTabClicked={this.onTabClicked}\n          selectedIndex={this.state.selectedIndex}\n        >\n          <span>Accounts</span>\n          <span>Git</span>\n          <span>Appearance</span>\n          <span>Advanced</span>\n        </TabBar>\n\n        {this.renderActiveTab()}\n        {this.renderFooter()}\n      </Dialog>\n    )\n  }\n\n  private onDotComSignIn = () => {\n    this.props.onDismissed()\n    this.props.dispatcher.showDotComSignInDialog()\n  }\n\n  private onEnterpriseSignIn = () => {\n    this.props.onDismissed()\n    this.props.dispatcher.showEnterpriseSignInDialog()\n  }\n\n  private onLogout = (account: Account) => {\n    this.props.dispatcher.removeAccount(account)\n  }\n\n  private disallowedCharacterErrorMessage(name: string, email: string) {\n    const disallowedNameCharacters = disallowedCharacters(name)\n    if (disallowedNameCharacters != null) {\n      return `Git name field cannot be a disallowed character \"${disallowedNameCharacters}\"`\n    }\n\n    const disallowedEmailCharacters = disallowedCharacters(email)\n    if (disallowedEmailCharacters != null) {\n      return `Git email field cannot be a disallowed character \"${disallowedEmailCharacters}\"`\n    }\n\n    return null\n  }\n\n  private renderDisallowedCharactersError() {\n    const message = this.state.disallowedCharactersMessage\n    if (message != null) {\n      return <DialogError>{message}</DialogError>\n    } else {\n      return null\n    }\n  }\n\n  private renderActiveTab() {\n    const index = this.state.selectedIndex\n    switch (index) {\n      case PreferencesTab.Accounts:\n        return (\n          <Accounts\n            dotComAccount={this.props.dotComAccount}\n            enterpriseAccount={this.props.enterpriseAccount}\n            onDotComSignIn={this.onDotComSignIn}\n            onEnterpriseSignIn={this.onEnterpriseSignIn}\n            onLogout={this.onLogout}\n          />\n        )\n      case PreferencesTab.Git: {\n        return (\n          <Git\n            name={this.state.committerName}\n            email={this.state.committerEmail}\n            onNameChanged={this.onCommitterNameChanged}\n            onEmailChanged={this.onCommitterEmailChanged}\n          />\n        )\n      }\n      case PreferencesTab.Appearance:\n        return (\n          <Appearance\n            selectedTheme={this.props.selectedTheme}\n            onSelectedThemeChanged={this.onSelectedThemeChanged}\n          />\n        )\n      case PreferencesTab.Advanced: {\n        return (\n          <Advanced\n            optOutOfUsageTracking={this.state.optOutOfUsageTracking}\n            confirmRepositoryRemoval={this.state.confirmRepositoryRemoval}\n            confirmDiscardChanges={this.state.confirmDiscardChanges}\n            availableEditors={this.state.availableEditors}\n            selectedExternalEditor={this.state.selectedExternalEditor}\n            onOptOutofReportingchanged={this.onOptOutofReportingChanged}\n            onConfirmRepositoryRemovalChanged={\n              this.onConfirmRepositoryRemovalChanged\n            }\n            onConfirmDiscardChangesChanged={this.onConfirmDiscardChangesChanged}\n            onSelectedEditorChanged={this.onSelectedEditorChanged}\n            availableShells={this.state.availableShells}\n            selectedShell={this.state.selectedShell}\n            onSelectedShellChanged={this.onSelectedShellChanged}\n            mergeTool={this.state.mergeTool}\n            onMergeToolCommandChanged={this.onMergeToolCommandChanged}\n            onMergeToolNameChanged={this.onMergeToolNameChanged}\n          />\n        )\n      }\n      default:\n        return assertNever(index, `Unknown tab index: ${index}`)\n    }\n  }\n\n  private onOptOutofReportingChanged = (value: boolean) => {\n    this.setState({ optOutOfUsageTracking: value })\n  }\n\n  private onConfirmRepositoryRemovalChanged = (value: boolean) => {\n    this.setState({ confirmRepositoryRemoval: value })\n  }\n\n  private onConfirmDiscardChangesChanged = (value: boolean) => {\n    this.setState({ confirmDiscardChanges: value })\n  }\n\n  private onCommitterNameChanged = (committerName: string) => {\n    const disallowedCharactersMessage = this.disallowedCharacterErrorMessage(\n      committerName,\n      this.state.committerEmail\n    )\n\n    this.setState({ committerName, disallowedCharactersMessage })\n  }\n\n  private onCommitterEmailChanged = (committerEmail: string) => {\n    const disallowedCharactersMessage = this.disallowedCharacterErrorMessage(\n      this.state.committerName,\n      committerEmail\n    )\n\n    this.setState({ committerEmail, disallowedCharactersMessage })\n  }\n\n  private onSelectedEditorChanged = (editor: ExternalEditor) => {\n    this.setState({ selectedExternalEditor: editor })\n  }\n\n  private onSelectedShellChanged = (shell: Shell) => {\n    this.setState({ selectedShell: shell })\n  }\n\n  private onSelectedThemeChanged = (theme: ApplicationTheme) => {\n    this.props.dispatcher.setSelectedTheme(theme)\n  }\n\n  private renderFooter() {\n    const hasDisabledError = this.state.disallowedCharactersMessage != null\n\n    const index = this.state.selectedIndex\n    switch (index) {\n      case PreferencesTab.Accounts:\n      case PreferencesTab.Appearance:\n        return null\n      case PreferencesTab.Advanced:\n      case PreferencesTab.Git: {\n        return (\n          <DialogFooter>\n            <ButtonGroup>\n              <Button type=\"submit\" disabled={hasDisabledError}>\n                Save\n              </Button>\n              <Button onClick={this.props.onDismissed}>Cancel</Button>\n            </ButtonGroup>\n          </DialogFooter>\n        )\n      }\n      default:\n        return assertNever(index, `Unknown tab index: ${index}`)\n    }\n  }\n\n  private onSave = async () => {\n    await setGlobalConfigValue('user.name', this.state.committerName)\n    await setGlobalConfigValue('user.email', this.state.committerEmail)\n    await this.props.dispatcher.setStatsOptOut(this.state.optOutOfUsageTracking)\n    await this.props.dispatcher.setConfirmRepoRemovalSetting(\n      this.state.confirmRepositoryRemoval\n    )\n\n    if (this.state.selectedExternalEditor) {\n      await this.props.dispatcher.setExternalEditor(\n        this.state.selectedExternalEditor\n      )\n    }\n    await this.props.dispatcher.setShell(this.state.selectedShell)\n    await this.props.dispatcher.setConfirmDiscardChangesSetting(\n      this.state.confirmDiscardChanges\n    )\n\n    const mergeTool = this.state.mergeTool\n    if (mergeTool && mergeTool.name) {\n      await setGlobalConfigValue('merge.tool', mergeTool.name)\n\n      if (mergeTool.command) {\n        await setGlobalConfigValue(\n          `mergetool.${mergeTool.name}.cmd`,\n          mergeTool.command\n        )\n      }\n    }\n\n    this.props.onDismissed()\n  }\n\n  private onTabClicked = (index: number) => {\n    this.setState({ selectedIndex: index })\n  }\n\n  private onMergeToolNameChanged = (name: string) => {\n    const mergeTool = {\n      name,\n      command: this.state.mergeTool && this.state.mergeTool.command,\n    }\n    this.setState({ mergeTool })\n  }\n\n  private onMergeToolCommandChanged = (command: string) => {\n    const mergeTool = {\n      name: this.state.mergeTool ? this.state.mergeTool.name : '',\n      command,\n    }\n    this.setState({ mergeTool })\n  }\n}\n","export { Preferences } from './preferences'\n","import * as React from 'react'\nimport { Dispatcher } from '../../lib/dispatcher/index'\nimport { LinkButton } from '../lib/link-button'\nimport { updateStore } from '../lib/update-store'\nimport { Octicon, OcticonSymbol } from '../octicons'\nimport { PopupType } from '../../lib/app-state'\nimport { shell } from '../../lib/app-shell'\n\nimport { ReleaseSummary } from '../../models/release-notes'\nimport { enableInAppReleaseNotes } from '../../lib/feature-flag'\n\ninterface IUpdateAvailableProps {\n  readonly dispatcher: Dispatcher\n  readonly newRelease: ReleaseSummary | null\n  readonly releaseNotesLink: string\n  readonly onDismissed: () => void\n}\n\n/**\n * A component which tells the user an update is available and gives them the\n * option of moving into the future or being a luddite.\n */\nexport class UpdateAvailable extends React.Component<\n  IUpdateAvailableProps,\n  {}\n> {\n  public render() {\n    return (\n      <div id=\"update-available\" className=\"active\" onSubmit={this.updateNow}>\n        <Octicon className=\"icon\" symbol={OcticonSymbol.desktopDownload} />\n\n        <span>\n          An updated version of GitHub Desktop is available and will be\n          installed at the next launch. See{' '}\n          {enableInAppReleaseNotes() ? (\n            <LinkButton onClick={this.showReleaseNotes}>what's new</LinkButton>\n          ) : (\n            <LinkButton uri={this.props.releaseNotesLink}>\n              what's new\n            </LinkButton>\n          )}{' '}\n          or{' '}\n          <LinkButton onClick={this.updateNow}>\n            restart GitHub Desktop\n          </LinkButton>\n          .\n        </span>\n\n        <a className=\"close\" onClick={this.dismiss}>\n          <Octicon symbol={OcticonSymbol.x} />\n        </a>\n      </div>\n    )\n  }\n\n  private showReleaseNotes = () => {\n    if (this.props.newRelease == null) {\n      // if, for some reason we're not able to render the release notes we\n      // should redirect the user to the website so we do _something_\n      const releaseNotesUri = 'https://desktop.github.com/release-notes/'\n      shell.openExternal(releaseNotesUri)\n    } else {\n      this.props.dispatcher.showPopup({\n        type: PopupType.ReleaseNotes,\n        newRelease: this.props.newRelease,\n      })\n    }\n  }\n\n  private updateNow = () => {\n    updateStore.quitAndInstallUpdate()\n  }\n\n  private dismiss = () => {\n    this.props.onDismissed()\n  }\n}\n","export { UpdateAvailable } from './update-available'\n","import * as React from 'react'\nimport { IMenu, ISubmenuItem } from '../../models/app-menu'\nimport { MenuListItem } from './menu-list-item'\nimport { AppMenu, CloseSource } from './app-menu'\nimport { ToolbarDropdown } from '../toolbar'\nimport { Dispatcher } from '../../lib/dispatcher'\n\ninterface IAppMenuBarButtonProps {\n  /**\n   * The top-level menu item. Currently only submenu items can be rendered as\n   * top-level menu bar buttons.\n   */\n  readonly menuItem: ISubmenuItem\n\n  /**\n   * A list of open menus to be rendered, each menu may have\n   * a selected item. An empty array signifies that the menu\n   * is not open and an array containing more than one element\n   * means that there's one or more submenus open.\n   */\n  readonly menuState: ReadonlyArray<IMenu>\n\n  /**\n   * Whether or not the application menu was opened with the Alt key, this\n   * enables access key highlighting for applicable menu items as well as\n   * keyboard navigation by pressing access keys.\n   */\n  readonly enableAccessKeyNavigation: boolean\n\n  /**\n   * Whether the menu was opened by pressing Alt (or Alt+X where X is an\n   * access key for one of the top level menu items). This is used as a\n   * one-time signal to the AppMenu to use some special semantics for\n   * selection and focus. Specifically it will ensure that the last opened\n   * menu will receive focus.\n   */\n  readonly openedWithAccessKey: boolean\n\n  /**\n   * Whether or not to highlight the access key of a top-level menu\n   * items (if they have one). This is normally true when the Alt-key\n   * is pressed, signifying that the item is accessible by holding Alt\n   * and pressing the corresponding access key. Note that this is a Windows\n   * convention.\n   *\n   * See the highlight prop of the AccessText component for more details.\n   */\n  readonly highlightMenuAccessKey: boolean\n\n  /**\n   * A function that's called when the menu item is closed by the user clicking\n   * on the button while it is expanded. This is a specialized version\n   * of the onDropdownStateChanged prop of the ToolbarDropdown component.\n   *\n   * @param menuItem - The top-level menu item rendered by this menu bar button.\n   * @param source   - Whether closing the menu was caused by a keyboard or\n   *                   pointer interaction, or if it was closed due to an\n   *                   item being activated (executed).\n   */\n  readonly onClose: (\n    menuItem: ISubmenuItem,\n    source: 'keyboard' | 'pointer' | 'item-executed'\n  ) => void\n\n  /**\n   * A function that's called when the menu item is opened by the user clicking\n   * on the button or pressing the down arrow key while it is collapsed.\n   * This is a specialized version of the onDropdownStateChanged prop of the\n   * ToolbarDropdown component.\n   *\n   * @param selectFirstItem - Whether or not to automatically select\n   *                          the first item in the newly opened menu.\n   *                          This is set when the menu is opened by the\n   *                          user pressing the down arrow key while focused\n   *                          on the button.\n   */\n  readonly onOpen: (menuItem: ISubmenuItem, selectFirstItem?: boolean) => void\n\n  /**\n   * A function that's called when the user hovers over the menu item with\n   * a pointer device. Note that this only fires for mouse events inside\n   * of the button and not when hovering content inside the foldout such\n   * as menu items.\n   */\n  readonly onMouseEnter: (menuItem: ISubmenuItem) => void\n\n  /**\n   * A function that's called when a key event is received from the MenuBar\n   * button component or any of its descendants. Note that this includes any\n   * component or element within the foldout when that is open like, for\n   * example, MenuItem components.\n   *\n   * This function is called before the menu bar button itself does any\n   * processing of the event so consumers should make sure to call\n   * event.preventDefault if they act on the event in order to make sure that\n   * the menu bar button component doesn't act on the same key.\n   */\n  readonly onKeyDown: (\n    menuItem: ISubmenuItem,\n    event: React.KeyboardEvent<HTMLDivElement>\n  ) => void\n\n  /**\n   * A function that's called once the component has been mounted. This, and\n   * the onWillUnmount prop are essentially equivalent to the ref callback\n   * except these methods pass along the menuItem so that the parent component\n   * is able to keep track of them without having to resort to closing over id's\n   * in its render method which would cause the component to re-render on each\n   * pass.\n   *\n   * Note that this method is unreliable if the component can receive a new\n   * MenuItem during its lifetime. As such it's important that\n   * consumers on this component uses a key prop that's equal to the id of\n   * the menu item such that it won't be re-used. It's also important that\n   * consumers of this not rely on reference equality when tracking components\n   * and instead use the id of the menuItem.\n   */\n  readonly onDidMount?: (\n    menuItem: ISubmenuItem,\n    button: AppMenuBarButton\n  ) => void\n\n  /**\n   * A function that's called directly before the component unmounts. This, and\n   * the onDidMount prop are essentially equivalent to the ref callback except\n   * these methods pass along the menuItem so that the parent component is able\n   * to keep track of them without having to resort to closing over id's in its\n   * render method which would cause the component to re-render on each pass.\n   *\n   * Note that this method is unreliable if the component can receive a new\n   * MenuItem during its lifetime. As such it's important that\n   * consumers on this component uses a key prop that's equal to the id of\n   * the menu item such that it won't be re-used. It's also important that\n   * consumers of this not rely on reference equality when tracking components\n   * and instead use the id of the menuItem.\n   */\n  readonly onWillUnmount?: (\n    menuItem: ISubmenuItem,\n    button: AppMenuBarButton\n  ) => void\n\n  readonly dispatcher: Dispatcher\n}\n\n/**\n * A button used inside of a menubar which utilizes the ToolbarDropdown component\n * in order to render the menu item as well as a foldout containing the item's\n * submenu (if open).\n */\nexport class AppMenuBarButton extends React.Component<\n  IAppMenuBarButtonProps,\n  {}\n> {\n  private innerDropDown: ToolbarDropdown | null = null\n\n  /**\n   * Gets a value indicating whether or not the menu of this\n   * particular menu item is expanded or collapsed.\n   */\n  private get isMenuOpen() {\n    return this.props.menuState.length !== 0\n  }\n\n  /**\n   * Programmatically move keyboard focus to the button element.\n   */\n  public focusButton() {\n    if (this.innerDropDown) {\n      this.innerDropDown.focusButton()\n    }\n  }\n\n  public componentDidMount() {\n    if (this.props.onDidMount) {\n      this.props.onDidMount(this.props.menuItem, this)\n    }\n  }\n\n  public componentWillUnmount() {\n    if (this.props.onWillUnmount) {\n      this.props.onWillUnmount(this.props.menuItem, this)\n    }\n  }\n\n  public render() {\n    const item = this.props.menuItem\n    const dropDownState = this.isMenuOpen ? 'open' : 'closed'\n\n    return (\n      <ToolbarDropdown\n        ref={this.onDropDownRef}\n        key={item.id}\n        dropdownState={dropDownState}\n        onDropdownStateChanged={this.onDropdownStateChanged}\n        dropdownContentRenderer={this.dropDownContentRenderer}\n        showDisclosureArrow={false}\n        onMouseEnter={this.onMouseEnter}\n        onKeyDown={this.onKeyDown}\n        tabIndex={-1}\n        role=\"menuitem\"\n      >\n        <MenuListItem\n          item={item}\n          highlightAccessKey={this.props.highlightMenuAccessKey}\n          renderAcceleratorText={false}\n          renderSubMenuArrow={false}\n        />\n      </ToolbarDropdown>\n    )\n  }\n\n  private onDropDownRef = (dropdown: ToolbarDropdown | null) => {\n    this.innerDropDown = dropdown\n  }\n\n  private onMouseEnter = (event: React.MouseEvent<HTMLButtonElement>) => {\n    this.props.onMouseEnter(this.props.menuItem)\n  }\n\n  private onKeyDown = (event: React.KeyboardEvent<HTMLDivElement>) => {\n    if (event.defaultPrevented) {\n      return\n    }\n\n    this.props.onKeyDown(this.props.menuItem, event)\n\n    if (!this.isMenuOpen && !event.defaultPrevented) {\n      if (event.key === 'ArrowDown') {\n        this.props.onOpen(this.props.menuItem, true)\n        event.preventDefault()\n      }\n    }\n  }\n\n  private onMenuClose = (closeSource: CloseSource) => {\n    // If the user closes the menu by hitting escape we explicitly move focus\n    // to the button so that it's highlighted and responds to Arrow keys.\n    if (closeSource.type === 'keyboard' && closeSource.event.key === 'Escape') {\n      this.focusButton()\n    }\n\n    this.props.onClose(this.props.menuItem, closeSource.type)\n  }\n\n  private onDropdownStateChanged = (\n    state: 'closed' | 'open',\n    source: 'keyboard' | 'pointer'\n  ) => {\n    if (this.isMenuOpen) {\n      this.props.onClose(this.props.menuItem, source)\n    } else {\n      this.props.onOpen(this.props.menuItem)\n    }\n  }\n\n  private dropDownContentRenderer = () => {\n    const menuState = this.props.menuState\n\n    if (!this.isMenuOpen) {\n      return null\n    }\n\n    return (\n      <AppMenu\n        dispatcher={this.props.dispatcher}\n        onClose={this.onMenuClose}\n        openedWithAccessKey={this.props.openedWithAccessKey}\n        state={menuState}\n        enableAccessKeyNavigation={this.props.enableAccessKeyNavigation}\n        autoHeight={true}\n      />\n    )\n  }\n}\n","import * as React from 'react'\nimport {\n  IMenu,\n  ISubmenuItem,\n  findItemByAccessKey,\n  itemIsSelectable,\n} from '../../models/app-menu'\nimport { AppMenuBarButton } from './app-menu-bar-button'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { AppMenuFoldout, FoldoutType } from '../../lib/app-state'\n\ninterface IAppMenuBarProps {\n  readonly appMenu: ReadonlyArray<IMenu>\n  readonly dispatcher: Dispatcher\n\n  /**\n   * Whether or not to highlight access keys for top-level menu items.\n   * Note that this does not affect whether access keys are highlighted\n   * for menu items in submenus, that's controlled by the foldoutState\n   * enableAccessKeyNavigation prop and follows Windows conventions such\n   * that opening a menu by clicking on it and then hitting Alt does\n   * not highlight the access keys within.\n   */\n  readonly highlightAppMenuAccessKeys: boolean\n\n  /**\n   * The current AppMenu foldout state. If null that means that the\n   * app menu foldout is not currently open.\n   */\n  readonly foldoutState: AppMenuFoldout | null\n\n  /**\n   * An optional function that's called when the menubar loses focus.\n   *\n   * Note that this function will only be called once no descendant element\n   * of the menu bar has keyboard focus. In other words this differs\n   * from the traditional onBlur event.\n   */\n  readonly onLostFocus?: () => void\n}\n\ninterface IAppMenuBarState {\n  /**\n   * A list of visible top-level menu items which have child menus of\n   * their own (ie submenu items).\n   */\n  readonly menuItems: ReadonlyArray<ISubmenuItem>\n}\n\n/**\n * Creates menu bar state given props. This is intentionally not\n * an instance member in order to avoid mistakenly using any other\n * input data or state than the received props.\n *\n * The state consists of a list of visible top-level menu items which have\n * child menus of their own (ie submenu items).\n */\nfunction createState(props: IAppMenuBarProps): IAppMenuBarState {\n  if (!props.appMenu.length) {\n    return { menuItems: [] }\n  }\n\n  const topLevelMenu = props.appMenu[0]\n  const items = topLevelMenu.items\n\n  const menuItems = new Array<ISubmenuItem>()\n\n  for (const item of items) {\n    if (item.type === 'submenuItem' && item.visible) {\n      menuItems.push(item)\n    }\n  }\n\n  return { menuItems }\n}\n\n/**\n * A Windows-style application menu bar which renders in the title\n * bar section of the app and utilizes foldouts for displaying interactive\n * menus.\n */\nexport class AppMenuBar extends React.Component<\n  IAppMenuBarProps,\n  IAppMenuBarState\n> {\n  private menuBar: HTMLDivElement | null = null\n  private readonly menuButtonRefsByMenuItemId: {\n    [id: string]: AppMenuBarButton\n  } = {}\n  private focusOutTimeout: number | null = null\n\n  /**\n   * Whether or not keyboard focus currently lies within the MenuBar component\n   */\n  private hasFocus: boolean = false\n\n  /**\n   * Whenever the MenuBar component receives focus it attempts to store the\n   * element which had focus prior to the component receiving it. We do so in\n   * order to be able to restore focus to that element when we decide to\n   * _programmatically_ give up our focus.\n   *\n   * A good example of this is when the user is focused on a text box and hits\n   * the Alt key. Focus will then move to the first menu item in the menu bar.\n   * If the user then hits Enter we relinquish our focus and return it back to\n   * the text box again.\n   *\n   * As long as we hold on to this reference we might be preventing GC from\n   * collecting a potentially huge subtree of the DOM so we need to make sure\n   * to clear it out as soon as we're done with it.\n   */\n  private stolenFocusElement: HTMLElement | null = null\n\n  public constructor(props: IAppMenuBarProps) {\n    super(props)\n    this.state = createState(props)\n  }\n\n  public componentWillReceiveProps(nextProps: IAppMenuBarProps) {\n    if (nextProps.appMenu !== this.props.appMenu) {\n      this.setState(createState(nextProps))\n    }\n  }\n\n  public componentDidUpdate(prevProps: IAppMenuBarProps) {\n    // Was the app menu foldout just opened or closed?\n    if (this.props.foldoutState && !prevProps.foldoutState) {\n      if (this.props.appMenu.length === 1 && !this.hasFocus) {\n        // It was just opened, no menus are open and we don't have focus,\n        // that's our cue to focus the first menu item so that users\n        // can move move around using arrow keys.\n        this.focusFirstMenuItem()\n      }\n    } else if (!this.props.foldoutState && prevProps.foldoutState) {\n      // The foldout was just closed and we still have focus, time to\n      // give it back to whoever had it before or remove focus entirely.\n      this.restoreFocusOrBlur()\n    }\n  }\n\n  public componentDidMount() {\n    if (this.props.foldoutState) {\n      if (this.props.appMenu.length === 1) {\n        this.focusFirstMenuItem()\n      }\n    }\n  }\n\n  public componentWillUnmount() {\n    if (this.hasFocus) {\n      this.restoreFocusOrBlur()\n    }\n    // This is perhaps being overly cautious but just in case we're unmounted\n    // and someone else is still holding a reference to us we want to make sure\n    // that we're not preventing GC from doing its job.\n    this.stolenFocusElement = null\n  }\n\n  public render() {\n    return (\n      <div\n        id=\"app-menu-bar\"\n        ref={this.onMenuBarRef}\n        role=\"menubar\"\n        aria-label=\"Application menu\"\n      >\n        {this.state.menuItems.map(this.renderMenuItem, this)}\n      </div>\n    )\n  }\n\n  private isMenuItemOpen(item: ISubmenuItem) {\n    const openMenu =\n      this.props.foldoutState && this.props.appMenu.length > 1\n        ? this.props.appMenu[1]\n        : null\n\n    return openMenu !== null && openMenu.id === item.id\n  }\n\n  /**\n   * Move keyboard focus to the first menu item button in the\n   * menu bar. This has no effect when a menu is currently open.\n   */\n  private focusFirstMenuItem() {\n    // Menu currently open?\n    if (this.props.appMenu.length > 1) {\n      return\n    }\n\n    const rootItems = this.state.menuItems\n\n    if (!rootItems.length) {\n      return\n    }\n\n    const firstMenuItem = rootItems[0]\n\n    if (firstMenuItem) {\n      this.focusMenuItem(firstMenuItem)\n    }\n  }\n\n  private focusMenuItem(item: ISubmenuItem) {\n    const itemComponent = this.menuButtonRefsByMenuItemId[item.id]\n\n    if (itemComponent) {\n      itemComponent.focusButton()\n    }\n  }\n\n  private restoreFocusOrBlur() {\n    if (!this.hasFocus) {\n      return\n    }\n\n    // Us having a reference to the previously focused element doesn't\n    // necessarily mean that that element is still in the DOM so we explicitly\n    // check to see if it is before we yield focus to it.\n    if (this.stolenFocusElement && document.contains(this.stolenFocusElement)) {\n      this.stolenFocusElement.focus()\n    } else if (document.activeElement instanceof HTMLElement) {\n      document.activeElement.blur()\n    }\n\n    // Don't want to hold on to this a moment longer than necessary.\n    this.stolenFocusElement = null\n  }\n\n  private onMenuBarFocusIn = (event: Event) => {\n    const focusEvent = event as FocusEvent\n    if (!this.hasFocus) {\n      if (\n        focusEvent.relatedTarget &&\n        focusEvent.relatedTarget instanceof HTMLElement\n      ) {\n        this.stolenFocusElement = focusEvent.relatedTarget\n      } else {\n        this.stolenFocusElement = null\n      }\n      this.hasFocus = true\n    }\n    this.clearFocusOutTimeout()\n  }\n\n  private onMenuBarFocusOut = (event: Event) => {\n    // When keyboard focus moves from one descendant within the\n    // menu bar to another we will receive one 'focusout' event\n    // followed quickly by a 'focusin' event. As such we\n    // can't tell whether we've lost focus until we're certain\n    // that we've only gotten the 'focusout' event.\n    //\n    // In order to achieve this we schedule our call to onLostFocusWithin\n    // and clear that timeout if we receive a 'focusin' event.\n    this.clearFocusOutTimeout()\n    this.focusOutTimeout = requestAnimationFrame(this.onLostFocusWithin)\n  }\n\n  private clearFocusOutTimeout() {\n    if (this.focusOutTimeout !== null) {\n      cancelAnimationFrame(this.focusOutTimeout)\n      this.focusOutTimeout = null\n    }\n  }\n\n  private onLostFocusWithin = () => {\n    this.hasFocus = false\n    this.focusOutTimeout = null\n\n    if (this.props.onLostFocus) {\n      this.props.onLostFocus()\n    }\n\n    // It's possible that the element which we are referencing here is no longer\n    // part of the DOM so it's important that we clear out our handle to prevent\n    // us from hanging on to a possibly huge DOM structure and preventing GC\n    // from collecting it. My kingdom for a weak reference.\n    this.stolenFocusElement = null\n  }\n\n  private onMenuBarRef = (menuBar: HTMLDivElement | null) => {\n    if (this.menuBar) {\n      this.menuBar.removeEventListener('focusin', this.onMenuBarFocusIn)\n      this.menuBar.removeEventListener('focusout', this.onMenuBarFocusOut)\n    }\n\n    this.menuBar = menuBar\n\n    if (this.menuBar) {\n      this.menuBar.addEventListener('focusin', this.onMenuBarFocusIn)\n      this.menuBar.addEventListener('focusout', this.onMenuBarFocusOut)\n    }\n  }\n\n  private onMenuClose = (\n    item: ISubmenuItem,\n    source: 'keyboard' | 'pointer' | 'item-executed'\n  ) => {\n    if (source === 'pointer' || source === 'item-executed') {\n      this.restoreFocusOrBlur()\n    }\n\n    this.props.dispatcher.setAppMenuState(m => m.withClosedMenu(item.menu))\n  }\n\n  private onMenuOpen = (item: ISubmenuItem, selectFirstItem?: boolean) => {\n    const enableAccessKeyNavigation = this.props.foldoutState\n      ? this.props.foldoutState.enableAccessKeyNavigation\n      : false\n\n    this.props.dispatcher.showFoldout({\n      type: FoldoutType.AppMenu,\n      enableAccessKeyNavigation,\n    })\n    this.props.dispatcher.setAppMenuState(m =>\n      m.withOpenedMenu(item, selectFirstItem)\n    )\n  }\n\n  private onMenuButtonMouseEnter = (item: ISubmenuItem) => {\n    if (this.hasFocus) {\n      this.focusMenuItem(item)\n    }\n\n    if (this.props.appMenu.length > 1) {\n      this.props.dispatcher.setAppMenuState(m => m.withOpenedMenu(item))\n    }\n  }\n\n  private moveToAdjacentMenu(\n    direction: 'next' | 'previous',\n    sourceItem: ISubmenuItem\n  ) {\n    const rootItems = this.state.menuItems\n    const menuItemIx = rootItems.findIndex(item => item.id === sourceItem.id)\n\n    if (menuItemIx === -1) {\n      return\n    }\n\n    const delta = direction === 'next' ? 1 : -1\n\n    // http://javascript.about.com/od/problemsolving/a/modulobug.htm\n    const nextMenuItemIx =\n      (menuItemIx + delta + rootItems.length) % rootItems.length\n    const nextItem = rootItems[nextMenuItemIx]\n\n    if (!nextItem) {\n      return\n    }\n\n    const foldoutState = this.props.foldoutState\n\n    // Determine whether a top-level application menu is currently\n    // open and use that if, and only if, the application menu foldout\n    // is active.\n    const openMenu = foldoutState !== null && this.props.appMenu.length > 1\n\n    if (openMenu) {\n      this.props.dispatcher.setAppMenuState(m =>\n        m.withOpenedMenu(nextItem, true)\n      )\n    } else {\n      const nextButton = this.menuButtonRefsByMenuItemId[nextItem.id]\n\n      if (nextButton) {\n        nextButton.focusButton()\n      }\n    }\n  }\n\n  private onMenuButtonKeyDown = (\n    item: ISubmenuItem,\n    event: React.KeyboardEvent<HTMLDivElement>\n  ) => {\n    if (event.defaultPrevented) {\n      return\n    }\n\n    const foldoutState = this.props.foldoutState\n\n    if (!foldoutState) {\n      return\n    }\n\n    if (event.key === 'Escape') {\n      if (!this.isMenuItemOpen(item)) {\n        this.restoreFocusOrBlur()\n        event.preventDefault()\n      }\n    } else if (event.key === 'ArrowLeft') {\n      this.moveToAdjacentMenu('previous', item)\n      event.preventDefault()\n    } else if (event.key === 'ArrowRight') {\n      this.moveToAdjacentMenu('next', item)\n      event.preventDefault()\n    } else if (foldoutState.enableAccessKeyNavigation) {\n      if (event.altKey || event.ctrlKey || event.metaKey) {\n        return\n      }\n\n      const menuItemForAccessKey = findItemByAccessKey(\n        event.key,\n        this.state.menuItems\n      )\n\n      if (menuItemForAccessKey && itemIsSelectable(menuItemForAccessKey)) {\n        if (menuItemForAccessKey.type === 'submenuItem') {\n          this.props.dispatcher.setAppMenuState(menu =>\n            menu\n              .withReset()\n              .withSelectedItem(menuItemForAccessKey)\n              .withOpenedMenu(menuItemForAccessKey, true)\n          )\n        } else {\n          this.restoreFocusOrBlur()\n          this.props.dispatcher.executeMenuItem(menuItemForAccessKey)\n        }\n\n        event.preventDefault()\n      }\n    }\n  }\n\n  private onMenuButtonDidMount = (\n    menuItem: ISubmenuItem,\n    button: AppMenuBarButton\n  ) => {\n    this.menuButtonRefsByMenuItemId[menuItem.id] = button\n  }\n\n  private onMenuButtonWillUnmount = (\n    menuItem: ISubmenuItem,\n    button: AppMenuBarButton\n  ) => {\n    delete this.menuButtonRefsByMenuItemId[menuItem.id]\n  }\n\n  private renderMenuItem(item: ISubmenuItem): JSX.Element {\n    const foldoutState = this.props.foldoutState\n\n    // Slice away the top menu so that each menu bar button receives\n    // their menu item's menu and any open submenus.\n    const menuState = this.isMenuItemOpen(item)\n      ? this.props.appMenu.slice(1)\n      : []\n\n    const openedWithAccessKey = foldoutState\n      ? foldoutState.openedWithAccessKey || false\n      : false\n\n    const enableAccessKeyNavigation = foldoutState\n      ? foldoutState.enableAccessKeyNavigation\n      : false\n\n    // If told to highlight access keys we will do so. If access key navigation\n    // is enabled and no menu is open we'll highlight as well. This matches\n    // the behavior of Windows menus.\n    const highlightMenuAccessKey =\n      this.props.highlightAppMenuAccessKeys ||\n      (!this.isMenuItemOpen(item) && enableAccessKeyNavigation)\n\n    return (\n      <AppMenuBarButton\n        key={item.id}\n        dispatcher={this.props.dispatcher}\n        menuItem={item}\n        menuState={menuState}\n        highlightMenuAccessKey={highlightMenuAccessKey}\n        enableAccessKeyNavigation={enableAccessKeyNavigation}\n        openedWithAccessKey={openedWithAccessKey}\n        onClose={this.onMenuClose}\n        onOpen={this.onMenuOpen}\n        onMouseEnter={this.onMenuButtonMouseEnter}\n        onKeyDown={this.onMenuButtonKeyDown}\n        onDidMount={this.onMenuButtonDidMount}\n        onWillUnmount={this.onMenuButtonWillUnmount}\n      />\n    )\n  }\n}\n","import * as React from 'react'\nimport * as classNames from 'classnames'\n\ninterface IAccessTextProps {\n  /**\n   * A string which optionally contains an access key modifier (ampersand).\n   * The access key modifier directly precedes the character which is\n   * highlighted when the highlight property is set. Literal ampersand\n   * characters need to be escaped by using two ampersand characters (&&).\n   *\n   * At most one character is allowed to have a preceeding ampersand character.\n   */\n  readonly text: string\n\n  /**\n   * Whether or not to highlight the access key (if one exists).\n   */\n  readonly highlight?: boolean\n}\n\nfunction unescape(accessText: string) {\n  return accessText.replace('&&', '&')\n}\n\n/**\n * A platform helper function which optionally highlights access keys (letters\n * prefixed with &) on Windows. On non-Windows platform access key prefixes\n * are removed before rendering.\n */\nexport class AccessText extends React.Component<IAccessTextProps, {}> {\n  public shouldComponentUpdate(nextProps: IAccessTextProps) {\n    return (\n      this.props.text !== nextProps.text ||\n      this.props.highlight !== nextProps.highlight\n    )\n  }\n\n  public render() {\n    // Match everything (if anything) before an ampersand followed by anything that's\n    // not an ampersand and then capture the remainder.\n    const m = this.props.text.match(/^(.*?)?(?:&([^&]))(.*)?$/)\n\n    if (!m) {\n      return <span>{this.props.text}</span>\n    }\n\n    const elements = new Array<JSX.Element>()\n\n    if (m[1]) {\n      elements.push(\n        <span key={1} aria-hidden={true}>\n          {unescape(m[1])}\n        </span>\n      )\n    }\n\n    const className = classNames('access-key', {\n      highlight: this.props.highlight,\n    })\n\n    elements.push(\n      <span aria-hidden={true} key={2} className={className}>\n        {m[2]}\n      </span>\n    )\n\n    if (m[3]) {\n      elements.push(\n        <span key={3} aria-hidden={true}>\n          {unescape(m[3])}\n        </span>\n      )\n    }\n\n    const preText = m[1] ? unescape(m[1]) : ''\n    const accessKeyText = m[2]\n    const postText = m[3] ? unescape(m[3]) : ''\n\n    const plainText = `${preText}${accessKeyText}${postText}`\n\n    return <span aria-label={plainText}>{elements}</span>\n  }\n}\n","export * from './app-menu'\nexport * from './app-menu-bar'\nexport * from './menu-pane'\n","import { StatsDatabase, ILaunchStats, IDailyMeasures } from './stats-database'\nimport { getDotComAPIEndpoint } from '../api'\nimport { getVersion } from '../../ui/lib/app-proxy'\nimport { hasShownWelcomeFlow } from '../welcome'\nimport { Account } from '../../models/account'\nimport { getOS } from '../get-os'\nimport { getGUID } from './get-guid'\nimport { Repository } from '../../models/repository'\nimport { merge } from '../../lib/merge'\nimport { getPersistedThemeName } from '../../ui/lib/application-theme'\nimport { IUiActivityMonitor } from '../../ui/lib/ui-activity-monitor'\nimport { Disposable } from 'event-kit'\nimport { SignInMethod } from '../stores'\nimport { assertNever } from '../fatal-error'\n\nconst StatsEndpoint = 'https://central.github.com/api/usage/desktop'\n\n/** The URL to the stats samples page. */\nexport const SamplesURL = 'https://desktop.github.com/usage-data/'\n\nconst LastDailyStatsReportKey = 'last-daily-stats-report'\n\n/** The localStorage key for whether the user has opted out. */\nconst StatsOptOutKey = 'stats-opt-out'\n\n/** Have we successfully sent the stats opt-in? */\nconst HasSentOptInPingKey = 'has-sent-stats-opt-in-ping'\n\nconst WelcomeWizardInitiatedAtKey = 'welcome-wizard-initiated-at'\nconst WelcomeWizardCompletedAtKey = 'welcome-wizard-terminated-at'\nconst FirstRepositoryAddedAtKey = 'first-repository-added-at'\nconst FirstRepositoryClonedAtKey = 'first-repository-cloned-at'\nconst FirstRepositoryCreatedAtKey = 'first-repository-created-at'\nconst FirstCommitCreatedAtKey = 'first-commit-created-at'\nconst FirstPushToGitHubAtKey = 'first-push-to-github-at'\nconst FirstNonDefaultBranchCheckoutAtKey =\n  'first-non-default-branch-checkout-at'\nconst WelcomeWizardSignInMethodKey = 'welcome-wizard-sign-in-method'\n\n/** How often daily stats should be submitted (i.e., 24 hours). */\nconst DailyStatsReportInterval = 1000 * 60 * 60 * 24\n\nconst DefaultDailyMeasures: IDailyMeasures = {\n  commits: 0,\n  partialCommits: 0,\n  openShellCount: 0,\n  coAuthoredCommits: 0,\n  branchComparisons: 0,\n  defaultBranchComparisons: 0,\n  mergesInitiatedFromComparison: 0,\n  updateFromDefaultBranchMenuCount: 0,\n  mergeIntoCurrentBranchMenuCount: 0,\n  prBranchCheckouts: 0,\n  repoWithIndicatorClicked: 0,\n  repoWithoutIndicatorClicked: 0,\n  divergingBranchBannerDismissal: 0,\n  divergingBranchBannerInitatedMerge: 0,\n  divergingBranchBannerInitiatedCompare: 0,\n  divergingBranchBannerInfluencedMerge: 0,\n  divergingBranchBannerDisplayed: 0,\n  dotcomPushCount: 0,\n  enterprisePushCount: 0,\n  externalPushCount: 0,\n  active: false,\n  mergeConflictFromPullCount: 0,\n  mergeConflictFromExplicitMergeCount: 0,\n  mergedWithLoadingHintCount: 0,\n  mergedWithCleanMergeHintCount: 0,\n  mergedWithConflictWarningHintCount: 0,\n  mergeSuccessAfterConflictsCount: 0,\n  mergeAbortedAfterConflictsCount: 0,\n}\n\ninterface IOnboardingStats {\n  /**\n   * Time (in seconds) from when the user first launched\n   * the application and entered the welcome wizard until\n   * the user added their first existing repository.\n   *\n   * A negative value means that this action hasn't yet\n   * taken place while undefined means that the current\n   * user installed desktop prior to this metric beeing\n   * added and we will thus never be able to provide a\n   * value.\n   */\n  readonly timeToFirstAddedRepository?: number\n\n  /**\n   * Time (in seconds) from when the user first launched\n   * the application and entered the welcome wizard until\n   * the user cloned their first repository.\n   *\n   * A negative value means that this action hasn't yet\n   * taken place while undefined means that the current\n   * user installed desktop prior to this metric beeing\n   * added and we will thus never be able to provide a\n   * value.\n   */\n  readonly timeToFirstClonedRepository?: number\n\n  /**\n   * Time (in seconds) from when the user first launched\n   * the application and entered the welcome wizard until\n   * the user created their first new repository.\n   *\n   * A negative value means that this action hasn't yet\n   * taken place while undefined means that the current\n   * user installed desktop prior to this metric beeing\n   * added and we will thus never be able to provide a\n   * value.\n   */\n  readonly timeToFirstCreatedRepository?: number\n\n  /**\n   * Time (in seconds) from when the user first launched\n   * the application and entered the welcome wizard until\n   * the user crafted their first commit.\n   *\n   * A negative value means that this action hasn't yet\n   * taken place while undefined means that the current\n   * user installed desktop prior to this metric beeing\n   * added and we will thus never be able to provide a\n   * value.\n   */\n  readonly timeToFirstCommit?: number\n\n  /**\n   * Time (in seconds) from when the user first launched\n   * the application and entered the welcome wizard until\n   * the user performed their first push of a repository\n   * to GitHub.com or GitHub Enterprise. This metric\n   * does not track pushes to non-GitHub remotes.\n   */\n  readonly timeToFirstGitHubPush?: number\n\n  /**\n   * Time (in seconds) from when the user first launched\n   * the application and entered the welcome wizard until\n   * the user first checked out a branch in any repository\n   * which is not the default branch of that repository.\n   *\n   * Note that this metric will be set regardless of whether\n   * that repository was a GitHub.com/GHE repository, local\n   * repository or has a non-GitHub remote.\n   *\n   * A negative value means that this action hasn't yet\n   * taken place while undefined means that the current\n   * user installed desktop prior to this metric beeing\n   * added and we will thus never be able to provide a\n   * value.\n   */\n  readonly timeToFirstNonDefaultBranchCheckout?: number\n\n  /**\n   * Time (in seconds) from when the user first launched\n   * the application and entered the welcome wizard until\n   * the user completed the wizard.\n   *\n   * A negative value means that this action hasn't yet\n   * taken place while undefined means that the current\n   * user installed desktop prior to this metric beeing\n   * added and we will thus never be able to provide a\n   * value.\n   */\n  readonly timeToWelcomeWizardTerminated?: number\n\n  /**\n   * The method that was used when authenticating a\n   * user in the welcome flow. If multiple succesful\n   * authentications happened during the welcome flow\n   * due to the user stepping back and signing in to\n   * another account this will reflect the last one.\n   */\n  readonly welcomeWizardSignInMethod?: 'basic' | 'web'\n}\n\ninterface ICalculatedStats {\n  /** The app version. */\n  readonly version: string\n\n  /** The OS version. */\n  readonly osVersion: string\n\n  /** The platform. */\n  readonly platform: string\n\n  /** The number of total repositories. */\n  readonly repositoryCount: number\n\n  /** The number of GitHub repositories. */\n  readonly gitHubRepositoryCount: number\n\n  /** The install ID. */\n  readonly guid: string\n\n  /** Is the user logged in with a GitHub.com account? */\n  readonly dotComAccount: boolean\n\n  /** Is the user logged in with an Enterprise account? */\n  readonly enterpriseAccount: boolean\n\n  /**\n   * The name of the currently selected theme/application\n   * appearance as set at time of stats submission.\n   */\n  readonly theme: string\n\n  readonly eventType: 'usage'\n}\n\ntype DailyStats = ICalculatedStats &\n  ILaunchStats &\n  IDailyMeasures &\n  IOnboardingStats\n\n/** The store for the app's stats. */\nexport class StatsStore {\n  private readonly db: StatsDatabase\n  private readonly uiActivityMonitor: IUiActivityMonitor\n  private uiActivityMonitorSubscription: Disposable | null = null\n\n  /** Has the user opted out of stats reporting? */\n  private optOut: boolean\n\n  public constructor(db: StatsDatabase, uiActivityMonitor: IUiActivityMonitor) {\n    this.db = db\n    this.uiActivityMonitor = uiActivityMonitor\n\n    const optOutValue = localStorage.getItem(StatsOptOutKey)\n    if (optOutValue) {\n      this.optOut = !!parseInt(optOutValue, 10)\n\n      // If the user has set an opt out value but we haven't sent the ping yet,\n      // give it a shot now.\n      if (!localStorage.getItem(HasSentOptInPingKey)) {\n        this.sendOptInStatusPing(!this.optOut)\n      }\n    } else {\n      this.optOut = false\n    }\n\n    this.enableUiActivityMonitoring()\n  }\n\n  /** Should the app report its daily stats? */\n  private shouldReportDailyStats(): boolean {\n    const lastDateString = localStorage.getItem(LastDailyStatsReportKey)\n    let lastDate = 0\n    if (lastDateString && lastDateString.length > 0) {\n      lastDate = parseInt(lastDateString, 10)\n    }\n\n    if (isNaN(lastDate)) {\n      lastDate = 0\n    }\n\n    const now = Date.now()\n    return now - lastDate > DailyStatsReportInterval\n  }\n\n  /** Report any stats which are eligible for reporting. */\n  public async reportStats(\n    accounts: ReadonlyArray<Account>,\n    repositories: ReadonlyArray<Repository>\n  ) {\n    if (this.optOut) {\n      return\n    }\n\n    // Never report stats while in dev or test. They could be pretty crazy.\n    if (__DEV__ || process.env.TEST_ENV) {\n      return\n    }\n\n    // don't report until the user has had a chance to view and opt-in for\n    // sharing their stats with us\n    if (!hasShownWelcomeFlow()) {\n      return\n    }\n\n    if (!this.shouldReportDailyStats()) {\n      return\n    }\n\n    const now = Date.now()\n    const stats = await this.getDailyStats(accounts, repositories)\n\n    try {\n      const response = await this.post(stats)\n      if (!response.ok) {\n        throw new Error(\n          `Unexpected status: ${response.statusText} (${response.status})`\n        )\n      }\n\n      log.info('Stats reported.')\n\n      await this.clearDailyStats()\n      localStorage.setItem(LastDailyStatsReportKey, now.toString())\n    } catch (e) {\n      log.error('Error reporting stats:', e)\n    }\n  }\n\n  /** Record the given launch stats. */\n  public async recordLaunchStats(stats: ILaunchStats) {\n    await this.db.launches.add(stats)\n  }\n\n  /**\n   * Clear the stored daily stats. Not meant to be called\n   * directly. Marked as public in order to enable testing\n   * of a specific scenario, see stats-store-tests for more\n   * detail.\n   */\n  public async clearDailyStats() {\n    await this.db.launches.clear()\n    await this.db.dailyMeasures.clear()\n\n    this.enableUiActivityMonitoring()\n  }\n\n  private enableUiActivityMonitoring() {\n    if (this.uiActivityMonitorSubscription !== null) {\n      return\n    }\n\n    this.uiActivityMonitorSubscription = this.uiActivityMonitor.onActivity(\n      this.onUiActivity\n    )\n  }\n\n  private disableUiActivityMonitoring() {\n    if (this.uiActivityMonitorSubscription === null) {\n      return\n    }\n\n    this.uiActivityMonitorSubscription.dispose()\n    this.uiActivityMonitorSubscription = null\n  }\n\n  /** Get the daily stats. */\n  private async getDailyStats(\n    accounts: ReadonlyArray<Account>,\n    repositories: ReadonlyArray<Repository>\n  ): Promise<DailyStats> {\n    const launchStats = await this.getAverageLaunchStats()\n    const dailyMeasures = await this.getDailyMeasures()\n    const userType = this.determineUserType(accounts)\n    const repositoryCounts = this.categorizedRepositoryCounts(repositories)\n    const onboardingStats = this.getOnboardingStats()\n\n    return {\n      eventType: 'usage',\n      version: getVersion(),\n      osVersion: getOS(),\n      platform: process.platform,\n      theme: getPersistedThemeName(),\n      ...launchStats,\n      ...dailyMeasures,\n      ...userType,\n      ...onboardingStats,\n      guid: getGUID(),\n      ...repositoryCounts,\n    }\n  }\n\n  private getOnboardingStats(): IOnboardingStats {\n    const wizardInitiatedAt = getLocalStorageTimestamp(\n      WelcomeWizardInitiatedAtKey\n    )\n\n    // If we don't have a start time for the wizard none of our other metrics\n    // makes sense. This will happen for users who installed the app before\n    // we started tracking onboarding stats.\n    if (wizardInitiatedAt === null) {\n      return {}\n    }\n\n    const timeToWelcomeWizardTerminated = timeTo(WelcomeWizardCompletedAtKey)\n    const timeToFirstAddedRepository = timeTo(FirstRepositoryAddedAtKey)\n    const timeToFirstClonedRepository = timeTo(FirstRepositoryClonedAtKey)\n    const timeToFirstCreatedRepository = timeTo(FirstRepositoryCreatedAtKey)\n    const timeToFirstCommit = timeTo(FirstCommitCreatedAtKey)\n    const timeToFirstGitHubPush = timeTo(FirstPushToGitHubAtKey)\n    const timeToFirstNonDefaultBranchCheckout = timeTo(\n      FirstNonDefaultBranchCheckoutAtKey\n    )\n\n    const welcomeWizardSignInMethod = getWelcomeWizardSignInMethod()\n\n    return {\n      timeToWelcomeWizardTerminated,\n      timeToFirstAddedRepository,\n      timeToFirstClonedRepository,\n      timeToFirstCreatedRepository,\n      timeToFirstCommit,\n      timeToFirstGitHubPush,\n      timeToFirstNonDefaultBranchCheckout,\n      welcomeWizardSignInMethod,\n    }\n  }\n\n  private categorizedRepositoryCounts(repositories: ReadonlyArray<Repository>) {\n    return {\n      repositoryCount: repositories.length,\n      gitHubRepositoryCount: repositories.filter(r => r.gitHubRepository)\n        .length,\n    }\n  }\n\n  /** Determines if an account is a dotCom and/or enterprise user */\n  private determineUserType(accounts: ReadonlyArray<Account>) {\n    const dotComAccount = !!accounts.find(\n      a => a.endpoint === getDotComAPIEndpoint()\n    )\n    const enterpriseAccount = !!accounts.find(\n      a => a.endpoint !== getDotComAPIEndpoint()\n    )\n\n    return {\n      dotComAccount,\n      enterpriseAccount,\n    }\n  }\n\n  /** Calculate the average launch stats. */\n  private async getAverageLaunchStats(): Promise<ILaunchStats> {\n    const launches:\n      | ReadonlyArray<ILaunchStats>\n      | undefined = await this.db.launches.toArray()\n    if (!launches || !launches.length) {\n      return {\n        mainReadyTime: -1,\n        loadTime: -1,\n        rendererReadyTime: -1,\n      }\n    }\n\n    const start: ILaunchStats = {\n      mainReadyTime: 0,\n      loadTime: 0,\n      rendererReadyTime: 0,\n    }\n\n    const totals = launches.reduce((running, current) => {\n      return {\n        mainReadyTime: running.mainReadyTime + current.mainReadyTime,\n        loadTime: running.loadTime + current.loadTime,\n        rendererReadyTime:\n          running.rendererReadyTime + current.rendererReadyTime,\n      }\n    }, start)\n\n    return {\n      mainReadyTime: totals.mainReadyTime / launches.length,\n      loadTime: totals.loadTime / launches.length,\n      rendererReadyTime: totals.rendererReadyTime / launches.length,\n    }\n  }\n\n  /** Get the daily measures. */\n  private async getDailyMeasures(): Promise<IDailyMeasures> {\n    const measures:\n      | IDailyMeasures\n      | undefined = await this.db.dailyMeasures.limit(1).first()\n    return {\n      ...DefaultDailyMeasures,\n      ...measures,\n      // We could spread the database ID in, but we really don't want it.\n      id: undefined,\n    }\n  }\n\n  private async updateDailyMeasures<K extends keyof IDailyMeasures>(\n    fn: (measures: IDailyMeasures) => Pick<IDailyMeasures, K>\n  ): Promise<void> {\n    const defaultMeasures = DefaultDailyMeasures\n    await this.db.transaction('rw', this.db.dailyMeasures, async () => {\n      const measures = await this.db.dailyMeasures.limit(1).first()\n      const measuresWithDefaults = {\n        ...defaultMeasures,\n        ...measures,\n      }\n      const newMeasures = merge(measuresWithDefaults, fn(measuresWithDefaults))\n\n      return this.db.dailyMeasures.put(newMeasures)\n    })\n  }\n\n  /** Record that a commit was accomplished. */\n  public async recordCommit(): Promise<void> {\n    await this.updateDailyMeasures(m => ({\n      commits: m.commits + 1,\n    }))\n\n    createLocalStorageTimestamp(FirstCommitCreatedAtKey)\n  }\n\n  /** Record that a partial commit was accomplished. */\n  public recordPartialCommit(): Promise<void> {\n    return this.updateDailyMeasures(m => ({\n      partialCommits: m.partialCommits + 1,\n    }))\n  }\n\n  /** Record that a commit was created with one or more co-authors. */\n  public recordCoAuthoredCommit(): Promise<void> {\n    return this.updateDailyMeasures(m => ({\n      coAuthoredCommits: m.coAuthoredCommits + 1,\n    }))\n  }\n\n  /** Record that the user opened a shell. */\n  public recordOpenShell(): Promise<void> {\n    return this.updateDailyMeasures(m => ({\n      openShellCount: m.openShellCount + 1,\n    }))\n  }\n\n  /** Record that a branch comparison has been made */\n  public recordBranchComparison(): Promise<void> {\n    return this.updateDailyMeasures(m => ({\n      branchComparisons: m.branchComparisons + 1,\n    }))\n  }\n\n  /** Record that a branch comparison has been made to the `master` branch */\n  public recordDefaultBranchComparison(): Promise<void> {\n    return this.updateDailyMeasures(m => ({\n      defaultBranchComparisons: m.defaultBranchComparisons + 1,\n    }))\n  }\n\n  /** Record that a merge has been initiated from the `compare` sidebar */\n  public recordCompareInitiatedMerge(): Promise<void> {\n    return this.updateDailyMeasures(m => ({\n      mergesInitiatedFromComparison: m.mergesInitiatedFromComparison + 1,\n    }))\n  }\n\n  /** Record that a merge has been initiated from the `Branch -> Update From Default Branch` menu item */\n  public recordMenuInitiatedUpdate(): Promise<void> {\n    return this.updateDailyMeasures(m => ({\n      updateFromDefaultBranchMenuCount: m.updateFromDefaultBranchMenuCount + 1,\n    }))\n  }\n\n  /** Record that conflicts were detected by a merge initiated by Desktop */\n  public recordMergeConflictFromPull(): Promise<void> {\n    return this.updateDailyMeasures(m => ({\n      mergeConflictFromPullCount: m.mergeConflictFromPullCount + 1,\n    }))\n  }\n\n  /** Record that conflicts were detected by a merge initiated by Desktop */\n  public recordMergeConflictFromExplicitMerge(): Promise<void> {\n    return this.updateDailyMeasures(m => ({\n      mergeConflictFromExplicitMergeCount:\n        m.mergeConflictFromExplicitMergeCount + 1,\n    }))\n  }\n\n  /** Record that a merge has been initiated from the `Branch -> Merge Into Current Branch` menu item */\n  public recordMenuInitiatedMerge(): Promise<void> {\n    return this.updateDailyMeasures(m => ({\n      mergeIntoCurrentBranchMenuCount: m.mergeIntoCurrentBranchMenuCount + 1,\n    }))\n  }\n\n  /** Record that the user checked out a PR branch */\n  public recordPRBranchCheckout(): Promise<void> {\n    return this.updateDailyMeasures(m => ({\n      prBranchCheckouts: m.prBranchCheckouts + 1,\n    }))\n  }\n\n  public recordRepoClicked(repoHasIndicator: boolean): Promise<void> {\n    if (repoHasIndicator) {\n      return this.updateDailyMeasures(m => ({\n        repoWithIndicatorClicked: m.repoWithIndicatorClicked + 1,\n      }))\n    }\n    return this.updateDailyMeasures(m => ({\n      repoWithoutIndicatorClicked: m.repoWithoutIndicatorClicked + 1,\n    }))\n  }\n\n  /** Set whether the user has opted out of stats reporting. */\n  public async setOptOut(optOut: boolean): Promise<void> {\n    const changed = this.optOut !== optOut\n\n    this.optOut = optOut\n\n    localStorage.setItem(StatsOptOutKey, optOut ? '1' : '0')\n\n    if (changed) {\n      await this.sendOptInStatusPing(!optOut)\n    }\n  }\n\n  /** Has the user opted out of stats reporting? */\n  public getOptOut(): boolean {\n    return this.optOut\n  }\n\n  /** Record that user dismissed diverging branch notification */\n  public async recordDivergingBranchBannerDismissal(): Promise<void> {\n    return this.updateDailyMeasures(m => ({\n      divergingBranchBannerDismissal: m.divergingBranchBannerDismissal + 1,\n    }))\n  }\n\n  /** Record that user initiated a merge from within the notification banner */\n  public async recordDivergingBranchBannerInitatedMerge(): Promise<void> {\n    return this.updateDailyMeasures(m => ({\n      divergingBranchBannerInitatedMerge:\n        m.divergingBranchBannerInitatedMerge + 1,\n    }))\n  }\n\n  /** Record that user initiated a compare from within the notification banner */\n  public async recordDivergingBranchBannerInitiatedCompare(): Promise<void> {\n    return this.updateDailyMeasures(m => ({\n      divergingBranchBannerInitiatedCompare:\n        m.divergingBranchBannerInitiatedCompare + 1,\n    }))\n  }\n\n  /**\n   * Record that user initiated a merge after getting to compare view\n   * from within notificatio banner\n   */\n  public async recordDivergingBranchBannerInfluencedMerge(): Promise<void> {\n    return this.updateDailyMeasures(m => ({\n      divergingBranchBannerInfluencedMerge:\n        m.divergingBranchBannerInfluencedMerge + 1,\n    }))\n  }\n\n  /** Record that the user was shown the notification banner */\n  public async recordDivergingBranchBannerDisplayed(): Promise<void> {\n    return this.updateDailyMeasures(m => ({\n      divergingBranchBannerDisplayed: m.divergingBranchBannerDisplayed + 1,\n    }))\n  }\n\n  /** Record that the user pushed to GitHub.com */\n  public async recordPushToGitHub(): Promise<void> {\n    await this.updateDailyMeasures(m => ({\n      dotcomPushCount: m.dotcomPushCount + 1,\n    }))\n\n    createLocalStorageTimestamp(FirstPushToGitHubAtKey)\n  }\n\n  /** Record that the user pushed to a GitHub Enterprise instance */\n  public async recordPushToGitHubEnterprise(): Promise<void> {\n    await this.updateDailyMeasures(m => ({\n      enterprisePushCount: m.enterprisePushCount + 1,\n    }))\n\n    // Note, this is not a typo. We track both GitHub.com and\n    // GitHub Enteprise under the same key\n    createLocalStorageTimestamp(FirstPushToGitHubAtKey)\n  }\n\n  /** Record that the user pushed to a generic remote */\n  public async recordPushToGenericRemote(): Promise<void> {\n    return this.updateDailyMeasures(m => ({\n      externalPushCount: m.externalPushCount + 1,\n    }))\n  }\n\n  /** Record that the user saw a 'merge conflicts' warning but continued with the merge */\n  public async recordUserProceededWhileLoading(): Promise<void> {\n    return this.updateDailyMeasures(m => ({\n      mergedWithLoadingHintCount: m.mergedWithLoadingHintCount + 1,\n    }))\n  }\n\n  /** Record that the user saw a 'merge conflicts' warning but continued with the merge */\n  public async recordMergeHintSuccessAndUserProceeded(): Promise<void> {\n    return this.updateDailyMeasures(m => ({\n      mergedWithCleanMergeHintCount: m.mergedWithCleanMergeHintCount + 1,\n    }))\n  }\n\n  /** Record that the user saw a 'merge conflicts' warning but continued with the merge */\n  public async recordUserProceededAfterConflictWarning(): Promise<void> {\n    return this.updateDailyMeasures(m => ({\n      mergedWithConflictWarningHintCount:\n        m.mergedWithConflictWarningHintCount + 1,\n    }))\n  }\n\n  public recordWelcomeWizardInitiated() {\n    localStorage.setItem(WelcomeWizardInitiatedAtKey, `${Date.now()}`)\n    localStorage.removeItem(WelcomeWizardCompletedAtKey)\n  }\n\n  public recordWelcomeWizardTerminated() {\n    localStorage.setItem(WelcomeWizardCompletedAtKey, `${Date.now()}`)\n  }\n\n  public recordAddExistingRepository() {\n    createLocalStorageTimestamp(FirstRepositoryAddedAtKey)\n  }\n\n  public recordCloneRepository() {\n    createLocalStorageTimestamp(FirstRepositoryClonedAtKey)\n  }\n\n  public recordCreateRepository() {\n    createLocalStorageTimestamp(FirstRepositoryCreatedAtKey)\n  }\n\n  public recordNonDefaultBranchCheckout() {\n    createLocalStorageTimestamp(FirstNonDefaultBranchCheckoutAtKey)\n  }\n\n  public recordWelcomeWizardSignInMethod(method: SignInMethod) {\n    localStorage.setItem(WelcomeWizardSignInMethodKey, method)\n  }\n\n  /** Record when a conflicted merge was successfully completed by the user */\n  public async recordMergeSuccesAfterConflicts(): Promise<void> {\n    return this.updateDailyMeasures(m => ({\n      mergeSuccessAfterConflictsCount: m.mergeSuccessAfterConflictsCount + 1,\n    }))\n  }\n\n  /** Record when a conflicted merge was aborted by the user */\n  public async recordMergeAbortedAfterConflicts(): Promise<void> {\n    return this.updateDailyMeasures(m => ({\n      mergeAbortedAfterConflictsCount: m.mergeAbortedAfterConflictsCount + 1,\n    }))\n  }\n\n  private onUiActivity = async () => {\n    this.disableUiActivityMonitoring()\n\n    return this.updateDailyMeasures(m => ({\n      active: true,\n    }))\n  }\n\n  /** Post some data to our stats endpoint. */\n  private post(body: object): Promise<Response> {\n    const options: RequestInit = {\n      method: 'POST',\n      headers: new Headers({ 'Content-Type': 'application/json' }),\n      body: JSON.stringify(body),\n    }\n\n    return fetch(StatsEndpoint, options)\n  }\n\n  private async sendOptInStatusPing(optIn: boolean): Promise<void> {\n    const direction = optIn ? 'in' : 'out'\n    try {\n      const response = await this.post({\n        eventType: 'ping',\n        optIn,\n      })\n      if (!response.ok) {\n        throw new Error(\n          `Unexpected status: ${response.statusText} (${response.status})`\n        )\n      }\n\n      localStorage.setItem(HasSentOptInPingKey, '1')\n\n      log.info(`Opt ${direction} reported.`)\n    } catch (e) {\n      log.error(`Error reporting opt ${direction}:`, e)\n    }\n  }\n}\n\n/**\n * Store the current date (in unix time) in localStorage.\n *\n * If the provided key already exists it will not be\n * overwritten.\n */\nfunction createLocalStorageTimestamp(key: string) {\n  if (localStorage.getItem(key) !== null) {\n    return\n  }\n\n  localStorage.setItem(key, `${Date.now()}`)\n}\n\n/**\n * Get a time stamp (in unix time) from localStorage.\n *\n * If the key doesn't exist or if the stored value can't\n * be converted into a number this method will return null.\n */\nfunction getLocalStorageTimestamp(key: string): number | null {\n  const value = parseInt(localStorage.getItem(key) || '', 10)\n  return isNaN(value) ? null : value\n}\n\n/**\n * Calculate the duration (in seconds) between the time the\n * welcome wizard was initiated to the time for the given\n * action.\n *\n * If no time stamp exists for when the welcome wizard was\n * initiated, which would be the case if the user completed\n * the wizard before we introduced onboarding metrics, or if\n * the delta between the two values are negative (which could\n * happen if a user manually manipulated localStorage in order\n * to run the wizard again) this method will return undefined.\n */\nfunction timeTo(key: string): number | undefined {\n  const startTime = getLocalStorageTimestamp(WelcomeWizardInitiatedAtKey)\n\n  if (startTime === null) {\n    return undefined\n  }\n\n  const endTime = getLocalStorageTimestamp(key)\n  return endTime === null || endTime <= startTime\n    ? -1\n    : Math.round((endTime - startTime) / 1000)\n}\n\n/**\n * Get a string representing the sign in method that was used\n * when authenticating a user in the welcome flow. This method\n * ensures that the reported value is known to the analytics\n * system regardless of whether the enum value of the SignInMethod\n * type changes.\n */\nfunction getWelcomeWizardSignInMethod(): 'basic' | 'web' | undefined {\n  const method = localStorage.getItem(\n    WelcomeWizardSignInMethodKey\n  ) as SignInMethod | null\n\n  try {\n    switch (method) {\n      case SignInMethod.Basic:\n      case SignInMethod.Web:\n        return method\n      case null:\n        return undefined\n      default:\n        return assertNever(method, `Unknown sign in method: ${method}`)\n    }\n  } catch (ex) {\n    log.error(`Could not parse welcome wizard sign in method`, ex)\n    return undefined\n  }\n}\n","import Dexie from 'dexie'\n\n// NB: This _must_ be incremented whenever the DB key scheme changes.\nconst DatabaseVersion = 2\n\n/** The timing stats for app launch. */\nexport interface ILaunchStats {\n  /**\n   * The time (in milliseconds) it takes from when our main process code is\n   * first loaded until the app `ready` event is emitted.\n   */\n  readonly mainReadyTime: number\n\n  /**\n   * The time (in milliseconds) it takes from when loading begins to loading\n   * end.\n   */\n  readonly loadTime: number\n\n  /**\n   * The time (in milliseconds) it takes from when our renderer process code is\n   * first loaded until the renderer `ready` event is emitted.\n   */\n  readonly rendererReadyTime: number\n}\n\n/** The daily measures captured for stats. */\nexport interface IDailyMeasures {\n  /** The ID in the database. */\n  readonly id?: number\n\n  /** The number of commits. */\n  readonly commits: number\n\n  /** The number of times the user has opened a shell from the app. */\n  readonly openShellCount: number\n\n  /** The number of partial commits. */\n  readonly partialCommits: number\n\n  /** The number of commits created with one or more co-authors. */\n  readonly coAuthoredCommits: number\n\n  /** The number of times a branch is compared to an arbitrary branch */\n  readonly branchComparisons: number\n\n  /** The number of times a branch is compared to `master` */\n  readonly defaultBranchComparisons: number\n\n  /** The number of times a merge is initiated in the `compare` sidebar */\n  readonly mergesInitiatedFromComparison: number\n\n  /** The number of times the `Branch -> Update From Default Branch` menu item is used */\n  readonly updateFromDefaultBranchMenuCount: number\n\n  /** The number of times the `Branch -> Merge Into Current Branch` menu item is used */\n  readonly mergeIntoCurrentBranchMenuCount: number\n\n  /** The number of times the user checks out a branch using the PR menu */\n  readonly prBranchCheckouts: number\n\n  /** The numbers of times a repo with indicators is clicked on repo list view */\n  readonly repoWithIndicatorClicked: number\n  /** The numbers of times a repo without indicators is clicked on repo list view */\n  readonly repoWithoutIndicatorClicked: number\n\n  /** The number of times the user dismisses the diverged branch notification */\n  readonly divergingBranchBannerDismissal: number\n\n  /** The number of times the user merges from the diverged branch notification merge CTA button */\n  readonly divergingBranchBannerInitatedMerge: number\n\n  /** The number of times the user compares from the diverged branch notification compare CTA button */\n  readonly divergingBranchBannerInitiatedCompare: number\n\n  /**\n   * The number of times the user merges from the compare view after getting to that state\n   * from the diverged branch notification compare CTA button\n   */\n  readonly divergingBranchBannerInfluencedMerge: number\n\n  /** The number of times the diverged branch notification is displayed */\n  readonly divergingBranchBannerDisplayed: number\n\n  /** The number of times the user pushes to GitHub.com */\n  readonly dotcomPushCount: number\n\n  /** The number of times the user pushed to a GitHub enterprise instance */\n  readonly enterprisePushCount: number\n\n  /** The number of times the users pushes to a generic remote */\n  readonly externalPushCount: number\n\n  /** The number of times the user merged before seeing the result of the merge hint */\n  readonly mergedWithLoadingHintCount: number\n\n  /** The number of times the user has merged after seeing the 'no conflicts' merge hint */\n  readonly mergedWithCleanMergeHintCount: number\n\n  /** The number of times the user has merged after seeing the 'you have XX conflicted files' warning */\n  readonly mergedWithConflictWarningHintCount: number\n\n  /** Whether or not the app has been interacted with during the current reporting window */\n  readonly active: boolean\n\n  /** The number of times a `git pull` initiated by Desktop resulted in a merge conflict for the user */\n  readonly mergeConflictFromPullCount: number\n\n  /** The number of times a `git merge` initiated by Desktop resulted in a merge conflict for the user */\n  readonly mergeConflictFromExplicitMergeCount: number\n\n  /** The number of times a conflicted merge was successfully completed by the user */\n  readonly mergeSuccessAfterConflictsCount: number\n\n  /** The number of times a conflicted merge was aborted by the user */\n  readonly mergeAbortedAfterConflictsCount: number\n}\n\nexport class StatsDatabase extends Dexie {\n  public launches!: Dexie.Table<ILaunchStats, number>\n  public dailyMeasures!: Dexie.Table<IDailyMeasures, number>\n\n  public constructor(name: string) {\n    super(name)\n\n    this.version(1).stores({\n      launches: '++',\n    })\n\n    this.version(DatabaseVersion).stores({\n      dailyMeasures: '++id',\n    })\n  }\n}\n","import * as React from 'react'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { WelcomeStep } from './welcome'\nimport { LinkButton } from '../lib/link-button'\nimport { Checkbox, CheckboxValue } from '../lib/checkbox'\nimport { Form } from '../lib/form'\nimport { Button } from '../lib/button'\nimport { Row } from '../lib/row'\nimport { SamplesURL } from '../../lib/stats'\n\ninterface IUsageOptOutProps {\n  readonly dispatcher: Dispatcher\n  readonly advance: (step: WelcomeStep) => void\n  readonly done: () => void\n  readonly optOut: boolean\n}\n\ninterface IUsageOptOutState {\n  readonly newOptOutValue: boolean\n}\n\n/** The Welcome flow step for opting out of stats reporting. */\nexport class UsageOptOut extends React.Component<\n  IUsageOptOutProps,\n  IUsageOptOutState\n> {\n  public constructor(props: IUsageOptOutProps) {\n    super(props)\n\n    this.state = { newOptOutValue: props.optOut }\n  }\n\n  public render() {\n    return (\n      <div className=\"usage-opt-out\">\n        <h1 className=\"welcome-title\">Make GitHub Desktop&nbsp;better!</h1>\n\n        <p>\n          Would you like to help us improve GitHub Desktop by periodically\n          submitting{' '}\n          <LinkButton uri={SamplesURL}>anonymous usage data</LinkButton>?\n        </p>\n\n        <Form onSubmit={this.finish}>\n          <Row>\n            <Checkbox\n              label=\"Yes, submit anonymized usage data\"\n              value={\n                this.state.newOptOutValue ? CheckboxValue.Off : CheckboxValue.On\n              }\n              onChange={this.onChange}\n            />\n          </Row>\n\n          <Row className=\"actions\">\n            <Button type=\"submit\">Finish</Button>\n            <Button onClick={this.cancel}>Cancel</Button>\n          </Row>\n        </Form>\n      </div>\n    )\n  }\n\n  private onChange = (event: React.FormEvent<HTMLInputElement>) => {\n    const value = event.currentTarget.checked\n    this.setState({ newOptOutValue: !value })\n  }\n\n  private cancel = () => {\n    this.props.advance(WelcomeStep.ConfigureGit)\n  }\n\n  private finish = () => {\n    this.props.dispatcher.setStatsOptOut(this.state.newOptOutValue)\n    this.props.done()\n  }\n}\n","import * as React from 'react'\nimport { Commit } from '../../models/commit'\nimport { lookupPreferredEmail } from '../../lib/email'\nimport {\n  getGlobalConfigValue,\n  setGlobalConfigValue,\n} from '../../lib/git/config'\nimport { CommitListItem } from '../history/commit-list-item'\nimport { Account } from '../../models/account'\nimport { CommitIdentity } from '../../models/commit-identity'\nimport { Form } from '../lib/form'\nimport { Button } from '../lib/button'\nimport { TextBox } from '../lib/text-box'\nimport { Row } from '../lib/row'\n\ninterface IConfigureGitUserProps {\n  /** The logged-in accounts. */\n  readonly accounts: ReadonlyArray<Account>\n\n  /** Called after the user has chosen to save their config. */\n  readonly onSave?: () => void\n\n  /** The label for the button which saves config changes. */\n  readonly saveLabel?: string\n}\n\ninterface IConfigureGitUserState {\n  readonly name: string\n  readonly email: string\n  readonly avatarURL: string | null\n}\n\n/**\n * A component which allows the user to configure their Git user.\n *\n * Provide `children` elements which will be rendered below the form.\n */\nexport class ConfigureGitUser extends React.Component<\n  IConfigureGitUserProps,\n  IConfigureGitUserState\n> {\n  public constructor(props: IConfigureGitUserProps) {\n    super(props)\n\n    this.state = { name: '', email: '', avatarURL: null }\n  }\n\n  public async componentWillMount() {\n    let name = await getGlobalConfigValue('user.name')\n    let email = await getGlobalConfigValue('user.email')\n\n    const user = this.props.accounts[0]\n    if ((!name || !name.length) && user) {\n      name = user.name && user.name.length ? user.name : user.login\n    }\n\n    if ((!email || !email.length) && user) {\n      const found = lookupPreferredEmail(user.emails)\n      if (found) {\n        email = found.email\n      }\n    }\n\n    const avatarURL = email ? this.avatarURLForEmail(email) : null\n    this.setState({ name: name || '', email: email || '', avatarURL })\n  }\n\n  private dateWithMinuteOffset(date: Date, minuteOffset: number): Date {\n    const copy = new Date(date.getTime())\n    copy.setTime(copy.getTime() + minuteOffset * 60 * 1000)\n    return copy\n  }\n\n  public render() {\n    const now = new Date()\n\n    // NB: We're using the name as the commit SHA:\n    //  1. `Commit` is referentially transparent wrt the SHA. So in order to get\n    //     it to update when we name changes, we need to change the SHA.\n    //  2. We don't display the SHA so the user won't ever know our secret.\n    const author = new CommitIdentity(\n      this.state.name,\n      this.state.email,\n      this.dateWithMinuteOffset(now, -30)\n    )\n    const dummyCommit = new Commit(\n      this.state.name,\n      'Fix all the things',\n      '',\n      author,\n      author,\n      [],\n      []\n    )\n    const emoji = new Map()\n    return (\n      <div id=\"configure-git-user\">\n        <Form className=\"sign-in-form\" onSubmit={this.save}>\n          <TextBox\n            label=\"Name\"\n            placeholder=\"Your Name\"\n            value={this.state.name}\n            onValueChanged={this.onNameChange}\n          />\n\n          <TextBox\n            label=\"Email\"\n            placeholder=\"your-email@example.com\"\n            value={this.state.email}\n            onValueChanged={this.onEmailChange}\n          />\n\n          <Row>\n            <Button type=\"submit\">{this.props.saveLabel || 'Save'}</Button>\n            {this.props.children}\n          </Row>\n        </Form>\n\n        <div id=\"commit-list\" className=\"commit-list-example\">\n          <div className=\"header\">Example commit</div>\n\n          <CommitListItem\n            commit={dummyCommit}\n            emoji={emoji}\n            gitHubUsers={null}\n            gitHubRepository={null}\n            isLocal={false}\n          />\n        </div>\n      </div>\n    )\n  }\n\n  private onNameChange = (name: string) => {\n    this.setState({\n      name,\n    })\n  }\n\n  private onEmailChange = (email: string) => {\n    const avatarURL = this.avatarURLForEmail(email)\n\n    this.setState({\n      name: this.state.name,\n      email,\n      avatarURL,\n    })\n  }\n\n  private avatarURLForEmail(email: string): string | null {\n    const matchingAccount = this.props.accounts.find(\n      a => a.emails.findIndex(e => e.email === email) > -1\n    )\n    return matchingAccount ? matchingAccount.avatarURL : null\n  }\n\n  private save = async () => {\n    if (this.props.onSave) {\n      this.props.onSave()\n    }\n\n    const name = this.state.name\n    if (name.length) {\n      await setGlobalConfigValue('user.name', name)\n    }\n\n    const email = this.state.email\n    if (email.length) {\n      await setGlobalConfigValue('user.email', email)\n    }\n  }\n}\n","import * as React from 'react'\nimport { WelcomeStep } from './welcome'\nimport { Account } from '../../models/account'\nimport { ConfigureGitUser } from '../lib/configure-git-user'\nimport { Button } from '../lib/button'\n\ninterface IConfigureGitProps {\n  readonly accounts: ReadonlyArray<Account>\n  readonly advance: (step: WelcomeStep) => void\n}\n\n/** The Welcome flow step to configure git. */\nexport class ConfigureGit extends React.Component<IConfigureGitProps, {}> {\n  public render() {\n    return (\n      <div id=\"configure-git\">\n        <h1 className=\"welcome-title\">Configure Git</h1>\n        <p className=\"welcome-text\">\n          This is used to identify the commits you create. Anyone will be able\n          to see this information if you publish commits.\n        </p>\n\n        <ConfigureGitUser\n          accounts={this.props.accounts}\n          onSave={this.continue}\n          saveLabel=\"Continue\"\n        >\n          <Button onClick={this.cancel}>Cancel</Button>\n        </ConfigureGitUser>\n      </div>\n    )\n  }\n\n  private cancel = () => {\n    this.props.advance(WelcomeStep.Start)\n  }\n\n  private continue = () => {\n    this.props.advance(WelcomeStep.UsageOptOut)\n  }\n}\n","import * as React from 'react'\nimport { WelcomeStep } from './welcome'\nimport { Button } from '../lib/button'\nimport { SignIn } from '../lib/sign-in'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { SignInState } from '../../lib/stores'\n\ninterface ISignInEnterpriseProps {\n  readonly dispatcher: Dispatcher\n  readonly advance: (step: WelcomeStep) => void\n  readonly signInState: SignInState | null\n}\n\n/** The Welcome flow step to login to an Enterprise instance. */\nexport class SignInEnterprise extends React.Component<\n  ISignInEnterpriseProps,\n  {}\n> {\n  public render() {\n    const state = this.props.signInState\n\n    if (!state) {\n      return null\n    }\n\n    return (\n      <div id=\"sign-in-enterprise\">\n        <h1 className=\"welcome-title\">\n          Sign in to your GitHub Enterprise server\n        </h1>\n\n        <SignIn signInState={state} dispatcher={this.props.dispatcher}>\n          <Button onClick={this.cancel}>Cancel</Button>\n        </SignIn>\n      </div>\n    )\n  }\n\n  private cancel = () => {\n    this.props.advance(WelcomeStep.Start)\n  }\n}\n","import * as React from 'react'\nimport { Loading } from './loading'\nimport { Form } from './form'\nimport { TextBox } from './text-box'\nimport { Button } from './button'\nimport { Errors } from './errors'\n\ninterface IEnterpriseServerEntryProps {\n  /**\n   * An error which, if present, is presented to the\n   * user in close proximity to the actions or input fields\n   * related to the current step.\n   */\n  readonly error: Error | null\n\n  /**\n   * A value indicating whether or not the sign in store is\n   * busy processing a request. While this value is true all\n   * form inputs and actions save for a cancel action will\n   * be disabled.\n   */\n  readonly loading: boolean\n\n  /**\n   * A callback which is invoked once the user has entered an\n   * endpoint url and submitted it either by clicking on the submit\n   * button or by submitting the form through other means (ie hitting Enter).\n   */\n  readonly onSubmit: (url: string) => void\n\n  /** An array of additional buttons to render after the \"Continue\" button. */\n  readonly additionalButtons?: ReadonlyArray<JSX.Element>\n}\n\ninterface IEnterpriseServerEntryState {\n  readonly serverAddress: string\n}\n\n/** An entry form for an Enterprise server address. */\nexport class EnterpriseServerEntry extends React.Component<\n  IEnterpriseServerEntryProps,\n  IEnterpriseServerEntryState\n> {\n  public constructor(props: IEnterpriseServerEntryProps) {\n    super(props)\n    this.state = { serverAddress: '' }\n  }\n\n  public render() {\n    const disableEntry = this.props.loading\n    const disableSubmission =\n      this.state.serverAddress.length === 0 || this.props.loading\n\n    return (\n      <Form onSubmit={this.onSubmit}>\n        <TextBox\n          label=\"Enterprise server address\"\n          autoFocus={true}\n          disabled={disableEntry}\n          onValueChanged={this.onServerAddressChanged}\n          placeholder=\"https://github.example.com\"\n        />\n\n        {this.props.error ? <Errors>{this.props.error.message}</Errors> : null}\n\n        <div className=\"actions\">\n          <Button type=\"submit\" disabled={disableSubmission}>\n            {this.props.loading ? <Loading /> : null} Continue\n          </Button>\n          {this.props.additionalButtons}\n        </div>\n      </Form>\n    )\n  }\n\n  private onServerAddressChanged = (serverAddress: string) => {\n    this.setState({ serverAddress })\n  }\n\n  private onSubmit = () => {\n    this.props.onSubmit(this.state.serverAddress)\n  }\n}\n","import * as React from 'react'\nimport { Loading } from './loading'\nimport { Button } from './button'\nimport { TextBox } from './text-box'\nimport { Form } from './form'\nimport { Errors } from './errors'\n\nimport { getWelcomeMessage, AuthenticationMode } from '../../lib/2fa'\n\ninterface ITwoFactorAuthenticationProps {\n  /**\n   * A callback which is invoked once the user has entered a\n   * OTP token and submitted it either by clicking on the submit\n   * button or by submitting the form through other means (ie hitting Enter).\n   */\n  readonly onOTPEntered: (otp: string) => void\n\n  /** An array of additional buttons to render after the \"Sign In\" button. */\n  readonly additionalButtons?:\n    | ReadonlyArray<JSX.Element>\n    | number\n    | string\n    | boolean\n    | {}\n    | null\n\n  /**\n   * An error which, if present, is presented to the\n   * user in close proximity to the actions or input fields\n   * related to the current step.\n   */\n  readonly error: Error | null\n\n  /**\n   * A value indicating whether or not the sign in store is\n   * busy processing a request. While this value is true all\n   * form inputs and actions save for a cancel action will\n   * be disabled.\n   */\n  readonly loading: boolean\n\n  /**\n   * The 2FA type expected by the GitHub endpoint.\n   */\n  readonly type: AuthenticationMode\n}\n\ninterface ITwoFactorAuthenticationState {\n  readonly otp: string\n}\n\n/** The two-factor authentication component. */\nexport class TwoFactorAuthentication extends React.Component<\n  ITwoFactorAuthenticationProps,\n  ITwoFactorAuthenticationState\n> {\n  public constructor(props: ITwoFactorAuthenticationProps) {\n    super(props)\n\n    this.state = { otp: '' }\n  }\n\n  public render() {\n    const textEntryDisabled = this.props.loading\n\n    // ensure user has entered non-whitespace characters\n    const codeProvided = /\\S+/.test(this.state.otp)\n    const signInDisabled = !codeProvided || this.props.loading\n    const errors = this.props.error ? (\n      <Errors>{this.props.error.message}</Errors>\n    ) : null\n\n    return (\n      <div>\n        <p className=\"welcome-text\">{getWelcomeMessage(this.props.type)}</p>\n\n        <Form onSubmit={this.signIn}>\n          <TextBox\n            label=\"Authentication code\"\n            disabled={textEntryDisabled}\n            autoFocus={true}\n            onValueChanged={this.onOTPChange}\n          />\n\n          {errors}\n\n          <div className=\"actions\">\n            <Button type=\"submit\" disabled={signInDisabled}>\n              {this.props.loading ? <Loading /> : null} Verify\n            </Button>\n            {this.props.additionalButtons}\n          </div>\n        </Form>\n      </div>\n    )\n  }\n\n  private onOTPChange = (text: string) => {\n    this.setState({ otp: text })\n  }\n\n  private signIn = () => {\n    this.props.onOTPEntered(this.state.otp)\n  }\n}\n","import * as React from 'react'\nimport { LinkButton } from '../lib/link-button'\nimport { Octicon, OcticonSymbol } from '../octicons'\nimport { Loading } from './loading'\nimport { Form } from './form'\nimport { Button } from './button'\nimport { TextBox } from './text-box'\nimport { Errors } from './errors'\n\ninterface IAuthenticationFormProps {\n  /** Does the server support basic auth? */\n  readonly supportsBasicAuth: boolean\n\n  /**\n   * A callback which is invoked once the user has entered a username\n   * and password and submitted those either by clicking on the submit\n   * button or by submitting the form through other means (ie hitting Enter).\n   */\n  readonly onSubmit: (username: string, password: string) => void\n\n  /**\n   * A callback which is invoked if the user requests OAuth sign in using\n   * their system configured browser.\n   */\n  readonly onBrowserSignInRequested: () => void\n\n  /** An array of additional buttons to render after the \"Sign In\" button. */\n  readonly additionalButtons?: ReadonlyArray<JSX.Element>\n\n  /**\n   * An error which, if present, is presented to the\n   * user in close proximity to the actions or input fields\n   * related to the current step.\n   */\n  readonly error: Error | null\n\n  /**\n   * A value indicating whether or not the sign in store is\n   * busy processing a request. While this value is true all\n   * form inputs and actions save for a cancel action will\n   * be disabled.\n   */\n  readonly loading: boolean\n\n  readonly forgotPasswordUrl: string\n}\n\ninterface IAuthenticationFormState {\n  readonly username: string\n  readonly password: string\n}\n\n/** The GitHub authentication component. */\nexport class AuthenticationForm extends React.Component<\n  IAuthenticationFormProps,\n  IAuthenticationFormState\n> {\n  public constructor(props: IAuthenticationFormProps) {\n    super(props)\n\n    this.state = { username: '', password: '' }\n  }\n\n  public render() {\n    return (\n      <Form className=\"sign-in-form\" onSubmit={this.signIn}>\n        {this.renderUsernamePassword()}\n\n        {this.renderSignInWithBrowser()}\n      </Form>\n    )\n  }\n\n  private renderUsernamePassword() {\n    if (!this.props.supportsBasicAuth) {\n      return null\n    }\n\n    const disabled = this.props.loading\n    return (\n      <div>\n        <TextBox\n          label=\"Username or email address\"\n          disabled={disabled}\n          autoFocus={true}\n          onValueChanged={this.onUsernameChange}\n        />\n\n        <TextBox\n          label=\"Password\"\n          type=\"password\"\n          disabled={disabled}\n          onValueChanged={this.onPasswordChange}\n        />\n\n        {this.renderError()}\n\n        {this.renderActions()}\n      </div>\n    )\n  }\n\n  private renderActions() {\n    const signInDisabled = Boolean(\n      !this.state.username.length ||\n        !this.state.password.length ||\n        this.props.loading\n    )\n    return (\n      <div className=\"actions\">\n        {this.props.supportsBasicAuth ? (\n          <Button type=\"submit\" disabled={signInDisabled}>\n            {this.props.loading ? <Loading /> : null} Sign in\n          </Button>\n        ) : null}\n\n        {this.props.additionalButtons}\n\n        {this.props.supportsBasicAuth ? (\n          <LinkButton\n            className=\"forgot-password-link\"\n            uri={this.props.forgotPasswordUrl}\n          >\n            Forgot password?\n          </LinkButton>\n        ) : null}\n      </div>\n    )\n  }\n\n  private renderSignInWithBrowser() {\n    const basicAuth = this.props.supportsBasicAuth\n    const browserSignInLink = (\n      <LinkButton\n        className=\"welcome-link-button link-with-icon\"\n        onClick={this.signInWithBrowser}\n      >\n        Sign in using your browser\n        <Octicon symbol={OcticonSymbol.linkExternal} />\n      </LinkButton>\n    )\n\n    const browserSignInButton = (\n      <Button type=\"submit\" onClick={this.signInWithBrowser}>\n        Sign in using your browser\n      </Button>\n    )\n\n    return (\n      <div>\n        {basicAuth ? <hr className=\"short-rule\" /> : null}\n        {basicAuth ? null : (\n          <p>\n            Your GitHub Enterprise instance requires you to sign in with your\n            browser.\n          </p>\n        )}\n\n        <div className=\"sign-in-footer\">\n          {basicAuth ? browserSignInLink : browserSignInButton}\n          {basicAuth ? null : this.renderActions()}\n        </div>\n      </div>\n    )\n  }\n\n  private renderError() {\n    const error = this.props.error\n    if (!error) {\n      return null\n    }\n\n    return <Errors>{error.message}</Errors>\n  }\n\n  private onUsernameChange = (username: string) => {\n    this.setState({ username })\n  }\n\n  private onPasswordChange = (password: string) => {\n    this.setState({ password })\n  }\n\n  private signInWithBrowser = (event?: React.MouseEvent<HTMLButtonElement>) => {\n    if (event) {\n      event.preventDefault()\n    }\n    this.props.onBrowserSignInRequested()\n  }\n\n  private signIn = () => {\n    this.props.onSubmit(this.state.username, this.state.password)\n  }\n}\n","import * as React from 'react'\nimport { WelcomeStep } from './welcome'\nimport { SignIn } from '../lib/sign-in'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { SignInState } from '../../lib/stores'\nimport { Button } from '../lib/button'\n\ninterface ISignInDotComProps {\n  readonly dispatcher: Dispatcher\n  readonly advance: (step: WelcomeStep) => void\n  readonly signInState: SignInState | null\n}\n\n/** The Welcome flow step to login to GitHub.com. */\nexport class SignInDotCom extends React.Component<ISignInDotComProps, {}> {\n  public componentWillMount() {\n    this.props.dispatcher.beginDotComSignIn()\n  }\n\n  public render() {\n    const state = this.props.signInState\n\n    if (!state) {\n      return null\n    }\n\n    return (\n      <div id=\"sign-in-dot-com\">\n        <h1 className=\"welcome-title\">Sign in to GitHub.com</h1>\n\n        <SignIn signInState={state} dispatcher={this.props.dispatcher}>\n          <Button onClick={this.cancel}>Cancel</Button>\n        </SignIn>\n      </div>\n    )\n  }\n\n  private cancel = () => {\n    this.props.advance(WelcomeStep.Start)\n  }\n}\n","import * as React from 'react'\nimport { WelcomeStep } from './welcome'\nimport { LinkButton } from '../lib/link-button'\n\nconst CreateAccountURL = 'https://github.com/join?source=github-desktop'\n\ninterface IStartProps {\n  readonly advance: (step: WelcomeStep) => void\n}\n\n/** The first step of the Welcome flow. */\nexport class Start extends React.Component<IStartProps, {}> {\n  public render() {\n    return (\n      <div id=\"start\">\n        <h1 className=\"welcome-title\">Welcome to GitHub&nbsp;Desktop</h1>\n        <p className=\"welcome-text\">\n          GitHub Desktop is a seamless way to contribute to projects on GitHub\n          and GitHub Enterprise. Sign in below to get started with your existing\n          projects.\n        </p>\n\n        <p className=\"welcome-text\">\n          New to GitHub?{' '}\n          <LinkButton uri={CreateAccountURL}>\n            Create your free account.\n          </LinkButton>\n        </p>\n\n        <hr className=\"short-rule\" />\n\n        <div>\n          <LinkButton className=\"welcome-button\" onClick={this.signInToDotCom}>\n            Sign into GitHub.com\n          </LinkButton>\n        </div>\n\n        <div>\n          <LinkButton\n            className=\"welcome-button\"\n            onClick={this.signInToEnterprise}\n          >\n            Sign into GitHub Enterprise\n          </LinkButton>\n        </div>\n\n        <div className=\"skip-action-container\">\n          <LinkButton className=\"skip-button\" onClick={this.skip}>\n            Skip this step\n          </LinkButton>\n        </div>\n      </div>\n    )\n  }\n\n  private signInToDotCom = () => {\n    this.props.advance(WelcomeStep.SignInToDotCom)\n  }\n\n  private signInToEnterprise = () => {\n    this.props.advance(WelcomeStep.SignInToEnterprise)\n  }\n\n  private skip = () => {\n    this.props.advance(WelcomeStep.ConfigureGit)\n  }\n}\n","import {\n  PullRequestDatabase,\n  IPullRequest,\n  IPullRequestStatus,\n} from '../databases'\nimport { GitHubRepository } from '../../models/github-repository'\nimport { Account } from '../../models/account'\nimport { API, IAPIPullRequest } from '../api'\nimport { fatalError, forceUnwrap } from '../fatal-error'\nimport { RepositoriesStore } from './repositories-store'\nimport {\n  PullRequest,\n  PullRequestRef,\n  PullRequestStatus,\n} from '../../models/pull-request'\nimport { TypedBaseStore } from './base-store'\nimport { Repository } from '../../models/repository'\nimport { getRemotes, removeRemote } from '../git'\nimport { IRemote, ForkedRemotePrefix } from '../../models/remote'\n\nconst Decrement = (n: number) => n - 1\nconst Increment = (n: number) => n + 1\n\n/** The store for GitHub Pull Requests. */\nexport class PullRequestStore extends TypedBaseStore<GitHubRepository> {\n  private readonly pullRequestDatabase: PullRequestDatabase\n  private readonly repositoryStore: RepositoriesStore\n  private readonly activeFetchCountPerRepository = new Map<number, number>()\n\n  public constructor(\n    db: PullRequestDatabase,\n    repositoriesStore: RepositoriesStore\n  ) {\n    super()\n\n    this.pullRequestDatabase = db\n    this.repositoryStore = repositoriesStore\n  }\n\n  /** Loads all pull requests against the given repository. */\n  public async fetchAndCachePullRequests(\n    repository: Repository,\n    account: Account\n  ): Promise<void> {\n    const githubRepo = forceUnwrap(\n      'Can only refresh pull requests for GitHub repositories',\n      repository.gitHubRepository\n    )\n    const apiClient = API.fromAccount(account)\n\n    this.updateActiveFetchCount(githubRepo, Increment)\n\n    try {\n      const apiResult = await apiClient.fetchPullRequests(\n        githubRepo.owner.login,\n        githubRepo.name,\n        'open'\n      )\n\n      await this.cachePullRequests(apiResult, githubRepo)\n\n      const prs = await this.fetchPullRequestsFromCache(githubRepo)\n\n      await this.fetchAndCachePullRequestStatus(prs, githubRepo, account)\n      await this.pruneForkedRemotes(repository, prs)\n\n      this.emitUpdate(githubRepo)\n    } catch (error) {\n      log.warn(`Error refreshing pull requests for '${repository.name}'`, error)\n    } finally {\n      this.updateActiveFetchCount(githubRepo, Decrement)\n    }\n  }\n\n  /** Is the store currently fetching the list of open pull requests? */\n  public isFetchingPullRequests(repository: GitHubRepository): boolean {\n    const repoDbId = forceUnwrap(\n      'Cannot fetch PRs for a repository which is not in the database',\n      repository.dbID\n    )\n    const currentCount = this.activeFetchCountPerRepository.get(repoDbId) || 0\n\n    return currentCount > 0\n  }\n\n  /** Loads the status for the given pull request. */\n  public async fetchPullRequestStatus(\n    repository: GitHubRepository,\n    account: Account,\n    pullRequest: PullRequest\n  ): Promise<void> {\n    await this.fetchAndCachePullRequestStatus(\n      [pullRequest],\n      repository,\n      account\n    )\n  }\n\n  /** Loads the status for all pull request against a given repository. */\n  public async fetchPullRequestStatuses(\n    repository: GitHubRepository,\n    account: Account\n  ): Promise<void> {\n    const prs = await this.fetchPullRequestsFromCache(repository)\n\n    try {\n      await this.fetchAndCachePullRequestStatus(prs, repository, account)\n    } catch (e) {\n      log.warn('Error updating pull request statuses', e)\n    }\n  }\n\n  /** Gets the pull requests against the given repository. */\n  public async fetchPullRequestsFromCache(\n    repository: GitHubRepository\n  ): Promise<ReadonlyArray<PullRequest>> {\n    const gitHubRepositoryID = repository.dbID\n\n    if (gitHubRepositoryID == null) {\n      return fatalError(\n        \"Cannot get pull requests for a repository that hasn't been inserted into the database!\"\n      )\n    }\n\n    const records = await this.pullRequestDatabase.pullRequests\n      .where('base.repoId')\n      .equals(gitHubRepositoryID)\n      .reverse()\n      .sortBy('number')\n\n    const result = new Array<PullRequest>()\n\n    for (const record of records) {\n      const repositoryDbId = record.head.repoId\n      let githubRepository: GitHubRepository | null = null\n\n      if (repositoryDbId != null) {\n        githubRepository = await this.repositoryStore.findGitHubRepositoryByID(\n          repositoryDbId\n        )\n      }\n\n      // We know the base repo ID can't be null since it's the repository we\n      // fetched the PR from in the first place.\n      const parentRepositoryDbId = forceUnwrap(\n        'A pull request cannot have a null base repo id',\n        record.base.repoId\n      )\n      const parentGitGubRepository: GitHubRepository | null = await this.repositoryStore.findGitHubRepositoryByID(\n        parentRepositoryDbId\n      )\n      const parentGitHubRepository = forceUnwrap(\n        'PR cannot have a null base repo',\n        parentGitGubRepository\n      )\n\n      // We can be certain the PR ID is valid since we just got it from the\n      // database.\n      const pullRequestDbId = forceUnwrap(\n        'PR cannot have a null ID after being retrieved from the database',\n        record.id\n      )\n\n      const pullRequestStatus = await this.findPullRequestStatus(\n        record.head.sha,\n        pullRequestDbId\n      )\n\n      result.push(\n        new PullRequest(\n          pullRequestDbId,\n          new Date(record.createdAt),\n          pullRequestStatus,\n          record.title,\n          record.number,\n          new PullRequestRef(\n            record.head.ref,\n            record.head.sha,\n            githubRepository\n          ),\n          new PullRequestRef(\n            record.base.ref,\n            record.base.sha,\n            parentGitHubRepository\n          ),\n          record.author\n        )\n      )\n    }\n\n    return result\n  }\n\n  private async pruneForkedRemotes(\n    repository: Repository,\n    pullRequests: ReadonlyArray<PullRequest>\n  ) {\n    const remotes = await getRemotes(repository)\n    const forkedRemotesToDelete = this.getRemotesToDelete(remotes, pullRequests)\n\n    await this.deleteRemotes(repository, forkedRemotesToDelete)\n  }\n\n  private getRemotesToDelete(\n    remotes: ReadonlyArray<IRemote>,\n    openPullRequests: ReadonlyArray<PullRequest>\n  ): ReadonlyArray<IRemote> {\n    const forkedRemotes = remotes.filter(remote =>\n      remote.name.startsWith(ForkedRemotePrefix)\n    )\n    const remotesOfPullRequests = new Set<string>()\n\n    openPullRequests.forEach(pr => {\n      const { gitHubRepository } = pr.head\n\n      if (gitHubRepository != null && gitHubRepository.cloneURL != null) {\n        remotesOfPullRequests.add(gitHubRepository.cloneURL)\n      }\n    })\n\n    const result = forkedRemotes.filter(\n      forkedRemote => !remotesOfPullRequests.has(forkedRemote.url)\n    )\n\n    return result\n  }\n\n  private async deleteRemotes(\n    repository: Repository,\n    remotes: ReadonlyArray<IRemote>\n  ) {\n    const promises: Array<Promise<void>> = []\n\n    remotes.forEach(r => promises.push(removeRemote(repository, r.name)))\n    await Promise.all(promises)\n  }\n\n  private updateActiveFetchCount(\n    repository: GitHubRepository,\n    update: (count: number) => number\n  ) {\n    const repoDbId = forceUnwrap(\n      'Cannot fetch PRs for a repository which is not in the database',\n      repository.dbID\n    )\n    const currentCount = this.activeFetchCountPerRepository.get(repoDbId) || 0\n    const newCount = update(currentCount)\n\n    this.activeFetchCountPerRepository.set(repoDbId, newCount)\n    this.emitUpdate(repository)\n  }\n\n  private async fetchAndCachePullRequestStatus(\n    pullRequests: ReadonlyArray<PullRequest>,\n    repository: GitHubRepository,\n    account: Account\n  ): Promise<void> {\n    const apiClient = API.fromAccount(account)\n    const statuses: Array<IPullRequestStatus> = []\n\n    for (const pr of pullRequests) {\n      const combinedRefStatus = await apiClient.fetchCombinedRefStatus(\n        repository.owner.login,\n        repository.name,\n        pr.head.sha\n      )\n\n      statuses.push({\n        pullRequestId: pr.id,\n        state: combinedRefStatus.state,\n        totalCount: combinedRefStatus.total_count,\n        sha: pr.head.sha,\n        statuses: combinedRefStatus.statuses,\n      })\n    }\n\n    await this.cachePullRequestStatuses(statuses)\n    this.emitUpdate(repository)\n  }\n\n  private async findPullRequestStatus(\n    sha: string,\n    pullRequestId: number\n  ): Promise<PullRequestStatus | null> {\n    const result = await this.pullRequestDatabase.pullRequestStatus\n      .where('[sha+pullRequestId]')\n      .equals([sha, pullRequestId])\n      .limit(1)\n      .first()\n\n    if (!result) {\n      return null\n    }\n\n    const combinedRefStatuses = (result.statuses || []).map(x => {\n      return {\n        id: x.id,\n        state: x.state,\n        description: x.description,\n      }\n    })\n\n    return new PullRequestStatus(\n      result.pullRequestId,\n      result.state,\n      result.totalCount,\n      result.sha,\n      combinedRefStatuses\n    )\n  }\n\n  private async cachePullRequests(\n    pullRequestsFromAPI: ReadonlyArray<IAPIPullRequest>,\n    repository: GitHubRepository\n  ): Promise<void> {\n    const repoDbId = repository.dbID\n\n    if (repoDbId == null) {\n      return fatalError(\n        \"Cannot store pull requests for a repository that hasn't been inserted into the database!\"\n      )\n    }\n\n    const table = this.pullRequestDatabase.pullRequests\n    const prsToInsert = new Array<IPullRequest>()\n\n    for (const pr of pullRequestsFromAPI) {\n      // `pr.head.repo` represents the source of the pull request. It might be\n      // a branch associated with the current repository, or a fork of the\n      // current repository.\n      //\n      // In cases where the user has removed the fork of the repository after\n      // opening a pull request, this can be `null`, and the app will not store\n      // this pull request.\n\n      if (pr.head.repo == null) {\n        log.debug(\n          `Unable to store pull request #${pr.number} for repository ${\n            repository.fullName\n          } as it has no head repository associated with it`\n        )\n        continue\n      }\n\n      const githubRepo = await this.repositoryStore.upsertGitHubRepository(\n        repository.endpoint,\n        pr.head.repo\n      )\n\n      const githubRepoDbId = forceUnwrap(\n        'PR cannot have non-existent repo',\n        githubRepo.dbID\n      )\n\n      // We know the base repo isn't null since that's where we got the PR from\n      // in the first place.\n      const parentRepo = forceUnwrap(\n        'PR cannot have a null base repo',\n        pr.base.repo\n      )\n      const parentGitHubRepo = await this.repositoryStore.upsertGitHubRepository(\n        repository.endpoint,\n        parentRepo\n      )\n      const parentGitHubRepoDbId = forceUnwrap(\n        'PR cannot have a null parent database id',\n        parentGitHubRepo.dbID\n      )\n\n      prsToInsert.push({\n        number: pr.number,\n        title: pr.title,\n        createdAt: pr.created_at,\n        head: {\n          ref: pr.head.ref,\n          sha: pr.head.sha,\n          repoId: githubRepoDbId,\n        },\n        base: {\n          ref: pr.base.ref,\n          sha: pr.base.sha,\n          repoId: parentGitHubRepoDbId,\n        },\n        author: pr.user.login,\n      })\n    }\n\n    return this.pullRequestDatabase.transaction('rw', table, async () => {\n      // we need to delete the stales PRs from the db\n      // so we remove all for a repo to avoid having to\n      // do diffing\n      await table\n        .where('base.repoId')\n        .equals(repoDbId)\n        .delete()\n\n      if (prsToInsert.length > 0) {\n        await table.bulkAdd(prsToInsert)\n      }\n    })\n  }\n\n  private async cachePullRequestStatuses(\n    statuses: Array<IPullRequestStatus>\n  ): Promise<void> {\n    const table = this.pullRequestDatabase.pullRequestStatus\n\n    await this.pullRequestDatabase.transaction('rw', table, async () => {\n      for (const status of statuses) {\n        const record = await table\n          .where('[sha+pullRequestId]')\n          .equals([status.sha, status.pullRequestId])\n          .first()\n\n        if (record == null) {\n          await table.add(status)\n        } else {\n          await table.put({ id: record.id, ...status })\n        }\n      }\n    })\n  }\n}\n","/**\n * The oldest officially supported version of GitHub Enterprise.\n * This information is used in user-facing text and shouldn't be\n * considered a hard limit, i.e. older versions of GitHub Enterprise\n * might (and probably do) work just fine but this should be a fairly\n * recent version that we can safely say that we'll work well with.\n *\n * I picked the current minimum (2.8) because it was the version\n * running on our internal GitHub Enterprise instance at the time\n * we implemented Enterprise sign in (desktop/desktop#664)\n */\nexport const minimumSupportedEnterpriseVersion = '2.8.0'\n","import * as URL from 'url'\n\n/** The protocols over which we can connect to Enterprise instances. */\nconst AllowedProtocols = new Set(['https:', 'http:'])\n\n/** The name for errors thrown because of an invalid URL. */\nexport const InvalidURLErrorName = 'invalid-url'\n\n/** The name for errors thrown because of an invalid protocol. */\nexport const InvalidProtocolErrorName = 'invalid-protocol'\n\n/**\n * Validate the URL for a GitHub Enterprise instance.\n *\n * Returns the validated URL, or throws if the URL cannot be validated.\n */\nexport function validateURL(address: string): string {\n  // ensure user has specified text and not just whitespace\n  // we will interact with this server so we can be fairly\n  // relaxed here about what we accept for the server name\n  const trimmed = address.trim()\n  if (trimmed.length === 0) {\n    const error = new Error('Unknown address')\n    error.name = InvalidURLErrorName\n    throw error\n  }\n\n  let url = URL.parse(trimmed)\n  if (!url.host) {\n    // E.g., if they user entered 'ghe.io', let's assume they're using https.\n    address = `https://${trimmed}`\n    url = URL.parse(address)\n  }\n\n  if (!url.protocol) {\n    const error = new Error('Invalid URL')\n    error.name = InvalidURLErrorName\n    throw error\n  }\n\n  if (!AllowedProtocols.has(url.protocol)) {\n    const error = new Error('Invalid protocol')\n    error.name = InvalidProtocolErrorName\n    throw error\n  }\n\n  return address\n}\n","import { Disposable } from 'event-kit'\nimport { Account } from '../../models/account'\nimport { assertNever, fatalError } from '../fatal-error'\nimport { askUserToOAuth } from '../../lib/oauth'\nimport {\n  validateURL,\n  InvalidURLErrorName,\n  InvalidProtocolErrorName,\n} from '../../ui/lib/enterprise-validate-url'\n\nimport {\n  createAuthorization,\n  AuthorizationResponse,\n  fetchUser,\n  AuthorizationResponseKind,\n  getHTMLURL,\n  getDotComAPIEndpoint,\n  getEnterpriseAPIURL,\n  fetchMetadata,\n} from '../../lib/api'\n\nimport { AuthenticationMode } from '../../lib/2fa'\n\nimport { minimumSupportedEnterpriseVersion } from '../../lib/enterprise'\nimport { TypedBaseStore } from './base-store'\n\nfunction getUnverifiedUserErrorMessage(login: string): string {\n  return `Unable to authenticate. The account ${login} is lacking a verified email address. Please sign in to GitHub.com, confirm your email address in the Emails section under Personal settings, and try again.`\n}\n\nconst EnterpriseTooOldMessage = `The GitHub Enterprise version does not support GitHub Desktop. Talk to your server's administrator about upgrading to the latest version of GitHub Enterprise.`\n\n/**\n * An enumeration of the possible steps that the sign in\n * store can be in save for the unitialized state (null).\n */\nexport enum SignInStep {\n  EndpointEntry = 'EndpointEntry',\n  Authentication = 'Authentication',\n  TwoFactorAuthentication = 'TwoFactorAuthentication',\n  Success = 'Success',\n}\n\n/**\n * The union type of all possible states that the sign in\n * store can be in save the unitialized state (null).\n */\nexport type SignInState =\n  | IEndpointEntryState\n  | IAuthenticationState\n  | ITwoFactorAuthenticationState\n  | ISuccessState\n\n/**\n * Base interface for shared properties between states\n */\nexport interface ISignInState {\n  /**\n   * The sign in step represented by this state\n   */\n  readonly kind: SignInStep\n\n  /**\n   * An error which, if present, should be presented to the\n   * user in close proximity to the actions or input fields\n   * related to the current step.\n   */\n  readonly error: Error | null\n\n  /**\n   * A value indicating whether or not the sign in store is\n   * busy processing a request. While this value is true all\n   * form inputs and actions save for a cancel action should\n   * be disabled and the user should be made aware that the\n   * sign in process is ongoing.\n   */\n  readonly loading: boolean\n}\n\n/**\n * State interface representing the endpoint entry step.\n * This is the initial step in the Enterprise sign in flow\n * and is not present when signing in to GitHub.com\n */\nexport interface IEndpointEntryState extends ISignInState {\n  readonly kind: SignInStep.EndpointEntry\n}\n\n/**\n * State interface representing the Authentication step where\n * the user provides credentials and/or initiates a browser\n * OAuth sign in process. This step occurs as the first step\n * when signing in to GitHub.com and as the second step when\n * signing in to a GitHub Enterprise instance.\n */\nexport interface IAuthenticationState extends ISignInState {\n  readonly kind: SignInStep.Authentication\n\n  /**\n   * The URL to the host which we're currently authenticating\n   * against. This will be either https://api.github.com when\n   * signing in against GitHub.com or a user-specified\n   * URL when signing in against a GitHub Enterprise instance.\n   */\n  readonly endpoint: string\n\n  /**\n   * A value indicating whether or not the endpoint supports\n   * basic authentication (i.e. username and password). All\n   * GitHub Enterprise instances support OAuth (or web flow\n   * sign-in).\n   */\n  readonly supportsBasicAuth: boolean\n\n  /**\n   * The endpoint-specific URL for resetting credentials.\n   */\n  readonly forgotPasswordUrl: string\n}\n\n/**\n * State interface representing the TwoFactorAuthentication\n * step where the user provides an OTP token. This step\n * occurs after the authentication step both for GitHub.com,\n * and GitHub Enterprise when the user has enabled two factor\n * authentication on the host.\n */\nexport interface ITwoFactorAuthenticationState extends ISignInState {\n  readonly kind: SignInStep.TwoFactorAuthentication\n\n  /**\n   * The URL to the host which we're currently authenticating\n   * against. This will be either https://api.github.com when\n   * signing in against GitHub.com or a user-specified\n   * URL when signing in against a GitHub Enterprise instance.\n   */\n  readonly endpoint: string\n\n  /**\n   * The username specified by the user in the preceeding\n   * Authentication step\n   */\n  readonly username: string\n\n  /**\n   * The password specified by the user in the preceeding\n   * Authentication step\n   */\n  readonly password: string\n\n  /**\n   * The 2FA type expected by the GitHub endpoint.\n   */\n  readonly type: AuthenticationMode\n}\n\n/**\n * Sentinel step representing a successful sign in process. Sign in\n * components may use this as a signal to dismiss the ongoing flow\n * or to show a message to the user indicating that they've been\n * successfully signed in.\n */\nexport interface ISuccessState {\n  readonly kind: SignInStep.Success\n}\n\n/**\n * The method used to authenticate a user.\n */\nexport enum SignInMethod {\n  /**\n   * In-app sign-in with username, password, and possibly a\n   * two-factor code.\n   */\n  Basic = 'basic',\n  /**\n   * Sign-in through a web browser with a redirect back to\n   * the application.\n   */\n  Web = 'web',\n}\n\ninterface IAuthenticationEvent {\n  readonly account: Account\n  readonly method: SignInMethod\n}\n\n/**\n * A store encapsulating all logic related to signing in a user\n * to GitHub.com, or a GitHub Enterprise instance.\n */\nexport class SignInStore extends TypedBaseStore<SignInState | null> {\n  private state: SignInState | null = null\n\n  private emitAuthenticate(account: Account, method: SignInMethod) {\n    const event: IAuthenticationEvent = { account, method }\n    this.emitter.emit('did-authenticate', event)\n  }\n\n  /**\n   * Registers an event handler which will be invoked whenever\n   * a user has successfully completed a sign-in process.\n   */\n  public onDidAuthenticate(\n    fn: (account: Account, method: SignInMethod) => void\n  ): Disposable {\n    return this.emitter.on(\n      'did-authenticate',\n      ({ account, method }: IAuthenticationEvent) => {\n        fn(account, method)\n      }\n    )\n  }\n\n  /**\n   * Returns the current state of the sign in store or null if\n   * no sign in process is in flight.\n   */\n  public getState(): SignInState | null {\n    return this.state\n  }\n\n  /**\n   * Update the internal state of the store and emit an update\n   * event.\n   */\n  private setState(state: SignInState | null) {\n    this.state = state\n    this.emitUpdate(this.getState())\n  }\n\n  private async endpointSupportsBasicAuth(endpoint: string): Promise<boolean> {\n    const response = await fetchMetadata(endpoint)\n\n    if (response) {\n      if (response.verifiable_password_authentication === false) {\n        return false\n      } else {\n        return true\n      }\n    } else {\n      throw new Error(\n        `Unable to authenticate with the GitHub Enterprise instance. Verify that the URL is correct, that your GitHub Enterprise instance is running version ${minimumSupportedEnterpriseVersion} or later, that you have an internet connection and try again.`\n      )\n    }\n  }\n\n  private getForgotPasswordURL(endpoint: string): string {\n    return `${getHTMLURL(endpoint)}/password_reset`\n  }\n\n  /**\n   * Clear any in-flight sign in state and return to the\n   * initial (no sign-in) state.\n   */\n  public reset() {\n    this.setState(null)\n  }\n\n  /**\n   * Initiate a sign in flow for github.com. This will put the store\n   * in the Authentication step ready to receive user credentials.\n   */\n  public beginDotComSignIn() {\n    const endpoint = getDotComAPIEndpoint()\n\n    this.setState({\n      kind: SignInStep.Authentication,\n      endpoint,\n      supportsBasicAuth: true,\n      error: null,\n      loading: false,\n      forgotPasswordUrl: this.getForgotPasswordURL(endpoint),\n    })\n  }\n\n  /**\n   * Attempt to advance from the authentication step using a username\n   * and password. This method must only be called when the store is\n   * in the authentication step or an error will be thrown. If the\n   * provided credentials are valid the store will either advance to\n   * the Success step or to the TwoFactorAuthentication step if the\n   * user has enabled two factor authentication.\n   *\n   * If an error occurs during sign in (such as invalid credentials)\n   * the authentication state will be updated with that error so that\n   * the responsible component can present it to the user.\n   */\n  public async authenticateWithBasicAuth(\n    username: string,\n    password: string\n  ): Promise<void> {\n    const currentState = this.state\n\n    if (!currentState || currentState.kind !== SignInStep.Authentication) {\n      const stepText = currentState ? currentState.kind : 'null'\n      return fatalError(\n        `Sign in step '${stepText}' not compatible with authentication`\n      )\n    }\n\n    const endpoint = currentState.endpoint\n\n    this.setState({ ...currentState, loading: true })\n\n    let response: AuthorizationResponse\n    try {\n      response = await createAuthorization(endpoint, username, password, null)\n    } catch (e) {\n      this.emitError(e)\n      return\n    }\n\n    if (!this.state || this.state.kind !== SignInStep.Authentication) {\n      // Looks like the sign in flow has been aborted\n      return\n    }\n\n    if (response.kind === AuthorizationResponseKind.Authorized) {\n      const token = response.token\n      const user = await fetchUser(endpoint, token)\n\n      if (!this.state || this.state.kind !== SignInStep.Authentication) {\n        // Looks like the sign in flow has been aborted\n        return\n      }\n\n      this.emitAuthenticate(user, SignInMethod.Basic)\n      this.setState({ kind: SignInStep.Success })\n    } else if (\n      response.kind ===\n      AuthorizationResponseKind.TwoFactorAuthenticationRequired\n    ) {\n      this.setState({\n        kind: SignInStep.TwoFactorAuthentication,\n        endpoint,\n        username,\n        password,\n        type: response.type,\n        error: null,\n        loading: false,\n      })\n    } else {\n      if (response.kind === AuthorizationResponseKind.Error) {\n        this.emitError(\n          new Error(\n            `The server responded with an error while attempting to authenticate (${\n              response.response.status\n            })\\n\\n${response.response.statusText}`\n          )\n        )\n        this.setState({ ...currentState, loading: false })\n      } else if (response.kind === AuthorizationResponseKind.Failed) {\n        if (username.includes('@')) {\n          this.setState({\n            ...currentState,\n            loading: false,\n            error: new Error('Incorrect email or password.'),\n          })\n        } else {\n          this.setState({\n            ...currentState,\n            loading: false,\n            error: new Error('Incorrect username or password.'),\n          })\n        }\n      } else if (\n        response.kind === AuthorizationResponseKind.UserRequiresVerification\n      ) {\n        this.setState({\n          ...currentState,\n          loading: false,\n          error: new Error(getUnverifiedUserErrorMessage(username)),\n        })\n      } else if (\n        response.kind === AuthorizationResponseKind.PersonalAccessTokenBlocked\n      ) {\n        this.setState({\n          ...currentState,\n          loading: false,\n          error: new Error(\n            'A personal access token cannot be used to login to GitHub Desktop.'\n          ),\n        })\n      } else if (response.kind === AuthorizationResponseKind.EnterpriseTooOld) {\n        this.setState({\n          ...currentState,\n          loading: false,\n          error: new Error(EnterpriseTooOldMessage),\n        })\n      } else {\n        return assertNever(response, `Unsupported response: ${response}`)\n      }\n    }\n  }\n\n  /**\n   * Initiate an OAuth sign in using the system configured browser.\n   * This method must only be called when the store is in the authentication\n   * step or an error will be thrown.\n   *\n   * The promise returned will only resolve once the user has successfully\n   * authenticated. If the user terminates the sign-in process by closing\n   * their browser before the protocol handler is invoked, by denying the\n   * protocol handler to execute or by providing the wrong credentials\n   * this promise will never complete.\n   */\n  public async authenticateWithBrowser(): Promise<void> {\n    const currentState = this.state\n\n    if (!currentState || currentState.kind !== SignInStep.Authentication) {\n      const stepText = currentState ? currentState.kind : 'null'\n      return fatalError(\n        `Sign in step '${stepText}' not compatible with browser authentication`\n      )\n    }\n\n    this.setState({ ...currentState, loading: true })\n\n    let account: Account\n    try {\n      log.info('[SignInStore] initializing OAuth flow')\n      account = await askUserToOAuth(currentState.endpoint)\n      log.info('[SignInStore] account resolved')\n    } catch (e) {\n      log.info('[SignInStore] error with OAuth flow', e)\n      this.setState({ ...currentState, error: e, loading: false })\n      return\n    }\n\n    if (!this.state || this.state.kind !== SignInStep.Authentication) {\n      // Looks like the sign in flow has been aborted\n      return\n    }\n\n    this.emitAuthenticate(account, SignInMethod.Web)\n    this.setState({ kind: SignInStep.Success })\n  }\n\n  /**\n   * Initiate a sign in flow for a GitHub Enterprise instance. This will\n   * put the store in the EndpointEntry step ready to receive the url\n   * to the enterprise instance.\n   */\n  public beginEnterpriseSignIn() {\n    this.setState({\n      kind: SignInStep.EndpointEntry,\n      error: null,\n      loading: false,\n    })\n  }\n\n  /**\n   * Attempt to advance from the EndpointEntry step with the given endpoint\n   * url. This method must only be called when the store is in the authentication\n   * step or an error will be thrown.\n   *\n   * The provided endpoint url will be validated for syntactic correctness as\n   * well as connectivity before the promise resolves. If the endpoint url is\n   * invalid or the host can't be reached the promise will be rejected and the\n   * sign in state updated with an error to be presented to the user.\n   *\n   * If validation is successful the store will advance to the authentication\n   * step.\n   */\n  public async setEndpoint(url: string): Promise<void> {\n    const currentState = this.state\n\n    if (!currentState || currentState.kind !== SignInStep.EndpointEntry) {\n      const stepText = currentState ? currentState.kind : 'null'\n      return fatalError(\n        `Sign in step '${stepText}' not compatible with endpoint entry`\n      )\n    }\n\n    this.setState({ ...currentState, loading: true })\n\n    let validUrl: string\n    try {\n      validUrl = validateURL(url)\n    } catch (e) {\n      let error = e\n      if (e.name === InvalidURLErrorName) {\n        error = new Error(\n          `The GitHub Enterprise instance address doesn't appear to be a valid URL. We're expecting something like https://github.example.com.`\n        )\n      } else if (e.name === InvalidProtocolErrorName) {\n        error = new Error(\n          'Unsupported protocol. Only http or https is supported when authenticating with GitHub Enterprise instances.'\n        )\n      }\n\n      this.setState({ ...currentState, loading: false, error })\n      return\n    }\n\n    const endpoint = getEnterpriseAPIURL(validUrl)\n    try {\n      const supportsBasicAuth = await this.endpointSupportsBasicAuth(endpoint)\n\n      if (!this.state || this.state.kind !== SignInStep.EndpointEntry) {\n        // Looks like the sign in flow has been aborted\n        return\n      }\n\n      this.setState({\n        kind: SignInStep.Authentication,\n        endpoint,\n        supportsBasicAuth,\n        error: null,\n        loading: false,\n        forgotPasswordUrl: this.getForgotPasswordURL(endpoint),\n      })\n    } catch (e) {\n      let error = e\n      // We'll get an ENOTFOUND if the address couldn't be resolved.\n      if (e.code === 'ENOTFOUND') {\n        error = new Error(\n          'The server could not be found. Please verify that the URL is correct and that you have a stable internet connection.'\n        )\n      }\n\n      this.setState({ ...currentState, loading: false, error })\n    }\n  }\n\n  /**\n   * Attempt to complete the sign in flow with the given OTP token.\\\n   * This method must only be called when the store is in the\n   * TwoFactorAuthentication step or an error will be thrown.\n   *\n   * If the provided token is valid the store will advance to\n   * the Success step.\n   *\n   * If an error occurs during sign in (such as invalid credentials)\n   * the authentication state will be updated with that error so that\n   * the responsible component can present it to the user.\n   */\n  public async setTwoFactorOTP(otp: string) {\n    const currentState = this.state\n\n    if (\n      !currentState ||\n      currentState.kind !== SignInStep.TwoFactorAuthentication\n    ) {\n      const stepText = currentState ? currentState.kind : 'null'\n      fatalError(\n        `Sign in step '${stepText}' not compatible with two factor authentication`\n      )\n      return\n    }\n\n    this.setState({ ...currentState, loading: true })\n\n    let response: AuthorizationResponse\n\n    try {\n      response = await createAuthorization(\n        currentState.endpoint,\n        currentState.username,\n        currentState.password,\n        otp\n      )\n    } catch (e) {\n      this.emitError(e)\n      return\n    }\n\n    if (!this.state || this.state.kind !== SignInStep.TwoFactorAuthentication) {\n      // Looks like the sign in flow has been aborted\n      return\n    }\n\n    if (response.kind === AuthorizationResponseKind.Authorized) {\n      const token = response.token\n      const user = await fetchUser(currentState.endpoint, token)\n\n      if (\n        !this.state ||\n        this.state.kind !== SignInStep.TwoFactorAuthentication\n      ) {\n        // Looks like the sign in flow has been aborted\n        return\n      }\n\n      this.emitAuthenticate(user, SignInMethod.Basic)\n      this.setState({ kind: SignInStep.Success })\n    } else {\n      switch (response.kind) {\n        case AuthorizationResponseKind.Failed:\n        case AuthorizationResponseKind.TwoFactorAuthenticationRequired:\n          this.setState({\n            ...currentState,\n            loading: false,\n            error: new Error('Two-factor authentication failed.'),\n          })\n          break\n        case AuthorizationResponseKind.Error:\n          this.emitError(\n            new Error(\n              `The server responded with an error (${\n                response.response.status\n              })\\n\\n${response.response.statusText}`\n            )\n          )\n          break\n        case AuthorizationResponseKind.UserRequiresVerification:\n          this.emitError(\n            new Error(getUnverifiedUserErrorMessage(currentState.username))\n          )\n          break\n        case AuthorizationResponseKind.PersonalAccessTokenBlocked:\n          this.emitError(\n            new Error(\n              'A personal access token cannot be used to login to GitHub Desktop.'\n            )\n          )\n          break\n        case AuthorizationResponseKind.EnterpriseTooOld:\n          this.emitError(new Error(EnterpriseTooOldMessage))\n          break\n        default:\n          assertNever(response, `Unknown response: ${response}`)\n      }\n    }\n  }\n}\n","import {\n  RepositoriesDatabase,\n  IDatabaseGitHubRepository,\n  IDatabaseOwner,\n} from '../databases/repositories-database'\nimport { Owner } from '../../models/owner'\nimport { GitHubRepository } from '../../models/github-repository'\nimport { Repository } from '../../models/repository'\nimport { fatalError } from '../fatal-error'\nimport { IAPIRepository } from '../api'\nimport { BaseStore } from './base-store'\n\n/** The store for local repositories. */\nexport class RepositoriesStore extends BaseStore {\n  private db: RepositoriesDatabase\n\n  public constructor(db: RepositoriesDatabase) {\n    super()\n\n    this.db = db\n  }\n\n  /** Find the matching GitHub repository or add it if it doesn't exist. */\n  public async upsertGitHubRepository(\n    endpoint: string,\n    apiRepository: IAPIRepository\n  ): Promise<GitHubRepository> {\n    return this.db.transaction(\n      'rw',\n      this.db.repositories,\n      this.db.gitHubRepositories,\n      this.db.owners,\n      async () => {\n        const gitHubRepository = await this.db.gitHubRepositories\n          .where('cloneURL')\n          .equals(apiRepository.clone_url)\n          .limit(1)\n          .first()\n\n        if (gitHubRepository == null) {\n          return this.putGitHubRepository(endpoint, apiRepository)\n        } else {\n          return this.buildGitHubRepository(gitHubRepository)\n        }\n      }\n    )\n  }\n\n  private async buildGitHubRepository(\n    dbRepo: IDatabaseGitHubRepository\n  ): Promise<GitHubRepository> {\n    const owner = await this.db.owners.get(dbRepo.ownerID)\n\n    if (owner == null) {\n      throw new Error(`Couldn't find the owner for ${dbRepo.name}`)\n    }\n\n    let parent: GitHubRepository | null = null\n    if (dbRepo.parentID) {\n      parent = await this.findGitHubRepositoryByID(dbRepo.parentID)\n    }\n\n    return new GitHubRepository(\n      dbRepo.name,\n      new Owner(owner.login, owner.endpoint, owner.id!),\n      dbRepo.id!,\n      dbRepo.private,\n      dbRepo.htmlURL,\n      dbRepo.defaultBranch,\n      dbRepo.cloneURL,\n      parent\n    )\n  }\n\n  /** Find a GitHub repository by its DB ID. */\n  public async findGitHubRepositoryByID(\n    id: number\n  ): Promise<GitHubRepository | null> {\n    const gitHubRepository = await this.db.gitHubRepositories.get(id)\n    if (!gitHubRepository) {\n      return null\n    }\n\n    return this.buildGitHubRepository(gitHubRepository)\n  }\n\n  /** Get all the local repositories. */\n  public getAll(): Promise<ReadonlyArray<Repository>> {\n    return this.db.transaction(\n      'r',\n      this.db.repositories,\n      this.db.gitHubRepositories,\n      this.db.owners,\n      async () => {\n        const inflatedRepos = new Array<Repository>()\n        const repos = await this.db.repositories.toArray()\n        for (const repo of repos) {\n          let inflatedRepo: Repository | null = null\n          let gitHubRepository: GitHubRepository | null = null\n          if (repo.gitHubRepositoryID) {\n            gitHubRepository = await this.findGitHubRepositoryByID(\n              repo.gitHubRepositoryID\n            )\n          }\n\n          inflatedRepo = new Repository(\n            repo.path,\n            repo.id!,\n            gitHubRepository,\n            repo.missing\n          )\n          inflatedRepos.push(inflatedRepo)\n        }\n\n        return inflatedRepos\n      }\n    )\n  }\n\n  /**\n   * Add a new local repository.\n   *\n   * If a repository already exists with that path, it will be returned instead.\n   */\n  public async addRepository(path: string): Promise<Repository> {\n    const repository = await this.db.transaction(\n      'rw',\n      this.db.repositories,\n      this.db.gitHubRepositories,\n      this.db.owners,\n      async () => {\n        const repos = await this.db.repositories.toArray()\n        const record = repos.find(r => r.path === path)\n        let recordId: number\n        let gitHubRepo: GitHubRepository | null = null\n\n        if (record != null) {\n          recordId = record.id!\n\n          if (record.gitHubRepositoryID != null) {\n            gitHubRepo = await this.findGitHubRepositoryByID(\n              record.gitHubRepositoryID\n            )\n          }\n        } else {\n          recordId = await this.db.repositories.add({\n            path,\n            gitHubRepositoryID: null,\n            missing: false,\n          })\n        }\n\n        return new Repository(path, recordId, gitHubRepo, false)\n      }\n    )\n\n    this.emitUpdate()\n\n    return repository\n  }\n\n  /** Remove the repository with the given ID. */\n  public async removeRepository(repoID: number): Promise<void> {\n    await this.db.repositories.delete(repoID)\n\n    this.emitUpdate()\n  }\n\n  /** Update the repository's `missing` flag. */\n  public async updateRepositoryMissing(\n    repository: Repository,\n    missing: boolean\n  ): Promise<Repository> {\n    const repoID = repository.id\n    if (!repoID) {\n      return fatalError(\n        '`updateRepositoryMissing` can only update `missing` for a repository which has been added to the database.'\n      )\n    }\n\n    const gitHubRepositoryID = repository.gitHubRepository\n      ? repository.gitHubRepository.dbID\n      : null\n    await this.db.repositories.put({\n      id: repository.id,\n      path: repository.path,\n      missing,\n      gitHubRepositoryID,\n    })\n\n    this.emitUpdate()\n\n    return new Repository(\n      repository.path,\n      repository.id,\n      repository.gitHubRepository,\n      missing\n    )\n  }\n\n  /** Update the repository's path. */\n  public async updateRepositoryPath(\n    repository: Repository,\n    path: string\n  ): Promise<Repository> {\n    const repoID = repository.id\n    if (!repoID) {\n      return fatalError(\n        '`updateRepositoryPath` can only update the path for a repository which has been added to the database.'\n      )\n    }\n\n    const gitHubRepositoryID = repository.gitHubRepository\n      ? repository.gitHubRepository.dbID\n      : null\n    await this.db.repositories.put({\n      id: repository.id,\n      missing: false,\n      path: path,\n      gitHubRepositoryID,\n    })\n\n    this.emitUpdate()\n\n    return new Repository(\n      path,\n      repository.id,\n      repository.gitHubRepository,\n      false\n    )\n  }\n\n  private async putOwner(endpoint: string, login: string): Promise<Owner> {\n    login = login.toLowerCase()\n\n    const existingOwner = await this.db.owners\n      .where('[endpoint+login]')\n      .equals([endpoint, login])\n      .first()\n    if (existingOwner) {\n      return new Owner(login, endpoint, existingOwner.id!)\n    }\n\n    const dbOwner: IDatabaseOwner = {\n      login,\n      endpoint,\n    }\n    const id = await this.db.owners.add(dbOwner)\n    return new Owner(login, endpoint, id)\n  }\n\n  private async putGitHubRepository(\n    endpoint: string,\n    gitHubRepository: IAPIRepository\n  ): Promise<GitHubRepository> {\n    let parent: GitHubRepository | null = null\n    if (gitHubRepository.parent) {\n      parent = await this.putGitHubRepository(endpoint, gitHubRepository.parent)\n    }\n\n    const login = gitHubRepository.owner.login.toLowerCase()\n    const owner = await this.putOwner(endpoint, login)\n\n    const existingRepo = await this.db.gitHubRepositories\n      .where('[ownerID+name]')\n      .equals([owner.id!, gitHubRepository.name])\n      .first()\n\n    let updatedGitHubRepo: IDatabaseGitHubRepository = {\n      ownerID: owner.id!,\n      name: gitHubRepository.name,\n      private: gitHubRepository.private,\n      htmlURL: gitHubRepository.html_url,\n      defaultBranch: gitHubRepository.default_branch,\n      cloneURL: gitHubRepository.clone_url,\n      parentID: parent ? parent.dbID : null,\n    }\n    if (existingRepo) {\n      updatedGitHubRepo = { ...updatedGitHubRepo, id: existingRepo.id }\n    }\n\n    const id = await this.db.gitHubRepositories.put(updatedGitHubRepo)\n    return new GitHubRepository(\n      updatedGitHubRepo.name,\n      owner,\n      id,\n      updatedGitHubRepo.private,\n      updatedGitHubRepo.htmlURL,\n      updatedGitHubRepo.defaultBranch,\n      updatedGitHubRepo.cloneURL,\n      parent\n    )\n  }\n\n  /** Add or update the repository's GitHub repository. */\n  public async updateGitHubRepository(\n    repository: Repository,\n    endpoint: string,\n    gitHubRepository: IAPIRepository\n  ): Promise<Repository> {\n    const repoID = repository.id\n    if (!repoID) {\n      return fatalError(\n        '`updateGitHubRepository` can only update a GitHub repository for a repository which has been added to the database.'\n      )\n    }\n\n    const updatedGitHubRepo = await this.db.transaction(\n      'rw',\n      this.db.repositories,\n      this.db.gitHubRepositories,\n      this.db.owners,\n      async () => {\n        const localRepo = (await this.db.repositories.get(repoID))!\n        const updatedGitHubRepo = await this.putGitHubRepository(\n          endpoint,\n          gitHubRepository\n        )\n\n        await this.db.repositories.update(localRepo.id!, {\n          gitHubRepositoryID: updatedGitHubRepo.dbID,\n        })\n\n        return updatedGitHubRepo\n      }\n    )\n\n    this.emitUpdate()\n\n    return new Repository(\n      repository.path,\n      repository.id,\n      updatedGitHubRepo,\n      repository.missing\n    )\n  }\n}\n","import { IssuesDatabase, IIssue } from '../databases/issues-database'\nimport { API, IAPIIssue } from '../api'\nimport { Account } from '../../models/account'\nimport { GitHubRepository } from '../../models/github-repository'\nimport { fatalError } from '../fatal-error'\n\n/** The hard limit on the number of issue results we'd ever return. */\nconst IssueResultsHardLimit = 100\n\n/** The store for GitHub issues. */\nexport class IssuesStore {\n  private db: IssuesDatabase\n\n  /** Initialize the store with the given database. */\n  public constructor(db: IssuesDatabase) {\n    this.db = db\n  }\n\n  /**\n   * Get the highest value of the 'updated_at' field for issues in a given\n   * repository. This value is used to request delta updates from the API\n   * using the 'since' parameter.\n   */\n  private async getLatestUpdatedAt(\n    repository: GitHubRepository\n  ): Promise<Date | null> {\n    const gitHubRepositoryID = repository.dbID\n    if (!gitHubRepositoryID) {\n      return fatalError(\n        \"Cannot get issues for a repository that hasn't been inserted into the database!\"\n      )\n    }\n\n    const db = this.db\n\n    const latestUpdatedIssue = await db.issues\n      .where('[gitHubRepositoryID+updated_at]')\n      .between([gitHubRepositoryID], [gitHubRepositoryID + 1], true, false)\n      .last()\n\n    if (!latestUpdatedIssue || !latestUpdatedIssue.updated_at) {\n      return null\n    }\n\n    const lastUpdatedAt = new Date(latestUpdatedIssue.updated_at)\n\n    return !isNaN(lastUpdatedAt.getTime()) ? lastUpdatedAt : null\n  }\n\n  /**\n   * Refresh the issues for the current repository. This will delete any issues that have\n   * been closed and update or add any issues that have changed or been added.\n   */\n  public async refreshIssues(repository: GitHubRepository, account: Account) {\n    const api = API.fromAccount(account)\n    const lastUpdatedAt = await this.getLatestUpdatedAt(repository)\n\n    // If we don't have a lastUpdatedAt that mean we haven't fetched any issues\n    // for the repository yet which in turn means we only have to fetch the\n    // currently open issues. If we have fetched before we get all issues\n    // that have been modified since the last time we fetched so that we\n    // can prune closed issues from our database. Note that since the GitHub\n    // API returns all issues modified _at_ or after the timestamp we give it\n    // we will always get at least one issue back but we won't have to transfer\n    // it since we should get a 304 response from GitHub.\n    const state = lastUpdatedAt ? 'all' : 'open'\n\n    const issues = await api.fetchIssues(\n      repository.owner.login,\n      repository.name,\n      state,\n      lastUpdatedAt\n    )\n\n    this.storeIssues(issues, repository)\n  }\n\n  private async storeIssues(\n    issues: ReadonlyArray<IAPIIssue>,\n    repository: GitHubRepository\n  ): Promise<void> {\n    const gitHubRepositoryID = repository.dbID\n    if (!gitHubRepositoryID) {\n      fatalError(\n        `Cannot store issues for a repository that hasn't been inserted into the database!`\n      )\n      return\n    }\n\n    const issuesToDelete = issues.filter(i => i.state === 'closed')\n    const issuesToUpsert = issues\n      .filter(i => i.state === 'open')\n      .map<IIssue>(i => {\n        return {\n          gitHubRepositoryID,\n          number: i.number,\n          title: i.title,\n          updated_at: i.updated_at,\n        }\n      })\n\n    const db = this.db\n\n    function findIssueInRepositoryByNumber(\n      gitHubRepositoryID: number,\n      issueNumber: number\n    ) {\n      return db.issues\n        .where('[gitHubRepositoryID+number]')\n        .equals([gitHubRepositoryID, issueNumber])\n        .limit(1)\n        .first()\n    }\n\n    await this.db.transaction('rw', this.db.issues, async () => {\n      for (const issue of issuesToDelete) {\n        const existing = await findIssueInRepositoryByNumber(\n          gitHubRepositoryID,\n          issue.number\n        )\n        if (existing) {\n          await this.db.issues.delete(existing.id!)\n        }\n      }\n\n      for (const issue of issuesToUpsert) {\n        const existing = await findIssueInRepositoryByNumber(\n          gitHubRepositoryID,\n          issue.number\n        )\n        if (existing) {\n          await db.issues.update(existing.id!, issue)\n        } else {\n          await db.issues.add(issue)\n        }\n      }\n    })\n  }\n\n  /** Get issues whose title or number matches the text. */\n  public async getIssuesMatching(\n    repository: GitHubRepository,\n    text: string\n  ): Promise<ReadonlyArray<IIssue>> {\n    const gitHubRepositoryID = repository.dbID\n    if (!gitHubRepositoryID) {\n      fatalError(\n        \"Cannot get issues for a repository that hasn't been inserted into the database!\"\n      )\n      return []\n    }\n\n    if (!text.length) {\n      const issues = await this.db.issues\n        .where('gitHubRepositoryID')\n        .equals(gitHubRepositoryID)\n        .limit(IssueResultsHardLimit)\n        .reverse()\n        .sortBy('number')\n      return issues\n    }\n\n    const MaxScore = 1\n    const score = (i: IIssue) => {\n      if (i.number.toString().startsWith(text)) {\n        return MaxScore\n      }\n\n      if (i.title.toLowerCase().includes(text.toLowerCase())) {\n        return MaxScore - 0.1\n      }\n\n      return 0\n    }\n\n    const issuesCollection = await this.db.issues\n      .where('gitHubRepositoryID')\n      .equals(gitHubRepositoryID)\n      .filter(i => score(i) > 0)\n\n    const issues = await issuesCollection.limit(IssueResultsHardLimit).toArray()\n\n    return issues.sort((a, b) => score(b) - score(a))\n  }\n}\n","import { Repository } from '../../models/repository'\nimport { Account } from '../../models/account'\nimport { GitHubRepository } from '../../models/github-repository'\nimport { API, getAccountForEndpoint, getDotComAPIEndpoint } from '../api'\nimport {\n  GitHubUserDatabase,\n  IGitHubUser,\n} from '../databases/github-user-database'\nimport { getAvatarWithEnterpriseFallback } from '../gravatar'\n\nimport { fatalError } from '../fatal-error'\nimport { compare } from '../compare'\nimport { BaseStore } from './base-store'\n\n/**\n * The store for GitHub users. This is used to match commit authors to GitHub\n * users and avatars.\n */\nexport class GitHubUserStore extends BaseStore {\n  private readonly requestsInFlight = new Set<string>()\n\n  /** The outer map is keyed by the endpoint, the inner map is keyed by email. */\n  private readonly usersByEndpoint = new Map<string, Map<string, IGitHubUser>>()\n\n  private readonly database: GitHubUserDatabase\n\n  /** The requests which have failed. We shouldn't keep trying them. */\n  private readonly failedRequests = new Set<string>()\n\n  /**\n   * The etag for the last mentionables request. Keyed by the GitHub repository\n   * `dbID`.\n   */\n  private readonly mentionablesEtags = new Map<number, string>()\n\n  public constructor(database: GitHubUserDatabase) {\n    super()\n\n    this.database = database\n  }\n\n  private getUsersForEndpoint(\n    endpoint: string\n  ): Map<string, IGitHubUser> | null {\n    return this.usersByEndpoint.get(endpoint) || null\n  }\n\n  /** Get the map of users for the repository. */\n  public getUsersForRepository(\n    repository: Repository\n  ): Map<string, IGitHubUser> {\n    const endpoint = repository.gitHubRepository\n      ? repository.gitHubRepository.endpoint\n      : getDotComAPIEndpoint()\n    return this.getUsersForEndpoint(endpoint) || new Map<string, IGitHubUser>()\n  }\n\n  /**\n   * Retrieve a public user profile based on the user login.\n   *\n   * If the user is already cached no additional API requests\n   * will be made. If the user isn't in the cache but found in\n   * the API it will be persisted to the database and the\n   * intermediate cache.\n   *\n   * @param account The account to use when querying the API\n   *                for information about the user\n   * @param login   The login (i.e. handle) of the user\n   */\n  public async getByLogin(\n    account: Account,\n    login: string\n  ): Promise<IGitHubUser | null> {\n    const existing = await this.database.users\n      .where('[endpoint+login]')\n      .equals([account.endpoint, login])\n      .first()\n\n    if (existing) {\n      return existing\n    }\n\n    const api = API.fromAccount(account)\n    const apiUser = await api.fetchUser(login).catch(e => null)\n\n    if (!apiUser || apiUser.type !== 'User') {\n      return null\n    }\n\n    const avatarURL = getAvatarWithEnterpriseFallback(\n      apiUser.avatar_url,\n      apiUser.email,\n      account.endpoint\n    )\n\n    const user: IGitHubUser = {\n      avatarURL,\n      email: apiUser.email || '',\n      endpoint: account.endpoint,\n      name: apiUser.name || apiUser.login,\n      login: apiUser.login,\n    }\n\n    // We don't overwrite email addresses since we might not get one from this\n    // endpoint, but we could already have one from looking up a commit\n    // specifically.\n    return await this.cacheUser(user, false)\n  }\n\n  /** Update the mentionable users for the repository. */\n  public async updateMentionables(\n    repository: GitHubRepository,\n    account: Account\n  ): Promise<void> {\n    const api = API.fromAccount(account)\n\n    const repositoryID = repository.dbID\n    if (!repositoryID) {\n      return fatalError(\n        `Cannot update mentionables for a repository that hasn't been cached yet.`\n      )\n    }\n    const etag = this.mentionablesEtags.get(repositoryID) || null\n\n    const response = await api.fetchMentionables(\n      repository.owner.login,\n      repository.name,\n      etag\n    )\n    if (!response) {\n      return\n    }\n    if (!response.users) {\n      return\n    }\n\n    if (response.etag) {\n      this.mentionablesEtags.set(repositoryID, response.etag)\n    }\n\n    const gitHubUsers: ReadonlyArray<IGitHubUser> = response.users.map(m => {\n      const email = m.email || ''\n\n      return {\n        ...m,\n        email,\n        endpoint: account.endpoint,\n        avatarURL: getAvatarWithEnterpriseFallback(\n          m.avatar_url,\n          email,\n          account.endpoint\n        ),\n      }\n    })\n\n    const cachedUsers = new Array<IGitHubUser>()\n    for (const user of gitHubUsers) {\n      // We don't overwrite email addresses since we might not get one from this\n      // endpoint, but we could already have one from looking up a commit\n      // specifically.\n      const cachedUser = await this.cacheUser(user, false)\n      if (cachedUser) {\n        cachedUsers.push(cachedUser)\n      }\n    }\n\n    for (const user of cachedUsers) {\n      await this.storeMentionable(user, repository)\n    }\n\n    await this.pruneRemovedMentionables(cachedUsers, repository)\n\n    this.emitUpdate()\n  }\n\n  /** Not to be called externally. See `Dispatcher`. */\n  public async _loadAndCacheUser(\n    accounts: ReadonlyArray<Account>,\n    repository: Repository,\n    sha: string | null,\n    email: string\n  ) {\n    const endpoint = repository.gitHubRepository\n      ? repository.gitHubRepository.endpoint\n      : getDotComAPIEndpoint()\n    const key = `${endpoint}+${email.toLowerCase()}`\n    if (this.requestsInFlight.has(key)) {\n      return\n    }\n    if (this.failedRequests.has(key)) {\n      return\n    }\n\n    const gitHubRepository = repository.gitHubRepository\n    if (!gitHubRepository) {\n      return\n    }\n\n    const account = getAccountForEndpoint(accounts, gitHubRepository.endpoint)\n    if (!account) {\n      return\n    }\n\n    this.requestsInFlight.add(key)\n\n    let gitUser: IGitHubUser | null = null\n    // We don't have email addresses for all the users in our database, e.g., if\n    // the user has no public email. In that case, the email field is an empty\n    // string. So searching with an empty email is gonna give us results, but\n    // not results that are meaningful.\n    if (email.length > 0) {\n      gitUser =\n        (await this.database.users\n          .where('[endpoint+email]')\n          .equals([account.endpoint, email.toLowerCase()])\n          .limit(1)\n          .first()) || null\n    }\n\n    // TODO: Invalidate the stored user in the db after ... some reasonable time\n    // period.\n    if (!gitUser) {\n      gitUser = await this.findUserWithAPI(\n        account,\n        gitHubRepository,\n        sha,\n        email\n      )\n    }\n\n    this.requestsInFlight.delete(key)\n\n    if (gitUser) {\n      await this.cacheUser(gitUser)\n      this.emitUpdate()\n    } else {\n      this.failedRequests.add(key)\n    }\n  }\n\n  private async findUserWithAPI(\n    account: Account,\n    repository: GitHubRepository,\n    sha: string | null,\n    email: string\n  ): Promise<IGitHubUser | null> {\n    const api = API.fromAccount(account)\n    if (sha) {\n      const apiCommit = await api.fetchCommit(\n        repository.owner.login,\n        repository.name,\n        sha\n      )\n      if (apiCommit && apiCommit.author) {\n        const avatarURL = getAvatarWithEnterpriseFallback(\n          apiCommit.author.avatar_url,\n          email,\n          account.endpoint\n        )\n\n        return {\n          email,\n          avatarURL,\n          login: apiCommit.author.login,\n          endpoint: account.endpoint,\n          name: apiCommit.author.name || apiCommit.author.login,\n        }\n      }\n    }\n\n    const matchingUser = await api.searchForUserWithEmail(email)\n    if (matchingUser) {\n      const avatarURL = getAvatarWithEnterpriseFallback(\n        matchingUser.avatar_url,\n        email,\n        account.endpoint\n      )\n      return {\n        email,\n        login: matchingUser.login,\n        avatarURL,\n        endpoint: account.endpoint,\n        name: matchingUser.name || matchingUser.login,\n      }\n    }\n\n    return null\n  }\n\n  /** Store the user in the cache. */\n  public async cacheUser(\n    user: IGitHubUser,\n    overwriteEmail: boolean = true\n  ): Promise<IGitHubUser | null> {\n    user = userWithLowerCase(user)\n\n    let userMap = this.getUsersForEndpoint(user.endpoint)\n    if (!userMap) {\n      userMap = new Map<string, IGitHubUser>()\n      this.usersByEndpoint.set(user.endpoint, userMap)\n    }\n\n    // We still store unknown emails as empty strings,\n    // inserting that into cache would just create a\n    // race condition of whoever gets added last\n    if (user.email.length > 0) {\n      userMap.set(user.email, user)\n    }\n\n    const addedUser = await this.database.transaction(\n      'rw',\n      this.database.users,\n      async () => {\n        const existing = await this.database.users\n          .where('[endpoint+login]')\n          .equals([user.endpoint, user.login])\n          .toArray()\n        const match = existing.find(e => e.email === user.email)\n        if (match) {\n          if (overwriteEmail) {\n            user = { ...user, id: match.id }\n          } else {\n            user = { ...user, id: match.id, email: match.email }\n          }\n        }\n\n        const id = await this.database.users.put(user)\n        return this.database.users.get(id)\n      }\n    )\n\n    return addedUser || null\n  }\n\n  /**\n   * Store a mentionable association between the user and repository.\n   *\n   * Note that both the user and the repository *must* have already been cached\n   * before calling this method. Otherwise it will throw.\n   */\n  private async storeMentionable(\n    user: IGitHubUser,\n    repository: GitHubRepository\n  ) {\n    const userID = user.id\n    if (!userID) {\n      fatalError(\n        `Cannot store a mentionable association for a user that hasn't been cached yet.`\n      )\n      return\n    }\n\n    const repositoryID = repository.dbID\n    if (!repositoryID) {\n      fatalError(\n        `Cannot store a mentionable association for a repository that hasn't been cached yet.`\n      )\n      return\n    }\n\n    await this.database.transaction(\n      'rw',\n      this.database.mentionables,\n      async () => {\n        const existing = await this.database.mentionables\n          .where('[userID+repositoryID]')\n          .equals([userID, repositoryID])\n          .limit(1)\n          .first()\n        if (existing) {\n          return\n        }\n\n        await this.database.mentionables.put({ userID, repositoryID })\n      }\n    )\n  }\n\n  /**\n   * Prune the mentionable associations by removing any association that isn't in\n   * the given array of users.\n   */\n  private async pruneRemovedMentionables(\n    users: ReadonlyArray<IGitHubUser>,\n    repository: GitHubRepository\n  ) {\n    const repositoryID = repository.dbID\n    if (!repositoryID) {\n      fatalError(\n        `Cannot prune removed mentionables for a repository that hasn't been cached yet.`\n      )\n      return\n    }\n\n    const userIDs = new Set<number>()\n    for (const user of users) {\n      const userID = user.id\n      if (!userID) {\n        fatalError(\n          `Cannot prune removed mentionables with a user that hasn't been cached yet: ${user}`\n        )\n        return\n      }\n\n      userIDs.add(userID)\n    }\n\n    await this.database.transaction(\n      'rw',\n      this.database.mentionables,\n      async () => {\n        const associations = await this.database.mentionables\n          .where('repositoryID')\n          .equals(repositoryID)\n          .toArray()\n\n        for (const association of associations) {\n          if (!userIDs.has(association.userID)) {\n            await this.database.mentionables.delete(association.id!)\n          }\n        }\n      }\n    )\n  }\n\n  /** Get the mentionable users in the repository. */\n  public async getMentionableUsers(\n    repository: GitHubRepository\n  ): Promise<ReadonlyArray<IGitHubUser>> {\n    const repositoryID = repository.dbID\n    if (!repositoryID) {\n      return fatalError(\n        `Cannot get mentionables for a repository that hasn't been cached yet.`\n      )\n    }\n\n    const users = new Array<IGitHubUser>()\n    await this.database.transaction(\n      'r',\n      this.database.mentionables,\n      this.database.users,\n      async () => {\n        const associations = await this.database.mentionables\n          .where('repositoryID')\n          .equals(repositoryID)\n          .toArray()\n\n        for (const association of associations) {\n          const user = await this.database.users.get(association.userID)\n          if (user) {\n            users.push(user)\n          }\n        }\n      }\n    )\n\n    return users\n  }\n\n  /**\n   * Get the mentionable users which match the text in some way.\n   *\n   * Hit results are ordered by how close in the search string\n   * they matched. Search strings start with username and are followed\n   * by real name. Only the first substring hit is considered\n   *\n   * @param text    A string to use when looking for a matching\n   *                user. A user is considered a hit if this text\n   *                matches any subtext of the username or real name\n   *\n   * @param maxHits The maximum number of hits to return.\n   */\n  public async getMentionableUsersMatching(\n    repository: GitHubRepository,\n    text: string,\n    maxHits: number = 100\n  ): Promise<ReadonlyArray<IGitHubUser>> {\n    const users = await this.getMentionableUsers(repository)\n\n    const hits = []\n    const needle = text.toLowerCase()\n\n    // Simple substring comparison on login and real name\n    for (let i = 0; i < users.length && hits.length < maxHits; i++) {\n      const user = users[i]\n      const ix = `${user.login} ${user.name}`\n        .trim()\n        .toLowerCase()\n        .indexOf(needle)\n\n      if (ix >= 0) {\n        hits.push({ user, ix })\n      }\n    }\n\n    // Sort hits primarily based on how early in the text the match\n    // was found and then secondarily using alphabetic order. Ideally\n    // we'd use the GitHub user id in order to match dotcom behavior\n    // but sadly we don't have it handy here. The id property on IGitHubUser\n    // refers to our internal database id.\n    return hits\n      .sort(\n        (x, y) => compare(x.ix, y.ix) || compare(x.user.login, y.user.login)\n      )\n      .map(h => h.user)\n  }\n}\n\n/**\n * Returns a copy of the user instance with relevant properties lower cased.\n */\nfunction userWithLowerCase(user: IGitHubUser): IGitHubUser {\n  return {\n    ...user,\n    email: user.email.toLowerCase(),\n    login: user.login.toLowerCase(),\n  }\n}\n","import { IRemote } from '../../../models/remote'\n\n/**\n * Attempt to find the remote which we consider to be the \"default\"\n * remote, i.e. in most cases the 'origin' remote.\n *\n * If no remotes are given this method will return null, if no \"default\"\n * branch could be found the first remote is considered the default.\n *\n * @param remotes A list of remotes for a given repository\n */\nexport function findDefaultRemote(remotes: ReadonlyArray<IRemote>) {\n  return remotes.find(x => x.name === 'origin') || remotes[0] || null\n}\n","async function awaitAnimationFrame(): Promise<number> {\n  return new Promise<number>((resolve, reject) => {\n    requestAnimationFrame(resolve)\n  })\n}\n\n/** The amount of time in milliseconds that we'll dedicate to queued work. */\nconst WorkWindowMs = 10\n\n/**\n * Split up high-priority synchronous work items across multiple animation frames.\n *\n * This function can be used to divvy up a set of tasks that needs to be executed\n * as quickly as possible with minimal interference to the browser's rendering.\n *\n * It does so by executing one work item per animation frame, potentially\n * squeezing in more if there's time left in the frame to do so.\n *\n * @param items  A set of work items to be executed across one or more animation\n *               frames\n *\n * @param worker A worker which, given a work item, performs work and returns\n *               either a promise or a synchronous result\n */\nexport async function queueWorkHigh<T>(\n  items: Iterable<T>,\n  worker: (item: T) => Promise<any> | any\n) {\n  const iterator = items[Symbol.iterator]()\n  let next = iterator.next()\n\n  while (!next.done) {\n    const start = await awaitAnimationFrame()\n\n    // Run one or more work items inside the animation frame. We will always run\n    // at least one task but we may run more if we can squeeze them into a 10ms\n    // window (frames have 1s/60 = 16.6ms available and we want to leave a little\n    // for the browser).\n    do {\n      // Promise.resolve lets us pass either a const value or a promise and it'll\n      // ensure we get an awaitable promise back.\n      await Promise.resolve(worker(next.value))\n      next = iterator.next()\n    } while (!next.done && performance.now() - start < WorkWindowMs)\n  }\n}\n","import * as Fs from 'fs'\nimport * as Path from 'path'\nimport { Disposable } from 'event-kit'\nimport { Repository } from '../../models/repository'\nimport { WorkingDirectoryFileChange, AppFileStatus } from '../../models/status'\nimport {\n  Branch,\n  BranchType,\n  IAheadBehind,\n  ICompareResult,\n} from '../../models/branch'\nimport { Tip, TipState } from '../../models/tip'\nimport { Commit } from '../../models/commit'\nimport { IRemote } from '../../models/remote'\nimport { IFetchProgress, IRevertProgress, ComparisonView } from '../app-state'\n\nimport { IAppShell } from '../app-shell'\nimport { ErrorWithMetadata, IErrorMetadata } from '../error-with-metadata'\nimport { structuralEquals } from '../../lib/equality'\nimport { compare } from '../../lib/compare'\nimport { queueWorkHigh } from '../../lib/queue-work'\n\nimport {\n  reset,\n  GitResetMode,\n  getRemotes,\n  fetch as fetchRepo,\n  fetchRefspec,\n  getRecentBranches,\n  getBranches,\n  deleteRef,\n  getCommits,\n  merge,\n  setRemoteURL,\n  getStatus,\n  IStatusResult,\n  getCommit,\n  IndexStatus,\n  getIndexChanges,\n  checkoutIndex,\n  checkoutPaths,\n  resetPaths,\n  revertCommit,\n  unstageAllFiles,\n  openMergeTool,\n  addRemote,\n  listSubmodules,\n  resetSubmodulePaths,\n  parseTrailers,\n  mergeTrailers,\n  getTrailerSeparatorCharacters,\n  parseSingleUnfoldedTrailer,\n  isCoAuthoredByTrailer,\n  getAheadBehind,\n  revRange,\n  revSymmetricDifference,\n  getSymbolicRef,\n} from '../git'\nimport { IGitAccount } from '../git/authentication'\nimport { RetryAction, RetryActionType } from '../retry-actions'\nimport { UpstreamAlreadyExistsError } from './upstream-already-exists-error'\nimport { forceUnwrap } from '../fatal-error'\nimport {\n  findUpstreamRemote,\n  UpstreamRemoteName,\n} from './helpers/find-upstream-remote'\nimport { findDefaultRemote } from './helpers/find-default-remote'\nimport { IAuthor } from '../../models/author'\nimport { formatCommitMessage } from '../format-commit-message'\nimport { GitAuthor } from '../../models/git-author'\nimport { BaseStore } from './base-store'\n\n/** The number of commits to load from history per batch. */\nconst CommitBatchSize = 100\n\nconst LoadingHistoryRequestKey = 'history'\n\n/** The max number of recent branches to find. */\nconst RecentBranchesLimit = 5\n\n/** A commit message summary and description. */\nexport interface ICommitMessage {\n  readonly summary: string\n  readonly description: string | null\n}\n\n/** The store for a repository's git data. */\nexport class GitStore extends BaseStore {\n  private readonly shell: IAppShell\n\n  /** The commits keyed by their SHA. */\n  public readonly commitLookup = new Map<string, Commit>()\n\n  private _history: ReadonlyArray<string> = new Array()\n\n  private readonly requestsInFight = new Set<string>()\n\n  private readonly repository: Repository\n\n  private _tip: Tip = { kind: TipState.Unknown }\n\n  private _defaultBranch: Branch | null = null\n\n  private _allBranches: ReadonlyArray<Branch> = []\n\n  private _recentBranches: ReadonlyArray<Branch> = []\n\n  private _localCommitSHAs: ReadonlyArray<string> = []\n\n  private _commitMessage: ICommitMessage | null = null\n\n  private _contextualCommitMessage: ICommitMessage | null = null\n\n  private _showCoAuthoredBy: boolean = false\n\n  private _coAuthors: ReadonlyArray<IAuthor> = []\n\n  private _aheadBehind: IAheadBehind | null = null\n\n  private _defaultRemote: IRemote | null = null\n\n  private _remote: IRemote | null = null\n\n  private _upstream: IRemote | null = null\n\n  private _lastFetched: Date | null = null\n\n  public constructor(repository: Repository, shell: IAppShell) {\n    super()\n\n    this.repository = repository\n    this.shell = shell\n  }\n\n  private emitNewCommitsLoaded(commits: ReadonlyArray<Commit>) {\n    this.emitter.emit('did-load-new-commits', commits)\n  }\n\n  /** Register a function to be called when the store loads new commits. */\n  public onDidLoadNewCommits(\n    fn: (commits: ReadonlyArray<Commit>) => void\n  ): Disposable {\n    return this.emitter.on('did-load-new-commits', fn)\n  }\n\n  /**\n   * Reconcile the local history view with the repository state\n   * after a pull has completed, to include merged remote commits.\n   */\n  public async reconcileHistory(mergeBase: string): Promise<void> {\n    if (this._history.length === 0) {\n      return\n    }\n\n    if (this.requestsInFight.has(LoadingHistoryRequestKey)) {\n      return\n    }\n\n    this.requestsInFight.add(LoadingHistoryRequestKey)\n\n    const range = revRange('HEAD', mergeBase)\n\n    const commits = await this.performFailableOperation(() =>\n      getCommits(this.repository, range, CommitBatchSize)\n    )\n    if (commits == null) {\n      return\n    }\n\n    const existingHistory = this._history\n    const index = existingHistory.findIndex(c => c === mergeBase)\n\n    if (index > -1) {\n      log.debug(\n        `reconciling history - adding ${\n          commits.length\n        } commits before merge base ${mergeBase.substr(0, 8)}`\n      )\n\n      // rebuild the local history state by combining the commits _before_ the\n      // merge base with the current commits on the tip of this current branch\n      const remainingHistory = existingHistory.slice(index)\n      this._history = [...commits.map(c => c.sha), ...remainingHistory]\n    }\n\n    this.storeCommits(commits, true)\n    this.requestsInFight.delete(LoadingHistoryRequestKey)\n    this.emitUpdate()\n  }\n\n  /** Load the next batch of history, starting from the last loaded commit. */\n  public async loadNextHistoryBatch() {\n    if (this.requestsInFight.has(LoadingHistoryRequestKey)) {\n      return\n    }\n\n    if (!this.history.length) {\n      return\n    }\n\n    const lastSHA = this.history[this.history.length - 1]\n    const requestKey = `history/${lastSHA}`\n    if (this.requestsInFight.has(requestKey)) {\n      return\n    }\n\n    this.requestsInFight.add(requestKey)\n\n    const commits = await this.performFailableOperation(() =>\n      getCommits(this.repository, `${lastSHA}^`, CommitBatchSize)\n    )\n    if (!commits) {\n      return\n    }\n\n    this._history = this._history.concat(commits.map(c => c.sha))\n    this.storeCommits(commits, true)\n    this.requestsInFight.delete(requestKey)\n    this.emitUpdate()\n  }\n\n  /** Load a batch of commits from the repository, using a given commitish object as the starting point */\n  public async loadCommitBatch(commitish: string) {\n    if (this.requestsInFight.has(LoadingHistoryRequestKey)) {\n      return null\n    }\n\n    const requestKey = `history/compare/${commitish}`\n    if (this.requestsInFight.has(requestKey)) {\n      return null\n    }\n\n    this.requestsInFight.add(requestKey)\n\n    const commits = await this.performFailableOperation(() =>\n      getCommits(this.repository, commitish, CommitBatchSize)\n    )\n\n    this.requestsInFight.delete(requestKey)\n    if (!commits) {\n      return null\n    }\n\n    this.storeCommits(commits, false)\n    return commits.map(c => c.sha)\n  }\n\n  /** The list of ordered SHAs. */\n  public get history(): ReadonlyArray<string> {\n    return this._history\n  }\n\n  /** Load all the branches. */\n  public async loadBranches() {\n    const [localAndRemoteBranches, recentBranchNames] = await Promise.all([\n      this.performFailableOperation(() => getBranches(this.repository)) || [],\n      this.performFailableOperation(() =>\n        getRecentBranches(this.repository, RecentBranchesLimit)\n      ),\n    ])\n\n    if (!localAndRemoteBranches) {\n      return\n    }\n\n    this._allBranches = this.mergeRemoteAndLocalBranches(localAndRemoteBranches)\n\n    this.refreshDefaultBranch()\n    this.refreshRecentBranches(recentBranchNames)\n\n    const commits = this._allBranches.map(b => b.tip)\n\n    for (const commit of commits) {\n      this.commitLookup.set(commit.sha, commit)\n    }\n\n    this.emitNewCommitsLoaded(commits)\n    this.emitUpdate()\n  }\n\n  /**\n   * Takes a list of local and remote branches and filters out \"duplicate\"\n   * remote branches, i.e. remote branches that we already have a local\n   * branch tracking.\n   */\n  private mergeRemoteAndLocalBranches(\n    branches: ReadonlyArray<Branch>\n  ): ReadonlyArray<Branch> {\n    const localBranches = new Array<Branch>()\n    const remoteBranches = new Array<Branch>()\n\n    for (const branch of branches) {\n      if (branch.type === BranchType.Local) {\n        localBranches.push(branch)\n      } else if (branch.type === BranchType.Remote) {\n        remoteBranches.push(branch)\n      }\n    }\n\n    const upstreamBranchesAdded = new Set<string>()\n    const allBranchesWithUpstream = new Array<Branch>()\n\n    for (const branch of localBranches) {\n      allBranchesWithUpstream.push(branch)\n\n      if (branch.upstream) {\n        upstreamBranchesAdded.add(branch.upstream)\n      }\n    }\n\n    for (const branch of remoteBranches) {\n      // This means we already added the local branch of this remote branch, so\n      // we don't need to add it again.\n      if (upstreamBranchesAdded.has(branch.name)) {\n        continue\n      }\n\n      allBranchesWithUpstream.push(branch)\n    }\n\n    return allBranchesWithUpstream\n  }\n\n  private async refreshDefaultBranch() {\n    const defaultBranchName = await this.resolveDefaultBranch()\n\n    // Find the default branch among all of our branches, giving\n    // priority to local branches by sorting them before remotes\n    this._defaultBranch =\n      this._allBranches\n        .filter(b => b.name === defaultBranchName)\n        .sort((x, y) => compare(x.type, y.type))\n        .shift() || null\n  }\n\n  /**\n   * Resolve the default branch name for the current repository,\n   * using the available API data, remote information or branch\n   * name conventionns.\n   */\n  private async resolveDefaultBranch(): Promise<string> {\n    const { gitHubRepository } = this.repository\n    if (gitHubRepository && gitHubRepository.defaultBranch != null) {\n      return gitHubRepository.defaultBranch\n    }\n\n    if (this.remote != null) {\n      // the Git server should use [remote]/HEAD to advertise\n      // it's default branch, so see if it exists and matches\n      // a valid branch on the remote and attempt to use that\n      const remoteNamespace = `refs/remotes/${this.remote.name}/`\n      const match = await getSymbolicRef(\n        this.repository,\n        `${remoteNamespace}HEAD`\n      )\n      if (\n        match != null &&\n        match.length > remoteNamespace.length &&\n        match.startsWith(remoteNamespace)\n      ) {\n        // strip out everything related to the remote because this\n        // is likely to be a tracked branch locally\n        // e.g. `master`, `develop`, etc\n        return match.substr(remoteNamespace.length)\n      }\n    }\n\n    return 'master'\n  }\n\n  private refreshRecentBranches(\n    recentBranchNames: ReadonlyArray<string> | undefined\n  ) {\n    if (!recentBranchNames || !recentBranchNames.length) {\n      this._recentBranches = []\n      return\n    }\n\n    const branchesByName = this._allBranches.reduce(\n      (map, branch) => map.set(branch.name, branch),\n      new Map<string, Branch>()\n    )\n\n    const recentBranches = new Array<Branch>()\n    for (const name of recentBranchNames) {\n      const branch = branchesByName.get(name)\n      if (!branch) {\n        // This means the recent branch has been deleted. That's fine.\n        continue\n      }\n\n      recentBranches.push(branch)\n    }\n\n    this._recentBranches = recentBranches\n  }\n\n  /** The current branch. */\n  public get tip(): Tip {\n    return this._tip\n  }\n\n  /** The default branch, or `master` if there is no default. */\n  public get defaultBranch(): Branch | null {\n    return this._defaultBranch\n  }\n\n  /** All branches, including the current branch and the default branch. */\n  public get allBranches(): ReadonlyArray<Branch> {\n    return this._allBranches\n  }\n\n  /** The most recently checked out branches. */\n  public get recentBranches(): ReadonlyArray<Branch> {\n    return this._recentBranches\n  }\n\n  /**\n   * Load local commits into memory for the current repository.\n   *\n   * @param branch The branch to query for unpublished commits.\n   *\n   * If the tip of the repository does not have commits (i.e. is unborn), this\n   * should be invoked with `null`, which clears any existing commits from the\n   * store.\n   */\n  public async loadLocalCommits(branch: Branch | null): Promise<void> {\n    if (branch === null) {\n      this._localCommitSHAs = []\n      return\n    }\n\n    let localCommits: ReadonlyArray<Commit> | undefined\n    if (branch.upstream) {\n      const range = revRange(branch.upstream, branch.name)\n      localCommits = await this.performFailableOperation(() =>\n        getCommits(this.repository, range, CommitBatchSize)\n      )\n    } else {\n      localCommits = await this.performFailableOperation(() =>\n        getCommits(this.repository, 'HEAD', CommitBatchSize, [\n          '--not',\n          '--remotes',\n        ])\n      )\n    }\n\n    if (!localCommits) {\n      return\n    }\n\n    this.storeCommits(localCommits)\n    this._localCommitSHAs = localCommits.map(c => c.sha)\n    this.emitUpdate()\n  }\n\n  /**\n   * The ordered array of local commit SHAs. The commits themselves can be\n   * looked up in `commits`.\n   */\n  public get localCommitSHAs(): ReadonlyArray<string> {\n    return this._localCommitSHAs\n  }\n\n  /** Store the given commits. */\n  private storeCommits(\n    commits: ReadonlyArray<Commit>,\n    emitUpdate: boolean = false\n  ) {\n    for (const commit of commits) {\n      this.commitLookup.set(commit.sha, commit)\n    }\n\n    if (emitUpdate) {\n      this.emitNewCommitsLoaded(commits)\n    }\n  }\n\n  private async undoFirstCommit(\n    repository: Repository\n  ): Promise<true | undefined> {\n    // What are we doing here?\n    // The state of the working directory here is rather important, because we\n    // want to ensure that any deleted files are restored to your working\n    // directory for the next stage. Doing doing a `git checkout -- .` here\n    // isn't suitable because we should preserve the other working directory\n    // changes.\n\n    const status = await this.performFailableOperation(() =>\n      getStatus(this.repository)\n    )\n\n    if (status == null) {\n      throw new Error(\n        `Unable to undo commit because there are too many files in your repository's working directory.`\n      )\n    }\n\n    const paths = status.workingDirectory.files\n\n    const deletedFiles = paths.filter(p => p.status === AppFileStatus.Deleted)\n    const deletedFilePaths = deletedFiles.map(d => d.path)\n\n    await checkoutPaths(repository, deletedFilePaths)\n\n    // Now that we have the working directory changes, as well the restored\n    // deleted files, we can remove the HEAD ref to make the current branch\n    // disappear\n    await deleteRef(repository, 'HEAD', 'Reverting first commit')\n\n    // Finally, ensure any changes in the index are unstaged. This ensures all\n    // files in the repository will be untracked.\n    await unstageAllFiles(repository)\n    return true\n  }\n\n  /**\n   * Undo a specific commit for the current repository.\n   *\n   * @param commit - The commit to remove - should be the tip of the current branch.\n   */\n  public async undoCommit(commit: Commit): Promise<void> {\n    // For an initial commit, just delete the reference but leave HEAD. This\n    // will make the branch unborn again.\n    const success = await this.performFailableOperation(\n      () =>\n        commit.parentSHAs.length === 0\n          ? this.undoFirstCommit(this.repository)\n          : reset(this.repository, GitResetMode.Mixed, commit.parentSHAs[0])\n    )\n\n    if (success === undefined) {\n      return\n    }\n\n    // Let's be safe about this since it's untried waters.\n    // If we can restore co-authors then that's fantastic\n    // but if we can't we shouldn't be throwing an error,\n    // let's just fall back to the old way of restoring the\n    // entire message\n    if (this.repository.gitHubRepository) {\n      try {\n        await this.loadCommitAndCoAuthors(commit)\n        this.emitUpdate()\n        return\n      } catch (e) {\n        log.error('Failed to restore commit and co-authors, falling back', e)\n      }\n    }\n\n    this._contextualCommitMessage = {\n      summary: commit.summary,\n      description: commit.body,\n    }\n    this.emitUpdate()\n  }\n\n  /**\n   * Attempt to restore both the commit message and any co-authors\n   * in it after an undo operation.\n   *\n   * This is a deceivingly simple task which complicated by the\n   * us wanting to follow the heuristics of Git when finding, and\n   * parsing trailers.\n   */\n  private async loadCommitAndCoAuthors(commit: Commit) {\n    const repository = this.repository\n\n    // git-interpret-trailers is really only made for working\n    // with full commit messages so let's start with that\n    const message = await formatCommitMessage(\n      repository,\n      commit.summary,\n      commit.body,\n      []\n    )\n\n    // Next we extract any co-authored-by trailers we\n    // can find. We use interpret-trailers for this\n    const foundTrailers = await parseTrailers(repository, message)\n    const coAuthorTrailers = foundTrailers.filter(isCoAuthoredByTrailer)\n\n    // This is the happy path, nothing more for us to do\n    if (coAuthorTrailers.length === 0) {\n      this._contextualCommitMessage = {\n        summary: commit.summary,\n        description: commit.body,\n      }\n\n      return\n    }\n\n    // call interpret-trailers --unfold so that we can be sure each\n    // trailer sits on a single line\n    const unfolded = await mergeTrailers(repository, message, [], true)\n    const lines = unfolded.split('\\n')\n\n    // We don't know (I mean, we're fairly sure) what the separator character\n    // used for the trailer is so we call out to git to get all possible\n    // characters. We'll need them in a bit\n    const separators = await getTrailerSeparatorCharacters(this.repository)\n\n    // We know that what we've got now is well formed so we can capture the leading\n    // token, followed by the separator char and a single space, followed by the\n    // value\n    const coAuthorRe = /^co-authored-by(.)\\s(.*)/i\n    const extractedTrailers = []\n\n    // Iterate backwards from the unfolded message and look for trailers that we've\n    // already seen when calling parseTrailers earlier.\n    for (let i = lines.length - 1; i >= 0; i--) {\n      const line = lines[i]\n      const match = coAuthorRe.exec(line)\n\n      // Not a trailer line, we're sure of that\n      if (!match || separators.indexOf(match[1]) === -1) {\n        continue\n      }\n\n      const trailer = parseSingleUnfoldedTrailer(line, match[1])\n\n      if (!trailer) {\n        continue\n      }\n\n      // We already know that the key is Co-Authored-By so we only\n      // need to compare by value. Let's see if we can find the thing\n      // that we believe to be a trailer among what interpret-trailers\n      // --parse told us was a trailer. This step is a bit redundant\n      // but it ensure we match exactly with what Git thinks is a trailer\n      const foundTrailerIx = coAuthorTrailers.findIndex(\n        t => t.value === trailer.value\n      )\n\n      if (foundTrailerIx === -1) {\n        continue\n      }\n\n      // We're running backwards\n      extractedTrailers.unshift(coAuthorTrailers[foundTrailerIx])\n\n      // Remove the trailer that matched so that we can be sure\n      // we're not picking it up again\n      coAuthorTrailers.splice(foundTrailerIx, 1)\n\n      // This line was a co-author trailer so we'll remove it to\n      // make sure it doesn't end up in the restored commit body\n      lines.splice(i, 1)\n    }\n\n    // Get rid of the summary/title\n    lines.splice(0, 2)\n\n    const newBody = lines.join('\\n').trim()\n\n    this._contextualCommitMessage = {\n      summary: commit.summary,\n      description: newBody,\n    }\n\n    const extractedAuthors = extractedTrailers.map(t =>\n      GitAuthor.parse(t.value)\n    )\n    const newAuthors = new Array<IAuthor>()\n\n    // Last step, phew! The most likely scenario where we\n    // get called is when someone has just made a commit and\n    // either forgot to add a co-author or forgot to remove\n    // someone so chances are high that we already have a\n    // co-author which includes a username. If we don't we'll\n    // add it without a username which is fine as well\n    for (let i = 0; i < extractedAuthors.length; i++) {\n      const extractedAuthor = extractedAuthors[i]\n\n      // If GitAuthor failed to parse\n      if (extractedAuthor === null) {\n        continue\n      }\n\n      const { name, email } = extractedAuthor\n      const existing = this.coAuthors.find(\n        a => a.name === name && a.email === email && a.username !== null\n      )\n      newAuthors.push(existing || { name, email, username: null })\n    }\n\n    this._coAuthors = newAuthors\n\n    if (this._coAuthors.length > 0 && this._showCoAuthoredBy === false) {\n      this._showCoAuthoredBy = true\n    }\n  }\n\n  /**\n   * Perform an operation that may fail by throwing an error. If an error is\n   * thrown, catch it and emit it, and return `undefined`.\n   *\n   * @param errorMetadata - The metadata which should be attached to any errors\n   *                        that are thrown.\n   */\n  public async performFailableOperation<T>(\n    fn: () => Promise<T>,\n    errorMetadata?: IErrorMetadata\n  ): Promise<T | undefined> {\n    try {\n      const result = await fn()\n      return result\n    } catch (e) {\n      e = new ErrorWithMetadata(e, {\n        repository: this.repository,\n        ...errorMetadata,\n      })\n\n      this.emitError(e)\n      return undefined\n    }\n  }\n\n  /** The commit message for a work-in-progress commit in the changes view. */\n  public get commitMessage(): ICommitMessage | null {\n    return this._commitMessage\n  }\n\n  /**\n   * The commit message to use based on the context of the repository, e.g., the\n   * message from a recently undone commit.\n   */\n  public get contextualCommitMessage(): ICommitMessage | null {\n    return this._contextualCommitMessage\n  }\n\n  /**\n   * Gets a value indicating whether the user has chosen to\n   * hide or show the co-authors field in the commit message\n   * component\n   */\n  public get showCoAuthoredBy(): boolean {\n    return this._showCoAuthoredBy\n  }\n\n  /**\n   * Gets a list of co-authors to use when crafting the next\n   * commit.\n   */\n  public get coAuthors(): ReadonlyArray<IAuthor> {\n    return this._coAuthors\n  }\n\n  /**\n   * Fetch the default, current, and upstream remotes, using the given account for\n   * authentication.\n   *\n   * @param account          - The account to use for authentication if needed.\n   * @param backgroundTask   - Was the fetch done as part of a background task?\n   * @param progressCallback - A function that's called with information about\n   *                           the overall fetch progress.\n   */\n  public async fetch(\n    account: IGitAccount | null,\n    backgroundTask: boolean,\n    progressCallback?: (fetchProgress: IFetchProgress) => void\n  ): Promise<void> {\n    // Use a map as a simple way of getting a unique set of remotes.\n    // Note that maps iterate in insertion order so the order in which\n    // we insert these will affect the order in which we fetch them\n    const remotes = new Map<string, IRemote>()\n\n    // We want to fetch the current remote first\n    if (this.remote) {\n      remotes.set(this.remote.name, this.remote)\n    }\n\n    // And then the default remote if it differs from the current\n    if (this.defaultRemote) {\n      remotes.set(this.defaultRemote.name, this.defaultRemote)\n    }\n\n    // And finally the upstream if we're a fork\n    if (this.upstream) {\n      remotes.set(this.upstream.name, this.upstream)\n    }\n\n    if (remotes.size > 0) {\n      await this.fetchRemotes(\n        account,\n        [...remotes.values()],\n        backgroundTask,\n        progressCallback\n      )\n    }\n\n    // check the upstream ref against the current branch to see if there are\n    // any new commits available\n    if (this.tip.kind === TipState.Valid) {\n      const currentBranch = this.tip.branch\n      if (currentBranch.remote !== null && currentBranch.upstream !== null) {\n        const range = revSymmetricDifference(\n          currentBranch.name,\n          currentBranch.upstream\n        )\n        this._aheadBehind = await getAheadBehind(this.repository, range)\n        this.emitUpdate()\n      }\n    }\n  }\n\n  /**\n   * Fetch the specified remotes, using the given account for authentication.\n   *\n   * @param account          - The account to use for authentication if needed.\n   * @param remotes          - The remotes to fetch from.\n   * @param backgroundTask   - Was the fetch done as part of a background task?\n   * @param progressCallback - A function that's called with information about\n   *                           the overall fetch progress.\n   */\n  public async fetchRemotes(\n    account: IGitAccount | null,\n    remotes: ReadonlyArray<IRemote>,\n    backgroundTask: boolean,\n    progressCallback?: (fetchProgress: IFetchProgress) => void\n  ): Promise<void> {\n    if (!remotes.length) {\n      return\n    }\n\n    const weight = 1 / remotes.length\n\n    for (let i = 0; i < remotes.length; i++) {\n      const remote = remotes[i]\n      const startProgressValue = i * weight\n\n      await this.fetchRemote(account, remote.name, backgroundTask, progress => {\n        if (progress && progressCallback) {\n          progressCallback({\n            ...progress,\n            value: startProgressValue + progress.value * weight,\n          })\n        }\n      })\n    }\n  }\n\n  /**\n   * Fetch a remote, using the given account for authentication.\n   *\n   * @param account          - The account to use for authentication if needed.\n   * @param remote           - The name of the remote to fetch from.\n   * @param backgroundTask   - Was the fetch done as part of a background task?\n   * @param progressCallback - A function that's called with information about\n   *                           the overall fetch progress.\n   */\n  public async fetchRemote(\n    account: IGitAccount | null,\n    remote: string,\n    backgroundTask: boolean,\n    progressCallback?: (fetchProgress: IFetchProgress) => void\n  ): Promise<void> {\n    const retryAction: RetryAction = {\n      type: RetryActionType.Fetch,\n      repository: this.repository,\n    }\n    await this.performFailableOperation(\n      () => {\n        return fetchRepo(this.repository, account, remote, progressCallback)\n      },\n      { backgroundTask, retryAction }\n    )\n  }\n\n  /**\n   * Fetch a given refspec, using the given account for authentication.\n   *\n   * @param user - The user to use for authentication if needed.\n   * @param refspec - The association between a remote and local ref to use as\n   *                  part of this action. Refer to git-scm for more\n   *                  information on refspecs: https://www.git-scm.com/book/tr/v2/Git-Internals-The-Refspec\n   *\n   */\n  public async fetchRefspec(\n    account: IGitAccount | null,\n    refspec: string\n  ): Promise<void> {\n    // TODO: we should favour origin here\n    const remotes = await getRemotes(this.repository)\n\n    for (const remote of remotes) {\n      await this.performFailableOperation(() =>\n        fetchRefspec(this.repository, account, remote.name, refspec)\n      )\n    }\n  }\n\n  public async loadStatus(): Promise<IStatusResult | null> {\n    const status = await this.performFailableOperation(() =>\n      getStatus(this.repository)\n    )\n\n    if (!status) {\n      return null\n    }\n\n    this._aheadBehind = status.branchAheadBehind || null\n\n    const { currentBranch, currentTip } = status\n\n    if (currentBranch || currentTip) {\n      if (currentTip && currentBranch) {\n        const branchTipCommit = await this.lookupCommit(currentTip)\n\n        const branch = new Branch(\n          currentBranch,\n          status.currentUpstreamBranch || null,\n          branchTipCommit,\n          BranchType.Local\n        )\n        this._tip = { kind: TipState.Valid, branch }\n      } else if (currentTip) {\n        this._tip = { kind: TipState.Detached, currentSha: currentTip }\n      } else if (currentBranch) {\n        this._tip = { kind: TipState.Unborn, ref: currentBranch }\n      }\n    } else {\n      this._tip = { kind: TipState.Unknown }\n    }\n\n    this.emitUpdate()\n\n    return status\n  }\n\n  /**\n   * Find a commit in the local cache, or load in the commit from the underlying\n   * repository.\n   *\n   * This will error if the commit ID cannot be resolved.\n   */\n  private async lookupCommit(sha: string): Promise<Commit> {\n    const cachedCommit = this.commitLookup.get(sha)\n    if (cachedCommit != null) {\n      return Promise.resolve(cachedCommit)\n    }\n\n    const foundCommit = await this.performFailableOperation(() =>\n      getCommit(this.repository, sha)\n    )\n\n    if (foundCommit != null) {\n      this.commitLookup.set(sha, foundCommit)\n      return foundCommit\n    }\n\n    throw new Error(`Could not load commit: '${sha}'`)\n  }\n\n  public async loadRemotes(): Promise<void> {\n    const remotes = await getRemotes(this.repository)\n    this._defaultRemote = findDefaultRemote(remotes)\n\n    const currentRemoteName =\n      this.tip.kind === TipState.Valid && this.tip.branch.remote !== null\n        ? this.tip.branch.remote\n        : null\n\n    // Load the remote that the current branch is tracking. If the branch\n    // is not tracking any remote or the remote which it's tracking has\n    // been removed we'll default to the default branch.\n    this._remote =\n      currentRemoteName !== null\n        ? remotes.find(r => r.name === currentRemoteName) || this._defaultRemote\n        : this._defaultRemote\n\n    const parent =\n      this.repository.gitHubRepository &&\n      this.repository.gitHubRepository.parent\n\n    this._upstream = parent ? findUpstreamRemote(parent, remotes) : null\n\n    this.emitUpdate()\n  }\n\n  /**\n   * Add the upstream remote if the repository is a fork and an upstream remote\n   * doesn't already exist.\n   */\n  public async addUpstreamRemoteIfNeeded(): Promise<void> {\n    const parent =\n      this.repository.gitHubRepository &&\n      this.repository.gitHubRepository.parent\n    if (!parent) {\n      return\n    }\n\n    const remotes = await getRemotes(this.repository)\n    const upstream = findUpstreamRemote(parent, remotes)\n    if (upstream) {\n      return\n    }\n\n    const remoteWithUpstreamName = remotes.find(\n      r => r.name === UpstreamRemoteName\n    )\n    if (remoteWithUpstreamName) {\n      const error = new UpstreamAlreadyExistsError(\n        this.repository,\n        remoteWithUpstreamName\n      )\n      this.emitError(error)\n      return\n    }\n\n    const url = forceUnwrap(\n      'Parent repositories are fully loaded',\n      parent.cloneURL\n    )\n\n    await this.performFailableOperation(() =>\n      addRemote(this.repository, UpstreamRemoteName, url)\n    )\n    this._upstream = { name: UpstreamRemoteName, url }\n  }\n\n  /**\n   * The number of commits the current branch is ahead and behind, relative to\n   * its upstream.\n   *\n   * It will be `null` if ahead/behind hasn't been calculated yet, or if the\n   * branch doesn't have an upstream.\n   */\n  public get aheadBehind(): IAheadBehind | null {\n    return this._aheadBehind\n  }\n\n  /** Get the remote we're working with. */\n  public get defaultRemote(): IRemote | null {\n    return this._defaultRemote\n  }\n\n  /** Get the remote we're working with. */\n  public get remote(): IRemote | null {\n    return this._remote\n  }\n\n  /**\n   * Get the remote for the upstream repository. This will be null if the\n   * repository isn't a fork, or if the fork doesn't have an upstream remote.\n   */\n  public get upstream(): IRemote | null {\n    return this._upstream\n  }\n\n  /**\n   * Set whether the user has chosen to hide or show the\n   * co-authors field in the commit message component\n   */\n  public setShowCoAuthoredBy(showCoAuthoredBy: boolean) {\n    this._showCoAuthoredBy = showCoAuthoredBy\n    // Clear co-authors when hiding\n    if (!showCoAuthoredBy) {\n      this._coAuthors = []\n    }\n    this.emitUpdate()\n  }\n\n  /**\n   * Update co-authors list\n   *\n   * @param coAuthors  Zero or more authors\n   */\n  public setCoAuthors(coAuthors: ReadonlyArray<IAuthor>) {\n    this._coAuthors = coAuthors\n    this.emitUpdate()\n  }\n\n  public setCommitMessage(message: ICommitMessage | null): Promise<void> {\n    this._commitMessage = message\n    this.emitUpdate()\n    return Promise.resolve()\n  }\n\n  /** The date the repository was last fetched. */\n  public get lastFetched(): Date | null {\n    return this._lastFetched\n  }\n\n  /** Update the last fetched date. */\n  public updateLastFetched(): Promise<void> {\n    const path = Path.join(this.repository.path, '.git', 'FETCH_HEAD')\n    return new Promise<void>((resolve, reject) => {\n      Fs.stat(path, (err, stats) => {\n        if (err) {\n          // An error most likely means the repository's never been published.\n          this._lastFetched = null\n        } else if (stats.size > 0) {\n          // If the file's empty then it _probably_ means the fetch failed and we\n          // shouldn't update the last fetched date.\n          this._lastFetched = stats.mtime\n        }\n\n        resolve()\n\n        this.emitUpdate()\n      })\n    })\n  }\n\n  /** Merge the named branch into the current branch. */\n  public merge(branch: string): Promise<void> {\n    return this.performFailableOperation(() => merge(this.repository, branch), {\n      command: 'merge',\n    })\n  }\n\n  /** Changes the URL for the remote that matches the given name  */\n  public async setRemoteURL(name: string, url: string): Promise<void> {\n    await this.performFailableOperation(() =>\n      setRemoteURL(this.repository, name, url)\n    )\n    await this.loadRemotes()\n\n    this.emitUpdate()\n  }\n\n  public async discardChanges(\n    files: ReadonlyArray<WorkingDirectoryFileChange>\n  ): Promise<void> {\n    const pathsToCheckout = new Array<string>()\n    const pathsToReset = new Array<string>()\n\n    const submodules = await listSubmodules(this.repository)\n\n    await queueWorkHigh(files, async file => {\n      const foundSubmodule = submodules.some(s => s.path === file.path)\n\n      if (file.status !== AppFileStatus.Deleted && !foundSubmodule) {\n        // N.B. moveItemToTrash is synchronous can take a fair bit of time\n        // which is why we're running it inside this work queue that spreads\n        // out the calls across as many animation frames as it needs to.\n        this.shell.moveItemToTrash(\n          Path.resolve(this.repository.path, file.path)\n        )\n      }\n\n      if (\n        file.status === AppFileStatus.Copied ||\n        file.status === AppFileStatus.Renamed\n      ) {\n        // file.path is the \"destination\" or \"new\" file in a copy or rename.\n        // we've already deleted it so all we need to do is make sure the\n        // index forgets about it.\n        pathsToReset.push(file.path)\n\n        // Checkout the old path though\n        if (file.oldPath) {\n          pathsToCheckout.push(file.oldPath)\n          pathsToReset.push(file.oldPath)\n        }\n      } else {\n        pathsToCheckout.push(file.path)\n        pathsToReset.push(file.path)\n      }\n    })\n\n    // Check the index to see which files actually have changes there as compared to HEAD\n    const changedFilesInIndex = await getIndexChanges(this.repository)\n\n    // Only reset paths if they have changes in the index\n    const necessaryPathsToReset = pathsToReset.filter(x =>\n      changedFilesInIndex.has(x)\n    )\n\n    const submodulePaths = pathsToCheckout.filter(p =>\n      submodules.find(s => s.path === p)\n    )\n\n    // Don't attempt to checkout files that are submodules or don't exist in the index after our reset\n    const necessaryPathsToCheckout = pathsToCheckout.filter(\n      x =>\n        submodulePaths.indexOf(x) === -1 ||\n        changedFilesInIndex.get(x) !== IndexStatus.Added\n    )\n\n    // We're trying to not invoke git linearly with the number of files to discard\n    // so we're doing our discards in three conceptual steps.\n    //\n    // 1. Figure out what the index thinks has changed as compared to the previous\n    //    commit. For users who exclusive interact with Git using Desktop this will\n    //    almost always empty which, as it turns out, is great for us.\n    //\n    // 2. Figure out if any of the files that we've been asked to discard are changed\n    //    in the index and if so, reset them such that the index is set up just as\n    //    the previous commit for the paths we're discarding.\n    //\n    // 3. Checkout all the files that we've discarded that existed in the previous\n    //    commit from the index.\n    await this.performFailableOperation(async () => {\n      await resetSubmodulePaths(this.repository, submodulePaths)\n      await resetPaths(\n        this.repository,\n        GitResetMode.Mixed,\n        'HEAD',\n        necessaryPathsToReset\n      )\n      await checkoutIndex(this.repository, necessaryPathsToCheckout)\n    })\n  }\n\n  /** Load the contextual commit message if there is one. */\n  public async loadContextualCommitMessage(): Promise<void> {\n    const message = await this.getMergeMessage()\n    const existingMessage = this._contextualCommitMessage\n    // In the case where we're in the middle of a merge, we're gonna keep\n    // finding the same merge message over and over. We don't need to keep\n    // telling the world.\n    if (\n      existingMessage &&\n      message &&\n      structuralEquals(existingMessage, message)\n    ) {\n      return\n    }\n\n    this._contextualCommitMessage = message\n    this.emitUpdate()\n  }\n\n  /** Reverts the commit with the given SHA */\n  public async revertCommit(\n    repository: Repository,\n    commit: Commit,\n    account: IGitAccount | null,\n    progressCallback?: (fetchProgress: IRevertProgress) => void\n  ): Promise<void> {\n    await this.performFailableOperation(() =>\n      revertCommit(repository, commit, account, progressCallback)\n    )\n\n    this.emitUpdate()\n  }\n\n  /**\n   * Get the merge message in the repository. This will resolve to null if the\n   * repository isn't in the middle of a merge.\n   */\n  private async getMergeMessage(): Promise<ICommitMessage | null> {\n    const messagePath = Path.join(this.repository.path, '.git', 'MERGE_MSG')\n    return new Promise<ICommitMessage | null>((resolve, reject) => {\n      Fs.readFile(messagePath, 'utf8', (err, data) => {\n        if (err || !data.length) {\n          resolve(null)\n        } else {\n          const pieces = data.match(/(.*)\\n\\n([\\S\\s]*)/m)\n          if (!pieces || pieces.length < 3) {\n            resolve(null)\n            return\n          }\n\n          // exclude any commented-out lines from the MERGE_MSG body\n          let description: string | null = pieces[2]\n            .split('\\n')\n            .filter(line => line[0] !== '#')\n            .join('\\n')\n\n          // join with no elements will return an empty string\n          if (description.length === 0) {\n            description = null\n          }\n\n          resolve({\n            summary: pieces[1],\n            description,\n          })\n        }\n      })\n    })\n  }\n\n  public async openMergeTool(path: string): Promise<void> {\n    await this.performFailableOperation(() =>\n      openMergeTool(this.repository, path)\n    )\n  }\n\n  /**\n   * Update the repository's existing upstream remote to point to the parent\n   * repository.\n   */\n  public async updateExistingUpstreamRemote(): Promise<void> {\n    const gitHubRepository = forceUnwrap(\n      'To update an upstream remote, the repository must be a GitHub repository',\n      this.repository.gitHubRepository\n    )\n    const parent = forceUnwrap(\n      'To update an upstream remote, the repository must have a parent',\n      gitHubRepository.parent\n    )\n    const url = forceUnwrap(\n      'Parent repositories are always fully loaded',\n      parent.cloneURL\n    )\n\n    await this.performFailableOperation(() =>\n      setRemoteURL(this.repository, UpstreamRemoteName, url)\n    )\n  }\n\n  /**\n   * Returns the commits associated with `branch` and ahead/behind info;\n   */\n  public async getCompareCommits(\n    branch: Branch,\n    compareType: ComparisonView.Ahead | ComparisonView.Behind\n  ): Promise<ICompareResult | null> {\n    if (this.tip.kind !== TipState.Valid) {\n      return null\n    }\n\n    const base = this.tip.branch\n    const aheadBehind = await getAheadBehind(\n      this.repository,\n      revSymmetricDifference(base.name, branch.name)\n    )\n\n    if (aheadBehind == null) {\n      return null\n    }\n\n    const revisionRange =\n      compareType === ComparisonView.Ahead\n        ? revRange(branch.name, base.name)\n        : revRange(base.name, branch.name)\n    const commitsToLoad =\n      compareType === ComparisonView.Ahead\n        ? aheadBehind.ahead\n        : aheadBehind.behind\n    const commits = await getCommits(\n      this.repository,\n      revisionRange,\n      commitsToLoad\n    )\n\n    if (commits.length > 0) {\n      this.storeCommits(commits, true)\n    }\n\n    return {\n      commits,\n      ahead: aheadBehind.ahead,\n      behind: aheadBehind.behind,\n    }\n  }\n}\n","import { CloningRepository } from '../../models/cloning-repository'\nimport { clone as cloneRepo, CloneOptions } from '../git'\nimport { ICloneProgress } from '../app-state'\nimport { RetryAction, RetryActionType } from '../retry-actions'\nimport { ErrorWithMetadata } from '../error-with-metadata'\nimport { BaseStore } from './base-store'\n\n/** The store in charge of repository currently being cloned. */\nexport class CloningRepositoriesStore extends BaseStore {\n  private readonly _repositories = new Array<CloningRepository>()\n  private readonly stateByID = new Map<number, ICloneProgress>()\n\n  /**\n   * Clone the repository at the URL to the path.\n   *\n   * Returns a {Promise} which resolves to whether the clone was successful.\n   */\n  public async clone(\n    url: string,\n    path: string,\n    options: CloneOptions\n  ): Promise<boolean> {\n    const repository = new CloningRepository(path, url)\n    this._repositories.push(repository)\n\n    const title = `Cloning into ${path}`\n\n    this.stateByID.set(repository.id, { kind: 'clone', title, value: 0 })\n    this.emitUpdate()\n\n    let success = true\n    try {\n      await cloneRepo(url, path, options, progress => {\n        this.stateByID.set(repository.id, progress)\n        this.emitUpdate()\n      })\n    } catch (e) {\n      success = false\n\n      const retryAction: RetryAction = {\n        type: RetryActionType.Clone,\n        url,\n        path,\n        options,\n      }\n      e = new ErrorWithMetadata(e, { retryAction, repository })\n\n      this.emitError(e)\n    }\n\n    this.remove(repository)\n\n    return success\n  }\n\n  /** Get the repositories currently being cloned. */\n  public get repositories(): ReadonlyArray<CloningRepository> {\n    return Array.from(this._repositories)\n  }\n\n  /** Get the state of the repository. */\n  public getRepositoryState(\n    repository: CloningRepository\n  ): ICloneProgress | null {\n    return this.stateByID.get(repository.id) || null\n  }\n\n  /** Remove the repository. */\n  public remove(repository: CloningRepository) {\n    this.stateByID.delete(repository.id)\n\n    const repoIndex = this._repositories.findIndex(r => r.id === repository.id)\n    if (repoIndex > -1) {\n      this._repositories.splice(repoIndex, 1)\n    }\n\n    this.emitUpdate()\n  }\n}\n","import * as Fs from 'fs'\nimport * as Path from 'path'\n\n/**\n * Type representing the contents of the gemoji json database\n * which consists of a top-level array containing objects describing\n * emojis.\n */\ntype IGemojiDb = ReadonlyArray<IGemojiDefinition>\n\n/**\n * Partial (there's more in the db) interface describing the elements\n * in the gemoji json array.\n */\ninterface IGemojiDefinition {\n  /**\n   * The unicode string of the emoji if emoji is part of\n   * the unicode specification. If missing this emoji is\n   * a GitHub custom emoji such as :shipit:\n   */\n  readonly emoji?: string\n\n  /** One or more human readable aliases for the emoji character */\n  readonly aliases: ReadonlyArray<string>\n\n  /** An optional, human readable, description of the emoji  */\n  readonly description?: string\n}\n\nfunction getEmojiImageUrlFromRelativePath(relativePath: string): string {\n  return `file://${Path.join(__dirname, 'emoji', relativePath)}`\n}\n\n/**\n * Given a unicode point number, returns a hexadecimal string\n * which is lef padded with zeroes to be at least 4 characters\n */\nfunction getHexCodePoint(cp: number): string {\n  const str = cp.toString(16)\n\n  // The combining characters are always stored on disk\n  // as zero-padded 4 character strings. Don't ask me why.\n  return str.length >= 4 ? str : ('0000' + str).substring(str.length)\n}\n\n/**\n * Returns a url to the on disk location of the image\n * representing the given emoji or null in case the\n * emoji unicode string was invalid.\n */\nfunction getUrlFromUnicodeEmoji(emoji: string): string | null {\n  const codePoint = emoji.codePointAt(0)\n\n  if (!codePoint) {\n    return null\n  }\n\n  let filename = getHexCodePoint(codePoint)\n\n  // Some emoji are composed of two unicode code points, they're\n  // usually variants of the same theme (like :one:, :two: etc)\n  // and they're stored on disk as CP1-CP2.\n  if (emoji.length > 2) {\n    const combiningCodePoint = emoji.codePointAt(2)\n\n    // 0xfe0f is VARIATION SELECTOR-16 which, best as I can tell means\n    // make the character before me all fancy pants. I don't know why\n    // but gemoji explicitly excludes this from its naming scheme so\n    // we'll do the same.\n    if (combiningCodePoint && combiningCodePoint !== 0xfe0f) {\n      filename = `${filename}-${getHexCodePoint(combiningCodePoint)}`\n    }\n  }\n\n  return getEmojiImageUrlFromRelativePath(`unicode/${filename}.png`)\n}\n\n/**\n * Read the stored emoji list from JSON into an in-memory representation.\n *\n * @param rootDir - The folder containing the entry point (index.html or main.js) of the application.\n */\nexport function readEmoji(rootDir: string): Promise<Map<string, string>> {\n  return new Promise<Map<string, string>>((resolve, reject) => {\n    const path = Path.join(rootDir, 'emoji.json')\n    Fs.readFile(path, 'utf8', (err, data) => {\n      if (err) {\n        reject(err)\n        return\n      }\n\n      const tmp = new Map<string, string>()\n\n      try {\n        const db: IGemojiDb = JSON.parse(data)\n        db.forEach(emoji => {\n          // Custom emoji don't have a unicode string and are instead stored\n          // on disk as their first alias.\n          const url = emoji.emoji\n            ? getUrlFromUnicodeEmoji(emoji.emoji)\n            : getEmojiImageUrlFromRelativePath(`${emoji.aliases[0]}.png`)\n\n          if (!url) {\n            log.error(`Could not calculate location of emoji: ${emoji}`)\n            return\n          }\n\n          emoji.aliases.forEach(alias => {\n            tmp.set(`:${alias}:`, url)\n          })\n        })\n      } catch (e) {\n        reject(e)\n      }\n\n      const emoji = new Map<string, string>()\n\n      // Sort and insert into actual map\n      const keys = Array.from(tmp.keys()).sort()\n      keys.forEach(k => {\n        const value = tmp.get(k)\n        if (value) {\n          emoji.set(k, value)\n        }\n      })\n\n      resolve(emoji)\n    })\n  })\n}\n","import { PullRequestStore } from '../pull-request-store'\nimport { Account } from '../../../models/account'\nimport { fatalError, forceUnwrap } from '../../fatal-error'\nimport { PullRequest } from '../../../models/pull-request'\nimport { Repository } from '../../../models/repository'\n\n//** Interval to check for pull requests */\nconst PullRequestInterval = 1000 * 60 * 10\n\n//** Interval to check for pull request statuses */\nconst StatusInterval = 1000 * 60 * 10\n\n//** Interval to check for pull request statuses after commits have been pushed */\nconst PostPushInterval = 1000 * 60\n\nenum TimeoutHandles {\n  PullRequest = 'PullRequestHandle',\n  Status = 'StatusHandle',\n  PushedPullRequest = 'PushedPullRequestHandle',\n}\n\n/**\n * Acts as a service for downloading the latest pull request\n * and status info from GitHub.\n */\nexport class PullRequestUpdater {\n  private readonly repository: Repository\n  private readonly account: Account\n  private readonly store: PullRequestStore\n\n  private readonly timeoutHandles = new Map<TimeoutHandles, number>()\n  private isStopped: boolean = true\n\n  private currentPullRequests: ReadonlyArray<PullRequest> = []\n\n  public constructor(\n    repository: Repository,\n    account: Account,\n    pullRequestStore: PullRequestStore\n  ) {\n    this.repository = repository\n    this.account = account\n    this.store = pullRequestStore\n  }\n\n  /** Starts the updater */\n  public start() {\n    const githubRepo = forceUnwrap(\n      'Can only refresh pull requests for GitHub repositories',\n      this.repository.gitHubRepository\n    )\n\n    if (!this.isStopped) {\n      fatalError(\n        'Cannot start the Pull Request Updater that is already running.'\n      )\n\n      return\n    }\n\n    this.timeoutHandles.set(\n      TimeoutHandles.PullRequest,\n\n      window.setTimeout(() => {\n        this.store.fetchAndCachePullRequests(this.repository, this.account)\n      }, PullRequestInterval)\n    )\n\n    this.timeoutHandles.set(\n      TimeoutHandles.Status,\n      window.setTimeout(() => {\n        this.store.fetchPullRequestStatuses(githubRepo, this.account)\n      }, StatusInterval)\n    )\n  }\n\n  public stop() {\n    this.isStopped = true\n\n    for (const timeoutHandle of this.timeoutHandles.values()) {\n      window.clearTimeout(timeoutHandle)\n    }\n\n    this.timeoutHandles.clear()\n  }\n\n  /** Starts fetching the statuses of PRs at an accelerated rate */\n  public didPushPullRequest(pullRequest: PullRequest) {\n    if (this.currentPullRequests.find(p => p.id === pullRequest.id)) {\n      return\n    }\n\n    this.currentPullRequests = [...this.currentPullRequests, pullRequest]\n\n    const pushedPRHandle = this.timeoutHandles.get(\n      TimeoutHandles.PushedPullRequest\n    )\n    if (pushedPRHandle) {\n      return\n    }\n\n    const handle = window.setTimeout(\n      () => this.refreshPullRequestStatus(),\n      PostPushInterval\n    )\n    this.timeoutHandles.set(TimeoutHandles.PushedPullRequest, handle)\n  }\n\n  private async refreshPullRequestStatus() {\n    const githubRepo = forceUnwrap(\n      'Can only refresh pull requests for GitHub repositories',\n      this.repository.gitHubRepository\n    )\n\n    await this.store.fetchPullRequestStatuses(githubRepo, this.account)\n    const prs = await this.store.fetchPullRequestsFromCache(githubRepo)\n\n    for (const pr of prs) {\n      const status = pr.status\n      if (!status) {\n        continue\n      }\n\n      if (\n        !status.totalCount ||\n        status.state === 'success' ||\n        status.state === 'failure'\n      ) {\n        this.currentPullRequests = this.currentPullRequests.filter(\n          p => p.pullRequestNumber !== status.pullRequestNumber\n        )\n      }\n    }\n\n    if (!this.currentPullRequests.length) {\n      const handle = this.timeoutHandles.get(TimeoutHandles.PushedPullRequest)\n\n      if (handle) {\n        window.clearTimeout(handle)\n        this.timeoutHandles.delete(TimeoutHandles.PushedPullRequest)\n      }\n    }\n  }\n}\n","import { Branch } from '../../../models/branch'\nimport { PullRequest } from '../../../models/pull-request'\nimport { GitHubRepository } from '../../../models/github-repository'\nimport { IRemote } from '../../../models/remote'\nimport { Repository } from '../../../models/repository'\nimport { ComparisonCache } from '../../comparison-cache'\n\ntype RemotesGetter = (repository: Repository) => Promise<ReadonlyArray<IRemote>>\n\n/**\n * Infers which branch to use as the comparison branch\n *\n * The branch returned is determined by the following conditions:\n * 1. Given a pull request -> target branch of PR\n * 2. Given a forked repository -> default branch on `upstream`\n * 3. Given a hosted repository -> default branch on `origin`\n * 4. Fallback -> `master` branch\n *\n * @param repository The repository the branch belongs to\n * @param branches The list of all branches for the repository\n * @param currentPullRequest The pull request to use for finding the branch\n * @param currentBranch The branch we want the parent of\n * @param getRemotes callback used to get all remotes for the current repository\n * @param comparisonCache cache used to get the number of commits ahead/behind the current branch is from another branch\n */\nexport async function inferComparisonBranch(\n  repository: Repository,\n  branches: ReadonlyArray<Branch>,\n  currentPullRequest: PullRequest | null,\n  currentBranch: Branch | null,\n  getRemotes: RemotesGetter,\n  comparisonCache: ComparisonCache\n): Promise<Branch | null> {\n  if (currentPullRequest !== null) {\n    return getTargetBranchOfPullRequest(branches, currentPullRequest)\n  }\n\n  const ghRepo = repository.gitHubRepository\n  if (ghRepo !== null) {\n    return ghRepo.fork === true && currentBranch !== null\n      ? getDefaultBranchOfFork(\n          repository,\n          branches,\n          currentBranch,\n          getRemotes,\n          comparisonCache\n        )\n      : getDefaultBranchOfGitHubRepo(branches, ghRepo)\n  }\n\n  return getMasterBranch(branches)\n}\n\nfunction getMasterBranch(branches: ReadonlyArray<Branch>): Branch | null {\n  return findBranch(branches, 'master')\n}\n\nfunction getDefaultBranchOfGitHubRepo(\n  branches: ReadonlyArray<Branch>,\n  ghRepository: GitHubRepository\n): Branch | null {\n  if (ghRepository.defaultBranch === null) {\n    return null\n  }\n\n  return findBranch(branches, ghRepository.defaultBranch)\n}\n\nfunction getTargetBranchOfPullRequest(\n  branches: ReadonlyArray<Branch>,\n  pr: PullRequest\n): Branch | null {\n  return findBranch(branches, pr.base.ref)\n}\n\n/**\n * For `inferComparisonBranch` case where inferring for a forked repository\n *\n * Returns the default branch of the fork if it's ahead of `currentBranch`.\n * Otherwise, the default branch of the parent is returned.\n */\nasync function getDefaultBranchOfFork(\n  repository: Repository,\n  branches: ReadonlyArray<Branch>,\n  currentBranch: Branch,\n  getRemotes: RemotesGetter,\n  comparisonCache: ComparisonCache\n): Promise<Branch | null> {\n  // this is guaranteed to exist since this function\n  // is only called if the ghRepo is not null\n  const ghRepo = repository.gitHubRepository!\n  const defaultBranch = getDefaultBranchOfGitHubRepo(branches, ghRepo)\n  if (defaultBranch === null) {\n    return getMasterBranch(branches)\n  }\n\n  const aheadBehind = comparisonCache.get(\n    currentBranch.tip.sha,\n    defaultBranch.tip.sha\n  )\n\n  // we want to return the default branch of the fork if it's ahead\n  // of the current branch; see https://github.com/desktop/desktop/issues/4766#issue-325764371\n  if (aheadBehind !== null && aheadBehind.ahead > 0) {\n    return defaultBranch\n  }\n\n  const potentialDefault = await getDefaultBranchOfForkedGitHubRepo(\n    repository,\n    branches,\n    getRemotes\n  )\n\n  return potentialDefault\n}\n\nasync function getDefaultBranchOfForkedGitHubRepo(\n  repository: Repository,\n  branches: ReadonlyArray<Branch>,\n  getRemotes: RemotesGetter\n): Promise<Branch | null> {\n  const parentRepo =\n    repository.gitHubRepository !== null\n      ? repository.gitHubRepository.parent\n      : null\n\n  if (parentRepo === null) {\n    return null\n  }\n\n  const remotes = await getRemotes(repository)\n  const remote = remotes.find(r => r.url === parentRepo.cloneURL)\n\n  if (remote === undefined) {\n    log.warn(`Could not find remote with URL ${parentRepo.cloneURL}.`)\n    return null\n  }\n\n  const branchToFind = `${remote.name}/${parentRepo.defaultBranch}`\n\n  return findBranch(branches, branchToFind)\n}\n\nfunction findBranch(\n  branches: ReadonlyArray<Branch>,\n  name: string\n): Branch | null {\n  return branches.find(b => b.name === name) || null\n}\n","import { Repository } from '../../../models/repository'\nimport { Account } from '../../../models/account'\nimport { GitHubRepository } from '../../../models/github-repository'\nimport { API } from '../../api'\nimport { fatalError } from '../../fatal-error'\n\n/**\n * A default interval at which to automatically fetch repositories, if the\n * server doesn't specify one or the header is malformed.\n */\nconst DefaultFetchInterval = 1000 * 60 * 60\n\n/**\n * A minimum fetch interval, to protect against the server accidentally sending\n * us a crazy value.\n */\nconst MinimumInterval = 1000 * 5 * 60\n\n/**\n * An upper bound to the skew that should be applied to the fetch interval to\n * prevent clients from accidentally syncing up.\n */\nconst SkewUpperBound = 30 * 1000\n\n/** The class which handles doing background fetches of the repository. */\nexport class BackgroundFetcher {\n  private readonly repository: Repository\n  private readonly account: Account\n  private readonly fetch: (repository: Repository) => Promise<void>\n  private readonly shouldPerformFetch: (repository: Repository) => boolean\n\n  /** The handle for our setTimeout invocation. */\n  private timeoutHandle: number | null = null\n\n  /** Flag to indicate whether `stop` has been called. */\n  private stopped = false\n\n  public constructor(\n    repository: Repository,\n    account: Account,\n    fetch: (repository: Repository) => Promise<void>,\n    shouldPerformFetch: (repository: Repository) => boolean\n  ) {\n    this.repository = repository\n    this.account = account\n    this.fetch = fetch\n    this.shouldPerformFetch = shouldPerformFetch\n  }\n\n  /** Start background fetching. */\n  public start(withInitialSkew: boolean) {\n    if (this.stopped) {\n      fatalError('Cannot start a background fetcher that has been stopped.')\n      return\n    }\n\n    const gitHubRepository = this.repository.gitHubRepository\n    if (!gitHubRepository) {\n      return\n    }\n\n    if (withInitialSkew) {\n      this.timeoutHandle = window.setTimeout(\n        () => this.performAndScheduleFetch(gitHubRepository),\n        skewInterval()\n      )\n    } else {\n      this.performAndScheduleFetch(gitHubRepository)\n    }\n  }\n\n  /**\n   * Stop background fetching. Once this is called, the fetcher cannot be\n   * restarted.\n   */\n  public stop() {\n    this.stopped = true\n\n    const handle = this.timeoutHandle\n    if (handle) {\n      window.clearTimeout(handle)\n      this.timeoutHandle = null\n    }\n  }\n\n  /** Perform a fetch and schedule the next one. */\n  private async performAndScheduleFetch(\n    repository: GitHubRepository\n  ): Promise<void> {\n    if (this.stopped) {\n      return\n    }\n\n    const shouldFetch = this.shouldPerformFetch(this.repository)\n    if (shouldFetch) {\n      try {\n        await this.fetch(this.repository)\n      } catch (e) {\n        const ghRepo = this.repository.gitHubRepository\n        const repoName =\n          ghRepo !== null ? ghRepo.fullName : this.repository.name\n\n        log.error(`Error performing periodic fetch for '${repoName}'`, e)\n      }\n    }\n\n    if (this.stopped) {\n      return\n    }\n\n    const interval = await this.getFetchInterval(repository)\n    if (this.stopped) {\n      return\n    }\n\n    this.timeoutHandle = window.setTimeout(\n      () => this.performAndScheduleFetch(repository),\n      interval\n    )\n  }\n\n  /** Get the allowed fetch interval from the server. */\n  private async getFetchInterval(\n    repository: GitHubRepository\n  ): Promise<number> {\n    const api = API.fromAccount(this.account)\n\n    let interval = DefaultFetchInterval\n    try {\n      const pollInterval = await api.getFetchPollInterval(\n        repository.owner.login,\n        repository.name\n      )\n      if (pollInterval) {\n        interval = Math.max(pollInterval, MinimumInterval)\n      } else {\n        interval = DefaultFetchInterval\n      }\n    } catch (e) {\n      log.error('Error fetching poll interval', e)\n    }\n\n    return interval + skewInterval()\n  }\n}\n\nlet _skewInterval: number | null = null\n\n/**\n * The milliseconds by which the fetch interval should be skewed, to prevent\n * clients from accidentally syncing up.\n */\nfunction skewInterval(): number {\n  if (_skewInterval !== null) {\n    return _skewInterval!\n  }\n\n  // We don't need cryptographically secure random numbers for\n  // the skew. Pseudo-random should be just fine.\n  // eslint-disable-next-line insecure-random\n  const skew = Math.ceil(Math.random() * SkewUpperBound)\n  _skewInterval = skew\n  return skew\n}\n","module.exports = require(\"events\");","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n","var inherits = require('inherits')\nvar EventEmitter = require('events').EventEmitter\n\nmodule.exports = Queue\n\nfunction Queue (options) {\n  if (!(this instanceof Queue)) {\n    return new Queue(options)\n  }\n\n  EventEmitter.call(this)\n  options = options || {}\n  this.concurrency = options.concurrency || Infinity\n  this.timeout = options.timeout || 0\n  this.autostart = options.autostart || false\n  this.results = options.results || null\n  this.pending = 0\n  this.session = 0\n  this.running = false\n  this.jobs = []\n  this.timers = {}\n}\ninherits(Queue, EventEmitter)\n\nvar arrayMethods = [\n  'pop',\n  'shift',\n  'indexOf',\n  'lastIndexOf'\n]\n\narrayMethods.forEach(function (method) {\n  Queue.prototype[method] = function () {\n    return Array.prototype[method].apply(this.jobs, arguments)\n  }\n})\n\nQueue.prototype.slice = function (begin, end) {\n  this.jobs = this.jobs.slice(begin, end)\n  return this\n}\n\nQueue.prototype.reverse = function () {\n  this.jobs.reverse()\n  return this\n}\n\nvar arrayAddMethods = [\n  'push',\n  'unshift',\n  'splice'\n]\n\narrayAddMethods.forEach(function (method) {\n  Queue.prototype[method] = function () {\n    var methodResult = Array.prototype[method].apply(this.jobs, arguments)\n    if (this.autostart) {\n      this.start()\n    }\n    return methodResult\n  }\n})\n\nObject.defineProperty(Queue.prototype, 'length', {\n  get: function () {\n    return this.pending + this.jobs.length\n  }\n})\n\nQueue.prototype.start = function (cb) {\n  if (cb) {\n    callOnErrorOrEnd.call(this, cb)\n  }\n\n  this.running = true\n\n  if (this.pending >= this.concurrency) {\n    return\n  }\n\n  if (this.jobs.length === 0) {\n    if (this.pending === 0) {\n      done.call(this)\n    }\n    return\n  }\n\n  var self = this\n  var job = this.jobs.shift()\n  var once = true\n  var session = this.session\n  var timeoutId = null\n  var didTimeout = false\n  var resultIndex = null\n\n  function next (err, result) {\n    if (once && self.session === session) {\n      once = false\n      self.pending--\n      if (timeoutId !== null) {\n        delete self.timers[timeoutId]\n        clearTimeout(timeoutId)\n      }\n\n      if (err) {\n        self.emit('error', err, job)\n      } else if (didTimeout === false) {\n        if (resultIndex !== null) {\n          self.results[resultIndex] = Array.prototype.slice.call(arguments, 1)\n        }\n        self.emit('success', result, job)\n      }\n\n      if (self.session === session) {\n        if (self.pending === 0 && self.jobs.length === 0) {\n          done.call(self)\n        } else if (self.running) {\n          self.start()\n        }\n      }\n    }\n  }\n\n  if (this.timeout) {\n    timeoutId = setTimeout(function () {\n      didTimeout = true\n      if (self.listeners('timeout').length > 0) {\n        self.emit('timeout', next, job)\n      } else {\n        next()\n      }\n    }, this.timeout)\n    this.timers[timeoutId] = timeoutId\n  }\n\n  if (this.results) {\n    resultIndex = this.results.length\n    this.results[resultIndex] = null\n  }\n\n  this.pending++\n  var promise = job(next)\n  if (promise && promise.then && typeof promise.then === 'function') {\n    promise.then(function (result) {\n      next(null, result)\n    }).catch(function (err) {\n      next(err || true)\n    })\n  }\n\n  if (this.running && this.jobs.length > 0) {\n    this.start()\n  }\n}\n\nQueue.prototype.stop = function () {\n  this.running = false\n}\n\nQueue.prototype.end = function (err) {\n  clearTimers.call(this)\n  this.jobs.length = 0\n  this.pending = 0\n  done.call(this, err)\n}\n\nfunction clearTimers () {\n  for (var key in this.timers) {\n    var timeoutId = this.timers[key]\n    delete this.timers[key]\n    clearTimeout(timeoutId)\n  }\n}\n\nfunction callOnErrorOrEnd (cb) {\n  var self = this\n  this.on('error', onerror)\n  this.on('end', onend)\n\n  function onerror (err) { self.end(err) }\n  function onend (err) {\n    self.removeListener('error', onerror)\n    self.removeListener('end', onend)\n    cb(err, this.results)\n  }\n}\n\nfunction done (err) {\n  this.session++\n  this.running = false\n  this.emit('end', err)\n}\n","const queue: (config: QueueConfig) => Queue = require('queue')\nimport { revSymmetricDifference } from '../../../lib/git'\n\n// eslint-disable-next-line typescript/interface-name-prefix\ninterface QueueConfig {\n  // Max number of jobs the queue should process concurrently, defaults to Infinity.\n  readonly concurrency: number\n  // Ensures the queue is always running if jobs are available.\n  // Useful in situations where you are using a queue only for concurrency control.\n  readonly autostart: boolean\n}\n\n// eslint-disable-next-line typescript/interface-name-prefix\ninterface Queue extends NodeJS.EventEmitter {\n  readonly length: number\n\n  start(): void\n  end(): void\n  push<T>(\n    func: (callback: (error: Error | null, result: T) => void) => void\n  ): void\n}\n\nimport { Repository } from '../../../models/repository'\nimport { getAheadBehind } from '../../../lib/git'\nimport { Branch, IAheadBehind } from '../../../models/branch'\nimport { ComparisonCache } from '../../comparison-cache'\n\nexport class AheadBehindUpdater {\n  private comparisonCache = new ComparisonCache()\n\n  private aheadBehindQueue = queue({\n    concurrency: 1,\n    autostart: true,\n  })\n\n  public constructor(\n    private repository: Repository,\n    private onCacheUpdate: (cache: ComparisonCache) => void\n  ) {}\n\n  public start() {\n    this.aheadBehindQueue.on('success', (result: IAheadBehind | null) => {\n      if (result != null) {\n        this.onCacheUpdate(this.comparisonCache)\n      }\n    })\n\n    this.aheadBehindQueue.on('error', (err: Error) => {\n      log.debug(\n        '[AheadBehindUpdater] an error with the queue was reported',\n        err\n      )\n    })\n\n    this.aheadBehindQueue.on('end', (err?: Error) => {\n      if (err != null) {\n        log.debug(`[AheadBehindUpdater] ended with an error`, err)\n      }\n    })\n\n    this.aheadBehindQueue.start()\n  }\n\n  public stop() {\n    this.aheadBehindQueue.end()\n  }\n\n  private executeTask = (\n    from: string,\n    to: string,\n    callback: (error: Error | null, result: IAheadBehind | null) => void\n  ) => {\n    if (this.comparisonCache.has(from, to)) {\n      return\n    }\n\n    const range = revSymmetricDifference(from, to)\n    getAheadBehind(this.repository, range).then(result => {\n      if (result != null) {\n        this.comparisonCache.set(from, to, result)\n      } else {\n        log.debug(\n          `[AheadBehindUpdater] unable to cache '${range}' as no result returned`\n        )\n      }\n      callback(null, result)\n    })\n  }\n\n  public insert(from: string, to: string, value: IAheadBehind) {\n    if (this.comparisonCache.has(from, to)) {\n      return\n    }\n\n    this.comparisonCache.set(from, to, value)\n  }\n\n  /**\n   * Stop processing any ahead/behind computations for the current repository\n   */\n  public clear() {\n    this.aheadBehindQueue.end()\n  }\n\n  /**\n   * Schedule ahead/behind computations for all available branches in\n   * the current repository, where they haven't been already computed\n   *\n   * @param currentBranch The current branch of the repository\n   * @param defaultBranch The default branch (if defined)\n   * @param recentBranches Recent branches in the repository\n   * @param allBranches All known branches in the repository\n   */\n  public schedule(\n    currentBranch: Branch,\n    defaultBranch: Branch | null,\n    recentBranches: ReadonlyArray<Branch>,\n    allBranches: ReadonlyArray<Branch>\n  ) {\n    this.clear()\n\n    const from = currentBranch.tip.sha\n\n    const filterBranchesNotInCache = (branches: ReadonlyArray<Branch>) => {\n      return branches\n        .map(b => b.tip.sha)\n        .filter(to => !this.comparisonCache.has(from, to))\n    }\n\n    const otherBranches = [...recentBranches, ...allBranches]\n\n    const branches =\n      defaultBranch !== null ? [defaultBranch, ...otherBranches] : otherBranches\n\n    const newRefsToCompare = new Set<string>(filterBranchesNotInCache(branches))\n\n    log.debug(\n      `[AheadBehindUpdater] - found ${\n        newRefsToCompare.size\n      } comparisons to perform`\n    )\n\n    for (const sha of newRefsToCompare) {\n      this.aheadBehindQueue.push<IAheadBehind | null>(callback =>\n        requestIdleCallback(() => {\n          this.executeTask(from, sha, callback)\n        })\n      )\n    }\n  }\n}\n","import { spawn, ChildProcess } from 'child_process'\nimport { pathExists } from 'fs-extra'\nimport { assertNever } from '../fatal-error'\nimport { IFoundShell } from './found-shell'\n\nexport enum Shell {\n  Gnome = 'GNOME Terminal',\n  Mate = 'MATE Terminal',\n  Tilix = 'Tilix',\n  Terminator = 'Terminator',\n  Urxvt = 'URxvt',\n  Konsole = 'Konsole',\n  Xterm = 'XTerm',\n  Terminology = 'Terminology',\n}\n\nexport const Default = Shell.Gnome\n\nexport function parse(label: string): Shell {\n  if (label === Shell.Gnome) {\n    return Shell.Gnome\n  }\n\n  if (label === Shell.Mate) {\n    return Shell.Mate\n  }\n\n  if (label === Shell.Tilix) {\n    return Shell.Tilix\n  }\n\n  if (label === Shell.Terminator) {\n    return Shell.Terminator\n  }\n\n  if (label === Shell.Urxvt) {\n    return Shell.Urxvt\n  }\n\n  if (label === Shell.Konsole) {\n    return Shell.Konsole\n  }\n\n  if (label === Shell.Xterm) {\n    return Shell.Xterm\n  }\n\n  if (label === Shell.Terminology) {\n    return Shell.Terminology\n  }\n\n  return Default\n}\n\nasync function getPathIfAvailable(path: string): Promise<string | null> {\n  return (await pathExists(path)) ? path : null\n}\n\nfunction getShellPath(shell: Shell): Promise<string | null> {\n  switch (shell) {\n    case Shell.Gnome:\n      return getPathIfAvailable('/usr/bin/gnome-terminal')\n    case Shell.Mate:\n      return getPathIfAvailable('/usr/bin/mate-terminal')\n    case Shell.Tilix:\n      return getPathIfAvailable('/usr/bin/tilix')\n    case Shell.Terminator:\n      return getPathIfAvailable('/usr/bin/terminator')\n    case Shell.Urxvt:\n      return getPathIfAvailable('/usr/bin/urxvt')\n    case Shell.Konsole:\n      return getPathIfAvailable('/usr/bin/konsole')\n    case Shell.Xterm:\n      return getPathIfAvailable('/usr/bin/xterm')\n    case Shell.Terminology:\n      return getPathIfAvailable('/usr/bin/terminology')\n    default:\n      return assertNever(shell, `Unknown shell: ${shell}`)\n  }\n}\n\nexport async function getAvailableShells(): Promise<\n  ReadonlyArray<IFoundShell<Shell>>\n> {\n  const [\n    gnomeTerminalPath,\n    mateTerminalPath,\n    tilixPath,\n    terminatorPath,\n    urxvtPath,\n    konsolePath,\n    xtermPath,\n    terminologyPath,\n  ] = await Promise.all([\n    getShellPath(Shell.Gnome),\n    getShellPath(Shell.Mate),\n    getShellPath(Shell.Tilix),\n    getShellPath(Shell.Terminator),\n    getShellPath(Shell.Urxvt),\n    getShellPath(Shell.Konsole),\n    getShellPath(Shell.Xterm),\n    getShellPath(Shell.Terminology),\n  ])\n\n  const shells: Array<IFoundShell<Shell>> = []\n  if (gnomeTerminalPath) {\n    shells.push({ shell: Shell.Gnome, path: gnomeTerminalPath })\n  }\n\n  if (mateTerminalPath) {\n    shells.push({ shell: Shell.Mate, path: mateTerminalPath })\n  }\n\n  if (tilixPath) {\n    shells.push({ shell: Shell.Tilix, path: tilixPath })\n  }\n\n  if (terminatorPath) {\n    shells.push({ shell: Shell.Terminator, path: terminatorPath })\n  }\n\n  if (urxvtPath) {\n    shells.push({ shell: Shell.Urxvt, path: urxvtPath })\n  }\n\n  if (konsolePath) {\n    shells.push({ shell: Shell.Konsole, path: konsolePath })\n  }\n\n  if (xtermPath) {\n    shells.push({ shell: Shell.Xterm, path: xtermPath })\n  }\n\n  if (terminologyPath) {\n    shells.push({ shell: Shell.Terminology, path: terminologyPath })\n  }\n\n  return shells\n}\n\nexport function launch(\n  foundShell: IFoundShell<Shell>,\n  path: string\n): ChildProcess {\n  const shell = foundShell.shell\n  switch (shell) {\n    case Shell.Gnome:\n    case Shell.Mate:\n    case Shell.Tilix:\n    case Shell.Terminator:\n      return spawn(foundShell.path, ['--working-directory', path])\n    case Shell.Urxvt:\n      return spawn(foundShell.path, ['-cd', path])\n    case Shell.Konsole:\n      return spawn(foundShell.path, ['--workdir', path])\n    case Shell.Xterm:\n      return spawn(foundShell.path, ['-e', '/bin/bash'], { cwd: path })\n    case Shell.Terminology:\n      return spawn(foundShell.path, ['-d', path])\n    default:\n      return assertNever(shell, `Unknown shell: ${shell}`)\n  }\n}\n","import { spawn, ChildProcess } from 'child_process'\nimport * as Path from 'path'\nimport { enumerateValues, HKEY, RegistryValueType } from 'registry-js'\nimport { pathExists } from 'fs-extra'\n\nimport { assertNever } from '../fatal-error'\nimport { IFoundShell } from './found-shell'\n\nexport enum Shell {\n  Cmd = 'Command Prompt',\n  PowerShell = 'PowerShell',\n  PowerShellCore = 'PowerShell Core',\n  Hyper = 'Hyper',\n  GitBash = 'Git Bash',\n  Cygwin = 'Cygwin',\n}\n\nexport const Default = Shell.Cmd\n\nexport function parse(label: string): Shell {\n  if (label === Shell.Cmd) {\n    return Shell.Cmd\n  }\n\n  if (label === Shell.PowerShell) {\n    return Shell.PowerShell\n  }\n\n  if (label === Shell.PowerShellCore) {\n    return Shell.PowerShellCore\n  }\n\n  if (label === Shell.Hyper) {\n    return Shell.Hyper\n  }\n\n  if (label === Shell.GitBash) {\n    return Shell.GitBash\n  }\n\n  if (label === Shell.Cygwin) {\n    return Shell.Cygwin\n  }\n\n  return Default\n}\n\nexport async function getAvailableShells(): Promise<\n  ReadonlyArray<IFoundShell<Shell>>\n> {\n  const shells = [\n    {\n      shell: Shell.Cmd,\n      path: process.env.comspec || 'C:\\\\Windows\\\\System32\\\\cmd.exe',\n    },\n  ]\n\n  const powerShellPath = await findPowerShell()\n  if (powerShellPath != null) {\n    shells.push({\n      shell: Shell.PowerShell,\n      path: powerShellPath,\n    })\n  }\n\n  const powerShellCorePath = await findPowerShellCore()\n  if (powerShellCorePath != null) {\n    shells.push({\n      shell: Shell.PowerShellCore,\n      path: powerShellCorePath,\n    })\n  }\n\n  const hyperPath = await findHyper()\n  if (hyperPath != null) {\n    shells.push({\n      shell: Shell.Hyper,\n      path: hyperPath,\n    })\n  }\n\n  const gitBashPath = await findGitBash()\n  if (gitBashPath != null) {\n    shells.push({\n      shell: Shell.GitBash,\n      path: gitBashPath,\n    })\n  }\n\n  const cygwinPath = await findCygwin()\n  if (cygwinPath != null) {\n    shells.push({\n      shell: Shell.Cygwin,\n      path: cygwinPath,\n    })\n  }\n\n  return shells\n}\n\nasync function findPowerShell(): Promise<string | null> {\n  const powerShell = enumerateValues(\n    HKEY.HKEY_LOCAL_MACHINE,\n    'Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\App Paths\\\\PowerShell.exe'\n  )\n\n  if (powerShell.length === 0) {\n    return null\n  }\n\n  const first = powerShell[0]\n\n  // NOTE:\n  // on Windows 7 these are both REG_SZ, which technically isn't supposed\n  // to contain unexpanded references to environment variables. But given\n  // it's also %SystemRoot% and we do the expanding here I think this is\n  // a fine workaround to do to support the maximum number of setups.\n\n  if (\n    first.type === RegistryValueType.REG_EXPAND_SZ ||\n    first.type === RegistryValueType.REG_SZ\n  ) {\n    const path = first.data.replace(\n      /^%SystemRoot%/i,\n      process.env.SystemRoot || 'C:\\\\Windows'\n    )\n\n    if (await pathExists(path)) {\n      return path\n    } else {\n      log.debug(\n        `[PowerShell] registry entry found but does not exist at '${path}'`\n      )\n    }\n  }\n\n  return null\n}\n\nasync function findPowerShellCore(): Promise<string | null> {\n  const powerShellCore = enumerateValues(\n    HKEY.HKEY_LOCAL_MACHINE,\n    'Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\App Paths\\\\pwsh.exe'\n  )\n\n  if (powerShellCore.length === 0) {\n    return null\n  }\n\n  const first = powerShellCore[0]\n  if (first.type === RegistryValueType.REG_SZ) {\n    const path = first.data\n\n    if (await pathExists(path)) {\n      return path\n    } else {\n      log.debug(\n        `[PowerShellCore] registry entry found but does not exist at '${path}'`\n      )\n    }\n  }\n\n  return null\n}\n\nasync function findHyper(): Promise<string | null> {\n  const hyper = enumerateValues(\n    HKEY.HKEY_CURRENT_USER,\n    'Software\\\\Classes\\\\Directory\\\\Background\\\\shell\\\\Hyper\\\\command'\n  )\n\n  if (hyper.length === 0) {\n    return null\n  }\n\n  const first = hyper[0]\n  if (first.type === RegistryValueType.REG_SZ) {\n    // Registry key is structured as \"{installationPath}\\app-x.x.x\\Hyper.exe\" \"%V\"\n\n    // This regex is designed to get the path to the version-specific Hyper.\n    // commandPieces = ['\"{installationPath}\\app-x.x.x\\Hyper.exe\"', '\"', '{installationPath}\\app-x.x.x\\Hyper.exe', ...]\n    const commandPieces = first.data.match(/([\"'])(.*?)\\1/)\n    const localAppData = process.env.LocalAppData\n\n    const path = commandPieces\n      ? commandPieces[2]\n      : localAppData != null\n        ? localAppData.concat('\\\\hyper\\\\Hyper.exe')\n        : null // fall back to the launcher in install root\n\n    if (path == null) {\n      log.debug(\n        `[Hyper] LOCALAPPDATA environment variable is unset, aborting fallback behavior`\n      )\n    } else if (await pathExists(path)) {\n      return path\n    } else {\n      log.debug(`[Hyper] registry entry found but does not exist at '${path}'`)\n    }\n  }\n\n  return null\n}\n\nasync function findGitBash(): Promise<string | null> {\n  const registryPath = enumerateValues(\n    HKEY.HKEY_LOCAL_MACHINE,\n    'SOFTWARE\\\\GitForWindows'\n  )\n\n  if (registryPath.length === 0) {\n    return null\n  }\n\n  const installPathEntry = registryPath.find(e => e.name === 'InstallPath')\n  if (installPathEntry && installPathEntry.type === RegistryValueType.REG_SZ) {\n    const path = Path.join(installPathEntry.data, 'git-bash.exe')\n\n    if (await pathExists(path)) {\n      return path\n    } else {\n      log.debug(\n        `[Git Bash] registry entry found but does not exist at '${path}'`\n      )\n    }\n  }\n\n  return null\n}\n\nasync function findCygwin(): Promise<string | null> {\n  const registryPath64 = enumerateValues(\n    HKEY.HKEY_LOCAL_MACHINE,\n    'SOFTWARE\\\\Cygwin\\\\setup'\n  )\n  const registryPath32 = enumerateValues(\n    HKEY.HKEY_LOCAL_MACHINE,\n    'SOFTWARE\\\\WOW6432Node\\\\Cygwin\\\\setup'\n  )\n\n  if (registryPath64 == null || registryPath32 == null) {\n    return null\n  }\n\n  const installPathEntry64 = registryPath64.find(e => e.name === 'rootdir')\n  const installPathEntry32 = registryPath32.find(e => e.name === 'rootdir')\n  if (\n    installPathEntry64 &&\n    installPathEntry64.type === RegistryValueType.REG_SZ\n  ) {\n    const path = Path.join(installPathEntry64.data, 'bin\\\\mintty.exe')\n\n    if (await pathExists(path)) {\n      return path\n    } else if (\n      installPathEntry32 &&\n      installPathEntry32.type === RegistryValueType.REG_SZ\n    ) {\n      const path = Path.join(installPathEntry32.data, 'bin\\\\mintty.exe')\n      if (await pathExists(path)) {\n        return path\n      }\n    } else {\n      log.debug(`[Cygwin] registry entry found but does not exist at '${path}'`)\n    }\n  }\n\n  return null\n}\n\nexport function launch(\n  foundShell: IFoundShell<Shell>,\n  path: string\n): ChildProcess {\n  const shell = foundShell.shell\n\n  switch (shell) {\n    case Shell.PowerShell:\n      const psCommand = `\"Set-Location -LiteralPath '${path}'\"`\n      return spawn('START', ['powershell', '-NoExit', '-Command', psCommand], {\n        shell: true,\n        cwd: path,\n      })\n    case Shell.PowerShellCore:\n      const psCoreCommand = `\"Set-Location -LiteralPath '${path}'\"`\n      return spawn('START', ['pwsh', '-NoExit', '-Command', psCoreCommand], {\n        shell: true,\n        cwd: path,\n      })\n    case Shell.Hyper:\n      const hyperPath = `\"${foundShell.path}\"`\n      log.info(`launching ${shell} at path: ${hyperPath}`)\n      return spawn(hyperPath, [`\"${path}\"`], {\n        shell: true,\n        cwd: path,\n      })\n    case Shell.GitBash:\n      const gitBashPath = `\"${foundShell.path}\"`\n      log.info(`launching ${shell} at path: ${gitBashPath}`)\n      return spawn(gitBashPath, [`--cd=\"${path}\"`], {\n        shell: true,\n        cwd: path,\n      })\n    case Shell.Cygwin:\n      const cygwinPath = `\"${foundShell.path}\"`\n      log.info(`launching ${shell} at path: ${cygwinPath}`)\n      return spawn(\n        cygwinPath,\n        [`/bin/sh -lc 'cd \"$(cygpath \"${path}\")\"; exec bash`],\n        {\n          shell: true,\n          cwd: path,\n        }\n      )\n    case Shell.Cmd:\n      return spawn('START', ['cmd'], { shell: true, cwd: path })\n    default:\n      return assertNever(shell, `Unknown shell: ${shell}`)\n  }\n}\n","import { spawn, ChildProcess } from 'child_process'\nimport { assertNever } from '../fatal-error'\nimport { IFoundShell } from './found-shell'\n\nconst appPath: (bundleId: string) => Promise<string> = require('app-path')\n\nexport enum Shell {\n  Terminal = 'Terminal',\n  Hyper = 'Hyper',\n  iTerm2 = 'iTerm2',\n  PowerShellCore = 'PowerShell Core',\n}\n\nexport const Default = Shell.Terminal\n\nexport function parse(label: string): Shell {\n  if (label === Shell.Terminal) {\n    return Shell.Terminal\n  }\n\n  if (label === Shell.Hyper) {\n    return Shell.Hyper\n  }\n\n  if (label === Shell.iTerm2) {\n    return Shell.iTerm2\n  }\n\n  if (label === Shell.PowerShellCore) {\n    return Shell.PowerShellCore\n  }\n\n  return Default\n}\n\nfunction getBundleID(shell: Shell): string {\n  switch (shell) {\n    case Shell.Terminal:\n      return 'com.apple.Terminal'\n    case Shell.iTerm2:\n      return 'com.googlecode.iterm2'\n    case Shell.Hyper:\n      return 'co.zeit.hyper'\n    case Shell.PowerShellCore:\n      return 'com.microsoft.powershell'\n    default:\n      return assertNever(shell, `Unknown shell: ${shell}`)\n  }\n}\n\nasync function getShellPath(shell: Shell): Promise<string | null> {\n  const bundleId = getBundleID(shell)\n  try {\n    return await appPath(bundleId)\n  } catch (e) {\n    // `appPath` will raise an error if it cannot find the program.\n    return null\n  }\n}\n\nexport async function getAvailableShells(): Promise<\n  ReadonlyArray<IFoundShell<Shell>>\n> {\n  const [\n    terminalPath,\n    hyperPath,\n    iTermPath,\n    powerShellCorePath,\n  ] = await Promise.all([\n    getShellPath(Shell.Terminal),\n    getShellPath(Shell.Hyper),\n    getShellPath(Shell.iTerm2),\n    getShellPath(Shell.PowerShellCore),\n  ])\n\n  const shells: Array<IFoundShell<Shell>> = []\n  if (terminalPath) {\n    shells.push({ shell: Shell.Terminal, path: terminalPath })\n  }\n\n  if (hyperPath) {\n    shells.push({ shell: Shell.Hyper, path: hyperPath })\n  }\n\n  if (iTermPath) {\n    shells.push({ shell: Shell.iTerm2, path: iTermPath })\n  }\n\n  if (powerShellCorePath) {\n    shells.push({ shell: Shell.PowerShellCore, path: powerShellCorePath })\n  }\n\n  return shells\n}\n\nexport function launch(\n  foundShell: IFoundShell<Shell>,\n  path: string\n): ChildProcess {\n  const bundleID = getBundleID(foundShell.shell)\n  const commandArgs = ['-b', bundleID, path]\n  return spawn('open', commandArgs)\n}\n","import { ChildProcess } from 'child_process'\nimport { pathExists } from 'fs-extra'\n\nimport * as Darwin from './darwin'\nimport * as Win32 from './win32'\nimport * as Linux from './linux'\nimport { IFoundShell } from './found-shell'\nimport { ShellError } from './error'\n\nexport type Shell = Darwin.Shell | Win32.Shell | Linux.Shell\n\nexport type FoundShell = IFoundShell<Shell>\n\n/** The default shell. */\nexport const Default = (function() {\n  if (__DARWIN__) {\n    return Darwin.Default\n  } else if (__WIN32__) {\n    return Win32.Default\n  } else {\n    return Linux.Default\n  }\n})()\n\nlet shellCache: ReadonlyArray<FoundShell> | null = null\n\n/** Parse the label into the specified shell type. */\nexport function parse(label: string): Shell {\n  if (__DARWIN__) {\n    return Darwin.parse(label)\n  } else if (__WIN32__) {\n    return Win32.parse(label)\n  } else if (__LINUX__) {\n    return Linux.parse(label)\n  }\n\n  throw new Error(\n    `Platform not currently supported for resolving shells: ${process.platform}`\n  )\n}\n\n/** Get the shells available for the user. */\nexport async function getAvailableShells(): Promise<ReadonlyArray<FoundShell>> {\n  if (shellCache) {\n    return shellCache\n  }\n\n  if (__DARWIN__) {\n    shellCache = await Darwin.getAvailableShells()\n    return shellCache\n  } else if (__WIN32__) {\n    shellCache = await Win32.getAvailableShells()\n    return shellCache\n  } else if (__LINUX__) {\n    shellCache = await Linux.getAvailableShells()\n    return shellCache\n  }\n\n  return Promise.reject(\n    `Platform not currently supported for resolving shells: ${process.platform}`\n  )\n}\n\n/** Find the given shell or the default if the given shell can't be found. */\nexport async function findShellOrDefault(shell: Shell): Promise<FoundShell> {\n  const available = await getAvailableShells()\n  const found = available.find(s => s.shell === shell)\n  if (found) {\n    return found\n  } else {\n    return available.find(s => s.shell === Default)!\n  }\n}\n\n/** Launch the given shell at the path. */\nexport async function launchShell(\n  shell: FoundShell,\n  path: string,\n  onError: (error: Error) => void\n): Promise<void> {\n  // We have to manually cast the wider `Shell` type into the platform-specific\n  // type. This is less than ideal, but maybe the best we can do without\n  // platform-specific build targets.\n  const exists = await pathExists(shell.path)\n  if (!exists) {\n    const label = __DARWIN__ ? 'Preferences' : 'Options'\n    throw new ShellError(\n      `Could not find executable for '${shell.shell}' at path '${\n        shell.path\n      }'.  Please open ${label} and select an available shell.`\n    )\n  }\n\n  let cp: ChildProcess | null = null\n\n  if (__DARWIN__) {\n    cp = Darwin.launch(shell as IFoundShell<Darwin.Shell>, path)\n  } else if (__WIN32__) {\n    cp = Win32.launch(shell as IFoundShell<Win32.Shell>, path)\n  } else if (__LINUX__) {\n    cp = Linux.launch(shell as IFoundShell<Linux.Shell>, path)\n  }\n\n  if (cp != null) {\n    addErrorTracing(shell.shell, cp, onError)\n    return Promise.resolve()\n  } else {\n    return Promise.reject(\n      `Platform not currently supported for launching shells: ${\n        process.platform\n      }`\n    )\n  }\n}\n\nfunction addErrorTracing(\n  shell: Shell,\n  cp: ChildProcess,\n  onError: (error: Error) => void\n) {\n  cp.stderr.on('data', chunk => {\n    const text = chunk instanceof Buffer ? chunk.toString() : chunk\n    log.debug(`[${shell}] stderr: '${text}'`)\n  })\n\n  cp.on('error', err => {\n    log.debug(`[${shell}] an error was encountered`, err)\n    onError(err)\n  })\n\n  cp.on('exit', code => {\n    if (code !== 0) {\n      log.debug(`[${shell}] exit code: ${code}`)\n    }\n  })\n}\n","import { MenuIDs } from '../main-process/menu'\nimport { merge } from './merge'\nimport { IAppState, SelectionType } from '../lib/app-state'\nimport { Repository } from '../models/repository'\nimport { CloningRepository } from '../models/cloning-repository'\nimport { TipState } from '../models/tip'\nimport { updateMenuState as ipcUpdateMenuState } from '../ui/main-process-proxy'\nimport { AppMenu, MenuItem } from '../models/app-menu'\n\nexport interface IMenuItemState {\n  readonly enabled?: boolean\n}\n\n/**\n * Utility class for coalescing updates to menu items\n */\nclass MenuStateBuilder {\n  private readonly _state: Map<MenuIDs, IMenuItemState>\n\n  public constructor(state: Map<MenuIDs, IMenuItemState> = new Map()) {\n    this._state = state\n  }\n\n  /**\n   * Returns an Map where each key is a MenuID and the values\n   * are IMenuItemState instances containing information about\n   * whether a particular menu item should be enabled/disabled or\n   * visible/hidden.\n   */\n  public get state() {\n    return new Map<MenuIDs, IMenuItemState>(this._state)\n  }\n\n  private updateMenuItem<K extends keyof IMenuItemState>(\n    id: MenuIDs,\n    state: Pick<IMenuItemState, K>\n  ) {\n    const currentState = this._state.get(id) || {}\n    this._state.set(id, merge(currentState, state))\n  }\n\n  /** Set the state of the given menu item id to enabled */\n  public enable(id: MenuIDs): this {\n    this.updateMenuItem(id, { enabled: true })\n    return this\n  }\n\n  /** Set the state of the given menu item id to disabled */\n  public disable(id: MenuIDs): this {\n    this.updateMenuItem(id, { enabled: false })\n    return this\n  }\n\n  /** Set the enabledness of the given menu item id */\n  public setEnabled(id: MenuIDs, enabled: boolean): this {\n    this.updateMenuItem(id, { enabled })\n    return this\n  }\n\n  /**\n   * Create a new state builder by merging the current state with the state from\n   * the other state builder. This will replace values in `this` with values\n   * from `other`.\n   */\n  public merge(other: MenuStateBuilder): MenuStateBuilder {\n    const merged = new Map<MenuIDs, IMenuItemState>(this._state)\n    for (const [key, value] of other._state) {\n      merged.set(key, value)\n    }\n    return new MenuStateBuilder(merged)\n  }\n}\n\nfunction isRepositoryHostedOnGitHub(\n  repository: Repository | CloningRepository\n) {\n  if (\n    !repository ||\n    repository instanceof CloningRepository ||\n    !repository.gitHubRepository\n  ) {\n    return false\n  }\n\n  return repository.gitHubRepository.htmlURL !== null\n}\n\nfunction menuItemStateEqual(state: IMenuItemState, menuItem: MenuItem) {\n  if (\n    state.enabled !== undefined &&\n    menuItem.type !== 'separator' &&\n    menuItem.enabled !== state.enabled\n  ) {\n    return false\n  }\n\n  return true\n}\n\nconst allMenuIds: ReadonlyArray<MenuIDs> = [\n  'rename-branch',\n  'delete-branch',\n  'preferences',\n  'update-branch',\n  'compare-to-branch',\n  'merge-branch',\n  'view-repository-on-github',\n  'compare-on-github',\n  'open-in-shell',\n  'push',\n  'pull',\n  'branch',\n  'repository',\n  'create-branch',\n  'show-changes',\n  'show-history',\n  'show-repository-list',\n  'show-branches-list',\n  'open-working-directory',\n  'show-repository-settings',\n  'open-external-editor',\n  'remove-repository',\n  'new-repository',\n  'add-local-repository',\n  'clone-repository',\n  'about',\n  'create-pull-request',\n]\n\nfunction getAllMenusDisabledBuilder(): MenuStateBuilder {\n  const menuStateBuilder = new MenuStateBuilder()\n\n  for (const menuId of allMenuIds) {\n    menuStateBuilder.disable(menuId)\n  }\n\n  return menuStateBuilder\n}\n\nfunction getRepositoryMenuBuilder(state: IAppState): MenuStateBuilder {\n  const selectedState = state.selectedState\n  const isHostedOnGitHub = selectedState\n    ? isRepositoryHostedOnGitHub(selectedState.repository)\n    : false\n\n  let repositorySelected = false\n  let onNonDefaultBranch = false\n  let onBranch = false\n  let onDetachedHead = false\n  let hasDefaultBranch = false\n  let hasPublishedBranch = false\n  let networkActionInProgress = false\n  let tipStateIsUnknown = false\n  let branchIsUnborn = false\n\n  let hasRemote = false\n\n  if (selectedState && selectedState.type === SelectionType.Repository) {\n    repositorySelected = true\n\n    const branchesState = selectedState.state.branchesState\n    const tip = branchesState.tip\n    const defaultBranch = branchesState.defaultBranch\n\n    hasDefaultBranch = Boolean(defaultBranch)\n\n    onBranch = tip.kind === TipState.Valid\n    onDetachedHead = tip.kind === TipState.Detached\n    tipStateIsUnknown = tip.kind === TipState.Unknown\n    branchIsUnborn = tip.kind === TipState.Unborn\n\n    // If we are:\n    //  1. on the default branch, or\n    //  2. on an unborn branch, or\n    //  3. on a detached HEAD\n    // there's not much we can do.\n    if (tip.kind === TipState.Valid) {\n      if (defaultBranch !== null) {\n        onNonDefaultBranch = tip.branch.name !== defaultBranch.name\n      }\n\n      hasPublishedBranch = !!tip.branch.upstream\n    } else {\n      onNonDefaultBranch = true\n    }\n\n    hasRemote = !!selectedState.state.remote\n\n    networkActionInProgress = selectedState.state.isPushPullFetchInProgress\n  }\n\n  // These are IDs for menu items that are entirely _and only_\n  // repository-scoped. They're always enabled if we're in a repository and\n  // always disabled if we're not.\n  const repositoryScopedIDs: ReadonlyArray<MenuIDs> = [\n    'branch',\n    'repository',\n    'remove-repository',\n    'open-in-shell',\n    'open-working-directory',\n    'show-repository-settings',\n    'show-changes',\n    'show-history',\n    'show-branches-list',\n    'open-external-editor',\n    'compare-to-branch',\n  ]\n\n  const menuStateBuilder = new MenuStateBuilder()\n\n  const windowOpen = state.windowState !== 'hidden'\n  const inWelcomeFlow = state.showWelcomeFlow\n  const repositoryActive = windowOpen && repositorySelected && !inWelcomeFlow\n\n  if (repositoryActive) {\n    for (const id of repositoryScopedIDs) {\n      menuStateBuilder.enable(id)\n    }\n\n    menuStateBuilder.setEnabled(\n      'rename-branch',\n      onNonDefaultBranch && !branchIsUnborn && !onDetachedHead\n    )\n    menuStateBuilder.setEnabled(\n      'delete-branch',\n      onNonDefaultBranch && !branchIsUnborn && !onDetachedHead\n    )\n    menuStateBuilder.setEnabled(\n      'update-branch',\n      onNonDefaultBranch && hasDefaultBranch && !onDetachedHead\n    )\n    menuStateBuilder.setEnabled('merge-branch', onBranch)\n    menuStateBuilder.setEnabled(\n      'compare-on-github',\n      isHostedOnGitHub && hasPublishedBranch\n    )\n\n    menuStateBuilder.setEnabled('view-repository-on-github', isHostedOnGitHub)\n    menuStateBuilder.setEnabled(\n      'create-pull-request',\n      isHostedOnGitHub && !branchIsUnborn && !onDetachedHead\n    )\n    menuStateBuilder.setEnabled(\n      'push',\n      hasRemote && !branchIsUnborn && !networkActionInProgress\n    )\n    menuStateBuilder.setEnabled(\n      'pull',\n      hasPublishedBranch && !networkActionInProgress\n    )\n    menuStateBuilder.setEnabled(\n      'create-branch',\n      !tipStateIsUnknown && !branchIsUnborn\n    )\n\n    menuStateBuilder.setEnabled('compare-to-branch', !onDetachedHead)\n\n    if (\n      selectedState &&\n      selectedState.type === SelectionType.MissingRepository\n    ) {\n      menuStateBuilder.disable('open-external-editor')\n    }\n  } else {\n    for (const id of repositoryScopedIDs) {\n      menuStateBuilder.disable(id)\n    }\n\n    menuStateBuilder.disable('view-repository-on-github')\n    menuStateBuilder.disable('create-pull-request')\n\n    if (\n      selectedState &&\n      selectedState.type === SelectionType.MissingRepository\n    ) {\n      if (selectedState.repository.gitHubRepository) {\n        menuStateBuilder.enable('view-repository-on-github')\n      }\n      menuStateBuilder.enable('remove-repository')\n    }\n\n    menuStateBuilder.disable('create-branch')\n    menuStateBuilder.disable('rename-branch')\n    menuStateBuilder.disable('delete-branch')\n    menuStateBuilder.disable('update-branch')\n    menuStateBuilder.disable('merge-branch')\n\n    menuStateBuilder.disable('push')\n    menuStateBuilder.disable('pull')\n    menuStateBuilder.disable('compare-to-branch')\n  }\n  return menuStateBuilder\n}\n\nfunction getMenuState(state: IAppState): Map<MenuIDs, IMenuItemState> {\n  if (state.currentPopup) {\n    return getAllMenusDisabledBuilder().state\n  }\n\n  return getAllMenusEnabledBuilder()\n    .merge(getRepositoryMenuBuilder(state))\n    .merge(getInWelcomeFlowBuilder(state.showWelcomeFlow)).state\n}\n\nfunction getAllMenusEnabledBuilder(): MenuStateBuilder {\n  const menuStateBuilder = new MenuStateBuilder()\n  for (const menuId of allMenuIds) {\n    menuStateBuilder.enable(menuId)\n  }\n  return menuStateBuilder\n}\n\nfunction getInWelcomeFlowBuilder(inWelcomeFlow: boolean): MenuStateBuilder {\n  const welcomeScopedIds: ReadonlyArray<MenuIDs> = [\n    'new-repository',\n    'add-local-repository',\n    'clone-repository',\n    'preferences',\n    'about',\n  ]\n\n  const menuStateBuilder = new MenuStateBuilder()\n  if (inWelcomeFlow) {\n    for (const id of welcomeScopedIds) {\n      menuStateBuilder.disable(id)\n    }\n  } else {\n    for (const id of welcomeScopedIds) {\n      menuStateBuilder.enable(id)\n    }\n  }\n\n  return menuStateBuilder\n}\n\n/**\n * Update the menu state in the main process.\n *\n * This function will set the enabledness and visibility of menu items\n * in the main process based on the AppState. All changes will be\n * batched together into one ipc message.\n */\nexport function updateMenuState(\n  state: IAppState,\n  currentAppMenu: AppMenu | null\n) {\n  const menuState = getMenuState(state)\n\n  // Try to avoid updating sending the IPC message at all\n  // if we have a current app menu that we can compare against.\n  if (currentAppMenu) {\n    for (const [id, menuItemState] of menuState.entries()) {\n      const appMenuItem = currentAppMenu.getItemById(id)\n\n      if (appMenuItem && menuItemStateEqual(menuItemState, appMenuItem)) {\n        menuState.delete(id)\n      }\n    }\n  }\n\n  if (menuState.size === 0) {\n    return\n  }\n\n  // because we can't send Map over the wire, we need to convert\n  // the remaining entries into an array that can be serialized\n  const array = new Array<{ id: MenuIDs; state: IMenuItemState }>()\n  menuState.forEach((value, key) => array.push({ id: key, state: value }))\n  ipcUpdateMenuState(array)\n}\n","import { GitStore } from './stores'\nimport { Repository } from '../models/repository'\nimport { Account } from '../models/account'\nimport { getAccountForRepository } from './get-account-for-repository'\nimport { API } from './api'\nimport { matchGitHubRepository } from './repository-matching'\n\n/**\n * Use the GitHub API to find the last push date for a repository, favouring\n * the current remote (if defined) or falling back to the detected GitHub remote\n * if no tracking information set for the current branch.\n *\n * Returns null if no date can be detected.\n *\n * @param accounts available accounts in the app\n * @param gitStore Git information about the repository\n * @param repository the local repository tracked by Desktop\n */\nexport async function inferLastPushForRepository(\n  accounts: ReadonlyArray<Account>,\n  gitStore: GitStore,\n  repository: Repository\n): Promise<Date | null> {\n  const account = getAccountForRepository(accounts, repository)\n  if (account == null) {\n    return null\n  }\n\n  await gitStore.loadRemotes()\n\n  const api = API.fromAccount(account)\n  let lastPushDate: Date | null = null\n  if (gitStore.remote !== null) {\n    const matchedRepository = matchGitHubRepository(\n      accounts,\n      gitStore.remote.url\n    )\n\n    if (matchedRepository !== null) {\n      const { owner, name } = matchedRepository\n      const repo = await api.fetchRepository(owner, name)\n\n      if (repo !== null) {\n        lastPushDate = new Date(repo.pushed_at)\n      }\n    }\n  }\n\n  if (repository.gitHubRepository !== null) {\n    const { owner, name } = repository.gitHubRepository\n    const repo = await api.fetchRepository(owner.login, name)\n\n    if (repo !== null) {\n      lastPushDate = new Date(repo.pushed_at)\n    }\n  }\n\n  await gitStore.updateLastFetched()\n\n  return lastPushDate\n}\n","import { git } from './core'\nimport { Repository } from '../../models/repository'\n\n/** Install the global LFS filters. */\nexport async function installGlobalLFSFilters(force: boolean): Promise<void> {\n  const args = ['lfs', 'install', '--skip-repo']\n  if (force) {\n    args.push('--force')\n  }\n\n  await git(args, __dirname, 'installGlobalLFSFilter')\n}\n\n/** Install LFS hooks in the repository. */\nexport async function installLFSHooks(\n  repository: Repository,\n  force: boolean\n): Promise<void> {\n  const args = ['lfs', 'install']\n  if (force) {\n    args.push('--force')\n  }\n\n  await git(args, repository.path, 'installLFSHooks')\n}\n\n/** Is the repository configured to track any paths with LFS? */\nexport async function isUsingLFS(repository: Repository): Promise<boolean> {\n  const env = {\n    GIT_LFS_TRACK_NO_INSTALL_HOOKS: '1',\n  }\n  const result = await git(['lfs', 'track'], repository.path, 'isUsingLFS', {\n    env,\n  })\n  return result.stdout.length > 0\n}\n","const path = require('path');const filePath = path.join(__dirname, \"keytar.node\");try { global.process.dlopen(module, filePath); } catch(exception) { throw new Error('Cannot open ' + filePath + ': ' + exception); }","var keytar = require('../build/Release/keytar.node')\n\nfunction checkRequired(val, name) {\n  if (!val || val.length <= 0) {\n    throw new Error(name + ' is required.');\n  }\n}\n\nfunction callbackPromise(callback) {\n  if (typeof callback === 'function') {\n    return new Promise(function(resolve, reject) {\n      callback((err, val) => {\n        if (err) {\n          reject(err)\n        } else {\n          resolve(val)\n        }\n      })\n    })\n  } else {\n    throw new Error('Callback required')\n  }\n}\n\nmodule.exports = {\n  getPassword: function (service, account) {\n    checkRequired(service, 'Service')\n    checkRequired(account, 'Account')\n\n    return callbackPromise(callback => keytar.getPassword(service, account, callback))\n  },\n\n  setPassword: function (service, account, password) {\n    checkRequired(service, 'Service')\n    checkRequired(account, 'Account')\n    checkRequired(password, 'Password')\n\n    return callbackPromise(callback => keytar.setPassword(service, account, password, callback))\n  },\n\n  deletePassword: function (service, account) {\n    checkRequired(service, 'Service')\n    checkRequired(account, 'Account')\n\n    return callbackPromise(callback => keytar.deletePassword(service, account, callback))\n  },\n\n  findPassword: function (service) {\n    checkRequired(service, 'Service')\n\n    return callbackPromise(callback => keytar.findPassword(service, callback))\n  }\n}\n","import { spawn } from 'child_process'\nimport { pathExists } from 'fs-extra'\nimport { ExternalEditorError, FoundEditor } from './shared'\n\n/**\n * Open a given file or folder in the desired external editor.\n *\n * @param fullPath A folder or file path to pass as an argument when launching the editor.\n * @param editor The external editor to launch.\n */\nexport async function launchExternalEditor(\n  fullPath: string,\n  editor: FoundEditor\n): Promise<void> {\n  const editorPath = editor.path\n  const exists = await pathExists(editorPath)\n  if (!exists) {\n    const label = __DARWIN__ ? 'Preferences' : 'Options'\n    throw new ExternalEditorError(\n      `Could not find executable for '${editor.editor}' at path '${\n        editor.path\n      }'.  Please open ${label} and select an available editor.`,\n      { openPreferences: true }\n    )\n  }\n\n  spawn(editorPath, [fullPath])\n}\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst nativeModule = process.platform === 'win32'\r\n    ? require('../../build/Release/registry.node')\r\n    : null;\r\n/**\r\n * Utility function used to achieve exhaustive type checks at compile time.\r\n *\r\n * If the type system is bypassed or this method will throw an exception\r\n * using the second parameter as the message.\r\n *\r\n * @param {x}       Placeholder parameter in order to leverage the type\r\n *                  system. Pass the variable which has been type narrowed\r\n *                  in an exhaustive check.\r\n *\r\n * @param {message} The message to be used in the runtime exception.\r\n *\r\n */\r\nfunction assertNever(x, message) {\r\n    throw new Error(message);\r\n}\r\n/**\r\n * Note: not all of these are currently implemented.\r\n *\r\n * Source: https://msdn.microsoft.com/en-us/library/windows/desktop/ms724884(v=vs.85).aspx\r\n */\r\nvar RegistryValueType;\r\n(function (RegistryValueType) {\r\n    RegistryValueType[\"REG_BINARY\"] = \"REG_BINARY\";\r\n    RegistryValueType[\"REG_DWORD\"] = \"REG_DWORD\";\r\n    RegistryValueType[\"REG_DWORD_LITTLE_ENDIAN\"] = \"REG_DWORD_LITTLE_ENDIAN\";\r\n    RegistryValueType[\"REG_DWORD_BIG_ENDIAN\"] = \"REG_DWORD_BIG_ENDIAN\";\r\n    RegistryValueType[\"REG_EXPAND_SZ\"] = \"REG_EXPAND_SZ\";\r\n    RegistryValueType[\"REG_LINK\"] = \"REG_LINK\";\r\n    RegistryValueType[\"REG_MULTI_SZ\"] = \"REG_MULTI_SZ\";\r\n    RegistryValueType[\"REG_NONE\"] = \"REG_NONE\";\r\n    RegistryValueType[\"REG_QWORD\"] = \"REG_QWORD\";\r\n    RegistryValueType[\"REG_QWORD_LITTLE_ENDIAN\"] = \"REG_QWORD_LITTLE_ENDIAN\";\r\n    RegistryValueType[\"REG_SZ\"] = \"REG_SZ\";\r\n})(RegistryValueType = exports.RegistryValueType || (exports.RegistryValueType = {}));\r\nvar HKEY;\r\n(function (HKEY) {\r\n    HKEY[\"HKEY_CLASSES_ROOT\"] = \"HKEY_CLASSES_ROOT\";\r\n    HKEY[\"HKEY_CURRENT_CONFIG\"] = \"HKEY_CURRENT_CONFIG\";\r\n    HKEY[\"HKEY_DYN_DATA\"] = \"HKEY_DYN_DATA\";\r\n    HKEY[\"HKEY_CURRENT_USER_LOCAL_SETTINGS\"] = \"HKEY_CURRENT_USER_LOCAL_SETTINGS\";\r\n    HKEY[\"HKEY_CURRENT_USER\"] = \"HKEY_CURRENT_USER\";\r\n    HKEY[\"HKEY_LOCAL_MACHINE\"] = \"HKEY_LOCAL_MACHINE\";\r\n    HKEY[\"HKEY_PERFORMANCE_DATA\"] = \"HKEY_PERFORMANCE_DATA\";\r\n    HKEY[\"HKEY_PERFORMANCE_TEXT\"] = \"HKEY_PERFORMANCE_TEXT\";\r\n    HKEY[\"HKEY_PERFORMANCE_NLSTEXT\"] = \"HKEY_PERFORMANCE_NLSTEXT\";\r\n    HKEY[\"HKEY_USERS\"] = \"HKEY_USERS\";\r\n})(HKEY = exports.HKEY || (exports.HKEY = {}));\r\nfunction mapToLong(key) {\r\n    if (key === HKEY.HKEY_CLASSES_ROOT)\r\n        return 0x80000000;\r\n    if (key === HKEY.HKEY_CURRENT_USER)\r\n        return 0x80000001;\r\n    if (key === HKEY.HKEY_LOCAL_MACHINE)\r\n        return 0x80000002;\r\n    if (key === HKEY.HKEY_USERS)\r\n        return 0x80000003;\r\n    if (key === HKEY.HKEY_PERFORMANCE_DATA)\r\n        return 0x80000004;\r\n    if (key === HKEY.HKEY_CURRENT_CONFIG)\r\n        return 0x80000005;\r\n    if (key === HKEY.HKEY_DYN_DATA)\r\n        return 0x80000006;\r\n    if (key === HKEY.HKEY_CURRENT_USER_LOCAL_SETTINGS)\r\n        return 0x80000007;\r\n    if (key === HKEY.HKEY_PERFORMANCE_TEXT)\r\n        return 0x80000050;\r\n    if (key === HKEY.HKEY_PERFORMANCE_NLSTEXT)\r\n        return 0x80000060;\r\n    return assertNever(key, 'The key does not map to an expected number value');\r\n}\r\nfunction enumerateValues(key, subkey) {\r\n    if (!nativeModule) {\r\n        // this code is a no-op when the module is missing\r\n        return [];\r\n    }\r\n    const hkey = mapToLong(key);\r\n    const result = nativeModule.readValues(hkey, subkey);\r\n    return result;\r\n}\r\nexports.enumerateValues = enumerateValues;\r\nfunction enumerateValuesSafe(key, subkey) {\r\n    try {\r\n        return enumerateValues(key, subkey);\r\n    }\r\n    catch (_a) {\r\n        return [];\r\n    }\r\n}\r\nexports.enumerateValuesSafe = enumerateValuesSafe;\r\n//# sourceMappingURL=registry.js.map","module.exports = require(\"querystring\");","import { ipcRenderer, remote } from 'electron'\nimport { pathExists } from 'fs-extra'\nimport { escape } from 'querystring'\nimport {\n  AccountsStore,\n  CloningRepositoriesStore,\n  GitHubUserStore,\n  GitStore,\n  ICommitMessage,\n  IssuesStore,\n  PullRequestStore,\n  RepositoriesStore,\n  SignInStore,\n} from '.'\nimport { Account } from '../../models/account'\nimport { AppMenu, IMenu } from '../../models/app-menu'\nimport { IAuthor } from '../../models/author'\nimport {\n  Branch,\n  eligibleForFastForward,\n  IAheadBehind,\n} from '../../models/branch'\nimport { BranchesTab } from '../../models/branches-tab'\nimport { CloneRepositoryTab } from '../../models/clone-repository-tab'\nimport { CloningRepository } from '../../models/cloning-repository'\nimport { Commit } from '../../models/commit'\nimport { DiffSelection, DiffSelectionType, DiffType } from '../../models/diff'\nimport { FetchType } from '../../models/fetch'\nimport { GitHubRepository } from '../../models/github-repository'\nimport { Owner } from '../../models/owner'\nimport { PullRequest } from '../../models/pull-request'\nimport { forkPullRequestRemoteName, IRemote } from '../../models/remote'\nimport {\n  ILocalRepositoryState,\n  nameOf,\n  Repository,\n} from '../../models/repository'\nimport {\n  CommittedFileChange,\n  WorkingDirectoryFileChange,\n  WorkingDirectoryStatus,\n  AppFileStatus,\n} from '../../models/status'\nimport { TipState } from '../../models/tip'\nimport { getAppPath } from '../../ui/lib/app-proxy'\nimport {\n  ApplicationTheme,\n  getPersistedTheme,\n  setPersistedTheme,\n} from '../../ui/lib/application-theme'\nimport {\n  getAppMenu,\n  updatePreferredAppMenuItemLabels,\n} from '../../ui/main-process-proxy'\nimport {\n  API,\n  getAccountForEndpoint,\n  getDotComAPIEndpoint,\n  getEnterpriseAPIURL,\n  IAPIUser,\n} from '../api'\nimport { shell } from '../app-shell'\nimport {\n  CompareAction,\n  CompareActionKind,\n  ComparisonView,\n  Foldout,\n  FoldoutType,\n  IAppState,\n  ICheckoutProgress,\n  ICompareBranch,\n  ICompareFormUpdate,\n  ICompareToBranch,\n  IDisplayHistory,\n  IFetchProgress,\n  ImageDiffType,\n  IRevertProgress,\n  Popup,\n  PopupType,\n  PossibleSelections,\n  Progress,\n  RepositorySectionTab,\n  SelectionType,\n  MergeResultStatus,\n} from '../app-state'\nimport { caseInsensitiveCompare } from '../compare'\nimport { IGitHubUser } from '../databases/github-user-database'\nimport {\n  ExternalEditor,\n  findEditorOrDefault,\n  getAvailableEditors,\n  launchExternalEditor,\n  parse,\n} from '../editors'\nimport { assertNever, fatalError, forceUnwrap } from '../fatal-error'\n\nimport { findAccountForRemoteURL } from '../find-account'\nimport { formatCommitMessage } from '../format-commit-message'\nimport { getGenericHostname, getGenericUsername } from '../generic-git-auth'\nimport { getAccountForRepository } from '../get-account-for-repository'\nimport {\n  addRemote,\n  checkoutBranch,\n  createBranch,\n  createCommit,\n  deleteBranch,\n  formatAsLocalRef,\n  getAuthorIdentity,\n  getBranchAheadBehind,\n  getChangedFiles,\n  getCommitDiff,\n  getMergeBase,\n  getRemotes,\n  getWorkingDirectoryDiff,\n  isCoAuthoredByTrailer,\n  mergeTree,\n  ITrailer,\n  pull as pullRepo,\n  push as pushRepo,\n  renameBranch,\n  updateRef,\n  saveGitIgnore,\n  appendIgnoreRule,\n  IStatusResult,\n} from '../git'\nimport { IGitAccount } from '../git/authentication'\nimport {\n  installGlobalLFSFilters,\n  installLFSHooks,\n  isUsingLFS,\n} from '../git/lfs'\nimport { inferLastPushForRepository } from '../infer-last-push-for-repository'\nimport { updateMenuState } from '../menu-update'\nimport { merge } from '../merge'\nimport {\n  IMatchedGitHubRepository,\n  matchGitHubRepository,\n  repositoryMatchesRemote,\n} from '../repository-matching'\nimport { RetryAction, RetryActionType } from '../retry-actions'\nimport {\n  Default as DefaultShell,\n  findShellOrDefault,\n  launchShell,\n  parse as parseShell,\n  Shell,\n} from '../shells'\nimport { ILaunchStats, StatsStore } from '../stats'\nimport { hasShownWelcomeFlow, markWelcomeFlowComplete } from '../welcome'\nimport { getWindowState, WindowState } from '../window-state'\nimport { TypedBaseStore } from './base-store'\nimport { AheadBehindUpdater } from './helpers/ahead-behind-updater'\nimport {\n  enableRepoInfoIndicators,\n  enableMergeConflictDetection,\n} from '../feature-flag'\nimport { MergeResultKind } from '../../models/merge'\nimport { promiseWithMinimumTimeout } from '../promise'\nimport { BackgroundFetcher } from './helpers/background-fetcher'\nimport { inferComparisonBranch } from './helpers/infer-comparison-branch'\nimport { PullRequestUpdater } from './helpers/pull-request-updater'\nimport { validatedRepositoryPath } from './helpers/validated-repository-path'\nimport { RepositoryStateCache } from './repository-state-cache'\nimport { readEmoji } from '../read-emoji'\n\n/**\n * As fast-forwarding local branches is proportional to the number of local\n * branches, and is run after every fetch/push/pull, this is skipped when the\n * number of eligible branches is greater than a given threshold.\n */\nconst FastForwardBranchesThreshold = 20\n\nconst LastSelectedRepositoryIDKey = 'last-selected-repository-id'\n\nconst defaultSidebarWidth: number = 250\nconst sidebarWidthConfigKey: string = 'sidebar-width'\n\nconst defaultCommitSummaryWidth: number = 250\nconst commitSummaryWidthConfigKey: string = 'commit-summary-width'\n\nconst confirmRepoRemovalDefault: boolean = true\nconst confirmDiscardChangesDefault: boolean = true\nconst confirmRepoRemovalKey: string = 'confirmRepoRemoval'\nconst confirmDiscardChangesKey: string = 'confirmDiscardChanges'\n\nconst externalEditorKey: string = 'externalEditor'\n\nconst imageDiffTypeDefault = ImageDiffType.TwoUp\nconst imageDiffTypeKey = 'image-diff-type'\n\nconst shellKey = 'shell'\n\n// background fetching should occur hourly when Desktop is active, but this\n// lower interval ensures user interactions like switching repositories and\n// switching between apps does not result in excessive fetching in the app\nconst BackgroundFetchMinimumInterval = 30 * 60 * 1000\n\nexport class AppStore extends TypedBaseStore<IAppState> {\n  private accounts: ReadonlyArray<Account> = new Array<Account>()\n  private repositories: ReadonlyArray<Repository> = new Array<Repository>()\n\n  private selectedRepository: Repository | CloningRepository | null = null\n\n  /** The background fetcher for the currently selected repository. */\n  private currentBackgroundFetcher: BackgroundFetcher | null = null\n\n  /** The pull request updater for the currently selected repository */\n  private currentPullRequestUpdater: PullRequestUpdater | null = null\n\n  /** The ahead/behind updater or the currently selected repository */\n  private currentAheadBehindUpdater: AheadBehindUpdater | null = null\n\n  private showWelcomeFlow = false\n  private currentPopup: Popup | null = null\n  private currentFoldout: Foldout | null = null\n  private errors: ReadonlyArray<Error> = new Array<Error>()\n  private emitQueued = false\n\n  /** GitStores keyed by their hash. */\n  private readonly gitStores = new Map<string, GitStore>()\n\n  private readonly localRepositoryStateLookup = new Map<\n    number,\n    ILocalRepositoryState\n  >()\n\n  /** Map from shortcut (e.g., :+1:) to on disk URL. */\n  private emoji = new Map<string, string>()\n\n  /**\n   * The Application menu as an AppMenu instance or null if\n   * the main process has not yet provided the renderer with\n   * a copy of the application menu structure.\n   */\n  private appMenu: AppMenu | null = null\n\n  /**\n   * Used to highlight access keys throughout the app when the\n   * Alt key is pressed. Only applicable on non-macOS platforms.\n   */\n  private highlightAccessKeys: boolean = false\n\n  /**\n   * A value indicating whether or not the current application\n   * window has focus.\n   */\n  private appIsFocused: boolean = false\n\n  private sidebarWidth: number = defaultSidebarWidth\n  private commitSummaryWidth: number = defaultCommitSummaryWidth\n  private windowState: WindowState\n  private windowZoomFactor: number = 1\n  private isUpdateAvailableBannerVisible: boolean = false\n  private confirmRepoRemoval: boolean = confirmRepoRemovalDefault\n  private confirmDiscardChanges: boolean = confirmDiscardChangesDefault\n  private imageDiffType: ImageDiffType = imageDiffTypeDefault\n\n  private selectedExternalEditor?: ExternalEditor\n\n  /** The user's preferred shell. */\n  private selectedShell = DefaultShell\n\n  /** The current repository filter text */\n  private repositoryFilterText: string = ''\n\n  private currentMergeTreePromise: Promise<void> | null = null\n\n  /** The function to resolve the current Open in Desktop flow. */\n  private resolveOpenInDesktop:\n    | ((repository: Repository | null) => void)\n    | null = null\n\n  private selectedCloneRepositoryTab = CloneRepositoryTab.DotCom\n\n  private selectedBranchesTab = BranchesTab.Branches\n  private selectedTheme = ApplicationTheme.Light\n\n  public constructor(\n    private readonly gitHubUserStore: GitHubUserStore,\n    private readonly cloningRepositoriesStore: CloningRepositoriesStore,\n    private readonly issuesStore: IssuesStore,\n    private readonly statsStore: StatsStore,\n    private readonly signInStore: SignInStore,\n    private readonly accountsStore: AccountsStore,\n    private readonly repositoriesStore: RepositoriesStore,\n    private readonly pullRequestStore: PullRequestStore,\n    private readonly repositoryStateCache: RepositoryStateCache\n  ) {\n    super()\n\n    this.showWelcomeFlow = !hasShownWelcomeFlow()\n\n    const window = remote.getCurrentWindow()\n    this.windowState = getWindowState(window)\n\n    window.webContents.getZoomFactor(factor => {\n      this.onWindowZoomFactorChanged(factor)\n    })\n\n    this.wireupIpcEventHandlers(window)\n    this.wireupStoreEventHandlers()\n    getAppMenu()\n  }\n\n  private wireupIpcEventHandlers(window: Electron.BrowserWindow) {\n    ipcRenderer.on(\n      'window-state-changed',\n      (event: Electron.IpcMessageEvent, args: any[]) => {\n        this.windowState = getWindowState(window)\n        this.emitUpdate()\n      }\n    )\n\n    ipcRenderer.on('zoom-factor-changed', (event: any, zoomFactor: number) => {\n      this.onWindowZoomFactorChanged(zoomFactor)\n    })\n\n    ipcRenderer.on(\n      'app-menu',\n      (event: Electron.IpcMessageEvent, { menu }: { menu: IMenu }) => {\n        this.setAppMenu(menu)\n      }\n    )\n  }\n\n  private wireupStoreEventHandlers() {\n    this.gitHubUserStore.onDidUpdate(() => {\n      this.emitUpdate()\n    })\n\n    this.cloningRepositoriesStore.onDidUpdate(() => {\n      this.emitUpdate()\n    })\n\n    this.cloningRepositoriesStore.onDidError(e => this.emitError(e))\n\n    this.signInStore.onDidAuthenticate((account, method) => {\n      this._addAccount(account)\n\n      if (this.showWelcomeFlow) {\n        this.statsStore.recordWelcomeWizardSignInMethod(method)\n      }\n    })\n    this.signInStore.onDidUpdate(() => this.emitUpdate())\n    this.signInStore.onDidError(error => this.emitError(error))\n\n    this.accountsStore.onDidUpdate(async () => {\n      const accounts = await this.accountsStore.getAll()\n      this.accounts = accounts\n      this.emitUpdate()\n    })\n    this.accountsStore.onDidError(error => this.emitError(error))\n\n    this.repositoriesStore.onDidUpdate(async () => {\n      this.repositories = await this.repositoriesStore.getAll()\n      this.updateRepositorySelectionAfterRepositoriesChanged()\n      this.emitUpdate()\n    })\n\n    this.pullRequestStore.onDidError(error => this.emitError(error))\n    this.pullRequestStore.onDidUpdate(gitHubRepository =>\n      this.onPullRequestStoreUpdated(gitHubRepository)\n    )\n  }\n\n  /** Load the emoji from disk. */\n  public loadEmoji() {\n    const rootDir = getAppPath()\n    readEmoji(rootDir)\n      .then(emoji => {\n        this.emoji = emoji\n        this.emitUpdate()\n      })\n      .catch(err => {\n        log.warn(`Unexpected issue when trying to read emoji into memory`, err)\n      })\n  }\n\n  protected emitUpdate() {\n    // If the window is hidden then we won't get an animation frame, but there\n    // may still be work we wanna do in response to the state change. So\n    // immediately emit the update.\n    if (this.windowState === 'hidden') {\n      this.emitUpdateNow()\n      return\n    }\n\n    if (this.emitQueued) {\n      return\n    }\n\n    this.emitQueued = true\n\n    window.requestAnimationFrame(() => {\n      this.emitUpdateNow()\n    })\n  }\n\n  private emitUpdateNow() {\n    this.emitQueued = false\n    const state = this.getState()\n\n    super.emitUpdate(state)\n    updateMenuState(state, this.appMenu)\n  }\n\n  /**\n   * Called when we have reason to suspect that the zoom factor\n   * has changed. Note that this doesn't necessarily mean that it\n   * has changed with regards to our internal state which is why\n   * we double check before emitting an update.\n   */\n  private onWindowZoomFactorChanged(zoomFactor: number) {\n    const current = this.windowZoomFactor\n    this.windowZoomFactor = zoomFactor\n\n    if (zoomFactor !== current) {\n      this.emitUpdate()\n    }\n  }\n\n  private getSelectedState(): PossibleSelections | null {\n    const repository = this.selectedRepository\n    if (!repository) {\n      return null\n    }\n\n    if (repository instanceof CloningRepository) {\n      const progress = this.cloningRepositoriesStore.getRepositoryState(\n        repository\n      )\n      if (!progress) {\n        return null\n      }\n\n      return {\n        type: SelectionType.CloningRepository,\n        repository,\n        progress,\n      }\n    }\n\n    if (repository.missing) {\n      return {\n        type: SelectionType.MissingRepository,\n        repository,\n      }\n    }\n\n    return {\n      type: SelectionType.Repository,\n      repository,\n      state: this.repositoryStateCache.get(repository),\n    }\n  }\n\n  public getState(): IAppState {\n    return {\n      accounts: this.accounts,\n      repositories: [\n        ...this.repositories,\n        ...this.cloningRepositoriesStore.repositories,\n      ],\n      localRepositoryStateLookup: this.localRepositoryStateLookup,\n      windowState: this.windowState,\n      windowZoomFactor: this.windowZoomFactor,\n      appIsFocused: this.appIsFocused,\n      selectedState: this.getSelectedState(),\n      signInState: this.signInStore.getState(),\n      currentPopup: this.currentPopup,\n      currentFoldout: this.currentFoldout,\n      errors: this.errors,\n      showWelcomeFlow: this.showWelcomeFlow,\n      emoji: this.emoji,\n      sidebarWidth: this.sidebarWidth,\n      commitSummaryWidth: this.commitSummaryWidth,\n      appMenuState: this.appMenu ? this.appMenu.openMenus : [],\n      titleBarStyle: this.showWelcomeFlow ? 'light' : 'dark',\n      highlightAccessKeys: this.highlightAccessKeys,\n      isUpdateAvailableBannerVisible: this.isUpdateAvailableBannerVisible,\n      askForConfirmationOnRepositoryRemoval: this.confirmRepoRemoval,\n      askForConfirmationOnDiscardChanges: this.confirmDiscardChanges,\n      selectedExternalEditor: this.selectedExternalEditor,\n      imageDiffType: this.imageDiffType,\n      selectedShell: this.selectedShell,\n      repositoryFilterText: this.repositoryFilterText,\n      selectedCloneRepositoryTab: this.selectedCloneRepositoryTab,\n      selectedBranchesTab: this.selectedBranchesTab,\n      selectedTheme: this.selectedTheme,\n    }\n  }\n\n  private onGitStoreUpdated(repository: Repository, gitStore: GitStore) {\n    this.repositoryStateCache.updateBranchesState(repository, () => ({\n      tip: gitStore.tip,\n      defaultBranch: gitStore.defaultBranch,\n      allBranches: gitStore.allBranches,\n      recentBranches: gitStore.recentBranches,\n    }))\n\n    this.repositoryStateCache.updateChangesState(repository, () => ({\n      commitMessage: gitStore.commitMessage,\n      contextualCommitMessage: gitStore.contextualCommitMessage,\n      showCoAuthoredBy: gitStore.showCoAuthoredBy,\n      coAuthors: gitStore.coAuthors,\n    }))\n\n    this.repositoryStateCache.update(repository, () => ({\n      commitLookup: gitStore.commitLookup,\n      localCommitSHAs: gitStore.localCommitSHAs,\n      aheadBehind: gitStore.aheadBehind,\n      remote: gitStore.remote,\n      lastFetched: gitStore.lastFetched,\n    }))\n\n    this.emitUpdate()\n  }\n\n  private removeGitStore(repository: Repository) {\n    if (this.gitStores.has(repository.hash)) {\n      this.gitStores.delete(repository.hash)\n    }\n  }\n\n  private getGitStore(repository: Repository): GitStore {\n    let gitStore = this.gitStores.get(repository.hash)\n    if (!gitStore) {\n      gitStore = new GitStore(repository, shell)\n      gitStore.onDidUpdate(() => this.onGitStoreUpdated(repository, gitStore!))\n      gitStore.onDidLoadNewCommits(commits =>\n        this.loadAndCacheUsers(repository, this.accounts, commits)\n      )\n      gitStore.onDidError(error => this.emitError(error))\n\n      this.gitStores.set(repository.hash, gitStore)\n    }\n\n    return gitStore\n  }\n\n  private clearSelectedCommit(repository: Repository) {\n    this.repositoryStateCache.update(repository, () => ({\n      commitSelection: {\n        sha: null,\n        file: null,\n        changedFiles: [],\n        diff: null,\n      },\n    }))\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _changeCommitSelection(\n    repository: Repository,\n    sha: string\n  ): Promise<void> {\n    this.repositoryStateCache.update(repository, state => {\n      const commitChanged = state.commitSelection.sha !== sha\n      const changedFiles = commitChanged\n        ? new Array<CommittedFileChange>()\n        : state.commitSelection.changedFiles\n      const file = commitChanged ? null : state.commitSelection.file\n      const commitSelection = { sha, file, diff: null, changedFiles }\n      return { commitSelection }\n    })\n\n    this.emitUpdate()\n  }\n\n  private updateOrSelectFirstCommit(\n    repository: Repository,\n    commitSHAs: ReadonlyArray<string>\n  ) {\n    const state = this.repositoryStateCache.get(repository)\n    let selectedSHA = state.commitSelection.sha\n    if (selectedSHA != null) {\n      const index = commitSHAs.findIndex(sha => sha === selectedSHA)\n      if (index < 0) {\n        // selected SHA is not in this list\n        // -> clear the selection in the app state\n        selectedSHA = null\n        this.clearSelectedCommit(repository)\n      }\n    }\n\n    if (selectedSHA == null && commitSHAs.length > 0) {\n      this._changeCommitSelection(repository, commitSHAs[0])\n      this._loadChangedFilesForCurrentSelection(repository)\n    }\n  }\n\n  private startAheadBehindUpdater(repository: Repository) {\n    if (this.currentAheadBehindUpdater != null) {\n      fatalError(\n        `An ahead/behind updater is already active and cannot start updating on ${\n          repository.name\n        }`\n      )\n\n      return\n    }\n\n    const updater = new AheadBehindUpdater(repository, aheadBehindCache => {\n      this.repositoryStateCache.updateCompareState(repository, () => ({\n        aheadBehindCache,\n      }))\n      this.emitUpdate()\n    })\n\n    this.currentAheadBehindUpdater = updater\n\n    this.currentAheadBehindUpdater.start()\n  }\n\n  private stopAheadBehindUpdate() {\n    const updater = this.currentAheadBehindUpdater\n\n    if (updater != null) {\n      updater.stop()\n      this.currentAheadBehindUpdater = null\n    }\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _initializeCompare(\n    repository: Repository,\n    initialAction?: CompareAction\n  ) {\n    log.debug('[AppStore] initializing compare state')\n\n    const state = this.repositoryStateCache.get(repository)\n\n    const { branchesState, compareState } = state\n    const { tip, currentPullRequest } = branchesState\n    const currentBranch = tip.kind === TipState.Valid ? tip.branch : null\n\n    const allBranches =\n      currentBranch != null\n        ? branchesState.allBranches.filter(b => b.name !== currentBranch.name)\n        : branchesState.allBranches\n    const recentBranches = currentBranch\n      ? branchesState.recentBranches.filter(b => b.name !== currentBranch.name)\n      : branchesState.recentBranches\n\n    const cachedDefaultBranch = branchesState.defaultBranch\n\n    // only include the default branch when comparing if the user is not on the default branch\n    // and it also exists in the repository\n    const defaultBranch =\n      currentBranch != null &&\n      cachedDefaultBranch != null &&\n      currentBranch.name !== cachedDefaultBranch.name\n        ? cachedDefaultBranch\n        : null\n\n    let inferredBranch: Branch | null = null\n    let aheadBehindOfInferredBranch: IAheadBehind | null = null\n    if (tip.kind === TipState.Valid && compareState.aheadBehindCache !== null) {\n      inferredBranch = await inferComparisonBranch(\n        repository,\n        allBranches,\n        currentPullRequest,\n        tip.branch,\n        getRemotes,\n        compareState.aheadBehindCache\n      )\n\n      if (inferredBranch !== null) {\n        aheadBehindOfInferredBranch = compareState.aheadBehindCache.get(\n          tip.branch.tip.sha,\n          inferredBranch.tip.sha\n        )\n      }\n    }\n\n    this.repositoryStateCache.updateCompareState(repository, () => ({\n      allBranches,\n      recentBranches,\n      defaultBranch,\n      inferredComparisonBranch: {\n        branch: inferredBranch,\n        aheadBehind: aheadBehindOfInferredBranch,\n      },\n    }))\n\n    if (inferredBranch !== null) {\n      const currentCount = getBehindOrDefault(aheadBehindOfInferredBranch)\n\n      const prevInferredBranchState =\n        state.compareState.inferredComparisonBranch\n\n      const previousCount = getBehindOrDefault(\n        prevInferredBranchState.aheadBehind\n      )\n\n      // we only want to show the banner when the the number\n      // commits behind has changed since the last it was visible\n      const countChanged = currentCount > 0 && previousCount !== currentCount\n      this._setDivergingBranchBannerVisibility(repository, countChanged)\n    } else {\n      this._setDivergingBranchBannerVisibility(repository, false)\n    }\n\n    const cachedState = compareState.formState\n    const action =\n      initialAction != null ? initialAction : getInitialAction(cachedState)\n    this._executeCompare(repository, action)\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _executeCompare(\n    repository: Repository,\n    action: CompareAction\n  ): Promise<void> {\n    const gitStore = this.getGitStore(repository)\n    const kind = action.kind\n\n    if (action.kind === CompareActionKind.History) {\n      const { tip } = gitStore\n\n      let currentSha: string | null = null\n\n      if (tip.kind === TipState.Valid) {\n        currentSha = tip.branch.tip.sha\n      } else if (tip.kind === TipState.Detached) {\n        currentSha = tip.currentSha\n      }\n\n      const { compareState } = this.repositoryStateCache.get(repository)\n      const { formState, commitSHAs } = compareState\n      const previousTip = compareState.tip\n\n      const tipIsUnchanged =\n        currentSha !== null &&\n        previousTip !== null &&\n        currentSha === previousTip\n\n      if (\n        tipIsUnchanged &&\n        formState.kind === ComparisonView.None &&\n        commitSHAs.length > 0\n      ) {\n        // don't refresh the history view here because we know nothing important\n        // has changed and we don't want to rebuild this state\n        return\n      }\n\n      // load initial group of commits for current branch\n      const commits = await gitStore.loadCommitBatch('HEAD')\n\n      if (commits === null) {\n        return\n      }\n\n      this.repositoryStateCache.updateCompareState(repository, () => ({\n        tip: currentSha,\n        formState: {\n          kind: ComparisonView.None,\n        },\n        commitSHAs: commits,\n        filterText: '',\n        showBranchList: false,\n      }))\n      this.updateOrSelectFirstCommit(repository, commits)\n\n      return this.emitUpdate()\n    }\n\n    if (action.kind === CompareActionKind.Branch) {\n      return this.updateCompareToBranch(repository, action)\n    }\n\n    return assertNever(action, `Unknown action: ${kind}`)\n  }\n\n  private async updateCompareToBranch(\n    repository: Repository,\n    action: ICompareToBranch\n  ) {\n    const gitStore = this.getGitStore(repository)\n\n    const comparisonBranch = action.branch\n    const compare = await gitStore.getCompareCommits(\n      comparisonBranch,\n      action.mode\n    )\n\n    this.statsStore.recordBranchComparison()\n    const { branchesState } = this.repositoryStateCache.get(repository)\n\n    if (\n      branchesState.defaultBranch !== null &&\n      comparisonBranch.name === branchesState.defaultBranch.name\n    ) {\n      this.statsStore.recordDefaultBranchComparison()\n    }\n\n    if (compare == null) {\n      return\n    }\n\n    const { ahead, behind } = compare\n    const aheadBehind = { ahead, behind }\n\n    const commitSHAs = compare.commits.map(commit => commit.sha)\n\n    this.repositoryStateCache.updateCompareState(repository, s => ({\n      formState: {\n        comparisonBranch,\n        kind: action.mode,\n        aheadBehind,\n      },\n      filterText: comparisonBranch.name,\n      commitSHAs,\n    }))\n\n    const tip = gitStore.tip\n\n    let currentSha: string | null = null\n\n    if (tip.kind === TipState.Valid) {\n      currentSha = tip.branch.tip.sha\n    } else if (tip.kind === TipState.Detached) {\n      currentSha = tip.currentSha\n    }\n\n    if (this.currentAheadBehindUpdater != null && currentSha != null) {\n      const from =\n        action.mode === ComparisonView.Ahead\n          ? comparisonBranch.tip.sha\n          : currentSha\n      const to =\n        action.mode === ComparisonView.Ahead\n          ? currentSha\n          : comparisonBranch.tip.sha\n\n      this.currentAheadBehindUpdater.insert(from, to, aheadBehind)\n    }\n\n    if (!enableMergeConflictDetection()) {\n      this.updateOrSelectFirstCommit(repository, commitSHAs)\n      return this.emitUpdate()\n    } else {\n      this.repositoryStateCache.updateCompareState(repository, () => ({\n        mergeStatus: { kind: MergeResultKind.Loading },\n      }))\n\n      this.emitUpdate()\n\n      this.updateOrSelectFirstCommit(repository, commitSHAs)\n\n      if (this.currentMergeTreePromise != null) {\n        return this.currentMergeTreePromise\n      }\n\n      if (tip.kind === TipState.Valid && aheadBehind.behind > 0) {\n        const mergeTreePromise = promiseWithMinimumTimeout(\n          () => mergeTree(repository, tip.branch, action.branch),\n          500\n        )\n          .catch(err => {\n            log.warn(\n              `Error occurred while trying to merge ${tip.branch.name} (${\n                tip.branch.tip.sha\n              }) and ${action.branch.name} (${action.branch.tip.sha})`,\n              err\n            )\n            return null\n          })\n          .then(mergeStatus => {\n            this.repositoryStateCache.updateCompareState(repository, () => ({\n              mergeStatus,\n            }))\n\n            this.emitUpdate()\n          })\n\n        const cleanup = () => {\n          this.currentMergeTreePromise = null\n        }\n\n        // TODO: when we have Promise.prototype.finally available we\n        //       should use that here to make this intent clearer\n        mergeTreePromise.then(cleanup, cleanup)\n\n        this.currentMergeTreePromise = mergeTreePromise\n\n        return this.currentMergeTreePromise\n      } else {\n        this.repositoryStateCache.updateCompareState(repository, () => ({\n          mergeStatus: null,\n        }))\n\n        return this.emitUpdate()\n      }\n    }\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public _updateCompareForm<K extends keyof ICompareFormUpdate>(\n    repository: Repository,\n    newState: Pick<ICompareFormUpdate, K>\n  ) {\n    this.repositoryStateCache.updateCompareState(repository, state => {\n      return merge(state, newState)\n    })\n\n    this.emitUpdate()\n\n    const { branchesState, compareState } = this.repositoryStateCache.get(\n      repository\n    )\n\n    if (branchesState.tip.kind !== TipState.Valid) {\n      return\n    }\n\n    if (this.currentAheadBehindUpdater === null) {\n      return\n    }\n\n    if (compareState.showBranchList) {\n      const currentBranch = branchesState.tip.branch\n\n      this.currentAheadBehindUpdater.schedule(\n        currentBranch,\n        compareState.defaultBranch,\n        compareState.recentBranches,\n        compareState.allBranches\n      )\n    } else {\n      this.currentAheadBehindUpdater.clear()\n    }\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _loadNextCommitBatch(repository: Repository): Promise<void> {\n    const gitStore = this.getGitStore(repository)\n\n    const state = this.repositoryStateCache.get(repository)\n    const { formState } = state.compareState\n    if (formState.kind === ComparisonView.None) {\n      const commits = state.compareState.commitSHAs\n      const lastCommitSha = commits[commits.length - 1]\n\n      const newCommits = await gitStore.loadCommitBatch(`${lastCommitSha}^`)\n      if (newCommits == null) {\n        return\n      }\n\n      this.repositoryStateCache.updateCompareState(repository, () => ({\n        commitSHAs: commits.concat(newCommits),\n      }))\n      this.emitUpdate()\n    }\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _loadChangedFilesForCurrentSelection(\n    repository: Repository\n  ): Promise<void> {\n    const state = this.repositoryStateCache.get(repository)\n    const { commitSelection } = state\n    const currentSHA = commitSelection.sha\n    if (currentSHA == null) {\n      return\n    }\n\n    const gitStore = this.getGitStore(repository)\n    const changedFiles = await gitStore.performFailableOperation(() =>\n      getChangedFiles(repository, currentSHA)\n    )\n    if (!changedFiles) {\n      return\n    }\n\n    // The selection could have changed between when we started loading the\n    // changed files and we finished. We might wanna store the changed files per\n    // SHA/path.\n    if (currentSHA !== state.commitSelection.sha) {\n      return\n    }\n\n    // if we're selecting a commit for the first time, we should select the\n    // first file in the commit and render the diff immediately\n\n    const noFileSelected = commitSelection.file === null\n\n    const firstFileOrDefault =\n      noFileSelected && changedFiles.length\n        ? changedFiles[0]\n        : commitSelection.file\n\n    const selectionOrFirstFile = {\n      file: firstFileOrDefault,\n      sha: commitSelection.sha,\n      changedFiles,\n      diff: null,\n    }\n\n    this.repositoryStateCache.update(repository, () => ({\n      commitSelection: selectionOrFirstFile,\n    }))\n\n    this.emitUpdate()\n\n    if (selectionOrFirstFile.file) {\n      this._changeFileSelection(repository, selectionOrFirstFile.file)\n    }\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _setRepositoryFilterText(text: string): Promise<void> {\n    this.repositoryFilterText = text\n    this.emitUpdate()\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _changeFileSelection(\n    repository: Repository,\n    file: CommittedFileChange\n  ): Promise<void> {\n    this.repositoryStateCache.update(repository, state => {\n      const { sha, changedFiles } = state.commitSelection\n      const commitSelection = {\n        sha,\n        changedFiles,\n        file,\n        diff: null,\n      }\n      return { commitSelection }\n    })\n    this.emitUpdate()\n\n    const stateBeforeLoad = this.repositoryStateCache.get(repository)\n    const sha = stateBeforeLoad.commitSelection.sha\n\n    if (!sha) {\n      if (__DEV__) {\n        throw new Error(\n          \"No currently selected sha yet we've been asked to switch file selection\"\n        )\n      } else {\n        return\n      }\n    }\n\n    const diff = await getCommitDiff(repository, file, sha)\n\n    const stateAfterLoad = this.repositoryStateCache.get(repository)\n\n    // A whole bunch of things could have happened since we initiated the diff load\n    if (\n      stateAfterLoad.commitSelection.sha !== stateBeforeLoad.commitSelection.sha\n    ) {\n      return\n    }\n    if (!stateAfterLoad.commitSelection.file) {\n      return\n    }\n    if (stateAfterLoad.commitSelection.file.id !== file.id) {\n      return\n    }\n\n    this.repositoryStateCache.update(repository, state => {\n      const { sha, changedFiles } = state.commitSelection\n      const commitSelection = {\n        sha,\n        changedFiles,\n        file,\n        diff,\n      }\n      return { commitSelection }\n    })\n\n    this.emitUpdate()\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _selectRepository(\n    repository: Repository | CloningRepository | null\n  ): Promise<Repository | null> {\n    const previouslySelectedRepository = this.selectedRepository\n\n    this.selectedRepository = repository\n\n    this.emitUpdate()\n    this.stopBackgroundFetching()\n    this.stopPullRequestUpdater()\n\n    if (repository == null) {\n      return Promise.resolve(null)\n    }\n\n    if (!(repository instanceof Repository)) {\n      return Promise.resolve(null)\n    }\n\n    localStorage.setItem(LastSelectedRepositoryIDKey, repository.id.toString())\n\n    if (repository.missing) {\n      // as the repository is no longer found on disk, cleaning this up\n      // ensures we don't accidentally run any Git operations against the\n      // wrong location if the user then relocates the `.git` folder elsewhere\n      this.removeGitStore(repository)\n      return Promise.resolve(null)\n    }\n\n    this._refreshRepository(repository)\n\n    const gitHubRepository = repository.gitHubRepository\n\n    if (gitHubRepository != null) {\n      this._refreshIssues(gitHubRepository)\n      this.loadPullRequests(repository, async () => {\n        const promiseForPRs = this.pullRequestStore.fetchPullRequestsFromCache(\n          gitHubRepository\n        )\n        const isLoading = this.pullRequestStore.isFetchingPullRequests(\n          gitHubRepository\n        )\n\n        const prs = await promiseForPRs\n\n        if (prs.length > 0) {\n          this.repositoryStateCache.updateBranchesState(repository, () => {\n            return {\n              openPullRequests: prs,\n              isLoadingPullRequests: isLoading,\n            }\n          })\n        } else {\n          this._refreshPullRequests(repository)\n        }\n\n        this._updateCurrentPullRequest(repository)\n        this.emitUpdate()\n      })\n    }\n\n    // The selected repository could have changed while we were refreshing.\n    if (this.selectedRepository !== repository) {\n      return null\n    }\n\n    // \"Clone in Desktop\" from a cold start can trigger this twice, and\n    // for edge cases where _selectRepository is re-entract, calling this here\n    // ensures we clean up the existing background fetcher correctly (if set)\n    this.stopBackgroundFetching()\n    this.stopPullRequestUpdater()\n    this.stopAheadBehindUpdate()\n\n    this.startBackgroundFetching(repository, !previouslySelectedRepository)\n    this.startPullRequestUpdater(repository)\n\n    this.startAheadBehindUpdater(repository)\n    this.refreshMentionables(repository)\n\n    this.addUpstreamRemoteIfNeeded(repository)\n\n    return this.repositoryWithRefreshedGitHubRepository(repository)\n  }\n\n  public async _refreshIssues(repository: GitHubRepository) {\n    const user = getAccountForEndpoint(this.accounts, repository.endpoint)\n    if (!user) {\n      return\n    }\n\n    try {\n      await this.issuesStore.refreshIssues(repository, user)\n    } catch (e) {\n      log.warn(`Unable to fetch issues for ${repository.fullName}`, e)\n    }\n  }\n\n  private stopBackgroundFetching() {\n    const backgroundFetcher = this.currentBackgroundFetcher\n    if (backgroundFetcher) {\n      backgroundFetcher.stop()\n      this.currentBackgroundFetcher = null\n    }\n  }\n\n  private refreshMentionables(repository: Repository) {\n    const account = getAccountForRepository(this.accounts, repository)\n    if (!account) {\n      return\n    }\n\n    const gitHubRepository = repository.gitHubRepository\n    if (!gitHubRepository) {\n      return\n    }\n\n    this.gitHubUserStore.updateMentionables(gitHubRepository, account)\n  }\n\n  private startPullRequestUpdater(repository: Repository) {\n    if (this.currentPullRequestUpdater) {\n      fatalError(\n        `A pull request updater is already active and cannot start updating on ${nameOf(\n          repository\n        )}`\n      )\n\n      return\n    }\n\n    if (!repository.gitHubRepository) {\n      return\n    }\n\n    const account = getAccountForRepository(this.accounts, repository)\n\n    if (!account) {\n      return\n    }\n\n    const updater = new PullRequestUpdater(\n      repository,\n      account,\n      this.pullRequestStore\n    )\n    this.currentPullRequestUpdater = updater\n\n    this.currentPullRequestUpdater.start()\n  }\n\n  private stopPullRequestUpdater() {\n    const updater = this.currentPullRequestUpdater\n\n    if (updater) {\n      updater.stop()\n      this.currentPullRequestUpdater = null\n    }\n  }\n\n  private shouldBackgroundFetch(\n    repository: Repository,\n    lastPush: Date | null\n  ): boolean {\n    const gitStore = this.getGitStore(repository)\n    const lastFetched = gitStore.lastFetched\n\n    if (lastFetched === null) {\n      return true\n    }\n\n    const now = new Date()\n    const timeSinceFetch = now.getTime() - lastFetched.getTime()\n    const repoName = nameOf(repository)\n    if (timeSinceFetch < BackgroundFetchMinimumInterval) {\n      const timeInSeconds = Math.floor(timeSinceFetch / 1000)\n\n      log.debug(\n        `Skipping background fetch as '${repoName}' was fetched ${timeInSeconds}s ago`\n      )\n      return false\n    }\n\n    if (lastPush === null) {\n      return true\n    }\n\n    // we should fetch if the last push happened after the last fetch\n    if (lastFetched < lastPush) {\n      return true\n    }\n\n    log.debug(\n      `Skipping background fetch since nothing has been pushed to '${repoName}' since the last fetch at ${lastFetched}`\n    )\n\n    return false\n  }\n\n  private startBackgroundFetching(\n    repository: Repository,\n    withInitialSkew: boolean\n  ) {\n    if (this.currentBackgroundFetcher) {\n      fatalError(\n        `We should only have on background fetcher active at once, but we're trying to start background fetching on ${\n          repository.name\n        } while another background fetcher is still active!`\n      )\n      return\n    }\n\n    const account = getAccountForRepository(this.accounts, repository)\n    if (!account) {\n      return\n    }\n\n    if (!repository.gitHubRepository) {\n      return\n    }\n\n    // Todo: add logic to background checker to check the API before fetching\n    // similar to what's being done in `refreshAllIndicators`\n    const fetcher = new BackgroundFetcher(\n      repository,\n      account,\n      r => this.performFetch(r, account, FetchType.BackgroundTask),\n      r => this.shouldBackgroundFetch(r, null)\n    )\n    fetcher.start(withInitialSkew)\n    this.currentBackgroundFetcher = fetcher\n  }\n\n  /** Load the initial state for the app. */\n  public async loadInitialState() {\n    const [accounts, repositories] = await Promise.all([\n      this.accountsStore.getAll(),\n      this.repositoriesStore.getAll(),\n    ])\n\n    log.info(\n      `[AppStore] loading ${repositories.length} repositories from store`\n    )\n    accounts.forEach(a => {\n      log.info(`[AppStore] found account: ${a.login} (${a.name})`)\n    })\n\n    this.accounts = accounts\n    this.repositories = repositories\n\n    // doing this that the current user can be found by any of their email addresses\n    for (const account of accounts) {\n      const userAssociations: ReadonlyArray<IGitHubUser> = account.emails.map(\n        email =>\n          // NB: We're not using object spread here because `account` has more\n          // keys than we want.\n          ({\n            endpoint: account.endpoint,\n            email: email.email,\n            login: account.login,\n            avatarURL: account.avatarURL,\n            name: account.name,\n          })\n      )\n\n      for (const user of userAssociations) {\n        this.gitHubUserStore.cacheUser(user)\n      }\n    }\n\n    this.updateRepositorySelectionAfterRepositoriesChanged()\n\n    this.sidebarWidth =\n      parseInt(localStorage.getItem(sidebarWidthConfigKey) || '', 10) ||\n      defaultSidebarWidth\n    this.commitSummaryWidth =\n      parseInt(localStorage.getItem(commitSummaryWidthConfigKey) || '', 10) ||\n      defaultCommitSummaryWidth\n\n    const confirmRepositoryRemovalValue = localStorage.getItem(\n      confirmRepoRemovalKey\n    )\n\n    this.confirmRepoRemoval =\n      confirmRepositoryRemovalValue === null\n        ? confirmRepoRemovalDefault\n        : confirmRepositoryRemovalValue === '1'\n\n    const confirmDiscardChangesValue = localStorage.getItem(\n      confirmDiscardChangesKey\n    )\n\n    this.confirmDiscardChanges =\n      confirmDiscardChangesValue === null\n        ? confirmDiscardChangesDefault\n        : confirmDiscardChangesValue === '1'\n\n    const externalEditorValue = await this.getSelectedExternalEditor()\n    if (externalEditorValue) {\n      this.selectedExternalEditor = externalEditorValue\n    }\n\n    const shellValue = localStorage.getItem(shellKey)\n    this.selectedShell = shellValue ? parseShell(shellValue) : DefaultShell\n\n    this.updateMenuItemLabels()\n\n    const imageDiffTypeValue = localStorage.getItem(imageDiffTypeKey)\n    this.imageDiffType =\n      imageDiffTypeValue === null\n        ? imageDiffTypeDefault\n        : parseInt(imageDiffTypeValue)\n\n    this.selectedTheme = getPersistedTheme()\n\n    this.emitUpdateNow()\n\n    this.accountsStore.refresh()\n  }\n\n  private async getSelectedExternalEditor(): Promise<ExternalEditor | null> {\n    const externalEditorValue = localStorage.getItem(externalEditorKey)\n    if (externalEditorValue) {\n      const value = parse(externalEditorValue)\n      if (value) {\n        return value\n      }\n    }\n\n    const editors = await getAvailableEditors()\n    if (editors.length) {\n      const value = editors[0].editor\n      // store this value to avoid the lookup next time\n      localStorage.setItem(externalEditorKey, value)\n      return value\n    }\n\n    return null\n  }\n\n  /**\n   * Update menu labels for editor, shell, and pull requests.\n   */\n  private updateMenuItemLabels(repository?: Repository) {\n    const editorLabel = this.selectedExternalEditor\n      ? `Open in ${this.selectedExternalEditor}`\n      : undefined\n\n    const prLabel = repository\n      ? this.getPullRequestLabel(repository)\n      : undefined\n\n    updatePreferredAppMenuItemLabels({\n      editor: editorLabel,\n      pullRequestLabel: prLabel,\n      shell: `Open in ${this.selectedShell}`,\n    })\n  }\n\n  private getPullRequestLabel(repository: Repository) {\n    const githubRepository = repository.gitHubRepository\n    const defaultPRLabel = __DARWIN__\n      ? 'Create Pull Request'\n      : 'Create &pull request'\n\n    if (!githubRepository) {\n      return defaultPRLabel\n    }\n\n    const state = this.repositoryStateCache.get(repository)\n\n    const { branchesState } = state\n\n    if (branchesState.currentPullRequest === null) {\n      return defaultPRLabel\n    }\n\n    return __DARWIN__ ? 'Show Pull Request' : 'Show &pull request'\n  }\n\n  private updateRepositorySelectionAfterRepositoriesChanged() {\n    const selectedRepository = this.selectedRepository\n    let newSelectedRepository: Repository | CloningRepository | null = this\n      .selectedRepository\n    if (selectedRepository) {\n      const r =\n        this.repositories.find(\n          r =>\n            r.constructor === selectedRepository.constructor &&\n            r.id === selectedRepository.id\n        ) || null\n\n      newSelectedRepository = r\n    }\n\n    if (newSelectedRepository === null && this.repositories.length > 0) {\n      const lastSelectedID = parseInt(\n        localStorage.getItem(LastSelectedRepositoryIDKey) || '',\n        10\n      )\n      if (lastSelectedID && !isNaN(lastSelectedID)) {\n        newSelectedRepository =\n          this.repositories.find(r => r.id === lastSelectedID) || null\n      }\n\n      if (!newSelectedRepository) {\n        newSelectedRepository = this.repositories[0]\n      }\n    }\n\n    const repositoryChanged =\n      (selectedRepository &&\n        newSelectedRepository &&\n        selectedRepository.hash !== newSelectedRepository.hash) ||\n      (selectedRepository && !newSelectedRepository) ||\n      (!selectedRepository && newSelectedRepository)\n    if (repositoryChanged) {\n      this._selectRepository(newSelectedRepository)\n      this.emitUpdate()\n    }\n  }\n\n  private detectMergeResolution(status: IStatusResult) {\n    const currentBranchName = status.currentBranch\n    if (currentBranchName === undefined) {\n      return\n    }\n\n    const selection = this.getSelectedState()\n    if (selection === null || selection.type !== SelectionType.Repository) {\n      return\n    }\n\n    const { tip } = selection.state.branchesState\n\n    if (tip.kind !== TipState.Valid) {\n      return\n    }\n\n    const repository = selection.repository\n    const repoState = this.repositoryStateCache.get(repository)\n    const { conflictState } = repoState.changesState\n\n    // conflict state being null means that there are no conflicts\n    if (conflictState === null) {\n      return\n    }\n\n    const previousBranch = conflictState.branch\n\n    // The branch name has changed, so the merge must have been aborted\n    if (previousBranch.name !== currentBranchName) {\n      this.statsStore.recordMergeAbortedAfterConflicts()\n      this.repositoryStateCache.updateChangesState(repository, () => ({\n        conflictState: null,\n      }))\n      this.emitUpdate()\n      return\n    }\n\n    // are there files that have a conflicted or _resolved_ status?\n    const workingDirectioryHasConflicts = status.workingDirectory.files.some(\n      file =>\n        file.status === AppFileStatus.Conflicted ||\n        file.status === AppFileStatus.Resolved\n    )\n\n    if (workingDirectioryHasConflicts) {\n      return\n    }\n\n    if (status.currentTip === previousBranch.tip.sha) {\n      // if the tip is the same, no merge commit was created\n      this.statsStore.recordMergeAbortedAfterConflicts()\n    } else {\n      this.statsStore.recordMergeSuccesAfterConflicts()\n    }\n\n    this.repositoryStateCache.updateChangesState(repository, state => ({\n      conflictState: null,\n    }))\n    this.emitUpdate()\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _loadStatus(\n    repository: Repository,\n    clearPartialState: boolean = false\n  ): Promise<boolean> {\n    const gitStore = this.getGitStore(repository)\n    const status = await gitStore.loadStatus()\n\n    if (!status) {\n      return false\n    }\n\n    this.detectMergeResolution(status)\n    this.repositoryStateCache.updateChangesState(repository, state => {\n      // Populate a map for all files in the current working directory state\n      const filesByID = new Map<string, WorkingDirectoryFileChange>()\n      state.workingDirectory.files.forEach(f => filesByID.set(f.id, f))\n\n      // Attempt to preserve the selection state for each file in the new\n      // working directory state by looking at the current files\n      const mergedFiles = status.workingDirectory.files\n        .map(file => {\n          const existingFile = filesByID.get(file.id)\n          if (existingFile) {\n            if (clearPartialState) {\n              if (\n                existingFile.selection.getSelectionType() ===\n                DiffSelectionType.Partial\n              ) {\n                return file.withIncludeAll(false)\n              }\n            }\n\n            return file.withSelection(existingFile.selection)\n          } else {\n            return file\n          }\n        })\n        .sort((x, y) => caseInsensitiveCompare(x.path, y.path))\n\n      // Collect all the currently available file ids into a set to avoid O(N)\n      // lookups using .find on the mergedFiles array.\n      const mergedFileIds = new Set(mergedFiles.map(x => x.id))\n\n      // The previously selected files might not be available in the working\n      // directory any more due to having been committed or discarded so we'll\n      // do a pass over and filter out any selected files that aren't available.\n      let selectedFileIDs = state.selectedFileIDs.filter(id =>\n        mergedFileIds.has(id)\n      )\n\n      // Select the first file if we don't have anything selected and we\n      // have something to select.\n      if (selectedFileIDs.length === 0 && mergedFiles.length > 0) {\n        selectedFileIDs = [mergedFiles[0].id]\n      }\n\n      // The file selection could have changed if the previously selected files\n      // are no longer selectable (they were discarded or committed) but if they\n      // were not changed we can reuse the diff. Note, however that we only render\n      // a diff when a single file is selected. If the previous selection was\n      // a single file with the same id as the current selection we can keep the\n      // diff we had, if not we'll clear it.\n      const workingDirectory = WorkingDirectoryStatus.fromFiles(mergedFiles)\n\n      const diff =\n        selectedFileIDs.length === 1 &&\n        state.selectedFileIDs.length === 1 &&\n        state.selectedFileIDs[0] === selectedFileIDs[0]\n          ? state.diff\n          : null\n\n      return { workingDirectory, selectedFileIDs, diff }\n    })\n    this.emitUpdate()\n\n    this.updateChangesDiffForCurrentSelection(repository)\n\n    return true\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _changeRepositorySection(\n    repository: Repository,\n    selectedSection: RepositorySectionTab\n  ): Promise<void> {\n    this.repositoryStateCache.update(repository, () => ({\n      selectedSection,\n    }))\n    this.emitUpdate()\n\n    if (selectedSection === RepositorySectionTab.History) {\n      return this.refreshHistorySection(repository)\n    } else if (selectedSection === RepositorySectionTab.Changes) {\n      return this.refreshChangesSection(repository, {\n        includingStatus: true,\n        clearPartialState: false,\n      })\n    }\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _changeChangesSelection(\n    repository: Repository,\n    selectedFiles: WorkingDirectoryFileChange[]\n  ): Promise<void> {\n    this.repositoryStateCache.updateChangesState(repository, () => ({\n      selectedFileIDs: selectedFiles.map(file => file.id),\n      diff: null,\n    }))\n    this.emitUpdate()\n\n    this.updateChangesDiffForCurrentSelection(repository)\n  }\n\n  /**\n   * Loads or re-loads (refreshes) the diff for the currently selected file\n   * in the working directory. This operation is a noop if there's no currently\n   * selected file.\n   */\n  private async updateChangesDiffForCurrentSelection(\n    repository: Repository\n  ): Promise<void> {\n    const stateBeforeLoad = this.repositoryStateCache.get(repository)\n    const changesStateBeforeLoad = stateBeforeLoad.changesState\n    const selectedFileIDsBeforeLoad = changesStateBeforeLoad.selectedFileIDs\n\n    // We only render diffs when a single file is selected.\n    if (selectedFileIDsBeforeLoad.length !== 1) {\n      if (changesStateBeforeLoad.diff !== null) {\n        this.repositoryStateCache.updateChangesState(repository, () => ({\n          diff: null,\n        }))\n        this.emitUpdate()\n      }\n      return\n    }\n\n    const selectedFileIdBeforeLoad = selectedFileIDsBeforeLoad[0]\n    const selectedFileBeforeLoad = changesStateBeforeLoad.workingDirectory.findFileWithID(\n      selectedFileIdBeforeLoad\n    )\n\n    if (selectedFileBeforeLoad === null) {\n      return\n    }\n\n    const diff = await getWorkingDirectoryDiff(\n      repository,\n      selectedFileBeforeLoad\n    )\n\n    const stateAfterLoad = this.repositoryStateCache.get(repository)\n    const changesState = stateAfterLoad.changesState\n\n    // A different file (or files) could have been selected while we were\n    // loading the diff in which case we no longer care about the diff we\n    // just loaded.\n    if (changesState.selectedFileIDs.length !== 1) {\n      return\n    }\n\n    const selectedFileID = changesState.selectedFileIDs[0]\n\n    if (selectedFileID !== selectedFileIdBeforeLoad) {\n      return\n    }\n\n    const currentlySelectedFile = changesState.workingDirectory.findFileWithID(\n      selectedFileID\n    )\n    if (currentlySelectedFile === null) {\n      return\n    }\n\n    const selectableLines = new Set<number>()\n    if (diff.kind === DiffType.Text) {\n      // The diff might have changed dramatically since last we loaded it.\n      // Ideally we would be more clever about validating that any partial\n      // selection state is still valid by ensuring that selected lines still\n      // exist but for now we'll settle on just updating the selectable lines\n      // such that any previously selected line which now no longer exists or\n      // has been turned into a context line isn't still selected.\n      diff.hunks.forEach(h => {\n        h.lines.forEach((line, index) => {\n          if (line.isIncludeableLine()) {\n            selectableLines.add(h.unifiedDiffStart + index)\n          }\n        })\n      })\n    }\n\n    const newSelection = currentlySelectedFile.selection.withSelectableLines(\n      selectableLines\n    )\n    const selectedFile = currentlySelectedFile.withSelection(newSelection)\n    const updatedFiles = changesState.workingDirectory.files.map(\n      f => (f.id === selectedFile.id ? selectedFile : f)\n    )\n    const workingDirectory = WorkingDirectoryStatus.fromFiles(updatedFiles)\n\n    this.repositoryStateCache.updateChangesState(repository, () => ({\n      diff,\n      workingDirectory,\n    }))\n    this.emitUpdate()\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _commitIncludedChanges(\n    repository: Repository,\n    summary: string,\n    description: string | null,\n    trailers?: ReadonlyArray<ITrailer>\n  ): Promise<boolean> {\n    const state = this.repositoryStateCache.get(repository)\n    const files = state.changesState.workingDirectory.files\n    const selectedFiles = files.filter(file => {\n      return file.selection.getSelectionType() !== DiffSelectionType.None\n    })\n\n    const gitStore = this.getGitStore(repository)\n\n    const result = await this.isCommitting(repository, () => {\n      return gitStore.performFailableOperation(async () => {\n        const message = await formatCommitMessage(\n          repository,\n          summary,\n          description,\n          trailers\n        )\n        return createCommit(repository, message, selectedFiles)\n      })\n    })\n\n    if (result) {\n      this.statsStore.recordCommit()\n\n      const includedPartialSelections = files.some(\n        file => file.selection.getSelectionType() === DiffSelectionType.Partial\n      )\n      if (includedPartialSelections) {\n        this.statsStore.recordPartialCommit()\n      }\n\n      if (trailers != null && trailers.some(isCoAuthoredByTrailer)) {\n        this.statsStore.recordCoAuthoredCommit()\n      }\n\n      await this._refreshRepository(repository)\n      await this.refreshChangesSection(repository, {\n        includingStatus: true,\n        clearPartialState: true,\n      })\n    }\n\n    return result || false\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public _changeFileIncluded(\n    repository: Repository,\n    file: WorkingDirectoryFileChange,\n    include: boolean\n  ): Promise<void> {\n    const selection = include\n      ? file.selection.withSelectAll()\n      : file.selection.withSelectNone()\n    this.updateWorkingDirectoryFileSelection(repository, file, selection)\n    return Promise.resolve()\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public _changeFileLineSelection(\n    repository: Repository,\n    file: WorkingDirectoryFileChange,\n    diffSelection: DiffSelection\n  ): Promise<void> {\n    this.updateWorkingDirectoryFileSelection(repository, file, diffSelection)\n    return Promise.resolve()\n  }\n\n  /**\n   * Updates the selection for the given file in the working directory state and\n   * emits an update event.\n   */\n  private updateWorkingDirectoryFileSelection(\n    repository: Repository,\n    file: WorkingDirectoryFileChange,\n    selection: DiffSelection\n  ) {\n    this.repositoryStateCache.updateChangesState(repository, state => {\n      const newFiles = state.workingDirectory.files.map(\n        f => (f.id === file.id ? f.withSelection(selection) : f)\n      )\n\n      const workingDirectory = WorkingDirectoryStatus.fromFiles(newFiles)\n\n      return { workingDirectory }\n    })\n\n    this.emitUpdate()\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public _changeIncludeAllFiles(\n    repository: Repository,\n    includeAll: boolean\n  ): Promise<void> {\n    this.repositoryStateCache.updateChangesState(repository, state => {\n      const workingDirectory = state.workingDirectory.withIncludeAllFiles(\n        includeAll\n      )\n      return { workingDirectory }\n    })\n\n    this.emitUpdate()\n\n    return Promise.resolve()\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _refreshRepository(repository: Repository): Promise<void> {\n    if (repository.missing) {\n      return\n    }\n\n    // if the repository path doesn't exist on disk,\n    // set the flag and don't try anything Git-related\n    const exists = await pathExists(repository.path)\n    if (!exists) {\n      this._updateRepositoryMissing(repository, true)\n      return\n    }\n\n    const state = this.repositoryStateCache.get(repository)\n    const gitStore = this.getGitStore(repository)\n\n    // if we cannot get a valid status it's a good indicator that the repository\n    // is in a bad state - let's mark it as missing here and give up on the\n    // further work\n    const status = await this._loadStatus(repository)\n    if (!status) {\n      await this._updateRepositoryMissing(repository, true)\n      return\n    }\n\n    await gitStore.loadBranches()\n\n    const section = state.selectedSection\n    let refreshSectionPromise: Promise<void>\n\n    if (section === RepositorySectionTab.History) {\n      refreshSectionPromise = this.refreshHistorySection(repository)\n    } else if (section === RepositorySectionTab.Changes) {\n      refreshSectionPromise = this.refreshChangesSection(repository, {\n        includingStatus: false,\n        clearPartialState: false,\n      })\n    } else {\n      return assertNever(section, `Unknown section: ${section}`)\n    }\n\n    await Promise.all([\n      gitStore.loadRemotes(),\n      gitStore.updateLastFetched(),\n      this.refreshAuthor(repository),\n      gitStore.loadContextualCommitMessage(),\n      refreshSectionPromise,\n    ])\n\n    this._updateCurrentPullRequest(repository)\n    this.updateMenuItemLabels(repository)\n    this._initializeCompare(repository)\n    this.refreshIndicatorsForRepositories([repository])\n  }\n\n  public refreshAllIndicators() {\n    return this.refreshIndicatorsForRepositories(this.repositories)\n  }\n\n  private async refreshIndicatorsForRepositories(\n    repositories: ReadonlyArray<Repository>\n  ): Promise<void> {\n    if (!enableRepoInfoIndicators()) {\n      return\n    }\n\n    const startTime = performance && performance.now ? performance.now() : null\n\n    for (const repo of repositories) {\n      await this.refreshIndicatorForRepository(repo)\n    }\n\n    if (startTime && repositories.length > 1) {\n      const delta = performance.now() - startTime\n      const timeInSeconds = (delta / 1000).toFixed(3)\n      log.info(\n        `Background fetch for ${\n          repositories.length\n        } repositories took ${timeInSeconds}sec`\n      )\n    }\n\n    this.emitUpdate()\n  }\n\n  private async refreshIndicatorForRepository(repository: Repository) {\n    const lookup = this.localRepositoryStateLookup\n\n    if (repository.missing) {\n      lookup.delete(repository.id)\n      return\n    }\n\n    const exists = await pathExists(repository.path)\n    if (!exists) {\n      lookup.delete(repository.id)\n      return\n    }\n\n    const gitStore = this.getGitStore(repository)\n    const status = await gitStore.loadStatus()\n    if (status === null) {\n      lookup.delete(repository.id)\n      return\n    }\n\n    const lastPush = await inferLastPushForRepository(\n      this.accounts,\n      gitStore,\n      repository\n    )\n\n    if (this.shouldBackgroundFetch(repository, lastPush)) {\n      await this.withAuthenticatingUser(repository, (repo, account) => {\n        return gitStore.performFailableOperation(() => {\n          return gitStore.fetch(account, true)\n        })\n      })\n    }\n\n    lookup.set(repository.id, {\n      aheadBehind: gitStore.aheadBehind,\n      changedFilesCount: status.workingDirectory.files.length,\n    })\n  }\n\n  /**\n   * Refresh all the data for the Changes section.\n   *\n   * This will be called automatically when appropriate.\n   */\n  private async refreshChangesSection(\n    repository: Repository,\n    options: { includingStatus: boolean; clearPartialState: boolean }\n  ): Promise<void> {\n    if (options.includingStatus) {\n      await this._loadStatus(repository, options.clearPartialState)\n    }\n\n    const gitStore = this.getGitStore(repository)\n    const state = this.repositoryStateCache.get(repository)\n\n    if (state.branchesState.tip.kind === TipState.Valid) {\n      const currentBranch = state.branchesState.tip.branch\n      await gitStore.loadLocalCommits(currentBranch)\n    } else if (state.branchesState.tip.kind === TipState.Unborn) {\n      await gitStore.loadLocalCommits(null)\n    }\n  }\n\n  /**\n   * Refresh all the data for the History section.\n   *\n   * This will be called automatically when appropriate.\n   */\n  private async refreshHistorySection(repository: Repository): Promise<void> {\n    const gitStore = this.getGitStore(repository)\n    const state = this.repositoryStateCache.get(repository)\n    const tip = state.branchesState.tip\n\n    if (tip.kind === TipState.Valid) {\n      await gitStore.loadLocalCommits(tip.branch)\n    }\n\n    return this.updateOrSelectFirstCommit(\n      repository,\n      state.compareState.commitSHAs\n    )\n  }\n\n  private async refreshAuthor(repository: Repository): Promise<void> {\n    const gitStore = this.getGitStore(repository)\n    const commitAuthor =\n      (await gitStore.performFailableOperation(() =>\n        getAuthorIdentity(repository)\n      )) || null\n\n    this.repositoryStateCache.update(repository, () => ({ commitAuthor }))\n    this.emitUpdate()\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _showPopup(popup: Popup): Promise<void> {\n    this._closePopup()\n\n    // Always close the app menu when showing a pop up. This is only\n    // applicable on Windows where we draw a custom app menu.\n    this._closeFoldout(FoldoutType.AppMenu)\n\n    this.currentPopup = popup\n    this.emitUpdate()\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public _closePopup(): Promise<void> {\n    const currentPopup = this.currentPopup\n    if (currentPopup == null) {\n      return Promise.resolve()\n    }\n\n    if (currentPopup.type === PopupType.CloneRepository) {\n      this._completeOpenInDesktop(() => Promise.resolve(null))\n    }\n\n    this.currentPopup = null\n    this.emitUpdate()\n\n    return Promise.resolve()\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _showFoldout(foldout: Foldout): Promise<void> {\n    this.currentFoldout = foldout\n    this.emitUpdate()\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _closeCurrentFoldout(): Promise<void> {\n    if (this.currentFoldout == null) {\n      return\n    }\n\n    this.currentFoldout = null\n    this.emitUpdate()\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _closeFoldout(foldout: FoldoutType): Promise<void> {\n    if (this.currentFoldout == null) {\n      return\n    }\n\n    if (foldout !== undefined && this.currentFoldout.type !== foldout) {\n      return\n    }\n\n    this.currentFoldout = null\n    this.emitUpdate()\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _createBranch(\n    repository: Repository,\n    name: string,\n    startPoint?: string\n  ): Promise<Repository> {\n    const gitStore = this.getGitStore(repository)\n    const branch = await gitStore.performFailableOperation(() =>\n      createBranch(repository, name, startPoint)\n    )\n\n    if (branch == null) {\n      return repository\n    }\n\n    return await this._checkoutBranch(repository, branch)\n  }\n\n  private updateCheckoutProgress(\n    repository: Repository,\n    checkoutProgress: ICheckoutProgress | null\n  ) {\n    this.repositoryStateCache.update(repository, () => ({ checkoutProgress }))\n\n    if (this.selectedRepository === repository) {\n      this.emitUpdate()\n    }\n  }\n\n  private getLocalBranch(\n    repository: Repository,\n    branch: string\n  ): Branch | null {\n    const gitStore = this.getGitStore(repository)\n    return (\n      gitStore.allBranches.find(b => b.nameWithoutRemote === branch) || null\n    )\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _checkoutBranch(\n    repository: Repository,\n    branch: Branch | string\n  ): Promise<Repository> {\n    const gitStore = this.getGitStore(repository)\n    const kind = 'checkout'\n\n    const foundBranch =\n      typeof branch === 'string'\n        ? this.getLocalBranch(repository, branch)\n        : branch\n\n    if (foundBranch == null) {\n      return repository\n    }\n\n    await this.withAuthenticatingUser(repository, (repository, account) =>\n      gitStore.performFailableOperation(() =>\n        checkoutBranch(repository, account, foundBranch, progress => {\n          this.updateCheckoutProgress(repository, progress)\n        })\n      )\n    )\n\n    try {\n      this.updateCheckoutProgress(repository, {\n        kind,\n        title: __DARWIN__ ? 'Refreshing Repository' : 'Refreshing repository',\n        value: 1,\n        targetBranch: foundBranch.name,\n      })\n\n      await this._refreshRepository(repository)\n    } finally {\n      this.updateCheckoutProgress(repository, null)\n      this._initializeCompare(repository, { kind: CompareActionKind.History })\n    }\n\n    const { branchesState } = this.repositoryStateCache.get(repository)\n    const { defaultBranch } = branchesState\n\n    if (defaultBranch !== null && foundBranch.name !== defaultBranch.name) {\n      this.statsStore.recordNonDefaultBranchCheckout()\n    }\n\n    return repository\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  private async repositoryWithRefreshedGitHubRepository(\n    repository: Repository\n  ): Promise<Repository> {\n    const oldGitHubRepository = repository.gitHubRepository\n\n    const matchedGitHubRepository = await this.matchGitHubRepository(repository)\n    if (!matchedGitHubRepository) {\n      // TODO: We currently never clear GitHub repository associations (see\n      // https://github.com/desktop/desktop/issues/1144). So we can bail early\n      // at this point.\n      return repository\n    }\n\n    // This is the repository with the GitHub repository as matched. It's not\n    // ideal because the GitHub repository hasn't been fetched from the API yet\n    // and so it is incomplete. But if we _can't_ fetch it from the API, it's\n    // better than nothing.\n    const skeletonOwner = new Owner(\n      matchedGitHubRepository.owner,\n      matchedGitHubRepository.endpoint,\n      null\n    )\n    const skeletonGitHubRepository = new GitHubRepository(\n      matchedGitHubRepository.name,\n      skeletonOwner,\n      null\n    )\n    const skeletonRepository = new Repository(\n      repository.path,\n      repository.id,\n      skeletonGitHubRepository,\n      repository.missing\n    )\n\n    const account = getAccountForEndpoint(\n      this.accounts,\n      matchedGitHubRepository.endpoint\n    )\n    if (!account) {\n      // If the repository given to us had a GitHubRepository instance we want\n      // to try to preserve that if possible since the updated GitHubRepository\n      // instance won't have any API information while the previous one might.\n      // We'll only swap it out if the endpoint has changed in which case the\n      // old API information will be invalid anyway.\n      if (\n        !oldGitHubRepository ||\n        matchedGitHubRepository.endpoint !== oldGitHubRepository.endpoint\n      ) {\n        return skeletonRepository\n      }\n\n      return repository\n    }\n\n    const api = API.fromAccount(account)\n    const apiRepo = await api.fetchRepository(\n      matchedGitHubRepository.owner,\n      matchedGitHubRepository.name\n    )\n\n    if (!apiRepo) {\n      // This is the same as above. If the request fails, we wanna preserve the\n      // existing GitHub repository info. But if we didn't have a GitHub\n      // repository already or the endpoint changed, the skeleton repository is\n      // better than nothing.\n      if (\n        !oldGitHubRepository ||\n        matchedGitHubRepository.endpoint !== oldGitHubRepository.endpoint\n      ) {\n        return skeletonRepository\n      }\n\n      return repository\n    }\n\n    const endpoint = matchedGitHubRepository.endpoint\n    return this.repositoriesStore.updateGitHubRepository(\n      repository,\n      endpoint,\n      apiRepo\n    )\n  }\n\n  private async matchGitHubRepository(\n    repository: Repository\n  ): Promise<IMatchedGitHubRepository | null> {\n    const gitStore = this.getGitStore(repository)\n    const remote = gitStore.defaultRemote\n    return remote !== null\n      ? matchGitHubRepository(this.accounts, remote.url)\n      : null\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public _pushError(error: Error): Promise<void> {\n    const newErrors = Array.from(this.errors)\n    newErrors.push(error)\n    this.errors = newErrors\n    this.emitUpdate()\n\n    return Promise.resolve()\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public _clearError(error: Error): Promise<void> {\n    this.errors = this.errors.filter(e => e !== error)\n    this.emitUpdate()\n\n    return Promise.resolve()\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _renameBranch(\n    repository: Repository,\n    branch: Branch,\n    newName: string\n  ): Promise<void> {\n    const gitStore = this.getGitStore(repository)\n    await gitStore.performFailableOperation(() =>\n      renameBranch(repository, branch, newName)\n    )\n\n    return this._refreshRepository(repository)\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _deleteBranch(\n    repository: Repository,\n    branch: Branch,\n    includeRemote: boolean\n  ): Promise<void> {\n    return this.withAuthenticatingUser(repository, async (r, account) => {\n      const { branchesState } = this.repositoryStateCache.get(r)\n      const { defaultBranch } = branchesState\n\n      if (defaultBranch == null) {\n        throw new Error(\n          `A default branch cannot be found for this repository, so the app is unable to identify which branch to switch to before removing the current branch.`\n        )\n      }\n\n      const gitStore = this.getGitStore(r)\n\n      await gitStore.performFailableOperation(() =>\n        checkoutBranch(r, account, defaultBranch)\n      )\n      await gitStore.performFailableOperation(() =>\n        deleteBranch(r, branch, account, includeRemote)\n      )\n\n      return this._refreshRepository(r)\n    })\n  }\n\n  private updatePushPullFetchProgress(\n    repository: Repository,\n    pushPullFetchProgress: Progress | null\n  ) {\n    this.repositoryStateCache.update(repository, () => ({\n      pushPullFetchProgress,\n    }))\n\n    if (this.selectedRepository === repository) {\n      this.emitUpdate()\n    }\n  }\n\n  public async _push(repository: Repository): Promise<void> {\n    return this.withAuthenticatingUser(repository, (repository, account) => {\n      return this.performPush(repository, account)\n    })\n  }\n\n  private async performPush(\n    repository: Repository,\n    account: IGitAccount | null\n  ): Promise<void> {\n    const gitStore = this.getGitStore(repository)\n    const remote = gitStore.remote\n    if (!remote) {\n      this._showPopup({ type: PopupType.PublishRepository, repository })\n      return\n    }\n\n    return this.withPushPull(repository, async () => {\n      const state = this.repositoryStateCache.get(repository)\n      if (state.branchesState.tip.kind === TipState.Unborn) {\n        throw new Error('The current branch is unborn.')\n      }\n\n      if (state.branchesState.tip.kind === TipState.Detached) {\n        throw new Error('The current repository is in a detached HEAD state.')\n      }\n\n      if (state.branchesState.tip.kind === TipState.Valid) {\n        const branch = state.branchesState.tip.branch\n\n        const pushTitle = `Pushing to ${remote.name}`\n\n        // Emit an initial progress even before our push begins\n        // since we're doing some work to get remotes up front.\n        this.updatePushPullFetchProgress(repository, {\n          kind: 'push',\n          title: pushTitle,\n          value: 0,\n          remote: remote.name,\n          branch: branch.name,\n        })\n\n        // Let's say that a push takes roughly twice as long as a fetch,\n        // this is of course highly inaccurate.\n        let pushWeight = 2.5\n        let fetchWeight = 1\n\n        // Let's leave 10% at the end for refreshing\n        const refreshWeight = 0.1\n\n        // Scale pull and fetch weights to be between 0 and 0.9.\n        const scale = (1 / (pushWeight + fetchWeight)) * (1 - refreshWeight)\n\n        pushWeight *= scale\n        fetchWeight *= scale\n\n        const retryAction: RetryAction = {\n          type: RetryActionType.Push,\n          repository,\n        }\n        await gitStore.performFailableOperation(\n          async () => {\n            await pushRepo(\n              repository,\n              account,\n              remote.name,\n              branch.name,\n              branch.upstreamWithoutRemote,\n              progress => {\n                this.updatePushPullFetchProgress(repository, {\n                  ...progress,\n                  title: pushTitle,\n                  value: pushWeight * progress.value,\n                })\n              }\n            )\n\n            await gitStore.fetchRemotes(\n              account,\n              [remote],\n              false,\n              fetchProgress => {\n                this.updatePushPullFetchProgress(repository, {\n                  ...fetchProgress,\n                  value: pushWeight + fetchProgress.value * fetchWeight,\n                })\n              }\n            )\n\n            const refreshTitle = __DARWIN__\n              ? 'Refreshing Repository'\n              : 'Refreshing repository'\n            const refreshStartProgress = pushWeight + fetchWeight\n\n            this.updatePushPullFetchProgress(repository, {\n              kind: 'generic',\n              title: refreshTitle,\n              value: refreshStartProgress,\n            })\n\n            await this._refreshRepository(repository)\n\n            this.updatePushPullFetchProgress(repository, {\n              kind: 'generic',\n              title: refreshTitle,\n              description: 'Fast-forwarding branches',\n              value: refreshStartProgress + refreshWeight * 0.5,\n            })\n\n            await this.fastForwardBranches(repository)\n          },\n          { retryAction }\n        )\n\n        this.updatePushPullFetchProgress(repository, null)\n\n        const prUpdater = this.currentPullRequestUpdater\n        if (prUpdater) {\n          const state = this.repositoryStateCache.get(repository)\n          const currentPR = state.branchesState.currentPullRequest\n          const gitHubRepository = repository.gitHubRepository\n\n          if (currentPR && gitHubRepository) {\n            prUpdater.didPushPullRequest(currentPR)\n          }\n        }\n\n        const { accounts } = this.getState()\n        const githubAccount = await findAccountForRemoteURL(\n          remote.url,\n          accounts\n        )\n\n        if (githubAccount === null) {\n          this.statsStore.recordPushToGenericRemote()\n        } else if (githubAccount.endpoint === getDotComAPIEndpoint()) {\n          this.statsStore.recordPushToGitHub()\n        } else if (\n          githubAccount.endpoint === getEnterpriseAPIURL(githubAccount.endpoint)\n        ) {\n          this.statsStore.recordPushToGitHubEnterprise()\n        }\n      }\n    })\n  }\n\n  private async isCommitting(\n    repository: Repository,\n    fn: () => Promise<boolean | undefined>\n  ): Promise<boolean | undefined> {\n    const state = this.repositoryStateCache.get(repository)\n    // ensure the user doesn't try and commit again\n    if (state.isCommitting) {\n      return\n    }\n\n    this.repositoryStateCache.update(repository, () => ({\n      isCommitting: true,\n    }))\n    this.emitUpdate()\n\n    try {\n      return await fn()\n    } finally {\n      this.repositoryStateCache.update(repository, () => ({\n        isCommitting: false,\n      }))\n      this.emitUpdate()\n    }\n  }\n\n  private async withPushPull(\n    repository: Repository,\n    fn: () => Promise<void>\n  ): Promise<void> {\n    const state = this.repositoryStateCache.get(repository)\n    // Don't allow concurrent network operations.\n    if (state.isPushPullFetchInProgress) {\n      return\n    }\n\n    this.repositoryStateCache.update(repository, () => ({\n      isPushPullFetchInProgress: true,\n    }))\n    this.emitUpdate()\n\n    try {\n      await fn()\n    } finally {\n      this.repositoryStateCache.update(repository, () => ({\n        isPushPullFetchInProgress: false,\n      }))\n      this.emitUpdate()\n    }\n  }\n\n  public async _pull(repository: Repository): Promise<void> {\n    return this.withAuthenticatingUser(repository, (repository, account) => {\n      return this.performPull(repository, account)\n    })\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  private async performPull(\n    repository: Repository,\n    account: IGitAccount | null\n  ): Promise<void> {\n    return this.withPushPull(repository, async () => {\n      const gitStore = this.getGitStore(repository)\n      const remote = gitStore.remote\n\n      if (!remote) {\n        throw new Error('The repository has no remotes.')\n      }\n\n      const state = this.repositoryStateCache.get(repository)\n      const tip = state.branchesState.tip\n\n      if (tip.kind === TipState.Unborn) {\n        throw new Error('The current branch is unborn.')\n      }\n\n      if (tip.kind === TipState.Detached) {\n        throw new Error('The current repository is in a detached HEAD state.')\n      }\n\n      if (tip.kind === TipState.Valid) {\n        let mergeBase: string | null = null\n        if (tip.branch.upstream) {\n          mergeBase = await getMergeBase(\n            repository,\n            tip.branch.name,\n            tip.branch.upstream\n          )\n        }\n\n        const title = `Pulling ${remote.name}`\n        const kind = 'pull'\n        this.updatePushPullFetchProgress(repository, {\n          kind,\n          title,\n          value: 0,\n          remote: remote.name,\n        })\n\n        try {\n          // Let's say that a pull takes twice as long as a fetch,\n          // this is of course highly inaccurate.\n          let pullWeight = 2\n          let fetchWeight = 1\n\n          // Let's leave 10% at the end for refreshing\n          const refreshWeight = 0.1\n\n          // Scale pull and fetch weights to be between 0 and 0.9.\n          const scale = (1 / (pullWeight + fetchWeight)) * (1 - refreshWeight)\n\n          pullWeight *= scale\n          fetchWeight *= scale\n\n          const retryAction: RetryAction = {\n            type: RetryActionType.Pull,\n            repository,\n          }\n          await gitStore.performFailableOperation(\n            () =>\n              pullRepo(repository, account, remote.name, progress => {\n                this.updatePushPullFetchProgress(repository, {\n                  ...progress,\n                  value: progress.value * pullWeight,\n                })\n              }),\n            { command: 'pull', retryAction }\n          )\n\n          const refreshStartProgress = pullWeight + fetchWeight\n          const refreshTitle = __DARWIN__\n            ? 'Refreshing Repository'\n            : 'Refreshing repository'\n\n          this.updatePushPullFetchProgress(repository, {\n            kind: 'generic',\n            title: refreshTitle,\n            value: refreshStartProgress,\n          })\n\n          if (mergeBase) {\n            await gitStore.reconcileHistory(mergeBase)\n          }\n\n          await this._refreshRepository(repository)\n\n          this.updatePushPullFetchProgress(repository, {\n            kind: 'generic',\n            title: refreshTitle,\n            description: 'Fast-forwarding branches',\n            value: refreshStartProgress + refreshWeight * 0.5,\n          })\n\n          await this.fastForwardBranches(repository)\n        } finally {\n          this.updatePushPullFetchProgress(repository, null)\n        }\n      }\n    })\n  }\n\n  private async fastForwardBranches(repository: Repository) {\n    const state = this.repositoryStateCache.get(repository)\n    const branches = state.branchesState.allBranches\n\n    const tip = state.branchesState.tip\n    const currentBranchName =\n      tip.kind === TipState.Valid ? tip.branch.name : null\n\n    let eligibleBranches = branches.filter(b =>\n      eligibleForFastForward(b, currentBranchName)\n    )\n\n    if (eligibleBranches.length >= FastForwardBranchesThreshold) {\n      log.info(\n        `skipping fast-forward for all branches as there are ${\n          eligibleBranches.length\n        } local branches - this will run again when there are less than ${FastForwardBranchesThreshold} local branches tracking remotes`\n      )\n\n      const defaultBranch = state.branchesState.defaultBranch\n      eligibleBranches =\n        defaultBranch != null &&\n        eligibleForFastForward(defaultBranch, currentBranchName)\n          ? [defaultBranch]\n          : []\n    }\n\n    for (const branch of eligibleBranches) {\n      const aheadBehind = await getBranchAheadBehind(repository, branch)\n      if (!aheadBehind) {\n        continue\n      }\n\n      const { ahead, behind } = aheadBehind\n      // Only perform the fast forward if the branch is behind it's upstream\n      // branch and has no local commits.\n      if (ahead === 0 && behind > 0) {\n        // At this point we're guaranteed this is non-null since we've filtered\n        // out any branches will null upstreams above when creating\n        // `eligibleBranches`.\n        const upstreamRef = branch.upstream!\n        const localRef = formatAsLocalRef(branch.name)\n        await updateRef(\n          repository,\n          localRef,\n          branch.tip.sha,\n          upstreamRef,\n          'pull: Fast-forward'\n        )\n      }\n    }\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _publishRepository(\n    repository: Repository,\n    name: string,\n    description: string,\n    private_: boolean,\n    account: Account,\n    org: IAPIUser | null\n  ): Promise<Repository> {\n    const api = API.fromAccount(account)\n    const apiRepository = await api.createRepository(\n      org,\n      name,\n      description,\n      private_\n    )\n\n    const gitStore = this.getGitStore(repository)\n    await gitStore.performFailableOperation(() =>\n      addRemote(repository, 'origin', apiRepository.clone_url)\n    )\n    await gitStore.loadRemotes()\n\n    // skip pushing if the current branch is a detached HEAD or the repository\n    // is unborn\n    if (gitStore.tip.kind === TipState.Valid) {\n      await this.performPush(repository, account)\n    }\n\n    return this.repositoryWithRefreshedGitHubRepository(repository)\n  }\n\n  private getAccountForRemoteURL(remote: string): IGitAccount | null {\n    const gitHubRepository = matchGitHubRepository(this.accounts, remote)\n    if (gitHubRepository) {\n      const account = getAccountForEndpoint(\n        this.accounts,\n        gitHubRepository.endpoint\n      )\n      if (account) {\n        const hasValidToken =\n          account.token.length > 0 ? 'has token' : 'empty token'\n        log.info(\n          `[AppStore.getAccountForRemoteURL] account found for remote: ${remote} - ${\n            account.login\n          } (${hasValidToken})`\n        )\n        return account\n      }\n    }\n\n    const hostname = getGenericHostname(remote)\n    const username = getGenericUsername(hostname)\n    if (username != null) {\n      log.info(\n        `[AppStore.getAccountForRemoteURL] found generic credentials for '${hostname}' and '${username}'`\n      )\n      return { login: username, endpoint: hostname }\n    }\n\n    log.info(\n      `[AppStore.getAccountForRemoteURL] no generic credentials found for '${remote}'`\n    )\n\n    return null\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public _clone(\n    url: string,\n    path: string,\n    options?: { branch?: string }\n  ): { promise: Promise<boolean>; repository: CloningRepository } {\n    const account = this.getAccountForRemoteURL(url)\n    const promise = this.cloningRepositoriesStore.clone(url, path, {\n      ...options,\n      account,\n    })\n    const repository = this.cloningRepositoriesStore.repositories.find(\n      r => r.url === url && r.path === path\n    )!\n\n    promise.then(success => {\n      if (success) {\n        this.statsStore.recordCloneRepository()\n      }\n    })\n\n    return { promise, repository }\n  }\n\n  public _removeCloningRepository(repository: CloningRepository) {\n    this.cloningRepositoriesStore.remove(repository)\n  }\n\n  public async _discardChanges(\n    repository: Repository,\n    files: ReadonlyArray<WorkingDirectoryFileChange>\n  ) {\n    const gitStore = this.getGitStore(repository)\n    await gitStore.discardChanges(files)\n\n    return this._refreshRepository(repository)\n  }\n\n  public async _undoCommit(\n    repository: Repository,\n    commit: Commit\n  ): Promise<void> {\n    const gitStore = this.getGitStore(repository)\n\n    await gitStore.undoCommit(commit)\n\n    const { commitSelection } = this.repositoryStateCache.get(repository)\n\n    if (commitSelection.sha === commit.sha) {\n      this.clearSelectedCommit(repository)\n    }\n\n    return this._refreshRepository(repository)\n  }\n\n  /**\n   * Fetch a specific refspec for the repository.\n   *\n   * As this action is required to complete when viewing a Pull Request from\n   * a fork, it does not opt-in to checks that prevent multiple concurrent\n   * network actions. This might require some rework in the future to chain\n   * these actions.\n   *\n   */\n  public async _fetchRefspec(\n    repository: Repository,\n    refspec: string\n  ): Promise<void> {\n    return this.withAuthenticatingUser(\n      repository,\n      async (repository, account) => {\n        const gitStore = this.getGitStore(repository)\n        await gitStore.fetchRefspec(account, refspec)\n\n        return this._refreshRepository(repository)\n      }\n    )\n  }\n\n  /**\n   * Fetch all relevant remotes in the the repository.\n   *\n   * See gitStore.fetch for more details.\n   *\n   * Note that this method will not perform the fetch of the specified remote\n   * if _any_ fetches or pulls are currently in-progress.\n   */\n  public _fetch(repository: Repository, fetchType: FetchType): Promise<void> {\n    return this.withAuthenticatingUser(repository, (repository, account) => {\n      return this.performFetch(repository, account, fetchType)\n    })\n  }\n\n  /**\n   * Fetch a particular remote in a repository.\n   *\n   * Note that this method will not perform the fetch of the specified remote\n   * if _any_ fetches or pulls are currently in-progress.\n   */\n  private _fetchRemote(\n    repository: Repository,\n    remote: IRemote,\n    fetchType: FetchType\n  ): Promise<void> {\n    return this.withAuthenticatingUser(repository, (repository, account) => {\n      return this.performFetch(repository, account, fetchType, [remote])\n    })\n  }\n\n  /**\n   * Fetch all relevant remotes or one or more given remotes in the repository.\n   *\n   * @param remotes Optional, one or more remotes to fetch if undefined all\n   *                relevant remotes will be fetched. See gitStore.fetch for\n   *                more detail on what constitutes a relevant remote.\n   */\n  private async performFetch(\n    repository: Repository,\n    account: IGitAccount | null,\n    fetchType: FetchType,\n    remotes?: IRemote[]\n  ): Promise<void> {\n    await this.withPushPull(repository, async () => {\n      const gitStore = this.getGitStore(repository)\n\n      try {\n        const fetchWeight = 0.9\n        const refreshWeight = 0.1\n        const isBackgroundTask = fetchType === FetchType.BackgroundTask\n\n        const progressCallback = (progress: IFetchProgress) => {\n          this.updatePushPullFetchProgress(repository, {\n            ...progress,\n            value: progress.value * fetchWeight,\n          })\n        }\n\n        if (remotes === undefined) {\n          await gitStore.fetch(account, isBackgroundTask, progressCallback)\n        } else {\n          await gitStore.fetchRemotes(\n            account,\n            remotes,\n            isBackgroundTask,\n            progressCallback\n          )\n        }\n\n        const refreshTitle = __DARWIN__\n          ? 'Refreshing Repository'\n          : 'Refreshing repository'\n\n        this.updatePushPullFetchProgress(repository, {\n          kind: 'generic',\n          title: refreshTitle,\n          value: fetchWeight,\n        })\n\n        await this._refreshRepository(repository)\n\n        this.updatePushPullFetchProgress(repository, {\n          kind: 'generic',\n          title: refreshTitle,\n          description: 'Fast-forwarding branches',\n          value: fetchWeight + refreshWeight * 0.5,\n        })\n\n        await this.fastForwardBranches(repository)\n      } finally {\n        this.updatePushPullFetchProgress(repository, null)\n\n        if (fetchType === FetchType.UserInitiatedTask) {\n          this._refreshPullRequests(repository)\n          if (repository.gitHubRepository != null) {\n            this._refreshIssues(repository.gitHubRepository)\n          }\n        }\n      }\n    })\n  }\n\n  public _endWelcomeFlow(): Promise<void> {\n    this.showWelcomeFlow = false\n\n    this.emitUpdate()\n\n    markWelcomeFlowComplete()\n\n    this.statsStore.recordWelcomeWizardTerminated()\n\n    return Promise.resolve()\n  }\n\n  public _setSidebarWidth(width: number): Promise<void> {\n    this.sidebarWidth = width\n    localStorage.setItem(sidebarWidthConfigKey, width.toString())\n    this.emitUpdate()\n\n    return Promise.resolve()\n  }\n\n  public _resetSidebarWidth(): Promise<void> {\n    this.sidebarWidth = defaultSidebarWidth\n    localStorage.removeItem(sidebarWidthConfigKey)\n    this.emitUpdate()\n\n    return Promise.resolve()\n  }\n\n  public _setCommitSummaryWidth(width: number): Promise<void> {\n    this.commitSummaryWidth = width\n    localStorage.setItem(commitSummaryWidthConfigKey, width.toString())\n    this.emitUpdate()\n\n    return Promise.resolve()\n  }\n\n  public _resetCommitSummaryWidth(): Promise<void> {\n    this.commitSummaryWidth = defaultCommitSummaryWidth\n    localStorage.removeItem(commitSummaryWidthConfigKey)\n    this.emitUpdate()\n\n    return Promise.resolve()\n  }\n\n  public _setCommitMessage(\n    repository: Repository,\n    message: ICommitMessage | null\n  ): Promise<void> {\n    const gitStore = this.getGitStore(repository)\n    return gitStore.setCommitMessage(message)\n  }\n\n  /**\n   * Set the global application menu.\n   *\n   * This is called in response to the main process emitting an event signalling\n   * that the application menu has changed in some way like an item being\n   * added/removed or an item having its visibility toggled.\n   *\n   * This method should not be called by the renderer in any other circumstance\n   * than as a directly result of the main-process event.\n   *\n   */\n  private setAppMenu(menu: IMenu): Promise<void> {\n    if (this.appMenu) {\n      this.appMenu = this.appMenu.withMenu(menu)\n    } else {\n      this.appMenu = AppMenu.fromMenu(menu)\n    }\n\n    this.emitUpdate()\n    return Promise.resolve()\n  }\n\n  public _setAppMenuState(\n    update: (appMenu: AppMenu) => AppMenu\n  ): Promise<void> {\n    if (this.appMenu) {\n      this.appMenu = update(this.appMenu)\n      this.emitUpdate()\n    }\n    return Promise.resolve()\n  }\n\n  public _setAccessKeyHighlightState(highlight: boolean): Promise<void> {\n    if (this.highlightAccessKeys !== highlight) {\n      this.highlightAccessKeys = highlight\n      this.emitUpdate()\n    }\n\n    return Promise.resolve()\n  }\n\n  public async _mergeBranch(\n    repository: Repository,\n    branch: string,\n    mergeStatus: MergeResultStatus | null\n  ): Promise<void> {\n    const gitStore = this.getGitStore(repository)\n\n    if (mergeStatus !== null) {\n      if (mergeStatus.kind === MergeResultKind.Clean) {\n        this.statsStore.recordMergeHintSuccessAndUserProceeded()\n      } else if (mergeStatus.kind === MergeResultKind.Conflicts) {\n        this.statsStore.recordUserProceededAfterConflictWarning()\n      } else if (mergeStatus.kind === MergeResultKind.Loading) {\n        this.statsStore.recordUserProceededWhileLoading()\n      }\n    }\n\n    await gitStore.merge(branch)\n\n    return this._refreshRepository(repository)\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public _setRemoteURL(\n    repository: Repository,\n    name: string,\n    url: string\n  ): Promise<void> {\n    const gitStore = this.getGitStore(repository)\n    return gitStore.setRemoteURL(name, url)\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _openShell(path: string) {\n    this.statsStore.recordOpenShell()\n\n    try {\n      const match = await findShellOrDefault(this.selectedShell)\n      await launchShell(match, path, error => this._pushError(error))\n    } catch (error) {\n      this.emitError(error)\n    }\n  }\n\n  /** Takes a URL and opens it using the system default application */\n  public _openInBrowser(url: string): Promise<boolean> {\n    return shell.openExternal(url)\n  }\n\n  /** Open a path to a repository or file using the user's configured editor */\n  public async _openInExternalEditor(fullPath: string): Promise<void> {\n    const selectedExternalEditor =\n      this.getState().selectedExternalEditor || null\n\n    try {\n      const match = await findEditorOrDefault(selectedExternalEditor)\n      await launchExternalEditor(fullPath, match)\n    } catch (error) {\n      this.emitError(error)\n    }\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _saveGitIgnore(\n    repository: Repository,\n    text: string\n  ): Promise<void> {\n    await saveGitIgnore(repository, text)\n    return this._refreshRepository(repository)\n  }\n\n  /** Has the user opted out of stats reporting? */\n  public getStatsOptOut(): boolean {\n    return this.statsStore.getOptOut()\n  }\n\n  /** Set whether the user has opted out of stats reporting. */\n  public async setStatsOptOut(optOut: boolean): Promise<void> {\n    await this.statsStore.setOptOut(optOut)\n\n    this.emitUpdate()\n  }\n\n  public _setConfirmRepositoryRemovalSetting(\n    confirmRepoRemoval: boolean\n  ): Promise<void> {\n    this.confirmRepoRemoval = confirmRepoRemoval\n    localStorage.setItem(confirmRepoRemovalKey, confirmRepoRemoval ? '1' : '0')\n    this.emitUpdate()\n\n    return Promise.resolve()\n  }\n\n  public _setConfirmDiscardChangesSetting(value: boolean): Promise<void> {\n    this.confirmDiscardChanges = value\n\n    localStorage.setItem(confirmDiscardChangesKey, value ? '1' : '0')\n    this.emitUpdate()\n\n    return Promise.resolve()\n  }\n\n  public _setExternalEditor(selectedEditor: ExternalEditor): Promise<void> {\n    this.selectedExternalEditor = selectedEditor\n    localStorage.setItem(externalEditorKey, selectedEditor)\n    this.emitUpdate()\n\n    this.updateMenuItemLabels()\n\n    return Promise.resolve()\n  }\n\n  public _setShell(shell: Shell): Promise<void> {\n    this.selectedShell = shell\n    localStorage.setItem(shellKey, shell)\n    this.emitUpdate()\n\n    this.updateMenuItemLabels()\n\n    return Promise.resolve()\n  }\n\n  public _changeImageDiffType(type: ImageDiffType): Promise<void> {\n    this.imageDiffType = type\n    localStorage.setItem(imageDiffTypeKey, JSON.stringify(this.imageDiffType))\n    this.emitUpdate()\n\n    return Promise.resolve()\n  }\n\n  public _setUpdateBannerVisibility(visibility: boolean) {\n    this.isUpdateAvailableBannerVisible = visibility\n\n    this.emitUpdate()\n  }\n\n  public _setDivergingBranchBannerVisibility(\n    repository: Repository,\n    visible: boolean\n  ) {\n    const state = this.repositoryStateCache.get(repository)\n    const { compareState } = state\n\n    if (compareState.isDivergingBranchBannerVisible !== visible) {\n      this.repositoryStateCache.updateCompareState(repository, () => ({\n        isDivergingBranchBannerVisible: visible,\n      }))\n\n      if (visible) {\n        this.statsStore.recordDivergingBranchBannerDisplayed()\n      }\n\n      this.emitUpdate()\n    }\n  }\n\n  public _reportStats() {\n    return this.statsStore.reportStats(this.accounts, this.repositories)\n  }\n\n  public _recordLaunchStats(stats: ILaunchStats): Promise<void> {\n    return this.statsStore.recordLaunchStats(stats)\n  }\n\n  public async _appendIgnoreRule(\n    repository: Repository,\n    pattern: string | string[]\n  ): Promise<void> {\n    await appendIgnoreRule(repository, pattern)\n    return this._refreshRepository(repository)\n  }\n\n  public _resetSignInState(): Promise<void> {\n    this.signInStore.reset()\n    return Promise.resolve()\n  }\n\n  public _beginDotComSignIn(): Promise<void> {\n    this.signInStore.beginDotComSignIn()\n    return Promise.resolve()\n  }\n\n  public _beginEnterpriseSignIn(): Promise<void> {\n    this.signInStore.beginEnterpriseSignIn()\n    return Promise.resolve()\n  }\n\n  public _setSignInEndpoint(url: string): Promise<void> {\n    return this.signInStore.setEndpoint(url)\n  }\n\n  public _setSignInCredentials(\n    username: string,\n    password: string\n  ): Promise<void> {\n    return this.signInStore.authenticateWithBasicAuth(username, password)\n  }\n\n  public _requestBrowserAuthentication(): Promise<void> {\n    return this.signInStore.authenticateWithBrowser()\n  }\n\n  public _setSignInOTP(otp: string): Promise<void> {\n    return this.signInStore.setTwoFactorOTP(otp)\n  }\n\n  public async _setAppFocusState(isFocused: boolean): Promise<void> {\n    if (this.appIsFocused !== isFocused) {\n      this.appIsFocused = isFocused\n      this.emitUpdate()\n    }\n  }\n\n  /**\n   * Start an Open in Desktop flow. This will return a new promise which will\n   * resolve when `_completeOpenInDesktop` is called.\n   */\n  public _startOpenInDesktop(fn: () => void): Promise<Repository | null> {\n    // tslint:disable-next-line:promise-must-complete\n    const p = new Promise<Repository | null>(\n      resolve => (this.resolveOpenInDesktop = resolve)\n    )\n    fn()\n    return p\n  }\n\n  /**\n   * Complete any active Open in Desktop flow with the repository returned by\n   * the given function.\n   */\n  public async _completeOpenInDesktop(\n    fn: () => Promise<Repository | null>\n  ): Promise<Repository | null> {\n    const resolve = this.resolveOpenInDesktop\n    this.resolveOpenInDesktop = null\n\n    const result = await fn()\n    if (resolve) {\n      resolve(result)\n    }\n\n    return result\n  }\n\n  public _updateRepositoryPath(\n    repository: Repository,\n    path: string\n  ): Promise<Repository> {\n    return this.repositoriesStore.updateRepositoryPath(repository, path)\n  }\n\n  public _removeAccount(account: Account): Promise<void> {\n    log.info(\n      `[AppStore] removing account ${account.login} (${\n        account.name\n      }) from store`\n    )\n    return this.accountsStore.removeAccount(account)\n  }\n\n  public async _addAccount(account: Account): Promise<void> {\n    log.info(\n      `[AppStore] adding account ${account.login} (${account.name}) to store`\n    )\n    await this.accountsStore.addAccount(account)\n    const selectedState = this.getState().selectedState\n\n    if (selectedState && selectedState.type === SelectionType.Repository) {\n      // ensuring we have the latest set of accounts here, rather than waiting\n      // and doing stuff when the account store emits an update and we refresh\n      // the accounts field\n      const accounts = await this.accountsStore.getAll()\n      const repoState = selectedState.state\n      const commits = repoState.commitLookup.values()\n      this.loadAndCacheUsers(selectedState.repository, accounts, commits)\n    }\n  }\n\n  private loadAndCacheUsers(\n    repository: Repository,\n    accounts: ReadonlyArray<Account>,\n    commits: Iterable<Commit>\n  ) {\n    for (const commit of commits) {\n      this.gitHubUserStore._loadAndCacheUser(\n        accounts,\n        repository,\n        commit.sha,\n        commit.author.email\n      )\n    }\n  }\n\n  public _updateRepositoryMissing(\n    repository: Repository,\n    missing: boolean\n  ): Promise<Repository> {\n    return this.repositoriesStore.updateRepositoryMissing(repository, missing)\n  }\n\n  public async _addRepositories(\n    paths: ReadonlyArray<string>\n  ): Promise<ReadonlyArray<Repository>> {\n    const addedRepositories = new Array<Repository>()\n    const lfsRepositories = new Array<Repository>()\n    for (const path of paths) {\n      const validatedPath = await validatedRepositoryPath(path)\n      if (validatedPath) {\n        log.info(`[AppStore] adding repository at ${validatedPath} to store`)\n\n        const addedRepo = await this.repositoriesStore.addRepository(\n          validatedPath\n        )\n\n        // initialize the remotes for this new repository to ensure it can fetch\n        // it's GitHub-related details using the GitHub API (if applicable)\n        const gitStore = this.getGitStore(addedRepo)\n        await gitStore.loadRemotes()\n\n        const [refreshedRepo, usingLFS] = await Promise.all([\n          this.repositoryWithRefreshedGitHubRepository(addedRepo),\n          this.isUsingLFS(addedRepo),\n        ])\n        addedRepositories.push(refreshedRepo)\n\n        if (usingLFS) {\n          lfsRepositories.push(refreshedRepo)\n        }\n      } else {\n        const error = new Error(`${path} isn't a git repository.`)\n        this.emitError(error)\n      }\n    }\n\n    if (lfsRepositories.length > 0) {\n      this._showPopup({\n        type: PopupType.InitializeLFS,\n        repositories: lfsRepositories,\n      })\n    }\n\n    return addedRepositories\n  }\n\n  public async _removeRepositories(\n    repositories: ReadonlyArray<Repository | CloningRepository>\n  ): Promise<void> {\n    const localRepositories = repositories.filter(\n      r => r instanceof Repository\n    ) as ReadonlyArray<Repository>\n    const cloningRepositories = repositories.filter(\n      r => r instanceof CloningRepository\n    ) as ReadonlyArray<CloningRepository>\n    cloningRepositories.forEach(r => {\n      this._removeCloningRepository(r)\n    })\n\n    const repositoryIDs = localRepositories.map(r => r.id)\n    for (const id of repositoryIDs) {\n      await this.repositoriesStore.removeRepository(id)\n    }\n\n    const allRepositories = await this.repositoriesStore.getAll()\n    if (allRepositories.length === 0) {\n      this._closeFoldout(FoldoutType.Repository)\n    } else {\n      this._showFoldout({ type: FoldoutType.Repository })\n    }\n  }\n\n  public async _cloneAgain(url: string, path: string): Promise<void> {\n    const { promise, repository } = this._clone(url, path)\n    await this._selectRepository(repository)\n    const success = await promise\n    if (!success) {\n      return\n    }\n\n    const repositories = this.repositories\n    const found = repositories.find(r => r.path === path)\n\n    if (found) {\n      const updatedRepository = await this._updateRepositoryMissing(\n        found,\n        false\n      )\n      await this._selectRepository(updatedRepository)\n    }\n  }\n\n  private async withAuthenticatingUser<T>(\n    repository: Repository,\n    fn: (repository: Repository, account: IGitAccount | null) => Promise<T>\n  ): Promise<T> {\n    let updatedRepository = repository\n    let account: IGitAccount | null = getAccountForRepository(\n      this.accounts,\n      updatedRepository\n    )\n\n    // If we don't have a user association, it might be because we haven't yet\n    // tried to associate the repository with a GitHub repository, or that\n    // association is out of date. So try again before we bail on providing an\n    // authenticating user.\n    if (!account) {\n      updatedRepository = await this.repositoryWithRefreshedGitHubRepository(\n        repository\n      )\n      account = getAccountForRepository(this.accounts, updatedRepository)\n    }\n\n    if (!account) {\n      const gitStore = this.getGitStore(repository)\n      const remote = gitStore.remote\n      if (remote) {\n        const hostname = getGenericHostname(remote.url)\n        const username = getGenericUsername(hostname)\n        if (username != null) {\n          account = { login: username, endpoint: hostname }\n        }\n      }\n    }\n\n    if (account instanceof Account) {\n      const hasValidToken =\n        account.token.length > 0 ? 'has token' : 'empty token'\n      log.info(\n        `[AppStore.withAuthenticatingUser] account found for repository: ${\n          repository.name\n        } - ${account.login} (${hasValidToken})`\n      )\n    }\n\n    return fn(updatedRepository, account)\n  }\n\n  private updateRevertProgress(\n    repository: Repository,\n    progress: IRevertProgress | null\n  ) {\n    this.repositoryStateCache.update(repository, () => ({\n      revertProgress: progress,\n    }))\n\n    if (this.selectedRepository === repository) {\n      this.emitUpdate()\n    }\n  }\n\n  /** This shouldn't be called directly. See `Dispatcher`. */\n  public async _revertCommit(\n    repository: Repository,\n    commit: Commit\n  ): Promise<void> {\n    return this.withAuthenticatingUser(repository, async (repo, account) => {\n      const gitStore = this.getGitStore(repo)\n\n      await gitStore.revertCommit(repo, commit, account, progress => {\n        this.updateRevertProgress(repo, progress)\n      })\n\n      this.updateRevertProgress(repo, null)\n      await this._refreshRepository(repository)\n    })\n  }\n\n  public async promptForGenericGitAuthentication(\n    repository: Repository | CloningRepository,\n    retryAction: RetryAction\n  ): Promise<void> {\n    let url\n    if (repository instanceof Repository) {\n      const gitStore = this.getGitStore(repository)\n      const remote = gitStore.remote\n      if (!remote) {\n        return\n      }\n\n      url = remote.url\n    } else {\n      url = repository.url\n    }\n\n    const hostname = getGenericHostname(url)\n    return this._showPopup({\n      type: PopupType.GenericGitAuthentication,\n      hostname,\n      retryAction,\n    })\n  }\n\n  public async _installGlobalLFSFilters(force: boolean): Promise<void> {\n    try {\n      await installGlobalLFSFilters(force)\n    } catch (error) {\n      this.emitError(error)\n    }\n  }\n\n  private async isUsingLFS(repository: Repository): Promise<boolean> {\n    try {\n      return await isUsingLFS(repository)\n    } catch (error) {\n      return false\n    }\n  }\n\n  public async _installLFSHooks(\n    repositories: ReadonlyArray<Repository>\n  ): Promise<void> {\n    for (const repo of repositories) {\n      try {\n        // At this point we've asked the user if we should install them, so\n        // force installation.\n        await installLFSHooks(repo, true)\n      } catch (error) {\n        this.emitError(error)\n      }\n    }\n  }\n\n  public _changeCloneRepositoriesTab(tab: CloneRepositoryTab): Promise<void> {\n    this.selectedCloneRepositoryTab = tab\n\n    this.emitUpdate()\n\n    return Promise.resolve()\n  }\n\n  public _openMergeTool(repository: Repository, path: string): Promise<void> {\n    const gitStore = this.getGitStore(repository)\n    return gitStore.openMergeTool(path)\n  }\n\n  public _changeBranchesTab(tab: BranchesTab): Promise<void> {\n    this.selectedBranchesTab = tab\n\n    this.emitUpdate()\n\n    return Promise.resolve()\n  }\n\n  public async _createPullRequest(repository: Repository): Promise<void> {\n    const gitHubRepository = repository.gitHubRepository\n    if (!gitHubRepository) {\n      return\n    }\n\n    const state = this.repositoryStateCache.get(repository)\n    const tip = state.branchesState.tip\n\n    if (tip.kind !== TipState.Valid) {\n      return\n    }\n\n    const branch = tip.branch\n    const aheadBehind = state.aheadBehind\n\n    if (aheadBehind == null) {\n      this._showPopup({\n        type: PopupType.PushBranchCommits,\n        repository,\n        branch,\n      })\n    } else if (aheadBehind.ahead > 0) {\n      this._showPopup({\n        type: PopupType.PushBranchCommits,\n        repository,\n        branch,\n        unPushedCommits: aheadBehind.ahead,\n      })\n    } else {\n      await this._openCreatePullRequestInBrowser(repository, branch)\n    }\n  }\n\n  public async _showPullRequest(repository: Repository): Promise<void> {\n    const gitHubRepository = repository.gitHubRepository\n\n    if (!gitHubRepository) {\n      return\n    }\n\n    const state = this.repositoryStateCache.get(repository)\n    const currentPullRequest = state.branchesState.currentPullRequest\n\n    if (!currentPullRequest) {\n      return\n    }\n\n    const baseURL = `${gitHubRepository.htmlURL}/pull/${\n      currentPullRequest.pullRequestNumber\n    }`\n\n    await this._openInBrowser(baseURL)\n  }\n\n  private async loadPullRequests(\n    repository: Repository,\n    loader: (account: Account) => void\n  ) {\n    const gitHubRepository = repository.gitHubRepository\n\n    if (gitHubRepository == null) {\n      return\n    }\n\n    const account = getAccountForEndpoint(\n      this.accounts,\n      gitHubRepository.endpoint\n    )\n\n    if (account == null) {\n      return\n    }\n\n    await loader(account)\n  }\n\n  public async _refreshPullRequests(repository: Repository): Promise<void> {\n    return this.loadPullRequests(repository, async account => {\n      await this.pullRequestStore.fetchAndCachePullRequests(repository, account)\n      this.updateMenuItemLabels(repository)\n    })\n  }\n\n  private async onPullRequestStoreUpdated(gitHubRepository: GitHubRepository) {\n    const promiseForPRs = this.pullRequestStore.fetchPullRequestsFromCache(\n      gitHubRepository\n    )\n    const isLoading = this.pullRequestStore.isFetchingPullRequests(\n      gitHubRepository\n    )\n\n    const repository = this.repositories.find(\n      r =>\n        !!r.gitHubRepository &&\n        r.gitHubRepository.dbID === gitHubRepository.dbID\n    )\n    if (!repository) {\n      return\n    }\n\n    const prs = await promiseForPRs\n    this.repositoryStateCache.updateBranchesState(repository, () => {\n      return {\n        openPullRequests: prs,\n        isLoadingPullRequests: isLoading,\n      }\n    })\n\n    this._updateCurrentPullRequest(repository)\n    this.emitUpdate()\n  }\n\n  private findAssociatedPullRequest(\n    branch: Branch,\n    pullRequests: ReadonlyArray<PullRequest>,\n    gitHubRepository: GitHubRepository,\n    remote: IRemote\n  ): PullRequest | null {\n    const upstream = branch.upstreamWithoutRemote\n\n    if (upstream == null) {\n      return null\n    }\n\n    const pr =\n      pullRequests.find(\n        pr =>\n          pr.head.ref === upstream &&\n          pr.head.gitHubRepository != null &&\n          repositoryMatchesRemote(pr.head.gitHubRepository, remote)\n      ) || null\n\n    return pr\n  }\n\n  private _updateCurrentPullRequest(repository: Repository) {\n    const gitHubRepository = repository.gitHubRepository\n\n    if (!gitHubRepository) {\n      return\n    }\n\n    this.repositoryStateCache.updateBranchesState(repository, state => {\n      let currentPullRequest: PullRequest | null = null\n\n      const { remote } = this.repositoryStateCache.get(repository)\n\n      if (state.tip.kind === TipState.Valid && remote) {\n        currentPullRequest = this.findAssociatedPullRequest(\n          state.tip.branch,\n          state.openPullRequests,\n          gitHubRepository,\n          remote\n        )\n      }\n\n      return {\n        currentPullRequest,\n      }\n    })\n\n    this.emitUpdate()\n  }\n\n  public async _openCreatePullRequestInBrowser(\n    repository: Repository,\n    branch: Branch\n  ): Promise<void> {\n    const gitHubRepository = repository.gitHubRepository\n    if (!gitHubRepository) {\n      return\n    }\n\n    const urlEncodedBranchName = escape(branch.nameWithoutRemote)\n    const baseURL = `${\n      gitHubRepository.htmlURL\n    }/pull/new/${urlEncodedBranchName}`\n\n    await this._openInBrowser(baseURL)\n  }\n\n  public async _updateExistingUpstreamRemote(\n    repository: Repository\n  ): Promise<void> {\n    const gitStore = this.getGitStore(repository)\n    await gitStore.updateExistingUpstreamRemote()\n\n    return this._refreshRepository(repository)\n  }\n\n  private getIgnoreExistingUpstreamRemoteKey(repository: Repository): string {\n    return `repository/${repository.id}/ignoreExistingUpstreamRemote`\n  }\n\n  public _ignoreExistingUpstreamRemote(repository: Repository): Promise<void> {\n    const key = this.getIgnoreExistingUpstreamRemoteKey(repository)\n    localStorage.setItem(key, '1')\n\n    return Promise.resolve()\n  }\n\n  private getIgnoreExistingUpstreamRemote(\n    repository: Repository\n  ): Promise<boolean> {\n    const key = this.getIgnoreExistingUpstreamRemoteKey(repository)\n    const value = localStorage.getItem(key)\n    return Promise.resolve(value === '1')\n  }\n\n  private async addUpstreamRemoteIfNeeded(repository: Repository) {\n    const gitStore = this.getGitStore(repository)\n    const ignored = await this.getIgnoreExistingUpstreamRemote(repository)\n    if (ignored) {\n      return\n    }\n\n    return gitStore.addUpstreamRemoteIfNeeded()\n  }\n\n  public async _checkoutPullRequest(\n    repository: Repository,\n    pullRequest: PullRequest\n  ): Promise<void> {\n    const gitHubRepository = forceUnwrap(\n      `Cannot checkout a PR if the repository doesn't have a GitHub repository`,\n      repository.gitHubRepository\n    )\n    const head = pullRequest.head\n    const isRefInThisRepo =\n      head.gitHubRepository &&\n      head.gitHubRepository.cloneURL === gitHubRepository.cloneURL\n\n    if (isRefInThisRepo) {\n      const gitStore = this.getGitStore(repository)\n      const defaultRemote = gitStore.defaultRemote\n      // if we don't have a default remote here, it's probably going\n      // to just crash and burn on checkout, but that's okay\n      if (defaultRemote != null) {\n        // the remote ref will be something like `origin/my-cool-branch`\n        const remoteRef = `${defaultRemote.name}/${head.ref}`\n\n        const remoteRefExists =\n          gitStore.allBranches.find(branch => branch.name === remoteRef) != null\n\n        // only try a fetch here if we can't find the ref\n        if (!remoteRefExists) {\n          await this._fetchRemote(\n            repository,\n            defaultRemote,\n            FetchType.UserInitiatedTask\n          )\n        }\n      }\n      await this._checkoutBranch(repository, head.ref)\n    } else if (head.gitHubRepository != null) {\n      const cloneURL = forceUnwrap(\n        \"This pull request's clone URL is not populated but should be\",\n        head.gitHubRepository.cloneURL\n      )\n      const remoteName = forkPullRequestRemoteName(\n        head.gitHubRepository.owner.login\n      )\n      const remotes = await getRemotes(repository)\n      const remote =\n        remotes.find(r => r.name === remoteName) ||\n        (await addRemote(repository, remoteName, cloneURL))\n\n      if (remote.url !== cloneURL) {\n        const error = new Error(\n          `Expected PR remote ${remoteName} url to be ${cloneURL} got ${\n            remote.url\n          }.`\n        )\n\n        log.error(error.message)\n        return this.emitError(error)\n      }\n\n      await this._fetchRemote(repository, remote, FetchType.UserInitiatedTask)\n\n      const gitStore = this.getGitStore(repository)\n\n      const localBranchName = `pr/${pullRequest.pullRequestNumber}`\n      const doesBranchExist =\n        gitStore.allBranches.find(branch => branch.name === localBranchName) !=\n        null\n\n      if (!doesBranchExist) {\n        await this._createBranch(\n          repository,\n          localBranchName,\n          `${remoteName}/${head.ref}`\n        )\n      }\n\n      await this._checkoutBranch(repository, localBranchName)\n    }\n\n    this.statsStore.recordPRBranchCheckout()\n  }\n\n  /**\n   * Set whether the user has chosen to hide or show the\n   * co-authors field in the commit message component\n   */\n  public _setShowCoAuthoredBy(\n    repository: Repository,\n    showCoAuthoredBy: boolean\n  ) {\n    this.getGitStore(repository).setShowCoAuthoredBy(showCoAuthoredBy)\n    return Promise.resolve()\n  }\n\n  /**\n   * Update the per-repository co-authors list\n   *\n   * @param repository Co-author settings are per-repository\n   * @param coAuthors  Zero or more authors\n   */\n  public _setCoAuthors(\n    repository: Repository,\n    coAuthors: ReadonlyArray<IAuthor>\n  ) {\n    this.getGitStore(repository).setCoAuthors(coAuthors)\n    return Promise.resolve()\n  }\n\n  /**\n   * Set the application-wide theme\n   */\n  public _setSelectedTheme(theme: ApplicationTheme) {\n    setPersistedTheme(theme)\n    this.selectedTheme = theme\n    this.emitUpdate()\n\n    return Promise.resolve()\n  }\n\n  /**\n   * Sets conflict state with a non-null value\n   *\n   * The presence of a non-null value signifies\n   * that the repository is in a conflicted state\n   */\n  public _mergeConflictDetected() {\n    const selection = this.getSelectedState()\n\n    if (selection === null || selection.type !== SelectionType.Repository) {\n      return\n    }\n\n    const { tip } = selection.state.branchesState\n\n    if (tip.kind !== TipState.Valid) {\n      return\n    }\n\n    const repository = selection.repository\n\n    this.repositoryStateCache.updateChangesState(repository, () => ({\n      conflictState: {\n        branch: tip.branch,\n      },\n    }))\n    this.emitUpdate()\n  }\n}\n\n/**\n * Map the cached state of the compare view to an action\n * to perform which is then used to compute the compare\n * view contents.\n */\nfunction getInitialAction(\n  cachedState: IDisplayHistory | ICompareBranch\n): CompareAction {\n  if (cachedState.kind === ComparisonView.None) {\n    return {\n      kind: CompareActionKind.History,\n    }\n  }\n\n  return {\n    kind: CompareActionKind.Branch,\n    branch: cachedState.comparisonBranch,\n    mode: cachedState.kind,\n  }\n}\n\n/**\n * Get the behind count (or 0) of the ahead/behind counter\n */\nfunction getBehindOrDefault(aheadBehind: IAheadBehind | null): number {\n  if (aheadBehind === null) {\n    return 0\n  }\n\n  return aheadBehind.behind\n}\n","import { IDataStore, ISecureStore } from './stores'\nimport { getKeyForAccount } from '../auth'\nimport { Account } from '../../models/account'\nimport { fetchUser, EmailVisibility } from '../api'\nimport { fatalError } from '../fatal-error'\nimport { BaseStore } from './base-store'\n\n/** The data-only interface for storage. */\ninterface IEmail {\n  readonly email: string\n  /**\n   * Represents whether GitHub has confirmed the user has access to this\n   * email address. New users require a verified email address before\n   * they can sign into GitHub Desktop.\n   */\n  readonly verified: boolean\n  /**\n   * Flag for the user's preferred email address. Other email addresses\n   * are provided for associating commit authors with the one GitHub account.\n   */\n  readonly primary: boolean\n\n  /** The way in which the email is visible. */\n  readonly visibility: EmailVisibility\n}\n\nfunction isKeyChainError(e: any) {\n  const error = e as Error\n  return (\n    error.message &&\n    error.message.startsWith(\n      'The user name or passphrase you entered is not correct'\n    )\n  )\n}\n\n/** The data-only interface for storage. */\ninterface IAccount {\n  readonly token: string\n  readonly login: string\n  readonly endpoint: string\n  readonly emails: ReadonlyArray<IEmail>\n  readonly avatarURL: string\n  readonly id: number\n  readonly name: string\n}\n\n/** The store for logged in accounts. */\nexport class AccountsStore extends BaseStore {\n  private dataStore: IDataStore\n  private secureStore: ISecureStore\n\n  private accounts: ReadonlyArray<Account> = []\n\n  /** A promise that will resolve when the accounts have been loaded. */\n  private loadingPromise: Promise<void>\n\n  public constructor(dataStore: IDataStore, secureStore: ISecureStore) {\n    super()\n\n    this.dataStore = dataStore\n    this.secureStore = secureStore\n    this.loadingPromise = this.loadFromStore()\n  }\n\n  /**\n   * Get the list of accounts in the cache.\n   */\n  public async getAll(): Promise<ReadonlyArray<Account>> {\n    await this.loadingPromise\n\n    return this.accounts.slice()\n  }\n\n  /**\n   * Add the account to the store.\n   */\n  public async addAccount(account: Account): Promise<void> {\n    await this.loadingPromise\n\n    let updated = account\n    try {\n      updated = await updatedAccount(account)\n    } catch (e) {\n      log.warn(`Failed to fetch user ${account.login}`, e)\n    }\n\n    try {\n      await this.secureStore.setItem(\n        getKeyForAccount(updated),\n        updated.login,\n        updated.token\n      )\n    } catch (e) {\n      log.error(`Error adding account '${account.login}'`, e)\n\n      if (__DARWIN__ && isKeyChainError(e)) {\n        this.emitError(\n          new Error(\n            `GitHub Desktop was unable to store the account token in the keychain. Please check you have unlocked access to the 'login' keychain.`\n          )\n        )\n      } else {\n        this.emitError(e)\n      }\n      return\n    }\n\n    this.accounts = [...this.accounts, updated]\n\n    this.save()\n  }\n\n  /** Refresh all accounts by fetching their latest info from the API. */\n  public async refresh(): Promise<void> {\n    this.accounts = await Promise.all(\n      this.accounts.map(acc => this.tryUpdateAccount(acc))\n    )\n\n    this.save()\n    this.emitUpdate()\n  }\n\n  /**\n   * Attempts to update the Account with new information from\n   * the API.\n   *\n   * If the update fails for whatever reason this function\n   * will return the old Account instance. Usually updates fails\n   * due to connectivity issues but in the future we should\n   * investigate whether we're able to detect here that the\n   * token is definitely not valid anymore and let the\n   * user know that they've been signed out.\n   */\n  private async tryUpdateAccount(account: Account): Promise<Account> {\n    try {\n      return await updatedAccount(account)\n    } catch (e) {\n      log.warn(`Error refreshing account '${account.login}'`, e)\n      return account\n    }\n  }\n\n  /**\n   * Remove the account from the store.\n   */\n  public async removeAccount(account: Account): Promise<void> {\n    await this.loadingPromise\n\n    try {\n      await this.secureStore.deleteItem(\n        getKeyForAccount(account),\n        account.login\n      )\n    } catch (e) {\n      log.error(`Error removing account '${account.login}'`, e)\n      this.emitError(e)\n      return\n    }\n\n    this.accounts = this.accounts.filter(a => a.id !== account.id)\n\n    this.save()\n  }\n\n  /**\n   * Load the users into memory from storage.\n   */\n  private async loadFromStore(): Promise<void> {\n    const raw = this.dataStore.getItem('users')\n    if (!raw || !raw.length) {\n      return\n    }\n\n    const rawAccounts: ReadonlyArray<IAccount> = JSON.parse(raw)\n    const accountsWithTokens = []\n    for (const account of rawAccounts) {\n      const accountWithoutToken = new Account(\n        account.login,\n        account.endpoint,\n        '',\n        account.emails,\n        account.avatarURL,\n        account.id,\n        account.name\n      )\n\n      const key = getKeyForAccount(accountWithoutToken)\n      try {\n        const token = await this.secureStore.getItem(key, account.login)\n        accountsWithTokens.push(accountWithoutToken.withToken(token || ''))\n      } catch (e) {\n        log.error(`Error getting token for '${key}'. Skipping.`, e)\n\n        this.emitError(e)\n      }\n    }\n\n    this.accounts = accountsWithTokens\n    this.emitUpdate()\n  }\n\n  private save() {\n    const usersWithoutTokens = this.accounts.map(account =>\n      account.withToken('')\n    )\n    this.dataStore.setItem('users', JSON.stringify(usersWithoutTokens))\n\n    this.emitUpdate()\n  }\n}\n\nasync function updatedAccount(account: Account): Promise<Account> {\n  if (!account.token) {\n    return fatalError(\n      `Cannot update an account which doesn't have a token: ${account.login}`\n    )\n  }\n\n  return fetchUser(account.endpoint, account.token)\n}\n","export { Welcome } from './welcome'\n","/** Convert input string to current platform's text case preference. */\nexport function toPlatformCase(inputText: string): string {\n  inputText = inputText.toLowerCase()\n\n  if (__DARWIN__) {\n    // Capitalize the first letter of every word.\n    inputText = inputText.replace(/\\b[a-z]/gi, $1 => $1.toUpperCase())\n  } else {\n    // Capitalize the first letter of the first word.\n    inputText = inputText.replace(/\\b[a-z]/i, $1 => $1.toUpperCase())\n  }\n\n  return inputText\n}\n","import * as React from 'react'\n\nimport { Repository } from '../../models/repository'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { WorkingDirectoryFileChange } from '../../models/status'\nimport { Button } from '../lib/button'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Dialog, DialogContent, DialogFooter } from '../dialog'\nimport { PathText } from '../lib/path-text'\nimport { Monospaced } from '../lib/monospaced'\nimport { Checkbox, CheckboxValue } from '../lib/checkbox'\nimport { TrashNameLabel } from '../lib/context-menu'\nimport { toPlatformCase } from '../../lib/platform-case'\n\ninterface IDiscardChangesProps {\n  readonly repository: Repository\n  readonly dispatcher: Dispatcher\n  readonly files: ReadonlyArray<WorkingDirectoryFileChange>\n  readonly confirmDiscardChanges: boolean\n  /**\n   * Determines whether to show the option\n   * to ask for confirmation when discarding\n   * changes\n   */\n  readonly discardingAllChanges: boolean\n  readonly showDiscardChangesSetting: boolean\n  readonly onDismissed: () => void\n  readonly onConfirmDiscardChangesChanged: (optOut: boolean) => void\n}\n\ninterface IDiscardChangesState {\n  /**\n   * Whether or not we're currently in the process of discarding\n   * changes. This is used to display a loading state\n   */\n  readonly isDiscardingChanges: boolean\n\n  readonly confirmDiscardChanges: boolean\n}\n\n/**\n * If we're discarding any more than this number, we won't bother listing them\n * all.\n */\nconst MaxFilesToList = 10\n\n/** A component to confirm and then discard changes. */\nexport class DiscardChanges extends React.Component<\n  IDiscardChangesProps,\n  IDiscardChangesState\n> {\n  public constructor(props: IDiscardChangesProps) {\n    super(props)\n\n    this.state = {\n      isDiscardingChanges: false,\n      confirmDiscardChanges: this.props.confirmDiscardChanges,\n    }\n  }\n\n  public render() {\n    const discardingAllChanges = this.props.discardingAllChanges\n\n    return (\n      <Dialog\n        id=\"discard-changes\"\n        title={\n          discardingAllChanges\n            ? toPlatformCase('Confirm Discard All Changes')\n            : toPlatformCase('Confirm Discard Changes')\n        }\n        onDismissed={this.props.onDismissed}\n        type=\"warning\"\n      >\n        <DialogContent>\n          {this.renderFileList()}\n          <p>\n            Changes can be restored by retrieving them from the {TrashNameLabel}\n            .\n          </p>\n          {this.renderConfirmDiscardChanges()}\n        </DialogContent>\n\n        <DialogFooter>\n          <ButtonGroup destructive={true}>\n            <Button type=\"submit\">Cancel</Button>\n            <Button onClick={this.discard}>\n              {discardingAllChanges\n                ? toPlatformCase('Discard All Changes')\n                : toPlatformCase('Discard Changes')}\n            </Button>\n          </ButtonGroup>\n        </DialogFooter>\n      </Dialog>\n    )\n  }\n\n  private renderConfirmDiscardChanges() {\n    if (this.props.showDiscardChangesSetting) {\n      return (\n        <Checkbox\n          label=\"Do not show this message again\"\n          value={\n            this.state.confirmDiscardChanges\n              ? CheckboxValue.Off\n              : CheckboxValue.On\n          }\n          onChange={this.onConfirmDiscardChangesChanged}\n        />\n      )\n    } else {\n      // since we ignore the users option to not show\n      // confirmation, we don't want to show a checkbox\n      // that will have no effect\n      return null\n    }\n  }\n\n  private renderFileList() {\n    if (this.props.files.length > MaxFilesToList) {\n      return (\n        <p>\n          Are you sure you want to discard all {this.props.files.length} changed\n          files?\n        </p>\n      )\n    } else {\n      return (\n        <div>\n          <p>Are you sure you want to discard all changes to:</p>\n          <ul>\n            {this.props.files.map(p => (\n              <li key={p.id}>\n                <Monospaced>\n                  <PathText path={p.path} />\n                </Monospaced>\n              </li>\n            ))}\n          </ul>\n        </div>\n      )\n    }\n  }\n\n  private discard = async () => {\n    this.setState({ isDiscardingChanges: true })\n\n    await this.props.dispatcher.discardChanges(\n      this.props.repository,\n      this.props.files\n    )\n\n    this.props.onConfirmDiscardChangesChanged(this.state.confirmDiscardChanges)\n    this.props.onDismissed()\n  }\n\n  private onConfirmDiscardChangesChanged = (\n    event: React.FormEvent<HTMLInputElement>\n  ) => {\n    const value = !event.currentTarget.checked\n\n    this.setState({ confirmDiscardChanges: value })\n  }\n}\n","export { DiscardChanges } from './discard-changes-dialog'\n","import * as React from 'react'\nimport { ToolbarButton, ToolbarButtonStyle } from './button'\nimport { OcticonSymbol } from '../octicons'\nimport { IRevertProgress } from '../../lib/app-state'\n\ninterface IRevertProgressProps {\n  /** Progress information associated with the current operation */\n  readonly progress: IRevertProgress\n}\n\n/** Display revert progress in the toolbar. */\nexport class RevertProgress extends React.Component<IRevertProgressProps, {}> {\n  public render() {\n    const progress = this.props.progress\n    const title = progress.title || 'Hang on'\n    return (\n      <ToolbarButton\n        title=\"Reverting\"\n        description={title}\n        progressValue={progress.value}\n        className=\"revert-progress\"\n        icon={OcticonSymbol.sync}\n        iconClassName=\"spin\"\n        style={ToolbarButtonStyle.Subtitle}\n        disabled={true}\n      />\n    )\n  }\n}\n","import * as React from 'react'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { OcticonSymbol } from '../octicons'\nimport { Repository } from '../../models/repository'\nimport { TipState } from '../../models/tip'\nimport { ToolbarDropdown, DropdownState } from './dropdown'\nimport { IRepositoryState } from '../../lib/app-state'\nimport { BranchesContainer, PullRequestBadge } from '../branches'\nimport { assertNever } from '../../lib/fatal-error'\nimport { BranchesTab } from '../../models/branches-tab'\nimport { PullRequest } from '../../models/pull-request'\n\ninterface IBranchDropdownProps {\n  readonly dispatcher: Dispatcher\n\n  /** The currently selected repository. */\n  readonly repository: Repository\n\n  /** The current repository state as derived from AppState */\n  readonly repositoryState: IRepositoryState\n\n  /** Whether or not the branch dropdown is currently open */\n  readonly isOpen: boolean\n\n  /**\n   * An event handler for when the drop down is opened, or closed, by a pointer\n   * event or by pressing the space or enter key while focused.\n   *\n   * @param state    - The new state of the drop down\n   */\n  readonly onDropDownStateChanged: (state: DropdownState) => void\n\n  /** The currently selected tab. */\n  readonly selectedTab: BranchesTab\n\n  /** The open pull requests in the repository. */\n  readonly pullRequests: ReadonlyArray<PullRequest>\n\n  /** The pull request associated with the current branch. */\n  readonly currentPullRequest: PullRequest | null\n\n  /** Are we currently loading pull requests? */\n  readonly isLoadingPullRequests: boolean\n}\n\n/**\n * A drop down for selecting the currently checked out branch.\n */\nexport class BranchDropdown extends React.Component<IBranchDropdownProps> {\n  private renderBranchFoldout = (): JSX.Element | null => {\n    const repositoryState = this.props.repositoryState\n    const branchesState = repositoryState.branchesState\n\n    const tip = repositoryState.branchesState.tip\n    const currentBranch = tip.kind === TipState.Valid ? tip.branch : null\n\n    return (\n      <BranchesContainer\n        allBranches={branchesState.allBranches}\n        recentBranches={branchesState.recentBranches}\n        currentBranch={currentBranch}\n        defaultBranch={branchesState.defaultBranch}\n        dispatcher={this.props.dispatcher}\n        repository={this.props.repository}\n        selectedTab={this.props.selectedTab}\n        pullRequests={this.props.pullRequests}\n        currentPullRequest={this.props.currentPullRequest}\n        isLoadingPullRequests={this.props.isLoadingPullRequests}\n      />\n    )\n  }\n\n  private onDropDownStateChanged = (state: DropdownState) => {\n    // Don't allow opening the drop down when checkout is in progress\n    if (state === 'open' && this.props.repositoryState.checkoutProgress) {\n      return\n    }\n\n    this.props.onDropDownStateChanged(state)\n  }\n\n  public render() {\n    const repositoryState = this.props.repositoryState\n    const branchesState = repositoryState.branchesState\n\n    const tip = branchesState.tip\n    const tipKind = tip.kind\n\n    let icon = OcticonSymbol.gitBranch\n    let iconClassName: string | undefined = undefined\n    let title: string\n    let description = __DARWIN__ ? 'Current Branch' : 'Current branch'\n    let canOpen = true\n    let tooltip: string\n\n    if (this.props.currentPullRequest) {\n      icon = OcticonSymbol.gitPullRequest\n    }\n\n    if (tip.kind === TipState.Unknown) {\n      // TODO: this is bad and I feel bad\n      return null\n    } else if (tip.kind === TipState.Unborn) {\n      title = tip.ref\n      tooltip = `Current branch is ${tip.ref}`\n      canOpen = branchesState.allBranches.length > 0\n    } else if (tip.kind === TipState.Detached) {\n      title = `On ${tip.currentSha.substr(0, 7)}`\n      tooltip = 'Currently on a detached HEAD'\n      icon = OcticonSymbol.gitCommit\n      description = 'Detached HEAD'\n    } else if (tip.kind === TipState.Valid) {\n      title = tip.branch.name\n      tooltip = `Current branch is ${title}`\n    } else {\n      return assertNever(tip, `Unknown tip state: ${tipKind}`)\n    }\n\n    const checkoutProgress = repositoryState.checkoutProgress\n    let progressValue: number | undefined = undefined\n\n    if (checkoutProgress) {\n      title = checkoutProgress.targetBranch\n      description = __DARWIN__ ? 'Switching to Branch' : 'Switching to branch'\n\n      if (checkoutProgress.value > 0) {\n        const friendlyProgress = Math.round(checkoutProgress.value * 100)\n        description = `${description} (${friendlyProgress} %)`\n      }\n\n      progressValue = checkoutProgress.value\n      icon = OcticonSymbol.sync\n      iconClassName = 'spin'\n      canOpen = false\n    }\n\n    const isOpen = this.props.isOpen\n    const currentState: DropdownState = isOpen && canOpen ? 'open' : 'closed'\n\n    return (\n      <ToolbarDropdown\n        className=\"branch-button\"\n        icon={icon}\n        iconClassName={iconClassName}\n        title={title}\n        description={description}\n        tooltip={tooltip}\n        onDropdownStateChanged={this.onDropDownStateChanged}\n        dropdownContentRenderer={this.renderBranchFoldout}\n        dropdownState={currentState}\n        showDisclosureArrow={canOpen}\n        progressValue={progressValue}\n      >\n        {this.renderPullRequestInfo()}\n      </ToolbarDropdown>\n    )\n  }\n\n  private renderPullRequestInfo() {\n    const pr = this.props.currentPullRequest\n    if (!pr) {\n      return null\n    }\n\n    return <PullRequestBadge number={pr.pullRequestNumber} status={pr.status} />\n  }\n}\n","import * as React from 'react'\nimport { ToolbarButton, ToolbarButtonStyle } from './button'\nimport { Progress } from '../../lib/app-state'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { Octicon, OcticonSymbol } from '../octicons'\nimport { Repository } from '../../models/repository'\nimport { IAheadBehind } from '../../models/branch'\nimport { TipState } from '../../models/tip'\nimport { RelativeTime } from '../relative-time'\nimport { FetchType } from '../../models/fetch'\n\ninterface IPushPullButtonProps {\n  /**\n   * The ahead/behind count for the current branch. If null, it indicates the\n   * branch doesn't have an upstream.\n   */\n  readonly aheadBehind: IAheadBehind | null\n\n  /** The name of the remote. */\n  readonly remoteName: string | null\n\n  /** Is a push/pull/update in progress? */\n  readonly networkActionInProgress: boolean\n\n  /** The date of the last fetch. */\n  readonly lastFetched: Date | null\n\n  /** Progress information associated with the current operation */\n  readonly progress: Progress | null\n\n  /** The global dispatcher, to invoke repository operations. */\n  readonly dispatcher: Dispatcher\n\n  /** The current repository */\n  readonly repository: Repository\n\n  /**\n   * Indicate whether the current branch is valid, unborn or detached HEAD\n   *\n   * Used for setting the enabled/disabled and the description text.\n   */\n  readonly tipState: TipState\n}\n\n/**\n * A button which pushes, pulls, or updates depending on the state of the\n * repository.\n */\nexport class PushPullButton extends React.Component<IPushPullButtonProps, {}> {\n  public render() {\n    const progress = this.props.progress\n\n    const title = progress ? progress.title : this.getTitle()\n\n    const description = progress\n      ? progress.description || 'Hang on'\n      : this.getDescription(this.props.tipState)\n\n    const progressValue = progress ? progress.value : undefined\n\n    const networkActive =\n      this.props.networkActionInProgress || !!this.props.progress\n\n    // if we have a remote associated with this repository, we should enable this branch\n    // when the tip is valid (no detached HEAD, no unborn repository)\n    //\n    // otherwise we consider the repository unpublished, and they should be able to\n    // open the publish dialog - we'll handle publishing the current branch afterwards\n    // if it exists\n    const validState = this.props.remoteName\n      ? this.props.tipState === TipState.Valid\n      : true\n\n    const disabled = !validState || networkActive\n\n    return (\n      <ToolbarButton\n        title={title}\n        description={description}\n        progressValue={progressValue}\n        className=\"push-pull-button\"\n        icon={this.getIcon()}\n        iconClassName={this.props.networkActionInProgress ? 'spin' : ''}\n        style={ToolbarButtonStyle.Subtitle}\n        onClick={this.performAction}\n        tooltip={progress ? progress.description : undefined}\n        disabled={disabled}\n      >\n        {this.renderAheadBehind()}\n      </ToolbarButton>\n    )\n  }\n\n  private renderAheadBehind() {\n    if (!this.props.aheadBehind || this.props.progress) {\n      return null\n    }\n\n    const { ahead, behind } = this.props.aheadBehind\n    if (ahead === 0 && behind === 0) {\n      return null\n    }\n\n    const content: JSX.Element[] = []\n    if (ahead > 0) {\n      content.push(\n        <span key=\"ahead\">\n          {ahead}\n          <Octicon symbol={OcticonSymbol.arrowSmallUp} />\n        </span>\n      )\n    }\n\n    if (behind > 0) {\n      content.push(\n        <span key=\"behind\">\n          {behind}\n          <Octicon symbol={OcticonSymbol.arrowSmallDown} />\n        </span>\n      )\n    }\n\n    return <div className=\"ahead-behind\">{content}</div>\n  }\n\n  private getTitle(): string {\n    if (!this.props.remoteName) {\n      return 'Publish repository'\n    }\n    if (!this.props.aheadBehind) {\n      return 'Publish branch'\n    }\n\n    const { ahead, behind } = this.props.aheadBehind\n    const actionName = (function() {\n      if (behind > 0) {\n        return 'Pull'\n      }\n      if (ahead > 0) {\n        return 'Push'\n      }\n      return 'Fetch'\n    })()\n\n    return `${actionName} ${this.props.remoteName}`\n  }\n\n  private getIcon(): OcticonSymbol {\n    if (this.props.networkActionInProgress) {\n      return OcticonSymbol.sync\n    }\n\n    if (!this.props.remoteName) {\n      return OcticonSymbol.cloudUpload\n    }\n    if (!this.props.aheadBehind) {\n      return OcticonSymbol.cloudUpload\n    }\n\n    const { ahead, behind } = this.props.aheadBehind\n    if (this.props.networkActionInProgress) {\n      return OcticonSymbol.sync\n    }\n    if (behind > 0) {\n      return OcticonSymbol.arrowDown\n    }\n    if (ahead > 0) {\n      return OcticonSymbol.arrowUp\n    }\n    return OcticonSymbol.sync\n  }\n\n  private getDescription(tipState: TipState): JSX.Element | string {\n    if (!this.props.remoteName) {\n      return 'Publish this repository to GitHub'\n    }\n\n    if (tipState === TipState.Detached) {\n      return 'Cannot publish detached HEAD'\n    }\n\n    if (tipState === TipState.Unborn) {\n      return 'Cannot publish unborn HEAD'\n    }\n\n    if (!this.props.aheadBehind) {\n      const isGitHub = !!this.props.repository.gitHubRepository\n      return isGitHub\n        ? 'Publish this branch to GitHub'\n        : 'Publish this branch to the remote'\n    }\n\n    const lastFetched = this.props.lastFetched\n    if (lastFetched) {\n      return (\n        <span>\n          Last fetched <RelativeTime date={lastFetched} />\n        </span>\n      )\n    } else {\n      return 'Never fetched'\n    }\n  }\n\n  private performAction = () => {\n    const repository = this.props.repository\n    const dispatcher = this.props.dispatcher\n    const aheadBehind = this.props.aheadBehind\n\n    if (!aheadBehind) {\n      dispatcher.push(repository)\n      return\n    }\n\n    const { ahead, behind } = aheadBehind\n\n    if (behind > 0) {\n      dispatcher.pull(repository)\n    } else if (ahead > 0) {\n      dispatcher.push(repository)\n    } else {\n      dispatcher.fetch(repository, FetchType.UserInitiatedTask)\n    }\n  }\n}\n","/**\n * Returns a value indicating whether the two supplied client\n * rect instances are structurally equal (i.e. all their individual\n * values are equal).\n */\nexport function rectEquals(x: ClientRect, y: ClientRect) {\n  if (x === y) {\n    return true\n  }\n\n  return (\n    x.left === y.left &&\n    x.right === y.right &&\n    x.top === y.top &&\n    x.bottom === y.bottom &&\n    x.width === y.width &&\n    x.height === y.height\n  )\n}\n","import * as React from 'react'\n\ninterface IToolbarProps {\n  readonly id?: string\n}\n\n/** The main application toolbar component. */\nexport class Toolbar extends React.Component<IToolbarProps, {}> {\n  public render() {\n    return (\n      <div id={this.props.id} className=\"toolbar\">\n        {this.props.children}\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\n\nimport { CloningRepository } from '../models/cloning-repository'\nimport { ICloneProgress } from '../lib/app-state'\nimport { Octicon, OcticonSymbol } from './octicons'\nimport { UiView } from './ui-view'\n\ninterface ICloningRepositoryProps {\n  readonly repository: CloningRepository\n  readonly progress: ICloneProgress\n}\n\n/** The component for displaying a cloning repository's progress. */\nexport class CloningRepositoryView extends React.Component<\n  ICloningRepositoryProps,\n  {}\n> {\n  public render() {\n    /* The progress element won't take null for an answer.\n     * Only way to get it to be indeterminate is by using undefined */\n    const progressValue = this.props.progress.value || undefined\n\n    return (\n      <UiView id=\"cloning-repository-view\">\n        <div className=\"title-container\">\n          <Octicon symbol={OcticonSymbol.desktopDownload} />\n          <div className=\"title\">Cloning {this.props.repository.name}</div>\n        </div>\n        <progress value={progressValue} />\n        <div className=\"details\">{this.props.progress.description}</div>\n      </UiView>\n    )\n  }\n}\n","import * as React from 'react'\n\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { Repository } from '../../models/repository'\nimport { Branch } from '../../models/branch'\nimport { Button } from '../lib/button'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Checkbox, CheckboxValue } from '../lib/checkbox'\nimport { Dialog, DialogContent, DialogFooter } from '../dialog'\nimport { Ref } from '../lib/ref'\n\ninterface IDeleteBranchProps {\n  readonly dispatcher: Dispatcher\n  readonly repository: Repository\n  readonly branch: Branch\n  readonly existsOnRemote: boolean\n  readonly onDismissed: () => void\n  readonly onDeleted: (repository: Repository) => void\n}\n\ninterface IDeleteBranchState {\n  readonly includeRemoteBranch: boolean\n  readonly isDeleting: boolean\n}\n\nexport class DeleteBranch extends React.Component<\n  IDeleteBranchProps,\n  IDeleteBranchState\n> {\n  public constructor(props: IDeleteBranchProps) {\n    super(props)\n\n    this.state = {\n      includeRemoteBranch: false,\n      isDeleting: false,\n    }\n  }\n\n  public render() {\n    return (\n      <Dialog\n        id=\"delete-branch\"\n        title={__DARWIN__ ? 'Delete Branch' : 'Delete branch'}\n        type=\"warning\"\n        onDismissed={this.props.onDismissed}\n        disabled={this.state.isDeleting}\n        loading={this.state.isDeleting}\n      >\n        <DialogContent>\n          <p>\n            Delete branch <Ref>{this.props.branch.name}</Ref>?<br />\n            This action cannot be undone.\n          </p>\n\n          {this.renderDeleteOnRemote()}\n        </DialogContent>\n        <DialogFooter>\n          <ButtonGroup destructive={true}>\n            <Button type=\"submit\">Cancel</Button>\n            <Button onClick={this.deleteBranch}>Delete</Button>\n          </ButtonGroup>\n        </DialogFooter>\n      </Dialog>\n    )\n  }\n\n  private renderDeleteOnRemote() {\n    if (this.props.branch.remote && this.props.existsOnRemote) {\n      return (\n        <div>\n          <p>\n            <strong>\n              The branch also exists on the remote, do you wish to delete it\n              there as well?\n            </strong>\n          </p>\n          <Checkbox\n            label=\"Yes, delete this branch on the remote\"\n            value={\n              this.state.includeRemoteBranch\n                ? CheckboxValue.On\n                : CheckboxValue.Off\n            }\n            onChange={this.onIncludeRemoteChanged}\n          />\n        </div>\n      )\n    }\n\n    return null\n  }\n\n  private onIncludeRemoteChanged = (\n    event: React.FormEvent<HTMLInputElement>\n  ) => {\n    const value = event.currentTarget.checked\n\n    this.setState({ includeRemoteBranch: value })\n  }\n\n  private deleteBranch = async () => {\n    const { dispatcher, repository, branch } = this.props\n\n    this.setState({ isDeleting: true })\n\n    await dispatcher.deleteBranch(\n      repository,\n      branch,\n      this.state.includeRemoteBranch\n    )\n    this.props.onDeleted(repository)\n\n    await dispatcher.closePopup()\n  }\n}\n","export { DeleteBranch } from './delete-branch-dialog'\n","import * as React from 'react'\n\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { Repository } from '../../models/repository'\nimport { Branch } from '../../models/branch'\nimport { sanitizedBranchName } from '../../lib/sanitize-branch'\nimport { TextBox } from '../lib/text-box'\nimport { Row } from '../lib/row'\nimport { Button } from '../lib/button'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Dialog, DialogContent, DialogFooter } from '../dialog'\nimport {\n  renderBranchNameWarning,\n  renderBranchHasRemoteWarning,\n} from '../lib/branch-name-warnings'\n\ninterface IRenameBranchProps {\n  readonly dispatcher: Dispatcher\n  readonly repository: Repository\n  readonly branch: Branch\n}\n\ninterface IRenameBranchState {\n  readonly newName: string\n}\n\nexport class RenameBranch extends React.Component<\n  IRenameBranchProps,\n  IRenameBranchState\n> {\n  public constructor(props: IRenameBranchProps) {\n    super(props)\n\n    this.state = { newName: props.branch.name }\n  }\n\n  public render() {\n    const disabled =\n      !this.state.newName.length || /^\\s*$/.test(this.state.newName)\n    return (\n      <Dialog\n        id=\"rename-branch\"\n        title={__DARWIN__ ? 'Rename Branch' : 'Rename branch'}\n        onDismissed={this.cancel}\n        onSubmit={this.renameBranch}\n      >\n        <DialogContent>\n          <Row>\n            <TextBox\n              label=\"Name\"\n              autoFocus={true}\n              value={this.state.newName}\n              onValueChanged={this.onNameChange}\n            />\n          </Row>\n          {renderBranchNameWarning(\n            this.state.newName,\n            sanitizedBranchName(this.state.newName)\n          )}\n          {renderBranchHasRemoteWarning(this.props.branch)}\n        </DialogContent>\n\n        <DialogFooter>\n          <ButtonGroup>\n            <Button type=\"submit\" disabled={disabled}>\n              Rename {this.props.branch.name}\n            </Button>\n            <Button onClick={this.cancel}>Cancel</Button>\n          </ButtonGroup>\n        </DialogFooter>\n      </Dialog>\n    )\n  }\n\n  private onNameChange = (name: string) => {\n    this.setState({ newName: name })\n  }\n\n  private cancel = () => {\n    this.props.dispatcher.closePopup()\n  }\n\n  private renameBranch = () => {\n    const name = sanitizedBranchName(this.state.newName)\n    this.props.dispatcher.renameBranch(\n      this.props.repository,\n      this.props.branch,\n      name\n    )\n    this.props.dispatcher.closePopup()\n  }\n}\n","export { RenameBranch } from './rename-branch-dialog'\n","import * as React from 'react'\n\nimport { CompareActionKind, MergeResultStatus } from '../../lib/app-state'\nimport { Repository } from '../../models/repository'\nimport { Branch } from '../../models/branch'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { Button } from '../lib/button'\nimport { MergeStatusHeader } from './merge-status-header'\nimport { MergeResultKind } from '../../models/merge'\n\ninterface IMergeCallToActionWithConflictsProps {\n  readonly repository: Repository\n  readonly dispatcher: Dispatcher\n  readonly mergeStatus: MergeResultStatus | null\n  readonly currentBranch: Branch\n  readonly comparisonBranch: Branch\n  readonly commitsBehind: number\n\n  /**\n   * Callback to execute after a merge has been performed\n   */\n  readonly onMerged: () => void\n}\n\nexport class MergeCallToActionWithConflicts extends React.Component<\n  IMergeCallToActionWithConflictsProps,\n  {}\n> {\n  public render() {\n    const { commitsBehind } = this.props\n\n    const cannotMergeBranch =\n      this.props.mergeStatus != null &&\n      this.props.mergeStatus.kind === MergeResultKind.Invalid\n\n    const disabled = commitsBehind <= 0 || cannotMergeBranch\n\n    const mergeDetails = commitsBehind > 0 ? this.renderMergeStatus() : null\n\n    return (\n      <div className=\"merge-cta\">\n        <Button type=\"submit\" disabled={disabled} onClick={this.onMergeClicked}>\n          Merge into <strong>{this.props.currentBranch.name}</strong>\n        </Button>\n\n        {mergeDetails}\n      </div>\n    )\n  }\n\n  private renderMergeStatus() {\n    return (\n      <div className=\"merge-status-component\">\n        <MergeStatusHeader status={this.props.mergeStatus} />\n\n        {this.renderMergeDetails(\n          this.props.currentBranch,\n          this.props.comparisonBranch,\n          this.props.mergeStatus,\n          this.props.commitsBehind\n        )}\n      </div>\n    )\n  }\n\n  private renderMergeDetails(\n    currentBranch: Branch,\n    comparisonBranch: Branch,\n    mergeStatus: MergeResultStatus | null,\n    behindCount: number\n  ) {\n    if (mergeStatus === null) {\n      return null\n    }\n\n    if (mergeStatus.kind === MergeResultKind.Loading) {\n      return this.renderLoadingMergeMessage()\n    }\n    if (mergeStatus.kind === MergeResultKind.Clean) {\n      return this.renderCleanMergeMessage(\n        currentBranch,\n        comparisonBranch,\n        behindCount\n      )\n    }\n    if (mergeStatus.kind === MergeResultKind.Invalid) {\n      return this.renderInvalidMergeMessage()\n    }\n    if (mergeStatus.kind === MergeResultKind.Conflicts) {\n      return this.renderConflictedMergeMessage(\n        currentBranch,\n        comparisonBranch,\n        mergeStatus.conflictedFiles\n      )\n    }\n    return null\n  }\n\n  private renderLoadingMergeMessage() {\n    return (\n      <div className=\"merge-message merge-message-loading\">\n        Checking for ability to merge automatically...\n      </div>\n    )\n  }\n\n  private renderCleanMergeMessage(\n    currentBranch: Branch,\n    branch: Branch,\n    count: number\n  ) {\n    if (count > 0) {\n      const pluralized = count === 1 ? 'commit' : 'commits'\n      return (\n        <div className=\"merge-message\">\n          This will merge\n          <strong>{` ${count} ${pluralized}`}</strong>\n          {` from `}\n          <strong>{branch.name}</strong>\n          {` into `}\n          <strong>{currentBranch.name}</strong>\n        </div>\n      )\n    } else {\n      return null\n    }\n  }\n\n  private renderInvalidMergeMessage() {\n    return (\n      <div className=\"merge-message\">\n        Unable to merge unrelated histories in this repository\n      </div>\n    )\n  }\n\n  private renderConflictedMergeMessage(\n    currentBranch: Branch,\n    branch: Branch,\n    count: number\n  ) {\n    const pluralized = count === 1 ? 'file' : 'files'\n    return (\n      <div className=\"merge-message\">\n        There will be\n        <strong>{` ${count} conflicted ${pluralized}`}</strong>\n        {` when merging `}\n        <strong>{branch.name}</strong>\n        {` into `}\n        <strong>{currentBranch.name}</strong>\n      </div>\n    )\n  }\n\n  private onMergeClicked = async () => {\n    const { comparisonBranch, repository, mergeStatus } = this.props\n\n    this.props.dispatcher.recordCompareInitiatedMerge()\n\n    await this.props.dispatcher.mergeBranch(\n      repository,\n      comparisonBranch.name,\n      mergeStatus\n    )\n\n    this.props.dispatcher.executeCompare(repository, {\n      kind: CompareActionKind.History,\n    })\n\n    this.props.dispatcher.updateCompareForm(repository, {\n      showBranchList: false,\n      filterText: '',\n    })\n    this.props.onMerged()\n  }\n}\n","import * as React from 'react'\n\nimport { CompareActionKind, ICompareBranch } from '../../lib/app-state'\nimport { Repository } from '../../models/repository'\nimport { Branch } from '../../models/branch'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { Button } from '../lib/button'\n\ninterface IMergeCallToActionProps {\n  readonly repository: Repository\n  readonly dispatcher: Dispatcher\n  readonly currentBranch: Branch\n  readonly formState: ICompareBranch\n\n  /**\n   * Callback to execute after a merge has been performed\n   */\n  readonly onMerged: () => void\n}\n\nexport class MergeCallToAction extends React.Component<\n  IMergeCallToActionProps,\n  {}\n> {\n  public render() {\n    const count = this.props.formState.aheadBehind.behind\n\n    return (\n      <div className=\"merge-cta\">\n        <Button\n          type=\"submit\"\n          disabled={count <= 0}\n          onClick={this.onMergeClicked}\n        >\n          Merge into <strong>{this.props.currentBranch.name}</strong>\n        </Button>\n\n        {this.renderMergeDetails(\n          this.props.formState,\n          this.props.currentBranch\n        )}\n      </div>\n    )\n  }\n\n  private renderMergeDetails(formState: ICompareBranch, currentBranch: Branch) {\n    const branch = formState.comparisonBranch\n    const count = formState.aheadBehind.behind\n\n    if (count > 0) {\n      const pluralized = count === 1 ? 'commit' : 'commits'\n      return (\n        <div className=\"merge-message merge-message-legacy\">\n          This will merge\n          <strong>{` ${count} ${pluralized}`}</strong>\n          {` `}\n          from\n          {` `}\n          <strong>{branch.name}</strong>\n          {` `}\n          into\n          {` `}\n          <strong>{currentBranch.name}</strong>\n        </div>\n      )\n    }\n\n    return null\n  }\n\n  private onMergeClicked = async () => {\n    const formState = this.props.formState\n\n    this.props.dispatcher.recordCompareInitiatedMerge()\n\n    await this.props.dispatcher.mergeBranch(\n      this.props.repository,\n      formState.comparisonBranch.name,\n      null\n    )\n\n    this.props.dispatcher.executeCompare(this.props.repository, {\n      kind: CompareActionKind.History,\n    })\n\n    this.props.dispatcher.updateCompareForm(this.props.repository, {\n      showBranchList: false,\n      filterText: '',\n    })\n    this.props.onMerged()\n  }\n}\n","import * as React from 'react'\nimport { Ref } from '../lib/ref'\nimport { Octicon, OcticonSymbol } from '../octicons'\nimport { Branch } from '../../models/branch'\nimport { Button } from '../lib/button'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { Repository } from '../../models/repository'\nimport {\n  CompareActionKind,\n  ComparisonView,\n  PopupType,\n} from '../../lib/app-state'\n\nexport type DismissalReason = 'close' | 'compare' | 'merge'\n\ninterface INewCommitsBannerProps {\n  readonly dispatcher: Dispatcher\n\n  readonly repository: Repository\n\n  /**\n   * The number of commits behind base branch\n   */\n  readonly commitsBehindBaseBranch: number\n\n  /**\n   * The target branch that will accept commits\n   * from the current branch\n   */\n  readonly baseBranch: Branch\n\n  /**\n   * Callback used to dismiss the banner\n   */\n  readonly onDismiss: (reason: DismissalReason) => void\n}\n\n/**\n * Banner used to notify user that their branch is a number of commits behind the base branch\n */\nexport class NewCommitsBanner extends React.Component<\n  INewCommitsBannerProps,\n  {}\n> {\n  public render() {\n    const pluralize = this.props.commitsBehindBaseBranch > 1\n\n    return (\n      <div className=\"notification-banner diverge-banner\">\n        <Octicon\n          symbol={OcticonSymbol.lightBulb}\n          className=\"notification-icon\"\n        />\n\n        <div className=\"notification-banner-content\">\n          <div className=\"notification-banner-content-body\">\n            <p>\n              We have noticed that your branch is{' '}\n              <strong>\n                {this.props.commitsBehindBaseBranch} commit\n                {pluralize ? 's' : ''}\n              </strong>{' '}\n              behind <Ref>{this.props.baseBranch.name}</Ref>.\n            </p>\n          </div>\n          <div>\n            <Button className=\"small-button\" onClick={this.onComparedClicked}>\n              View commits\n            </Button>\n            <Button\n              className=\"small-button\"\n              type=\"submit\"\n              onClick={this.onMergeClicked}\n            >\n              Merge...\n            </Button>\n          </div>\n        </div>\n\n        <a\n          className=\"close\"\n          aria-label=\"Dismiss banner\"\n          onClick={this.onDismissed}\n        >\n          <Octicon symbol={OcticonSymbol.x} />\n        </a>\n      </div>\n    )\n  }\n\n  private onDismissed = () => {\n    this.props.onDismiss('close')\n  }\n\n  private onComparedClicked = () => {\n    const { repository, dispatcher } = this.props\n\n    dispatcher.executeCompare(repository, {\n      kind: CompareActionKind.Branch,\n      branch: this.props.baseBranch,\n      mode: ComparisonView.Behind,\n    })\n    dispatcher.recordDivergingBranchBannerInitiatedCompare()\n    this.props.onDismiss('compare')\n  }\n\n  private onMergeClicked = () => {\n    const { repository, dispatcher } = this.props\n\n    dispatcher.showPopup({\n      type: PopupType.MergeBranch,\n      branch: this.props.baseBranch,\n      repository,\n    })\n    dispatcher.recordDivergingBranchBannerInitatedMerge()\n    this.props.onDismiss('merge')\n  }\n}\n","import * as React from 'react'\nimport { Octicon, OcticonSymbol } from '../octicons'\nimport { TextBox, ITextBoxProps } from './text-box'\nimport * as classNames from 'classnames'\n\ninterface IFancyTextBoxProps extends ITextBoxProps {\n  /** Icon to render */\n  readonly symbol: OcticonSymbol\n\n  /** Callback used to get a reference to internal TextBox */\n  readonly onRef: (textbox: TextBox) => void\n}\n\ninterface IFancyTextBoxState {\n  readonly isFocused: boolean\n}\n\nexport class FancyTextBox extends React.Component<\n  IFancyTextBoxProps,\n  IFancyTextBoxState\n> {\n  public constructor(props: IFancyTextBoxProps) {\n    super(props)\n\n    this.state = { isFocused: false }\n  }\n\n  public render() {\n    const componentCSS = classNames(\n      'fancy-text-box-component',\n      this.props.className,\n      { disabled: this.props.disabled },\n      { focused: this.state.isFocused }\n    )\n    const octiconCSS = classNames('fancy-octicon')\n\n    return (\n      <div className={componentCSS}>\n        <Octicon className={octiconCSS} symbol={this.props.symbol} />\n        <TextBox\n          value={this.props.value}\n          onFocus={this.onFocus}\n          onBlur={this.onBlur}\n          autoFocus={this.props.autoFocus}\n          disabled={this.props.disabled}\n          type={this.props.type}\n          placeholder={this.props.placeholder}\n          onKeyDown={this.props.onKeyDown}\n          onValueChanged={this.props.onValueChanged}\n          onSearchCleared={this.props.onSearchCleared}\n          tabIndex={this.props.tabIndex}\n          ref={this.props.onRef}\n        />\n      </div>\n    )\n  }\n\n  private onFocus = () => {\n    if (this.props.onFocus !== undefined) {\n      this.props.onFocus()\n    }\n\n    this.setState({ isFocused: true })\n  }\n\n  private onBlur = () => {\n    if (this.props.onBlur !== undefined) {\n      this.props.onBlur()\n    }\n\n    this.setState({ isFocused: false })\n  }\n}\n","import * as React from 'react'\n\nimport { Octicon, OcticonSymbol } from '../octicons'\nimport { HighlightText } from '../lib/highlight-text'\nimport { Branch, IAheadBehind } from '../../models/branch'\nimport { IMatches } from '../../lib/fuzzy-find'\n\ninterface ICompareBranchListItemProps {\n  readonly branch: Branch\n\n  /** Specifies whether this item is currently selected */\n  readonly isCurrentBranch: boolean\n\n  /** The characters in the branch name to highlight */\n  readonly matches: IMatches\n\n  readonly aheadBehind: IAheadBehind | null\n}\n\nexport class CompareBranchListItem extends React.Component<\n  ICompareBranchListItemProps,\n  {}\n> {\n  public render() {\n    const isCurrentBranch = this.props.isCurrentBranch\n    const branch = this.props.branch\n    const icon = isCurrentBranch ? OcticonSymbol.check : OcticonSymbol.gitBranch\n\n    const aheadBehind = this.props.aheadBehind\n\n    const aheadBehindElement = aheadBehind ? (\n      <div className=\"branch-commit-counter\">\n        <span className=\"branch-commit-counter-item\">\n          {aheadBehind.behind}\n          <Octicon className=\"icon\" symbol={OcticonSymbol.arrowDown} />\n        </span>\n\n        <span className=\"branch-commit-counter-item\">\n          {aheadBehind.ahead}\n          <Octicon className=\"icon\" symbol={OcticonSymbol.arrowUp} />\n        </span>\n      </div>\n    ) : null\n\n    return (\n      <div className=\"branches-list-item\">\n        <Octicon className=\"icon\" symbol={icon} />\n        <div className=\"name\" title={branch.name}>\n          <HighlightText\n            text={branch.name}\n            highlight={this.props.matches.title}\n          />\n        </div>\n        {aheadBehindElement}\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport { CIStatus } from './ci-status'\nimport { PullRequestStatus } from '../../models/pull-request'\n\ninterface IPullRequestBadgeProps {\n  /** The CI status of the pull request. */\n  readonly status: PullRequestStatus | null\n\n  /** The pull request's number. */\n  readonly number: number\n}\n\n/** The pull request info badge. */\nexport class PullRequestBadge extends React.Component<\n  IPullRequestBadgeProps,\n  {}\n> {\n  public render() {\n    const status = this.props.status\n\n    return (\n      <div className=\"pr-badge\">\n        <span className=\"number\">#{this.props.number}</span>\n        {status != null && status.totalCount > 0 ? (\n          <CIStatus status={status} />\n        ) : null}\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport { FilterList, IFilterListItem } from '../lib/filter-list'\nimport {\n  PullRequestListItem,\n  IPullRequestListItemProps,\n} from './pull-request-list-item'\nimport { RowHeight } from './pull-request-list'\n\nconst FacadeCount = 6\n\nconst prLoadingItemProps: IPullRequestListItemProps = {\n  loading: true,\n  author: '',\n  created: new Date(0),\n  number: 0,\n  title: '',\n  matches: { title: [], subtitle: [] },\n  status: {\n    sha: '4b825dc642cb6eb9a060e54bf8d69288fbee4904',\n    totalCount: 1,\n    state: 'pending',\n    pullRequestNumber: 0,\n    statuses: [],\n  },\n}\n\n/** The placeholder for when pull requests are still loading. */\nexport class PullRequestsLoading extends React.Component<{}, {}> {\n  public render() {\n    const items: Array<IFilterListItem> = []\n    for (let i = 0; i < FacadeCount; i++) {\n      items.push({\n        text: [''],\n        id: i.toString(),\n      })\n    }\n\n    const groups = [\n      {\n        identifier: '',\n        items,\n      },\n    ]\n\n    return (\n      <FilterList<IFilterListItem>\n        className=\"pull-request-list\"\n        rowHeight={RowHeight}\n        groups={groups}\n        selectedItem={null}\n        renderItem={this.renderItem}\n        invalidationProps={groups}\n        disabled={true}\n      />\n    )\n  }\n\n  private renderItem = (item: IFilterListItem) => {\n    return <PullRequestListItem {...prLoadingItemProps} />\n  }\n}\n","import * as React from 'react'\nimport { encodePathAsUrl } from '../../lib/path'\nimport { Ref } from '../lib/ref'\nimport { LinkButton } from '../lib/link-button'\n\nconst BlankSlateImage = encodePathAsUrl(\n  __dirname,\n  'static/empty-no-pull-requests.svg'\n)\n\ninterface INoPullRequestsProps {\n  /** The name of the repository. */\n  readonly repositoryName: string\n\n  /** Is the default branch currently checked out? */\n  readonly isOnDefaultBranch: boolean\n\n  /** Is this component being rendered due to a search? */\n  readonly isSearch: boolean\n\n  /* Called when the user wants to create a new branch. */\n  readonly onCreateBranch: () => void\n\n  /** Called when the user wants to create a pull request. */\n  readonly onCreatePullRequest: () => void\n}\n\n/** The placeholder for when there are no open pull requests. */\nexport class NoPullRequests extends React.Component<INoPullRequestsProps, {}> {\n  public render() {\n    return (\n      <div className=\"no-pull-requests\">\n        <img src={BlankSlateImage} className=\"blankslate-image\" />\n        {this.renderTitle()}\n        {this.renderCallToAction()}\n      </div>\n    )\n  }\n\n  private renderTitle() {\n    if (this.props.isSearch) {\n      return <div className=\"title\">Sorry, I can't find that pull request!</div>\n    } else {\n      return (\n        <div>\n          <div className=\"title\">You're all set!</div>\n          <div className=\"no-prs\">\n            No open pull requests in <Ref>{this.props.repositoryName}</Ref>\n          </div>\n        </div>\n      )\n    }\n  }\n\n  private renderCallToAction() {\n    if (this.props.isOnDefaultBranch) {\n      return (\n        <div className=\"call-to-action\">\n          Would you like to{' '}\n          <LinkButton onClick={this.props.onCreateBranch}>\n            create a new branch\n          </LinkButton>{' '}\n          and get going on your next project?\n        </div>\n      )\n    } else {\n      return (\n        <div className=\"call-to-action\">\n          Would you like to{' '}\n          <LinkButton onClick={this.props.onCreatePullRequest}>\n            create a pull request\n          </LinkButton>{' '}\n          from the current branch?\n        </div>\n      )\n    }\n  }\n}\n","import { PullRequestStatus, ICommitStatus } from '../../models/pull-request'\nimport { APIRefState } from '../../lib/api'\nimport { assertNever } from '../../lib/fatal-error'\n\nfunction formatState(state: APIRefState): string {\n  switch (state) {\n    case 'failure':\n      return 'Commit status: failed'\n    case 'pending':\n    case 'success':\n      return `Commit status: ${state}`\n\n    default:\n      return assertNever(state, `Unknown APIRefState value: ${state}`)\n  }\n}\n\nfunction formatSingleStatus(status: ICommitStatus) {\n  const word = status.state\n  const sentenceCaseWord =\n    word.charAt(0).toUpperCase() + word.substring(1, word.length)\n\n  return `${sentenceCaseWord}: ${status.description}`\n}\n\n/**\n * Convert the Pull Request status to an app-friendly string.\n *\n * If the pull request contains commit statuses, this method will compute\n * the number of successful statuses. Oteherwise, it will fall back\n * to the `state` value reported by the GitHub API.\n */\nexport function getPRStatusSummary(prStatus: PullRequestStatus): string {\n  const statusCount = prStatus.statuses.length || 0\n\n  if (statusCount === 0) {\n    return formatState(prStatus.state)\n  }\n\n  if (statusCount === 1) {\n    return formatSingleStatus(prStatus.statuses[0])\n  }\n\n  const successCount = prStatus.statuses.filter(x => x.state === 'success')\n    .length\n\n  return `${successCount}/${statusCount} checks OK`\n}\n","import * as React from 'react'\nimport { CSSTransitionGroup } from 'react-transition-group'\n\nimport { PullRequest } from '../../models/pull-request'\nimport { Repository, nameOf } from '../../models/repository'\nimport { Branch } from '../../models/branch'\nimport { BranchesTab } from '../../models/branches-tab'\n\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { FoldoutType, PopupType } from '../../lib/app-state'\nimport { assertNever } from '../../lib/fatal-error'\n\nimport { TabBar } from '../tab-bar'\n\nimport { BranchList } from './branch-list'\nimport { PullRequestList } from './pull-request-list'\nimport { PullRequestsLoading } from './pull-requests-loading'\nimport { IBranchListItem } from './group-branches'\nimport { renderDefaultBranch } from './branch-renderer'\nimport { IMatches } from '../../lib/fuzzy-find'\n\nconst PullRequestsLoadingCrossFadeInTimeout = 300\nconst PullRequestsLoadingCrossFadeOutTimeout = 200\n\ninterface IBranchesContainerProps {\n  readonly dispatcher: Dispatcher\n  readonly repository: Repository\n  readonly selectedTab: BranchesTab\n  readonly allBranches: ReadonlyArray<Branch>\n  readonly defaultBranch: Branch | null\n  readonly currentBranch: Branch | null\n  readonly recentBranches: ReadonlyArray<Branch>\n  readonly pullRequests: ReadonlyArray<PullRequest>\n\n  /** The pull request associated with the current branch. */\n  readonly currentPullRequest: PullRequest | null\n\n  /** Are we currently loading pull requests? */\n  readonly isLoadingPullRequests: boolean\n}\n\ninterface IBranchesContainerState {\n  readonly selectedBranch: Branch | null\n  readonly selectedPullRequest: PullRequest | null\n  readonly branchFilterText: string\n  readonly pullRequestFilterText: string\n}\n\n/** The unified Branches and Pull Requests component. */\nexport class BranchesContainer extends React.Component<\n  IBranchesContainerProps,\n  IBranchesContainerState\n> {\n  public constructor(props: IBranchesContainerProps) {\n    super(props)\n\n    this.state = {\n      selectedBranch: props.currentBranch,\n      selectedPullRequest: props.currentPullRequest,\n      branchFilterText: '',\n      pullRequestFilterText: '',\n    }\n  }\n\n  public render() {\n    return (\n      <div className=\"branches-container\">\n        {this.renderTabBar()}\n        {this.renderSelectedTab()}\n      </div>\n    )\n  }\n\n  private renderTabBar() {\n    if (!this.props.repository.gitHubRepository) {\n      return null\n    }\n\n    let countElement = null\n    if (this.props.pullRequests) {\n      countElement = (\n        <span className=\"count\">{this.props.pullRequests.length}</span>\n      )\n    }\n\n    return (\n      <TabBar\n        onTabClicked={this.onTabClicked}\n        selectedIndex={this.props.selectedTab}\n      >\n        <span>Branches</span>\n        <span className=\"pull-request-tab\">\n          {__DARWIN__ ? 'Pull Requests' : 'Pull requests'}\n\n          {countElement}\n        </span>\n      </TabBar>\n    )\n  }\n\n  private renderBranch = (item: IBranchListItem, matches: IMatches) => {\n    return renderDefaultBranch(item, matches, this.props.currentBranch)\n  }\n\n  private renderSelectedTab() {\n    let tab = this.props.selectedTab\n    if (!this.props.repository.gitHubRepository) {\n      tab = BranchesTab.Branches\n    }\n\n    switch (tab) {\n      case BranchesTab.Branches:\n        return (\n          <BranchList\n            defaultBranch={this.props.defaultBranch}\n            currentBranch={this.props.currentBranch}\n            allBranches={this.props.allBranches}\n            recentBranches={this.props.recentBranches}\n            onItemClick={this.onBranchItemClick}\n            filterText={this.state.branchFilterText}\n            onFilterTextChanged={this.onBranchFilterTextChanged}\n            selectedBranch={this.state.selectedBranch}\n            onSelectionChanged={this.onBranchSelectionChanged}\n            canCreateNewBranch={true}\n            onCreateNewBranch={this.onCreateBranchWithName}\n            renderBranch={this.renderBranch}\n          />\n        )\n\n      case BranchesTab.PullRequests: {\n        return (\n          <CSSTransitionGroup\n            transitionName=\"cross-fade\"\n            component=\"div\"\n            id=\"pr-transition-div\"\n            transitionEnterTimeout={PullRequestsLoadingCrossFadeInTimeout}\n            transitionLeaveTimeout={PullRequestsLoadingCrossFadeOutTimeout}\n          >\n            {this.renderPullRequests()}\n          </CSSTransitionGroup>\n        )\n      }\n    }\n\n    return assertNever(tab, `Unknown Branches tab: ${tab}`)\n  }\n\n  private renderPullRequests() {\n    if (this.props.isLoadingPullRequests) {\n      return <PullRequestsLoading key=\"prs-loading\" />\n    }\n\n    const pullRequests = this.props.pullRequests\n    const repo = this.props.repository\n    const isOnDefaultBranch =\n      this.props.defaultBranch &&\n      this.props.currentBranch &&\n      this.props.defaultBranch.name === this.props.currentBranch.name\n\n    return (\n      <PullRequestList\n        key=\"pr-list\"\n        pullRequests={pullRequests}\n        selectedPullRequest={this.state.selectedPullRequest}\n        repositoryName={nameOf(repo)}\n        isOnDefaultBranch={!!isOnDefaultBranch}\n        onSelectionChanged={this.onPullRequestSelectionChanged}\n        onCreateBranch={this.onCreateBranch}\n        onCreatePullRequest={this.onCreatePullRequest}\n        filterText={this.state.pullRequestFilterText}\n        onFilterTextChanged={this.onPullRequestFilterTextChanged}\n        onItemClick={this.onPullRequestClicked}\n        onDismiss={this.onDismiss}\n      />\n    )\n  }\n\n  private onTabClicked = (tab: BranchesTab) => {\n    this.props.dispatcher.changeBranchesTab(tab)\n  }\n\n  private onDismiss = () => {\n    this.props.dispatcher.closeFoldout(FoldoutType.Branch)\n  }\n\n  private onBranchItemClick = (branch: Branch) => {\n    this.props.dispatcher.closeFoldout(FoldoutType.Branch)\n\n    const currentBranch = this.props.currentBranch\n\n    if (currentBranch == null || currentBranch.name !== branch.name) {\n      this.props.dispatcher.checkoutBranch(this.props.repository, branch)\n    }\n  }\n\n  private onBranchSelectionChanged = (selectedBranch: Branch | null) => {\n    this.setState({ selectedBranch })\n  }\n\n  private onBranchFilterTextChanged = (text: string) => {\n    this.setState({ branchFilterText: text })\n  }\n\n  private onCreateBranchWithName = (name: string) => {\n    this.props.dispatcher.closeFoldout(FoldoutType.Branch)\n    this.props.dispatcher.showPopup({\n      type: PopupType.CreateBranch,\n      repository: this.props.repository,\n      initialName: name,\n    })\n  }\n\n  private onCreateBranch = () => {\n    this.onCreateBranchWithName('')\n  }\n\n  private onPullRequestFilterTextChanged = (text: string) => {\n    this.setState({ pullRequestFilterText: text })\n  }\n\n  private onPullRequestSelectionChanged = (\n    selectedPullRequest: PullRequest | null\n  ) => {\n    this.setState({ selectedPullRequest })\n  }\n\n  private onCreatePullRequest = () => {\n    this.props.dispatcher.closeFoldout(FoldoutType.Branch)\n    this.props.dispatcher.createPullRequest(this.props.repository)\n  }\n\n  private onPullRequestClicked = (pullRequest: PullRequest) => {\n    this.props.dispatcher.closeFoldout(FoldoutType.Branch)\n    this.props.dispatcher.checkoutPullRequest(\n      this.props.repository,\n      pullRequest\n    )\n\n    this.onPullRequestSelectionChanged(pullRequest)\n  }\n}\n","import * as React from 'react'\nimport { encodePathAsUrl } from '../../lib/path'\nimport { Button } from '../lib/button'\n\nconst BlankSlateImage = encodePathAsUrl(\n  __dirname,\n  'static/empty-no-branches.svg'\n)\n\ninterface INoBranchesProps {\n  /** The callback to invoke when the user wishes to create a new branch */\n  readonly onCreateNewBranch: () => void\n  /** True to display the UI elements for creating a new branch, false to hide them */\n  readonly canCreateNewBranch: boolean\n}\n\nexport class NoBranches extends React.Component<INoBranchesProps> {\n  public render() {\n    if (this.props.canCreateNewBranch) {\n      return (\n        <div className=\"no-branches\">\n          <img src={BlankSlateImage} className=\"blankslate-image\" />\n\n          <div className=\"title\">Sorry, I can't find that branch</div>\n\n          <div className=\"subtitle\">\n            Do you want to create a new branch instead?\n          </div>\n\n          <Button\n            className=\"create-branch-button\"\n            onClick={this.props.onCreateNewBranch}\n            type=\"submit\"\n          >\n            {__DARWIN__ ? 'Create New Branch' : 'Create new branch'}\n          </Button>\n\n          <div className=\"protip\">\n            ProTip! Press {this.renderShortcut()} to quickly create a new branch\n            from anywhere within the app\n          </div>\n        </div>\n      )\n    }\n\n    return <div className=\"no-branches\">Sorry, I can't find that branch</div>\n  }\n\n  private renderShortcut() {\n    if (__DARWIN__) {\n      return (\n        <span>\n          <kbd></kbd> + <kbd></kbd> + <kbd>N</kbd>\n        </span>\n      )\n    } else {\n      return (\n        <span>\n          <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>N</kbd>\n        </span>\n      )\n    }\n  }\n}\n","import * as React from 'react'\n\n/**\n * A container component for footer content in a Dialog.\n * This component should only be used at most once in any given dialog and it\n * should be rendered as the last child of that dialog.\n *\n * Provide `children` to display content inside the dialog footer.\n */\nexport class DialogFooter extends React.Component<{}, {}> {\n  public render() {\n    return <div className=\"dialog-footer\">{this.props.children}</div>\n  }\n}\n","import * as React from 'react'\nimport { Octicon, OcticonSymbol } from '../octicons'\n\ninterface IDialogErrorProps {}\n\n/**\n * A component used for displaying short error messages inline\n * in a dialog. These error messages (there can be more than one)\n * should be rendered as the first child of the <Dialog> component\n * and support arbitrary content.\n *\n * The content (error message) is paired with a stop icon and receive\n * special styling.\n *\n * Provide `children` to display content inside the error dialog.\n */\nexport class DialogError extends React.Component<IDialogErrorProps, {}> {\n  public render() {\n    return (\n      <div className=\"dialog-error\">\n        <Octicon symbol={OcticonSymbol.stop} />\n        <div>{this.props.children}</div>\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport * as classNames from 'classnames'\nimport { DialogHeader } from './header'\nimport { createUniqueId, releaseUniqueId } from '../lib/id-pool'\n\n/**\n * The time (in milliseconds) from when the dialog is mounted\n * until it can be dismissed. See the isAppearing property in\n * IDialogState for more information.\n */\nconst dismissGracePeriodMs = 250\n\n/**\n * The time (in milliseconds) that we should wait after focusing before we\n * re-enable click dismissal. Note that this is only used on Windows.\n */\nconst DisableClickDismissalDelay = 500\n\n/**\n * Title bar height in pixels. Values taken from 'app/styles/_variables.scss'.\n */\nconst titleBarHeight = __DARWIN__ ? 22 : 28\n\ninterface IDialogProps {\n  /**\n   * An optional dialog title. Most, if not all dialogs should have\n   * this. When present the Dialog renders a DialogHeader element\n   * containing an icon (if the type prop warrants it), the title itself\n   * and a close button (if the dialog is dismissable).\n   *\n   * By omitting this consumers may use their own custom DialogHeader\n   * for when the default component doesn't cut it.\n   */\n  readonly title?: string\n\n  /**\n   * Whether or not the dialog should be dismissable. A dismissable dialog\n   * can be dismissed either by clicking on the backdrop or by clicking\n   * the close button in the header (if a header was specified). Dismissal\n   * will trigger the onDismissed event which callers must handle and pass\n   * on to the dispatcher in order to close the dialog.\n   *\n   * A non-dismissable dialog can only be closed by means of the component\n   * implementing a dialog. An example would be a critical error or warning\n   * that requires explicit user action by for example clicking on a button.\n   *\n   * Defaults to true if omitted.\n   */\n  readonly dismissable?: boolean\n\n  /**\n   * Event triggered when the dialog is dismissed by the user in the\n   * ways described in the dismissable prop.\n   */\n  readonly onDismissed: () => void\n\n  /**\n   * An optional id for the rendered dialog element.\n   */\n  readonly id?: string\n\n  /**\n   * An optional dialog type. A warning or error dialog type triggers custom\n   * styling of the dialog, see _dialog.scss for more detail.\n   *\n   * Defaults to 'normal' if omitted\n   */\n  readonly type?: 'normal' | 'warning' | 'error'\n\n  /**\n   * An event triggered when the dialog form is submitted. All dialogs contain\n   * a top-level form element which can be triggered through a submit button.\n   *\n   * Consumers should handle this rather than subscribing to the onClick event\n   * on the button itself since there may be other ways of submitting a specific\n   * form (such as Ctrl+Enter).\n   */\n  readonly onSubmit?: () => void\n\n  /**\n   * An optional className to be applied to the rendered dialog element.\n   */\n  readonly className?: string\n\n  /**\n   * Whether or not the dialog should be disabled. All dialogs wrap their\n   * content in a <fieldset> element which, when disabled, causes all descendant\n   * form elements and buttons to also become disabled. This is useful for\n   * consumers implementing a typical save dialog where the save action isn't\n   * instantaneous (such as a sign in dialog) and they need to ensure that the\n   * user doesn't continue mutating the form state or click buttons while the\n   * save/submit action is in progress. Note that this does not prevent the\n   * dialog from being dismissed.\n   */\n  readonly disabled?: boolean\n\n  /**\n   * Whether or not the dialog contents are currently involved in processing\n   * data, executing an asynchronous operation or by other means working.\n   * Setting this value will render a spinning progress icon in the dialog\n   * header (if the dialog has a header). Note that the spinning icon\n   * will temporarily replace the dialog icon (if present) for the duration\n   * of the loading operation.\n   */\n  readonly loading?: boolean\n}\n\ninterface IDialogState {\n  /**\n   * When a dialog is shown we wait for a few hundred milliseconds before\n   * acknowledging a dismissal in order to avoid people accidentally dismissing\n   * dialogs that appear as they're doing other things. Since the entire\n   * backdrop of a dialog can be clicked to dismiss all it takes is one rogue\n   * click and the dialog is gone. This is less than ideal if we're in the\n   * middle of displaying an important error message.\n   *\n   * This state boolean is used to keep track of whether we're still in that\n   * grace period or not.\n   */\n  readonly isAppearing: boolean\n\n  /**\n   * An optional id for the h1 element that contains the title of this\n   * dialog. Used to aid in accessibility by allowing the h1 to be referenced\n   * in an aria-labeledby/aria-describedby attributed. Undefined if the dialog\n   * does not have a title or the component has not yet been mounted.\n   */\n  readonly titleId?: string\n}\n\n/**\n * A general purpose, versatile, dialog component which utilizes the new\n * <dialog> element. See https://demo.agektmr.com/dialog/\n *\n * A dialog is opened as a modal that prevents keyboard or pointer access to\n * underlying elements. It's not possible to use the tab key to move focus\n * out of the dialog without first dismissing it.\n */\nexport class Dialog extends React.Component<IDialogProps, IDialogState> {\n  private dialogElement: HTMLElement | null = null\n  private dismissGraceTimeoutId?: number\n\n  private disableClickDismissalTimeoutId: number | null = null\n  private disableClickDismissal = false\n\n  public constructor(props: IDialogProps) {\n    super(props)\n    this.state = { isAppearing: true }\n  }\n\n  private clearDismissGraceTimeout() {\n    if (this.dismissGraceTimeoutId !== undefined) {\n      window.clearTimeout(this.dismissGraceTimeoutId)\n      this.dismissGraceTimeoutId = undefined\n    }\n  }\n\n  private scheduleDismissGraceTimeout() {\n    this.clearDismissGraceTimeout()\n\n    this.dismissGraceTimeoutId = window.setTimeout(\n      this.onDismissGraceTimer,\n      dismissGracePeriodMs\n    )\n  }\n\n  private onDismissGraceTimer = () => {\n    this.setState({ isAppearing: false })\n  }\n\n  private isDismissable() {\n    return this.props.dismissable === undefined || this.props.dismissable\n  }\n\n  private updateTitleId() {\n    if (this.state.titleId) {\n      releaseUniqueId(this.state.titleId)\n      this.setState({ titleId: undefined })\n    }\n\n    if (this.props.title) {\n      this.setState({\n        titleId: createUniqueId(`Dialog_${this.props.id}_${this.props.title}`),\n      })\n    }\n  }\n\n  public componentWillMount() {\n    this.updateTitleId()\n  }\n\n  public componentDidMount() {\n    // This cast to any is necessary since React doesn't know about the\n    // dialog element yet.\n    ;(this.dialogElement as any).showModal()\n\n    this.setState({ isAppearing: true })\n    this.scheduleDismissGraceTimeout()\n\n    window.addEventListener('focus', this.onWindowFocus)\n  }\n\n  private onWindowFocus = () => {\n    // On Windows and Linux, a click which focuses the window will also get\n    // passed down into the DOM. But we don't want to dismiss the dialog based\n    // on that click. See https://github.com/desktop/desktop/issues/2486.\n    if (__WIN32__ || __LINUX__) {\n      this.clearClickDismissalTimer()\n\n      this.disableClickDismissal = true\n\n      this.disableClickDismissalTimeoutId = window.setTimeout(() => {\n        this.disableClickDismissal = false\n        this.disableClickDismissalTimeoutId = null\n      }, DisableClickDismissalDelay)\n    }\n  }\n\n  private clearClickDismissalTimer() {\n    if (this.disableClickDismissalTimeoutId) {\n      window.clearTimeout(this.disableClickDismissalTimeoutId)\n      this.disableClickDismissalTimeoutId = null\n    }\n  }\n\n  public componentWillUnmount() {\n    this.clearDismissGraceTimeout()\n\n    if (this.state.titleId) {\n      releaseUniqueId(this.state.titleId)\n    }\n\n    window.removeEventListener('focus', this.onWindowFocus)\n  }\n\n  public componentDidUpdate() {\n    if (!this.props.title && this.state.titleId) {\n      this.updateTitleId()\n    }\n  }\n\n  private onDialogCancel = (e: Event) => {\n    e.preventDefault()\n    this.onDismiss()\n  }\n\n  private onDialogClick = (e: React.MouseEvent<HTMLElement>) => {\n    if (this.isDismissable() === false) {\n      return\n    }\n\n    // This event handler catches the onClick event of buttons in the\n    // dialog. Ie, if someone hits enter inside the dialog form an onClick\n    // event will be raised on the the submit button which isn't what we\n    // want so we'll make sure that the original target for the event is\n    // our own dialog element.\n    if (e.target !== this.dialogElement) {\n      return\n    }\n\n    const isInTitleBar = e.clientY <= titleBarHeight\n\n    if (isInTitleBar) {\n      return\n    }\n\n    // Ignore the first click right after the window's been focused. It could\n    // be the click that focused the window, in which case we don't wanna\n    // dismiss the dialog.\n    if (this.disableClickDismissal) {\n      this.disableClickDismissal = false\n      this.clearClickDismissalTimer()\n      return\n    }\n\n    // Figure out if the user clicked on the backdrop or in the dialog itself.\n    const rect = e.currentTarget.getBoundingClientRect()\n\n    // http://stackoverflow.com/a/26984690/2114\n    const isInDialog =\n      rect.top <= e.clientY &&\n      e.clientY <= rect.top + rect.height &&\n      rect.left <= e.clientX &&\n      e.clientX <= rect.left + rect.width\n\n    if (!isInDialog) {\n      e.preventDefault()\n      this.onDismiss()\n    }\n  }\n\n  private onDialogRef = (e: HTMLElement | null) => {\n    // We need to explicitly subscribe to and unsubscribe from the dialog\n    // element as react doesn't yet understand the element and which events\n    // it has.\n    if (!e) {\n      if (this.dialogElement) {\n        this.dialogElement.removeEventListener('cancel', this.onDialogCancel)\n        this.dialogElement.removeEventListener('keydown', this.onKeyDown)\n      }\n    } else {\n      e.addEventListener('cancel', this.onDialogCancel)\n      e.addEventListener('keydown', this.onKeyDown)\n    }\n\n    this.dialogElement = e\n  }\n\n  private onKeyDown = (event: KeyboardEvent) => {\n    const shortcutKey = __DARWIN__ ? event.metaKey : event.ctrlKey\n    if (shortcutKey && event.key === 'w') {\n      this.onDialogCancel(event)\n    }\n  }\n\n  private onDismiss = () => {\n    if (this.isDismissable() && !this.state.isAppearing) {\n      if (this.props.onDismissed) {\n        this.props.onDismissed()\n      }\n    }\n  }\n\n  private onSubmit = (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault()\n\n    if (this.props.onSubmit) {\n      this.props.onSubmit()\n    } else {\n      this.onDismiss()\n    }\n  }\n\n  private renderHeader() {\n    if (!this.props.title) {\n      return null\n    }\n\n    return (\n      <DialogHeader\n        title={this.props.title}\n        titleId={this.state.titleId}\n        dismissable={this.isDismissable()}\n        onDismissed={this.onDismiss}\n        loading={this.props.loading}\n      />\n    )\n  }\n\n  public render() {\n    const className = classNames(\n      {\n        error: this.props.type === 'error',\n        warning: this.props.type === 'warning',\n      },\n      this.props.className\n    )\n\n    return (\n      <dialog\n        ref={this.onDialogRef}\n        id={this.props.id}\n        onClick={this.onDialogClick}\n        className={className}\n        aria-labelledby={this.state.titleId}\n      >\n        {this.renderHeader()}\n\n        <form onSubmit={this.onSubmit}>\n          <fieldset disabled={this.props.disabled}>\n            {this.props.children}\n          </fieldset>\n        </form>\n      </dialog>\n    )\n  }\n}\n","import * as React from 'react'\nimport * as classNames from 'classnames'\n\ninterface IDialogContentProps {\n  /**\n   * An optional className to be applied to the rendered div element.\n   */\n  readonly className?: string\n\n  /**\n   * An optional function that will be passed a reference do the\n   * div container element of the DialogContents component (or null if\n   * unmounted).\n   */\n  readonly onRef?: (element: HTMLDivElement | null) => void\n}\n\n/**\n * A container component for content (ie non-header, non-footer) in a Dialog.\n * This component should only be used once in any given dialog.\n *\n * If a dialog implements a tabbed interface where each tab is a child component\n * the child components _should_ render the DialogContent component themselves\n * to avoid excessive nesting and to ensure that styles applying to phrasing\n * content in the dialog get applied consistently.\n */\nexport class DialogContent extends React.Component<IDialogContentProps, {}> {\n  public render() {\n    const className = classNames('dialog-content', this.props.className)\n\n    return (\n      <div className={className} ref={this.props.onRef}>\n        {this.props.children}\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { Branch } from '../../models/branch'\nimport { ButtonGroup } from '../lib/button-group'\nimport { Button } from '../lib/button'\nimport { Dialog, DialogContent, DialogFooter } from '../dialog'\nimport { Repository } from '../../models/repository'\nimport { Ref } from '../lib/ref'\n\ninterface IPushBranchCommitsProps {\n  readonly dispatcher: Dispatcher\n  readonly repository: Repository\n  readonly branch: Branch\n  readonly onConfirm: (repository: Repository, branch: Branch) => void\n  readonly onDismissed: () => void\n\n  /**\n   * Used to show the number of commits a branch is ahead by.\n   * If this value is undefined, component defaults to publish view.\n   */\n  readonly unPushedCommits?: number\n}\n\ninterface IPushBranchCommitsState {\n  /**\n   * A value indicating whether we're currently working on publishing\n   * or pushing the branch to the remote. This value is used to tell\n   * the dialog to apply the loading and disabled state which adds a\n   * spinner and disables form controls for the duration of the operation.\n   */\n  readonly isPushingOrPublishing: boolean\n}\n\n/**\n * Returns a string used for communicating the number of commits\n * that will be pushed to the user.\n *\n * @param numberOfCommits The number of commits that will be pushed\n * @param unit            A string written in such a way that without\n *                        modification it can be paired with the digit 1\n *                        such as 'commit' and which, when a 's' is appended\n *                        to it can be paired with a zero digit or a number\n *                        greater than one.\n */\nfunction pluralize(numberOfCommits: number, unit: string) {\n  return numberOfCommits === 1\n    ? `${numberOfCommits} ${unit}`\n    : `${numberOfCommits} ${unit}s`\n}\n\n/**\n * Simple type guard which allows us to substitute the non-obvious\n * this.props.unPushedCommits === undefined checks with\n * renderPublishView(this.props.unPushedCommits).\n */\nfunction renderPublishView(\n  unPushedCommits: number | undefined\n): unPushedCommits is undefined {\n  return unPushedCommits === undefined\n}\n\n/**\n * This component gets shown if the user attempts to open a PR with\n * a) An un-published branch\n * b) A branch that is ahead of its base branch\n *\n * In both cases, this asks the user if they'd like to push/publish the branch.\n * If they confirm we push/publish then open the PR page on dotcom.\n */\nexport class PushBranchCommits extends React.Component<\n  IPushBranchCommitsProps,\n  IPushBranchCommitsState\n> {\n  private dialogButtonRef: HTMLButtonElement | null = null\n  public constructor(props: IPushBranchCommitsProps) {\n    super(props)\n\n    this.state = { isPushingOrPublishing: false }\n  }\n\n  public componentDidMount() {\n    if (this.dialogButtonRef) {\n      this.dialogButtonRef.focus() // Focuses on the Publish Branch button when the push-branch-commits dialog opens\n    }\n  }\n\n  public render() {\n    return (\n      <Dialog\n        id=\"push-branch-commits\"\n        key=\"push-branch-commits\"\n        title={this.renderDialogTitle()}\n        onDismissed={this.cancel}\n        onSubmit={this.cancel}\n        loading={this.state.isPushingOrPublishing}\n        disabled={this.state.isPushingOrPublishing}\n      >\n        {this.renderDialogContent()}\n\n        <DialogFooter>{this.renderButtonGroup()}</DialogFooter>\n      </Dialog>\n    )\n  }\n\n  private onDialogOpenRef = (element: HTMLButtonElement | null) => {\n    this.dialogButtonRef = element\n  }\n\n  private renderDialogContent() {\n    if (renderPublishView(this.props.unPushedCommits)) {\n      return (\n        <DialogContent>\n          <p>Your branch must be published before opening a pull request.</p>\n          <p>\n            Would you like to publish <Ref>{this.props.branch.name}</Ref> now\n            and open a pull request?\n          </p>\n        </DialogContent>\n      )\n    }\n\n    const localCommits = pluralize(this.props.unPushedCommits, 'local commit')\n\n    return (\n      <DialogContent>\n        <p>\n          You have {localCommits} that haven't been pushed to the remote yet.\n        </p>\n        <p>\n          Would you like to push your changes to{' '}\n          <Ref>{this.props.branch.name}</Ref> before creating your pull request?\n        </p>\n      </DialogContent>\n    )\n  }\n\n  private renderDialogTitle() {\n    if (renderPublishView(this.props.unPushedCommits)) {\n      return __DARWIN__ ? 'Publish Branch?' : 'Publish branch?'\n    }\n\n    return __DARWIN__ ? `Push Local Changes?` : `Push local changes?`\n  }\n\n  private renderButtonGroup() {\n    if (renderPublishView(this.props.unPushedCommits)) {\n      return (\n        <ButtonGroup>\n          <Button\n            type=\"submit\"\n            onClick={this.onPushOrPublishButtonClick}\n            onButtonRef={this.onDialogOpenRef}\n          >\n            {__DARWIN__ ? 'Publish Branch' : 'Publish branch'}\n          </Button>\n          <Button onClick={this.cancel}>Cancel</Button>\n        </ButtonGroup>\n      )\n    }\n\n    return (\n      <ButtonGroup>\n        <Button type=\"submit\" onClick={this.onPushOrPublishButtonClick}>\n          {__DARWIN__ ? 'Push Commits' : 'Push commits'}\n        </Button>\n        <Button onClick={this.onCreateWithoutPushButtonClick}>\n          {__DARWIN__ ? 'Create Without Pushing' : 'Create without pushing'}\n        </Button>\n      </ButtonGroup>\n    )\n  }\n\n  private cancel = () => {\n    this.props.onDismissed()\n  }\n\n  private onCreateWithoutPushButtonClick = () => {\n    this.props.onConfirm(this.props.repository, this.props.branch)\n    this.props.onDismissed()\n  }\n\n  private onPushOrPublishButtonClick = async (\n    e: React.MouseEvent<HTMLButtonElement>\n  ) => {\n    e.preventDefault()\n\n    const { repository, branch } = this.props\n\n    this.setState({ isPushingOrPublishing: true })\n\n    try {\n      await this.props.dispatcher.push(repository)\n    } finally {\n      this.setState({ isPushingOrPublishing: false })\n    }\n\n    this.props.onConfirm(repository, branch)\n    this.props.onDismissed()\n  }\n}\n","import * as React from 'react'\nimport { GitHubRepository } from '../../models/github-repository'\nimport { Commit } from '../../models/commit'\nimport { CommitListItem } from './commit-list-item'\nimport { List } from '../lib/list'\nimport { IGitHubUser } from '../../lib/databases'\n\nconst RowHeight = 50\n\ninterface ICommitListProps {\n  /** The GitHub repository associated with this commit (if found) */\n  readonly gitHubRepository: GitHubRepository | null\n\n  /** The list of commits SHAs to display, in order. */\n  readonly commitSHAs: ReadonlyArray<string>\n\n  /** The commits loaded, keyed by their full SHA. */\n  readonly commitLookup: Map<string, Commit>\n\n  /** The SHA of the selected commit */\n  readonly selectedSHA: string | null\n\n  /** The lookup for GitHub users related to this repository */\n  readonly gitHubUsers: Map<string, IGitHubUser>\n\n  /** The emoji lookup to render images inline */\n  readonly emoji: Map<string, string>\n\n  /** The list of known local commits for the current branch */\n  readonly localCommitSHAs: ReadonlyArray<string>\n\n  /** The message to display inside the list when no results are displayed */\n  readonly emptyListMessage: JSX.Element | string\n\n  /** Callback which fires when a commit has been selected in the list */\n  readonly onCommitSelected: (commit: Commit) => void\n\n  /** Callback that fires when a scroll event has occurred */\n  readonly onScroll: (start: number, end: number) => void\n\n  /** Callback to fire to revert a given commit in the current repository */\n  readonly onRevertCommit: (commit: Commit) => void\n\n  /** Callback to fire to open a given commit on GitHub */\n  readonly onViewCommitOnGitHub: (sha: string) => void\n}\n\n/** A component which displays the list of commits. */\nexport class CommitList extends React.Component<ICommitListProps, {}> {\n  private renderCommit = (row: number) => {\n    const sha = this.props.commitSHAs[row]\n    const commit = this.props.commitLookup.get(sha)\n\n    if (commit == null) {\n      if (__DEV__) {\n        log.warn(\n          `[CommitList]: the commit '${sha}' does not exist in the cache`\n        )\n      }\n      return null\n    }\n\n    const isLocal = this.props.localCommitSHAs.indexOf(commit.sha) > -1\n\n    return (\n      <CommitListItem\n        key={commit.sha}\n        gitHubRepository={this.props.gitHubRepository}\n        isLocal={isLocal}\n        commit={commit}\n        gitHubUsers={this.props.gitHubUsers}\n        emoji={this.props.emoji}\n        onRevertCommit={this.props.onRevertCommit}\n        onViewCommitOnGitHub={this.props.onViewCommitOnGitHub}\n      />\n    )\n  }\n\n  private onSelectedRowChanged = (row: number) => {\n    const sha = this.props.commitSHAs[row]\n    const commit = this.props.commitLookup.get(sha)\n    if (commit) {\n      this.props.onCommitSelected(commit)\n    }\n  }\n\n  private onScroll = (scrollTop: number, clientHeight: number) => {\n    const numberOfRows = Math.ceil(clientHeight / RowHeight)\n    const top = Math.floor(scrollTop / RowHeight)\n    const bottom = top + numberOfRows\n    this.props.onScroll(top, bottom)\n  }\n\n  private rowForSHA(sha_: string | null): number {\n    const sha = sha_\n    if (!sha) {\n      return -1\n    }\n\n    return this.props.commitSHAs.findIndex(s => s === sha)\n  }\n\n  public render() {\n    if (this.props.commitSHAs.length === 0) {\n      return (\n        <div className=\"panel blankslate\">{this.props.emptyListMessage}</div>\n      )\n    }\n\n    return (\n      <div id=\"commit-list\">\n        <List\n          rowCount={this.props.commitSHAs.length}\n          rowHeight={RowHeight}\n          selectedRows={[this.rowForSHA(this.props.selectedSHA)]}\n          rowRenderer={this.renderCommit}\n          onSelectedRowChanged={this.onSelectedRowChanged}\n          onScroll={this.onScroll}\n          invalidationProps={{\n            commits: this.props.commitSHAs,\n            gitHubUsers: this.props.gitHubUsers,\n          }}\n        />\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport { CSSTransitionGroup } from 'react-transition-group'\n\nimport { IGitHubUser } from '../../lib/databases'\nimport { Commit } from '../../models/commit'\nimport {\n  ComparisonView,\n  ICompareState,\n  CompareActionKind,\n  ICompareBranch,\n} from '../../lib/app-state'\nimport { CommitList } from './commit-list'\nimport { Repository } from '../../models/repository'\nimport { Branch } from '../../models/branch'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { ThrottledScheduler } from '../lib/throttled-scheduler'\nimport { BranchList } from '../branches'\nimport { TextBox } from '../lib/text-box'\nimport { IBranchListItem } from '../branches/group-branches'\nimport { TabBar } from '../tab-bar'\nimport { CompareBranchListItem } from './compare-branch-list-item'\nimport { FancyTextBox } from '../lib/fancy-text-box'\nimport { OcticonSymbol } from '../octicons'\nimport { SelectionSource } from '../lib/filter-list'\nimport { IMatches } from '../../lib/fuzzy-find'\nimport { Ref } from '../lib/ref'\nimport {\n  NewCommitsBanner,\n  DismissalReason,\n} from '../notification/new-commits-banner'\nimport {\n  enableNotificationOfBranchUpdates,\n  enableMergeConflictDetection,\n} from '../../lib/feature-flag'\nimport { MergeCallToAction } from './merge-call-to-action'\nimport { MergeCallToActionWithConflicts } from './merge-call-to-action-with-conflicts'\n\ninterface ICompareSidebarProps {\n  readonly repository: Repository\n  readonly compareState: ICompareState\n  readonly gitHubUsers: Map<string, IGitHubUser>\n  readonly emoji: Map<string, string>\n  readonly commitLookup: Map<string, Commit>\n  readonly localCommitSHAs: ReadonlyArray<string>\n  readonly dispatcher: Dispatcher\n  readonly currentBranch: Branch | null\n  readonly selectedCommitSha: string | null\n  readonly onRevertCommit: (commit: Commit) => void\n  readonly onViewCommitOnGitHub: (sha: string) => void\n}\n\ninterface ICompareSidebarState {\n  /**\n   * This branch should only be used when tracking interactions that the user is performing.\n   *\n   * For all other cases, use the prop\n   */\n  readonly focusedBranch: Branch | null\n\n  /**\n   * Flag that tracks whether the user interacted with one of the notification's\n   * \"call to action\" buttons\n   */\n  readonly hasConsumedNotification: boolean\n}\n\n/** If we're within this many rows from the bottom, load the next history batch. */\nconst CloseToBottomThreshold = 10\n\nexport class CompareSidebar extends React.Component<\n  ICompareSidebarProps,\n  ICompareSidebarState\n> {\n  private textbox: TextBox | null = null\n  private readonly loadChangedFilesScheduler = new ThrottledScheduler(200)\n  private branchList: BranchList | null = null\n  private loadingMoreCommitsPromise: Promise<void> | null = null\n  private resultCount = 0\n\n  public constructor(props: ICompareSidebarProps) {\n    super(props)\n\n    this.state = {\n      focusedBranch: null,\n      hasConsumedNotification: false,\n    }\n  }\n\n  public componentWillReceiveProps(nextProps: ICompareSidebarProps) {\n    const newFormState = nextProps.compareState.formState\n    const oldFormState = this.props.compareState.formState\n\n    if (this.textbox !== null) {\n      if (\n        !this.props.compareState.showBranchList &&\n        nextProps.compareState.showBranchList\n      ) {\n        // showBranchList changes from false -> true\n        //  -> ensure the textbox has focus\n        this.textbox.focus()\n      } else if (\n        this.props.compareState.showBranchList &&\n        !nextProps.compareState.showBranchList\n      ) {\n        // showBranchList changes from true -> false\n        //  -> ensure the textbox no longer has focus\n        this.textbox.blur()\n      }\n    }\n\n    if (\n      newFormState.kind !== oldFormState.kind &&\n      newFormState.kind === ComparisonView.None\n    ) {\n      this.setState({\n        focusedBranch: null,\n      })\n      return\n    }\n\n    if (\n      newFormState.kind !== ComparisonView.None &&\n      oldFormState.kind !== ComparisonView.None\n    ) {\n      const oldBranch = oldFormState.comparisonBranch\n      const newBranch = newFormState.comparisonBranch\n\n      if (oldBranch.name !== newBranch.name) {\n        // ensure the focused branch is in sync with the chosen branch\n        this.setState({\n          focusedBranch: newBranch,\n        })\n      }\n    }\n  }\n\n  public componentWillMount() {\n    this.props.dispatcher.initializeCompare(this.props.repository)\n  }\n\n  public componentWillUnmount() {\n    this.textbox = null\n\n    // by hiding the branch list here when the component is torn down\n    // we ensure any ahead/behind computation work is discarded\n    this.props.dispatcher.updateCompareForm(this.props.repository, {\n      showBranchList: false,\n    })\n  }\n\n  public render() {\n    const { allBranches, filterText, showBranchList } = this.props.compareState\n    const placeholderText = getPlaceholderText(this.props.compareState)\n    const DivergingBannerAnimationTimeout = 300\n\n    return (\n      <div id=\"compare-view\">\n        <CSSTransitionGroup\n          transitionName=\"diverge-banner\"\n          transitionAppear={true}\n          transitionAppearTimeout={DivergingBannerAnimationTimeout}\n          transitionEnterTimeout={DivergingBannerAnimationTimeout}\n          transitionLeaveTimeout={DivergingBannerAnimationTimeout}\n        >\n          {this.renderNotificationBanner()}\n        </CSSTransitionGroup>\n\n        <div className=\"compare-form\">\n          <FancyTextBox\n            symbol={OcticonSymbol.gitBranch}\n            type=\"search\"\n            placeholder={placeholderText}\n            onFocus={this.onTextBoxFocused}\n            value={filterText}\n            disabled={allBranches.length === 0}\n            onRef={this.onTextBoxRef}\n            onValueChanged={this.onBranchFilterTextChanged}\n            onKeyDown={this.onBranchFilterKeyDown}\n            onSearchCleared={this.handleEscape}\n          />\n        </div>\n\n        {showBranchList ? this.renderFilterList() : this.renderCommits()}\n      </div>\n    )\n  }\n\n  private onBranchesListRef = (branchList: BranchList | null) => {\n    this.branchList = branchList\n  }\n\n  private renderNotificationBanner() {\n    if (!enableNotificationOfBranchUpdates()) {\n      return null\n    }\n\n    if (!this.props.compareState.isDivergingBranchBannerVisible) {\n      return null\n    }\n\n    const { inferredComparisonBranch } = this.props.compareState\n\n    return inferredComparisonBranch.branch !== null &&\n      inferredComparisonBranch.aheadBehind !== null &&\n      inferredComparisonBranch.aheadBehind.behind > 0 ? (\n      <div className=\"diverge-banner-wrapper\">\n        <NewCommitsBanner\n          dispatcher={this.props.dispatcher}\n          repository={this.props.repository}\n          commitsBehindBaseBranch={inferredComparisonBranch.aheadBehind.behind}\n          baseBranch={inferredComparisonBranch.branch}\n          onDismiss={this.onNotificationBannerDismissed}\n        />\n      </div>\n    ) : null\n  }\n\n  private renderCommits() {\n    const formState = this.props.compareState.formState\n    return (\n      <div className=\"compare-commit-list\">\n        {formState.kind === ComparisonView.None\n          ? this.renderCommitList()\n          : this.renderTabBar(formState)}\n      </div>\n    )\n  }\n\n  private filterListResultsChanged = (resultCount: number) => {\n    this.resultCount = resultCount\n  }\n\n  private viewHistoryForBranch = () => {\n    this.props.dispatcher.executeCompare(this.props.repository, {\n      kind: CompareActionKind.History,\n    })\n\n    this.props.dispatcher.updateCompareForm(this.props.repository, {\n      showBranchList: false,\n    })\n  }\n\n  private renderCommitList() {\n    const { formState, commitSHAs } = this.props.compareState\n\n    let emptyListMessage: string | JSX.Element\n    if (formState.kind === ComparisonView.None) {\n      emptyListMessage = 'No history'\n    } else {\n      const currentlyComparedBranchName = formState.comparisonBranch.name\n\n      emptyListMessage =\n        formState.kind === ComparisonView.Ahead ? (\n          <p>\n            The compared branch (<Ref>{currentlyComparedBranchName}</Ref>) is up\n            to date with your branch\n          </p>\n        ) : (\n          <p>\n            Your branch is up to date with the compared branch (\n            <Ref>{currentlyComparedBranchName}</Ref>)\n          </p>\n        )\n    }\n\n    return (\n      <CommitList\n        gitHubRepository={this.props.repository.gitHubRepository}\n        commitLookup={this.props.commitLookup}\n        commitSHAs={commitSHAs}\n        selectedSHA={this.props.selectedCommitSha}\n        gitHubUsers={this.props.gitHubUsers}\n        localCommitSHAs={this.props.localCommitSHAs}\n        emoji={this.props.emoji}\n        onViewCommitOnGitHub={this.props.onViewCommitOnGitHub}\n        onRevertCommit={this.props.onRevertCommit}\n        onCommitSelected={this.onCommitSelected}\n        onScroll={this.onScroll}\n        emptyListMessage={emptyListMessage}\n      />\n    )\n  }\n\n  private renderActiveTab() {\n    const formState = this.props.compareState.formState\n    return (\n      <div className=\"compare-commit-list\">\n        {this.renderCommitList()}\n        {formState.kind === ComparisonView.Behind\n          ? this.renderMergeCallToAction(formState)\n          : null}\n      </div>\n    )\n  }\n\n  private renderFilterList() {\n    const {\n      defaultBranch,\n      allBranches,\n      recentBranches,\n      filterText,\n    } = this.props.compareState\n\n    return (\n      <BranchList\n        ref={this.onBranchesListRef}\n        defaultBranch={defaultBranch}\n        currentBranch={this.props.currentBranch}\n        allBranches={allBranches}\n        recentBranches={recentBranches}\n        filterText={filterText}\n        textbox={this.textbox!}\n        selectedBranch={this.state.focusedBranch}\n        canCreateNewBranch={false}\n        onSelectionChanged={this.onSelectionChanged}\n        onItemClick={this.onBranchItemClicked}\n        onFilterTextChanged={this.onBranchFilterTextChanged}\n        renderBranch={this.renderCompareBranchListItem}\n        onFilterListResultsChanged={this.filterListResultsChanged}\n      />\n    )\n  }\n\n  private renderMergeCallToAction(formState: ICompareBranch) {\n    if (this.props.currentBranch == null) {\n      return null\n    }\n\n    if (!enableMergeConflictDetection()) {\n      return (\n        <MergeCallToAction\n          repository={this.props.repository}\n          dispatcher={this.props.dispatcher}\n          currentBranch={this.props.currentBranch}\n          formState={formState}\n          onMerged={this.onMerge}\n        />\n      )\n    }\n\n    return (\n      <MergeCallToActionWithConflicts\n        repository={this.props.repository}\n        dispatcher={this.props.dispatcher}\n        mergeStatus={this.props.compareState.mergeStatus}\n        currentBranch={this.props.currentBranch}\n        comparisonBranch={formState.comparisonBranch}\n        commitsBehind={formState.aheadBehind.behind}\n        onMerged={this.onMerge}\n      />\n    )\n  }\n\n  private onTabClicked = (index: number) => {\n    const formState = this.props.compareState.formState\n\n    if (formState.kind === ComparisonView.None) {\n      return\n    }\n\n    const mode = index === 0 ? ComparisonView.Behind : ComparisonView.Ahead\n    const branch = formState.comparisonBranch\n\n    this.props.dispatcher.executeCompare(this.props.repository, {\n      kind: CompareActionKind.Branch,\n      branch,\n      mode,\n    })\n  }\n\n  private renderTabBar(formState: ICompareBranch) {\n    const selectedTab = formState.kind === ComparisonView.Behind ? 0 : 1\n\n    return (\n      <div className=\"compare-content\">\n        <TabBar selectedIndex={selectedTab} onTabClicked={this.onTabClicked}>\n          <span>{`Behind (${formState.aheadBehind.behind})`}</span>\n          <span>{`Ahead (${formState.aheadBehind.ahead})`}</span>\n        </TabBar>\n        {this.renderActiveTab()}\n      </div>\n    )\n  }\n\n  private renderCompareBranchListItem = (\n    item: IBranchListItem,\n    matches: IMatches\n  ) => {\n    const currentBranch = this.props.currentBranch\n\n    const currentBranchName = currentBranch != null ? currentBranch.name : null\n    const branch = item.branch\n\n    const aheadBehind = currentBranch\n      ? this.props.compareState.aheadBehindCache.get(\n          currentBranch.tip.sha,\n          branch.tip.sha\n        )\n      : null\n\n    return (\n      <CompareBranchListItem\n        branch={branch}\n        isCurrentBranch={branch.name === currentBranchName}\n        matches={matches}\n        aheadBehind={aheadBehind}\n      />\n    )\n  }\n\n  private onBranchFilterKeyDown = (\n    event: React.KeyboardEvent<HTMLInputElement>\n  ) => {\n    const key = event.key\n\n    if (key === 'Enter') {\n      if (this.resultCount === 0) {\n        event.preventDefault()\n        return\n      }\n\n      if (this.props.compareState.filterText.length === 0) {\n        this.handleEscape()\n      } else {\n        if (this.state.focusedBranch == null) {\n          this.viewHistoryForBranch()\n        } else {\n          const branch = this.state.focusedBranch\n\n          this.props.dispatcher.executeCompare(this.props.repository, {\n            kind: CompareActionKind.Branch,\n            branch,\n            mode: ComparisonView.Behind,\n          })\n\n          this.props.dispatcher.updateCompareForm(this.props.repository, {\n            filterText: branch.name,\n          })\n        }\n\n        if (this.textbox) {\n          this.textbox.blur()\n        }\n      }\n    } else if (key === 'Escape') {\n      this.handleEscape()\n    } else if (key === 'ArrowDown') {\n      if (this.branchList !== null) {\n        this.branchList.selectFirstItem(true)\n      }\n    }\n  }\n\n  private handleEscape = () => {\n    this.clearFilterState()\n    if (this.textbox) {\n      this.textbox.blur()\n    }\n  }\n\n  private onCommitSelected = (commit: Commit) => {\n    this.props.dispatcher.changeCommitSelection(\n      this.props.repository,\n      commit.sha\n    )\n\n    this.loadChangedFilesScheduler.queue(() => {\n      this.props.dispatcher.loadChangedFilesForCurrentSelection(\n        this.props.repository\n      )\n    })\n  }\n\n  private onScroll = (start: number, end: number) => {\n    const compareState = this.props.compareState\n    const formState = compareState.formState\n\n    if (formState.kind !== ComparisonView.None) {\n      // as the app is currently comparing the current branch to some other\n      // branch, everything needed should be loaded\n      return\n    }\n\n    const commits = compareState.commitSHAs\n    if (commits.length - end <= CloseToBottomThreshold) {\n      if (this.loadingMoreCommitsPromise != null) {\n        // as this callback fires for any scroll event we need to guard\n        // against re-entrant calls to loadNextHistoryBatch\n        return\n      }\n\n      this.loadingMoreCommitsPromise = this.props.dispatcher\n        .loadNextCommitBatch(this.props.repository)\n        .then(() => {\n          // deferring unsetting this flag to some time _after_ the commits\n          // have been appended to prevent eagerly adding more commits due\n          // to scroll events (which fire indiscriminately)\n          window.setTimeout(() => {\n            this.loadingMoreCommitsPromise = null\n          }, 500)\n        })\n    }\n  }\n\n  private onBranchFilterTextChanged = (filterText: string) => {\n    if (filterText.length === 0) {\n      this.setState({ focusedBranch: null })\n    }\n\n    this.props.dispatcher.updateCompareForm(this.props.repository, {\n      filterText,\n    })\n  }\n\n  private clearFilterState = () => {\n    this.setState({\n      focusedBranch: null,\n    })\n\n    this.props.dispatcher.updateCompareForm(this.props.repository, {\n      filterText: '',\n    })\n\n    this.viewHistoryForBranch()\n  }\n\n  private onBranchItemClicked = (branch: Branch) => {\n    this.props.dispatcher.executeCompare(this.props.repository, {\n      branch,\n      kind: CompareActionKind.Branch,\n      mode: ComparisonView.Behind,\n    })\n\n    this.setState({\n      focusedBranch: null,\n    })\n\n    this.props.dispatcher.updateCompareForm(this.props.repository, {\n      filterText: branch.name,\n      showBranchList: false,\n    })\n  }\n\n  private onSelectionChanged = (\n    branch: Branch | null,\n    source: SelectionSource\n  ) => {\n    if (source.kind === 'mouseclick' && branch != null) {\n      this.props.dispatcher.executeCompare(this.props.repository, {\n        branch,\n        kind: CompareActionKind.Branch,\n        mode: ComparisonView.Behind,\n      })\n    }\n\n    this.setState({\n      focusedBranch: branch,\n    })\n  }\n\n  private onTextBoxFocused = () => {\n    this.props.dispatcher.updateCompareForm(this.props.repository, {\n      showBranchList: true,\n    })\n  }\n\n  private onTextBoxRef = (textbox: TextBox) => {\n    this.textbox = textbox\n  }\n\n  private onNotificationBannerDismissed = (reason: DismissalReason) => {\n    this.props.dispatcher.setDivergingBranchBannerVisibility(\n      this.props.repository,\n      false\n    )\n    this.props.dispatcher.recordDivergingBranchBannerDismissal()\n\n    switch (reason) {\n      case 'close':\n        this.setState({ hasConsumedNotification: false })\n        break\n      case 'compare':\n      case 'merge':\n        this.setState({ hasConsumedNotification: true })\n        break\n    }\n  }\n\n  private onMerge = () => {\n    if (this.state.hasConsumedNotification) {\n      this.props.dispatcher.recordDivergingBranchBannerInfluencedMerge()\n    }\n  }\n}\n\nfunction getPlaceholderText(state: ICompareState) {\n  const { allBranches, formState } = state\n\n  if (allBranches.length === 0) {\n    return __DARWIN__ ? 'No Branches to Compare' : 'No branches to compare'\n  } else if (formState.kind === ComparisonView.None) {\n    return __DARWIN__\n      ? 'Select Branch to Compare...'\n      : 'Select branch to compare...'\n  } else {\n    return undefined\n  }\n}\n","import * as React from 'react'\n\n/**\n * Component abstracting a resizable panel.\n *\n * Note: this component is pure, consumers must subscribe to the\n * onResize and onReset event and update the width prop accordingly.\n */\nexport class Resizable extends React.Component<IResizableProps, {}> {\n  public static defaultProps: IResizableProps = {\n    width: 250,\n    maximumWidth: 350,\n    minimumWidth: 200,\n  }\n\n  private startWidth: number | null = null\n  private startX: number | null = null\n\n  /**\n   * Returns the current width as determined by props.\n   *\n   * This value will be constrained by the maximum and minimum\n   * with props and might not be identical to that of props.width.\n   */\n  private getCurrentWidth() {\n    return this.clampWidth(this.props.width)\n  }\n\n  /**\n   * Constrains the provided width to lie within the minimum and\n   * maximum widths as determined by props\n   */\n  private clampWidth(width: number) {\n    return Math.max(\n      this.props.minimumWidth!,\n      Math.min(this.props.maximumWidth!, width)\n    )\n  }\n\n  /**\n   * Handler for when the user presses the mouse button over the resize\n   * handle.\n   */\n  private handleDragStart = (e: React.MouseEvent<any>) => {\n    this.startX = e.clientX\n    this.startWidth = this.getCurrentWidth() || null\n\n    document.addEventListener('mousemove', this.handleDragMove)\n    document.addEventListener('mouseup', this.handleDragStop)\n\n    e.preventDefault()\n  }\n\n  /**\n   * Handler for when the user moves the mouse while dragging\n   */\n  private handleDragMove = (e: MouseEvent) => {\n    if (this.startWidth == null || this.startX == null) {\n      return\n    }\n\n    const deltaX = e.clientX - this.startX\n    const newWidth = this.startWidth + deltaX\n    const newWidthClamped = this.clampWidth(newWidth)\n\n    if (this.props.onResize) {\n      this.props.onResize(newWidthClamped)\n    }\n\n    e.preventDefault()\n  }\n\n  /**\n   * Handler for when the user lets go of the mouse button during\n   * a resize operation.\n   */\n  private handleDragStop = (e: MouseEvent) => {\n    document.removeEventListener('mousemove', this.handleDragMove)\n    document.removeEventListener('mouseup', this.handleDragStop)\n\n    e.preventDefault()\n  }\n\n  /**\n   * Handler for when the resize handle is double clicked.\n   *\n   * Resets the panel width to its default value and clears\n   * any persisted value.\n   */\n  private handleDoubleClick = () => {\n    if (this.props.onReset) {\n      this.props.onReset()\n    }\n  }\n\n  public render() {\n    const style: React.CSSProperties = {\n      width: this.getCurrentWidth(),\n      maxWidth: this.props.maximumWidth,\n      minWidth: this.props.minimumWidth,\n    }\n\n    return (\n      <div id={this.props.id} className=\"resizable-component\" style={style}>\n        {this.props.children}\n        <div\n          onMouseDown={this.handleDragStart}\n          onDoubleClick={this.handleDoubleClick}\n          className=\"resize-handle\"\n        />\n      </div>\n    )\n  }\n}\n\nexport interface IResizableProps {\n  readonly width: number\n\n  /** The maximum width the panel can be resized to.\n   *\n   * @default 350\n   */\n  readonly maximumWidth?: number\n\n  /**\n   * The minimum width the panel can be resized to.\n   *\n   * @default 150\n   */\n  readonly minimumWidth?: number\n\n  /** The optional ID for the root element. */\n  readonly id?: string\n\n  /**\n   * Handler called when the width of the component has changed\n   * through an explicit resize event (dragging the handle).\n   */\n  readonly onResize?: (newWidth: number) => void\n\n  /**\n   * Handler called when the resizable component has been\n   * reset (ie restored to its original width by double clicking\n   * on the resize handle).\n   */\n  readonly onReset?: () => void\n}\n","import * as React from 'react'\nimport * as Path from 'path'\nimport { pathExists } from 'fs-extra'\nimport { revealInFileManager } from '../../lib/app-shell'\n\nimport { FileChange, mapStatus, iconForStatus } from '../../models/status'\nimport { Repository } from '../../models/repository'\n\nimport { PathLabel } from '../lib/path-label'\nimport {\n  isSafeFileExtension,\n  DefaultEditorLabel,\n  RevealInFileManagerLabel,\n  OpenWithDefaultProgramLabel,\n} from '../lib/context-menu'\nimport { List } from '../lib/list'\n\nimport { Octicon } from '../octicons'\nimport { showContextualMenu } from '../main-process-proxy'\n\ninterface IFileListProps {\n  readonly files: ReadonlyArray<FileChange>\n  readonly selectedFile: FileChange | null\n  readonly onSelectedFileChanged: (file: FileChange) => void\n  readonly availableWidth: number\n\n  /**\n   * Called to open a file with its default application\n   * @param path The path of the file relative to the root of the repository\n   */\n  readonly onOpenItem: (path: string) => void\n\n  /** The name of the currently selected external editor */\n  readonly externalEditorLabel?: string\n\n  /**\n   * Called to open a file using the user's configured applications\n   * @param path The path of the file relative to the root of the repository\n   */\n  readonly onOpenInExternalEditor: (path: string) => void\n\n  /**\n   * Repository that we use to get the base path and build\n   * full path for the file in commit to check for file existence\n   */\n  readonly repository: Repository\n}\n\nexport class FileList extends React.Component<IFileListProps, {}> {\n  private onSelectedRowChanged = (row: number) => {\n    const file = this.props.files[row]\n    this.props.onSelectedFileChanged(file)\n  }\n\n  private renderFile = (row: number) => {\n    const file = this.props.files[row]\n    const status = file.status\n    const fileStatus = mapStatus(status)\n\n    const listItemPadding = 10 * 2\n    const statusWidth = 16\n    const filePathPadding = 5\n    const availablePathWidth =\n      this.props.availableWidth -\n      listItemPadding -\n      filePathPadding -\n      statusWidth\n\n    return (\n      <div className=\"file\" onContextMenu={this.onContextMenu}>\n        <PathLabel\n          path={file.path}\n          oldPath={file.oldPath}\n          status={file.status}\n          availableWidth={availablePathWidth}\n        />\n\n        <Octicon\n          symbol={iconForStatus(status)}\n          className={'status status-' + fileStatus.toLowerCase()}\n          title={fileStatus}\n        />\n      </div>\n    )\n  }\n\n  private rowForFile(file: FileChange | null): number {\n    return file ? this.props.files.findIndex(f => f.path === file.path) : -1\n  }\n\n  public render() {\n    return (\n      <div className=\"file-list\">\n        <List\n          rowRenderer={this.renderFile}\n          rowCount={this.props.files.length}\n          rowHeight={29}\n          selectedRows={[this.rowForFile(this.props.selectedFile)]}\n          onSelectedRowChanged={this.onSelectedRowChanged}\n        />\n      </div>\n    )\n  }\n\n  private onContextMenu = async (event: React.MouseEvent<HTMLDivElement>) => {\n    event.preventDefault()\n\n    if (this.props.selectedFile == null) {\n      return\n    }\n\n    const filePath = this.props.selectedFile.path\n    const fullPath = Path.join(this.props.repository.path, filePath)\n    const fileExistsOnDisk = await pathExists(fullPath)\n    if (!fileExistsOnDisk) {\n      showContextualMenu([\n        {\n          label: __DARWIN__\n            ? 'File Does Not Exist on Disk'\n            : 'File does not exist on disk',\n          enabled: false,\n        },\n      ])\n      return\n    }\n\n    const extension = Path.extname(filePath)\n\n    const isSafeExtension = isSafeFileExtension(extension)\n    const openInExternalEditor = this.props.externalEditorLabel\n      ? `Open in ${this.props.externalEditorLabel}`\n      : DefaultEditorLabel\n\n    const items = [\n      {\n        label: RevealInFileManagerLabel,\n        action: () => revealInFileManager(this.props.repository, filePath),\n        enabled: fileExistsOnDisk,\n      },\n      {\n        label: openInExternalEditor,\n        action: () => this.props.onOpenInExternalEditor(fullPath),\n        enabled: isSafeExtension && fileExistsOnDisk,\n      },\n      {\n        label: OpenWithDefaultProgramLabel,\n        action: () => this.props.onOpenItem(filePath),\n        enabled: isSafeExtension && fileExistsOnDisk,\n      },\n    ]\n    showContextualMenu(items)\n  }\n}\n","import * as React from 'react'\nimport * as classNames from 'classnames'\n\nimport { FileChange } from '../../models/status'\nimport { Octicon, OcticonSymbol } from '../octicons'\nimport { RichText } from '../lib/rich-text'\nimport { IGitHubUser } from '../../lib/databases'\nimport { Repository } from '../../models/repository'\nimport { Commit } from '../../models/commit'\nimport { getAvatarUsersForCommit, IAvatarUser } from '../../models/avatar'\nimport { AvatarStack } from '../lib/avatar-stack'\nimport { CommitAttribution } from '../lib/commit-attribution'\n\ninterface ICommitSummaryProps {\n  readonly repository: Repository\n  readonly commit: Commit\n  readonly files: ReadonlyArray<FileChange>\n  readonly emoji: Map<string, string>\n  readonly gitHubUsers: Map<string, IGitHubUser> | null\n\n  /**\n   * Whether or not the commit body container should\n   * be rendered expanded or not. In expanded mode the\n   * commit body container takes over the diff view\n   * allowing for full height, scrollable reading of\n   * the commit message body.\n   */\n  readonly isExpanded: boolean\n\n  readonly onExpandChanged: (isExpanded: boolean) => void\n\n  readonly onDescriptionBottomChanged: (descriptionBottom: Number) => void\n\n  readonly hideDescriptionBorder: boolean\n}\n\ninterface ICommitSummaryState {\n  /**\n   * The commit message summary, i.e. the first line in the commit message.\n   * Note that this may differ from the body property in the commit object\n   * passed through props, see the createState method for more details.\n   */\n  readonly summary: string\n\n  /**\n   * The commit message body, i.e. anything after the first line of text in the\n   * commit message. Note that this may differ from the body property in the\n   * commit object passed through props, see the createState method for more\n   * details.\n   */\n  readonly body: string\n\n  /**\n   * Whether or not the commit body text overflows its container. Used in\n   * conjunction with the isExpanded prop.\n   */\n  readonly isOverflowed: boolean\n\n  /**\n   * The avatars associated with this commit. Used when rendering\n   * the avatar stack and calculated whenever the commit prop changes.\n   */\n  readonly avatarUsers: ReadonlyArray<IAvatarUser>\n}\n\nconst maxSummaryLength = 72\n\n/**\n * Removes whitespace characters from the end of the string\n */\nfunction trimTrailingWhitespace(value: string) {\n  return value.replace(/\\s+$/, '')\n}\n\n/**\n * Creates the state object for the CommitSummary component.\n *\n * Ensures that the commit summary never exceeds 72 characters and wraps it\n * into the commit body if it does.\n *\n * @param isOverflowed Whether or not the component should render the commit\n *                     body in expanded mode, see the documentation for the\n *                     isOverflowed state property.\n *\n * @param props        The current commit summary prop object.\n */\nfunction createState(isOverflowed: boolean, props: ICommitSummaryProps) {\n  let summary = trimTrailingWhitespace(props.commit.summary)\n  let body = trimTrailingWhitespace(props.commit.body)\n\n  if (summary.length > maxSummaryLength) {\n    // Truncate at least 3 characters off the end to avoid just an ellipsis\n    // followed by 1-2 characters in the body. This matches dotcom behavior.\n    const truncationMargin = 3\n    const truncateLength = maxSummaryLength - truncationMargin\n    const remainder = summary.substr(truncateLength)\n\n    // Don't join the the body with newlines if it's empty\n    body = body.length > 0 ? `${remainder}\\n\\n${body}` : `${remainder}`\n    summary = `${summary.substr(0, truncateLength)}`\n  }\n\n  const avatarUsers = getAvatarUsersForCommit(\n    props.repository.gitHubRepository,\n    props.gitHubUsers,\n    props.commit\n  )\n\n  return { isOverflowed, summary, body, avatarUsers }\n}\n\n/**\n * Helper function which determines if two commit objects\n * have the same commit summary and body.\n */\nfunction messageEquals(x: Commit, y: Commit) {\n  return x.summary === y.summary && x.body === y.body\n}\n\nexport class CommitSummary extends React.Component<\n  ICommitSummaryProps,\n  ICommitSummaryState\n> {\n  private descriptionScrollViewRef: HTMLDivElement | null = null\n  private readonly resizeObserver: ResizeObserver | null = null\n  private updateOverflowTimeoutId: number | null = null\n  private descriptionRef: HTMLDivElement | null = null\n\n  public constructor(props: ICommitSummaryProps) {\n    super(props)\n\n    this.state = createState(false, props)\n\n    const ResizeObserverClass: typeof ResizeObserver = (window as any)\n      .ResizeObserver\n\n    if (ResizeObserverClass || false) {\n      this.resizeObserver = new ResizeObserverClass(entries => {\n        for (const entry of entries) {\n          if (entry.target === this.descriptionScrollViewRef) {\n            // We might end up causing a recursive update by updating the state\n            // when we're reacting to a resize so we'll defer it until after\n            // react is done with this frame.\n            if (this.updateOverflowTimeoutId !== null) {\n              clearImmediate(this.updateOverflowTimeoutId)\n            }\n\n            this.updateOverflowTimeoutId = setImmediate(this.onResized)\n          }\n        }\n      })\n    }\n  }\n\n  private onResized = () => {\n    if (this.descriptionRef) {\n      const descriptionBottom = this.descriptionRef.getBoundingClientRect()\n        .bottom\n      this.props.onDescriptionBottomChanged(descriptionBottom)\n    }\n\n    if (this.props.isExpanded) {\n      return\n    }\n\n    this.updateOverflow()\n  }\n\n  private onDescriptionScrollViewRef = (ref: HTMLDivElement | null) => {\n    this.descriptionScrollViewRef = ref\n\n    if (this.resizeObserver) {\n      this.resizeObserver.disconnect()\n\n      if (ref) {\n        this.resizeObserver.observe(ref)\n      } else {\n        this.setState({ isOverflowed: false })\n      }\n    }\n  }\n\n  private onDescriptionRef = (ref: HTMLDivElement | null) => {\n    this.descriptionRef = ref\n  }\n\n  private renderExpander() {\n    if (\n      !this.state.body.length ||\n      (!this.props.isExpanded && !this.state.isOverflowed)\n    ) {\n      return null\n    }\n\n    const expanded = this.props.isExpanded\n    const onClick = expanded ? this.onCollapse : this.onExpand\n    const icon = expanded ? OcticonSymbol.unfold : OcticonSymbol.fold\n\n    return (\n      <a onClick={onClick} className=\"expander\">\n        <Octicon symbol={icon} />\n        {expanded ? 'Collapse' : 'Expand'}\n      </a>\n    )\n  }\n\n  private onExpand = () => {\n    this.props.onExpandChanged(true)\n  }\n\n  private onCollapse = () => {\n    if (this.descriptionScrollViewRef) {\n      this.descriptionScrollViewRef.scrollTop = 0\n    }\n\n    this.props.onExpandChanged(false)\n  }\n\n  private updateOverflow() {\n    const scrollView = this.descriptionScrollViewRef\n    if (scrollView) {\n      this.setState({\n        isOverflowed: scrollView.scrollHeight > scrollView.offsetHeight,\n      })\n    } else {\n      if (this.state.isOverflowed) {\n        this.setState({ isOverflowed: false })\n      }\n    }\n  }\n\n  public componentDidMount() {\n    // No need to check if it overflows if we're expanded\n    if (!this.props.isExpanded) {\n      this.updateOverflow()\n    }\n  }\n\n  public componentWillUpdate(nextProps: ICommitSummaryProps) {\n    if (!messageEquals(nextProps.commit, this.props.commit)) {\n      this.setState(createState(false, nextProps))\n    }\n  }\n\n  public componentDidUpdate(\n    prevProps: ICommitSummaryProps,\n    prevState: ICommitSummaryState\n  ) {\n    // No need to check if it overflows if we're expanded\n    if (!this.props.isExpanded) {\n      // If the body has changed or we've just toggled the expanded\n      // state we'll recalculate whether we overflow or not.\n      if (prevState.body !== this.state.body || prevProps.isExpanded) {\n        this.updateOverflow()\n      }\n    } else {\n      // Clear overflow state if we're expanded, we don't need it.\n      if (this.state.isOverflowed) {\n        this.setState({ isOverflowed: false })\n      }\n    }\n  }\n\n  private renderDescription() {\n    if (!this.state.body) {\n      return null\n    }\n\n    return (\n      <div\n        className=\"commit-summary-description-container\"\n        ref={this.onDescriptionRef}\n      >\n        <div\n          className=\"commit-summary-description-scroll-view\"\n          ref={this.onDescriptionScrollViewRef}\n        >\n          <RichText\n            className=\"commit-summary-description\"\n            emoji={this.props.emoji}\n            repository={this.props.repository}\n            text={this.state.body}\n          />\n        </div>\n\n        {this.renderExpander()}\n      </div>\n    )\n  }\n\n  public render() {\n    const fileCount = this.props.files.length\n    const filesPlural = fileCount === 1 ? 'file' : 'files'\n    const filesDescription = `${fileCount} changed ${filesPlural}`\n    const shortSHA = this.props.commit.sha.slice(0, 7)\n\n    const className = classNames({\n      expanded: this.props.isExpanded,\n      collapsed: !this.props.isExpanded,\n      'has-expander': this.props.isExpanded || this.state.isOverflowed,\n      'hide-description-border': this.props.hideDescriptionBorder,\n    })\n\n    return (\n      <div id=\"commit-summary\" className={className}>\n        <div className=\"commit-summary-header\">\n          <RichText\n            className=\"commit-summary-title\"\n            emoji={this.props.emoji}\n            repository={this.props.repository}\n            text={this.state.summary}\n          />\n\n          <ul className=\"commit-summary-meta\">\n            <li\n              className=\"commit-summary-meta-item without-truncation\"\n              aria-label=\"Author\"\n            >\n              <AvatarStack users={this.state.avatarUsers} />\n              <CommitAttribution\n                gitHubRepository={this.props.repository.gitHubRepository}\n                commit={this.props.commit}\n              />\n            </li>\n\n            <li className=\"commit-summary-meta-item\" aria-label=\"SHA\">\n              <span aria-hidden=\"true\">\n                <Octicon symbol={OcticonSymbol.gitCommit} />\n              </span>\n              <span className=\"sha\">{shortSHA}</span>\n            </li>\n\n            <li className=\"commit-summary-meta-item\" title={filesDescription}>\n              <span aria-hidden=\"true\">\n                <Octicon symbol={OcticonSymbol.diff} />\n              </span>\n\n              {filesDescription}\n            </li>\n          </ul>\n        </div>\n\n        {this.renderDescription()}\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport * as Path from 'path'\n\nimport { CommitSummary } from './commit-summary'\nimport { Diff } from '../diff'\nimport { FileList } from './file-list'\nimport { Repository } from '../../models/repository'\nimport { CommittedFileChange, FileChange } from '../../models/status'\nimport { Commit } from '../../models/commit'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { ImageDiffType } from '../../lib/app-state'\nimport { encodePathAsUrl } from '../../lib/path'\nimport { ThrottledScheduler } from '../lib/throttled-scheduler'\nimport { IGitHubUser } from '../../lib/databases'\nimport { Resizable } from '../resizable'\nimport { openFile } from '../../lib/open-file'\nimport { IDiff } from '../../models/diff'\n\ninterface ISelectedCommitProps {\n  readonly repository: Repository\n  readonly dispatcher: Dispatcher\n  readonly emoji: Map<string, string>\n  readonly selectedCommit: Commit | null\n  readonly changedFiles: ReadonlyArray<CommittedFileChange>\n  readonly selectedFile: CommittedFileChange | null\n  readonly currentDiff: IDiff | null\n  readonly commitSummaryWidth: number\n  readonly gitHubUsers: Map<string, IGitHubUser>\n  readonly selectedDiffType: ImageDiffType\n  /** The name of the currently selected external editor */\n  readonly externalEditorLabel?: string\n\n  /**\n   * Called to open a file using the user's configured applications\n   * @param path The path of the file relative to the root of the repository\n   */\n  readonly onOpenInExternalEditor: (path: string) => void\n}\n\ninterface ISelectedCommitState {\n  readonly isExpanded: boolean\n  readonly hideDescriptionBorder: boolean\n}\n\n/** The History component. Contains the commit list, commit summary, and diff. */\nexport class SelectedCommit extends React.Component<\n  ISelectedCommitProps,\n  ISelectedCommitState\n> {\n  private readonly loadChangedFilesScheduler = new ThrottledScheduler(200)\n  private historyRef: HTMLDivElement | null = null\n\n  public constructor(props: ISelectedCommitProps) {\n    super(props)\n\n    this.state = {\n      isExpanded: false,\n      hideDescriptionBorder: false,\n    }\n  }\n\n  private onFileSelected = (file: FileChange) => {\n    this.props.dispatcher.changeFileSelection(\n      this.props.repository,\n      file as CommittedFileChange\n    )\n  }\n\n  private onHistoryRef = (ref: HTMLDivElement | null) => {\n    this.historyRef = ref\n  }\n\n  public componentWillUpdate(nextProps: ISelectedCommitProps) {\n    // reset isExpanded if we're switching commits.\n    const currentValue = this.props.selectedCommit\n      ? this.props.selectedCommit.sha\n      : undefined\n    const nextValue = nextProps.selectedCommit\n      ? nextProps.selectedCommit.sha\n      : undefined\n\n    if ((currentValue || nextValue) && currentValue !== nextValue) {\n      if (this.state.isExpanded) {\n        this.setState({ isExpanded: false })\n      }\n    }\n  }\n\n  public componentWillUnmount() {\n    this.loadChangedFilesScheduler.clear()\n  }\n\n  private renderDiff() {\n    const file = this.props.selectedFile\n    const diff = this.props.currentDiff\n\n    if (file == null || diff == null) {\n      // don't show both 'empty' messages\n      const message =\n        this.props.changedFiles.length === 0 ? '' : 'No file selected'\n\n      return (\n        <div className=\"panel blankslate\" id=\"diff\">\n          {message}\n        </div>\n      )\n    }\n\n    return (\n      <Diff\n        repository={this.props.repository}\n        imageDiffType={this.props.selectedDiffType}\n        file={file}\n        diff={diff}\n        readOnly={true}\n        dispatcher={this.props.dispatcher}\n      />\n    )\n  }\n\n  private renderCommitSummary(commit: Commit) {\n    return (\n      <CommitSummary\n        commit={commit}\n        files={this.props.changedFiles}\n        emoji={this.props.emoji}\n        repository={this.props.repository}\n        gitHubUsers={this.props.gitHubUsers}\n        onExpandChanged={this.onExpandChanged}\n        isExpanded={this.state.isExpanded}\n        onDescriptionBottomChanged={this.onDescriptionBottomChanged}\n        hideDescriptionBorder={this.state.hideDescriptionBorder}\n      />\n    )\n  }\n\n  private onExpandChanged = (isExpanded: boolean) => {\n    this.setState({ isExpanded })\n  }\n\n  private onDescriptionBottomChanged = (descriptionBottom: Number) => {\n    if (this.historyRef) {\n      const historyBottom = this.historyRef.getBoundingClientRect().bottom\n      this.setState({\n        hideDescriptionBorder: descriptionBottom >= historyBottom,\n      })\n    }\n  }\n\n  private onCommitSummaryReset = () => {\n    this.props.dispatcher.resetCommitSummaryWidth()\n  }\n\n  private onCommitSummaryResize = (width: number) => {\n    this.props.dispatcher.setCommitSummaryWidth(width)\n  }\n\n  private renderFileList() {\n    const files = this.props.changedFiles\n    if (files.length === 0) {\n      return <div className=\"fill-window\">No files in commit</div>\n    }\n\n    // -1 for right hand side border\n    const availableWidth = this.props.commitSummaryWidth - 1\n\n    return (\n      <FileList\n        files={files}\n        onSelectedFileChanged={this.onFileSelected}\n        selectedFile={this.props.selectedFile}\n        availableWidth={availableWidth}\n        onOpenItem={this.onOpenItem}\n        externalEditorLabel={this.props.externalEditorLabel}\n        onOpenInExternalEditor={this.props.onOpenInExternalEditor}\n        repository={this.props.repository}\n      />\n    )\n  }\n\n  /**\n   * Open file with default application.\n   * @param path The path of the file relative to the root of the repository\n   */\n  private onOpenItem = (path: string) => {\n    const fullPath = Path.join(this.props.repository.path, path)\n    openFile(fullPath, this.props.dispatcher)\n  }\n\n  public render() {\n    const commit = this.props.selectedCommit\n\n    if (commit == null) {\n      return <NoCommitSelected />\n    }\n\n    const className = this.state.isExpanded ? 'expanded' : 'collapsed'\n\n    return (\n      <div id=\"history\" ref={this.onHistoryRef} className={className}>\n        {this.renderCommitSummary(commit)}\n        <div id=\"commit-details\">\n          <Resizable\n            width={this.props.commitSummaryWidth}\n            onResize={this.onCommitSummaryResize}\n            onReset={this.onCommitSummaryReset}\n          >\n            {this.renderFileList()}\n          </Resizable>\n          {this.renderDiff()}\n        </div>\n      </div>\n    )\n  }\n}\n\nfunction NoCommitSelected() {\n  const BlankSlateImage = encodePathAsUrl(\n    __dirname,\n    'static/empty-no-commit.svg'\n  )\n\n  return (\n    <div className=\"panel blankslate\">\n      <img src={BlankSlateImage} className=\"blankslate-image\" />\n      No commit selected\n    </div>\n  )\n}\n","export { SelectedCommit } from './selected-commit'\nexport { CompareSidebar } from './compare'\n","import * as React from 'react'\n\ninterface IFilesChangedBadgeProps {\n  readonly filesChangedCount: number\n}\n\n/** The number that can be displayed as a specific value */\nconst MaximumChangesCount = 300\n\n/** Displays number of files that have changed */\nexport class FilesChangedBadge extends React.Component<\n  IFilesChangedBadgeProps,\n  {}\n> {\n  public render() {\n    const filesChangedCount = this.props.filesChangedCount\n    const badgeCount =\n      filesChangedCount > MaximumChangesCount\n        ? `${MaximumChangesCount}+`\n        : filesChangedCount\n\n    return <span className=\"counter\">{badgeCount}</span>\n  }\n}\n","import * as React from 'react'\nimport { encodePathAsUrl } from '../../lib/path'\n\nconst BlankSlateImage = encodePathAsUrl(\n  __dirname,\n  'static/multiple-files-selected.svg'\n)\n\ninterface IMultipleSelectionProps {\n  /** Called when the user chooses to open the repository. */\n  readonly count: number\n}\n/** The component to display when there are no local changes. */\nexport class MultipleSelection extends React.Component<\n  IMultipleSelectionProps,\n  {}\n> {\n  public render() {\n    return (\n      <div className=\"panel blankslate\" id=\"no-changes\">\n        <img src={BlankSlateImage} className=\"blankslate-image\" />\n        <div>{this.props.count} files selected</div>\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\n\nimport { encodePathAsUrl } from '../../lib/path'\nimport { revealInFileManager } from '../../lib/app-shell'\nimport { Repository } from '../../models/repository'\nimport { LinkButton } from '../lib/link-button'\n\nconst BlankSlateImage = encodePathAsUrl(\n  __dirname,\n  'static/empty-no-file-selected.svg'\n)\n\ninterface INoChangesProps {\n  readonly repository: Repository\n}\n\n/** The component to display when there are no local changes. */\nexport class NoChanges extends React.Component<INoChangesProps, {}> {\n  public render() {\n    const opener = __DARWIN__\n      ? 'Finder'\n      : __WIN32__\n        ? 'Explorer'\n        : 'your File Manager'\n    return (\n      <div className=\"panel blankslate\" id=\"no-changes\">\n        <img src={BlankSlateImage} className=\"blankslate-image\" />\n        <div>No local changes</div>\n\n        <div>\n          Would you like to{' '}\n          <LinkButton onClick={this.open}>open this repository</LinkButton> in{' '}\n          {opener}?\n        </div>\n      </div>\n    )\n  }\n\n  private open = () => {\n    revealInFileManager(this.props.repository, '')\n  }\n}\n","import * as React from 'react'\nimport { PathLabel } from '../lib/path-label'\nimport { AppFileStatus, mapStatus, iconForStatus } from '../../models/status'\nimport { IDiff, DiffType } from '../../models/diff'\nimport { Octicon, OcticonSymbol } from '../octicons'\nimport { Button } from '../lib/button'\nimport { enableMergeTool } from '../../lib/feature-flag'\n\ninterface IChangedFileDetailsProps {\n  readonly path: string\n  readonly oldPath?: string\n  readonly status: AppFileStatus\n  readonly diff: IDiff\n\n  readonly onOpenMergeTool: (path: string) => void\n}\n\n/** Displays information about a file */\nexport class ChangedFileDetails extends React.Component<\n  IChangedFileDetailsProps,\n  {}\n> {\n  public render() {\n    const status = this.props.status\n    const fileStatus = mapStatus(status)\n\n    return (\n      <div className=\"header\">\n        <PathLabel\n          path={this.props.path}\n          oldPath={this.props.oldPath}\n          status={this.props.status}\n        />\n        {this.renderDecorator()}\n\n        <Octicon\n          symbol={iconForStatus(status)}\n          className={'status status-' + fileStatus.toLowerCase()}\n          title={fileStatus}\n        />\n      </div>\n    )\n  }\n\n  private renderDecorator() {\n    const status = this.props.status\n    const diff = this.props.diff\n    if (status === AppFileStatus.Conflicted && enableMergeTool()) {\n      return (\n        <Button className=\"open-merge-tool\" onClick={this.onOpenMergeTool}>\n          {__DARWIN__ ? 'Open Merge Tool' : 'Open merge tool'}\n        </Button>\n      )\n    } else if (diff.kind === DiffType.Text && diff.lineEndingsChange) {\n      const message = `Warning: line endings have changed from '${\n        diff.lineEndingsChange.from\n      }' to '${diff.lineEndingsChange.to}'.`\n      return (\n        <Octicon\n          symbol={OcticonSymbol.alert}\n          className={'line-endings'}\n          title={message}\n        />\n      )\n    } else {\n      return null\n    }\n  }\n\n  private onOpenMergeTool = () => {\n    this.props.onOpenMergeTool(this.props.path)\n  }\n}\n","export interface IRange {\n  /** The starting location for the range. */\n  readonly location: number\n\n  /** The length of the range. */\n  readonly length: number\n}\n\n/** Get the maximum position in the range. */\nfunction rangeMax(range: IRange): number {\n  return range.location + range.length\n}\n\n/** Get the length of the common substring between the two strings. */\nfunction commonLength(\n  stringA: string,\n  rangeA: IRange,\n  stringB: string,\n  rangeB: IRange,\n  reverse: boolean\n): number {\n  const max = Math.min(rangeA.length, rangeB.length)\n  const startA = reverse ? rangeMax(rangeA) - 1 : rangeA.location\n  const startB = reverse ? rangeMax(rangeB) - 1 : rangeB.location\n  const stride = reverse ? -1 : 1\n\n  let length = 0\n  while (Math.abs(length) < max) {\n    if (stringA[startA + length] !== stringB[startB + length]) {\n      break\n    }\n\n    length += stride\n  }\n\n  return Math.abs(length)\n}\n\n/** Get the changed ranges in the strings, relative to each other. */\nexport function relativeChanges(\n  stringA: string,\n  stringB: string\n): { stringARange: IRange; stringBRange: IRange } {\n  let bRange = { location: 0, length: stringB.length }\n  let aRange = { location: 0, length: stringA.length }\n\n  const prefixLength = commonLength(stringB, bRange, stringA, aRange, false)\n  bRange = {\n    location: bRange.location + prefixLength,\n    length: bRange.length - prefixLength,\n  }\n  aRange = {\n    location: aRange.location + prefixLength,\n    length: aRange.length - prefixLength,\n  }\n\n  const suffixLength = commonLength(stringB, bRange, stringA, aRange, true)\n  bRange.length -= suffixLength\n  aRange.length -= suffixLength\n\n  return { stringARange: aRange, stringBRange: bRange }\n}\n","import { ITokens, IHighlightRequest } from './types'\nimport { encodePathAsUrl } from '../../lib/path'\n\nconst highlightWorkers = new Array<Worker>()\nconst maxIdlingWorkers = 2\nconst workerMaxRunDuration = 5 * 1000\nconst workerUri = encodePathAsUrl(__dirname, 'highlighter.js')\n\n/**\n * Request an automatic detection of the language and highlight\n * the contents provided.\n *\n * @param contents  The actual contents which is to be used for\n *                  highlighting.\n * @param extension The file extension of the path in question as returned\n *                  by node's extname() function (i.e. with a leading dot).\n * @param tabSize   The width of a tab character. Defaults to 4. Used by the\n *                  stream to count columns. See CodeMirror's StringStream\n *                  class for more details.\n * @param lines     An optional filter of lines which needs to be tokenized.\n *\n *                  If undefined or empty all lines will be tokenized\n *                  and returned. By passing an explicit set of lines we can\n *                  both minimize the size of the response object (which needs\n *                  to be serialized over the IPC boundary) and, for stateless\n *                  modes we can significantly speed up the highlight process.\n */\nexport function highlight(\n  contents: string,\n  extension: string,\n  tabSize: number,\n  lines: Array<number>\n): Promise<ITokens> {\n  // Bail early if there's no content to highlight or if we don't\n  // need any lines from this file.\n  if (!contents.length || !lines.length) {\n    return Promise.resolve({})\n  }\n\n  // Get an idle worker or create a new one if none exist.\n  const worker = highlightWorkers.shift() || new Worker(workerUri)\n\n  return new Promise<ITokens>((resolve, reject) => {\n    let timeout: null | number = null\n\n    const clearTimeout = () => {\n      if (timeout) {\n        window.clearTimeout(timeout)\n        timeout = null\n      }\n    }\n\n    worker.onerror = ev => {\n      clearTimeout()\n      worker.terminate()\n      reject(ev.error || new Error(ev.message))\n    }\n\n    worker.onmessage = ev => {\n      clearTimeout()\n      if (highlightWorkers.length < maxIdlingWorkers) {\n        highlightWorkers.push(worker)\n      } else {\n        worker.terminate()\n      }\n      resolve(ev.data as ITokens)\n    }\n\n    const request: IHighlightRequest = {\n      contents,\n      extension,\n      tabSize,\n      lines,\n      addModeClass: true,\n    }\n\n    worker.postMessage(request)\n\n    timeout = window.setTimeout(() => {\n      worker.terminate()\n      reject(new Error('timed out'))\n    }, workerMaxRunDuration)\n  })\n}\n","import * as Path from 'path'\n\nimport { assertNever } from '../../../lib/fatal-error'\n\nimport { getPartialBlobContents } from '../../../lib/git/show'\nimport { readPartialFile } from '../../../lib/file-system'\nimport { highlight } from '../../../lib/highlighter/worker'\nimport { ITokens } from '../../../lib/highlighter/types'\n\nimport {\n  CommittedFileChange,\n  WorkingDirectoryFileChange,\n  AppFileStatus,\n} from '../../../models/status'\nimport { Repository } from '../../../models/repository'\nimport { DiffHunk, DiffLineType, DiffLine } from '../../../models/diff'\n\n/** The maximum number of bytes we'll process for highlighting. */\nconst MaxHighlightContentLength = 256 * 1024\n\ntype ChangedFile = WorkingDirectoryFileChange | CommittedFileChange\n\ninterface ILineFilters {\n  readonly oldLineFilter: Array<number>\n  readonly newLineFilter: Array<number>\n}\n\ninterface IFileContents {\n  readonly file: ChangedFile\n  readonly oldContents: Buffer\n  readonly newContents: Buffer\n}\n\ninterface IFileTokens {\n  readonly oldTokens: ITokens\n  readonly newTokens: ITokens\n}\n\nasync function getOldFileContent(\n  repository: Repository,\n  file: ChangedFile\n): Promise<Buffer> {\n  if (file.status === AppFileStatus.New) {\n    return new Buffer(0)\n  }\n\n  let commitish\n\n  if (file instanceof WorkingDirectoryFileChange) {\n    // If we pass an empty string here we get the contents\n    // that are in the index. But since we call diff with\n    // --no-index (see diff.ts) we need to look at what's\n    // actually committed to get the appropriate content.\n    commitish = 'HEAD'\n  } else if (file instanceof CommittedFileChange) {\n    commitish = `${file.commitish}^`\n  } else {\n    return assertNever(file, 'Unknown file change type')\n  }\n\n  return getPartialBlobContents(\n    repository,\n    commitish,\n    file.oldPath || file.path,\n    MaxHighlightContentLength\n  )\n}\n\nasync function getNewFileContent(\n  repository: Repository,\n  file: ChangedFile\n): Promise<Buffer> {\n  if (file.status === AppFileStatus.Deleted) {\n    return new Buffer(0)\n  }\n\n  if (file instanceof WorkingDirectoryFileChange) {\n    return readPartialFile(\n      Path.join(repository.path, file.path),\n      0,\n      MaxHighlightContentLength - 1\n    )\n  } else if (file instanceof CommittedFileChange) {\n    return getPartialBlobContents(\n      repository,\n      file.commitish,\n      file.path,\n      MaxHighlightContentLength\n    )\n  }\n\n  return assertNever(file, 'Unknown file change type')\n}\n\nexport async function getFileContents(\n  repo: Repository,\n  file: ChangedFile,\n  lineFilters: ILineFilters\n): Promise<IFileContents> {\n  const oldContentsPromise = lineFilters.oldLineFilter.length\n    ? getOldFileContent(repo, file)\n    : Promise.resolve(new Buffer(0))\n\n  const newContentsPromise = lineFilters.newLineFilter.length\n    ? getNewFileContent(repo, file)\n    : Promise.resolve(new Buffer(0))\n\n  const [oldContents, newContents] = await Promise.all([\n    oldContentsPromise.catch(e => {\n      log.error('Could not load old contents for syntax highlighting', e)\n      return new Buffer(0)\n    }),\n    newContentsPromise.catch(e => {\n      log.error('Could not load new contents for syntax highlighting', e)\n      return new Buffer(0)\n    }),\n  ])\n\n  return { file, oldContents, newContents }\n}\n\n/**\n * Figure out which lines we need to have tokenized in\n * both the old and new version of the file.\n */\nexport function getLineFilters(hunks: ReadonlyArray<DiffHunk>): ILineFilters {\n  const oldLineFilter = new Array<number>()\n  const newLineFilter = new Array<number>()\n\n  const diffLines = new Array<DiffLine>()\n\n  let anyAdded = false\n  let anyDeleted = false\n\n  for (const hunk of hunks) {\n    for (const line of hunk.lines) {\n      anyAdded = anyAdded || line.type === DiffLineType.Add\n      anyDeleted = anyDeleted || line.type === DiffLineType.Delete\n      diffLines.push(line)\n    }\n  }\n\n  for (const line of diffLines) {\n    // So this might need a little explaining. What we're trying\n    // to achieve here is if the diff contains only additions or\n    // only deletions we'll source all the highlighted lines from\n    // either the before or after file. That way we can completely\n    // disregard loading, and highlighting, the other version.\n    if (line.oldLineNumber !== null && line.newLineNumber !== null) {\n      if (anyAdded && !anyDeleted) {\n        newLineFilter.push(line.newLineNumber - 1)\n      } else {\n        oldLineFilter.push(line.oldLineNumber - 1)\n      }\n    } else {\n      // If there's a mix (meaning we'll have to read from both\n      // anyway) we'll prioritize the old version since\n      // that's immutable and less likely to be the subject of a\n      // race condition when someone rapidly modifies the file on\n      // disk.\n      if (line.oldLineNumber !== null) {\n        oldLineFilter.push(line.oldLineNumber - 1)\n      } else if (line.newLineNumber !== null) {\n        newLineFilter.push(line.newLineNumber - 1)\n      }\n    }\n  }\n\n  return { oldLineFilter, newLineFilter }\n}\n\nexport async function highlightContents(\n  contents: IFileContents,\n  tabSize: number,\n  lineFilters: ILineFilters\n): Promise<IFileTokens> {\n  const { file, oldContents, newContents } = contents\n\n  const [oldTokens, newTokens] = await Promise.all([\n    highlight(\n      oldContents.toString('utf8'),\n      Path.extname(file.oldPath || file.path),\n      tabSize,\n      lineFilters.oldLineFilter\n    ).catch(e => {\n      log.error('Highlighter worked failed for old contents', e)\n      return {}\n    }),\n    highlight(\n      newContents.toString('utf8'),\n      Path.extname(file.path),\n      tabSize,\n      lineFilters.newLineFilter\n    ).catch(e => {\n      log.error('Highlighter worked failed for new contents', e)\n      return {}\n    }),\n  ])\n\n  return { oldTokens, newTokens }\n}\n","import { DiffSelection } from '../../../models/diff'\nimport { ISelectionStrategy } from './selection-strategy'\nimport { DiffLineGutter } from '../diff-line-gutter'\nimport { compare } from '../../../lib/compare'\nimport { range } from '../../../lib/range'\n\n/** apply a drag-and-drop change to the current diff */\nexport class DragDropSelection implements ISelectionStrategy {\n  private readonly start: number\n  private readonly desiredSelection: boolean\n  private readonly snapshot: DiffSelection\n\n  // the current row the cursor is hovering over\n  private current: number\n\n  // to track the gesture range so that we repaint over the\n  // entire range of elements while the gesture is in-flight\n  private maximumDirtyRange: number\n  private minimumDirtyRange: number\n\n  public constructor(\n    start: number,\n    desiredSelection: boolean,\n    snapshot: DiffSelection\n  ) {\n    this.start = start\n    this.desiredSelection = desiredSelection\n    this.snapshot = snapshot\n\n    this.current = start\n    this.maximumDirtyRange = start\n    this.minimumDirtyRange = start\n  }\n\n  /**\n   * Return the lower bounds of the selection range\n   */\n  private get lowerIndex(): number {\n    if (this.start <= this.current) {\n      return this.start\n    }\n\n    return this.current\n  }\n\n  /**\n   * Return the upper bounds of the selection range\n   */\n  private get upperIndex(): number {\n    if (this.start <= this.current) {\n      return this.current\n    }\n\n    return this.start\n  }\n\n  /**\n   * update the selection strategy with the row the user's cursor is over\n   */\n  public update(current: number) {\n    this.current = current\n\n    if (current > this.maximumDirtyRange) {\n      this.maximumDirtyRange = current\n    }\n\n    if (current < this.minimumDirtyRange) {\n      this.minimumDirtyRange = current\n    }\n  }\n\n  /**\n   * apply the selection strategy result to the current diff\n   */\n  public done(): DiffSelection {\n    const length = this.upperIndex - this.lowerIndex + 1\n\n    const newSelection = this.snapshot.withRangeSelection(\n      this.lowerIndex,\n      length,\n      this.desiredSelection\n    )\n\n    return newSelection\n  }\n\n  /**\n   * Compute the range of lines to repaint, based on how far the user\n   * has moved their cursor\n   */\n  private determineDirtyRange(\n    elements: Map<number, DiffLineGutter>\n  ): { start: number; end: number } {\n    // as user can go back and forth when doing drag-and-drop, we should\n    // update rows outside the current selected range\n\n    // keys are by default sorted by insertion order\n    // source: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map/keys\n    //\n    // this ensures we get the latest index that's drawn onscreen\n    const sortedKeys = Array.from(elements.keys()).sort(compare)\n    const lastKey = sortedKeys[sortedKeys.length - 1]\n    const maximum = lastKey\n\n    let start = this.lowerIndex\n    // ensure we repaint over previously touched rows before the start\n    if (this.minimumDirtyRange < start) {\n      start = this.minimumDirtyRange - 1\n    }\n\n    if (start < 1) {\n      start = 1 // 0 is always the diff context\n    }\n\n    let end = this.upperIndex + 1\n    // ensure we repaint over previously touched rows after the end\n    if (this.maximumDirtyRange > end) {\n      end = this.maximumDirtyRange + 1\n    }\n\n    // ensure that we stay within the range of rows painted\n    if (end > maximum) {\n      end = maximum\n    }\n\n    return { start, end }\n  }\n\n  /**\n   * repaint the current diff gutter to visualize the current state\n   */\n  public paint(elements: Map<number, DiffLineGutter>) {\n    const { start, end } = this.determineDirtyRange(elements)\n\n    // range is not inclusive of the last number, which means the edge of\n    // the diff may not be updated - that's why we're adding one here\n    range(start, end + 1).forEach(row => {\n      const element = elements.get(row)\n      if (!element) {\n        console.error('expected gutter element not found')\n        return\n      }\n\n      // don't select the line if it's part of the context\n      if (!element.props.line.isIncludeableLine()) {\n        return\n      }\n\n      const selected = this.getIsSelected(row)\n      element.setSelected(selected)\n    })\n  }\n\n  /**\n   * compute the selected state for a given row, based on the current gesture\n   * values inside the range pick up the desired value, and values\n   * outside the range revert to the initially selected state\n   */\n  private getIsSelected(index: number): boolean {\n    // if we're in the diff range, use the stored value\n    if (index >= this.lowerIndex && index <= this.upperIndex) {\n      return this.desiredSelection\n    }\n\n    // otherwise, just use whatever the old value was\n    return this.snapshot.isSelected(index)\n  }\n}\n","import { DiffSelection } from '../../../models/diff'\nimport { ISelectionStrategy } from './selection-strategy'\nimport { DiffLineGutter } from '../diff-line-gutter'\nimport { range } from '../../../lib/range'\n\n/** apply hunk selection to the current diff */\nexport class RangeSelection implements ISelectionStrategy {\n  private readonly _start: number\n  private readonly _end: number\n  private readonly _desiredSelection: boolean\n  private readonly _snapshot: DiffSelection\n\n  public constructor(\n    start: number,\n    end: number,\n    desiredSelection: boolean,\n    snapshot: DiffSelection\n  ) {\n    this._start = start\n    this._end = end\n    this._desiredSelection = desiredSelection\n    this._snapshot = snapshot\n  }\n\n  public update(index: number) {\n    // no-op\n  }\n\n  public paint(elements: Map<number, DiffLineGutter>) {\n    range(this._start, this._end + 1).forEach(row => {\n      const element = elements.get(row)\n\n      if (!element) {\n        // if the element has not been rendered, it's not visible to the user\n        return\n      }\n\n      if (!element.isIncluded()) {\n        return\n      }\n\n      element.setSelected(this._desiredSelection)\n    })\n  }\n\n  public done(): DiffSelection {\n    const length = this._end - this._start + 1\n\n    const newSelection = this._snapshot.withRangeSelection(\n      this._start,\n      length,\n      this._desiredSelection\n    )\n\n    return newSelection\n  }\n}\n","export const selectedLineClass = 'diff-line-selected'\nexport const hoverCssClass = 'diff-line-hover'\n","import * as React from 'react'\nimport { DiffHunk, DiffLine, DiffLineType } from '../../models/diff'\nimport { diffHunkForIndex, findInteractiveDiffRange } from './diff-explorer'\nimport { hoverCssClass, selectedLineClass } from './selection/selection'\nimport { assertNever } from '../../lib/fatal-error'\nimport * as classNames from 'classnames'\nimport { RangeSelectionSizePixels } from './edge-detection'\n\n/** The props for the diff gutter. */\ninterface IDiffGutterProps {\n  /** The line being represented by the gutter. */\n  readonly line: DiffLine\n\n  /**\n   * In the case of a non-readonly line, indicates whether the given line\n   * should be rendered as selected or not.\n   */\n  readonly isIncluded: boolean\n\n  /**\n   * The line number relative to the unified diff output\n   */\n  readonly index: number\n\n  /**\n   * Indicate whether the diff should handle user interactions\n   */\n  readonly readOnly: boolean\n\n  /**\n   * The diff currently displayed in the app\n   */\n  readonly hunks: ReadonlyArray<DiffHunk>\n\n  /**\n   * Callback to apply hover effect to specific lines in the diff\n   */\n  readonly updateRangeHoverState: (\n    start: number,\n    end: number,\n    active: boolean\n  ) => void\n\n  /**\n   * Callback to query whether a selection gesture is currently underway\n   *\n   * If this returns true, the element will attempt to update the hover state.\n   * Otherwise, this will defer to the active selection gesture to update\n   * the visual state of the gutter.\n   */\n  readonly isSelectionEnabled: () => boolean\n\n  /**\n   * Callback to signal when the mouse button is pressed on this element\n   */\n  readonly onMouseDown: (\n    index: number,\n    hunks: ReadonlyArray<DiffHunk>,\n    isRangeSelection: boolean\n  ) => void\n\n  /**\n   * Callback to signal when the mouse is hovering over this element\n   */\n  readonly onMouseMove: (index: number) => void\n}\n\ninterface IDiffGutterState {\n  /**\n   * Whether or not the diff line gutter should render as hovered,\n   * i.e. highlighted. This is used when moused over directly or\n   * when the hunk that this line is part of is hovered.\n   */\n  readonly hover: boolean\n\n  /**\n   * Whether or not the diff line gutter should render that it's\n   * selected, i.e. included for commit.\n   */\n  readonly selected: boolean\n}\n\n/**\n * Detect if mouse cursor is within the range\n */\nfunction isMouseCursorNearEdge(ev: MouseEvent): boolean {\n  // MouseEvent is not generic, but getBoundingClientRect should be\n  // available for all HTML elements\n  // docs: https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect\n\n  const element: any = ev.currentTarget\n  const offset: ClientRect = element.getBoundingClientRect()\n  const relativeLeft = ev.clientX - offset.left\n\n  const edge = offset.width - RangeSelectionSizePixels\n\n  return relativeLeft >= edge\n}\n\n/** The gutter for a diff's line. */\nexport class DiffLineGutter extends React.Component<\n  IDiffGutterProps,\n  IDiffGutterState\n> {\n  private elem_?: HTMLSpanElement\n\n  public constructor(props: IDiffGutterProps) {\n    super(props)\n\n    this.state = {\n      hover: false,\n      selected: this.props.isIncluded,\n    }\n  }\n\n  /**\n   * Compute the width for the current element\n   */\n  public getWidth(): number | null {\n    if (this.elem_) {\n      return this.elem_.clientWidth\n    }\n    return null\n  }\n\n  /**\n   * Indicate whether the current gutter element is selected\n   */\n  public isIncluded(): boolean {\n    return this.props.line.isIncludeableLine() && this.state.selected\n  }\n\n  /**\n   * Set (or unset) the hover styling of the diff gutter\n   */\n  public setHover(hover: boolean) {\n    // only show the hover effect if the line isn't context\n    if (!this.props.line.isIncludeableLine()) {\n      return\n    }\n\n    this.setState({ hover })\n  }\n\n  /**\n   * Set (or unset) the selected styling of the diff gutter\n   */\n  public setSelected(selected: boolean) {\n    this.setState({ selected })\n  }\n\n  private getLineClassName(): string {\n    const type = this.props.line.type\n    switch (type) {\n      case DiffLineType.Add:\n        return 'diff-add'\n      case DiffLineType.Delete:\n        return 'diff-delete'\n      case DiffLineType.Context:\n        return 'diff-context'\n      case DiffLineType.Hunk:\n        return 'diff-hunk'\n    }\n\n    return assertNever(type, `Unknown DiffLineType ${type}`)\n  }\n\n  private getLineClass(): string {\n    const lineClass = this.getLineClassName()\n    const selectedClass = this.isIncluded() ? selectedLineClass : null\n    const hoverClass = this.state.hover ? hoverCssClass : null\n\n    return classNames(\n      'diff-line-gutter',\n      lineClass,\n      selectedClass,\n      hoverClass,\n      {\n        'read-only': this.props.readOnly,\n      }\n    )\n  }\n\n  private updateHoverState(isRangeSelection: boolean, isActive: boolean) {\n    if (isRangeSelection) {\n      const range = findInteractiveDiffRange(this.props.hunks, this.props.index)\n      if (!range) {\n        console.error('unable to find range for given index in diff')\n        return\n      }\n      this.props.updateRangeHoverState(range.start, range.end, isActive)\n    } else {\n      this.setHover(isActive)\n    }\n  }\n\n  private mouseEnterHandler = (ev: MouseEvent) => {\n    ev.preventDefault()\n\n    const isRangeSelection = isMouseCursorNearEdge(ev)\n    this.updateHoverState(isRangeSelection, true)\n  }\n\n  private mouseLeaveHandler = (ev: MouseEvent) => {\n    ev.preventDefault()\n    const isRangeSelection = isMouseCursorNearEdge(ev)\n    this.updateHoverState(isRangeSelection, false)\n  }\n\n  private mouseMoveHandler = (ev: MouseEvent) => {\n    ev.preventDefault()\n\n    const hunk = diffHunkForIndex(this.props.hunks, this.props.index)\n    if (!hunk) {\n      console.error('unable to find hunk for given line in diff')\n      return\n    }\n\n    const isRangeSelection = isMouseCursorNearEdge(ev)\n    const isSelectionActive = this.props.isSelectionEnabled()\n\n    const range = findInteractiveDiffRange(this.props.hunks, this.props.index)\n    if (!range) {\n      console.error('unable to find range for given index in diff')\n      return\n    }\n\n    // selection is not active, perform highlighting based on mouse position\n    if (isRangeSelection && range && isSelectionActive) {\n      this.props.updateRangeHoverState(range.start, range.end, true)\n    } else {\n      // clear range selection in case range was previously higlighted\n      this.props.updateRangeHoverState(range.start, range.end, false)\n\n      this.setHover(true)\n    }\n\n    this.props.onMouseMove(this.props.index)\n  }\n\n  private mouseDownHandler = (ev: MouseEvent) => {\n    ev.preventDefault()\n    const isRangeSelection = isMouseCursorNearEdge(ev)\n    this.props.onMouseDown(this.props.index, this.props.hunks, isRangeSelection)\n  }\n\n  private applyEventHandlers = (elem: HTMLSpanElement | null) => {\n    // set this so we can compute the width of the diff gutter\n    // whether it is an editable line or not\n    if (elem) {\n      this.elem_ = elem\n    }\n\n    // read-only diffs do not support any interactivity\n    if (this.props.readOnly) {\n      return\n    }\n\n    // no point handling mouse events on context lines\n    if (elem && this.props.line.isIncludeableLine()) {\n      elem.addEventListener('mouseenter', this.mouseEnterHandler)\n      elem.addEventListener('mouseleave', this.mouseLeaveHandler)\n      elem.addEventListener('mousemove', this.mouseMoveHandler)\n      elem.addEventListener('mousedown', this.mouseDownHandler)\n    } else {\n      // this callback fires a second time when the DOM element\n      // is unmounted, so we can use this as a chance to cleanup.\n      // We unsubscribe without checking for isIncludeableLine since\n      // that might have changed underneath us\n      if (this.elem_) {\n        this.elem_.removeEventListener('mouseenter', this.mouseEnterHandler)\n        this.elem_.removeEventListener('mouseleave', this.mouseLeaveHandler)\n        this.elem_.removeEventListener('mousemove', this.mouseMoveHandler)\n        this.elem_.removeEventListener('mousedown', this.mouseDownHandler)\n      }\n\n      this.elem_ = undefined\n    }\n  }\n\n  public render() {\n    const role =\n      !this.props.readOnly && this.props.line.isIncludeableLine()\n        ? 'button'\n        : undefined\n\n    return (\n      <span\n        className={this.getLineClass()}\n        ref={this.applyEventHandlers}\n        role={role}\n      >\n        <span className=\"diff-line-number before\">\n          {this.props.line.oldLineNumber || ' '}\n        </span>\n        <span className=\"diff-line-number after\">\n          {this.props.line.newLineNumber || ' '}\n        </span>\n      </span>\n    )\n  }\n}\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  function Bar(cls, orientation, scroll) {\n    this.orientation = orientation;\n    this.scroll = scroll;\n    this.screen = this.total = this.size = 1;\n    this.pos = 0;\n\n    this.node = document.createElement(\"div\");\n    this.node.className = cls + \"-\" + orientation;\n    this.inner = this.node.appendChild(document.createElement(\"div\"));\n\n    var self = this;\n    CodeMirror.on(this.inner, \"mousedown\", function(e) {\n      if (e.which != 1) return;\n      CodeMirror.e_preventDefault(e);\n      var axis = self.orientation == \"horizontal\" ? \"pageX\" : \"pageY\";\n      var start = e[axis], startpos = self.pos;\n      function done() {\n        CodeMirror.off(document, \"mousemove\", move);\n        CodeMirror.off(document, \"mouseup\", done);\n      }\n      function move(e) {\n        if (e.which != 1) return done();\n        self.moveTo(startpos + (e[axis] - start) * (self.total / self.size));\n      }\n      CodeMirror.on(document, \"mousemove\", move);\n      CodeMirror.on(document, \"mouseup\", done);\n    });\n\n    CodeMirror.on(this.node, \"click\", function(e) {\n      CodeMirror.e_preventDefault(e);\n      var innerBox = self.inner.getBoundingClientRect(), where;\n      if (self.orientation == \"horizontal\")\n        where = e.clientX < innerBox.left ? -1 : e.clientX > innerBox.right ? 1 : 0;\n      else\n        where = e.clientY < innerBox.top ? -1 : e.clientY > innerBox.bottom ? 1 : 0;\n      self.moveTo(self.pos + where * self.screen);\n    });\n\n    function onWheel(e) {\n      var moved = CodeMirror.wheelEventPixels(e)[self.orientation == \"horizontal\" ? \"x\" : \"y\"];\n      var oldPos = self.pos;\n      self.moveTo(self.pos + moved);\n      if (self.pos != oldPos) CodeMirror.e_preventDefault(e);\n    }\n    CodeMirror.on(this.node, \"mousewheel\", onWheel);\n    CodeMirror.on(this.node, \"DOMMouseScroll\", onWheel);\n  }\n\n  Bar.prototype.setPos = function(pos, force) {\n    if (pos < 0) pos = 0;\n    if (pos > this.total - this.screen) pos = this.total - this.screen;\n    if (!force && pos == this.pos) return false;\n    this.pos = pos;\n    this.inner.style[this.orientation == \"horizontal\" ? \"left\" : \"top\"] =\n      (pos * (this.size / this.total)) + \"px\";\n    return true\n  };\n\n  Bar.prototype.moveTo = function(pos) {\n    if (this.setPos(pos)) this.scroll(pos, this.orientation);\n  }\n\n  var minButtonSize = 10;\n\n  Bar.prototype.update = function(scrollSize, clientSize, barSize) {\n    var sizeChanged = this.screen != clientSize || this.total != scrollSize || this.size != barSize\n    if (sizeChanged) {\n      this.screen = clientSize;\n      this.total = scrollSize;\n      this.size = barSize;\n    }\n\n    var buttonSize = this.screen * (this.size / this.total);\n    if (buttonSize < minButtonSize) {\n      this.size -= minButtonSize - buttonSize;\n      buttonSize = minButtonSize;\n    }\n    this.inner.style[this.orientation == \"horizontal\" ? \"width\" : \"height\"] =\n      buttonSize + \"px\";\n    this.setPos(this.pos, sizeChanged);\n  };\n\n  function SimpleScrollbars(cls, place, scroll) {\n    this.addClass = cls;\n    this.horiz = new Bar(cls, \"horizontal\", scroll);\n    place(this.horiz.node);\n    this.vert = new Bar(cls, \"vertical\", scroll);\n    place(this.vert.node);\n    this.width = null;\n  }\n\n  SimpleScrollbars.prototype.update = function(measure) {\n    if (this.width == null) {\n      var style = window.getComputedStyle ? window.getComputedStyle(this.horiz.node) : this.horiz.node.currentStyle;\n      if (style) this.width = parseInt(style.height);\n    }\n    var width = this.width || 0;\n\n    var needsH = measure.scrollWidth > measure.clientWidth + 1;\n    var needsV = measure.scrollHeight > measure.clientHeight + 1;\n    this.vert.node.style.display = needsV ? \"block\" : \"none\";\n    this.horiz.node.style.display = needsH ? \"block\" : \"none\";\n\n    if (needsV) {\n      this.vert.update(measure.scrollHeight, measure.clientHeight,\n                       measure.viewHeight - (needsH ? width : 0));\n      this.vert.node.style.bottom = needsH ? width + \"px\" : \"0\";\n    }\n    if (needsH) {\n      this.horiz.update(measure.scrollWidth, measure.clientWidth,\n                        measure.viewWidth - (needsV ? width : 0) - measure.barLeft);\n      this.horiz.node.style.right = needsV ? width + \"px\" : \"0\";\n      this.horiz.node.style.left = measure.barLeft + \"px\";\n    }\n\n    return {right: needsV ? width : 0, bottom: needsH ? width : 0};\n  };\n\n  SimpleScrollbars.prototype.setScrollTop = function(pos) {\n    this.vert.setPos(pos);\n  };\n\n  SimpleScrollbars.prototype.setScrollLeft = function(pos) {\n    this.horiz.setPos(pos);\n  };\n\n  SimpleScrollbars.prototype.clear = function() {\n    var parent = this.horiz.node.parentNode;\n    parent.removeChild(this.horiz.node);\n    parent.removeChild(this.vert.node);\n  };\n\n  CodeMirror.scrollbarModel.simple = function(place, scroll) {\n    return new SimpleScrollbars(\"CodeMirror-simplescroll\", place, scroll);\n  };\n  CodeMirror.scrollbarModel.overlay = function(place, scroll) {\n    return new SimpleScrollbars(\"CodeMirror-overlayscroll\", place, scroll);\n  };\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  var HINT_ELEMENT_CLASS        = \"CodeMirror-hint\";\n  var ACTIVE_HINT_ELEMENT_CLASS = \"CodeMirror-hint-active\";\n\n  // This is the old interface, kept around for now to stay\n  // backwards-compatible.\n  CodeMirror.showHint = function(cm, getHints, options) {\n    if (!getHints) return cm.showHint(options);\n    if (options && options.async) getHints.async = true;\n    var newOpts = {hint: getHints};\n    if (options) for (var prop in options) newOpts[prop] = options[prop];\n    return cm.showHint(newOpts);\n  };\n\n  CodeMirror.defineExtension(\"showHint\", function(options) {\n    options = parseOptions(this, this.getCursor(\"start\"), options);\n    var selections = this.listSelections()\n    if (selections.length > 1) return;\n    // By default, don't allow completion when something is selected.\n    // A hint function can have a `supportsSelection` property to\n    // indicate that it can handle selections.\n    if (this.somethingSelected()) {\n      if (!options.hint.supportsSelection) return;\n      // Don't try with cross-line selections\n      for (var i = 0; i < selections.length; i++)\n        if (selections[i].head.line != selections[i].anchor.line) return;\n    }\n\n    if (this.state.completionActive) this.state.completionActive.close();\n    var completion = this.state.completionActive = new Completion(this, options);\n    if (!completion.options.hint) return;\n\n    CodeMirror.signal(this, \"startCompletion\", this);\n    completion.update(true);\n  });\n\n  function Completion(cm, options) {\n    this.cm = cm;\n    this.options = options;\n    this.widget = null;\n    this.debounce = 0;\n    this.tick = 0;\n    this.startPos = this.cm.getCursor(\"start\");\n    this.startLen = this.cm.getLine(this.startPos.line).length - this.cm.getSelection().length;\n\n    var self = this;\n    cm.on(\"cursorActivity\", this.activityFunc = function() { self.cursorActivity(); });\n  }\n\n  var requestAnimationFrame = window.requestAnimationFrame || function(fn) {\n    return setTimeout(fn, 1000/60);\n  };\n  var cancelAnimationFrame = window.cancelAnimationFrame || clearTimeout;\n\n  Completion.prototype = {\n    close: function() {\n      if (!this.active()) return;\n      this.cm.state.completionActive = null;\n      this.tick = null;\n      this.cm.off(\"cursorActivity\", this.activityFunc);\n\n      if (this.widget && this.data) CodeMirror.signal(this.data, \"close\");\n      if (this.widget) this.widget.close();\n      CodeMirror.signal(this.cm, \"endCompletion\", this.cm);\n    },\n\n    active: function() {\n      return this.cm.state.completionActive == this;\n    },\n\n    pick: function(data, i) {\n      var completion = data.list[i];\n      if (completion.hint) completion.hint(this.cm, data, completion);\n      else this.cm.replaceRange(getText(completion), completion.from || data.from,\n                                completion.to || data.to, \"complete\");\n      CodeMirror.signal(data, \"pick\", completion);\n      this.close();\n    },\n\n    cursorActivity: function() {\n      if (this.debounce) {\n        cancelAnimationFrame(this.debounce);\n        this.debounce = 0;\n      }\n\n      var pos = this.cm.getCursor(), line = this.cm.getLine(pos.line);\n      if (pos.line != this.startPos.line || line.length - pos.ch != this.startLen - this.startPos.ch ||\n          pos.ch < this.startPos.ch || this.cm.somethingSelected() ||\n          (pos.ch && this.options.closeCharacters.test(line.charAt(pos.ch - 1)))) {\n        this.close();\n      } else {\n        var self = this;\n        this.debounce = requestAnimationFrame(function() {self.update();});\n        if (this.widget) this.widget.disable();\n      }\n    },\n\n    update: function(first) {\n      if (this.tick == null) return\n      var self = this, myTick = ++this.tick\n      fetchHints(this.options.hint, this.cm, this.options, function(data) {\n        if (self.tick == myTick) self.finishUpdate(data, first)\n      })\n    },\n\n    finishUpdate: function(data, first) {\n      if (this.data) CodeMirror.signal(this.data, \"update\");\n\n      var picked = (this.widget && this.widget.picked) || (first && this.options.completeSingle);\n      if (this.widget) this.widget.close();\n\n      this.data = data;\n\n      if (data && data.list.length) {\n        if (picked && data.list.length == 1) {\n          this.pick(data, 0);\n        } else {\n          this.widget = new Widget(this, data);\n          CodeMirror.signal(data, \"shown\");\n        }\n      }\n    }\n  };\n\n  function parseOptions(cm, pos, options) {\n    var editor = cm.options.hintOptions;\n    var out = {};\n    for (var prop in defaultOptions) out[prop] = defaultOptions[prop];\n    if (editor) for (var prop in editor)\n      if (editor[prop] !== undefined) out[prop] = editor[prop];\n    if (options) for (var prop in options)\n      if (options[prop] !== undefined) out[prop] = options[prop];\n    if (out.hint.resolve) out.hint = out.hint.resolve(cm, pos)\n    return out;\n  }\n\n  function getText(completion) {\n    if (typeof completion == \"string\") return completion;\n    else return completion.text;\n  }\n\n  function buildKeyMap(completion, handle) {\n    var baseMap = {\n      Up: function() {handle.moveFocus(-1);},\n      Down: function() {handle.moveFocus(1);},\n      PageUp: function() {handle.moveFocus(-handle.menuSize() + 1, true);},\n      PageDown: function() {handle.moveFocus(handle.menuSize() - 1, true);},\n      Home: function() {handle.setFocus(0);},\n      End: function() {handle.setFocus(handle.length - 1);},\n      Enter: handle.pick,\n      Tab: handle.pick,\n      Esc: handle.close\n    };\n    var custom = completion.options.customKeys;\n    var ourMap = custom ? {} : baseMap;\n    function addBinding(key, val) {\n      var bound;\n      if (typeof val != \"string\")\n        bound = function(cm) { return val(cm, handle); };\n      // This mechanism is deprecated\n      else if (baseMap.hasOwnProperty(val))\n        bound = baseMap[val];\n      else\n        bound = val;\n      ourMap[key] = bound;\n    }\n    if (custom)\n      for (var key in custom) if (custom.hasOwnProperty(key))\n        addBinding(key, custom[key]);\n    var extra = completion.options.extraKeys;\n    if (extra)\n      for (var key in extra) if (extra.hasOwnProperty(key))\n        addBinding(key, extra[key]);\n    return ourMap;\n  }\n\n  function getHintElement(hintsElement, el) {\n    while (el && el != hintsElement) {\n      if (el.nodeName.toUpperCase() === \"LI\" && el.parentNode == hintsElement) return el;\n      el = el.parentNode;\n    }\n  }\n\n  function Widget(completion, data) {\n    this.completion = completion;\n    this.data = data;\n    this.picked = false;\n    var widget = this, cm = completion.cm;\n\n    var hints = this.hints = document.createElement(\"ul\");\n    hints.className = \"CodeMirror-hints\";\n    this.selectedHint = data.selectedHint || 0;\n\n    var completions = data.list;\n    for (var i = 0; i < completions.length; ++i) {\n      var elt = hints.appendChild(document.createElement(\"li\")), cur = completions[i];\n      var className = HINT_ELEMENT_CLASS + (i != this.selectedHint ? \"\" : \" \" + ACTIVE_HINT_ELEMENT_CLASS);\n      if (cur.className != null) className = cur.className + \" \" + className;\n      elt.className = className;\n      if (cur.render) cur.render(elt, data, cur);\n      else elt.appendChild(document.createTextNode(cur.displayText || getText(cur)));\n      elt.hintId = i;\n    }\n\n    var pos = cm.cursorCoords(completion.options.alignWithWord ? data.from : null);\n    var left = pos.left, top = pos.bottom, below = true;\n    hints.style.left = left + \"px\";\n    hints.style.top = top + \"px\";\n    // If we're at the edge of the screen, then we want the menu to appear on the left of the cursor.\n    var winW = window.innerWidth || Math.max(document.body.offsetWidth, document.documentElement.offsetWidth);\n    var winH = window.innerHeight || Math.max(document.body.offsetHeight, document.documentElement.offsetHeight);\n    (completion.options.container || document.body).appendChild(hints);\n    var box = hints.getBoundingClientRect(), overlapY = box.bottom - winH;\n    var scrolls = hints.scrollHeight > hints.clientHeight + 1\n    var startScroll = cm.getScrollInfo();\n\n    if (overlapY > 0) {\n      var height = box.bottom - box.top, curTop = pos.top - (pos.bottom - box.top);\n      if (curTop - height > 0) { // Fits above cursor\n        hints.style.top = (top = pos.top - height) + \"px\";\n        below = false;\n      } else if (height > winH) {\n        hints.style.height = (winH - 5) + \"px\";\n        hints.style.top = (top = pos.bottom - box.top) + \"px\";\n        var cursor = cm.getCursor();\n        if (data.from.ch != cursor.ch) {\n          pos = cm.cursorCoords(cursor);\n          hints.style.left = (left = pos.left) + \"px\";\n          box = hints.getBoundingClientRect();\n        }\n      }\n    }\n    var overlapX = box.right - winW;\n    if (overlapX > 0) {\n      if (box.right - box.left > winW) {\n        hints.style.width = (winW - 5) + \"px\";\n        overlapX -= (box.right - box.left) - winW;\n      }\n      hints.style.left = (left = pos.left - overlapX) + \"px\";\n    }\n    if (scrolls) for (var node = hints.firstChild; node; node = node.nextSibling)\n      node.style.paddingRight = cm.display.nativeBarWidth + \"px\"\n\n    cm.addKeyMap(this.keyMap = buildKeyMap(completion, {\n      moveFocus: function(n, avoidWrap) { widget.changeActive(widget.selectedHint + n, avoidWrap); },\n      setFocus: function(n) { widget.changeActive(n); },\n      menuSize: function() { return widget.screenAmount(); },\n      length: completions.length,\n      close: function() { completion.close(); },\n      pick: function() { widget.pick(); },\n      data: data\n    }));\n\n    if (completion.options.closeOnUnfocus) {\n      var closingOnBlur;\n      cm.on(\"blur\", this.onBlur = function() { closingOnBlur = setTimeout(function() { completion.close(); }, 100); });\n      cm.on(\"focus\", this.onFocus = function() { clearTimeout(closingOnBlur); });\n    }\n\n    cm.on(\"scroll\", this.onScroll = function() {\n      var curScroll = cm.getScrollInfo(), editor = cm.getWrapperElement().getBoundingClientRect();\n      var newTop = top + startScroll.top - curScroll.top;\n      var point = newTop - (window.pageYOffset || (document.documentElement || document.body).scrollTop);\n      if (!below) point += hints.offsetHeight;\n      if (point <= editor.top || point >= editor.bottom) return completion.close();\n      hints.style.top = newTop + \"px\";\n      hints.style.left = (left + startScroll.left - curScroll.left) + \"px\";\n    });\n\n    CodeMirror.on(hints, \"dblclick\", function(e) {\n      var t = getHintElement(hints, e.target || e.srcElement);\n      if (t && t.hintId != null) {widget.changeActive(t.hintId); widget.pick();}\n    });\n\n    CodeMirror.on(hints, \"click\", function(e) {\n      var t = getHintElement(hints, e.target || e.srcElement);\n      if (t && t.hintId != null) {\n        widget.changeActive(t.hintId);\n        if (completion.options.completeOnSingleClick) widget.pick();\n      }\n    });\n\n    CodeMirror.on(hints, \"mousedown\", function() {\n      setTimeout(function(){cm.focus();}, 20);\n    });\n\n    CodeMirror.signal(data, \"select\", completions[this.selectedHint], hints.childNodes[this.selectedHint]);\n    return true;\n  }\n\n  Widget.prototype = {\n    close: function() {\n      if (this.completion.widget != this) return;\n      this.completion.widget = null;\n      this.hints.parentNode.removeChild(this.hints);\n      this.completion.cm.removeKeyMap(this.keyMap);\n\n      var cm = this.completion.cm;\n      if (this.completion.options.closeOnUnfocus) {\n        cm.off(\"blur\", this.onBlur);\n        cm.off(\"focus\", this.onFocus);\n      }\n      cm.off(\"scroll\", this.onScroll);\n    },\n\n    disable: function() {\n      this.completion.cm.removeKeyMap(this.keyMap);\n      var widget = this;\n      this.keyMap = {Enter: function() { widget.picked = true; }};\n      this.completion.cm.addKeyMap(this.keyMap);\n    },\n\n    pick: function() {\n      this.completion.pick(this.data, this.selectedHint);\n    },\n\n    changeActive: function(i, avoidWrap) {\n      if (i >= this.data.list.length)\n        i = avoidWrap ? this.data.list.length - 1 : 0;\n      else if (i < 0)\n        i = avoidWrap ? 0  : this.data.list.length - 1;\n      if (this.selectedHint == i) return;\n      var node = this.hints.childNodes[this.selectedHint];\n      node.className = node.className.replace(\" \" + ACTIVE_HINT_ELEMENT_CLASS, \"\");\n      node = this.hints.childNodes[this.selectedHint = i];\n      node.className += \" \" + ACTIVE_HINT_ELEMENT_CLASS;\n      if (node.offsetTop < this.hints.scrollTop)\n        this.hints.scrollTop = node.offsetTop - 3;\n      else if (node.offsetTop + node.offsetHeight > this.hints.scrollTop + this.hints.clientHeight)\n        this.hints.scrollTop = node.offsetTop + node.offsetHeight - this.hints.clientHeight + 3;\n      CodeMirror.signal(this.data, \"select\", this.data.list[this.selectedHint], node);\n    },\n\n    screenAmount: function() {\n      return Math.floor(this.hints.clientHeight / this.hints.firstChild.offsetHeight) || 1;\n    }\n  };\n\n  function applicableHelpers(cm, helpers) {\n    if (!cm.somethingSelected()) return helpers\n    var result = []\n    for (var i = 0; i < helpers.length; i++)\n      if (helpers[i].supportsSelection) result.push(helpers[i])\n    return result\n  }\n\n  function fetchHints(hint, cm, options, callback) {\n    if (hint.async) {\n      hint(cm, callback, options)\n    } else {\n      var result = hint(cm, options)\n      if (result && result.then) result.then(callback)\n      else callback(result)\n    }\n  }\n\n  function resolveAutoHints(cm, pos) {\n    var helpers = cm.getHelpers(pos, \"hint\"), words\n    if (helpers.length) {\n      var resolved = function(cm, callback, options) {\n        var app = applicableHelpers(cm, helpers);\n        function run(i) {\n          if (i == app.length) return callback(null)\n          fetchHints(app[i], cm, options, function(result) {\n            if (result && result.list.length > 0) callback(result)\n            else run(i + 1)\n          })\n        }\n        run(0)\n      }\n      resolved.async = true\n      resolved.supportsSelection = true\n      return resolved\n    } else if (words = cm.getHelper(cm.getCursor(), \"hintWords\")) {\n      return function(cm) { return CodeMirror.hint.fromList(cm, {words: words}) }\n    } else if (CodeMirror.hint.anyword) {\n      return function(cm, options) { return CodeMirror.hint.anyword(cm, options) }\n    } else {\n      return function() {}\n    }\n  }\n\n  CodeMirror.registerHelper(\"hint\", \"auto\", {\n    resolve: resolveAutoHints\n  });\n\n  CodeMirror.registerHelper(\"hint\", \"fromList\", function(cm, options) {\n    var cur = cm.getCursor(), token = cm.getTokenAt(cur);\n    var to = CodeMirror.Pos(cur.line, token.end);\n    if (token.string && /\\w/.test(token.string[token.string.length - 1])) {\n      var term = token.string, from = CodeMirror.Pos(cur.line, token.start);\n    } else {\n      var term = \"\", from = to;\n    }\n    var found = [];\n    for (var i = 0; i < options.words.length; i++) {\n      var word = options.words[i];\n      if (word.slice(0, term.length) == term)\n        found.push(word);\n    }\n\n    if (found.length) return {list: found, from: from, to: to};\n  });\n\n  CodeMirror.commands.autocomplete = CodeMirror.showHint;\n\n  var defaultOptions = {\n    hint: CodeMirror.hint.auto,\n    completeSingle: true,\n    alignWithWord: true,\n    closeCharacters: /[\\s()\\[\\]{};:>,]/,\n    closeOnUnfocus: true,\n    completeOnSingleClick: true,\n    container: null,\n    customKeys: null,\n    extraKeys: null\n  };\n\n  CodeMirror.defineOption(\"hintOptions\", null);\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n// Because sometimes you need to mark the selected *text*.\n//\n// Adds an option 'styleSelectedText' which, when enabled, gives\n// selected text the CSS class given as option value, or\n// \"CodeMirror-selectedtext\" when the value is not a string.\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  CodeMirror.defineOption(\"styleSelectedText\", false, function(cm, val, old) {\n    var prev = old && old != CodeMirror.Init;\n    if (val && !prev) {\n      cm.state.markedSelection = [];\n      cm.state.markedSelectionStyle = typeof val == \"string\" ? val : \"CodeMirror-selectedtext\";\n      reset(cm);\n      cm.on(\"cursorActivity\", onCursorActivity);\n      cm.on(\"change\", onChange);\n    } else if (!val && prev) {\n      cm.off(\"cursorActivity\", onCursorActivity);\n      cm.off(\"change\", onChange);\n      clear(cm);\n      cm.state.markedSelection = cm.state.markedSelectionStyle = null;\n    }\n  });\n\n  function onCursorActivity(cm) {\n    if (cm.state.markedSelection)\n      cm.operation(function() { update(cm); });\n  }\n\n  function onChange(cm) {\n    if (cm.state.markedSelection && cm.state.markedSelection.length)\n      cm.operation(function() { clear(cm); });\n  }\n\n  var CHUNK_SIZE = 8;\n  var Pos = CodeMirror.Pos;\n  var cmp = CodeMirror.cmpPos;\n\n  function coverRange(cm, from, to, addAt) {\n    if (cmp(from, to) == 0) return;\n    var array = cm.state.markedSelection;\n    var cls = cm.state.markedSelectionStyle;\n    for (var line = from.line;;) {\n      var start = line == from.line ? from : Pos(line, 0);\n      var endLine = line + CHUNK_SIZE, atEnd = endLine >= to.line;\n      var end = atEnd ? to : Pos(endLine, 0);\n      var mark = cm.markText(start, end, {className: cls});\n      if (addAt == null) array.push(mark);\n      else array.splice(addAt++, 0, mark);\n      if (atEnd) break;\n      line = endLine;\n    }\n  }\n\n  function clear(cm) {\n    var array = cm.state.markedSelection;\n    for (var i = 0; i < array.length; ++i) array[i].clear();\n    array.length = 0;\n  }\n\n  function reset(cm) {\n    clear(cm);\n    var ranges = cm.listSelections();\n    for (var i = 0; i < ranges.length; i++)\n      coverRange(cm, ranges[i].from(), ranges[i].to());\n  }\n\n  function update(cm) {\n    if (!cm.somethingSelected()) return clear(cm);\n    if (cm.listSelections().length > 1) return reset(cm);\n\n    var from = cm.getCursor(\"start\"), to = cm.getCursor(\"end\");\n\n    var array = cm.state.markedSelection;\n    if (!array.length) return coverRange(cm, from, to);\n\n    var coverStart = array[0].find(), coverEnd = array[array.length - 1].find();\n    if (!coverStart || !coverEnd || to.line - from.line <= CHUNK_SIZE ||\n        cmp(from, coverEnd.to) >= 0 || cmp(to, coverStart.from) <= 0)\n      return reset(cm);\n\n    while (cmp(from, coverStart.from) > 0) {\n      array.shift().clear();\n      coverStart = array[0].find();\n    }\n    if (cmp(from, coverStart.from) < 0) {\n      if (coverStart.to.line - from.line < CHUNK_SIZE) {\n        array.shift().clear();\n        coverRange(cm, from, coverStart.to, 0);\n      } else {\n        coverRange(cm, from, coverStart.from, 0);\n      }\n    }\n\n    while (cmp(to, coverEnd.to) < 0) {\n      array.pop().clear();\n      coverEnd = array[array.length - 1].find();\n    }\n    if (cmp(to, coverEnd.to) > 0) {\n      if (to.line - coverEnd.from.line < CHUNK_SIZE) {\n        array.pop().clear();\n        coverRange(cm, coverEnd.from, to);\n      } else {\n        coverRange(cm, coverEnd.to, to);\n      }\n    }\n  }\n});\n","import * as React from 'react'\nimport * as CodeMirror from 'codemirror'\n\n// Required for us to be able to customize the foreground color of selected text\nimport 'codemirror/addon/selection/mark-selection'\n\n// Autocompletion plugin\nimport 'codemirror/addon/hint/show-hint'\n\nif (__DARWIN__) {\n  // This has to be required to support the `simple` scrollbar style.\n  require('codemirror/addon/scroll/simplescrollbars')\n}\n\ninterface ICodeMirrorHostProps {\n  /**\n   * An optional class name for the wrapper element around the\n   * CodeMirror component\n   */\n  readonly className?: string\n\n  /** The text contents for the editor */\n  readonly value: string\n\n  /** Any CodeMirror specific settings */\n  readonly options?: CodeMirror.EditorConfiguration\n\n  /** Callback for diff to control whether selection is enabled */\n  readonly isSelectionEnabled?: () => boolean\n\n  /** Callback for when CodeMirror renders (or re-renders) a line */\n  readonly onRenderLine?: (\n    cm: CodeMirror.Editor,\n    line: CodeMirror.LineHandle,\n    element: HTMLElement\n  ) => void\n\n  /** Callback for when CodeMirror has completed a batch of changes to the editor */\n  readonly onChanges?: (\n    cm: CodeMirror.Editor,\n    change: CodeMirror.EditorChangeLinkedList[]\n  ) => void\n\n  /**\n   * Called when content has been copied. The default behavior may be prevented\n   * by calling `preventDefault` on the event.\n   */\n  readonly onCopy?: (editor: CodeMirror.Editor, event: Event) => void\n}\n\n/**\n * A component hosting a CodeMirror instance\n */\nexport class CodeMirrorHost extends React.Component<ICodeMirrorHostProps, {}> {\n  private wrapper: HTMLDivElement | null = null\n  private codeMirror: CodeMirror.Editor | null = null\n\n  /**\n   * Gets the internal CodeMirror instance or null if CodeMirror hasn't\n   * been initialized yet (happens when component mounts)\n   */\n  public getEditor(): CodeMirror.Editor | null {\n    return this.codeMirror\n  }\n\n  public componentDidMount() {\n    this.codeMirror = CodeMirror(this.wrapper!, this.props.options)\n\n    this.codeMirror.on('renderLine', this.onRenderLine)\n    this.codeMirror.on('changes', this.onChanges)\n    this.codeMirror.on('beforeSelectionChange', this.beforeSelectionChanged)\n\n    // The type declaration for this is wrong.\n    // See https://github.com/DefinitelyTyped/DefinitelyTyped/pull/18824.\n    this.codeMirror.on('copy', this.onCopy as any)\n\n    this.codeMirror.setValue(this.props.value)\n  }\n\n  private onCopy = (instance: CodeMirror.Editor, event: Event) => {\n    if (this.props.onCopy) {\n      this.props.onCopy(instance, event)\n    }\n  }\n\n  public componentWillUnmount() {\n    const cm = this.codeMirror\n\n    if (cm) {\n      cm.off('changes', this.onChanges)\n      cm.off('renderLine', this.onRenderLine)\n      cm.off('beforeSelectionChange', this.beforeSelectionChanged)\n      cm.off('copy', this.onCopy as any)\n\n      this.codeMirror = null\n    }\n  }\n\n  public componentWillReceiveProps(nextProps: ICodeMirrorHostProps) {\n    if (this.props.value !== nextProps.value) {\n      this.codeMirror!.setValue(nextProps.value)\n    }\n  }\n\n  public shouldComponentUpdate(nextProps: ICodeMirrorHostProps) {\n    // NB This is the only time we actually have to re-render.\n    // Updating of values is done in componentWillReceiveProps,\n    // all event handlers are marshalled through private non-changing\n    // wrappers.\n    return nextProps.className !== this.props.className\n  }\n\n  private beforeSelectionChanged = (cm: CodeMirror.Editor, changeObj: any) => {\n    if (this.props.isSelectionEnabled) {\n      if (!this.props.isSelectionEnabled()) {\n        // ignore whatever the user has currently selected, pass in a\n        // \"nothing selected\" value\n        // NOTE:\n        // - `head` is the part of the selection that is moving\n        // - `anchor` is the other end\n        changeObj.update([\n          { head: { line: 0, ch: 0 }, anchor: { line: 0, ch: 0 } },\n        ])\n      }\n    }\n  }\n\n  private onChanges = (\n    cm: CodeMirror.Editor,\n    changes: CodeMirror.EditorChangeLinkedList[]\n  ) => {\n    if (this.props.onChanges) {\n      this.props.onChanges(cm, changes)\n    }\n  }\n\n  private onRenderLine = (\n    cm: CodeMirror.Editor,\n    line: CodeMirror.LineHandle,\n    element: HTMLElement\n  ) => {\n    if (this.props.onRenderLine) {\n      this.props.onRenderLine(cm, line, element)\n    }\n  }\n\n  private onRef = (ref: HTMLDivElement | null) => {\n    this.wrapper = ref\n  }\n\n  public render() {\n    return <div className={this.props.className} ref={this.onRef} />\n  }\n}\n","import * as React from 'react'\nimport * as ReactDOM from 'react-dom'\nimport { clipboard } from 'electron'\nimport { Editor } from 'codemirror'\nimport { Disposable } from 'event-kit'\n\nimport { fatalError } from '../../lib/fatal-error'\n\nimport { DiffHunk, DiffLineType, DiffSelection } from '../../models/diff'\nimport {\n  WorkingDirectoryFileChange,\n  CommittedFileChange,\n} from '../../models/status'\n\nimport { Octicon, OcticonSymbol } from '../octicons'\n\nimport { IEditorConfigurationExtra } from './editor-configuration-extra'\nimport { DiffSyntaxMode, IDiffSyntaxModeSpec } from './diff-syntax-mode'\nimport { CodeMirrorHost } from './code-mirror-host'\nimport { DiffLineGutter } from './diff-line-gutter'\nimport {\n  diffLineForIndex,\n  diffHunkForIndex,\n  findInteractiveDiffRange,\n  lineNumberForDiffLine,\n} from './diff-explorer'\nimport { RangeSelectionSizePixels } from './edge-detection'\n\nimport { ISelectionStrategy } from './selection/selection-strategy'\nimport { RangeSelection } from './selection/range-selection-strategy'\nimport { DragDropSelection } from './selection/drag-drop-selection-strategy'\n\nimport {\n  getLineFilters,\n  getFileContents,\n  highlightContents,\n} from './syntax-highlighting'\nimport { relativeChanges } from './changed-range'\nimport { Repository } from '../../models/repository'\n\n/** The longest line for which we'd try to calculate a line diff. */\nconst MaxIntraLineDiffStringLength = 4096\n\n// This is a custom version of the no-newline octicon that's exactly as\n// tall as it needs to be (8px) which helps with aligning it on the line.\nconst narrowNoNewlineSymbol = new OcticonSymbol(\n  16,\n  8,\n  'm 16,1 0,3 c 0,0.55 -0.45,1 -1,1 l -3,0 0,2 -3,-3 3,-3 0,2 2,0 0,-2 2,0 z M 8,4 C 8,6.2 6.2,8 4,8 1.8,8 0,6.2 0,4 0,1.8 1.8,0 4,0 6.2,0 8,1.8 8,4 Z M 1.5,5.66 5.66,1.5 C 5.18,1.19 4.61,1 4,1 2.34,1 1,2.34 1,4 1,4.61 1.19,5.17 1.5,5.66 Z M 7,4 C 7,3.39 6.81,2.83 6.5,2.34 L 2.34,6.5 C 2.82,6.81 3.39,7 4,7 5.66,7 7,5.66 7,4 Z'\n)\n\ntype ChangedFile = WorkingDirectoryFileChange | CommittedFileChange\n\n/**\n * Checks to see if any key parameters in the props object that are used\n * when performing highlighting has changed. This is used to determine\n * whether highlighting should abort in between asynchronous operations\n * due to some factor (like which file is currently selected) have changed\n * and thus rendering the in-flight highlighting data useless.\n */\nfunction highlightParametersEqual(\n  newProps: ITextDiffProps,\n  prevProps: ITextDiffProps\n) {\n  if (newProps === prevProps) {\n    return true\n  }\n\n  return (\n    newProps.file.path === prevProps.file.path &&\n    newProps.file.oldPath === prevProps.file.oldPath &&\n    newProps.text === prevProps.text\n  )\n}\n\ninterface ITextDiffProps {\n  readonly repository: Repository\n  readonly file: ChangedFile\n  readonly readOnly: boolean\n  readonly onIncludeChanged?: (diffSelection: DiffSelection) => void\n  readonly text: string\n  readonly hunks: ReadonlyArray<DiffHunk>\n}\n\nexport class TextDiff extends React.Component<ITextDiffProps, {}> {\n  private codeMirror: Editor | null = null\n\n  private gutterWidth: number | null = null\n\n  /**\n   * We store the scroll position before reloading the same diff so that we can\n   * restore it when we're done. If we're not reloading the same diff, this'll\n   * be null.\n   */\n  private scrollPositionToRestore: { left: number; top: number } | null = null\n\n  /**\n   * A mapping from CodeMirror line handles to disposables which, when disposed\n   * cleans up any line gutter components and events associated with that line.\n   * See renderLine for more information.\n   */\n  private readonly lineCleanup = new Map<any, Disposable>()\n\n  /**\n   *  a local cache of gutter elements, keyed by the row in the diff\n   */\n  private cachedGutterElements = new Map<number, DiffLineGutter>()\n\n  /**\n   * Maintain the current state of the user interacting with the diff gutter\n   */\n  private selection: ISelectionStrategy | null = null\n\n  private async initDiffSyntaxMode() {\n    const cm = this.codeMirror\n    const file = this.props.file\n    const hunks = this.props.hunks\n    const repo = this.props.repository\n\n    if (!cm) {\n      return\n    }\n\n    // Store the current props to that we can see if anything\n    // changes from underneath us as we're making asynchronous\n    // operations that makes our data stale or useless.\n    const propsSnapshot = this.props\n\n    const lineFilters = getLineFilters(hunks)\n    const contents = await getFileContents(repo, file, lineFilters)\n\n    if (!highlightParametersEqual(this.props, propsSnapshot)) {\n      return\n    }\n\n    const tsOpt = cm.getOption('tabSize')\n    const tabSize = typeof tsOpt === 'number' ? tsOpt : 4\n\n    const tokens = await highlightContents(contents, tabSize, lineFilters)\n\n    if (!highlightParametersEqual(this.props, propsSnapshot)) {\n      return\n    }\n\n    const spec: IDiffSyntaxModeSpec = {\n      name: DiffSyntaxMode.ModeName,\n      hunks: this.props.hunks,\n      oldTokens: tokens.oldTokens,\n      newTokens: tokens.newTokens,\n    }\n\n    cm.setOption('mode', spec)\n  }\n\n  private dispose() {\n    this.codeMirror = null\n\n    this.lineCleanup.forEach(disposable => disposable.dispose())\n    this.lineCleanup.clear()\n\n    document.removeEventListener('mouseup', this.onDocumentMouseUp)\n  }\n\n  /**\n   * compute the diff gutter width based on what's been rendered in the browser\n   */\n  private getAndCacheGutterWidth = (): number | null => {\n    if (this.gutterWidth) {\n      return this.gutterWidth\n    }\n\n    if (this.codeMirror) {\n      // as getWidth will return 0 for elements that are offscreen, this code\n      // will look for the first row of the current viewport, which should be\n      // onscreen\n      const viewport = this.codeMirror.getScrollInfo()\n      const top = viewport.top\n\n      const row = this.codeMirror.lineAtHeight(top, 'local')\n      const element = this.cachedGutterElements.get(row)\n\n      if (!element) {\n        console.error(\n          `unable to find element at ${row}, should probably look into that`\n        )\n        return null\n      }\n\n      this.gutterWidth = element.getWidth()\n\n      if (this.gutterWidth === 0) {\n        console.error(\n          `element at row ${row} does not have a width, should probably look into that`\n        )\n      }\n    }\n\n    return this.gutterWidth\n  }\n\n  private updateRangeHoverState = (\n    start: number,\n    end: number,\n    show: boolean\n  ) => {\n    for (let i = start; i <= end; i++) {\n      this.hoverLine(i, show)\n    }\n  }\n\n  private hoverLine = (row: number, include: boolean) => {\n    const element = this.cachedGutterElements.get(row)\n\n    // element may not be drawn by the editor, so updating it isn't necessary\n    if (element) {\n      element.setHover(include)\n    }\n  }\n\n  /**\n   * start a selection gesture based on the current interation\n   */\n  private startSelection = (\n    file: WorkingDirectoryFileChange,\n    hunks: ReadonlyArray<DiffHunk>,\n    index: number,\n    isRangeSelection: boolean\n  ) => {\n    const snapshot = file.selection\n    const selected = snapshot.isSelected(index)\n    const desiredSelection = !selected\n\n    if (isRangeSelection) {\n      const range = findInteractiveDiffRange(hunks, index)\n      if (!range) {\n        console.error('unable to find range for given line in diff')\n        return\n      }\n\n      this.selection = new RangeSelection(\n        range.start,\n        range.end,\n        desiredSelection,\n        snapshot\n      )\n    } else {\n      this.selection = new DragDropSelection(index, desiredSelection, snapshot)\n    }\n\n    this.selection.paint(this.cachedGutterElements)\n    document.addEventListener('mouseup', this.onDocumentMouseUp)\n  }\n\n  /**\n   * Helper event listener, registered when starting a selection by\n   * clicking anywhere on or near the gutter. Immediately removes itself\n   * from the mouseup event on the document element and ends any current\n   * selection.\n   *\n   * TODO: Once Electron upgrades to Chrome 55 we can drop this in favor\n   * of the 'once' option in addEventListener, see\n   * https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener\n   */\n  private onDocumentMouseUp = (ev: MouseEvent) => {\n    ev.preventDefault()\n    document.removeEventListener('mouseup', this.onDocumentMouseUp)\n    this.endSelection()\n  }\n\n  /**\n   * complete the selection gesture and apply the change to the diff\n   */\n  private endSelection = () => {\n    if (!this.props.onIncludeChanged || !this.selection) {\n      return\n    }\n\n    this.props.onIncludeChanged(this.selection.done())\n\n    // operation is completed, clean this up\n    this.selection = null\n  }\n\n  private onGutterMouseDown = (\n    index: number,\n    hunks: ReadonlyArray<DiffHunk>,\n    isRangeSelection: boolean\n  ) => {\n    if (!(this.props.file instanceof WorkingDirectoryFileChange)) {\n      fatalError(\n        'must not start selection when selected file is not a WorkingDirectoryFileChange'\n      )\n      return\n    }\n\n    if (isRangeSelection) {\n      const hunk = diffHunkForIndex(hunks, index)\n      if (!hunk) {\n        console.error('unable to find hunk for given line in diff')\n      }\n    }\n    this.startSelection(this.props.file, hunks, index, isRangeSelection)\n  }\n\n  private onGutterMouseMove = (index: number) => {\n    if (!this.selection) {\n      return\n    }\n\n    this.selection.update(index)\n    this.selection.paint(this.cachedGutterElements)\n  }\n\n  private onDiffTextMouseMove = (\n    ev: MouseEvent,\n    hunks: ReadonlyArray<DiffHunk>,\n    index: number\n  ) => {\n    const isActive = this.isMouseCursorNearGutter(ev)\n    if (isActive === null) {\n      return\n    }\n\n    const diffLine = diffLineForIndex(hunks, index)\n    if (!diffLine) {\n      return\n    }\n\n    if (!diffLine.isIncludeableLine()) {\n      return\n    }\n\n    const range = findInteractiveDiffRange(hunks, index)\n    if (!range) {\n      console.error('unable to find range for given index in diff')\n      return\n    }\n\n    this.updateRangeHoverState(range.start, range.end, isActive)\n  }\n\n  private onDiffTextMouseDown = (\n    ev: MouseEvent,\n    hunks: ReadonlyArray<DiffHunk>,\n    index: number\n  ) => {\n    const isActive = this.isMouseCursorNearGutter(ev)\n\n    if (isActive) {\n      // this line is important because it prevents the codemirror editor\n      // from handling the event and resetting the scroll position.\n      // it doesn't do this when you click on elements in the gutter,\n      // which is an amazing joke to have placed upon me right now\n      ev.preventDefault()\n\n      if (!(this.props.file instanceof WorkingDirectoryFileChange)) {\n        fatalError(\n          'must not start selection when selected file is not a WorkingDirectoryFileChange'\n        )\n        return\n      }\n\n      this.startSelection(this.props.file, hunks, index, true)\n    }\n  }\n\n  private onDiffTextMouseLeave = (\n    ev: MouseEvent,\n    hunks: ReadonlyArray<DiffHunk>,\n    index: number\n  ) => {\n    const range = findInteractiveDiffRange(hunks, index)\n    if (!range) {\n      console.error('unable to find range for given index in diff')\n      return\n    }\n\n    this.updateRangeHoverState(range.start, range.end, false)\n  }\n\n  private isMouseCursorNearGutter = (ev: MouseEvent): boolean | null => {\n    const width = this.getAndCacheGutterWidth()\n\n    if (!width) {\n      // should fail earlier than this with a helpful error message\n      return null\n    }\n\n    const deltaX = ev.layerX - width\n    return deltaX >= 0 && deltaX <= RangeSelectionSizePixels\n  }\n\n  private isSelectionEnabled = () => {\n    return this.selection == null\n  }\n\n  private restoreScrollPosition(cm: Editor) {\n    const scrollPosition = this.scrollPositionToRestore\n    if (cm && scrollPosition) {\n      cm.scrollTo(scrollPosition.left, scrollPosition.top)\n    }\n  }\n\n  private renderLine = (instance: any, line: any, element: HTMLElement) => {\n    const existingLineDisposable = this.lineCleanup.get(line)\n\n    // If we can find the line in our cleanup list that means the line is\n    // being re-rendered. Agains, CodeMirror doesn't fire the 'delete' event\n    // when this happens.\n    if (existingLineDisposable) {\n      existingLineDisposable.dispose()\n      this.lineCleanup.delete(line)\n    }\n\n    const index = instance.getLineNumber(line) as number\n\n    const diffLine = diffLineForIndex(this.props.hunks, index)\n    if (diffLine) {\n      const diffLineElement = element.children[0] as HTMLSpanElement\n\n      let noNewlineReactContainer: HTMLSpanElement | null = null\n\n      if (diffLine.noTrailingNewLine) {\n        noNewlineReactContainer = document.createElement('span')\n        noNewlineReactContainer.setAttribute(\n          'title',\n          'No newline at end of file'\n        )\n        ReactDOM.render(\n          <Octicon symbol={narrowNoNewlineSymbol} className=\"no-newline\" />,\n          noNewlineReactContainer\n        )\n        diffLineElement.appendChild(noNewlineReactContainer)\n      }\n\n      const gutterReactContainer = document.createElement('span')\n\n      let isIncluded = false\n      if (this.props.file instanceof WorkingDirectoryFileChange) {\n        isIncluded = this.props.file.selection.isSelected(index)\n      }\n\n      const cache = this.cachedGutterElements\n\n      const hunks = this.props.hunks\n\n      ReactDOM.render(\n        <DiffLineGutter\n          line={diffLine}\n          isIncluded={isIncluded}\n          index={index}\n          readOnly={this.props.readOnly}\n          hunks={hunks}\n          updateRangeHoverState={this.updateRangeHoverState}\n          isSelectionEnabled={this.isSelectionEnabled}\n          onMouseDown={this.onGutterMouseDown}\n          onMouseMove={this.onGutterMouseMove}\n        />,\n        gutterReactContainer,\n        function(this: DiffLineGutter) {\n          if (this !== undefined) {\n            cache.set(index, this)\n          }\n        }\n      )\n\n      const onMouseMoveLine: (ev: MouseEvent) => void = ev => {\n        this.onDiffTextMouseMove(ev, hunks, index)\n      }\n\n      const onMouseDownLine: (ev: MouseEvent) => void = ev => {\n        this.onDiffTextMouseDown(ev, hunks, index)\n      }\n\n      const onMouseLeaveLine: (ev: MouseEvent) => void = ev => {\n        this.onDiffTextMouseLeave(ev, hunks, index)\n      }\n\n      if (!this.props.readOnly) {\n        diffLineElement.addEventListener('mousemove', onMouseMoveLine)\n        diffLineElement.addEventListener('mousedown', onMouseDownLine)\n        diffLineElement.addEventListener('mouseleave', onMouseLeaveLine)\n      }\n\n      element.insertBefore(gutterReactContainer, diffLineElement)\n\n      // Hack(ish?). In order to be a real good citizen we need to unsubscribe from\n      // the line delete event once we've been called once or the component has been\n      // unmounted. In the latter case it's _probably_ not strictly necessary since\n      // the only thing gc rooted by the event should be isolated and eligble for\n      // collection. But let's be extra cautious I guess.\n      //\n      // The only way to unsubscribe is to pass the exact same function given to the\n      // 'on' function to the 'off' so we need a reference to ourselves, basically.\n      let deleteHandler: () => void // eslint-disable-line prefer-const\n\n      // Since we manually render a react component we have to take care of unmounting\n      // it or else we'll leak memory. This disposable will unmount the component.\n      //\n      // See https://facebook.github.io/react/blog/2015/10/01/react-render-and-top-level-api.html\n      const gutterCleanup = new Disposable(() => {\n        this.cachedGutterElements.delete(index)\n\n        ReactDOM.unmountComponentAtNode(gutterReactContainer)\n\n        if (noNewlineReactContainer) {\n          ReactDOM.unmountComponentAtNode(noNewlineReactContainer)\n        }\n\n        if (!this.props.readOnly) {\n          diffLineElement.removeEventListener('mousemove', onMouseMoveLine)\n          diffLineElement.removeEventListener('mousedown', onMouseDownLine)\n          diffLineElement.removeEventListener('mouseleave', onMouseLeaveLine)\n        }\n\n        line.off('delete', deleteHandler)\n      })\n\n      // Add the cleanup disposable to our list of disposables so that we clean up when\n      // this component is unmounted or when the line is re-rendered. When either of that\n      // happens the line 'delete' event doesn't  fire.\n      this.lineCleanup.set(line, gutterCleanup)\n\n      // If the line delete event fires we dispose of the disposable (disposing is\n      // idempotent)\n      deleteHandler = () => {\n        const disp = this.lineCleanup.get(line)\n        if (disp) {\n          this.lineCleanup.delete(line)\n          disp.dispose()\n        }\n      }\n      line.on('delete', deleteHandler)\n    }\n  }\n\n  private getAndStoreCodeMirrorInstance = (cmh: CodeMirrorHost | null) => {\n    this.codeMirror = cmh === null ? null : cmh.getEditor()\n  }\n\n  private onCopy = (editor: Editor, event: Event) => {\n    event.preventDefault()\n\n    // Remove the diff line markers from the copied text. The beginning of the\n    // selection might start within a line, in which case we don't have to trim\n    // the diff type marker. But for selections that span multiple lines, we'll\n    // trim it.\n    const doc = editor.getDoc()\n    const lines = doc.getSelections()\n    const selectionRanges = doc.listSelections()\n    const lineContent: Array<string> = []\n\n    for (let i = 0; i < lines.length; i++) {\n      const range = selectionRanges[i]\n      const content = lines[i]\n      const contentLines = content.split('\\n')\n      for (const [i, line] of contentLines.entries()) {\n        if (i === 0 && range.head.ch > 0) {\n          lineContent.push(line)\n        } else {\n          lineContent.push(line.substr(1))\n        }\n      }\n\n      const textWithoutMarkers = lineContent.join('\\n')\n      clipboard.writeText(textWithoutMarkers)\n    }\n  }\n\n  private markIntraLineChanges(\n    codeMirror: Editor,\n    hunks: ReadonlyArray<DiffHunk>\n  ) {\n    for (const hunk of hunks) {\n      const additions = hunk.lines.filter(l => l.type === DiffLineType.Add)\n      const deletions = hunk.lines.filter(l => l.type === DiffLineType.Delete)\n      if (additions.length !== deletions.length) {\n        continue\n      }\n\n      for (let i = 0; i < additions.length; i++) {\n        const addLine = additions[i]\n        const deleteLine = deletions[i]\n        if (\n          addLine.text.length > MaxIntraLineDiffStringLength ||\n          deleteLine.text.length > MaxIntraLineDiffStringLength\n        ) {\n          continue\n        }\n\n        const changeRanges = relativeChanges(\n          addLine.content,\n          deleteLine.content\n        )\n        const addRange = changeRanges.stringARange\n        if (addRange.length > 0) {\n          const addLineNumber = lineNumberForDiffLine(addLine, hunks)\n          if (addLineNumber > -1) {\n            const addFrom = {\n              line: addLineNumber,\n              ch: addRange.location + 1,\n            }\n            const addTo = {\n              line: addLineNumber,\n              ch: addRange.location + addRange.length + 1,\n            }\n            codeMirror\n              .getDoc()\n              .markText(addFrom, addTo, { className: 'cm-diff-add-inner' })\n          }\n        }\n\n        const deleteRange = changeRanges.stringBRange\n        if (deleteRange.length > 0) {\n          const deleteLineNumber = lineNumberForDiffLine(deleteLine, hunks)\n          if (deleteLineNumber > -1) {\n            const deleteFrom = {\n              line: deleteLineNumber,\n              ch: deleteRange.location + 1,\n            }\n            const deleteTo = {\n              line: deleteLineNumber,\n              ch: deleteRange.location + deleteRange.length + 1,\n            }\n            codeMirror.getDoc().markText(deleteFrom, deleteTo, {\n              className: 'cm-diff-delete-inner',\n            })\n          }\n        }\n      }\n    }\n  }\n\n  private onChanges = (cm: Editor) => {\n    this.restoreScrollPosition(cm)\n\n    this.markIntraLineChanges(cm, this.props.hunks)\n  }\n\n  public componentWillReceiveProps(nextProps: ITextDiffProps) {\n    // If we're reloading the same file, we want to save the current scroll\n    // position and restore it after the diff's been updated.\n    const sameFile =\n      nextProps.file &&\n      this.props.file &&\n      nextProps.file.id === this.props.file.id\n\n    // Happy path, if the text hasn't changed we won't re-render\n    // and subsequently won't have to restore the scroll position.\n    const textHasChanged = nextProps.text !== this.props.text\n\n    const codeMirror = this.codeMirror\n    if (codeMirror && sameFile && textHasChanged) {\n      const scrollInfo = codeMirror.getScrollInfo()\n      this.scrollPositionToRestore = {\n        left: scrollInfo.left,\n        top: scrollInfo.top,\n      }\n    } else {\n      this.scrollPositionToRestore = null\n    }\n\n    if (codeMirror && this.props.text !== nextProps.text) {\n      codeMirror.setOption('mode', { name: DiffSyntaxMode.ModeName })\n    }\n\n    // HACK: This entire section is a hack. Whenever we receive\n    // props we update all currently visible gutter elements with\n    // the selection state from the file.\n    if (nextProps.file instanceof WorkingDirectoryFileChange) {\n      const selection = nextProps.file.selection\n      const oldSelection =\n        this.props.file instanceof WorkingDirectoryFileChange\n          ? this.props.file.selection\n          : null\n\n      // Nothing has changed\n      if (oldSelection === selection) {\n        return\n      }\n\n      this.gutterWidth = null\n\n      const hunks = nextProps.hunks\n      this.cachedGutterElements.forEach((element, index) => {\n        if (!element) {\n          console.error('expected DOM element for diff gutter not found')\n          return\n        }\n\n        const line = diffLineForIndex(hunks, index)\n        const isIncludable = line ? line.isIncludeableLine() : false\n        const isSelected = selection.isSelected(index) && isIncludable\n        element.setSelected(isSelected)\n      })\n    }\n  }\n\n  public componentWillUnmount() {\n    this.dispose()\n  }\n\n  public componentDidUpdate(prevProps: ITextDiffProps) {\n    if (this.props.text === prevProps.text) {\n      return\n    }\n\n    if (this.codeMirror) {\n      this.codeMirror.setOption('mode', { name: DiffSyntaxMode.ModeName })\n    }\n\n    this.initDiffSyntaxMode()\n  }\n\n  public componentDidMount() {\n    this.initDiffSyntaxMode()\n  }\n\n  public render() {\n    const options: IEditorConfigurationExtra = {\n      lineNumbers: false,\n      readOnly: true,\n      showCursorWhenSelecting: false,\n      cursorBlinkRate: -1,\n      lineWrapping: true,\n      mode: { name: DiffSyntaxMode.ModeName },\n      // Make sure CodeMirror doesn't capture Tab and thus destroy tab navigation\n      extraKeys: { Tab: false },\n      scrollbarStyle: __DARWIN__ ? 'simple' : 'native',\n      styleSelectedText: true,\n      lineSeparator: '\\n',\n      specialChars: /[\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u061c\\u200b-\\u200f\\u2028\\u2029\\ufeff]/,\n    }\n\n    // If the text looks like it could have been formatted using Windows\n    // line endings (\\r\\n) we need to massage it a bit before we hand it\n    // off to CodeMirror. That's because CodeMirror has two ways of splitting\n    // lines, one is the built in which splits on \\n, \\r\\n and \\r. The last\n    // one is important because that will match carriage return characters\n    // inside a diff line. The other way is when consumers supply the\n    // lineSeparator option. That option only takes a string meaning we can\n    // either make it split on '\\r\\n', '\\n' or '\\r' but not what we would like\n    // to do, namely '\\r?\\n'. We want to keep CR characters inside of a diff\n    // line so that we can mark them using the specialChars attribute so\n    // we convert all \\r\\n to \\n and remove any trailing \\r character.\n    const text =\n      this.props.text.indexOf('\\r') !== -1\n        ? this.props.text\n            // Capture the \\r if followed by (positive lookahead) a \\n or\n            // the end of the string. Note that this does not capture the \\n.\n            .replace(/\\r(?=\\n|$)/g, '')\n        : this.props.text\n\n    return (\n      <CodeMirrorHost\n        className=\"diff-code-mirror\"\n        value={text}\n        options={options}\n        isSelectionEnabled={this.isSelectionEnabled}\n        onChanges={this.onChanges}\n        onRenderLine={this.renderLine}\n        ref={this.getAndStoreCodeMirrorInstance}\n        onCopy={this.onCopy}\n      />\n    )\n  }\n}\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n\"use strict\";\n\nCodeMirror.defineMode(\"javascript\", function(config, parserConfig) {\n  var indentUnit = config.indentUnit;\n  var statementIndent = parserConfig.statementIndent;\n  var jsonldMode = parserConfig.jsonld;\n  var jsonMode = parserConfig.json || jsonldMode;\n  var isTS = parserConfig.typescript;\n  var wordRE = parserConfig.wordCharacters || /[\\w$\\xa1-\\uffff]/;\n\n  // Tokenizer\n\n  var keywords = function(){\n    function kw(type) {return {type: type, style: \"keyword\"};}\n    var A = kw(\"keyword a\"), B = kw(\"keyword b\"), C = kw(\"keyword c\"), D = kw(\"keyword d\");\n    var operator = kw(\"operator\"), atom = {type: \"atom\", style: \"atom\"};\n\n    return {\n      \"if\": kw(\"if\"), \"while\": A, \"with\": A, \"else\": B, \"do\": B, \"try\": B, \"finally\": B,\n      \"return\": D, \"break\": D, \"continue\": D, \"new\": kw(\"new\"), \"delete\": C, \"void\": C, \"throw\": C,\n      \"debugger\": kw(\"debugger\"), \"var\": kw(\"var\"), \"const\": kw(\"var\"), \"let\": kw(\"var\"),\n      \"function\": kw(\"function\"), \"catch\": kw(\"catch\"),\n      \"for\": kw(\"for\"), \"switch\": kw(\"switch\"), \"case\": kw(\"case\"), \"default\": kw(\"default\"),\n      \"in\": operator, \"typeof\": operator, \"instanceof\": operator,\n      \"true\": atom, \"false\": atom, \"null\": atom, \"undefined\": atom, \"NaN\": atom, \"Infinity\": atom,\n      \"this\": kw(\"this\"), \"class\": kw(\"class\"), \"super\": kw(\"atom\"),\n      \"yield\": C, \"export\": kw(\"export\"), \"import\": kw(\"import\"), \"extends\": C,\n      \"await\": C\n    };\n  }();\n\n  var isOperatorChar = /[+\\-*&%=<>!?|~^@]/;\n  var isJsonldKeyword = /^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)\"/;\n\n  function readRegexp(stream) {\n    var escaped = false, next, inSet = false;\n    while ((next = stream.next()) != null) {\n      if (!escaped) {\n        if (next == \"/\" && !inSet) return;\n        if (next == \"[\") inSet = true;\n        else if (inSet && next == \"]\") inSet = false;\n      }\n      escaped = !escaped && next == \"\\\\\";\n    }\n  }\n\n  // Used as scratch variables to communicate multiple values without\n  // consing up tons of objects.\n  var type, content;\n  function ret(tp, style, cont) {\n    type = tp; content = cont;\n    return style;\n  }\n  function tokenBase(stream, state) {\n    var ch = stream.next();\n    if (ch == '\"' || ch == \"'\") {\n      state.tokenize = tokenString(ch);\n      return state.tokenize(stream, state);\n    } else if (ch == \".\" && stream.match(/^\\d+(?:[eE][+\\-]?\\d+)?/)) {\n      return ret(\"number\", \"number\");\n    } else if (ch == \".\" && stream.match(\"..\")) {\n      return ret(\"spread\", \"meta\");\n    } else if (/[\\[\\]{}\\(\\),;\\:\\.]/.test(ch)) {\n      return ret(ch);\n    } else if (ch == \"=\" && stream.eat(\">\")) {\n      return ret(\"=>\", \"operator\");\n    } else if (ch == \"0\" && stream.eat(/x/i)) {\n      stream.eatWhile(/[\\da-f]/i);\n      return ret(\"number\", \"number\");\n    } else if (ch == \"0\" && stream.eat(/o/i)) {\n      stream.eatWhile(/[0-7]/i);\n      return ret(\"number\", \"number\");\n    } else if (ch == \"0\" && stream.eat(/b/i)) {\n      stream.eatWhile(/[01]/i);\n      return ret(\"number\", \"number\");\n    } else if (/\\d/.test(ch)) {\n      stream.match(/^\\d*(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/);\n      return ret(\"number\", \"number\");\n    } else if (ch == \"/\") {\n      if (stream.eat(\"*\")) {\n        state.tokenize = tokenComment;\n        return tokenComment(stream, state);\n      } else if (stream.eat(\"/\")) {\n        stream.skipToEnd();\n        return ret(\"comment\", \"comment\");\n      } else if (expressionAllowed(stream, state, 1)) {\n        readRegexp(stream);\n        stream.match(/^\\b(([gimyu])(?![gimyu]*\\2))+\\b/);\n        return ret(\"regexp\", \"string-2\");\n      } else {\n        stream.eat(\"=\");\n        return ret(\"operator\", \"operator\", stream.current());\n      }\n    } else if (ch == \"`\") {\n      state.tokenize = tokenQuasi;\n      return tokenQuasi(stream, state);\n    } else if (ch == \"#\") {\n      stream.skipToEnd();\n      return ret(\"error\", \"error\");\n    } else if (isOperatorChar.test(ch)) {\n      if (ch != \">\" || !state.lexical || state.lexical.type != \">\") {\n        if (stream.eat(\"=\")) {\n          if (ch == \"!\" || ch == \"=\") stream.eat(\"=\")\n        } else if (/[<>*+\\-]/.test(ch)) {\n          stream.eat(ch)\n          if (ch == \">\") stream.eat(ch)\n        }\n      }\n      return ret(\"operator\", \"operator\", stream.current());\n    } else if (wordRE.test(ch)) {\n      stream.eatWhile(wordRE);\n      var word = stream.current()\n      if (state.lastType != \".\") {\n        if (keywords.propertyIsEnumerable(word)) {\n          var kw = keywords[word]\n          return ret(kw.type, kw.style, word)\n        }\n        if (word == \"async\" && stream.match(/^(\\s|\\/\\*.*?\\*\\/)*[\\(\\w]/, false))\n          return ret(\"async\", \"keyword\", word)\n      }\n      return ret(\"variable\", \"variable\", word)\n    }\n  }\n\n  function tokenString(quote) {\n    return function(stream, state) {\n      var escaped = false, next;\n      if (jsonldMode && stream.peek() == \"@\" && stream.match(isJsonldKeyword)){\n        state.tokenize = tokenBase;\n        return ret(\"jsonld-keyword\", \"meta\");\n      }\n      while ((next = stream.next()) != null) {\n        if (next == quote && !escaped) break;\n        escaped = !escaped && next == \"\\\\\";\n      }\n      if (!escaped) state.tokenize = tokenBase;\n      return ret(\"string\", \"string\");\n    };\n  }\n\n  function tokenComment(stream, state) {\n    var maybeEnd = false, ch;\n    while (ch = stream.next()) {\n      if (ch == \"/\" && maybeEnd) {\n        state.tokenize = tokenBase;\n        break;\n      }\n      maybeEnd = (ch == \"*\");\n    }\n    return ret(\"comment\", \"comment\");\n  }\n\n  function tokenQuasi(stream, state) {\n    var escaped = false, next;\n    while ((next = stream.next()) != null) {\n      if (!escaped && (next == \"`\" || next == \"$\" && stream.eat(\"{\"))) {\n        state.tokenize = tokenBase;\n        break;\n      }\n      escaped = !escaped && next == \"\\\\\";\n    }\n    return ret(\"quasi\", \"string-2\", stream.current());\n  }\n\n  var brackets = \"([{}])\";\n  // This is a crude lookahead trick to try and notice that we're\n  // parsing the argument patterns for a fat-arrow function before we\n  // actually hit the arrow token. It only works if the arrow is on\n  // the same line as the arguments and there's no strange noise\n  // (comments) in between. Fallback is to only notice when we hit the\n  // arrow, and not declare the arguments as locals for the arrow\n  // body.\n  function findFatArrow(stream, state) {\n    if (state.fatArrowAt) state.fatArrowAt = null;\n    var arrow = stream.string.indexOf(\"=>\", stream.start);\n    if (arrow < 0) return;\n\n    if (isTS) { // Try to skip TypeScript return type declarations after the arguments\n      var m = /:\\s*(?:\\w+(?:<[^>]*>|\\[\\])?|\\{[^}]*\\})\\s*$/.exec(stream.string.slice(stream.start, arrow))\n      if (m) arrow = m.index\n    }\n\n    var depth = 0, sawSomething = false;\n    for (var pos = arrow - 1; pos >= 0; --pos) {\n      var ch = stream.string.charAt(pos);\n      var bracket = brackets.indexOf(ch);\n      if (bracket >= 0 && bracket < 3) {\n        if (!depth) { ++pos; break; }\n        if (--depth == 0) { if (ch == \"(\") sawSomething = true; break; }\n      } else if (bracket >= 3 && bracket < 6) {\n        ++depth;\n      } else if (wordRE.test(ch)) {\n        sawSomething = true;\n      } else if (/[\"'\\/]/.test(ch)) {\n        return;\n      } else if (sawSomething && !depth) {\n        ++pos;\n        break;\n      }\n    }\n    if (sawSomething && !depth) state.fatArrowAt = pos;\n  }\n\n  // Parser\n\n  var atomicTypes = {\"atom\": true, \"number\": true, \"variable\": true, \"string\": true, \"regexp\": true, \"this\": true, \"jsonld-keyword\": true};\n\n  function JSLexical(indented, column, type, align, prev, info) {\n    this.indented = indented;\n    this.column = column;\n    this.type = type;\n    this.prev = prev;\n    this.info = info;\n    if (align != null) this.align = align;\n  }\n\n  function inScope(state, varname) {\n    for (var v = state.localVars; v; v = v.next)\n      if (v.name == varname) return true;\n    for (var cx = state.context; cx; cx = cx.prev) {\n      for (var v = cx.vars; v; v = v.next)\n        if (v.name == varname) return true;\n    }\n  }\n\n  function parseJS(state, style, type, content, stream) {\n    var cc = state.cc;\n    // Communicate our context to the combinators.\n    // (Less wasteful than consing up a hundred closures on every call.)\n    cx.state = state; cx.stream = stream; cx.marked = null, cx.cc = cc; cx.style = style;\n\n    if (!state.lexical.hasOwnProperty(\"align\"))\n      state.lexical.align = true;\n\n    while(true) {\n      var combinator = cc.length ? cc.pop() : jsonMode ? expression : statement;\n      if (combinator(type, content)) {\n        while(cc.length && cc[cc.length - 1].lex)\n          cc.pop()();\n        if (cx.marked) return cx.marked;\n        if (type == \"variable\" && inScope(state, content)) return \"variable-2\";\n        return style;\n      }\n    }\n  }\n\n  // Combinator utils\n\n  var cx = {state: null, column: null, marked: null, cc: null};\n  function pass() {\n    for (var i = arguments.length - 1; i >= 0; i--) cx.cc.push(arguments[i]);\n  }\n  function cont() {\n    pass.apply(null, arguments);\n    return true;\n  }\n  function register(varname) {\n    function inList(list) {\n      for (var v = list; v; v = v.next)\n        if (v.name == varname) return true;\n      return false;\n    }\n    var state = cx.state;\n    cx.marked = \"def\";\n    if (state.context) {\n      if (inList(state.localVars)) return;\n      state.localVars = {name: varname, next: state.localVars};\n    } else {\n      if (inList(state.globalVars)) return;\n      if (parserConfig.globalVars)\n        state.globalVars = {name: varname, next: state.globalVars};\n    }\n  }\n\n  function isModifier(name) {\n    return name == \"public\" || name == \"private\" || name == \"protected\" || name == \"abstract\" || name == \"readonly\"\n  }\n\n  // Combinators\n\n  var defaultVars = {name: \"this\", next: {name: \"arguments\"}};\n  function pushcontext() {\n    cx.state.context = {prev: cx.state.context, vars: cx.state.localVars};\n    cx.state.localVars = defaultVars;\n  }\n  function popcontext() {\n    cx.state.localVars = cx.state.context.vars;\n    cx.state.context = cx.state.context.prev;\n  }\n  function pushlex(type, info) {\n    var result = function() {\n      var state = cx.state, indent = state.indented;\n      if (state.lexical.type == \"stat\") indent = state.lexical.indented;\n      else for (var outer = state.lexical; outer && outer.type == \")\" && outer.align; outer = outer.prev)\n        indent = outer.indented;\n      state.lexical = new JSLexical(indent, cx.stream.column(), type, null, state.lexical, info);\n    };\n    result.lex = true;\n    return result;\n  }\n  function poplex() {\n    var state = cx.state;\n    if (state.lexical.prev) {\n      if (state.lexical.type == \")\")\n        state.indented = state.lexical.indented;\n      state.lexical = state.lexical.prev;\n    }\n  }\n  poplex.lex = true;\n\n  function expect(wanted) {\n    function exp(type) {\n      if (type == wanted) return cont();\n      else if (wanted == \";\") return pass();\n      else return cont(exp);\n    };\n    return exp;\n  }\n\n  function statement(type, value) {\n    if (type == \"var\") return cont(pushlex(\"vardef\", value.length), vardef, expect(\";\"), poplex);\n    if (type == \"keyword a\") return cont(pushlex(\"form\"), parenExpr, statement, poplex);\n    if (type == \"keyword b\") return cont(pushlex(\"form\"), statement, poplex);\n    if (type == \"keyword d\") return cx.stream.match(/^\\s*$/, false) ? cont() : cont(pushlex(\"stat\"), maybeexpression, expect(\";\"), poplex);\n    if (type == \"debugger\") return cont(expect(\";\"));\n    if (type == \"{\") return cont(pushlex(\"}\"), block, poplex);\n    if (type == \";\") return cont();\n    if (type == \"if\") {\n      if (cx.state.lexical.info == \"else\" && cx.state.cc[cx.state.cc.length - 1] == poplex)\n        cx.state.cc.pop()();\n      return cont(pushlex(\"form\"), parenExpr, statement, poplex, maybeelse);\n    }\n    if (type == \"function\") return cont(functiondef);\n    if (type == \"for\") return cont(pushlex(\"form\"), forspec, statement, poplex);\n    if (type == \"class\" || (isTS && value == \"interface\")) { cx.marked = \"keyword\"; return cont(pushlex(\"form\"), className, poplex); }\n    if (type == \"variable\") {\n      if (isTS && value == \"type\") {\n        cx.marked = \"keyword\"\n        return cont(typeexpr, expect(\"operator\"), typeexpr, expect(\";\"));\n      } else if (isTS && value == \"declare\") {\n        cx.marked = \"keyword\"\n        return cont(statement)\n      } else if (isTS && (value == \"module\" || value == \"enum\") && cx.stream.match(/^\\s*\\w/, false)) {\n        cx.marked = \"keyword\"\n        return cont(pushlex(\"form\"), pattern, expect(\"{\"), pushlex(\"}\"), block, poplex, poplex)\n      } else if (isTS && value == \"namespace\") {\n        cx.marked = \"keyword\"\n        return cont(pushlex(\"form\"), expression, block, poplex)\n      } else {\n        return cont(pushlex(\"stat\"), maybelabel);\n      }\n    }\n    if (type == \"switch\") return cont(pushlex(\"form\"), parenExpr, expect(\"{\"), pushlex(\"}\", \"switch\"),\n                                      block, poplex, poplex);\n    if (type == \"case\") return cont(expression, expect(\":\"));\n    if (type == \"default\") return cont(expect(\":\"));\n    if (type == \"catch\") return cont(pushlex(\"form\"), pushcontext, expect(\"(\"), funarg, expect(\")\"),\n                                     statement, poplex, popcontext);\n    if (type == \"export\") return cont(pushlex(\"stat\"), afterExport, poplex);\n    if (type == \"import\") return cont(pushlex(\"stat\"), afterImport, poplex);\n    if (type == \"async\") return cont(statement)\n    if (value == \"@\") return cont(expression, statement)\n    return pass(pushlex(\"stat\"), expression, expect(\";\"), poplex);\n  }\n  function expression(type, value) {\n    return expressionInner(type, value, false);\n  }\n  function expressionNoComma(type, value) {\n    return expressionInner(type, value, true);\n  }\n  function parenExpr(type) {\n    if (type != \"(\") return pass()\n    return cont(pushlex(\")\"), expression, expect(\")\"), poplex)\n  }\n  function expressionInner(type, value, noComma) {\n    if (cx.state.fatArrowAt == cx.stream.start) {\n      var body = noComma ? arrowBodyNoComma : arrowBody;\n      if (type == \"(\") return cont(pushcontext, pushlex(\")\"), commasep(funarg, \")\"), poplex, expect(\"=>\"), body, popcontext);\n      else if (type == \"variable\") return pass(pushcontext, pattern, expect(\"=>\"), body, popcontext);\n    }\n\n    var maybeop = noComma ? maybeoperatorNoComma : maybeoperatorComma;\n    if (atomicTypes.hasOwnProperty(type)) return cont(maybeop);\n    if (type == \"function\") return cont(functiondef, maybeop);\n    if (type == \"class\" || (isTS && value == \"interface\")) { cx.marked = \"keyword\"; return cont(pushlex(\"form\"), classExpression, poplex); }\n    if (type == \"keyword c\" || type == \"async\") return cont(noComma ? expressionNoComma : expression);\n    if (type == \"(\") return cont(pushlex(\")\"), maybeexpression, expect(\")\"), poplex, maybeop);\n    if (type == \"operator\" || type == \"spread\") return cont(noComma ? expressionNoComma : expression);\n    if (type == \"[\") return cont(pushlex(\"]\"), arrayLiteral, poplex, maybeop);\n    if (type == \"{\") return contCommasep(objprop, \"}\", null, maybeop);\n    if (type == \"quasi\") return pass(quasi, maybeop);\n    if (type == \"new\") return cont(maybeTarget(noComma));\n    return cont();\n  }\n  function maybeexpression(type) {\n    if (type.match(/[;\\}\\)\\],]/)) return pass();\n    return pass(expression);\n  }\n\n  function maybeoperatorComma(type, value) {\n    if (type == \",\") return cont(expression);\n    return maybeoperatorNoComma(type, value, false);\n  }\n  function maybeoperatorNoComma(type, value, noComma) {\n    var me = noComma == false ? maybeoperatorComma : maybeoperatorNoComma;\n    var expr = noComma == false ? expression : expressionNoComma;\n    if (type == \"=>\") return cont(pushcontext, noComma ? arrowBodyNoComma : arrowBody, popcontext);\n    if (type == \"operator\") {\n      if (/\\+\\+|--/.test(value) || isTS && value == \"!\") return cont(me);\n      if (isTS && value == \"<\" && cx.stream.match(/^([^>]|<.*?>)*>\\s*\\(/, false))\n        return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, me);\n      if (value == \"?\") return cont(expression, expect(\":\"), expr);\n      return cont(expr);\n    }\n    if (type == \"quasi\") { return pass(quasi, me); }\n    if (type == \";\") return;\n    if (type == \"(\") return contCommasep(expressionNoComma, \")\", \"call\", me);\n    if (type == \".\") return cont(property, me);\n    if (type == \"[\") return cont(pushlex(\"]\"), maybeexpression, expect(\"]\"), poplex, me);\n    if (isTS && value == \"as\") { cx.marked = \"keyword\"; return cont(typeexpr, me) }\n    if (type == \"regexp\") {\n      cx.state.lastType = cx.marked = \"operator\"\n      cx.stream.backUp(cx.stream.pos - cx.stream.start - 1)\n      return cont(expr)\n    }\n  }\n  function quasi(type, value) {\n    if (type != \"quasi\") return pass();\n    if (value.slice(value.length - 2) != \"${\") return cont(quasi);\n    return cont(expression, continueQuasi);\n  }\n  function continueQuasi(type) {\n    if (type == \"}\") {\n      cx.marked = \"string-2\";\n      cx.state.tokenize = tokenQuasi;\n      return cont(quasi);\n    }\n  }\n  function arrowBody(type) {\n    findFatArrow(cx.stream, cx.state);\n    return pass(type == \"{\" ? statement : expression);\n  }\n  function arrowBodyNoComma(type) {\n    findFatArrow(cx.stream, cx.state);\n    return pass(type == \"{\" ? statement : expressionNoComma);\n  }\n  function maybeTarget(noComma) {\n    return function(type) {\n      if (type == \".\") return cont(noComma ? targetNoComma : target);\n      else if (type == \"variable\" && isTS) return cont(maybeTypeArgs, noComma ? maybeoperatorNoComma : maybeoperatorComma)\n      else return pass(noComma ? expressionNoComma : expression);\n    };\n  }\n  function target(_, value) {\n    if (value == \"target\") { cx.marked = \"keyword\"; return cont(maybeoperatorComma); }\n  }\n  function targetNoComma(_, value) {\n    if (value == \"target\") { cx.marked = \"keyword\"; return cont(maybeoperatorNoComma); }\n  }\n  function maybelabel(type) {\n    if (type == \":\") return cont(poplex, statement);\n    return pass(maybeoperatorComma, expect(\";\"), poplex);\n  }\n  function property(type) {\n    if (type == \"variable\") {cx.marked = \"property\"; return cont();}\n  }\n  function objprop(type, value) {\n    if (type == \"async\") {\n      cx.marked = \"property\";\n      return cont(objprop);\n    } else if (type == \"variable\" || cx.style == \"keyword\") {\n      cx.marked = \"property\";\n      if (value == \"get\" || value == \"set\") return cont(getterSetter);\n      var m // Work around fat-arrow-detection complication for detecting typescript typed arrow params\n      if (isTS && cx.state.fatArrowAt == cx.stream.start && (m = cx.stream.match(/^\\s*:\\s*/, false)))\n        cx.state.fatArrowAt = cx.stream.pos + m[0].length\n      return cont(afterprop);\n    } else if (type == \"number\" || type == \"string\") {\n      cx.marked = jsonldMode ? \"property\" : (cx.style + \" property\");\n      return cont(afterprop);\n    } else if (type == \"jsonld-keyword\") {\n      return cont(afterprop);\n    } else if (isTS && isModifier(value)) {\n      cx.marked = \"keyword\"\n      return cont(objprop)\n    } else if (type == \"[\") {\n      return cont(expression, maybetype, expect(\"]\"), afterprop);\n    } else if (type == \"spread\") {\n      return cont(expressionNoComma, afterprop);\n    } else if (value == \"*\") {\n      cx.marked = \"keyword\";\n      return cont(objprop);\n    } else if (type == \":\") {\n      return pass(afterprop)\n    }\n  }\n  function getterSetter(type) {\n    if (type != \"variable\") return pass(afterprop);\n    cx.marked = \"property\";\n    return cont(functiondef);\n  }\n  function afterprop(type) {\n    if (type == \":\") return cont(expressionNoComma);\n    if (type == \"(\") return pass(functiondef);\n  }\n  function commasep(what, end, sep) {\n    function proceed(type, value) {\n      if (sep ? sep.indexOf(type) > -1 : type == \",\") {\n        var lex = cx.state.lexical;\n        if (lex.info == \"call\") lex.pos = (lex.pos || 0) + 1;\n        return cont(function(type, value) {\n          if (type == end || value == end) return pass()\n          return pass(what)\n        }, proceed);\n      }\n      if (type == end || value == end) return cont();\n      return cont(expect(end));\n    }\n    return function(type, value) {\n      if (type == end || value == end) return cont();\n      return pass(what, proceed);\n    };\n  }\n  function contCommasep(what, end, info) {\n    for (var i = 3; i < arguments.length; i++)\n      cx.cc.push(arguments[i]);\n    return cont(pushlex(end, info), commasep(what, end), poplex);\n  }\n  function block(type) {\n    if (type == \"}\") return cont();\n    return pass(statement, block);\n  }\n  function maybetype(type, value) {\n    if (isTS) {\n      if (type == \":\") return cont(typeexpr);\n      if (value == \"?\") return cont(maybetype);\n    }\n  }\n  function mayberettype(type) {\n    if (isTS && type == \":\") {\n      if (cx.stream.match(/^\\s*\\w+\\s+is\\b/, false)) return cont(expression, isKW, typeexpr)\n      else return cont(typeexpr)\n    }\n  }\n  function isKW(_, value) {\n    if (value == \"is\") {\n      cx.marked = \"keyword\"\n      return cont()\n    }\n  }\n  function typeexpr(type, value) {\n    if (type == \"variable\" || value == \"void\") {\n      if (value == \"keyof\") {\n        cx.marked = \"keyword\"\n        return cont(typeexpr)\n      } else {\n        cx.marked = \"type\"\n        return cont(afterType)\n      }\n    }\n    if (type == \"string\" || type == \"number\" || type == \"atom\") return cont(afterType);\n    if (type == \"[\") return cont(pushlex(\"]\"), commasep(typeexpr, \"]\", \",\"), poplex, afterType)\n    if (type == \"{\") return cont(pushlex(\"}\"), commasep(typeprop, \"}\", \",;\"), poplex, afterType)\n    if (type == \"(\") return cont(commasep(typearg, \")\"), maybeReturnType)\n  }\n  function maybeReturnType(type) {\n    if (type == \"=>\") return cont(typeexpr)\n  }\n  function typeprop(type, value) {\n    if (type == \"variable\" || cx.style == \"keyword\") {\n      cx.marked = \"property\"\n      return cont(typeprop)\n    } else if (value == \"?\") {\n      return cont(typeprop)\n    } else if (type == \":\") {\n      return cont(typeexpr)\n    } else if (type == \"[\") {\n      return cont(expression, maybetype, expect(\"]\"), typeprop)\n    }\n  }\n  function typearg(type) {\n    if (type == \"variable\") return cont(typearg)\n    else if (type == \":\") return cont(typeexpr)\n  }\n  function afterType(type, value) {\n    if (value == \"<\") return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, afterType)\n    if (value == \"|\" || type == \".\") return cont(typeexpr)\n    if (type == \"[\") return cont(expect(\"]\"), afterType)\n    if (value == \"extends\" || value == \"implements\") { cx.marked = \"keyword\"; return cont(typeexpr) }\n  }\n  function maybeTypeArgs(_, value) {\n    if (value == \"<\") return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, afterType)\n  }\n  function typeparam() {\n    return pass(typeexpr, maybeTypeDefault)\n  }\n  function maybeTypeDefault(_, value) {\n    if (value == \"=\") return cont(typeexpr)\n  }\n  function vardef() {\n    return pass(pattern, maybetype, maybeAssign, vardefCont);\n  }\n  function pattern(type, value) {\n    if (isTS && isModifier(value)) { cx.marked = \"keyword\"; return cont(pattern) }\n    if (type == \"variable\") { register(value); return cont(); }\n    if (type == \"spread\") return cont(pattern);\n    if (type == \"[\") return contCommasep(pattern, \"]\");\n    if (type == \"{\") return contCommasep(proppattern, \"}\");\n  }\n  function proppattern(type, value) {\n    if (type == \"variable\" && !cx.stream.match(/^\\s*:/, false)) {\n      register(value);\n      return cont(maybeAssign);\n    }\n    if (type == \"variable\") cx.marked = \"property\";\n    if (type == \"spread\") return cont(pattern);\n    if (type == \"}\") return pass();\n    return cont(expect(\":\"), pattern, maybeAssign);\n  }\n  function maybeAssign(_type, value) {\n    if (value == \"=\") return cont(expressionNoComma);\n  }\n  function vardefCont(type) {\n    if (type == \",\") return cont(vardef);\n  }\n  function maybeelse(type, value) {\n    if (type == \"keyword b\" && value == \"else\") return cont(pushlex(\"form\", \"else\"), statement, poplex);\n  }\n  function forspec(type) {\n    if (type == \"(\") return cont(pushlex(\")\"), forspec1, expect(\")\"), poplex);\n  }\n  function forspec1(type) {\n    if (type == \"var\") return cont(vardef, expect(\";\"), forspec2);\n    if (type == \";\") return cont(forspec2);\n    if (type == \"variable\") return cont(formaybeinof);\n    return pass(expression, expect(\";\"), forspec2);\n  }\n  function formaybeinof(_type, value) {\n    if (value == \"in\" || value == \"of\") { cx.marked = \"keyword\"; return cont(expression); }\n    return cont(maybeoperatorComma, forspec2);\n  }\n  function forspec2(type, value) {\n    if (type == \";\") return cont(forspec3);\n    if (value == \"in\" || value == \"of\") { cx.marked = \"keyword\"; return cont(expression); }\n    return pass(expression, expect(\";\"), forspec3);\n  }\n  function forspec3(type) {\n    if (type != \")\") cont(expression);\n  }\n  function functiondef(type, value) {\n    if (value == \"*\") {cx.marked = \"keyword\"; return cont(functiondef);}\n    if (type == \"variable\") {register(value); return cont(functiondef);}\n    if (type == \"(\") return cont(pushcontext, pushlex(\")\"), commasep(funarg, \")\"), poplex, mayberettype, statement, popcontext);\n    if (isTS && value == \"<\") return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex, functiondef)\n  }\n  function funarg(type, value) {\n    if (value == \"@\") cont(expression, funarg)\n    if (type == \"spread\") return cont(funarg);\n    if (isTS && isModifier(value)) { cx.marked = \"keyword\"; return cont(funarg); }\n    return pass(pattern, maybetype, maybeAssign);\n  }\n  function classExpression(type, value) {\n    // Class expressions may have an optional name.\n    if (type == \"variable\") return className(type, value);\n    return classNameAfter(type, value);\n  }\n  function className(type, value) {\n    if (type == \"variable\") {register(value); return cont(classNameAfter);}\n  }\n  function classNameAfter(type, value) {\n    if (value == \"<\") return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex, classNameAfter)\n    if (value == \"extends\" || value == \"implements\" || (isTS && type == \",\"))\n      return cont(isTS ? typeexpr : expression, classNameAfter);\n    if (type == \"{\") return cont(pushlex(\"}\"), classBody, poplex);\n  }\n  function classBody(type, value) {\n    if (type == \"async\" ||\n        (type == \"variable\" &&\n         (value == \"static\" || value == \"get\" || value == \"set\" || (isTS && isModifier(value))) &&\n         cx.stream.match(/^\\s+[\\w$\\xa1-\\uffff]/, false))) {\n      cx.marked = \"keyword\";\n      return cont(classBody);\n    }\n    if (type == \"variable\" || cx.style == \"keyword\") {\n      cx.marked = \"property\";\n      return cont(isTS ? classfield : functiondef, classBody);\n    }\n    if (type == \"[\")\n      return cont(expression, maybetype, expect(\"]\"), isTS ? classfield : functiondef, classBody)\n    if (value == \"*\") {\n      cx.marked = \"keyword\";\n      return cont(classBody);\n    }\n    if (type == \";\") return cont(classBody);\n    if (type == \"}\") return cont();\n    if (value == \"@\") return cont(expression, classBody)\n  }\n  function classfield(type, value) {\n    if (value == \"?\") return cont(classfield)\n    if (type == \":\") return cont(typeexpr, maybeAssign)\n    if (value == \"=\") return cont(expressionNoComma)\n    return pass(functiondef)\n  }\n  function afterExport(type, value) {\n    if (value == \"*\") { cx.marked = \"keyword\"; return cont(maybeFrom, expect(\";\")); }\n    if (value == \"default\") { cx.marked = \"keyword\"; return cont(expression, expect(\";\")); }\n    if (type == \"{\") return cont(commasep(exportField, \"}\"), maybeFrom, expect(\";\"));\n    return pass(statement);\n  }\n  function exportField(type, value) {\n    if (value == \"as\") { cx.marked = \"keyword\"; return cont(expect(\"variable\")); }\n    if (type == \"variable\") return pass(expressionNoComma, exportField);\n  }\n  function afterImport(type) {\n    if (type == \"string\") return cont();\n    return pass(importSpec, maybeMoreImports, maybeFrom);\n  }\n  function importSpec(type, value) {\n    if (type == \"{\") return contCommasep(importSpec, \"}\");\n    if (type == \"variable\") register(value);\n    if (value == \"*\") cx.marked = \"keyword\";\n    return cont(maybeAs);\n  }\n  function maybeMoreImports(type) {\n    if (type == \",\") return cont(importSpec, maybeMoreImports)\n  }\n  function maybeAs(_type, value) {\n    if (value == \"as\") { cx.marked = \"keyword\"; return cont(importSpec); }\n  }\n  function maybeFrom(_type, value) {\n    if (value == \"from\") { cx.marked = \"keyword\"; return cont(expression); }\n  }\n  function arrayLiteral(type) {\n    if (type == \"]\") return cont();\n    return pass(commasep(expressionNoComma, \"]\"));\n  }\n\n  function isContinuedStatement(state, textAfter) {\n    return state.lastType == \"operator\" || state.lastType == \",\" ||\n      isOperatorChar.test(textAfter.charAt(0)) ||\n      /[,.]/.test(textAfter.charAt(0));\n  }\n\n  function expressionAllowed(stream, state, backUp) {\n    return state.tokenize == tokenBase &&\n      /^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\\[{}\\(,;:]|=>)$/.test(state.lastType) ||\n      (state.lastType == \"quasi\" && /\\{\\s*$/.test(stream.string.slice(0, stream.pos - (backUp || 0))))\n  }\n\n  // Interface\n\n  return {\n    startState: function(basecolumn) {\n      var state = {\n        tokenize: tokenBase,\n        lastType: \"sof\",\n        cc: [],\n        lexical: new JSLexical((basecolumn || 0) - indentUnit, 0, \"block\", false),\n        localVars: parserConfig.localVars,\n        context: parserConfig.localVars && {vars: parserConfig.localVars},\n        indented: basecolumn || 0\n      };\n      if (parserConfig.globalVars && typeof parserConfig.globalVars == \"object\")\n        state.globalVars = parserConfig.globalVars;\n      return state;\n    },\n\n    token: function(stream, state) {\n      if (stream.sol()) {\n        if (!state.lexical.hasOwnProperty(\"align\"))\n          state.lexical.align = false;\n        state.indented = stream.indentation();\n        findFatArrow(stream, state);\n      }\n      if (state.tokenize != tokenComment && stream.eatSpace()) return null;\n      var style = state.tokenize(stream, state);\n      if (type == \"comment\") return style;\n      state.lastType = type == \"operator\" && (content == \"++\" || content == \"--\") ? \"incdec\" : type;\n      return parseJS(state, style, type, content, stream);\n    },\n\n    indent: function(state, textAfter) {\n      if (state.tokenize == tokenComment) return CodeMirror.Pass;\n      if (state.tokenize != tokenBase) return 0;\n      var firstChar = textAfter && textAfter.charAt(0), lexical = state.lexical, top\n      // Kludge to prevent 'maybelse' from blocking lexical scope pops\n      if (!/^\\s*else\\b/.test(textAfter)) for (var i = state.cc.length - 1; i >= 0; --i) {\n        var c = state.cc[i];\n        if (c == poplex) lexical = lexical.prev;\n        else if (c != maybeelse) break;\n      }\n      while ((lexical.type == \"stat\" || lexical.type == \"form\") &&\n             (firstChar == \"}\" || ((top = state.cc[state.cc.length - 1]) &&\n                                   (top == maybeoperatorComma || top == maybeoperatorNoComma) &&\n                                   !/^[,\\.=+\\-*:?[\\(]/.test(textAfter))))\n        lexical = lexical.prev;\n      if (statementIndent && lexical.type == \")\" && lexical.prev.type == \"stat\")\n        lexical = lexical.prev;\n      var type = lexical.type, closing = firstChar == type;\n\n      if (type == \"vardef\") return lexical.indented + (state.lastType == \"operator\" || state.lastType == \",\" ? lexical.info + 1 : 0);\n      else if (type == \"form\" && firstChar == \"{\") return lexical.indented;\n      else if (type == \"form\") return lexical.indented + indentUnit;\n      else if (type == \"stat\")\n        return lexical.indented + (isContinuedStatement(state, textAfter) ? statementIndent || indentUnit : 0);\n      else if (lexical.info == \"switch\" && !closing && parserConfig.doubleIndentSwitch != false)\n        return lexical.indented + (/^(?:case|default)\\b/.test(textAfter) ? indentUnit : 2 * indentUnit);\n      else if (lexical.align) return lexical.column + (closing ? 0 : 1);\n      else return lexical.indented + (closing ? 0 : indentUnit);\n    },\n\n    electricInput: /^\\s*(?:case .*?:|default:|\\{|\\})$/,\n    blockCommentStart: jsonMode ? null : \"/*\",\n    blockCommentEnd: jsonMode ? null : \"*/\",\n    blockCommentContinue: jsonMode ? null : \" * \",\n    lineComment: jsonMode ? null : \"//\",\n    fold: \"brace\",\n    closeBrackets: \"()[]{}''\\\"\\\"``\",\n\n    helperType: jsonMode ? \"json\" : \"javascript\",\n    jsonldMode: jsonldMode,\n    jsonMode: jsonMode,\n\n    expressionAllowed: expressionAllowed,\n\n    skipExpression: function(state) {\n      var top = state.cc[state.cc.length - 1]\n      if (top == expression || top == expressionNoComma) state.cc.pop()\n    }\n  };\n});\n\nCodeMirror.registerHelper(\"wordChars\", \"javascript\", /[\\w$]/);\n\nCodeMirror.defineMIME(\"text/javascript\", \"javascript\");\nCodeMirror.defineMIME(\"text/ecmascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/javascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/x-javascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/ecmascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/json\", {name: \"javascript\", json: true});\nCodeMirror.defineMIME(\"application/x-json\", {name: \"javascript\", json: true});\nCodeMirror.defineMIME(\"application/ld+json\", {name: \"javascript\", jsonld: true});\nCodeMirror.defineMIME(\"text/typescript\", { name: \"javascript\", typescript: true });\nCodeMirror.defineMIME(\"application/typescript\", { name: \"javascript\", typescript: true });\n\n});\n","import * as React from 'react'\nimport * as Path from 'path'\n\nimport { Repository } from '../../models/repository'\nimport { openFile } from '../../lib/open-file'\nimport { Dispatcher } from '../../lib/dispatcher/dispatcher'\n\nimport { LinkButton } from '../lib/link-button'\n\ninterface IBinaryFileProps {\n  readonly repository: Repository\n  readonly path: string\n  readonly dispatcher: Dispatcher\n}\n\n/** represents the default view for a file that we cannot render a diff for */\nexport class BinaryFile extends React.Component<IBinaryFileProps, {}> {\n  private open = () => {\n    const fullPath = Path.join(this.props.repository.path, this.props.path)\n    openFile(fullPath, this.props.dispatcher)\n  }\n\n  public render() {\n    return (\n      <div className=\"panel binary\" id=\"diff\">\n        <div className=\"image-header\">This binary file has changed.</div>\n        <div className=\"image-header\">\n          <LinkButton onClick={this.open}>\n            Open file in external program.\n          </LinkButton>\n        </div>\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\n\nimport { Image } from '../../../models/diff'\nimport { ImageContainer } from './image-container'\n\ninterface IDeletedImageDiffProps {\n  readonly previous: Image\n}\n\n/** A component to render when the file has been deleted from the repository */\nexport class DeletedImageDiff extends React.Component<\n  IDeletedImageDiffProps,\n  {}\n> {\n  public render() {\n    return (\n      <div className=\"panel image\" id=\"diff\">\n        <div className=\"image-diff-previous\">\n          <div className=\"image-diff-header\">Deleted</div>\n          <ImageContainer image={this.props.previous} />\n        </div>\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\n\nimport { Image } from '../../../models/diff'\nimport { ImageContainer } from './image-container'\n\ninterface INewImageDiffProps {\n  readonly current: Image\n}\n\n/** A component to render when a new image has been added to the repository */\nexport class NewImageDiff extends React.Component<INewImageDiffProps, {}> {\n  public render() {\n    return (\n      <div className=\"panel image\" id=\"diff\">\n        <div className=\"image-diff-current\">\n          <div className=\"image-diff-header\">Added</div>\n          <ImageContainer image={this.props.current} />\n        </div>\n      </div>\n    )\n  }\n}\n","export interface ISize {\n  readonly width: number\n  readonly height: number\n}\n\n/**\n * Get the size which fits in the container without scaling and maintaining\n * aspect ratio.\n */\nexport function getAspectFitSize(\n  imageSize: ISize,\n  containerSize: ISize\n): ISize {\n  const heightRatio =\n    containerSize.height < imageSize.height\n      ? imageSize.height / containerSize.height\n      : 1\n  const widthRatio =\n    containerSize.width < imageSize.width\n      ? imageSize.width / containerSize.width\n      : 1\n\n  let ratio = Math.max(1, widthRatio)\n  if (widthRatio < heightRatio) {\n    ratio = Math.max(1, heightRatio)\n  }\n\n  return {\n    width: imageSize.width / ratio,\n    height: imageSize.height / ratio,\n  }\n}\n\n/**\n * Get the size which will fit the bigger of the two images while maintaining\n * aspect ratio.\n */\nexport function getMaxFitSize(\n  previousImageSize: ISize,\n  currentImageSize: ISize,\n  containerSize: ISize\n): ISize {\n  const previousSize = getAspectFitSize(previousImageSize, containerSize)\n  const currentSize = getAspectFitSize(currentImageSize, containerSize)\n\n  const width = Math.max(previousSize.width, currentSize.width)\n  const height = Math.max(previousSize.height, currentSize.height)\n  return { width, height }\n}\n","import * as React from 'react'\nimport { ICommonImageDiffProperties } from './modified-image-diff'\nimport { ImageContainer } from './image-container'\n\n/** How much bigger the slider should be than the images. */\nconst SliderOverflow = 14\n\ninterface ISwipeState {\n  readonly percentage: number\n}\n\nexport class Swipe extends React.Component<\n  ICommonImageDiffProperties,\n  ISwipeState\n> {\n  public constructor(props: ICommonImageDiffProperties) {\n    super(props)\n\n    this.state = { percentage: 1 }\n  }\n\n  public render() {\n    const style: React.CSSProperties = {\n      height: this.props.maxSize.height,\n      width: this.props.maxSize.width,\n    }\n\n    const maxSize: React.CSSProperties = {\n      maxHeight: this.props.maxSize.height,\n      maxWidth: this.props.maxSize.width,\n    }\n\n    return (\n      <div className=\"image-diff-swipe\">\n        <div className=\"sizing-container\" ref={this.props.onContainerRef}>\n          <div className=\"image-container\" style={style}>\n            <div className=\"image-diff-current\" style={style}>\n              <ImageContainer\n                image={this.props.current}\n                onElementLoad={this.props.onCurrentImageLoad}\n                style={maxSize}\n              />\n            </div>\n            <div\n              className=\"swiper\"\n              style={{\n                width: this.props.maxSize.width * (1 - this.state.percentage),\n                height: this.props.maxSize.height,\n              }}\n            >\n              <div className=\"image-diff-previous\" style={style}>\n                <ImageContainer\n                  image={this.props.previous}\n                  onElementLoad={this.props.onPreviousImageLoad}\n                  style={maxSize}\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n        <input\n          style={{\n            width: this.props.maxSize.width + SliderOverflow,\n          }}\n          className=\"slider\"\n          type=\"range\"\n          max={1}\n          min={0}\n          value={this.state.percentage}\n          step={0.001}\n          onChange={this.onValueChange}\n        />\n      </div>\n    )\n  }\n\n  private onValueChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const percentage = e.currentTarget.valueAsNumber\n    this.setState({ percentage })\n  }\n}\n","import * as React from 'react'\nimport { ICommonImageDiffProperties } from './modified-image-diff'\nimport { ImageContainer } from './image-container'\n\ninterface IOnionSkinState {\n  readonly crossfade: number\n}\n\nexport class OnionSkin extends React.Component<\n  ICommonImageDiffProperties,\n  IOnionSkinState\n> {\n  public constructor(props: ICommonImageDiffProperties) {\n    super(props)\n\n    this.state = { crossfade: 1 }\n  }\n\n  public render() {\n    const style: React.CSSProperties = {\n      height: this.props.maxSize.height,\n      width: this.props.maxSize.width,\n    }\n\n    const maxSize: React.CSSProperties = {\n      maxHeight: this.props.maxSize.height,\n      maxWidth: this.props.maxSize.width,\n    }\n\n    return (\n      <div className=\"image-diff-onion-skin\">\n        <div className=\"sizing-container\" ref={this.props.onContainerRef}>\n          <div className=\"image-container\" style={style}>\n            <div className=\"image-diff-previous\" style={style}>\n              <ImageContainer\n                image={this.props.previous}\n                onElementLoad={this.props.onPreviousImageLoad}\n                style={maxSize}\n              />\n            </div>\n\n            <div\n              className=\"image-diff-current\"\n              style={{\n                ...style,\n                opacity: this.state.crossfade,\n              }}\n            >\n              <ImageContainer\n                image={this.props.current}\n                onElementLoad={this.props.onCurrentImageLoad}\n                style={maxSize}\n              />\n            </div>\n          </div>\n        </div>\n\n        <input\n          style={{\n            width: this.props.maxSize.width / 2,\n          }}\n          className=\"slider\"\n          type=\"range\"\n          max={1}\n          min={0}\n          value={this.state.crossfade}\n          step={0.001}\n          onChange={this.onValueChange}\n        />\n      </div>\n    )\n  }\n\n  private onValueChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({ crossfade: e.currentTarget.valueAsNumber })\n  }\n}\n","import * as React from 'react'\nimport { ImageContainer } from './image-container'\nimport { ICommonImageDiffProperties } from './modified-image-diff'\n\nexport class DifferenceBlend extends React.Component<\n  ICommonImageDiffProperties,\n  {}\n> {\n  public render() {\n    const style: React.CSSProperties = {\n      height: this.props.maxSize.height,\n      width: this.props.maxSize.width,\n    }\n\n    const maxSize: React.CSSProperties = {\n      maxHeight: this.props.maxSize.height,\n      maxWidth: this.props.maxSize.width,\n    }\n\n    return (\n      <div className=\"image-diff-difference\" ref={this.props.onContainerRef}>\n        <div className=\"sizing-container\">\n          <div className=\"image-container\" style={style}>\n            <div className=\"image-diff-previous\">\n              <ImageContainer\n                image={this.props.previous}\n                onElementLoad={this.props.onPreviousImageLoad}\n                style={maxSize}\n              />\n            </div>\n\n            <div className=\"image-diff-current\">\n              <ImageContainer\n                image={this.props.current}\n                onElementLoad={this.props.onCurrentImageLoad}\n                style={{\n                  ...maxSize,\n                  mixBlendMode: 'difference',\n                }}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n","/**\n * Number sign display mode\n */\nexport const enum Sign {\n  Normal,\n  Forced,\n}\n\n/**\n * Display bytes in human readable format like:\n *    23GB\n *   -43B\n * It's also possible to force sign in order to get the\n * plus sign in case of positive numbers like:\n *   +23GB\n *   -43B\n */\nexport const formatBytes = (bytes: number, signType: Sign = Sign.Normal) => {\n  if (!Number.isFinite(bytes)) {\n    return 'Unknown'\n  }\n  const sizes = ['B', 'KB', 'MB', 'GB', 'TB', 'PB']\n  const sizeIndex = Math.floor(Math.log(Math.abs(bytes)) / Math.log(1024))\n  const sign = signType === Sign.Forced && bytes > 0 ? '+' : ''\n  const value = Math.round(bytes / Math.pow(1024, sizeIndex))\n  return `${sign}${value}${sizes[sizeIndex]}`\n}\n","import * as React from 'react'\nimport { ImageContainer } from './image-container'\nimport { ICommonImageDiffProperties } from './modified-image-diff'\nimport { ISize } from './sizing'\nimport { formatBytes, Sign } from '../../lib/bytes'\nimport * as classNames from 'classnames'\n\n/**\n * The height of the Deleted/Added labels at the top and the image dimension\n * labels.\n */\nconst ControlsHeight = 60\n\nconst XPadding = 20\n\ninterface ITwoUpProps extends ICommonImageDiffProperties {\n  readonly containerWidth: number\n\n  readonly previousImageSize: ISize | null\n  readonly currentImageSize: ISize | null\n}\n\nexport class TwoUp extends React.Component<ITwoUpProps, {}> {\n  public render() {\n    const style: React.CSSProperties = {\n      maxWidth: Math.min(\n        (this.props.containerWidth - XPadding) / 2,\n        this.props.maxSize.width\n      ),\n      maxHeight: this.props.maxSize.height - ControlsHeight,\n    }\n    const percentDiff = (previous: number, current: number) => {\n      const diff = Math.round((100 * (current - previous)) / previous)\n      const sign = diff > 0 ? '+' : ''\n      return sign + diff + '%'\n    }\n\n    const zeroSize = { width: 0, height: 0 }\n    const previousImageSize = this.props.previousImageSize || zeroSize\n    const currentImageSize = this.props.currentImageSize || zeroSize\n    const diffPercent = percentDiff(\n      this.props.previous.bytes,\n      this.props.current.bytes\n    )\n    const diffBytes = this.props.current.bytes - this.props.previous.bytes\n\n    return (\n      <div className=\"image-diff-container\" ref={this.props.onContainerRef}>\n        <div className=\"image-diff-two-up\">\n          <div className=\"image-diff-previous\">\n            <div className=\"image-diff-header\">Deleted</div>\n            <ImageContainer\n              image={this.props.previous}\n              onElementLoad={this.props.onPreviousImageLoad}\n              style={style}\n            />\n\n            <div className=\"image-diff-footer\">\n              <span className=\"strong\">W:</span> {previousImageSize.width}\n              px | <span className=\"strong\">H:</span> {previousImageSize.height}\n              px | <span className=\"strong\">Size:</span>{' '}\n              {formatBytes(this.props.previous.bytes)}\n            </div>\n          </div>\n\n          <div className=\"image-diff-current\">\n            <div className=\"image-diff-header\">Added</div>\n            <ImageContainer\n              image={this.props.current}\n              onElementLoad={this.props.onCurrentImageLoad}\n              style={style}\n            />\n\n            <div className=\"image-diff-footer\">\n              <span className=\"strong\">W:</span> {currentImageSize.width}\n              px | <span className=\"strong\">H:</span> {currentImageSize.height}\n              px | <span className=\"strong\">Size:</span>{' '}\n              {formatBytes(this.props.current.bytes)}\n            </div>\n          </div>\n        </div>\n        <div className=\"image-diff-summary\">\n          Diff:{' '}\n          <span\n            className={classNames({\n              added: diffBytes > 0,\n              removed: diffBytes < 0,\n            })}\n          >\n            {diffBytes !== 0\n              ? `${formatBytes(diffBytes, Sign.Forced)} (${diffPercent})`\n              : 'No size difference'}\n          </span>\n        </div>\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\n\nimport { ImageDiffType } from '../../../lib/app-state'\nimport { Image } from '../../../models/diff'\nimport { TabBar, TabBarType } from '../../tab-bar'\nimport { TwoUp } from './two-up'\nimport { DifferenceBlend } from './difference-blend'\nimport { OnionSkin } from './onion-skin'\nimport { Swipe } from './swipe'\nimport { assertNever } from '../../../lib/fatal-error'\nimport { ISize, getMaxFitSize } from './sizing'\n\ninterface IModifiedImageDiffProps {\n  readonly previous: Image\n  readonly current: Image\n  readonly diffType: ImageDiffType\n  readonly onChangeDiffType: (type: ImageDiffType) => void\n}\n\nexport interface ICommonImageDiffProperties {\n  /** The biggest size to fit both the previous and current images. */\n  readonly maxSize: ISize\n\n  /** The previous image. */\n  readonly previous: Image\n\n  /** The current image. */\n  readonly current: Image\n\n  /** A function to call when the previous image has loaded. */\n  readonly onPreviousImageLoad: (img: HTMLImageElement) => void\n\n  /** A function to call when the current image has loaded. */\n  readonly onCurrentImageLoad: (img: HTMLImageElement) => void\n\n  /**\n   * A function to call which provides the element that will contain the\n   * images. This container element is used to measure the available space for\n   * the images, which is then used to calculate the aspect fit size.\n   */\n  readonly onContainerRef: (e: HTMLElement | null) => void\n}\n\ninterface IModifiedImageDiffState {\n  /** The size of the previous image. */\n  readonly previousImageSize: ISize | null\n\n  /** The size of the current image. */\n  readonly currentImageSize: ISize | null\n\n  /** The size of the container element. */\n  readonly containerSize: ISize | null\n}\n\n/** A component which renders the changes to an image in the repository */\nexport class ModifiedImageDiff extends React.Component<\n  IModifiedImageDiffProps,\n  IModifiedImageDiffState\n> {\n  private container: HTMLElement | null = null\n\n  private readonly resizeObserver: ResizeObserver\n  private resizedTimeoutID: number | null = null\n\n  public constructor(props: IModifiedImageDiffProps) {\n    super(props)\n\n    this.resizeObserver = new ResizeObserver(entries => {\n      for (const entry of entries) {\n        if (entry.target === this.container) {\n          // We might end up causing a recursive update by updating the state\n          // when we're reacting to a resize so we'll defer it until after\n          // react is done with this frame.\n          if (this.resizedTimeoutID !== null) {\n            clearImmediate(this.resizedTimeoutID)\n          }\n\n          this.resizedTimeoutID = setImmediate(\n            this.onResized,\n            entry.target,\n            entry.contentRect\n          )\n        }\n      }\n    })\n\n    this.state = {\n      previousImageSize: null,\n      currentImageSize: null,\n      containerSize: null,\n    }\n  }\n\n  private onPreviousImageLoad = (img: HTMLImageElement) => {\n    const size = { width: img.naturalWidth, height: img.naturalHeight }\n    this.setState({ previousImageSize: size })\n  }\n\n  private onCurrentImageLoad = (img: HTMLImageElement) => {\n    const size = { width: img.naturalWidth, height: img.naturalHeight }\n    this.setState({ currentImageSize: size })\n  }\n\n  private onResized = (target: HTMLElement, contentRect: ClientRect) => {\n    this.resizedTimeoutID = null\n\n    const containerSize = {\n      width: contentRect.width,\n      height: contentRect.height,\n    }\n    this.setState({ containerSize })\n  }\n\n  private getMaxSize(): ISize {\n    const zeroSize = { width: 0, height: 0, containerWidth: 0 }\n    const containerSize = this.state.containerSize\n    if (!containerSize) {\n      return zeroSize\n    }\n\n    const { previousImageSize, currentImageSize } = this.state\n    if (!previousImageSize || !currentImageSize) {\n      return zeroSize\n    }\n\n    const maxFitSize = getMaxFitSize(\n      previousImageSize,\n      currentImageSize,\n      containerSize\n    )\n\n    return maxFitSize\n  }\n\n  private onContainerRef = (c: HTMLElement | null) => {\n    this.container = c\n\n    this.resizeObserver.disconnect()\n\n    if (c) {\n      this.resizeObserver.observe(c)\n    }\n  }\n\n  public render() {\n    return (\n      <div className=\"panel image\" id=\"diff\">\n        {this.renderCurrentDiffType()}\n\n        <TabBar\n          selectedIndex={this.props.diffType}\n          onTabClicked={this.props.onChangeDiffType}\n          type={TabBarType.Switch}\n        >\n          <span>2-up</span>\n          <span>Swipe</span>\n          <span>Onion Skin</span>\n          <span>Difference</span>\n        </TabBar>\n      </div>\n    )\n  }\n\n  private renderCurrentDiffType() {\n    const maxSize = this.getMaxSize()\n    const type = this.props.diffType\n    switch (type) {\n      case ImageDiffType.TwoUp:\n        return (\n          <TwoUp\n            {...this.getCommonProps(maxSize)}\n            containerWidth={\n              (this.state.containerSize && this.state.containerSize.width) || 0\n            }\n            previousImageSize={this.state.previousImageSize}\n            currentImageSize={this.state.currentImageSize}\n          />\n        )\n\n      case ImageDiffType.Swipe:\n        return <Swipe {...this.getCommonProps(maxSize)} />\n\n      case ImageDiffType.OnionSkin:\n        return <OnionSkin {...this.getCommonProps(maxSize)} />\n\n      case ImageDiffType.Difference:\n        return <DifferenceBlend {...this.getCommonProps(maxSize)} />\n\n      default:\n        return assertNever(type, `Unknown diff type: ${type}`)\n    }\n  }\n\n  private getCommonProps(maxSize: ISize): ICommonImageDiffProperties {\n    return {\n      maxSize,\n      previous: this.props.previous,\n      current: this.props.current,\n      onPreviousImageLoad: this.onPreviousImageLoad,\n      onCurrentImageLoad: this.onCurrentImageLoad,\n      onContainerRef: this.onContainerRef,\n    }\n  }\n}\n","export { ModifiedImageDiff } from './modified-image-diff'\nexport { NewImageDiff } from './new-image-diff'\nexport { DeletedImageDiff } from './deleted-image-diff'\n","import * as React from 'react'\nimport { Diff } from '../diff'\nimport { ChangedFileDetails } from './changed-file-details'\nimport { ImageDiffType } from '../../lib/app-state'\nimport { DiffSelection, IDiff } from '../../models/diff'\nimport { WorkingDirectoryFileChange } from '../../models/status'\nimport { Repository } from '../../models/repository'\nimport { Dispatcher } from '../../lib/dispatcher'\n\ninterface IChangesProps {\n  readonly repository: Repository\n  readonly file: WorkingDirectoryFileChange\n  readonly diff: IDiff\n  readonly dispatcher: Dispatcher\n  readonly imageDiffType: ImageDiffType\n}\n\nexport class Changes extends React.Component<IChangesProps, {}> {\n  private onDiffLineIncludeChanged = (diffSelection: DiffSelection) => {\n    const file = this.props.file\n    this.props.dispatcher.changeFileLineSelection(\n      this.props.repository,\n      file,\n      diffSelection\n    )\n  }\n\n  public render() {\n    const diff = this.props.diff\n    const file = this.props.file\n    return (\n      <div className=\"changed-file\">\n        <ChangedFileDetails\n          path={file.path}\n          oldPath={file.oldPath}\n          status={file.status}\n          diff={diff}\n          onOpenMergeTool={this.onOpenMergeTool}\n        />\n\n        <div className=\"diff-wrapper\">\n          <Diff\n            repository={this.props.repository}\n            imageDiffType={this.props.imageDiffType}\n            file={file}\n            readOnly={false}\n            onIncludeChanged={this.onDiffLineIncludeChanged}\n            diff={diff}\n            dispatcher={this.props.dispatcher}\n          />\n        </div>\n      </div>\n    )\n  }\n\n  private onOpenMergeTool = (path: string) => {\n    this.props.dispatcher.openMergeTool(this.props.repository, path)\n  }\n}\n","import { Repository } from '../models/repository'\nimport { GitHubRepository } from '../models/github-repository'\nimport { getHTMLURL } from './api'\n\nexport enum TokenType {\n  /*\n   * A token that should be rendered as-is, without any formatting.\n   */\n  Text,\n  /*\n   * A token representing an emoji character - should be replaced with an image.\n   */\n  Emoji,\n  /*\n   * A token representing a generic link - should be drawn as a hyperlink\n   * to launch the browser.\n   */\n  Link,\n}\n\nexport type EmojiMatch = {\n  readonly kind: TokenType.Emoji\n  // The alternate text to display with the image, e.g. ':+1:'\n  readonly text: string\n  // The path on disk to the image.\n  readonly path: string\n}\n\nexport type HyperlinkMatch = {\n  readonly kind: TokenType.Link\n  // The text to display inside the rendered link, e.g. @shiftkey\n  readonly text: string\n  // The URL to launch when clicking on the link\n  readonly url: string\n}\n\nexport type PlainText = {\n  readonly kind: TokenType.Text\n  // The text to render.\n  readonly text: string\n}\n\nexport type TokenResult = PlainText | EmojiMatch | HyperlinkMatch\n\ntype LookupResult = {\n  nextIndex: number\n}\n\n/**\n * A look-ahead tokenizer designed for scanning commit messages for emoji, issues, mentions and links.\n */\nexport class Tokenizer {\n  private readonly emoji: Map<string, string>\n  private readonly repository: GitHubRepository | null = null\n\n  private _results = new Array<TokenResult>()\n  private _currentString = ''\n\n  public constructor(emoji: Map<string, string>, repository?: Repository) {\n    this.emoji = emoji\n\n    if (repository) {\n      this.repository = repository.gitHubRepository\n    }\n  }\n\n  private reset() {\n    this._results = new Array<TokenResult>()\n    this._currentString = ''\n  }\n\n  private append(character: string) {\n    this._currentString += character\n  }\n\n  private flush() {\n    if (this._currentString.length) {\n      this._results.push({ kind: TokenType.Text, text: this._currentString })\n      this._currentString = ''\n    }\n  }\n\n  private getLastProcessedChar(): string | null {\n    if (this._currentString.length) {\n      return this._currentString[this._currentString.length - 1]\n    }\n    return null\n  }\n\n  private scanForEndOfWord(text: string, index: number): number {\n    const indexOfNextNewline = text.indexOf('\\n', index + 1)\n    const indexOfNextSpace = text.indexOf(' ', index + 1)\n\n    if (indexOfNextNewline > -1 && indexOfNextSpace > -1) {\n      // if we find whitespace and a newline, take whichever is closest\n      return Math.min(indexOfNextNewline, indexOfNextSpace)\n    }\n\n    // favouring newlines over whitespace here because people often like to\n    // use mentions or issues at the end of a sentence.\n    if (indexOfNextNewline > -1) {\n      return indexOfNextNewline\n    }\n    if (indexOfNextSpace > -1) {\n      return indexOfNextSpace\n    }\n\n    // as a fallback use the entire remaining string\n    return text.length\n  }\n\n  private scanForEmoji(text: string, index: number): LookupResult | null {\n    const nextIndex = this.scanForEndOfWord(text, index)\n    const maybeEmoji = text.slice(index, nextIndex)\n    if (!/^:.*?:$/.test(maybeEmoji)) {\n      return null\n    }\n\n    const path = this.emoji.get(maybeEmoji)\n    if (!path) {\n      return null\n    }\n\n    this.flush()\n    this._results.push({ kind: TokenType.Emoji, text: maybeEmoji, path })\n    return { nextIndex }\n  }\n\n  private scanForIssue(\n    text: string,\n    index: number,\n    repository: GitHubRepository\n  ): LookupResult | null {\n    let nextIndex = this.scanForEndOfWord(text, index)\n    let maybeIssue = text.slice(index, nextIndex)\n\n    // handle situation where issue reference is wrapped in parentheses\n    // like the generated \"squash and merge\" commits on GitHub\n    if (maybeIssue.endsWith(')')) {\n      nextIndex -= 1\n      maybeIssue = text.slice(index, nextIndex)\n    }\n\n    // release notes may add a full stop as part of formatting the entry\n    if (maybeIssue.endsWith('.')) {\n      nextIndex -= 1\n      maybeIssue = text.slice(index, nextIndex)\n    }\n\n    if (!/^#\\d+$/.test(maybeIssue)) {\n      return null\n    }\n\n    this.flush()\n    const id = parseInt(maybeIssue.substr(1), 10)\n    if (isNaN(id)) {\n      return null\n    }\n\n    const url = `${repository.htmlURL}/issues/${id}`\n    this._results.push({ kind: TokenType.Link, text: maybeIssue, url })\n    return { nextIndex }\n  }\n\n  private scanForMention(\n    text: string,\n    index: number,\n    repository: GitHubRepository\n  ): LookupResult | null {\n    // to ensure this isn't part of an email address, peek at the previous\n    // character - if something is found and it's not whitespace, bail out\n    const lastItem = this.getLastProcessedChar()\n    if (lastItem && lastItem !== ' ') {\n      return null\n    }\n\n    let nextIndex = this.scanForEndOfWord(text, index)\n    let maybeMention = text.slice(index, nextIndex)\n\n    // release notes add a ! to the very last user, or use , to separate users\n    if (maybeMention.endsWith('!') || maybeMention.endsWith(',')) {\n      nextIndex -= 1\n      maybeMention = text.slice(index, nextIndex)\n    }\n\n    if (!/^@[a-zA-Z0-9\\-]+$/.test(maybeMention)) {\n      return null\n    }\n\n    this.flush()\n    const name = maybeMention.substr(1)\n    const url = `${getHTMLURL(repository.endpoint)}/${name}`\n    this._results.push({ kind: TokenType.Link, text: maybeMention, url })\n    return { nextIndex }\n  }\n\n  private scanForHyperlink(\n    text: string,\n    index: number,\n    repository?: GitHubRepository\n  ): LookupResult | null {\n    // to ensure this isn't just the part of some word - if something is\n    // found and it's not whitespace, bail out\n    const lastItem = this.getLastProcessedChar()\n    if (lastItem && lastItem !== ' ') {\n      return null\n    }\n\n    const nextIndex = this.scanForEndOfWord(text, index)\n    const maybeHyperlink = text.slice(index, nextIndex)\n    if (!/^https?:\\/\\/.+/.test(maybeHyperlink)) {\n      return null\n    }\n\n    this.flush()\n    if (repository && repository.htmlURL) {\n      // case-insensitive regex to see if this matches the issue URL template for the current repository\n      const compare = repository.htmlURL.toLowerCase()\n      if (maybeHyperlink.toLowerCase().startsWith(`${compare}/issues/`)) {\n        const issueMatch = /\\/issues\\/(\\d+)/.exec(maybeHyperlink)\n        if (issueMatch) {\n          const idText = issueMatch[1]\n          this._results.push({\n            kind: TokenType.Link,\n            url: maybeHyperlink,\n            text: `#${idText}`,\n          })\n          return { nextIndex }\n        }\n      }\n    }\n\n    // just render a hyperlink with the full URL\n    this._results.push({\n      kind: TokenType.Link,\n      url: maybeHyperlink,\n      text: maybeHyperlink,\n    })\n    return { nextIndex }\n  }\n\n  private inspectAndMove(\n    element: string,\n    index: number,\n    callback: () => LookupResult | null\n  ): number {\n    const match = callback()\n    if (match) {\n      return match.nextIndex\n    } else {\n      this.append(element)\n      return index + 1\n    }\n  }\n\n  private tokenizeNonGitHubRepository(\n    text: string\n  ): ReadonlyArray<TokenResult> {\n    let i = 0\n    while (i < text.length) {\n      const element = text[i]\n      switch (element) {\n        case ':':\n          i = this.inspectAndMove(element, i, () => this.scanForEmoji(text, i))\n          break\n\n        case 'h':\n          i = this.inspectAndMove(element, i, () =>\n            this.scanForHyperlink(text, i)\n          )\n          break\n\n        default:\n          this.append(element)\n          i++\n          break\n      }\n    }\n\n    this.flush()\n    return this._results\n  }\n\n  private tokenizeGitHubRepository(\n    text: string,\n    repository: GitHubRepository\n  ): ReadonlyArray<TokenResult> {\n    let i = 0\n    while (i < text.length) {\n      const element = text[i]\n      switch (element) {\n        case ':':\n          i = this.inspectAndMove(element, i, () => this.scanForEmoji(text, i))\n          break\n\n        case '#':\n          i = this.inspectAndMove(element, i, () =>\n            this.scanForIssue(text, i, repository)\n          )\n          break\n\n        case '@':\n          i = this.inspectAndMove(element, i, () =>\n            this.scanForMention(text, i, repository)\n          )\n          break\n\n        case 'h':\n          i = this.inspectAndMove(element, i, () =>\n            this.scanForHyperlink(text, i, repository)\n          )\n          break\n\n        default:\n          this.append(element)\n          i++\n          break\n      }\n    }\n\n    this.flush()\n    return this._results\n  }\n\n  /**\n   * Scan the string for tokens that match with entities an application\n   * might be interested in.\n   *\n   * @returns an array of tokens representing the scan results.\n   */\n  public tokenize(text: string): ReadonlyArray<TokenResult> {\n    this.reset()\n\n    if (this.repository) {\n      return this.tokenizeGitHubRepository(text, this.repository)\n    } else {\n      return this.tokenizeNonGitHubRepository(text)\n    }\n  }\n}\n","import * as React from 'react'\n\nimport { Commit } from '../../models/commit'\nimport { RichText } from '../lib/rich-text'\nimport { RelativeTime } from '../relative-time'\nimport { Button } from '../lib/button'\n\ninterface IUndoCommitProps {\n  /** The function to call when the Undo button is clicked. */\n  readonly onUndo: () => void\n\n  /** The commit to undo. */\n  readonly commit: Commit\n\n  /** The emoji cache to use when rendering the commit message */\n  readonly emoji: Map<string, string>\n\n  /** whether a push, pull or fetch is in progress */\n  readonly isPushPullFetchInProgress: boolean\n}\n\n/** The Undo Commit component. */\nexport class UndoCommit extends React.Component<IUndoCommitProps, {}> {\n  public render() {\n    const disabled = this.props.isPushPullFetchInProgress\n    const title = disabled\n      ? 'Undo is disabled while the repository is being updated'\n      : undefined\n\n    const authorDate = this.props.commit.author.date\n    return (\n      <div id=\"undo-commit\" role=\"group\" aria-label=\"Undo commit\">\n        <div className=\"commit-info\">\n          <div className=\"ago\">\n            Committed <RelativeTime date={authorDate} />\n          </div>\n          <RichText\n            emoji={this.props.emoji}\n            className=\"summary\"\n            text={this.props.commit.summary}\n            renderUrlsAsLinks={false}\n          />\n        </div>\n        <div className=\"actions\" title={title}>\n          <Button size=\"small\" disabled={disabled} onClick={this.props.onUndo}>\n            Undo\n          </Button>\n        </div>\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\n\nimport { AppFileStatus, mapStatus, iconForStatus } from '../../models/status'\nimport { PathLabel } from '../lib/path-label'\nimport { Octicon } from '../octicons'\nimport { Checkbox, CheckboxValue } from '../lib/checkbox'\n\ninterface IChangedFileProps {\n  readonly id: string\n  readonly path: string\n  readonly status: AppFileStatus\n  readonly oldPath?: string\n  readonly include: boolean | null\n  readonly availableWidth: number\n  readonly disableSelection: boolean\n  readonly onIncludeChanged: (path: string, include: boolean) => void\n\n  /** Callback called when user right-clicks on an item */\n  readonly onContextMenu: (\n    id: string,\n    path: string,\n    status: AppFileStatus,\n    event: React.MouseEvent<HTMLDivElement>\n  ) => void\n}\n\n/** a changed file in the working directory for a given repository */\nexport class ChangedFile extends React.Component<IChangedFileProps, {}> {\n  private handleCheckboxChange = (event: React.FormEvent<HTMLInputElement>) => {\n    const include = event.currentTarget.checked\n    this.props.onIncludeChanged(this.props.path, include)\n  }\n\n  private get checkboxValue(): CheckboxValue {\n    if (this.props.include === true) {\n      return CheckboxValue.On\n    } else if (this.props.include === false) {\n      return CheckboxValue.Off\n    } else {\n      return CheckboxValue.Mixed\n    }\n  }\n\n  public render() {\n    const status = this.props.status\n    const fileStatus = mapStatus(status)\n\n    const listItemPadding = 10 * 2\n    const checkboxWidth = 20\n    const statusWidth = 16\n    const filePadding = 5\n\n    const availablePathWidth =\n      this.props.availableWidth -\n      listItemPadding -\n      checkboxWidth -\n      filePadding -\n      statusWidth\n\n    return (\n      <div className=\"file\" onContextMenu={this.onContextMenu}>\n        <Checkbox\n          // The checkbox doesn't need to be tab reachable since we emulate\n          // checkbox behavior on the list item itself, ie hitting space bar\n          // while focused on a row will toggle selection.\n          tabIndex={-1}\n          value={this.checkboxValue}\n          onChange={this.handleCheckboxChange}\n          disabled={this.props.disableSelection}\n        />\n\n        <PathLabel\n          path={this.props.path}\n          oldPath={this.props.oldPath}\n          status={this.props.status}\n          availableWidth={availablePathWidth}\n        />\n\n        <Octicon\n          symbol={iconForStatus(status)}\n          className={'status status-' + fileStatus.toLowerCase()}\n          title={fileStatus}\n        />\n      </div>\n    )\n  }\n\n  private onContextMenu = (event: React.MouseEvent<HTMLDivElement>) => {\n    this.props.onContextMenu(\n      this.props.id,\n      this.props.path,\n      this.props.status,\n      event\n    )\n  }\n}\n","import * as React from 'react'\nimport * as CodeMirror from 'codemirror'\nimport * as URL from 'url'\nimport * as classNames from 'classnames'\nimport { UserAutocompletionProvider, IUserHit } from '../autocompletion'\nimport { Editor, Doc, Position } from 'codemirror'\nimport { getDotComAPIEndpoint } from '../../lib/api'\nimport { compare } from '../../lib/compare'\nimport { arrayEquals } from '../../lib/equality'\nimport { OcticonSymbol } from '../octicons'\nimport { IAuthor } from '../../models/author'\nimport { showContextualMenu } from '../main-process-proxy'\nimport { IMenuItem } from '../../lib/menu-item'\n\ninterface IAuthorInputProps {\n  /**\n   * An optional class name for the wrapper element around the\n   * author input component\n   */\n  readonly className?: string\n\n  /**\n   * The user autocomplete provider to use when searching for substring\n   * matches while autocompleting.\n   */\n  readonly autoCompleteProvider: UserAutocompletionProvider\n\n  /**\n   * The list of authors to fill the input with initially. If this\n   * prop changes from what's propagated through onAuthorsUpdated\n   * while the component is mounted it will reset, loosing\n   * any text that has not yet been resolved to an author.\n   */\n  readonly authors: ReadonlyArray<IAuthor>\n\n  /**\n   * A method called when authors has been added or removed from the\n   * input field.\n   */\n  readonly onAuthorsUpdated: (authors: ReadonlyArray<IAuthor>) => void\n\n  /**\n   * Whether or not the input should be read-only and styled as being\n   * disabled. When disabled the component will not accept focus.\n   */\n  readonly disabled: boolean\n}\n\n/**\n * Return the position previous to (i.e before) the given\n * position in a codemirror doc\n */\nfunction prevPosition(doc: Doc, pos: Position) {\n  return doc.posFromIndex(doc.indexFromPos(pos) - 1)\n}\n\n/**\n * Return the position next to (i.e after) the given\n * position in a codemirror doc\n */\nfunction nextPosition(doc: Doc, pos: Position) {\n  return doc.posFromIndex(doc.indexFromPos(pos) + 1)\n}\n\n/**\n * Gets a value indicating whether the given position is\n * _inside_ of an existing marker. Note that marker ranges\n * are inclusive and this method takes that into account.\n */\nfunction posIsInsideMarkedText(doc: Doc, pos: Position) {\n  const marks = (doc.findMarksAt(pos) as any) as ActualTextMarker[]\n  const ix = doc.indexFromPos(pos)\n\n  return marks.some(mark => {\n    const markPos = mark.find()\n\n    // This shouldn't ever happen since we just pulled them\n    // from the doc\n    if (!markPos) {\n      return false\n    }\n\n    const from = doc.indexFromPos(markPos.from)\n    const to = doc.indexFromPos(markPos.to)\n\n    return ix > from && ix < to\n  })\n}\n\nfunction isMarkOrWhitespace(doc: Doc, pos: Position) {\n  const line = doc.getLine(pos.line)\n  if (/\\s/.test(line.charAt(pos.ch))) {\n    return true\n  }\n\n  return posIsInsideMarkedText(doc, pos)\n}\n\nfunction posEquals(x: Position, y: Position) {\n  return x.line === y.line && x.ch === y.ch\n}\n\n/**\n * Scan through the doc, starting at the given start position and\n * moving using the iter function for as long as the predicate is\n * true or the iterator function fails to update the position (i.e\n * at the start or end of the document)\n *\n * @param doc       The codemirror document to scan through\n *\n * @param start     The initial position, note that this position is\n *                  not inclusive, i.e. the predicate will not be\n *                  called for the initial position\n *\n * @param predicate A function called with each position returned\n *                  from the iter function that determines whether\n *                  or not to keep scanning through the document.\n *\n *                  If the predicate returns true this function will\n *                  keep iterating.\n *\n * @param iter      A function that, given either the start position\n *                  or a position returned from the previous iter\n *                  call, returns the next position to scan.\n */\nfunction scanWhile(\n  doc: Doc,\n  start: Position,\n  predicate: (doc: Doc, pos: Position) => boolean,\n  iter: (doc: Doc, pos: Position) => Position\n) {\n  let pos = start\n\n  for (\n    let next = iter(doc, start);\n    predicate(doc, next) && !posEquals(pos, next);\n    next = iter(doc, next)\n  ) {\n    pos = next\n  }\n\n  return pos\n}\n\n/**\n * Scan through the doc, starting at the given start position and\n * moving using the iter function until the predicate returns\n * true or the iterator function fails to update the position (i.e\n * at the start or end of the document)\n *\n * @param doc       The codemirror document to scan through\n *\n * @param start     The initial position, note that this position is\n *                  not inclusive, i.e. the predicate will not be\n *                  called for the initial position\n *\n * @param predicate A function called with each position returned\n *                  from the iter function that determines whether\n *                  or not to keep scanning through the document.\n *\n *                  If the predicate returns false this function will\n *                  keep iterating.\n *\n * @param iter      A function that, given either the start position\n *                  or a position returned from the previous iter\n *                  call, returns the next position to scan.\n */\nfunction scanUntil(\n  doc: Doc,\n  start: Position,\n  predicate: (doc: Doc, pos: Position) => boolean,\n  iter: (doc: Doc, pos: Position) => Position\n): Position {\n  return scanWhile(doc, start, (doc, pos) => !predicate(doc, pos), iter)\n}\n\nfunction appendTextMarker(\n  cm: Editor,\n  text: string,\n  options: CodeMirror.TextMarkerOptions\n): ActualTextMarker {\n  const doc = cm.getDoc()\n  const from = doc.posFromIndex(Infinity)\n\n  doc.replaceRange(text, from)\n  const to = doc.posFromIndex(Infinity)\n\n  return (doc.markText(from, to, options) as any) as ActualTextMarker\n}\n\n/**\n * Comparison method for use in sorting lists of markers in ascending\n * order of start positions.\n */\nfunction orderByPosition(x: ActualTextMarker, y: ActualTextMarker) {\n  const xPos = x.find()\n  const yPos = y.find()\n\n  if (xPos === undefined || yPos === undefined) {\n    return compare(xPos, yPos)\n  }\n\n  return compare(xPos.from, yPos.from)\n}\n\n// The types for CodeMirror.TextMarker is all wrong, this is what it\n// actually looks like\n// eslint-disable-next-line typescript/interface-name-prefix\ninterface ActualTextMarker extends CodeMirror.TextMarkerOptions {\n  /** Remove the mark. */\n  clear(): void\n\n  /**\n   * Returns a {from, to} object (both holding document positions), indicating\n   * the current position of the marked range, or undefined if the marker is\n   * no longer in the document.\n   */\n  find(): { from: Position; to: Position } | undefined\n\n  changed(): void\n}\n\nfunction renderUnknownUserAutocompleteItem(\n  elem: HTMLElement,\n  self: any,\n  data: any\n) {\n  const text = data.username as string\n  const user = document.createElement('div')\n  user.classList.add('user', 'unknown')\n\n  const username = document.createElement('span')\n  username.className = 'username'\n  username.innerText = text\n  user.appendChild(username)\n\n  const description = document.createElement('span')\n  description.className = 'description'\n  description.innerText = `Search for user`\n  user.appendChild(description)\n\n  elem.appendChild(user)\n}\n\nfunction renderUserAutocompleteItem(elem: HTMLElement, self: any, data: any) {\n  const author = data.author as IAuthor\n  const user = document.createElement('div')\n  user.className = 'user'\n\n  // This will always be non-null when we get it from the\n  // autocompletion provider but let's be extra cautious\n  if (author.username) {\n    const username = document.createElement('span')\n    username.className = 'username'\n    username.innerText = author.username\n    user.appendChild(username)\n  }\n\n  const name = document.createElement('span')\n  name.className = 'name'\n  name.innerText = author.name\n\n  user.appendChild(name)\n  elem.appendChild(user)\n}\n\n/**\n * Returns an email address which can be used on the host side to\n * look up the user which is to be given attribution.\n *\n * If the user has a public email address specified in their profile\n * that's used and if they don't then we'll generate a stealth email\n * address.\n */\nfunction getEmailAddressForUser(user: IUserHit) {\n  if (user.email && user.email.length > 0) {\n    return user.email\n  }\n\n  const url = URL.parse(user.endpoint)\n  const host =\n    url.hostname && getDotComAPIEndpoint() !== user.endpoint\n      ? url.hostname\n      : 'github.com'\n\n  return `${user.username}@users.noreply.${host}`\n}\n\nfunction getDisplayTextForAuthor(author: IAuthor) {\n  return author.username === null ? author.name : `@${author.username}`\n}\n\nfunction renderHandleMarkReplacementElement(author: IAuthor) {\n  const elem = document.createElement('span')\n  elem.classList.add('handle')\n  elem.title = `${author.name} <${author.email}>`\n  elem.innerText = getDisplayTextForAuthor(author)\n\n  return elem\n}\n\nfunction renderUnknownHandleMarkReplacementElement(\n  username: string,\n  isError: boolean\n) {\n  const elem = document.createElement('span')\n\n  elem.classList.add('handle', isError ? 'error' : 'progress')\n  elem.title = isError\n    ? `Could not find user with username ${username}`\n    : `Searching for @${username}`\n\n  const symbol = isError ? OcticonSymbol.stop : OcticonSymbol.sync\n\n  const spinner = document.createElementNS('http://www.w3.org/2000/svg', 'svg')\n  spinner.classList.add('icon')\n\n  if (!isError) {\n    spinner.classList.add('spin')\n  }\n\n  const path = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n\n  spinner.viewBox.baseVal.width = symbol.w\n  spinner.viewBox.baseVal.height = symbol.h\n\n  path.setAttribute('d', symbol.d)\n  spinner.appendChild(path)\n\n  elem.appendChild(document.createTextNode(`@${username}`))\n  elem.appendChild(spinner)\n\n  return elem\n}\n\nfunction markRangeAsHandle(\n  doc: Doc,\n  from: Position,\n  to: Position,\n  author: IAuthor\n): ActualTextMarker {\n  const elem = renderHandleMarkReplacementElement(author)\n\n  return (doc.markText(from, to, {\n    atomic: true,\n    className: 'handle',\n    readOnly: false,\n    replacedWith: elem,\n    handleMouseEvents: true,\n  }) as any) as ActualTextMarker\n}\n\nfunction triggerAutoCompleteBasedOnCursorPosition(cm: Editor) {\n  const doc = cm.getDoc()\n\n  if (doc.somethingSelected()) {\n    return\n  }\n\n  const cursor = doc.getCursor()\n  const p = scanUntil(doc, cursor, isMarkOrWhitespace, prevPosition)\n\n  if (posEquals(cursor, p)) {\n    return\n  }\n\n  ;(cm as any).showHint()\n}\n\n/**\n * Convert a IUserHit object which is returned from\n * user-autocomplete-provider into an IAuthor object.\n *\n * If the IUserHit object lacks an email address we'll\n * attempt to create a stealth email address.\n */\nfunction authorFromUserHit(user: IUserHit): IAuthor {\n  return {\n    name: user.name || user.username,\n    email: getEmailAddressForUser(user),\n    username: user.username,\n  }\n}\n\n/**\n * Autocompletable input field for possible authors of a commit.\n *\n * Intended primarily for co-authors but written in a general enough\n * fashion to deal only with authors in general.\n */\nexport class AuthorInput extends React.Component<IAuthorInputProps, {}> {\n  /**\n   * The codemirror instance if mounted, otherwise null\n   */\n  private editor: Editor | null = null\n\n  /**\n   * Resize observer used for tracking width changes and\n   * refreshing the internal codemirror instance when\n   * they occur\n   */\n  private readonly resizeObserver: ResizeObserver\n  private resizeDebounceId: number | null = null\n  private lastKnownWidth: number | null = null\n\n  /**\n   * Whether or not the hint (i.e. autocompleter)\n   * is currently active.\n   */\n  private hintActive: boolean = false\n\n  /**\n   * A reference to the label mark (the persistent\n   * part of the placeholder text)\n   */\n  private label: ActualTextMarker | null = null\n\n  /**\n   * A reference to the placeholder mark (the second\n   * part of the placeholder text which is collapsed\n   * when there's user input)\n   */\n  private placeholder: ActualTextMarker | null = null\n\n  /**\n   * The internal list of authors. Note that codemirror\n   * ultimately is the source of truth for what authors\n   * are in here but we synchronize that into this field\n   * whenever codemirror reports a change. We also use\n   * this array to detect whether the author props have\n   * change, in which case we blow away everything and\n   * start from scratch.\n   */\n  private authors: ReadonlyArray<IAuthor> = []\n\n  // For undo association\n  private readonly markAuthorMap = new Map<ActualTextMarker, IAuthor>()\n  private readonly authorMarkMap = new Map<IAuthor, ActualTextMarker>()\n\n  public constructor(props: IAuthorInputProps) {\n    super(props)\n\n    // Observe size changes and let codemirror know\n    // when it needs to refresh.\n    this.resizeObserver = new ResizeObserver(entries => {\n      if (entries.length === 1 && this.editor) {\n        const newWidth = entries[0].contentRect.width\n\n        // We don't care about the first resize, let's just\n        // store what we've got\n        if (!this.lastKnownWidth) {\n          this.lastKnownWidth = newWidth\n          return\n        }\n\n        // Codemirror already does a good job of height changes,\n        // we just need to care about when the width changes and\n        // do a re-layout\n        if (this.lastKnownWidth !== newWidth) {\n          this.lastKnownWidth = newWidth\n\n          if (this.resizeDebounceId !== null) {\n            cancelAnimationFrame(this.resizeDebounceId)\n            this.resizeDebounceId = null\n          }\n          requestAnimationFrame(this.onResized)\n        }\n      }\n    })\n\n    this.state = {}\n  }\n\n  public componentWillUnmount() {\n    // Sometimes the completion box seems to fail to register\n    // the blur event and close. It's hard to reproduce so\n    // we'll just make doubly sure it's closed when we're\n    // about to go away.\n    if (this.editor) {\n      const state = this.editor.state\n      if (state.completionActive && state.completionActive.close) {\n        state.completionActive.close()\n      }\n    }\n  }\n\n  public componentWillReceiveProps(nextProps: IAuthorInputProps) {\n    const cm = this.editor\n\n    if (!cm) {\n      return\n    }\n\n    // If the authors prop have changed from our internal representation\n    // we'll throw up our hands and reset the input to whatever we're\n    // given.\n    if (\n      nextProps.authors !== this.props.authors &&\n      !arrayEquals(this.authors, nextProps.authors)\n    ) {\n      cm.operation(() => {\n        this.reset(cm, nextProps.authors)\n      })\n    }\n\n    if (nextProps.disabled !== this.props.disabled) {\n      cm.setOption('readOnly', nextProps.disabled ? 'nocursor' : false)\n    }\n  }\n\n  private onResized = () => {\n    this.resizeDebounceId = null\n    if (this.editor) {\n      this.editor.refresh()\n    }\n  }\n\n  private onContainerRef = (elem: HTMLDivElement) => {\n    if (elem) {\n      this.editor = this.initializeCodeMirror(elem)\n      this.resizeObserver.observe(elem)\n    } else {\n      this.editor = null\n      this.resizeObserver.disconnect()\n    }\n  }\n\n  private applyCompletion = (cm: Editor, data: any, completion: any) => {\n    const from: Position = completion.from || data.from\n    const to: Position = completion.to || data.to\n    const author: IAuthor = completion.author\n\n    this.insertAuthor(cm, author, from, to)\n    this.updateAuthors(cm)\n  }\n\n  private applyUnknownUserCompletion = (\n    cm: Editor,\n    data: any,\n    completion: any\n  ) => {\n    const from: Position = completion.from || data.from\n    const to: Position = completion.to || data.to\n    const username: string = completion.username\n    const text = `@${username}`\n    const doc = cm.getDoc()\n\n    doc.replaceRange(text, from, to, 'complete')\n    const end = doc.posFromIndex(doc.indexFromPos(from) + text.length)\n\n    // Create a temporary, atomic, marker so that the text can't be modified.\n    // This marker will be styled in such a way as to indicate that it's\n    // processing.\n    const tmpMark = (doc.markText(from, end, {\n      atomic: true,\n      className: 'handle progress',\n      readOnly: false,\n      replacedWith: renderUnknownHandleMarkReplacementElement(username, false),\n      handleMouseEvents: true,\n    }) as any) as ActualTextMarker\n\n    // Note that it's important that this method isn't async up until\n    // this point since show-hint expects a synchronous method\n    return this.props.autoCompleteProvider.exactMatch(username).then(hit => {\n      cm.operation(() => {\n        const tmpPos = tmpMark.find()\n\n        // Since we're async here it's possible that the user has deleted\n        // the temporary mark already, in which case we just bail.\n        if (!tmpPos) {\n          return\n        }\n\n        // Clear out the temporary mark and get ready to either replace\n        // it with a proper handle marker or an error marker.\n        tmpMark.clear()\n\n        if (!hit) {\n          doc.markText(tmpPos.from, tmpPos.to, {\n            atomic: true,\n            className: 'handle error',\n            readOnly: false,\n            replacedWith: renderUnknownHandleMarkReplacementElement(\n              username,\n              true\n            ),\n            handleMouseEvents: true,\n          })\n\n          return\n        }\n\n        this.insertAuthor(cm, authorFromUserHit(hit), tmpPos.from, tmpPos.to)\n      })\n    })\n  }\n\n  private insertAuthor(\n    cm: Editor,\n    author: IAuthor,\n    from: Position,\n    to?: Position\n  ) {\n    const text = getDisplayTextForAuthor(author)\n    const doc = cm.getDoc()\n\n    doc.replaceRange(text, from, to, 'complete')\n\n    const end = doc.posFromIndex(doc.indexFromPos(from) + text.length)\n    const marker = markRangeAsHandle(doc, from, end, author)\n\n    this.markAuthorMap.set(marker, author)\n    this.authorMarkMap.set(author, marker)\n\n    return marker\n  }\n\n  private appendAuthor(cm: Editor, author: IAuthor) {\n    const doc = cm.getDoc()\n    return this.insertAuthor(cm, author, doc.posFromIndex(Infinity))\n  }\n\n  private onAutocompleteUser = async (cm: Editor, x?: any, y?: any) => {\n    const doc = cm.getDoc()\n    const cursor = doc.getCursor() as Readonly<Position>\n\n    // expand the current cursor position into a range covering as\n    // long of an autocompletable string as possible.\n    const from = scanUntil(doc, cursor, isMarkOrWhitespace, prevPosition)\n    const to = scanUntil(doc, cursor, isMarkOrWhitespace, nextPosition)\n\n    const word = doc.getRange(from, to)\n\n    const needle = word.replace(/^@/, '')\n    const hits = await this.props.autoCompleteProvider.getAutocompletionItems(\n      needle\n    )\n\n    const exactMatch = hits.some(\n      hit => hit.username.toLowerCase() === needle.toLowerCase()\n    )\n\n    const existingUsernames = new Set(this.authors.map(x => x.username))\n\n    const list: any[] = hits\n      .map(authorFromUserHit)\n      .filter(x => x.username === null || !existingUsernames.has(x.username))\n      .map(author => ({\n        author,\n        text: getDisplayTextForAuthor(author),\n        render: renderUserAutocompleteItem,\n        className: 'autocompletion-item',\n        hint: this.applyCompletion,\n      }))\n\n    if (!exactMatch && needle.length > 0) {\n      list.push({\n        text: `@${needle}`,\n        username: needle,\n        render: renderUnknownUserAutocompleteItem,\n        className: 'autocompletion-item',\n        hint: this.applyUnknownUserCompletion,\n      })\n    }\n\n    return { list, from, to }\n  }\n\n  private updatePlaceholderVisibility(cm: Editor) {\n    if (this.label && this.placeholder) {\n      const labelRange = this.label.find()\n      const placeholderRange = this.placeholder.find()\n\n      // If this happen then codemirror has done something\n      // weird. It shouldn't be possible to remove these\n      // markers from the document.\n      if (!labelRange || !placeholderRange) {\n        return\n      }\n\n      const doc = cm.getDoc()\n\n      const collapse =\n        doc.indexFromPos(labelRange.to) !==\n        doc.indexFromPos(placeholderRange.from)\n\n      if (this.placeholder.collapsed !== collapse) {\n        this.placeholder.collapsed = collapse\n        this.placeholder.changed()\n      }\n    }\n  }\n\n  private getAllHandleMarks(cm: Editor): Array<ActualTextMarker> {\n    return (cm.getDoc().getAllMarks() as any) as ActualTextMarker[]\n  }\n\n  private initializeCodeMirror(host: HTMLDivElement) {\n    const CodeMirrorOptions: CodeMirror.EditorConfiguration & {\n      hintOptions: any\n    } = {\n      mode: null,\n      lineWrapping: true,\n      extraKeys: {\n        Tab: false,\n        Enter: false,\n        'Shift-Tab': false,\n        'Ctrl-Space': 'autocomplete',\n        'Ctrl-Enter': false,\n        'Cmd-Enter': false,\n      },\n      readOnly: this.props.disabled ? 'nocursor' : false,\n      hintOptions: {\n        completeOnSingleClick: true,\n        completeSingle: false,\n        closeOnUnfocus: true,\n        closeCharacters: /\\s/,\n        hint: this.onAutocompleteUser,\n      },\n    }\n\n    const cm = CodeMirror(host, CodeMirrorOptions)\n\n    cm.operation(() => {\n      this.reset(cm, this.props.authors)\n    })\n\n    cm.on('startCompletion', () => {\n      this.hintActive = true\n    })\n\n    cm.on('endCompletion', () => {\n      this.hintActive = false\n    })\n\n    cm.on('change', () => {\n      this.updatePlaceholderVisibility(cm)\n\n      if (!this.hintActive) {\n        triggerAutoCompleteBasedOnCursorPosition(cm)\n      }\n    })\n\n    cm.on('focus', () => {\n      if (!this.hintActive) {\n        triggerAutoCompleteBasedOnCursorPosition(cm)\n      }\n    })\n\n    cm.on('changes', () => {\n      this.updateAuthors(cm)\n    })\n\n    const wrapperElem = cm.getWrapperElement()\n\n    // Do the very least we can do to pretend that we're a\n    // single line textbox. Users can still paste newlines\n    // though and if the do we don't care.\n    wrapperElem.addEventListener('keypress', (e: KeyboardEvent) => {\n      if (!e.defaultPrevented && e.key === 'Enter') {\n        e.preventDefault()\n      }\n    })\n\n    wrapperElem.addEventListener('contextmenu', e => {\n      this.onContextMenu(cm, e)\n    })\n\n    return cm\n  }\n\n  private onContextMenu(cm: Editor, e: MouseEvent) {\n    e.preventDefault()\n\n    const menu: IMenuItem[] = [\n      { label: 'Undo', action: () => cm.getDoc().undo() },\n      { label: 'Redo', action: () => cm.getDoc().redo() },\n      { type: 'separator' },\n      { role: 'cut' },\n      { role: 'copy' },\n      { role: 'paste' },\n    ]\n\n    if (__WIN32__) {\n      menu.push({ type: 'separator' })\n    }\n\n    menu.push({\n      label: __DARWIN__ ? 'Select All' : 'Select all',\n      action: () => {\n        cm.execCommand('selectAll')\n      },\n    })\n\n    showContextualMenu(menu)\n  }\n\n  private updateAuthors(cm: Editor) {\n    const markers = this.getAllHandleMarks(cm).sort(orderByPosition)\n    const authors = new Array<IAuthor>()\n\n    for (const marker of markers) {\n      const author = this.markAuthorMap.get(marker)\n\n      // undefined authors shouldn't happen lol\n      if (author) {\n        authors.push(author)\n      }\n    }\n\n    if (!arrayEquals(this.authors, authors)) {\n      this.authors = authors\n      this.props.onAuthorsUpdated(authors)\n    }\n  }\n\n  private reset(cm: Editor, authors: ReadonlyArray<IAuthor>) {\n    const doc = cm.getDoc()\n\n    cm.setValue('')\n    doc.clearHistory()\n\n    this.authors = []\n    this.authorMarkMap.clear()\n    this.markAuthorMap.clear()\n\n    this.label = appendTextMarker(cm, 'Co-Authors ', {\n      atomic: true,\n      inclusiveLeft: true,\n      className: 'label',\n      readOnly: true,\n    })\n\n    for (const author of authors) {\n      this.appendAuthor(cm, author)\n    }\n\n    this.authors = this.props.authors\n\n    this.placeholder = appendTextMarker(cm, '@username', {\n      atomic: true,\n      inclusiveRight: true,\n      className: 'placeholder',\n      readOnly: true,\n      collapsed: authors.length > 0,\n    })\n\n    // We know that find won't returned undefined here because we\n    // _just_ put the placeholder in there\n    doc.setCursor(this.placeholder.find()!.from)\n  }\n\n  public render() {\n    const className = classNames(\n      'author-input-component',\n      this.props.className,\n      {\n        disabled: this.props.disabled,\n      }\n    )\n    return <div className={className} ref={this.onContainerRef} />\n  }\n}\n","import { generateGravatarUrl } from '../../lib/gravatar'\nimport { IAvatarUser } from '../../models/avatar'\n\nconst inMemoryCache = new Map<string, string | null>()\n\nconst defaultHeaders = new Headers()\n\nconst defaultInit: RequestInit = {\n  method: 'GET',\n  headers: defaultHeaders,\n  mode: 'cors',\n  cache: 'default',\n}\n\n/**\n * Fetch an avatar URL and cache it in memory, using the browser's\n * URL.createObjectURL method to refer to the blob content, instead of\n * converting into the data URI format.\n *\n * This method will store a `null` in the cache if the request fails, so that\n * it avoids repeated requests to the same URL for the current session.\n *\n * @param requestUrl The source URL to fetch\n */\nasync function fetchAndCache(requestUrl: string): Promise<string | null> {\n  let url: string | null = null\n\n  try {\n    const response = await fetch(requestUrl, defaultInit)\n    if (response.ok) {\n      const contentType = response.headers.get('Content-Type')\n      if (contentType && contentType.startsWith('text/html')) {\n        // we're encountering a request to sign in, let's skip this\n      } else {\n        const blob = await response.blob()\n        url = URL.createObjectURL(blob)\n      }\n    }\n  } catch {\n    // catch and ignore any network errors\n  }\n\n  inMemoryCache.set(requestUrl, url)\n\n  return url\n}\n\n/**\n * Fetch an avatar to associate with a user, with fallback when the resource is\n * not accessible.\n *\n * @param avatarURL The GitHub avatar URL to lookup first\n * @param email The email address to translate into a Gravatar URL as a fallback\n */\nexport async function lookupAvatar(\n  avatarURL: string,\n  email: string\n): Promise<string | null> {\n  const cachedAccountAvatar = inMemoryCache.get(avatarURL)\n  if (cachedAccountAvatar) {\n    return cachedAccountAvatar\n  }\n\n  if (cachedAccountAvatar === undefined) {\n    // no cache entry found for GitHub avatar\n    const accountAvatar = await fetchAndCache(avatarURL)\n    if (accountAvatar) {\n      return accountAvatar\n    }\n  }\n\n  const gravatarURL = generateGravatarUrl(email)\n  const cachedGravatarAvatar = inMemoryCache.get(gravatarURL)\n  if (cachedGravatarAvatar) {\n    return cachedGravatarAvatar\n  }\n\n  if (cachedGravatarAvatar === undefined) {\n    // no cache entry found for Gravatar avatar\n    const gravatarAvatar = await fetchAndCache(gravatarURL)\n    if (gravatarAvatar) {\n      return gravatarAvatar\n    }\n  }\n\n  return null\n}\n\n/**\n * Fetch the avatar associated with the current user\n *\n * @param defaultURL default avatar to render\n * @param user current user to inspect\n */\nexport async function fetchAvatarUrl(\n  defaultURL: string,\n  user?: IAvatarUser\n): Promise<string> {\n  if (!user) {\n    return defaultURL\n  }\n\n  const avatar = await lookupAvatar(user.avatarURL, user.email)\n  return avatar || defaultURL\n}\n","'use strict';\nconst path = require('path');\n\nmodule.exports = (str, opts) => {\n\tif (typeof str !== 'string') {\n\t\tthrow new TypeError(`Expected a string, got ${typeof str}`);\n\t}\n\n\topts = Object.assign({resolve: true}, opts);\n\n\tlet pathName = str;\n\n\tif (opts.resolve) {\n\t\tpathName = path.resolve(str);\n\t}\n\n\tpathName = pathName.replace(/\\\\/g, '/');\n\n\t// Windows drive letter must be prefixed with a slash\n\tif (pathName[0] !== '/') {\n\t\tpathName = `/${pathName}`;\n\t}\n\n\t// Escape required characters for path components\n\t// See: https://tools.ietf.org/html/rfc3986#section-3.3\n\treturn encodeURI(`file://${pathName}`).replace(/[?#]/g, encodeURIComponent);\n};\n","import * as React from 'react'\n\nimport { IAutocompletionProvider } from './index'\nimport { GitHubUserStore } from '../../lib/stores'\nimport { GitHubRepository } from '../../models/github-repository'\nimport { Account } from '../../models/account'\nimport { IGitHubUser } from '../../lib/databases/index'\n\n/** An autocompletion hit for a user. */\nexport interface IUserHit {\n  /** The username. */\n  readonly username: string\n\n  /**\n   * The user's name or null if the user\n   * hasn't entered a name in their profile\n   */\n  readonly name: string | null\n\n  /**\n   * The user's public email address. If the user\n   * hasn't selected a public email address this\n   * field will be an empty string.\n   */\n  readonly email: string\n\n  readonly endpoint: string\n}\n\nfunction userToHit(user: IGitHubUser): IUserHit {\n  return {\n    username: user.login,\n    name: user.name,\n    email: user.email,\n    endpoint: user.endpoint,\n  }\n}\n\n/** The autocompletion provider for user mentions in a GitHub repository. */\nexport class UserAutocompletionProvider\n  implements IAutocompletionProvider<IUserHit> {\n  public readonly kind = 'user'\n\n  private readonly gitHubUserStore: GitHubUserStore\n  private readonly repository: GitHubRepository\n  private readonly account: Account | null\n\n  public constructor(\n    gitHubUserStore: GitHubUserStore,\n    repository: GitHubRepository,\n    account?: Account\n  ) {\n    this.gitHubUserStore = gitHubUserStore\n    this.repository = repository\n    this.account = account || null\n  }\n\n  public getRegExp(): RegExp {\n    return /(?:^|\\n| )(?:@)([a-z\\d\\\\+-][a-z\\d_-]*)?/g\n  }\n\n  public async getAutocompletionItems(\n    text: string\n  ): Promise<ReadonlyArray<IUserHit>> {\n    const users = await this.gitHubUserStore.getMentionableUsersMatching(\n      this.repository,\n      text\n    )\n\n    // dotcom doesn't let you autocomplete on your own handle\n    const account = this.account\n    const filtered = account\n      ? users.filter(x => x.login !== account.login)\n      : users\n\n    return filtered.map(userToHit)\n  }\n\n  public renderItem(item: IUserHit): JSX.Element {\n    return (\n      <div className=\"user\" key={item.username}>\n        <span className=\"username\">{item.username}</span>\n        <span className=\"name\">{item.name}</span>\n      </div>\n    )\n  }\n\n  public getCompletionText(item: IUserHit): string {\n    return `@${item.username}`\n  }\n\n  /**\n   * Retrieve a user based on the user login name, i.e their handle.\n   *\n   * If the user is already cached no additional API requests\n   * will be made. If the user isn't in the cache but found in\n   * the API it will be persisted to the database and the\n   * intermediate cache.\n   *\n   * @param login   The login (i.e. handle) of the user\n   */\n  public async exactMatch(login: string): Promise<IUserHit | null> {\n    if (this.account === null) {\n      return null\n    }\n\n    const user = await this.gitHubUserStore.getByLogin(this.account, login)\n\n    if (!user) {\n      return null\n    }\n\n    return userToHit(user)\n  }\n}\n","import * as React from 'react'\nimport { IAutocompletionProvider } from './index'\nimport { IssuesStore } from '../../lib/stores'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { GitHubRepository } from '../../models/github-repository'\nimport { ThrottledScheduler } from '../lib/throttled-scheduler'\n\n/** The interval we should use to throttle the issues update. */\nconst UpdateIssuesThrottleInterval = 1000 * 60\n\n/** An autocompletion hit for an issue. */\nexport interface IIssueHit {\n  /** The title of the issue. */\n  readonly title: string\n\n  /** The issue's number. */\n  readonly number: number\n}\n\n/** The autocompletion provider for issues in a GitHub repository. */\nexport class IssuesAutocompletionProvider\n  implements IAutocompletionProvider<IIssueHit> {\n  public readonly kind = 'issue'\n\n  private readonly issuesStore: IssuesStore\n  private readonly repository: GitHubRepository\n  private readonly dispatcher: Dispatcher\n\n  /**\n   * The scheduler used to throttle calls to update the issues for\n   * autocompletion.\n   */\n  private readonly updateIssuesScheduler = new ThrottledScheduler(\n    UpdateIssuesThrottleInterval\n  )\n\n  public constructor(\n    issuesStore: IssuesStore,\n    repository: GitHubRepository,\n    dispatcher: Dispatcher\n  ) {\n    this.issuesStore = issuesStore\n    this.repository = repository\n    this.dispatcher = dispatcher\n  }\n\n  public getRegExp(): RegExp {\n    return /(?:^|\\n| )(?:#)([a-z\\d\\\\+-][a-z\\d_]*)?/g\n  }\n\n  public getAutocompletionItems(\n    text: string\n  ): Promise<ReadonlyArray<IIssueHit>> {\n    this.updateIssuesScheduler.queue(() => {\n      this.dispatcher.refreshIssues(this.repository)\n    })\n\n    return this.issuesStore.getIssuesMatching(this.repository, text)\n  }\n\n  public renderItem(item: IIssueHit): JSX.Element {\n    return (\n      <div className=\"issue\" key={item.number}>\n        <span className=\"number\">#{item.number}</span>\n        <span className=\"title\">{item.title}</span>\n      </div>\n    )\n  }\n\n  public getCompletionText(item: IIssueHit): string {\n    return `#${item.number}`\n  }\n}\n","import * as React from 'react'\nimport { IAutocompletionProvider } from './index'\nimport { compare } from '../../lib/compare'\n\n/**\n * Interface describing a autocomplete match for the given search\n * input passed to EmojiAutocompletionProvider#getAutocompletionItems.\n */\nexport interface IEmojiHit {\n  /** A human-readable markdown representation of the emoji, ex :heart: */\n  readonly emoji: string\n\n  /**\n   * The offset into the emoji string where the\n   * match started, used for highlighting matches.\n   */\n  readonly matchStart: number\n\n  /**\n   * The length of the match or zero if the filter\n   * string was empty, causing the provider to return\n   * all possible matches.\n   */\n  readonly matchLength: number\n}\n\n/** Autocompletion provider for emoji. */\nexport class EmojiAutocompletionProvider\n  implements IAutocompletionProvider<IEmojiHit> {\n  public readonly kind = 'emoji'\n\n  private emoji: Map<string, string>\n\n  public constructor(emoji: Map<string, string>) {\n    this.emoji = emoji\n  }\n\n  public getRegExp(): RegExp {\n    return /(?:^|\\n| )(?::)([a-z\\d\\\\+-][a-z\\d_]*)?/g\n  }\n\n  public async getAutocompletionItems(\n    text: string\n  ): Promise<ReadonlyArray<IEmojiHit>> {\n    // Empty strings is falsy, this is the happy path to avoid\n    // sorting and matching when the user types a ':'. We want\n    // to open the popup with suggestions as fast as possible.\n    if (!text) {\n      return Array.from(this.emoji.keys()).map<IEmojiHit>(emoji => {\n        return { emoji: emoji, matchStart: 0, matchLength: 0 }\n      })\n    }\n\n    const results = new Array<IEmojiHit>()\n    const needle = text.toLowerCase()\n\n    for (const emoji of this.emoji.keys()) {\n      const index = emoji.indexOf(needle)\n      if (index !== -1) {\n        results.push({ emoji, matchStart: index, matchLength: needle.length })\n      }\n    }\n\n    // Naive emoji result sorting\n    //\n    // Matches closer to the start of the string are sorted\n    // before matches further into the string\n    //\n    // Longer matches relative to the emoji length is sorted\n    // before the same match in a longer emoji\n    // (:heart over :heart_eyes)\n    //\n    // If both those start and length are equal we sort\n    // alphabetically\n    return results.sort(\n      (x, y) =>\n        compare(x.matchStart, y.matchStart) ||\n        compare(x.emoji.length, y.emoji.length) ||\n        compare(x.emoji, y.emoji)\n    )\n  }\n\n  public renderItem(hit: IEmojiHit) {\n    const emoji = hit.emoji\n\n    return (\n      <div className=\"emoji\" key={emoji}>\n        <img className=\"icon\" src={this.emoji.get(emoji)} />\n        {this.renderHighlightedTitle(hit)}\n      </div>\n    )\n  }\n\n  private renderHighlightedTitle(hit: IEmojiHit) {\n    const emoji = hit.emoji\n\n    if (!hit.matchLength) {\n      return <div className=\"title\">{emoji}</div>\n    }\n\n    return (\n      <div className=\"title\">\n        {emoji.substr(0, hit.matchStart)}\n        <mark>{emoji.substr(hit.matchStart, hit.matchLength)}</mark>\n        {emoji.substr(hit.matchStart + hit.matchLength)}\n      </div>\n    )\n  }\n\n  public getCompletionText(item: IEmojiHit) {\n    return item.emoji\n  }\n}\n","/* jshint browser: true */\n\n(function () {\n\n// The properties that we copy into a mirrored div.\n// Note that some browsers, such as Firefox,\n// do not concatenate properties, i.e. padding-top, bottom etc. -> padding,\n// so we have to do every single property specifically.\nvar properties = [\n  'direction',  // RTL support\n  'boxSizing',\n  'width',  // on Chrome and IE, exclude the scrollbar, so the mirror div wraps exactly as the textarea does\n  'height',\n  'overflowX',\n  'overflowY',  // copy the scrollbar for IE\n\n  'borderTopWidth',\n  'borderRightWidth',\n  'borderBottomWidth',\n  'borderLeftWidth',\n  'borderStyle',\n\n  'paddingTop',\n  'paddingRight',\n  'paddingBottom',\n  'paddingLeft',\n\n  // https://developer.mozilla.org/en-US/docs/Web/CSS/font\n  'fontStyle',\n  'fontVariant',\n  'fontWeight',\n  'fontStretch',\n  'fontSize',\n  'fontSizeAdjust',\n  'lineHeight',\n  'fontFamily',\n\n  'textAlign',\n  'textTransform',\n  'textIndent',\n  'textDecoration',  // might not make a difference, but better be safe\n\n  'letterSpacing',\n  'wordSpacing',\n\n  'tabSize',\n  'MozTabSize'\n\n];\n\nvar isBrowser = (typeof window !== 'undefined');\nvar isFirefox = (isBrowser && window.mozInnerScreenX != null);\n\nfunction getCaretCoordinates(element, position, options) {\n  if(!isBrowser) {\n    throw new Error('textarea-caret-position#getCaretCoordinates should only be called in a browser');\n  }\n\n  var debug = options && options.debug || false;\n  if (debug) {\n    var el = document.querySelector('#input-textarea-caret-position-mirror-div');\n    if ( el ) { el.parentNode.removeChild(el); }\n  }\n\n  // mirrored div\n  var div = document.createElement('div');\n  div.id = 'input-textarea-caret-position-mirror-div';\n  document.body.appendChild(div);\n\n  var style = div.style;\n  var computed = window.getComputedStyle? getComputedStyle(element) : element.currentStyle;  // currentStyle for IE < 9\n\n  // default textarea styles\n  style.whiteSpace = 'pre-wrap';\n  if (element.nodeName !== 'INPUT')\n    style.wordWrap = 'break-word';  // only for textarea-s\n\n  // position off-screen\n  style.position = 'absolute';  // required to return coordinates properly\n  if (!debug)\n    style.visibility = 'hidden';  // not 'display: none' because we want rendering\n\n  // transfer the element's properties to the div\n  properties.forEach(function (prop) {\n    style[prop] = computed[prop];\n  });\n\n  if (isFirefox) {\n    // Firefox lies about the overflow property for textareas: https://bugzilla.mozilla.org/show_bug.cgi?id=984275\n    if (element.scrollHeight > parseInt(computed.height))\n      style.overflowY = 'scroll';\n  } else {\n    style.overflow = 'hidden';  // for Chrome to not render a scrollbar; IE keeps overflowY = 'scroll'\n  }\n\n  div.textContent = element.value.substring(0, position);\n  // the second special handling for input type=\"text\" vs textarea: spaces need to be replaced with non-breaking spaces - http://stackoverflow.com/a/13402035/1269037\n  if (element.nodeName === 'INPUT')\n    div.textContent = div.textContent.replace(/\\s/g, '\\u00a0');\n\n  var span = document.createElement('span');\n  // Wrapping must be replicated *exactly*, including when a long word gets\n  // onto the next line, with whitespace at the end of the line before (#7).\n  // The  *only* reliable way to do that is to copy the *entire* rest of the\n  // textarea's content into the <span> created at the caret position.\n  // for inputs, just '.' would be enough, but why bother?\n  span.textContent = element.value.substring(position) || '.';  // || because a completely empty faux span doesn't render at all\n  div.appendChild(span);\n\n  var coordinates = {\n    top: span.offsetTop + parseInt(computed['borderTopWidth']),\n    left: span.offsetLeft + parseInt(computed['borderLeftWidth'])\n  };\n\n  if (debug) {\n    span.style.backgroundColor = '#aaa';\n  } else {\n    document.body.removeChild(div);\n  }\n\n  return coordinates;\n}\n\nif (typeof module != 'undefined' && typeof module.exports != 'undefined') {\n  module.exports = getCaretCoordinates;\n} else if(isBrowser){\n  window.getCaretCoordinates = getCaretCoordinates;\n}\n\n}());\n","import * as React from 'react'\nimport {\n  List,\n  SelectionSource,\n  findNextSelectableRow,\n  SelectionDirection,\n} from '../lib/list'\nimport { IAutocompletionProvider } from './index'\nimport { fatalError } from '../../lib/fatal-error'\nimport * as classNames from 'classnames'\n\ninterface IRange {\n  readonly start: number\n  readonly length: number\n}\n\nimport getCaretCoordinates = require('textarea-caret')\nimport { showContextualMenu } from '../main-process-proxy'\n\ninterface IAutocompletingTextInputProps<ElementType> {\n  /**\n   * An optional className to be applied to the rendered\n   * top level element of the component.\n   */\n  readonly className?: string\n\n  /** The placeholder for the input field. */\n  readonly placeholder?: string\n\n  /** The current value of the input field. */\n  readonly value?: string\n\n  /** Disabled state for input field. */\n  readonly disabled?: boolean\n\n  /** Indicates if input field should be required */\n  readonly isRequired?: boolean\n\n  /**\n   * Called when the user changes the value in the input field.\n   */\n  readonly onValueChanged?: (value: string) => void\n\n  /** Called on key down. */\n  readonly onKeyDown?: (event: React.KeyboardEvent<ElementType>) => void\n\n  /**\n   * A list of autocompletion providers that should be enabled for this\n   * input.\n   */\n  readonly autocompletionProviders: ReadonlyArray<IAutocompletionProvider<any>>\n\n  /**\n   * A method that's called when the internal input or textarea element\n   * is mounted or unmounted.\n   */\n  readonly onElementRef?: (elem: ElementType | null) => void\n\n  /**\n   * Optional callback to override the default edit context menu\n   * in the input field.\n   */\n  readonly onContextMenu?: (event: React.MouseEvent<any>) => void\n}\n\ninterface IAutocompletionState<T> {\n  readonly provider: IAutocompletionProvider<T>\n  readonly items: ReadonlyArray<T>\n  readonly range: IRange\n  readonly rangeText: string\n  readonly selectedItem: T | null\n}\n\n/**\n * The height of the autocompletion result rows.\n */\nconst RowHeight = 29\n\n/**\n * The amount to offset on the Y axis so that the popup is displayed below the\n * current line.\n */\nconst YOffset = 20\n\n/**\n * The default height for the popup. Note that the actual height may be\n * smaller in order to fit the popup within the window.\n */\nconst DefaultPopupHeight = 100\n\ninterface IAutocompletingTextInputState<T> {\n  /**\n   * All of the state about autocompletion. Will be null if there are no\n   * matching autocompletion providers.\n   */\n  readonly autocompletionState: IAutocompletionState<T> | null\n}\n\n/** A text area which provides autocompletions as the user types. */\nexport abstract class AutocompletingTextInput<\n  ElementType extends HTMLInputElement | HTMLTextAreaElement\n> extends React.Component<\n  IAutocompletingTextInputProps<ElementType>,\n  IAutocompletingTextInputState<Object>\n> {\n  private element: ElementType | null = null\n\n  /** The identifier for each autocompletion request. */\n  private autocompletionRequestID = 0\n\n  public constructor(props: IAutocompletingTextInputProps<ElementType>) {\n    super(props)\n\n    this.state = { autocompletionState: null }\n  }\n\n  private renderItem = (row: number): JSX.Element | null => {\n    const state = this.state.autocompletionState\n    if (!state) {\n      return null\n    }\n\n    const item = state.items[row]\n    const selected = item === state.selectedItem ? 'selected' : ''\n    return (\n      <div className={`autocompletion-item ${selected}`}>\n        {state.provider.renderItem(item)}\n      </div>\n    )\n  }\n\n  private renderAutocompletions() {\n    const state = this.state.autocompletionState\n    if (!state) {\n      return null\n    }\n\n    const items = state.items\n    if (!items.length) {\n      return null\n    }\n\n    const element = this.element!\n    let coordinates = getCaretCoordinates(element, state.range.start)\n    coordinates = {\n      ...coordinates,\n      top: coordinates.top - element.scrollTop,\n      left: coordinates.left - element.scrollLeft,\n    }\n\n    const left = coordinates.left\n    const top = coordinates.top + YOffset\n    const selectedRow = state.selectedItem\n      ? items.indexOf(state.selectedItem)\n      : -1\n    const rect = element.getBoundingClientRect()\n    const popupAbsoluteTop = rect.top + coordinates.top\n\n    // The maximum height we can use for the popup without it extending beyond\n    // the Window bounds.\n    let maxHeight: number\n    if (\n      element.ownerDocument !== null &&\n      element.ownerDocument.defaultView !== null\n    ) {\n      const windowHeight = element.ownerDocument.defaultView.innerHeight\n      const spaceToBottomOfWindow = windowHeight - popupAbsoluteTop - YOffset\n      maxHeight = Math.min(DefaultPopupHeight, spaceToBottomOfWindow)\n    } else {\n      maxHeight = DefaultPopupHeight\n    }\n\n    // The height needed to accomodate all the matched items without overflowing\n    //\n    // Magic number warning! The autocompletion-popup container adds a border\n    // which we have to account for in case we want to show N number of items\n    // without overflowing and triggering the scrollbar.\n    const noOverflowItemHeight = RowHeight * items.length\n\n    const height = Math.min(noOverflowItemHeight, maxHeight)\n\n    // Use the completion text as invalidation props so that highlighting\n    // will update as you type even though the number of items matched\n    // remains the same. Additionally we need to be aware that different\n    // providers can use different sorting behaviors which also might affect\n    // rendering.\n    const searchText = state.rangeText\n\n    const className = classNames('autocompletion-popup', state.provider.kind)\n\n    return (\n      <div className={className} style={{ top, left, height }}>\n        <List\n          rowCount={items.length}\n          rowHeight={RowHeight}\n          selectedRows={[selectedRow]}\n          rowRenderer={this.renderItem}\n          scrollToRow={selectedRow}\n          selectOnHover={true}\n          focusOnHover={false}\n          onRowMouseDown={this.onRowMouseDown}\n          onRowClick={this.insertCompletionOnClick}\n          onSelectedRowChanged={this.onSelectedRowChanged}\n          invalidationProps={searchText}\n        />\n      </div>\n    )\n  }\n\n  private onRowMouseDown = (row: number, event: React.MouseEvent<any>) => {\n    const currentAutoCompletionState = this.state.autocompletionState\n\n    if (!currentAutoCompletionState) {\n      return\n    }\n\n    const item = currentAutoCompletionState.items[row]\n\n    if (item) {\n      this.insertCompletion(item, 'mouseclick')\n    }\n  }\n\n  private onSelectedRowChanged = (row: number, source: SelectionSource) => {\n    const currentAutoCompletionState = this.state.autocompletionState\n\n    if (!currentAutoCompletionState) {\n      return\n    }\n\n    const newSelectedItem = currentAutoCompletionState.items[row]\n\n    const newAutoCompletionState = {\n      ...currentAutoCompletionState,\n      selectedItem: newSelectedItem,\n    }\n\n    this.setState({ autocompletionState: newAutoCompletionState })\n  }\n\n  private insertCompletionOnClick = (row: number): void => {\n    const state = this.state.autocompletionState\n    if (!state) {\n      return\n    }\n\n    const items = state.items\n    if (!items.length) {\n      return\n    }\n\n    const item = items[row]\n\n    this.insertCompletion(item, 'mouseclick')\n  }\n\n  /**\n   * To be implemented by subclasses. It must return the element tag name which\n   * should correspond to the ElementType over which it is parameterized.\n   */\n  protected abstract getElementTagName(): 'textarea' | 'input'\n\n  private onContextMenu = (event: React.MouseEvent<any>) => {\n    if (this.props.onContextMenu) {\n      this.props.onContextMenu(event)\n    } else {\n      event.preventDefault()\n      showContextualMenu([{ role: 'editMenu' }])\n    }\n  }\n\n  private renderTextInput() {\n    const props = {\n      type: 'text',\n      placeholder: this.props.placeholder,\n      value: this.props.value,\n      ref: this.onRef,\n      onChange: this.onChange,\n      onKeyDown: this.onKeyDown,\n      onBlur: this.onBlur,\n      onContextMenu: this.onContextMenu,\n      disabled: this.props.disabled,\n      'aria-required': this.props.isRequired ? true : false,\n    }\n\n    return React.createElement<React.HTMLAttributes<ElementType>, ElementType>(\n      this.getElementTagName(),\n      props\n    )\n  }\n\n  private onBlur = (e: React.FocusEvent<ElementType>) => {\n    this.close()\n  }\n\n  private onRef = (ref: ElementType | null) => {\n    this.element = ref\n    if (this.props.onElementRef) {\n      this.props.onElementRef(ref)\n    }\n  }\n\n  public focus() {\n    if (this.element) {\n      this.element.focus()\n    }\n  }\n\n  public render() {\n    const tagName = this.getElementTagName()\n    const className = classNames(\n      'autocompletion-container',\n      this.props.className,\n      {\n        'text-box-component': tagName === 'input',\n        'text-area-component': tagName === 'textarea',\n      }\n    )\n    return (\n      <div className={className}>\n        {this.renderAutocompletions()}\n\n        {this.renderTextInput()}\n      </div>\n    )\n  }\n\n  private setCursorPosition(newCaretPosition: number) {\n    if (this.element == null) {\n      log.warn('Unable to set cursor position when element is null')\n      return\n    }\n\n    this.element.selectionStart = newCaretPosition\n    this.element.selectionEnd = newCaretPosition\n  }\n\n  private insertCompletion(item: Object, source: 'mouseclick' | 'keyboard') {\n    const element = this.element!\n    const autocompletionState = this.state.autocompletionState!\n    const originalText = element.value\n    const range = autocompletionState.range\n    const autoCompleteText = autocompletionState.provider.getCompletionText(\n      item\n    )\n\n    const textWithAutoCompleteText =\n      originalText.substr(0, range.start - 1) + autoCompleteText + ' '\n\n    const newText =\n      textWithAutoCompleteText + originalText.substr(range.start + range.length)\n\n    element.value = newText\n\n    if (this.props.onValueChanged) {\n      this.props.onValueChanged(newText)\n    }\n\n    const newCaretPosition = textWithAutoCompleteText.length\n\n    if (source === 'mouseclick') {\n      // we only need to re-focus on the text input when the autocomplete overlay\n      // steals focus due to the user clicking on a selection in the autocomplete list\n      window.setTimeout(() => {\n        element.focus()\n        this.setCursorPosition(newCaretPosition)\n      }, 0)\n    } else {\n      this.setCursorPosition(newCaretPosition)\n    }\n\n    this.close()\n  }\n\n  private getMovementDirection(\n    event: React.KeyboardEvent<any>\n  ): SelectionDirection | null {\n    switch (event.key) {\n      case 'ArrowUp':\n        return 'up'\n      case 'ArrowDown':\n        return 'down'\n    }\n\n    return null\n  }\n\n  private onKeyDown = (event: React.KeyboardEvent<ElementType>) => {\n    if (this.props.onKeyDown) {\n      this.props.onKeyDown(event)\n    }\n\n    if (event.defaultPrevented) {\n      return\n    }\n\n    const currentAutoCompletionState = this.state.autocompletionState\n\n    if (\n      !currentAutoCompletionState ||\n      !currentAutoCompletionState.items.length\n    ) {\n      return\n    }\n\n    const selectedRow = currentAutoCompletionState.selectedItem\n      ? currentAutoCompletionState.items.indexOf(\n          currentAutoCompletionState.selectedItem\n        )\n      : -1\n\n    const direction = this.getMovementDirection(event)\n    if (direction) {\n      event.preventDefault()\n      const rowCount = currentAutoCompletionState.items.length\n\n      const nextRow = findNextSelectableRow(rowCount, {\n        direction,\n        row: selectedRow,\n      })\n\n      if (nextRow !== null) {\n        const newSelectedItem = currentAutoCompletionState.items[nextRow]\n\n        const newAutoCompletionState = {\n          ...currentAutoCompletionState,\n          selectedItem: newSelectedItem,\n        }\n\n        this.setState({ autocompletionState: newAutoCompletionState })\n      }\n    } else if (event.key === 'Enter' || event.key === 'Tab') {\n      const item = currentAutoCompletionState.selectedItem\n      if (item) {\n        event.preventDefault()\n\n        this.insertCompletion(item, 'keyboard')\n      }\n    } else if (event.key === 'Escape') {\n      this.close()\n    }\n  }\n\n  private close() {\n    this.setState({ autocompletionState: null })\n  }\n\n  private async attemptAutocompletion(\n    str: string,\n    caretPosition: number\n  ): Promise<IAutocompletionState<any> | null> {\n    for (const provider of this.props.autocompletionProviders) {\n      // NB: RegExps are stateful (AAAAAAAAAAAAAAAAAA) so defensively copy the\n      // regex we're given.\n      const regex = new RegExp(provider.getRegExp())\n      if (!regex.global) {\n        fatalError(\n          `The regex (${regex}) returned from ${provider} isn't global, but it should be!`\n        )\n        continue\n      }\n\n      let result: RegExpExecArray | null = null\n      while ((result = regex.exec(str))) {\n        const index = regex.lastIndex\n        const text = result[1] || ''\n        if (index === caretPosition) {\n          const range = { start: index - text.length, length: text.length }\n          const items = await provider.getAutocompletionItems(text)\n\n          const selectedItem = items[0]\n          return { provider, items, range, selectedItem, rangeText: text }\n        }\n      }\n    }\n\n    return null\n  }\n\n  private onChange = async (event: React.FormEvent<ElementType>) => {\n    const str = event.currentTarget.value\n\n    if (this.props.onValueChanged) {\n      this.props.onValueChanged(str)\n    }\n\n    const element = this.element\n\n    if (element === null) {\n      return\n    }\n\n    const caretPosition = element.selectionStart\n\n    if (caretPosition === null) {\n      return\n    }\n\n    const requestID = ++this.autocompletionRequestID\n    const autocompletionState = await this.attemptAutocompletion(\n      str,\n      caretPosition\n    )\n\n    // If another autocompletion request is in flight, then ignore these\n    // results.\n    if (requestID !== this.autocompletionRequestID) {\n      return\n    }\n\n    this.setState({ autocompletionState })\n  }\n}\n","import { AutocompletingTextInput } from './autocompleting-text-input'\n\nexport class AutocompletingTextArea extends AutocompletingTextInput<\n  HTMLTextAreaElement\n> {\n  protected getElementTagName(): 'textarea' | 'input' {\n    return 'textarea'\n  }\n}\nexport class AutocompletingInput extends AutocompletingTextInput<\n  HTMLInputElement\n> {\n  protected getElementTagName(): 'textarea' | 'input' {\n    return 'input'\n  }\n}\n\n/** An interface which defines the protocol for an autocompletion provider. */\nexport interface IAutocompletionProvider<T> {\n  /**\n   * The type of auto completion provided this instance implements. Used\n   * for variable width auto completion popups depending on type.\n   */\n  kind: 'emoji' | 'user' | 'issue'\n\n  /**\n   * Get the regex which it used to capture text for the provider. The text\n   * captured in the first group will then be passed to `getAutocompletionItems`\n   * to get autocompletions.\n   *\n   * The returned regex *must* be global.\n   */\n  getRegExp(): RegExp\n\n  /**\n   * Get the autocompletion results for the given text. The text is whatever was\n   * captured in the first group by the regex returned from `getRegExp`.\n   */\n  getAutocompletionItems(text: string): Promise<ReadonlyArray<T>>\n\n  /**\n   * Render the autocompletion item. The item will be one which the provider\n   * returned from `getAutocompletionItems`.\n   */\n  renderItem(item: T): JSX.Element\n\n  /**\n   * Returns a text representation of a given autocompletion results.\n   * This is the text that will end up going into the textbox if the\n   * user chooses to autocomplete a particular item.\n   */\n  getCompletionText(item: T): string\n}\n","import * as React from 'react'\nimport * as classNames from 'classnames'\nimport {\n  AutocompletingTextArea,\n  AutocompletingInput,\n  IAutocompletionProvider,\n  UserAutocompletionProvider,\n} from '../autocompletion'\nimport { CommitIdentity } from '../../models/commit-identity'\nimport { ICommitMessage } from '../../lib/app-state'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { IGitHubUser } from '../../lib/databases/github-user-database'\nimport { Repository } from '../../models/repository'\nimport { Button } from '../lib/button'\nimport { Avatar } from '../lib/avatar'\nimport { Loading } from '../lib/loading'\nimport { structuralEquals } from '../../lib/equality'\nimport { generateGravatarUrl } from '../../lib/gravatar'\nimport { AuthorInput } from '../lib/author-input'\nimport { FocusContainer } from '../lib/focus-container'\nimport { showContextualMenu } from '../main-process-proxy'\nimport { Octicon, OcticonSymbol } from '../octicons'\nimport { ITrailer } from '../../lib/git/interpret-trailers'\nimport { IAuthor } from '../../models/author'\nimport { IMenuItem } from '../../lib/menu-item'\n\nconst addAuthorIcon = new OcticonSymbol(\n  12,\n  7,\n  'M9.875 2.125H12v1.75H9.875V6h-1.75V3.875H6v-1.75h2.125V0h1.75v2.125zM6 ' +\n    '6.5a.5.5 0 0 1-.5.5h-5a.5.5 0 0 1-.5-.5V6c0-1.316 2-2 2-2s.114-.204 ' +\n    '0-.5c-.42-.31-.472-.795-.5-2C1.587.293 2.434 0 3 0s1.413.293 1.5 1.5c-.028 ' +\n    '1.205-.08 1.69-.5 2-.114.295 0 .5 0 .5s2 .684 2 2v.5z'\n)\n\ninterface ICommitMessageProps {\n  readonly onCreateCommit: (\n    summary: string,\n    description: string | null,\n    trailers?: ReadonlyArray<ITrailer>\n  ) => Promise<boolean>\n  readonly branch: string | null\n  readonly commitAuthor: CommitIdentity | null\n  readonly gitHubUser: IGitHubUser | null\n  readonly anyFilesSelected: boolean\n  readonly commitMessage: ICommitMessage | null\n  readonly contextualCommitMessage: ICommitMessage | null\n  readonly repository: Repository\n  readonly dispatcher: Dispatcher\n  readonly autocompletionProviders: ReadonlyArray<IAutocompletionProvider<any>>\n  readonly isCommitting: boolean\n  readonly placeholder: string\n  readonly singleFileCommit: boolean\n\n  /**\n   * Whether or not to show a field for adding co-authors to\n   * a commit (currently only supported for GH/GHE repositories)\n   */\n  readonly showCoAuthoredBy: boolean\n\n  /**\n   * A list of authors (name, email pairs) which have been\n   * entered into the co-authors input box in the commit form\n   * and which _may_ be used in the subsequent commit to add\n   * Co-Authored-By commit message trailers depending on whether\n   * the user has chosen to do so.\n   */\n  readonly coAuthors: ReadonlyArray<IAuthor>\n}\n\ninterface ICommitMessageState {\n  readonly summary: string\n  readonly description: string | null\n\n  /** The last contextual commit message we've received. */\n  readonly lastContextualCommitMessage: ICommitMessage | null\n\n  readonly userAutocompletionProvider: UserAutocompletionProvider | null\n\n  /**\n   * Whether or not the description text area has more text that's\n   * obscured by the action bar. Note that this will always be\n   * false when there's no action bar.\n   */\n  readonly descriptionObscured: boolean\n}\n\nfunction findUserAutoCompleteProvider(\n  providers: ReadonlyArray<IAutocompletionProvider<any>>\n): UserAutocompletionProvider | null {\n  for (const provider of providers) {\n    if (provider instanceof UserAutocompletionProvider) {\n      return provider\n    }\n  }\n\n  return null\n}\n\nexport class CommitMessage extends React.Component<\n  ICommitMessageProps,\n  ICommitMessageState\n> {\n  private descriptionComponent: AutocompletingTextArea | null = null\n\n  private descriptionTextArea: HTMLTextAreaElement | null = null\n  private descriptionTextAreaScrollDebounceId: number | null = null\n\n  public constructor(props: ICommitMessageProps) {\n    super(props)\n\n    this.state = {\n      summary: '',\n      description: '',\n      lastContextualCommitMessage: null,\n      userAutocompletionProvider: findUserAutoCompleteProvider(\n        props.autocompletionProviders\n      ),\n      descriptionObscured: false,\n    }\n  }\n\n  public componentWillMount() {\n    this.receiveProps(this.props, true)\n  }\n\n  public componentWillUnmount() {\n    // We're unmounting, likely due to the user switching to the history tab.\n    // Let's persist our commit message in the dispatcher.\n    this.props.dispatcher.setCommitMessage(this.props.repository, this.state)\n  }\n\n  public componentWillReceiveProps(nextProps: ICommitMessageProps) {\n    this.receiveProps(nextProps, false)\n  }\n\n  private receiveProps(nextProps: ICommitMessageProps, initializing: boolean) {\n    // If we're switching away from one repository to another we'll persist\n    // our commit message in the dispatcher.\n    if (nextProps.repository.id !== this.props.repository.id) {\n      this.props.dispatcher.setCommitMessage(this.props.repository, this.state)\n    }\n\n    if (\n      nextProps.autocompletionProviders !== this.props.autocompletionProviders\n    ) {\n      this.setState({\n        userAutocompletionProvider: findUserAutoCompleteProvider(\n          nextProps.autocompletionProviders\n        ),\n      })\n    }\n\n    // This is rather gnarly. We want to persist the commit message (summary,\n    // and description) in the dispatcher on a per-repository level (git-store).\n    //\n    // Our dispatcher is asynchronous and only emits and update on animation\n    // frames. This is a great thing for performance but it gets real messy\n    // when you throw text boxes into the mix. If we went for a traditional\n    // approach of persisting the textbox values in the dispatcher and updating\n    // the virtual dom when we get new props there's an interim state which\n    // means that the browser can't keep track of the cursor for us, see:\n    //\n    //   http://stackoverflow.com/a/28922465\n    //\n    // So in order to work around that we keep the text values in the component\n    // state. Whenever they get updated we submit the update to the dispatcher\n    // but we disregard the message that flows to us on the subsequent animation\n    // frame unless we have switched repositories.\n    //\n    // Then there's the case when we're being mounted (think switching between\n    // history and changes tabs. In that case we have to rely on what's in the\n    // dispatcher since we don't have any state of our own.\n\n    const nextContextualCommitMessage = nextProps.contextualCommitMessage\n    const lastContextualCommitMessage = this.state.lastContextualCommitMessage\n    // If the contextual commit message changed, we'll use it as our commit\n    // message.\n    if (\n      nextContextualCommitMessage &&\n      (!lastContextualCommitMessage ||\n        !structuralEquals(\n          nextContextualCommitMessage,\n          lastContextualCommitMessage\n        ))\n    ) {\n      this.setState({\n        summary: nextContextualCommitMessage.summary,\n        description: nextContextualCommitMessage.description,\n        lastContextualCommitMessage: nextContextualCommitMessage,\n      })\n    } else if (\n      initializing ||\n      this.props.repository.id !== nextProps.repository.id\n    ) {\n      // We're either initializing (ie being mounted) or someone has switched\n      // repositories. If we receive a message we'll take it\n      if (nextProps.commitMessage) {\n        // Don't update dispatcher here, we're receiving it, could cause never-\n        // ending loop.\n        this.setState({\n          summary: nextProps.commitMessage.summary,\n          description: nextProps.commitMessage.description,\n          lastContextualCommitMessage: nextContextualCommitMessage,\n        })\n      } else {\n        // No message, assume clean slate\n        this.setState({\n          summary: '',\n          description: null,\n          lastContextualCommitMessage: nextContextualCommitMessage,\n        })\n      }\n    } else {\n      this.setState({\n        lastContextualCommitMessage: nextContextualCommitMessage,\n      })\n    }\n  }\n\n  private clearCommitMessage() {\n    this.setState({ summary: '', description: null })\n  }\n\n  private onSummaryChanged = (summary: string) => {\n    this.setState({ summary })\n  }\n\n  private onDescriptionChanged = (description: string) => {\n    this.setState({ description })\n  }\n\n  private onSubmit = () => {\n    this.createCommit()\n  }\n\n  private getCoAuthorTrailers() {\n    if (!this.isCoAuthorInputEnabled) {\n      return []\n    }\n\n    return this.props.coAuthors.map(a => ({\n      token: 'Co-Authored-By',\n      value: `${a.name} <${a.email}>`,\n    }))\n  }\n\n  private async createCommit() {\n    const { summary, description } = this.state\n\n    if (!this.canCommit()) {\n      return\n    }\n\n    const trailers = this.getCoAuthorTrailers()\n\n    const commitCreated = await this.props.onCreateCommit(\n      // allow single file commit without summary\n      this.props.singleFileCommit && !this.state.summary\n        ? this.props.placeholder\n        : summary,\n      description,\n      trailers\n    )\n\n    if (commitCreated) {\n      this.clearCommitMessage()\n    }\n  }\n\n  private canCommit(): boolean {\n    return (\n      (this.props.anyFilesSelected && this.state.summary.length > 0) ||\n      this.props.singleFileCommit\n    )\n  }\n\n  private onKeyDown = (event: React.KeyboardEvent<Element>) => {\n    if (event.defaultPrevented) {\n      return\n    }\n\n    const isShortcutKey = __DARWIN__ ? event.metaKey : event.ctrlKey\n    if (isShortcutKey && event.key === 'Enter' && this.canCommit()) {\n      this.createCommit()\n      event.preventDefault()\n    }\n  }\n\n  private renderAvatar() {\n    const commitAuthor = this.props.commitAuthor\n    const avatarTitle = commitAuthor\n      ? `Committing as ${commitAuthor.name} <${commitAuthor.email}>`\n      : undefined\n    let avatarUser = undefined\n\n    if (commitAuthor) {\n      const avatarURL = this.props.gitHubUser\n        ? this.props.gitHubUser.avatarURL\n        : generateGravatarUrl(commitAuthor.email)\n\n      avatarUser = {\n        email: commitAuthor.email,\n        name: commitAuthor.name,\n        avatarURL,\n      }\n    }\n\n    return <Avatar user={avatarUser} title={avatarTitle} />\n  }\n\n  private get isCoAuthorInputEnabled() {\n    return this.props.repository.gitHubRepository !== null\n  }\n\n  private get isCoAuthorInputVisible() {\n    return this.props.showCoAuthoredBy && this.isCoAuthorInputEnabled\n  }\n\n  private onCoAuthorsUpdated = (coAuthors: ReadonlyArray<IAuthor>) => {\n    this.props.dispatcher.setCoAuthors(this.props.repository, coAuthors)\n  }\n\n  private renderCoAuthorInput() {\n    if (!this.isCoAuthorInputVisible) {\n      return null\n    }\n\n    const autocompletionProvider = this.state.userAutocompletionProvider\n\n    if (!autocompletionProvider) {\n      return null\n    }\n\n    return (\n      <AuthorInput\n        onAuthorsUpdated={this.onCoAuthorsUpdated}\n        authors={this.props.coAuthors}\n        autoCompleteProvider={autocompletionProvider}\n        disabled={this.props.isCommitting}\n      />\n    )\n  }\n\n  private onToggleCoAuthors = () => {\n    this.props.dispatcher.setShowCoAuthoredBy(\n      this.props.repository,\n      !this.props.showCoAuthoredBy\n    )\n  }\n\n  private get toggleCoAuthorsText(): string {\n    return this.props.showCoAuthoredBy\n      ? __DARWIN__\n        ? 'Remove Co-Authors'\n        : 'Remove co-authors'\n      : __DARWIN__\n        ? 'Add Co-Authors'\n        : 'Add co-authors'\n  }\n\n  private getAddRemoveCoAuthorsMenuItem(): IMenuItem {\n    return {\n      label: this.toggleCoAuthorsText,\n      action: this.onToggleCoAuthors,\n      enabled:\n        this.props.repository.gitHubRepository !== null &&\n        !this.props.isCommitting,\n    }\n  }\n\n  private onContextMenu = (event: React.MouseEvent<any>) => {\n    if (event.defaultPrevented) {\n      return\n    }\n\n    event.preventDefault()\n\n    const items: IMenuItem[] = [this.getAddRemoveCoAuthorsMenuItem()]\n    showContextualMenu(items)\n  }\n\n  private onAutocompletingInputContextMenu = (event: React.MouseEvent<any>) => {\n    event.preventDefault()\n\n    const items: IMenuItem[] = [\n      this.getAddRemoveCoAuthorsMenuItem(),\n      { type: 'separator' },\n      { role: 'editMenu' },\n    ]\n\n    showContextualMenu(items)\n  }\n\n  private onCoAuthorToggleButtonClick = (\n    e: React.MouseEvent<HTMLButtonElement>\n  ) => {\n    e.preventDefault()\n    this.onToggleCoAuthors()\n  }\n\n  private renderCoAuthorToggleButton() {\n    if (this.props.repository.gitHubRepository === null) {\n      return null\n    }\n\n    return (\n      <button\n        className=\"co-authors-toggle\"\n        onClick={this.onCoAuthorToggleButtonClick}\n        tabIndex={-1}\n        aria-label={this.toggleCoAuthorsText}\n        disabled={this.props.isCommitting}\n      >\n        <Octicon symbol={addAuthorIcon} />\n      </button>\n    )\n  }\n\n  private onDescriptionFieldRef = (\n    component: AutocompletingTextArea | null\n  ) => {\n    this.descriptionComponent = component\n  }\n\n  private onDescriptionTextAreaScroll = () => {\n    this.descriptionTextAreaScrollDebounceId = null\n\n    const elem = this.descriptionTextArea\n    const descriptionObscured =\n      elem !== null && elem.scrollTop + elem.offsetHeight < elem.scrollHeight\n\n    if (this.state.descriptionObscured !== descriptionObscured) {\n      this.setState({ descriptionObscured })\n    }\n  }\n\n  private onDescriptionTextAreaRef = (elem: HTMLTextAreaElement | null) => {\n    if (elem) {\n      elem.addEventListener('scroll', () => {\n        if (this.descriptionTextAreaScrollDebounceId !== null) {\n          cancelAnimationFrame(this.descriptionTextAreaScrollDebounceId)\n          this.descriptionTextAreaScrollDebounceId = null\n        }\n        this.descriptionTextAreaScrollDebounceId = requestAnimationFrame(\n          this.onDescriptionTextAreaScroll\n        )\n      })\n    }\n\n    this.descriptionTextArea = elem\n  }\n\n  private onFocusContainerClick = (event: React.MouseEvent<HTMLDivElement>) => {\n    if (this.descriptionComponent) {\n      this.descriptionComponent.focus()\n    }\n  }\n\n  /**\n   * Whether or not there's anything to render in the action bar\n   */\n  private get isActionBarEnabled() {\n    return this.isCoAuthorInputEnabled\n  }\n\n  private renderActionBar() {\n    if (!this.isCoAuthorInputEnabled) {\n      return null\n    }\n\n    const className = classNames('action-bar', {\n      disabled: this.props.isCommitting,\n    })\n\n    return <div className={className}>{this.renderCoAuthorToggleButton()}</div>\n  }\n\n  public render() {\n    const branchName = this.props.branch ? this.props.branch : 'master'\n\n    const isSummaryWhiteSpace = this.state.summary.match(/^\\s+$/g)\n    const buttonEnabled =\n      this.canCommit() && !this.props.isCommitting && !isSummaryWhiteSpace\n\n    const loading = this.props.isCommitting ? <Loading /> : undefined\n    const className = classNames({\n      'with-action-bar': this.isActionBarEnabled,\n      'with-co-authors': this.isCoAuthorInputVisible,\n    })\n\n    const descriptionClassName = classNames('description-field', {\n      'with-overflow': this.state.descriptionObscured,\n    })\n\n    return (\n      <div\n        id=\"commit-message\"\n        role=\"group\"\n        aria-label=\"Create commit\"\n        className={className}\n        onContextMenu={this.onContextMenu}\n        onKeyDown={this.onKeyDown}\n      >\n        <div className=\"summary\">\n          {this.renderAvatar()}\n\n          <AutocompletingInput\n            isRequired={true}\n            className=\"summary-field\"\n            placeholder={this.props.placeholder}\n            value={this.state.summary}\n            onValueChanged={this.onSummaryChanged}\n            autocompletionProviders={this.props.autocompletionProviders}\n            onContextMenu={this.onAutocompletingInputContextMenu}\n            disabled={this.props.isCommitting}\n          />\n        </div>\n\n        <FocusContainer\n          className=\"description-focus-container\"\n          onClick={this.onFocusContainerClick}\n        >\n          <AutocompletingTextArea\n            className={descriptionClassName}\n            placeholder=\"Description\"\n            value={this.state.description || ''}\n            onValueChanged={this.onDescriptionChanged}\n            autocompletionProviders={this.props.autocompletionProviders}\n            ref={this.onDescriptionFieldRef}\n            onElementRef={this.onDescriptionTextAreaRef}\n            onContextMenu={this.onAutocompletingInputContextMenu}\n            disabled={this.props.isCommitting}\n          />\n          {this.renderActionBar()}\n        </FocusContainer>\n\n        {this.renderCoAuthorInput()}\n\n        <Button\n          type=\"submit\"\n          className=\"commit-button\"\n          onClick={this.onSubmit}\n          disabled={!buttonEnabled}\n        >\n          {loading}\n          <span title={`Commit to ${branchName}`}>\n            {loading ? 'Committing' : 'Commit'} to <strong>{branchName}</strong>\n          </span>\n        </Button>\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport * as Path from 'path'\n\nimport { ICommitMessage } from '../../lib/app-state'\nimport { IGitHubUser } from '../../lib/databases'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { ITrailer } from '../../lib/git/interpret-trailers'\nimport { IMenuItem } from '../../lib/menu-item'\nimport { revealInFileManager } from '../../lib/app-shell'\nimport {\n  AppFileStatus,\n  WorkingDirectoryStatus,\n  WorkingDirectoryFileChange,\n} from '../../models/status'\nimport { DiffSelectionType } from '../../models/diff'\nimport { CommitIdentity } from '../../models/commit-identity'\nimport { Repository } from '../../models/repository'\nimport { IAuthor } from '../../models/author'\nimport { List, ClickSource } from '../lib/list'\nimport { Checkbox, CheckboxValue } from '../lib/checkbox'\nimport {\n  isSafeFileExtension,\n  DefaultEditorLabel,\n  RevealInFileManagerLabel,\n  OpenWithDefaultProgramLabel,\n} from '../lib/context-menu'\nimport { CommitMessage } from './commit-message'\nimport { ChangedFile } from './changed-file'\nimport { IAutocompletionProvider } from '../autocompletion'\nimport { showContextualMenu } from '../main-process-proxy'\nimport { arrayEquals } from '../../lib/equality'\n\nconst RowHeight = 29\n\nconst GitIgnoreFileName = '.gitignore'\n\ninterface IChangesListProps {\n  readonly repository: Repository\n  readonly workingDirectory: WorkingDirectoryStatus\n  readonly selectedFileIDs: string[]\n  readonly onFileSelectionChanged: (rows: ReadonlyArray<number>) => void\n  readonly onIncludeChanged: (path: string, include: boolean) => void\n  readonly onSelectAll: (selectAll: boolean) => void\n  readonly onCreateCommit: (\n    summary: string,\n    description: string | null,\n    trailers?: ReadonlyArray<ITrailer>\n  ) => Promise<boolean>\n  readonly onDiscardChanges: (file: WorkingDirectoryFileChange) => void\n  readonly askForConfirmationOnDiscardChanges: boolean\n  readonly onDiscardAllChanges: (\n    files: ReadonlyArray<WorkingDirectoryFileChange>,\n    isDiscardingAllChanges?: boolean\n  ) => void\n\n  /**\n   * Called to open a file it its default application\n   * @param path The path of the file relative to the root of the repository\n   */\n  readonly onOpenItem: (path: string) => void\n  readonly branch: string | null\n  readonly commitAuthor: CommitIdentity | null\n  readonly gitHubUser: IGitHubUser | null\n  readonly dispatcher: Dispatcher\n  readonly availableWidth: number\n  readonly isCommitting: boolean\n\n  /**\n   * Click event handler passed directly to the onRowClick prop of List, see\n   * List Props for documentation.\n   */\n  readonly onRowClick?: (row: number, source: ClickSource) => void\n  readonly commitMessage: ICommitMessage | null\n  readonly contextualCommitMessage: ICommitMessage | null\n\n  /** The autocompletion providers available to the repository. */\n  readonly autocompletionProviders: ReadonlyArray<IAutocompletionProvider<any>>\n\n  /** Called when the given pattern should be ignored. */\n  readonly onIgnore: (pattern: string | string[]) => void\n\n  /**\n   * Whether or not to show a field for adding co-authors to\n   * a commit (currently only supported for GH/GHE repositories)\n   */\n  readonly showCoAuthoredBy: boolean\n\n  /**\n   * A list of authors (name, email pairs) which have been\n   * entered into the co-authors input box in the commit form\n   * and which _may_ be used in the subsequent commit to add\n   * Co-Authored-By commit message trailers depending on whether\n   * the user has chosen to do so.\n   */\n  readonly coAuthors: ReadonlyArray<IAuthor>\n\n  /** The name of the currently selected external editor */\n  readonly externalEditorLabel?: string\n\n  /**\n   * Callback to open a selected file using the configured external editor\n   *\n   * @param fullPath The full path to the file on disk\n   */\n  readonly onOpenInExternalEditor: (fullPath: string) => void\n}\n\ninterface IChangesState {\n  readonly selectedRows: ReadonlyArray<number>\n}\n\nfunction getSelectedRowsFromProps(\n  props: IChangesListProps\n): ReadonlyArray<number> {\n  const selectedFileIDs = props.selectedFileIDs\n  const selectedRows = []\n\n  for (const id of selectedFileIDs) {\n    const ix = props.workingDirectory.findFileIndexByID(id)\n    if (ix !== -1) {\n      selectedRows.push(ix)\n    }\n  }\n\n  return selectedRows\n}\n\nexport class ChangesList extends React.Component<\n  IChangesListProps,\n  IChangesState\n> {\n  public constructor(props: IChangesListProps) {\n    super(props)\n    this.state = {\n      selectedRows: getSelectedRowsFromProps(props),\n    }\n  }\n\n  public componentWillReceiveProps(nextProps: IChangesListProps) {\n    // No need to update state unless we haven't done it yet or the\n    // selected file id list has changed.\n    if (\n      !arrayEquals(nextProps.selectedFileIDs, this.props.selectedFileIDs) ||\n      !arrayEquals(\n        nextProps.workingDirectory.files,\n        this.props.workingDirectory.files\n      )\n    ) {\n      this.setState({ selectedRows: getSelectedRowsFromProps(nextProps) })\n    }\n  }\n\n  private onIncludeAllChanged = (event: React.FormEvent<HTMLInputElement>) => {\n    const include = event.currentTarget.checked\n    this.props.onSelectAll(include)\n  }\n\n  private renderRow = (row: number): JSX.Element => {\n    const file = this.props.workingDirectory.files[row]\n    const selection = file.selection.getSelectionType()\n\n    const includeAll =\n      selection === DiffSelectionType.All\n        ? true\n        : selection === DiffSelectionType.None\n          ? false\n          : null\n\n    return (\n      <ChangedFile\n        id={file.id}\n        path={file.path}\n        status={file.status}\n        oldPath={file.oldPath}\n        include={includeAll}\n        key={file.id}\n        onContextMenu={this.onItemContextMenu}\n        onIncludeChanged={this.props.onIncludeChanged}\n        availableWidth={this.props.availableWidth}\n        disableSelection={this.props.isCommitting}\n      />\n    )\n  }\n\n  private get includeAllValue(): CheckboxValue {\n    const includeAll = this.props.workingDirectory.includeAll\n    if (includeAll === true) {\n      return CheckboxValue.On\n    } else if (includeAll === false) {\n      return CheckboxValue.Off\n    } else {\n      return CheckboxValue.Mixed\n    }\n  }\n\n  private onDiscardAllChanges = () => {\n    this.props.onDiscardAllChanges(this.props.workingDirectory.files)\n  }\n\n  private onDiscardChanges = (files: ReadonlyArray<string>) => {\n    const workingDirectory = this.props.workingDirectory\n\n    if (files.length === 1) {\n      const modifiedFile = workingDirectory.files.find(f => f.path === files[0])\n\n      if (modifiedFile != null) {\n        this.props.onDiscardChanges(modifiedFile)\n      }\n    } else {\n      const modifiedFiles = new Array<WorkingDirectoryFileChange>()\n\n      files.forEach(file => {\n        const modifiedFile = workingDirectory.files.find(f => f.path === file)\n\n        if (modifiedFile != null) {\n          modifiedFiles.push(modifiedFile)\n        }\n      })\n\n      if (modifiedFiles.length > 0) {\n        // DiscardAllChanges can also be used for discarding several selected changes.\n        // Therefore, we update the pop up to reflect whether or not it is \"all\" changes.\n        const discardingAllChanges =\n          modifiedFiles.length === workingDirectory.files.length\n\n        this.props.onDiscardAllChanges(modifiedFiles, discardingAllChanges)\n      }\n    }\n  }\n\n  private getDiscardChangesMenuItemLabel = (files: ReadonlyArray<string>) => {\n    const label =\n      files.length === 1\n        ? __DARWIN__\n          ? `Discard Changes`\n          : `Discard changes`\n        : __DARWIN__\n          ? `Discard ${files.length} Selected Changes`\n          : `Discard ${files.length} selected changes`\n\n    return this.props.askForConfirmationOnDiscardChanges ? `${label}` : label\n  }\n\n  private onContextMenu = (event: React.MouseEvent<any>) => {\n    event.preventDefault()\n\n    const items: IMenuItem[] = [\n      {\n        label: __DARWIN__ ? 'Discard All Changes' : 'Discard all changes',\n        action: this.onDiscardAllChanges,\n        enabled: this.props.workingDirectory.files.length > 0,\n      },\n    ]\n\n    showContextualMenu(items)\n  }\n\n  private onItemContextMenu = (\n    id: string,\n    path: string,\n    status: AppFileStatus,\n    event: React.MouseEvent<HTMLDivElement>\n  ) => {\n    event.preventDefault()\n\n    const extension = Path.extname(path)\n    const isSafeExtension = isSafeFileExtension(extension)\n    const openInExternalEditor = this.props.externalEditorLabel\n      ? `Open in ${this.props.externalEditorLabel}`\n      : DefaultEditorLabel\n\n    const wd = this.props.workingDirectory\n    const selectedFiles = new Array<WorkingDirectoryFileChange>()\n    const paths = new Array<string>()\n    const extensions = new Set<string>()\n\n    const addItemToArray = (fileID: string) => {\n      const newFile = wd.findFileWithID(fileID)\n      if (newFile) {\n        selectedFiles.push(newFile)\n        paths.push(newFile.path)\n\n        const extension = Path.extname(newFile.path)\n        if (extension.length) {\n          extensions.add(extension)\n        }\n      }\n    }\n\n    if (this.props.selectedFileIDs.includes(id)) {\n      // user has selected a file inside an existing selection\n      // -> context menu entries should be applied to all selected files\n      this.props.selectedFileIDs.forEach(addItemToArray)\n    } else {\n      // this is outside their previous selection\n      // -> context menu entries should be applied to just this file\n      addItemToArray(id)\n    }\n\n    const items: IMenuItem[] = [\n      {\n        label: this.getDiscardChangesMenuItemLabel(paths),\n        action: () => this.onDiscardChanges(paths),\n      },\n      {\n        label: __DARWIN__ ? 'Discard All Changes' : 'Discard all changes',\n        action: () => this.onDiscardAllChanges(),\n      },\n      { type: 'separator' },\n    ]\n\n    if (paths.length === 1) {\n      items.push({\n        label: __DARWIN__ ? 'Ignore File' : 'Ignore file',\n        action: () => this.props.onIgnore(path),\n        enabled: Path.basename(path) !== GitIgnoreFileName,\n      })\n    } else if (paths.length > 1) {\n      items.push({\n        label: `Ignore ${paths.length} selected files`,\n        action: () => {\n          // Filter out any .gitignores that happens to be selected, ignoring\n          // those doesn't make sense.\n          this.props.onIgnore(\n            paths.filter(path => Path.basename(path) !== GitIgnoreFileName)\n          )\n        },\n        // Enable this action as long as there's something selected which isn't\n        // a .gitignore file.\n        enabled: paths.some(path => Path.basename(path) !== GitIgnoreFileName),\n      })\n    }\n\n    // Five menu items should be enough for everyone\n    Array.from(extensions)\n      .slice(0, 5)\n      .forEach(extension => {\n        items.push({\n          label: __DARWIN__\n            ? `Ignore All ${extension} Files`\n            : `Ignore all ${extension} files`,\n          action: () => this.props.onIgnore(`*${extension}`),\n        })\n      })\n\n    items.push(\n      { type: 'separator' },\n      {\n        label: RevealInFileManagerLabel,\n        action: () => revealInFileManager(this.props.repository, path),\n        enabled: status !== AppFileStatus.Deleted,\n      },\n      {\n        label: openInExternalEditor,\n        action: () => {\n          const fullPath = Path.join(this.props.repository.path, path)\n          this.props.onOpenInExternalEditor(fullPath)\n        },\n        enabled: isSafeExtension && status !== AppFileStatus.Deleted,\n      },\n      {\n        label: OpenWithDefaultProgramLabel,\n        action: () => this.props.onOpenItem(path),\n        enabled: isSafeExtension && status !== AppFileStatus.Deleted,\n      }\n    )\n\n    showContextualMenu(items)\n  }\n\n  public render() {\n    const fileList = this.props.workingDirectory.files\n    const fileCount = fileList.length\n    const filesPlural = fileCount === 1 ? 'file' : 'files'\n    const filesDescription = `${fileCount} changed ${filesPlural}`\n    const anyFilesSelected =\n      fileCount > 0 && this.includeAllValue !== CheckboxValue.Off\n    const filesSelected = this.props.workingDirectory.files.filter(\n      f => f.selection.getSelectionType() !== DiffSelectionType.None\n    )\n    const singleFileCommit = filesSelected.length === 1\n\n    return (\n      <div className=\"changes-list-container file-list\">\n        <div className=\"header\" onContextMenu={this.onContextMenu}>\n          <Checkbox\n            label={filesDescription}\n            value={this.includeAllValue}\n            onChange={this.onIncludeAllChanged}\n            disabled={fileCount === 0 || this.props.isCommitting}\n          />\n        </div>\n\n        <List\n          id=\"changes-list\"\n          rowCount={this.props.workingDirectory.files.length}\n          rowHeight={RowHeight}\n          rowRenderer={this.renderRow}\n          selectedRows={this.state.selectedRows}\n          selectionMode=\"multi\"\n          onSelectionChanged={this.props.onFileSelectionChanged}\n          invalidationProps={this.props.workingDirectory}\n          onRowClick={this.props.onRowClick}\n        />\n\n        <CommitMessage\n          onCreateCommit={this.props.onCreateCommit}\n          branch={this.props.branch}\n          gitHubUser={this.props.gitHubUser}\n          commitAuthor={this.props.commitAuthor}\n          anyFilesSelected={anyFilesSelected}\n          repository={this.props.repository}\n          dispatcher={this.props.dispatcher}\n          commitMessage={this.props.commitMessage}\n          contextualCommitMessage={this.props.contextualCommitMessage}\n          autocompletionProviders={this.props.autocompletionProviders}\n          isCommitting={this.props.isCommitting}\n          showCoAuthoredBy={this.props.showCoAuthoredBy}\n          coAuthors={this.props.coAuthors}\n          placeholder={\n            singleFileCommit\n              ? `Update ${filesSelected[0].path}`\n              : 'Summary (required)'\n          }\n          singleFileCommit={singleFileCommit}\n        />\n      </div>\n    )\n  }\n}\n","import * as Path from 'path'\nimport * as React from 'react'\n\nimport { ChangesList } from './changes-list'\nimport { DiffSelectionType } from '../../models/diff'\nimport { IChangesState, PopupType } from '../../lib/app-state'\nimport { Repository } from '../../models/repository'\nimport { Dispatcher } from '../../lib/dispatcher'\nimport { IGitHubUser } from '../../lib/databases'\nimport { IssuesStore, GitHubUserStore } from '../../lib/stores'\nimport { CommitIdentity } from '../../models/commit-identity'\nimport { Commit } from '../../models/commit'\nimport { UndoCommit } from './undo-commit'\nimport {\n  IAutocompletionProvider,\n  EmojiAutocompletionProvider,\n  IssuesAutocompletionProvider,\n  UserAutocompletionProvider,\n} from '../autocompletion'\nimport { ClickSource } from '../lib/list'\nimport { WorkingDirectoryFileChange } from '../../models/status'\nimport { CSSTransitionGroup } from 'react-transition-group'\nimport { openFile } from '../../lib/open-file'\nimport { ITrailer } from '../../lib/git/interpret-trailers'\nimport { Account } from '../../models/account'\n\n/**\n * The timeout for the animation of the enter/leave animation for Undo.\n *\n * Note that this *must* match the duration specified for the `undo` transitions\n * in `_changes-list.scss`.\n */\nconst UndoCommitAnimationTimeout = 500\n\ninterface IChangesSidebarProps {\n  readonly repository: Repository\n  readonly changes: IChangesState\n  readonly dispatcher: Dispatcher\n  readonly commitAuthor: CommitIdentity | null\n  readonly branch: string | null\n  readonly gitHubUsers: Map<string, IGitHubUser>\n  readonly emoji: Map<string, string>\n  readonly mostRecentLocalCommit: Commit | null\n  readonly issuesStore: IssuesStore\n  readonly availableWidth: number\n  readonly isCommitting: boolean\n  readonly isPushPullFetchInProgress: boolean\n  readonly gitHubUserStore: GitHubUserStore\n  readonly askForConfirmationOnDiscardChanges: boolean\n  readonly accounts: ReadonlyArray<Account>\n  /** The name of the currently selected external editor */\n  readonly externalEditorLabel?: string\n\n  /**\n   * Callback to open a selected file using the configured external editor\n   *\n   * @param fullPath The full path to the file on disk\n   */\n  readonly onOpenInExternalEditor: (fullPath: string) => void\n}\n\nexport class ChangesSidebar extends React.Component<IChangesSidebarProps, {}> {\n  private autocompletionProviders: ReadonlyArray<\n    IAutocompletionProvider<any>\n  > | null = null\n\n  public constructor(props: IChangesSidebarProps) {\n    super(props)\n\n    this.receiveProps(props)\n  }\n\n  public componentWillReceiveProps(nextProps: IChangesSidebarProps) {\n    this.receiveProps(nextProps)\n  }\n\n  private receiveProps(props: IChangesSidebarProps) {\n    if (\n      this.autocompletionProviders === null ||\n      this.props.emoji.size === 0 ||\n      props.repository.hash !== this.props.repository.hash ||\n      props.accounts !== this.props.accounts\n    ) {\n      const autocompletionProviders: IAutocompletionProvider<any>[] = [\n        new EmojiAutocompletionProvider(props.emoji),\n      ]\n\n      // Issues autocompletion is only available for GitHub repositories.\n      const gitHubRepository = props.repository.gitHubRepository\n      if (gitHubRepository) {\n        autocompletionProviders.push(\n          new IssuesAutocompletionProvider(\n            props.issuesStore,\n            gitHubRepository,\n            props.dispatcher\n          )\n        )\n\n        const account = this.props.accounts.find(\n          a => a.endpoint === gitHubRepository.endpoint\n        )\n\n        autocompletionProviders.push(\n          new UserAutocompletionProvider(\n            props.gitHubUserStore,\n            gitHubRepository,\n            account\n          )\n        )\n      }\n\n      this.autocompletionProviders = autocompletionProviders\n    }\n  }\n\n  private onCreateCommit = (\n    summary: string,\n    description: string | null,\n    trailers?: ReadonlyArray<ITrailer>\n  ): Promise<boolean> => {\n    return this.props.dispatcher.commitIncludedChanges(\n      this.props.repository,\n      summary,\n      description,\n      trailers\n    )\n  }\n\n  private onFileSelectionChanged = (rows: ReadonlyArray<number>) => {\n    const files = rows.map(i => this.props.changes.workingDirectory.files[i])\n    this.props.dispatcher.changeChangesSelection(this.props.repository, files)\n  }\n\n  private onIncludeChanged = (path: string, include: boolean) => {\n    const workingDirectory = this.props.changes.workingDirectory\n    const file = workingDirectory.files.find(f => f.path === path)\n    if (!file) {\n      console.error(\n        'unable to find working directory file to apply included change: ' +\n          path\n      )\n      return\n    }\n\n    this.props.dispatcher.changeFileIncluded(\n      this.props.repository,\n      file,\n      include\n    )\n  }\n\n  private onSelectAll = (selectAll: boolean) => {\n    this.props.dispatcher.changeIncludeAllFiles(\n      this.props.repository,\n      selectAll\n    )\n  }\n\n  private onDiscardChanges = (file: WorkingDirectoryFileChange) => {\n    if (!this.props.askForConfirmationOnDiscardChanges) {\n      this.props.dispatcher.discardChanges(this.props.repository, [file])\n    } else {\n      this.props.dispatcher.showPopup({\n        type: PopupType.ConfirmDiscardChanges,\n        repository: this.props.repository,\n        files: [file],\n      })\n    }\n  }\n\n  private onDiscardAllChanges = (\n    files: ReadonlyArray<WorkingDirectoryFileChange>,\n    isDiscardingAllChanges: boolean = true\n  ) => {\n    this.props.dispatcher.showPopup({\n      type: PopupType.ConfirmDiscardChanges,\n      repository: this.props.repository,\n      showDiscardChangesSetting: false,\n      discardingAllChanges: isDiscardingAllChanges,\n      files,\n    })\n  }\n\n  private onIgnore = (pattern: string | string[]) => {\n    this.props.dispatcher.appendIgnoreRule(this.props.repository, pattern)\n  }\n\n  /**\n   * Open file with default application.\n   * @param path The path of the file relative to the root of the repository\n   */\n  private onOpenItem = (path: string) => {\n    const fullPath = Path.join(this.props.repository.path, path)\n    openFile(fullPath, this.props.dispatcher)\n  }\n\n  /**\n   * Toggles the selection of a given working directory file.\n   * If the file is partially selected it the selection is cleared\n   * in order to match the behavior of clicking on an indeterminate\n   * checkbox.\n   */\n  private onToggleInclude(row: number) {\n    const workingDirectory = this.props.changes.workingDirectory\n    const file = workingDirectory.files[row]\n\n    if (!file) {\n      console.error('keyboard selection toggle despite no file - what?')\n      return\n    }\n\n    const currentSelection = file.selection.getSelectionType()\n\n    this.props.dispatcher.changeFileIncluded(\n      this.props.repository,\n      file,\n      currentSelection === DiffSelectionType.None\n    )\n  }\n\n  /**\n   * Handles click events from the List item container, note that this is\n   * Not the same thing as the element returned by the row renderer in ChangesList\n   */\n  private onChangedItemClick = (\n    rows: number | number[],\n    source: ClickSource\n  ) => {\n    // Toggle selection when user presses the spacebar or enter while focused\n    // on a list item or on the list's container\n    if (source.kind === 'keyboard') {\n      if (rows instanceof Array) {\n        rows.forEach(row => this.onToggleInclude(row))\n      } else {\n        this.onToggleInclude(rows)\n      }\n    }\n  }\n\n  private onUndo = () => {\n    const commit = this.props.mostRecentLocalCommit\n\n    if (commit) {\n      this.props.dispatcher.undoCommit(this.props.repository, commit)\n    }\n  }\n\n  private renderMostRecentLocalCommit() {\n    const commit = this.props.mostRecentLocalCommit\n    let child: JSX.Element | null = null\n    if (commit) {\n      child = (\n        <UndoCommit\n          isPushPullFetchInProgress={this.props.isPushPullFetchInProgress}\n          commit={commit}\n          onUndo={this.onUndo}\n          emoji={this.props.emoji}\n        />\n      )\n    }\n\n    return (\n      <CSSTransitionGroup\n        transitionName=\"undo\"\n        transitionAppear={true}\n        transitionAppearTimeout={UndoCommitAnimationTimeout}\n        transitionEnterTimeout={UndoCommitAnimationTimeout}\n        transitionLeaveTimeout={UndoCommitAnimationTimeout}\n      >\n        {child}\n      </CSSTransitionGroup>\n    )\n  }\n\n  public render() {\n    const changesState = this.props.changes\n    const selectedFileIDs = changesState.selectedFileIDs\n\n    // TODO: I think user will expect the avatar to match that which\n    // they have configured in GitHub.com as well as GHE so when we add\n    // support for GHE we should revisit this and try to update the logic\n    // to look up based on email _and_ host.\n    const email = this.props.commitAuthor ? this.props.commitAuthor.email : null\n    let user: IGitHubUser | null = null\n    if (email) {\n      user = this.props.gitHubUsers.get(email.toLowerCase()) || null\n    }\n\n    return (\n      <div id=\"changes-sidebar-contents\">\n        <ChangesList\n          dispatcher={this.props.dispatcher}\n          repository={this.props.repository}\n          workingDirectory={changesState.workingDirectory}\n          selectedFileIDs={selectedFileIDs}\n          onFileSelectionChanged={this.onFileSelectionChanged}\n          onCreateCommit={this.onCreateCommit}\n          onIncludeChanged={this.onIncludeChanged}\n          onSelectAll={this.onSelectAll}\n          onDiscardChanges={this.onDiscardChanges}\n          askForConfirmationOnDiscardChanges={\n            this.props.askForConfirmationOnDiscardChanges\n          }\n          onDiscardAllChanges={this.onDiscardAllChanges}\n          onOpenItem={this.onOpenItem}\n          onRowClick={this.onChangedItemClick}\n          commitAuthor={this.props.commitAuthor}\n          branch={this.props.branch}\n          gitHubUser={user}\n          commitMessage={this.props.changes.commitMessage}\n          contextualCommitMessage={this.props.changes.contextualCommitMessage}\n          autocompletionProviders={this.autocompletionProviders!}\n          availableWidth={this.props.availableWidth}\n          onIgnore={this.onIgnore}\n          isCommitting={this.props.isCommitting}\n          showCoAuthoredBy={this.props.changes.showCoAuthoredBy}\n          coAuthors={this.props.changes.coAuthors}\n          externalEditorLabel={this.props.externalEditorLabel}\n          onOpenInExternalEditor={this.props.onOpenInExternalEditor}\n        />\n        {this.renderMostRecentLocalCommit()}\n      </div>\n    )\n  }\n}\n","export { ChangesSidebar } from './sidebar'\nexport { Changes } from './changes'\n","import * as React from 'react'\nimport { Repository as Repo } from '../models/repository'\nimport { Commit } from '../models/commit'\nimport { TipState } from '../models/tip'\nimport { UiView } from './ui-view'\nimport { Changes, ChangesSidebar } from './changes'\nimport { NoChanges } from './changes/no-changes'\nimport { MultipleSelection } from './changes/multiple-selection'\nimport { FilesChangedBadge } from './changes/files-changed-badge'\nimport { SelectedCommit, CompareSidebar } from './history'\nimport { Resizable } from './resizable'\nimport { TabBar } from './tab-bar'\nimport {\n  IRepositoryState,\n  RepositorySectionTab,\n  ImageDiffType,\n} from '../lib/app-state'\nimport { Dispatcher } from '../lib/dispatcher'\nimport { IssuesStore, GitHubUserStore } from '../lib/stores'\nimport { assertNever } from '../lib/fatal-error'\nimport { Account } from '../models/account'\nimport { enableNotificationOfBranchUpdates } from '../lib/feature-flag'\nimport { FocusContainer } from './lib/focus-container'\nimport { OcticonSymbol, Octicon } from './octicons'\n\n/** The widest the sidebar can be with the minimum window size. */\nconst MaxSidebarWidth = 495\n\ninterface IRepositoryViewProps {\n  readonly repository: Repo\n  readonly state: IRepositoryState\n  readonly dispatcher: Dispatcher\n  readonly emoji: Map<string, string>\n  readonly sidebarWidth: number\n  readonly commitSummaryWidth: number\n  readonly issuesStore: IssuesStore\n  readonly gitHubUserStore: GitHubUserStore\n  readonly onViewCommitOnGitHub: (SHA: string) => void\n  readonly imageDiffType: ImageDiffType\n  readonly askForConfirmationOnDiscardChanges: boolean\n  readonly accounts: ReadonlyArray<Account>\n\n  /** The name of the currently selected external editor */\n  readonly externalEditorLabel?: string\n\n  /**\n   * Callback to open a selected file using the configured external editor\n   *\n   * @param fullPath The full path to the file on disk\n   */\n  readonly onOpenInExternalEditor: (fullPath: string) => void\n}\n\ninterface IRepositoryViewState {\n  readonly sidebarHasFocusWithin: boolean\n}\n\nconst enum Tab {\n  Changes = 0,\n  History = 1,\n}\n\nexport class RepositoryView extends React.Component<\n  IRepositoryViewProps,\n  IRepositoryViewState\n> {\n  public constructor(props: IRepositoryViewProps) {\n    super(props)\n\n    this.state = {\n      sidebarHasFocusWithin: false,\n    }\n  }\n\n  private renderChangesBadge(): JSX.Element | null {\n    const filesChangedCount = this.props.state.changesState.workingDirectory\n      .files.length\n\n    if (filesChangedCount <= 0) {\n      return null\n    }\n\n    return <FilesChangedBadge filesChangedCount={filesChangedCount} />\n  }\n\n  private renderTabs(): JSX.Element {\n    const selectedTab =\n      this.props.state.selectedSection === RepositorySectionTab.Changes\n        ? Tab.Changes\n        : Tab.History\n\n    return (\n      <TabBar selectedIndex={selectedTab} onTabClicked={this.onTabClicked}>\n        <span className=\"with-indicator\">\n          <span>Changes</span>\n          {this.renderChangesBadge()}\n        </span>\n\n        <div className=\"with-indicator\">\n          <span>History</span>\n          {enableNotificationOfBranchUpdates() &&\n          this.props.state.compareState.isDivergingBranchBannerVisible ? (\n            <Octicon\n              className=\"indicator\"\n              symbol={OcticonSymbol.primitiveDot}\n            />\n          ) : null}\n        </div>\n      </TabBar>\n    )\n  }\n\n  private renderChangesSidebar(): JSX.Element {\n    const tip = this.props.state.branchesState.tip\n    const branch = tip.kind === TipState.Valid ? tip.branch : null\n\n    const localCommitSHAs = this.props.state.localCommitSHAs\n    const mostRecentLocalCommitSHA =\n      localCommitSHAs.length > 0 ? localCommitSHAs[0] : null\n    const mostRecentLocalCommit =\n      (mostRecentLocalCommitSHA\n        ? this.props.state.commitLookup.get(mostRecentLocalCommitSHA)\n        : null) || null\n\n    // -1 Because of right hand side border\n    const availableWidth = this.props.sidebarWidth - 1\n\n    return (\n      <ChangesSidebar\n        repository={this.props.repository}\n        dispatcher={this.props.dispatcher}\n        changes={this.props.state.changesState}\n        branch={branch ? branch.name : null}\n        commitAuthor={this.props.state.commitAuthor}\n        gitHubUsers={this.props.state.gitHubUsers}\n        emoji={this.props.emoji}\n        mostRecentLocalCommit={mostRecentLocalCommit}\n        issuesStore={this.props.issuesStore}\n        availableWidth={availableWidth}\n        gitHubUserStore={this.props.gitHubUserStore}\n        isCommitting={this.props.state.isCommitting}\n        isPushPullFetchInProgress={this.props.state.isPushPullFetchInProgress}\n        askForConfirmationOnDiscardChanges={\n          this.props.askForConfirmationOnDiscardChanges\n        }\n        accounts={this.props.accounts}\n        externalEditorLabel={this.props.externalEditorLabel}\n        onOpenInExternalEditor={this.props.onOpenInExternalEditor}\n      />\n    )\n  }\n\n  private renderCompareSidebar(): JSX.Element {\n    const tip = this.props.state.branchesState.tip\n    const currentBranch = tip.kind === TipState.Valid ? tip.branch : null\n\n    return (\n      <CompareSidebar\n        repository={this.props.repository}\n        compareState={this.props.state.compareState}\n        selectedCommitSha={this.props.state.commitSelection.sha}\n        currentBranch={currentBranch}\n        gitHubUsers={this.props.state.gitHubUsers}\n        emoji={this.props.emoji}\n        commitLookup={this.props.state.commitLookup}\n        localCommitSHAs={this.props.state.localCommitSHAs}\n        dispatcher={this.props.dispatcher}\n        onRevertCommit={this.onRevertCommit}\n        onViewCommitOnGitHub={this.props.onViewCommitOnGitHub}\n      />\n    )\n  }\n\n  private renderSidebarContents(): JSX.Element {\n    const selectedSection = this.props.state.selectedSection\n\n    if (selectedSection === RepositorySectionTab.Changes) {\n      return this.renderChangesSidebar()\n    } else if (selectedSection === RepositorySectionTab.History) {\n      return this.renderCompareSidebar()\n    } else {\n      return assertNever(selectedSection, 'Unknown repository section')\n    }\n  }\n\n  private handleSidebarWidthReset = () => {\n    this.props.dispatcher.resetSidebarWidth()\n  }\n\n  private handleSidebarResize = (width: number) => {\n    this.props.dispatcher.setSidebarWidth(width)\n  }\n\n  private renderSidebar(): JSX.Element {\n    return (\n      <FocusContainer onFocusWithinChanged={this.onSidebarFocusWithinChanged}>\n        <Resizable\n          id=\"repository-sidebar\"\n          width={this.props.sidebarWidth}\n          onReset={this.handleSidebarWidthReset}\n          onResize={this.handleSidebarResize}\n          maximumWidth={MaxSidebarWidth}\n        >\n          {this.renderTabs()}\n          {this.renderSidebarContents()}\n        </Resizable>\n      </FocusContainer>\n    )\n  }\n\n  private onSidebarFocusWithinChanged = (sidebarHasFocusWithin: boolean) => {\n    // this lets us know that focus is somewhere within the sidebar\n    this.setState({ sidebarHasFocusWithin })\n\n    if (\n      sidebarHasFocusWithin === false &&\n      this.props.state.selectedSection === RepositorySectionTab.History\n    ) {\n      this.props.dispatcher.updateCompareForm(this.props.repository, {\n        showBranchList: false,\n      })\n    }\n  }\n\n  private renderContent(): JSX.Element | null {\n    const selectedSection = this.props.state.selectedSection\n\n    if (selectedSection === RepositorySectionTab.Changes) {\n      const changesState = this.props.state.changesState\n      const selectedFileIDs = changesState.selectedFileIDs\n\n      if (selectedFileIDs.length > 1) {\n        return <MultipleSelection count={selectedFileIDs.length} />\n      }\n\n      if (\n        changesState.workingDirectory.files.length === 0 ||\n        selectedFileIDs.length === 0 ||\n        changesState.diff === null\n      ) {\n        return <NoChanges repository={this.props.repository} />\n      } else {\n        const workingDirectory = changesState.workingDirectory\n        const selectedFile = workingDirectory.findFileWithID(selectedFileIDs[0])\n\n        if (!selectedFile) {\n          return null\n        }\n\n        return (\n          <Changes\n            repository={this.props.repository}\n            dispatcher={this.props.dispatcher}\n            file={selectedFile}\n            diff={changesState.diff}\n            imageDiffType={this.props.imageDiffType}\n          />\n        )\n      }\n    } else if (selectedSection === RepositorySectionTab.History) {\n      const { commitSelection } = this.props.state\n\n      const sha = commitSelection.sha\n\n      const selectedCommit =\n        sha != null ? this.props.state.commitLookup.get(sha) || null : null\n\n      const { changedFiles, file, diff } = commitSelection\n\n      return (\n        <SelectedCommit\n          repository={this.props.repository}\n          dispatcher={this.props.dispatcher}\n          selectedCommit={selectedCommit}\n          changedFiles={changedFiles}\n          selectedFile={file}\n          currentDiff={diff}\n          emoji={this.props.emoji}\n          commitSummaryWidth={this.props.commitSummaryWidth}\n          gitHubUsers={this.props.state.gitHubUsers}\n          selectedDiffType={this.props.imageDiffType}\n          externalEditorLabel={this.props.externalEditorLabel}\n          onOpenInExternalEditor={this.props.onOpenInExternalEditor}\n        />\n      )\n    } else {\n      return assertNever(selectedSection, 'Unknown repository section')\n    }\n  }\n\n  public render() {\n    return (\n      <UiView id=\"repository\" onKeyDown={this.onKeyDown}>\n        {this.renderSidebar()}\n        {this.renderContent()}\n      </UiView>\n    )\n  }\n\n  private onRevertCommit = (commit: Commit) => {\n    this.props.dispatcher.revertCommit(this.props.repository, commit)\n  }\n\n  private onKeyDown = (e: React.KeyboardEvent<HTMLDivElement>) => {\n    // Toggle tab selection on Ctrl+Tab. Note that we don't care\n    // about the shift key here, we can get away with that as long\n    // as there's only two tabs.\n    if (e.ctrlKey && e.key === 'Tab') {\n      const section =\n        this.props.state.selectedSection === RepositorySectionTab.History\n          ? RepositorySectionTab.Changes\n          : RepositorySectionTab.History\n\n      this.props.dispatcher.changeRepositorySection(\n        this.props.repository,\n        section\n      )\n      e.preventDefault()\n    }\n  }\n\n  private onTabClicked = (tab: Tab) => {\n    const section =\n      tab === Tab.History\n        ? RepositorySectionTab.History\n        : RepositorySectionTab.Changes\n\n    this.props.dispatcher.changeRepositorySection(\n      this.props.repository,\n      section\n    )\n    if (!!section) {\n      this.props.dispatcher.updateCompareForm(this.props.repository, {\n        showBranchList: false,\n      })\n    }\n  }\n}\n","(function() {\n  var basenameMatch, computeMatch, isMatch, isWordStart, match, mergeMatches, scoreAcronyms, scoreCharacter, scoreConsecutives, _ref;\n\n  _ref = require('./scorer'), isMatch = _ref.isMatch, isWordStart = _ref.isWordStart, scoreConsecutives = _ref.scoreConsecutives, scoreCharacter = _ref.scoreCharacter, scoreAcronyms = _ref.scoreAcronyms;\n\n  exports.match = match = function(string, query, options) {\n    var allowErrors, baseMatches, matches, pathSeparator, preparedQuery, string_lw;\n    allowErrors = options.allowErrors, preparedQuery = options.preparedQuery, pathSeparator = options.pathSeparator;\n    if (!(allowErrors || isMatch(string, preparedQuery.core_lw, preparedQuery.core_up))) {\n      return [];\n    }\n    string_lw = string.toLowerCase();\n    matches = computeMatch(string, string_lw, preparedQuery);\n    if (matches.length === 0) {\n      return matches;\n    }\n    if (string.indexOf(pathSeparator) > -1) {\n      baseMatches = basenameMatch(string, string_lw, preparedQuery, pathSeparator);\n      matches = mergeMatches(matches, baseMatches);\n    }\n    return matches;\n  };\n\n  exports.wrap = function(string, query, options) {\n    var matchIndex, matchPos, matchPositions, output, strPos, tagClass, tagClose, tagOpen, _ref1;\n    if ((options.wrap != null)) {\n      _ref1 = options.wrap, tagClass = _ref1.tagClass, tagOpen = _ref1.tagOpen, tagClose = _ref1.tagClose;\n    }\n    if (tagClass == null) {\n      tagClass = 'highlight';\n    }\n    if (tagOpen == null) {\n      tagOpen = '<strong class=\"' + tagClass + '\">';\n    }\n    if (tagClose == null) {\n      tagClose = '</strong>';\n    }\n    if (string === query) {\n      return tagOpen + string + tagClose;\n    }\n    matchPositions = match(string, query, options);\n    if (matchPositions.length === 0) {\n      return string;\n    }\n    output = '';\n    matchIndex = -1;\n    strPos = 0;\n    while (++matchIndex < matchPositions.length) {\n      matchPos = matchPositions[matchIndex];\n      if (matchPos > strPos) {\n        output += string.substring(strPos, matchPos);\n        strPos = matchPos;\n      }\n      while (++matchIndex < matchPositions.length) {\n        if (matchPositions[matchIndex] === matchPos + 1) {\n          matchPos++;\n        } else {\n          matchIndex--;\n          break;\n        }\n      }\n      matchPos++;\n      if (matchPos > strPos) {\n        output += tagOpen;\n        output += string.substring(strPos, matchPos);\n        output += tagClose;\n        strPos = matchPos;\n      }\n    }\n    if (strPos <= string.length - 1) {\n      output += string.substring(strPos);\n    }\n    return output;\n  };\n\n  basenameMatch = function(subject, subject_lw, preparedQuery, pathSeparator) {\n    var basePos, depth, end;\n    end = subject.length - 1;\n    while (subject[end] === pathSeparator) {\n      end--;\n    }\n    basePos = subject.lastIndexOf(pathSeparator, end);\n    if (basePos === -1) {\n      return [];\n    }\n    depth = preparedQuery.depth;\n    while (depth-- > 0) {\n      basePos = subject.lastIndexOf(pathSeparator, basePos - 1);\n      if (basePos === -1) {\n        return [];\n      }\n    }\n    basePos++;\n    end++;\n    return computeMatch(subject.slice(basePos, end), subject_lw.slice(basePos, end), preparedQuery, basePos);\n  };\n\n  mergeMatches = function(a, b) {\n    var ai, bj, i, j, m, n, out;\n    m = a.length;\n    n = b.length;\n    if (n === 0) {\n      return a.slice();\n    }\n    if (m === 0) {\n      return b.slice();\n    }\n    i = -1;\n    j = 0;\n    bj = b[j];\n    out = [];\n    while (++i < m) {\n      ai = a[i];\n      while (bj <= ai && ++j < n) {\n        if (bj < ai) {\n          out.push(bj);\n        }\n        bj = b[j];\n      }\n      out.push(ai);\n    }\n    while (j < n) {\n      out.push(b[j++]);\n    }\n    return out;\n  };\n\n  computeMatch = function(subject, subject_lw, preparedQuery, offset) {\n    var DIAGONAL, LEFT, STOP, UP, acro_score, align, backtrack, csc_diag, csc_row, csc_score, i, j, m, matches, move, n, pos, query, query_lw, score, score_diag, score_row, score_up, si_lw, start, trace;\n    if (offset == null) {\n      offset = 0;\n    }\n    query = preparedQuery.query;\n    query_lw = preparedQuery.query_lw;\n    m = subject.length;\n    n = query.length;\n    acro_score = scoreAcronyms(subject, subject_lw, query, query_lw).score;\n    score_row = new Array(n);\n    csc_row = new Array(n);\n    STOP = 0;\n    UP = 1;\n    LEFT = 2;\n    DIAGONAL = 3;\n    trace = new Array(m * n);\n    pos = -1;\n    j = -1;\n    while (++j < n) {\n      score_row[j] = 0;\n      csc_row[j] = 0;\n    }\n    i = -1;\n    while (++i < m) {\n      score = 0;\n      score_up = 0;\n      csc_diag = 0;\n      si_lw = subject_lw[i];\n      j = -1;\n      while (++j < n) {\n        csc_score = 0;\n        align = 0;\n        score_diag = score_up;\n        if (query_lw[j] === si_lw) {\n          start = isWordStart(i, subject, subject_lw);\n          csc_score = csc_diag > 0 ? csc_diag : scoreConsecutives(subject, subject_lw, query, query_lw, i, j, start);\n          align = score_diag + scoreCharacter(i, j, start, acro_score, csc_score);\n        }\n        score_up = score_row[j];\n        csc_diag = csc_row[j];\n        if (score > score_up) {\n          move = LEFT;\n        } else {\n          score = score_up;\n          move = UP;\n        }\n        if (align > score) {\n          score = align;\n          move = DIAGONAL;\n        } else {\n          csc_score = 0;\n        }\n        score_row[j] = score;\n        csc_row[j] = csc_score;\n        trace[++pos] = score > 0 ? move : STOP;\n      }\n    }\n    i = m - 1;\n    j = n - 1;\n    pos = i * n + j;\n    backtrack = true;\n    matches = [];\n    while (backtrack && i >= 0 && j >= 0) {\n      switch (trace[pos]) {\n        case UP:\n          i--;\n          pos -= n;\n          break;\n        case LEFT:\n          j--;\n          pos--;\n          break;\n        case DIAGONAL:\n          matches.push(i + offset);\n          j--;\n          i--;\n          pos -= n + 1;\n          break;\n        default:\n          backtrack = false;\n      }\n    }\n    matches.reverse();\n    return matches;\n  };\n\n}).call(this);\n","(function() {\n  var Query, pathScorer, pluckCandidates, scorer, sortCandidates;\n\n  scorer = require('./scorer');\n\n  pathScorer = require('./pathScorer');\n\n  Query = require('./query');\n\n  pluckCandidates = function(a) {\n    return a.candidate;\n  };\n\n  sortCandidates = function(a, b) {\n    return b.score - a.score;\n  };\n\n  module.exports = function(candidates, query, options) {\n    var bKey, candidate, key, maxInners, maxResults, score, scoreProvider, scoredCandidates, spotLeft, string, usePathScoring, _i, _len;\n    scoredCandidates = [];\n    key = options.key, maxResults = options.maxResults, maxInners = options.maxInners, usePathScoring = options.usePathScoring;\n    spotLeft = (maxInners != null) && maxInners > 0 ? maxInners : candidates.length + 1;\n    bKey = key != null;\n    scoreProvider = usePathScoring ? pathScorer : scorer;\n    for (_i = 0, _len = candidates.length; _i < _len; _i++) {\n      candidate = candidates[_i];\n      string = bKey ? candidate[key] : candidate;\n      if (!string) {\n        continue;\n      }\n      score = scoreProvider.score(string, query, options);\n      if (score > 0) {\n        scoredCandidates.push({\n          candidate: candidate,\n          score: score\n        });\n        if (!--spotLeft) {\n          break;\n        }\n      }\n    }\n    scoredCandidates.sort(sortCandidates);\n    candidates = scoredCandidates.map(pluckCandidates);\n    if (maxResults != null) {\n      candidates = candidates.slice(0, maxResults);\n    }\n    return candidates;\n  };\n\n}).call(this);\n","(function() {\n  var Query, defaultPathSeparator, filter, matcher, parseOptions, pathScorer, preparedQueryCache, scorer;\n\n  filter = require('./filter');\n\n  matcher = require('./matcher');\n\n  scorer = require('./scorer');\n\n  pathScorer = require('./pathScorer');\n\n  Query = require('./query');\n\n  preparedQueryCache = null;\n\n  defaultPathSeparator = (typeof process !== \"undefined\" && process !== null ? process.platform : void 0) === \"win32\" ? '\\\\' : '/';\n\n  module.exports = {\n    filter: function(candidates, query, options) {\n      if (options == null) {\n        options = {};\n      }\n      if (!((query != null ? query.length : void 0) && (candidates != null ? candidates.length : void 0))) {\n        return [];\n      }\n      options = parseOptions(options, query);\n      return filter(candidates, query, options);\n    },\n    score: function(string, query, options) {\n      if (options == null) {\n        options = {};\n      }\n      if (!((string != null ? string.length : void 0) && (query != null ? query.length : void 0))) {\n        return 0;\n      }\n      options = parseOptions(options, query);\n      if (options.usePathScoring) {\n        return pathScorer.score(string, query, options);\n      } else {\n        return scorer.score(string, query, options);\n      }\n    },\n    match: function(string, query, options) {\n      var _i, _ref, _results;\n      if (options == null) {\n        options = {};\n      }\n      if (!string) {\n        return [];\n      }\n      if (!query) {\n        return [];\n      }\n      if (string === query) {\n        return (function() {\n          _results = [];\n          for (var _i = 0, _ref = string.length; 0 <= _ref ? _i < _ref : _i > _ref; 0 <= _ref ? _i++ : _i--){ _results.push(_i); }\n          return _results;\n        }).apply(this);\n      }\n      options = parseOptions(options, query);\n      return matcher.match(string, query, options);\n    },\n    wrap: function(string, query, options) {\n      if (options == null) {\n        options = {};\n      }\n      if (!string) {\n        return [];\n      }\n      if (!query) {\n        return [];\n      }\n      options = parseOptions(options, query);\n      return matcher.wrap(string, query, options);\n    },\n    prepareQuery: function(query, options) {\n      if (options == null) {\n        options = {};\n      }\n      options = parseOptions(options, query);\n      return options.preparedQuery;\n    }\n  };\n\n  parseOptions = function(options, query) {\n    if (options.allowErrors == null) {\n      options.allowErrors = false;\n    }\n    if (options.usePathScoring == null) {\n      options.usePathScoring = true;\n    }\n    if (options.useExtensionBonus == null) {\n      options.useExtensionBonus = false;\n    }\n    if (options.pathSeparator == null) {\n      options.pathSeparator = defaultPathSeparator;\n    }\n    if (options.optCharRegEx == null) {\n      options.optCharRegEx = null;\n    }\n    if (options.wrap == null) {\n      options.wrap = null;\n    }\n    if (options.preparedQuery == null) {\n      options.preparedQuery = preparedQueryCache && preparedQueryCache.query === query ? preparedQueryCache : (preparedQueryCache = new Query(query, options));\n    }\n    return options;\n  };\n\n}).call(this);\n","import * as fuzzAldrin from 'fuzzaldrin-plus'\n\nimport { compareDescending } from './compare'\n\nfunction score(str: string, query: string, maxScore: number) {\n  return fuzzAldrin.score(str, query) / maxScore\n}\n\nexport interface IMatches {\n  readonly title: ReadonlyArray<number>\n  readonly subtitle: ReadonlyArray<number>\n}\n\nexport interface IMatch<T> {\n  /** `0 <= score <= 1` */\n  score: number\n  item: T\n  matches: IMatches\n}\n\nexport type KeyFunction<T> = (item: T) => ReadonlyArray<string>\n\nexport function match<T, _K extends keyof T>(\n  query: string,\n  items: ReadonlyArray<T>,\n  getKey: KeyFunction<T>\n): ReadonlyArray<IMatch<T>> {\n  // matching `query` against itself is a perfect match.\n  const maxScore = score(query, query, 1)\n  const result = items\n    .map(\n      (item): IMatch<T> => {\n        const matches: Array<ReadonlyArray<number>> = []\n        const itemTextArray = getKey(item)\n        itemTextArray.forEach(text => {\n          matches.push(fuzzAldrin.match(text, query))\n        })\n\n        return {\n          score: score(itemTextArray.join(''), query, maxScore),\n          item,\n          matches: {\n            title: matches[0],\n            subtitle: matches.length > 1 ? matches[1] : [],\n          },\n        }\n      }\n    )\n    .filter(\n      ({ matches }) => matches.title.length > 0 || matches.subtitle.length > 0\n    )\n    .sort(({ score: left }, { score: right }) => compareDescending(left, right))\n\n  return result\n}\n","import * as React from 'react'\nimport * as classNames from 'classnames'\n\ninterface IListRowProps {\n  /** the total number of row in this list */\n  readonly rowCount: number\n\n  /** the index of the row in the list */\n  readonly rowIndex: number\n\n  /** the accessibility mode to assign to the row */\n  readonly ariaMode?: 'list' | 'menu'\n\n  /** custom styles to provide to the row */\n  readonly style?: React.CSSProperties\n\n  /** set a tab index for this row (if selectable) */\n  readonly tabIndex?: number\n\n  /** an optional id to provide to the element */\n  readonly id?: string\n\n  /** whether the row should be rendered as selected */\n  readonly selected?: boolean\n\n  /** callback to fire when the DOM element is created */\n  readonly onRef?: (element: HTMLDivElement | null) => void\n\n  /** callback to fire when the row receives a mouseover event */\n  readonly onRowMouseOver: (index: number, e: React.MouseEvent<any>) => void\n\n  /** callback to fire when the row receieves a mousedown event */\n  readonly onRowMouseDown: (index: number, e: React.MouseEvent<any>) => void\n\n  /** callback to fire when the row is clicked */\n  readonly onRowClick: (index: number, e: React.MouseEvent<any>) => void\n\n  /** callback to fire when the row receives a keyboard event */\n  readonly onRowKeyDown: (index: number, e: React.KeyboardEvent<any>) => void\n}\n\nexport class ListRow extends React.Component<IListRowProps, {}> {\n  private onRowMouseOver = (e: React.MouseEvent<HTMLDivElement>) => {\n    this.props.onRowMouseOver(this.props.rowIndex, e)\n  }\n\n  private onRowMouseDown = (e: React.MouseEvent<HTMLDivElement>) => {\n    this.props.onRowMouseDown(this.props.rowIndex, e)\n  }\n\n  private onRowClick = (e: React.MouseEvent<HTMLDivElement>) => {\n    this.props.onRowClick(this.props.rowIndex, e)\n  }\n\n  private onRowKeyDown = (e: React.KeyboardEvent<HTMLDivElement>) => {\n    this.props.onRowKeyDown(this.props.rowIndex, e)\n  }\n\n  public render() {\n    const selected = this.props.selected\n    const className = classNames('list-item', { selected })\n    const role = this.props.ariaMode === 'menu' ? 'menuitem' : 'option'\n\n    // react-virtualized gives us an explicit pixel width for rows, but that\n    // width doesn't take into account whether or not the scroll bar needs\n    // width too, e.g., on macOS when \"Show scroll bars\" is set to \"Always.\"\n    //\n    // *But* the parent Grid uses `autoContainerWidth` which means its width\n    // *does* reflect any width needed by the scroll bar. So we should just use\n    // that width.\n    const style = { ...this.props.style, width: '100%' }\n\n    return (\n      <div\n        id={this.props.id}\n        aria-setsize={this.props.rowCount}\n        aria-posinset={this.props.rowIndex + 1}\n        aria-selected={this.props.selected}\n        role={role}\n        className={className}\n        tabIndex={this.props.tabIndex}\n        ref={this.props.onRef}\n        onMouseOver={this.onRowMouseOver}\n        onMouseDown={this.onRowMouseDown}\n        onClick={this.onRowClick}\n        onKeyDown={this.onRowKeyDown}\n        style={style}\n      >\n        {this.props.children}\n      </div>\n    )\n  }\n}\n","var supportsArgumentsClass = (function(){\n  return Object.prototype.toString.call(arguments)\n})() == '[object Arguments]';\n\nexports = module.exports = supportsArgumentsClass ? supported : unsupported;\n\nexports.supported = supported;\nfunction supported(object) {\n  return Object.prototype.toString.call(object) == '[object Arguments]';\n};\n\nexports.unsupported = unsupported;\nfunction unsupported(object){\n  return object &&\n    typeof object == 'object' &&\n    typeof object.length == 'number' &&\n    Object.prototype.hasOwnProperty.call(object, 'callee') &&\n    !Object.prototype.propertyIsEnumerable.call(object, 'callee') ||\n    false;\n};\n","exports = module.exports = typeof Object.keys === 'function'\n  ? Object.keys : shim;\n\nexports.shim = shim;\nfunction shim (obj) {\n  var keys = [];\n  for (var key in obj) keys.push(key);\n  return keys;\n}\n","var pSlice = Array.prototype.slice;\nvar objectKeys = require('./lib/keys.js');\nvar isArguments = require('./lib/is_arguments.js');\n\nvar deepEqual = module.exports = function (actual, expected, opts) {\n  if (!opts) opts = {};\n  // 7.1. All identical values are equivalent, as determined by ===.\n  if (actual === expected) {\n    return true;\n\n  } else if (actual instanceof Date && expected instanceof Date) {\n    return actual.getTime() === expected.getTime();\n\n  // 7.3. Other pairs that do not both pass typeof value == 'object',\n  // equivalence is determined by ==.\n  } else if (!actual || !expected || typeof actual != 'object' && typeof expected != 'object') {\n    return opts.strict ? actual === expected : actual == expected;\n\n  // 7.4. For all other Object pairs, including Array objects, equivalence is\n  // determined by having the same number of owned properties (as verified\n  // with Object.prototype.hasOwnProperty.call), the same set of keys\n  // (although not necessarily the same order), equivalent values for every\n  // corresponding key, and an identical 'prototype' property. Note: this\n  // accounts for both named and indexed properties on Arrays.\n  } else {\n    return objEquiv(actual, expected, opts);\n  }\n}\n\nfunction isUndefinedOrNull(value) {\n  return value === null || value === undefined;\n}\n\nfunction isBuffer (x) {\n  if (!x || typeof x !== 'object' || typeof x.length !== 'number') return false;\n  if (typeof x.copy !== 'function' || typeof x.slice !== 'function') {\n    return false;\n  }\n  if (x.length > 0 && typeof x[0] !== 'number') return false;\n  return true;\n}\n\nfunction objEquiv(a, b, opts) {\n  var i, key;\n  if (isUndefinedOrNull(a) || isUndefinedOrNull(b))\n    return false;\n  // an identical 'prototype' property.\n  if (a.prototype !== b.prototype) return false;\n  //~~~I've managed to break Object.keys through screwy arguments passing.\n  //   Converting to array solves the problem.\n  if (isArguments(a)) {\n    if (!isArguments(b)) {\n      return false;\n    }\n    a = pSlice.call(a);\n    b = pSlice.call(b);\n    return deepEqual(a, b, opts);\n  }\n  if (isBuffer(a)) {\n    if (!isBuffer(b)) {\n      return false;\n    }\n    if (a.length !== b.length) return false;\n    for (i = 0; i < a.length; i++) {\n      if (a[i] !== b[i]) return false;\n    }\n    return true;\n  }\n  try {\n    var ka = objectKeys(a),\n        kb = objectKeys(b);\n  } catch (e) {//happens when one is a string literal and the other isn't\n    return false;\n  }\n  // having the same number of owned properties (keys incorporates\n  // hasOwnProperty)\n  if (ka.length != kb.length)\n    return false;\n  //the same set of keys (although not necessarily the same order),\n  ka.sort();\n  kb.sort();\n  //~~~cheap key test\n  for (i = ka.length - 1; i >= 0; i--) {\n    if (ka[i] != kb[i])\n      return false;\n  }\n  //equivalent values for every corresponding key, and\n  //~~~possibly expensive deep test\n  for (i = ka.length - 1; i >= 0; i--) {\n    key = ka[i];\n    if (!deepEqual(a[key], b[key], opts)) return false;\n  }\n  return typeof a === typeof b;\n}\n","var classof   = require('./$.classof')\n  , ITERATOR  = require('./$.wks')('iterator')\n  , Iterators = require('./$.iterators');\nmodule.exports = require('./$.core').getIteratorMethod = function(it){\n  if(it != undefined)return it[ITERATOR]\n    || it['@@iterator']\n    || Iterators[classof(it)];\n};","var anObject = require('./$.an-object')\n  , get      = require('./core.get-iterator-method');\nmodule.exports = require('./$.core').getIterator = function(it){\n  var iterFn = get(it);\n  if(typeof iterFn != 'function')throw TypeError(it + ' is not iterable!');\n  return anObject(iterFn.call(it));\n};","require('../modules/web.dom.iterable');\nrequire('../modules/es6.string.iterator');\nmodule.exports = require('../modules/core.get-iterator');","module.exports = { \"default\": require(\"core-js/library/fn/get-iterator\"), __esModule: true };","var classof   = require('./$.classof')\n  , ITERATOR  = require('./$.wks')('iterator')\n  , Iterators = require('./$.iterators');\nmodule.exports = require('./$.core').isIterable = function(it){\n  var O = Object(it);\n  return O[ITERATOR] !== undefined\n    || '@@iterator' in O\n    || Iterators.hasOwnProperty(classof(O));\n};","require('../modules/web.dom.iterable');\nrequire('../modules/es6.string.iterator');\nmodule.exports = require('../modules/core.is-iterable');","module.exports = { \"default\": require(\"core-js/library/fn/is-iterable\"), __esModule: true };","import * as React from 'react';\n\nvar bpfrpt_proptype_RowRendererParams = process.env.NODE_ENV === 'production' ? null : {\n  index: PropTypes.number.isRequired,\n  isScrolling: PropTypes.bool.isRequired,\n  isVisible: PropTypes.bool.isRequired,\n  key: PropTypes.string.isRequired,\n  parent: PropTypes.object.isRequired,\n  style: PropTypes.object.isRequired\n};\nvar bpfrpt_proptype_RowRenderer = process.env.NODE_ENV === 'production' ? null : PropTypes.func;\nvar bpfrpt_proptype_RenderedRows = process.env.NODE_ENV === 'production' ? null : {\n  overscanStartIndex: PropTypes.number.isRequired,\n  overscanStopIndex: PropTypes.number.isRequired,\n  startIndex: PropTypes.number.isRequired,\n  stopIndex: PropTypes.number.isRequired\n};\nvar bpfrpt_proptype_Scroll = process.env.NODE_ENV === 'production' ? null : {\n  clientHeight: PropTypes.number.isRequired,\n  scrollHeight: PropTypes.number.isRequired,\n  scrollTop: PropTypes.number.isRequired\n};\nimport PropTypes from 'prop-types';\nexport { bpfrpt_proptype_RowRendererParams };\nexport { bpfrpt_proptype_RowRenderer };\nexport { bpfrpt_proptype_RenderedRows };\nexport { bpfrpt_proptype_Scroll };","// 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\nvar toIObject = require('./$.to-iobject');\n\nrequire('./$.object-sap')('getOwnPropertyDescriptor', function($getOwnPropertyDescriptor){\n  return function getOwnPropertyDescriptor(it, key){\n    return $getOwnPropertyDescriptor(toIObject(it), key);\n  };\n});","var $ = require('../../modules/$');\nrequire('../../modules/es6.object.get-own-property-descriptor');\nmodule.exports = function getOwnPropertyDescriptor(it, key){\n  return $.getDesc(it, key);\n};","// 19.1.2.14 Object.keys(O)\nvar toObject = require('./$.to-object');\n\nrequire('./$.object-sap')('keys', function($keys){\n  return function keys(it){\n    return $keys(toObject(it));\n  };\n});","require('../../modules/es6.object.keys');\nmodule.exports = require('../../modules/$.core').Object.keys;","// 19.1.2.1 Object.assign(target, source, ...)\nvar $        = require('./$')\n  , toObject = require('./$.to-object')\n  , IObject  = require('./$.iobject');\n\n// should work with symbols and should have deterministic property order (V8 bug)\nmodule.exports = require('./$.fails')(function(){\n  var a = Object.assign\n    , A = {}\n    , B = {}\n    , S = Symbol()\n    , K = 'abcdefghijklmnopqrst';\n  A[S] = 7;\n  K.split('').forEach(function(k){ B[k] = k; });\n  return a({}, A)[S] != 7 || Object.keys(a({}, B)).join('') != K;\n}) ? function assign(target, source){ // eslint-disable-line no-unused-vars\n  var T     = toObject(target)\n    , $$    = arguments\n    , $$len = $$.length\n    , index = 1\n    , getKeys    = $.getKeys\n    , getSymbols = $.getSymbols\n    , isEnum     = $.isEnum;\n  while($$len > index){\n    var S      = IObject($$[index++])\n      , keys   = getSymbols ? getKeys(S).concat(getSymbols(S)) : getKeys(S)\n      , length = keys.length\n      , j      = 0\n      , key;\n    while(length > j)if(isEnum.call(S, key = keys[j++]))T[key] = S[key];\n  }\n  return T;\n} : Object.assign;","// 19.1.3.1 Object.assign(target, source)\nvar $export = require('./$.export');\n\n$export($export.S + $export.F, 'Object', {assign: require('./$.object-assign')});","require('../../modules/es6.object.assign');\nmodule.exports = require('../../modules/$.core').Object.assign;","var bpfrpt_proptype_ScrollIndices = process.env.NODE_ENV === 'production' ? null : {\n  scrollToColumn: PropTypes.number.isRequired,\n  scrollToRow: PropTypes.number.isRequired\n};\nimport PropTypes from \"prop-types\";\nexport { bpfrpt_proptype_ScrollIndices };","var $ = require('../../modules/$');\nmodule.exports = function create(P, D){\n  return $.create(P, D);\n};","module.exports = { \"default\": require(\"core-js/library/fn/object/create\"), __esModule: true };","// Works with __proto__ only. Old v8 can't work with null proto objects.\n/* eslint-disable no-proto */\nvar getDesc  = require('./$').getDesc\n  , isObject = require('./$.is-object')\n  , anObject = require('./$.an-object');\nvar check = function(O, proto){\n  anObject(O);\n  if(!isObject(proto) && proto !== null)throw TypeError(proto + \": can't set as prototype!\");\n};\nmodule.exports = {\n  set: Object.setPrototypeOf || ('__proto__' in {} ? // eslint-disable-line\n    function(test, buggy, set){\n      try {\n        set = require('./$.ctx')(Function.call, getDesc(Object.prototype, '__proto__').set, 2);\n        set(test, []);\n        buggy = !(test instanceof Array);\n      } catch(e){ buggy = true; }\n      return function setPrototypeOf(O, proto){\n        check(O, proto);\n        if(buggy)O.__proto__ = proto;\n        else set(O, proto);\n        return O;\n      };\n    }({}, false) : undefined),\n  check: check\n};","// 19.1.3.19 Object.setPrototypeOf(O, proto)\nvar $export = require('./$.export');\n$export($export.S, 'Object', {setPrototypeOf: require('./$.set-proto').set});","require('../../modules/es6.object.set-prototype-of');\nmodule.exports = require('../../modules/$.core').Object.setPrototypeOf;","module.exports = { \"default\": require(\"core-js/library/fn/object/set-prototype-of\"), __esModule: true };","// 7.2.2 IsArray(argument)\nvar cof = require('./$.cof');\nmodule.exports = Array.isArray || function(arg){\n  return cof(arg) == 'Array';\n};","// all enumerable object keys, includes symbols\nvar $ = require('./$');\nmodule.exports = function(it){\n  var keys       = $.getKeys(it)\n    , getSymbols = $.getSymbols;\n  if(getSymbols){\n    var symbols = getSymbols(it)\n      , isEnum  = $.isEnum\n      , i       = 0\n      , key;\n    while(symbols.length > i)if(isEnum.call(it, key = symbols[i++]))keys.push(key);\n  }\n  return keys;\n};","// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window\nvar toIObject = require('./$.to-iobject')\n  , getNames  = require('./$').getNames\n  , toString  = {}.toString;\n\nvar windowNames = typeof window == 'object' && Object.getOwnPropertyNames\n  ? Object.getOwnPropertyNames(window) : [];\n\nvar getWindowNames = function(it){\n  try {\n    return getNames(it);\n  } catch(e){\n    return windowNames.slice();\n  }\n};\n\nmodule.exports.get = function getOwnPropertyNames(it){\n  if(windowNames && toString.call(it) == '[object Window]')return getWindowNames(it);\n  return getNames(toIObject(it));\n};","var $         = require('./$')\n  , toIObject = require('./$.to-iobject');\nmodule.exports = function(object, el){\n  var O      = toIObject(object)\n    , keys   = $.getKeys(O)\n    , length = keys.length\n    , index  = 0\n    , key;\n  while(length > index)if(O[key = keys[index++]] === el)return key;\n};","'use strict';\n// ECMAScript 6 symbols shim\nvar $              = require('./$')\n  , global         = require('./$.global')\n  , has            = require('./$.has')\n  , DESCRIPTORS    = require('./$.descriptors')\n  , $export        = require('./$.export')\n  , redefine       = require('./$.redefine')\n  , $fails         = require('./$.fails')\n  , shared         = require('./$.shared')\n  , setToStringTag = require('./$.set-to-string-tag')\n  , uid            = require('./$.uid')\n  , wks            = require('./$.wks')\n  , keyOf          = require('./$.keyof')\n  , $names         = require('./$.get-names')\n  , enumKeys       = require('./$.enum-keys')\n  , isArray        = require('./$.is-array')\n  , anObject       = require('./$.an-object')\n  , toIObject      = require('./$.to-iobject')\n  , createDesc     = require('./$.property-desc')\n  , getDesc        = $.getDesc\n  , setDesc        = $.setDesc\n  , _create        = $.create\n  , getNames       = $names.get\n  , $Symbol        = global.Symbol\n  , $JSON          = global.JSON\n  , _stringify     = $JSON && $JSON.stringify\n  , setter         = false\n  , HIDDEN         = wks('_hidden')\n  , isEnum         = $.isEnum\n  , SymbolRegistry = shared('symbol-registry')\n  , AllSymbols     = shared('symbols')\n  , useNative      = typeof $Symbol == 'function'\n  , ObjectProto    = Object.prototype;\n\n// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687\nvar setSymbolDesc = DESCRIPTORS && $fails(function(){\n  return _create(setDesc({}, 'a', {\n    get: function(){ return setDesc(this, 'a', {value: 7}).a; }\n  })).a != 7;\n}) ? function(it, key, D){\n  var protoDesc = getDesc(ObjectProto, key);\n  if(protoDesc)delete ObjectProto[key];\n  setDesc(it, key, D);\n  if(protoDesc && it !== ObjectProto)setDesc(ObjectProto, key, protoDesc);\n} : setDesc;\n\nvar wrap = function(tag){\n  var sym = AllSymbols[tag] = _create($Symbol.prototype);\n  sym._k = tag;\n  DESCRIPTORS && setter && setSymbolDesc(ObjectProto, tag, {\n    configurable: true,\n    set: function(value){\n      if(has(this, HIDDEN) && has(this[HIDDEN], tag))this[HIDDEN][tag] = false;\n      setSymbolDesc(this, tag, createDesc(1, value));\n    }\n  });\n  return sym;\n};\n\nvar isSymbol = function(it){\n  return typeof it == 'symbol';\n};\n\nvar $defineProperty = function defineProperty(it, key, D){\n  if(D && has(AllSymbols, key)){\n    if(!D.enumerable){\n      if(!has(it, HIDDEN))setDesc(it, HIDDEN, createDesc(1, {}));\n      it[HIDDEN][key] = true;\n    } else {\n      if(has(it, HIDDEN) && it[HIDDEN][key])it[HIDDEN][key] = false;\n      D = _create(D, {enumerable: createDesc(0, false)});\n    } return setSymbolDesc(it, key, D);\n  } return setDesc(it, key, D);\n};\nvar $defineProperties = function defineProperties(it, P){\n  anObject(it);\n  var keys = enumKeys(P = toIObject(P))\n    , i    = 0\n    , l = keys.length\n    , key;\n  while(l > i)$defineProperty(it, key = keys[i++], P[key]);\n  return it;\n};\nvar $create = function create(it, P){\n  return P === undefined ? _create(it) : $defineProperties(_create(it), P);\n};\nvar $propertyIsEnumerable = function propertyIsEnumerable(key){\n  var E = isEnum.call(this, key);\n  return E || !has(this, key) || !has(AllSymbols, key) || has(this, HIDDEN) && this[HIDDEN][key]\n    ? E : true;\n};\nvar $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(it, key){\n  var D = getDesc(it = toIObject(it), key);\n  if(D && has(AllSymbols, key) && !(has(it, HIDDEN) && it[HIDDEN][key]))D.enumerable = true;\n  return D;\n};\nvar $getOwnPropertyNames = function getOwnPropertyNames(it){\n  var names  = getNames(toIObject(it))\n    , result = []\n    , i      = 0\n    , key;\n  while(names.length > i)if(!has(AllSymbols, key = names[i++]) && key != HIDDEN)result.push(key);\n  return result;\n};\nvar $getOwnPropertySymbols = function getOwnPropertySymbols(it){\n  var names  = getNames(toIObject(it))\n    , result = []\n    , i      = 0\n    , key;\n  while(names.length > i)if(has(AllSymbols, key = names[i++]))result.push(AllSymbols[key]);\n  return result;\n};\nvar $stringify = function stringify(it){\n  if(it === undefined || isSymbol(it))return; // IE8 returns string on undefined\n  var args = [it]\n    , i    = 1\n    , $$   = arguments\n    , replacer, $replacer;\n  while($$.length > i)args.push($$[i++]);\n  replacer = args[1];\n  if(typeof replacer == 'function')$replacer = replacer;\n  if($replacer || !isArray(replacer))replacer = function(key, value){\n    if($replacer)value = $replacer.call(this, key, value);\n    if(!isSymbol(value))return value;\n  };\n  args[1] = replacer;\n  return _stringify.apply($JSON, args);\n};\nvar buggyJSON = $fails(function(){\n  var S = $Symbol();\n  // MS Edge converts symbol values to JSON as {}\n  // WebKit converts symbol values to JSON as null\n  // V8 throws on boxed symbols\n  return _stringify([S]) != '[null]' || _stringify({a: S}) != '{}' || _stringify(Object(S)) != '{}';\n});\n\n// 19.4.1.1 Symbol([description])\nif(!useNative){\n  $Symbol = function Symbol(){\n    if(isSymbol(this))throw TypeError('Symbol is not a constructor');\n    return wrap(uid(arguments.length > 0 ? arguments[0] : undefined));\n  };\n  redefine($Symbol.prototype, 'toString', function toString(){\n    return this._k;\n  });\n\n  isSymbol = function(it){\n    return it instanceof $Symbol;\n  };\n\n  $.create     = $create;\n  $.isEnum     = $propertyIsEnumerable;\n  $.getDesc    = $getOwnPropertyDescriptor;\n  $.setDesc    = $defineProperty;\n  $.setDescs   = $defineProperties;\n  $.getNames   = $names.get = $getOwnPropertyNames;\n  $.getSymbols = $getOwnPropertySymbols;\n\n  if(DESCRIPTORS && !require('./$.library')){\n    redefine(ObjectProto, 'propertyIsEnumerable', $propertyIsEnumerable, true);\n  }\n}\n\nvar symbolStatics = {\n  // 19.4.2.1 Symbol.for(key)\n  'for': function(key){\n    return has(SymbolRegistry, key += '')\n      ? SymbolRegistry[key]\n      : SymbolRegistry[key] = $Symbol(key);\n  },\n  // 19.4.2.5 Symbol.keyFor(sym)\n  keyFor: function keyFor(key){\n    return keyOf(SymbolRegistry, key);\n  },\n  useSetter: function(){ setter = true; },\n  useSimple: function(){ setter = false; }\n};\n// 19.4.2.2 Symbol.hasInstance\n// 19.4.2.3 Symbol.isConcatSpreadable\n// 19.4.2.4 Symbol.iterator\n// 19.4.2.6 Symbol.match\n// 19.4.2.8 Symbol.replace\n// 19.4.2.9 Symbol.search\n// 19.4.2.10 Symbol.species\n// 19.4.2.11 Symbol.split\n// 19.4.2.12 Symbol.toPrimitive\n// 19.4.2.13 Symbol.toStringTag\n// 19.4.2.14 Symbol.unscopables\n$.each.call((\n  'hasInstance,isConcatSpreadable,iterator,match,replace,search,' +\n  'species,split,toPrimitive,toStringTag,unscopables'\n).split(','), function(it){\n  var sym = wks(it);\n  symbolStatics[it] = useNative ? sym : wrap(sym);\n});\n\nsetter = true;\n\n$export($export.G + $export.W, {Symbol: $Symbol});\n\n$export($export.S, 'Symbol', symbolStatics);\n\n$export($export.S + $export.F * !useNative, 'Object', {\n  // 19.1.2.2 Object.create(O [, Properties])\n  create: $create,\n  // 19.1.2.4 Object.defineProperty(O, P, Attributes)\n  defineProperty: $defineProperty,\n  // 19.1.2.3 Object.defineProperties(O, Properties)\n  defineProperties: $defineProperties,\n  // 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\n  getOwnPropertyDescriptor: $getOwnPropertyDescriptor,\n  // 19.1.2.7 Object.getOwnPropertyNames(O)\n  getOwnPropertyNames: $getOwnPropertyNames,\n  // 19.1.2.8 Object.getOwnPropertySymbols(O)\n  getOwnPropertySymbols: $getOwnPropertySymbols\n});\n\n// 24.3.2 JSON.stringify(value [, replacer [, space]])\n$JSON && $export($export.S + $export.F * (!useNative || buggyJSON), 'JSON', {stringify: $stringify});\n\n// 19.4.3.5 Symbol.prototype[@@toStringTag]\nsetToStringTag($Symbol, 'Symbol');\n// 20.2.1.9 Math[@@toStringTag]\nsetToStringTag(Math, 'Math', true);\n// 24.3.3 JSON[@@toStringTag]\nsetToStringTag(global.JSON, 'JSON', true);","require('../../modules/es6.symbol');\nrequire('../../modules/es6.object.to-string');\nmodule.exports = require('../../modules/$.core').Symbol;","module.exports = { \"default\": require(\"core-js/library/fn/symbol\"), __esModule: true };","module.exports = function(done, value){\n  return {value: value, done: !!done};\n};","module.exports = function(){ /* empty */ };","'use strict';\nvar addToUnscopables = require('./$.add-to-unscopables')\n  , step             = require('./$.iter-step')\n  , Iterators        = require('./$.iterators')\n  , toIObject        = require('./$.to-iobject');\n\n// 22.1.3.4 Array.prototype.entries()\n// 22.1.3.13 Array.prototype.keys()\n// 22.1.3.29 Array.prototype.values()\n// 22.1.3.30 Array.prototype[@@iterator]()\nmodule.exports = require('./$.iter-define')(Array, 'Array', function(iterated, kind){\n  this._t = toIObject(iterated); // target\n  this._i = 0;                   // next index\n  this._k = kind;                // kind\n// 22.1.5.2.1 %ArrayIteratorPrototype%.next()\n}, function(){\n  var O     = this._t\n    , kind  = this._k\n    , index = this._i++;\n  if(!O || index >= O.length){\n    this._t = undefined;\n    return step(1);\n  }\n  if(kind == 'keys'  )return step(0, index);\n  if(kind == 'values')return step(0, O[index]);\n  return step(0, [index, O[index]]);\n}, 'values');\n\n// argumentsList[@@iterator] is %ArrayProto_values% (9.4.4.6, 9.4.4.7)\nIterators.Arguments = Iterators.Array;\n\naddToUnscopables('keys');\naddToUnscopables('values');\naddToUnscopables('entries');","'use strict';\nvar $              = require('./$')\n  , descriptor     = require('./$.property-desc')\n  , setToStringTag = require('./$.set-to-string-tag')\n  , IteratorPrototype = {};\n\n// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()\nrequire('./$.hide')(IteratorPrototype, require('./$.wks')('iterator'), function(){ return this; });\n\nmodule.exports = function(Constructor, NAME, next){\n  Constructor.prototype = $.create(IteratorPrototype, {next: descriptor(1, next)});\n  setToStringTag(Constructor, NAME + ' Iterator');\n};","// 7.1.4 ToInteger\nvar ceil  = Math.ceil\n  , floor = Math.floor;\nmodule.exports = function(it){\n  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n};","var toInteger = require('./$.to-integer')\n  , defined   = require('./$.defined');\n// true  -> String#at\n// false -> String#codePointAt\nmodule.exports = function(TO_STRING){\n  return function(that, pos){\n    var s = String(defined(that))\n      , i = toInteger(pos)\n      , l = s.length\n      , a, b;\n    if(i < 0 || i >= l)return TO_STRING ? '' : undefined;\n    a = s.charCodeAt(i);\n    return a < 0xd800 || a > 0xdbff || i + 1 === l || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff\n      ? TO_STRING ? s.charAt(i) : a\n      : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;\n  };\n};","require('../../modules/es6.string.iterator');\nrequire('../../modules/web.dom.iterable');\nmodule.exports = require('../../modules/$.wks')('iterator');","module.exports = { \"default\": require(\"core-js/library/fn/symbol/iterator\"), __esModule: true };","var $ = require('../../modules/$');\nmodule.exports = function defineProperty(it, key, desc){\n  return $.setDesc(it, key, desc);\n};","module.exports = function(it){\n  if(typeof it != 'function')throw TypeError(it + ' is not a function!');\n  return it;\n};","// 19.1.2.9 Object.getPrototypeOf(O)\nvar toObject = require('./$.to-object');\n\nrequire('./$.object-sap')('getPrototypeOf', function($getPrototypeOf){\n  return function getPrototypeOf(it){\n    return $getPrototypeOf(toObject(it));\n  };\n});","require('../../modules/es6.object.get-prototype-of');\nmodule.exports = require('../../modules/$.core').Object.getPrototypeOf;","import * as React from 'react'\nimport * as ReactDOM from 'react-dom'\nimport { Grid, AutoSizer } from 'react-virtualized'\nimport { shallowEquals, arrayEquals } from '../../../lib/equality'\nimport { FocusContainer } from '../../lib/focus-container'\nimport { ListRow } from './list-row'\nimport {\n  findNextSelectableRow,\n  SelectionSource,\n  SelectionDirection,\n  IMouseClickSource,\n  IKeyboardSource,\n  ISelectAllSource,\n} from './selection'\nimport { createUniqueId, releaseUniqueId } from '../../lib/id-pool'\nimport { range } from '../../../lib/range'\n\n/**\n * Describe the first argument given to the cellRenderer,\n * See\n *  https://github.com/bvaughn/react-virtualized/issues/386\n *  https://github.com/bvaughn/react-virtualized/blob/8.0.11/source/Grid/defaultCellRangeRenderer.js#L38-L44\n */\nexport interface IRowRendererParams {\n  /** Horizontal (column) index of cell */\n  readonly columnIndex: number\n\n  /** The Grid is currently being scrolled */\n  readonly isScrolling: boolean\n\n  /** Unique key within array of cells */\n  readonly key: React.Key\n\n  /** Vertical (row) index of cell */\n  readonly rowIndex: number\n\n  /** Style object to be applied to cell */\n  readonly style: React.CSSProperties\n}\n\nexport type ClickSource = IMouseClickSource | IKeyboardSource\n\ninterface IListProps {\n  /**\n   * Mandatory callback for rendering the contents of a particular\n   * row. The callback is not responsible for the outer wrapper\n   * of the row, only its contents and may return null although\n   * that will result in an empty list item.\n   */\n  readonly rowRenderer: (row: number) => JSX.Element | null\n\n  /**\n   * The total number of rows in the list. This is used for\n   * scroll virtualization purposes when calculating the theoretical\n   * height of the list.\n   */\n  readonly rowCount: number\n\n  /**\n   * The height of each individual row in the list. This height\n   * is enforced for each row container and attempting to render a row\n   * which does not fit inside that height is forbidden.\n   *\n   * Can either be a number (most efficient) in which case all rows\n   * are of equal height, or, a function that, given a row index returns\n   * the height of that particular row.\n   */\n  readonly rowHeight: number | ((info: { index: number }) => number)\n\n  /**\n   * The currently selected rows indexes. Used to attach a special\n   * selection class on those row's containers as well as being used\n   * for keyboard selection.\n   */\n  readonly selectedRows: ReadonlyArray<number>\n\n  /**\n   * This function will be called when a pointer device is pressed and then\n   * released on a selectable row. Note that this follows the conventions\n   * of button elements such that pressing Enter or Space on a keyboard\n   * while focused on a particular row will also trigger this event. Consumers\n   * can differentiate between the two using the source parameter.\n   *\n   * Note that this event handler will not be called for keyboard events\n   * if event.preventDefault was called in the onRowKeyDown event handler.\n   *\n   * Consumers of this event do _not_ have to call event.preventDefault,\n   * when this event is subscribed to the list will automatically call it.\n   */\n  readonly onRowClick?: (row: number, soure: ClickSource) => void\n\n  /**\n   * This prop defines the behaviour of the selection of items whithin this list.\n   *  - 'single' : (default) single list-item selection. [shift] and [ctrl] have\n   * no effect. Use in combination with one of:\n   *             onSelectedRowChanged(row: number)\n   *             onSelectionChanged(rows: number[])\n   *  - 'range' : allows for selecting continuous ranges. [shift] can be used.\n   * [ctrl] has no effect. Use in combination with one of:\n   *             onSelectedRangeChanged(start: number, end: number)\n   *             onSelectionChanged(rows: number[])\n   *  - 'multi' : allows range and/or arbitrary selection. [shift] and [ctrl]\n   * can be used. Use in combination with:\n   *             onSelectionChanged(rows: number[])\n   */\n  readonly selectionMode?: 'single' | 'range' | 'multi'\n\n  /**\n   * This function will be called when the selection changes as a result of a\n   * user keyboard or mouse action (i.e. not when props change). This function\n   * will not be invoked when an already selected row is clicked on.\n   * Use this function when the selectionMode is 'single'\n   *\n   * @param row    - The index of the row that was just selected\n   * @param source - The kind of user action that provoked the change, either\n   *                 a pointer device press, hover (if selectOnHover is set) or\n   *                 a keyboard event (arrow up/down)\n   */\n  readonly onSelectedRowChanged?: (row: number, source: SelectionSource) => void\n\n  /**\n   * This function will be called when the selection changes as a result of a\n   * user keyboard or mouse action (i.e. not when props change). This function\n   * will not be invoked when an already selected row is clicked on.\n   * Index parameters are inclusive\n   * Use this function when the selectionMode is 'range'\n   *\n   * @param start  - The index of the first selected row\n   * @param end    - The index of the last selected row\n   * @param source - The kind of user action that provoked the change, either\n   *                 a pointer device press, hover (if selectOnHover is set) or\n   *                 a keyboard event (arrow up/down)\n   */\n  readonly onSelectedRangeChanged?: (\n    start: number,\n    end: number,\n    source: SelectionSource\n  ) => void\n\n  /**\n   * This function will be called when the selection changes as a result of a\n   * user keyboard or mouse action (i.e. not when props change). This function\n   * will not be invoked when an already selected row is clicked on.\n   * Use this function for any selectionMode\n   *\n   * @param rows   - The indexes of the row(s) that are part of the selection\n   * @param source - The kind of user action that provoked the change, either\n   *                 a pointer device press, hover (if selectOnHover is set) or\n   *                 a keyboard event (arrow up/down)\n   */\n  readonly onSelectionChanged?: (\n    rows: ReadonlyArray<number>,\n    source: SelectionSource\n  ) => void\n\n  /**\n   * A handler called whenever a key down event is received on the\n   * row container element. Due to the way the container is currently\n   * implemented the element produced by the rowRendered will never\n   * see keyboard events without stealing focus away from the container.\n   *\n   * Primary use case for this is to allow items to react to the space\n   * bar in order to toggle selection. This function is responsible\n   * for calling event.preventDefault() when acting on a key press.\n   */\n  readonly onRowKeyDown?: (row: number, event: React.KeyboardEvent<any>) => void\n\n  /**\n   * A handler called whenever a mouse down event is received on the\n   * row container element. Unlike onSelectionChanged, this is raised\n   * for every mouse down event, whether the row is selected or not.\n   */\n  readonly onRowMouseDown?: (row: number, event: React.MouseEvent<any>) => void\n\n  /**\n   * An optional handler called to determine whether a given row is\n   * selectable or not. Reasons for why a row might not be selectable\n   * includes it being a group header or the item being disabled.\n   */\n  readonly canSelectRow?: (row: number) => boolean\n  readonly onScroll?: (scrollTop: number, clientHeight: number) => void\n\n  /**\n   * List's underlying implementation acts as a pure component based on the\n   * above props. So if there are any other properties that also determine\n   * whether the list should re-render, List must know about them.\n   */\n  readonly invalidationProps?: any\n\n  /** The unique identifier for the outer element of the component (optional, defaults to null) */\n  readonly id?: string\n\n  /** The row that should be scrolled to when the list is rendered. */\n  readonly scrollToRow?: number\n\n  /** Whether or not selection should follow pointer device */\n  readonly selectOnHover?: boolean\n\n  /**\n   * Whether or not to explicitly move focus to a row if it was selected\n   * by hovering (has no effect if selectOnHover is not set). Defaults to\n   * true if not defined.\n   */\n  readonly focusOnHover?: boolean\n\n  readonly ariaMode?: 'list' | 'menu'\n}\n\ninterface IListState {\n  /** The available height for the list as determined by ResizeObserver */\n  readonly height?: number\n\n  /** The available width for the list as determined by ResizeObserver */\n  readonly width?: number\n\n  readonly rowIdPrefix?: string\n}\n\n/**\n * Create an array with row indices between firstRow and lastRow (inclusive).\n *\n * This is essentially a range function with the explicit behavior of\n * inclusive upper and lower bound.\n */\nfunction createSelectionBetween(\n  firstRow: number,\n  lastRow: number\n): ReadonlyArray<number> {\n  // range is upper bound exclusive\n  const end = lastRow > firstRow ? lastRow + 1 : lastRow - 1\n  return range(firstRow, end)\n}\n\nexport class List extends React.Component<IListProps, IListState> {\n  private focusItem: HTMLDivElement | null = null\n  private fakeScroll: HTMLDivElement | null = null\n\n  private scrollToRow = -1\n  private focusRow = -1\n\n  /**\n   * The style prop for our child Grid. We keep this here in order\n   * to not create a new object on each render and thus forcing\n   * the Grid to re-render even though nothing has changed.\n   */\n  private gridStyle: React.CSSProperties = { overflowX: 'hidden' }\n\n  /**\n   * On Win32 we use a fake scroll bar. This variable keeps track of\n   * which of the actual scroll container and the fake scroll container\n   * received the scroll event first to avoid bouncing back and forth\n   * causing jerky scroll bars and more importantly making the mouse\n   * wheel scroll speed appear different when scrolling over the\n   * fake scroll bar and the actual one.\n   */\n  private lastScroll: 'grid' | 'fake' | null = null\n\n  private list: HTMLDivElement | null = null\n  private grid: React.Component<any, any> | null = null\n  private readonly resizeObserver: ResizeObserver | null = null\n  private updateSizeTimeoutId: number | null = null\n\n  public constructor(props: IListProps) {\n    super(props)\n\n    this.state = {}\n\n    const ResizeObserverClass: typeof ResizeObserver = (window as any)\n      .ResizeObserver\n\n    if (ResizeObserver || false) {\n      this.resizeObserver = new ResizeObserverClass(entries => {\n        for (const entry of entries) {\n          if (entry.target === this.list) {\n            // We might end up causing a recursive update by updating the state\n            // when we're reacting to a resize so we'll defer it until after\n            // react is done with this frame.\n            if (this.updateSizeTimeoutId !== null) {\n              clearImmediate(this.updateSizeTimeoutId)\n            }\n\n            this.updateSizeTimeoutId = setImmediate(\n              this.onResized,\n              entry.target,\n              entry.contentRect\n            )\n          }\n        }\n      })\n    }\n  }\n\n  private onResized = (target: HTMLElement, contentRect: ClientRect) => {\n    this.updateSizeTimeoutId = null\n\n    const [width, height] = [target.offsetWidth, target.offsetHeight]\n\n    if (this.state.width !== width || this.state.height !== height) {\n      this.setState({ width, height })\n    }\n  }\n\n  private onSelectAll = (event: Event) => {\n    const selectionMode = this.props.selectionMode\n\n    if (selectionMode !== 'range' && selectionMode !== 'multi') {\n      return\n    }\n\n    event.preventDefault()\n\n    if (this.props.rowCount <= 0) {\n      return\n    }\n\n    const source: ISelectAllSource = { kind: 'select-all' }\n    const firstRow = 0\n    const lastRow = this.props.rowCount - 1\n\n    if (this.props.onSelectionChanged) {\n      const newSelection = createSelectionBetween(firstRow, lastRow)\n      this.props.onSelectionChanged(newSelection, source)\n    }\n\n    if (selectionMode === 'range' && this.props.onSelectedRangeChanged) {\n      this.props.onSelectedRangeChanged(firstRow, lastRow, source)\n    }\n  }\n\n  private onRef = (element: HTMLDivElement | null) => {\n    if (element === null && this.list !== null) {\n      this.list.removeEventListener('select-all', this.onSelectAll)\n    }\n\n    this.list = element\n\n    if (element !== null) {\n      // This is a custom event that desktop emits through <App />\n      // when the user selects the Edit > Select all menu item. We\n      // hijack it and select all list items rather than let it bubble\n      // to electron's default behavior which is to select all selectable\n      // text in the renderer.\n      element.addEventListener('select-all', this.onSelectAll)\n    }\n\n    if (this.resizeObserver) {\n      this.resizeObserver.disconnect()\n\n      if (element !== null) {\n        this.resizeObserver.observe(element)\n      } else {\n        this.setState({ width: undefined, height: undefined })\n      }\n    }\n  }\n\n  private handleKeyDown = (event: React.KeyboardEvent<any>) => {\n    this.props.selectedRows.forEach(row => {\n      if (this.props.onRowKeyDown) {\n        this.props.onRowKeyDown(row, event)\n      }\n    })\n\n    // The consumer is given a change to prevent the default behavior for\n    // keyboard navigation so that they can customize its behavior as needed.\n    if (event.defaultPrevented) {\n      return\n    }\n\n    if (event.key === 'ArrowDown') {\n      if (\n        event.shiftKey &&\n        this.props.selectionMode &&\n        this.props.selectionMode !== 'single'\n      ) {\n        this.addSelection('down', event)\n      } else {\n        this.moveSelection('down', event)\n      }\n      event.preventDefault()\n    } else if (event.key === 'ArrowUp') {\n      if (\n        event.shiftKey &&\n        this.props.selectionMode &&\n        this.props.selectionMode !== 'single'\n      ) {\n        this.addSelection('up', event)\n      } else {\n        this.moveSelection('up', event)\n      }\n      event.preventDefault()\n    }\n  }\n\n  private onRowKeyDown = (\n    rowIndex: number,\n    event: React.KeyboardEvent<any>\n  ) => {\n    if (this.props.onRowKeyDown) {\n      this.props.onRowKeyDown(rowIndex, event)\n    }\n\n    // We give consumers the power to prevent the onRowClick event by subscribing\n    // to the onRowKeyDown event and calling event.preventDefault. This lets\n    // consumers add their own semantics for keyboard presses.\n    if (\n      !event.defaultPrevented &&\n      (event.key === 'Enter' || event.key === ' ')\n    ) {\n      this.toggleSelection(event)\n      event.preventDefault()\n    }\n  }\n\n  private onKeyDown = (event: React.KeyboardEvent<any>) => {\n    if (event.key === 'Enter' || event.key === ' ') {\n      this.toggleSelection(event)\n      event.preventDefault()\n    }\n  }\n\n  private toggleSelection = (event: React.KeyboardEvent<any>) => {\n    this.props.selectedRows.forEach(row => {\n      if (this.props.onRowClick) {\n        this.props.onRowClick(row, { kind: 'keyboard', event })\n      }\n    })\n  }\n\n  private onRowMouseOver = (row: number, event: React.MouseEvent<any>) => {\n    if (this.props.selectOnHover && this.canSelectRow(row)) {\n      if (\n        this.props.selectedRows.includes(row) &&\n        this.props.onSelectionChanged\n      ) {\n        this.props.onSelectionChanged([row], { kind: 'hover', event })\n        // By calling scrollRowToVisible we ensure that hovering over a partially\n        // visible item at the top or bottom of the list scrolls it into view but\n        // more importantly `scrollRowToVisible` automatically manages focus so\n        // using it here allows us to piggy-back on its focus-preserving magic\n        // even though we could theoretically live without scrolling\n        this.scrollRowToVisible(row)\n      }\n    }\n  }\n\n  /** Convenience method for invoking canSelectRow callback when it exists */\n  private canSelectRow = (rowIndex: number) => {\n    return this.props.canSelectRow ? this.props.canSelectRow(rowIndex) : true\n  }\n\n  private addSelection(\n    direction: SelectionDirection,\n    event: React.KeyboardEvent<any>\n  ) {\n    if (this.props.selectedRows.length === 0) {\n      return this.moveSelection(direction, event)\n    }\n\n    const lastSelection = this.props.selectedRows[\n      this.props.selectedRows.length - 1\n    ]\n\n    const selectionOrigin = this.props.selectedRows[0]\n\n    const newRow = findNextSelectableRow(\n      this.props.rowCount,\n      { direction, row: lastSelection, wrap: false },\n      this.canSelectRow\n    )\n\n    if (newRow != null) {\n      if (this.props.onSelectionChanged) {\n        const newSelection = createSelectionBetween(selectionOrigin, newRow)\n        this.props.onSelectionChanged(newSelection, { kind: 'keyboard', event })\n      }\n\n      if (\n        this.props.selectionMode === 'range' &&\n        this.props.onSelectedRangeChanged\n      ) {\n        this.props.onSelectedRangeChanged(selectionOrigin, newRow, {\n          kind: 'keyboard',\n          event,\n        })\n      }\n\n      this.scrollRowToVisible(newRow)\n    }\n  }\n\n  private moveSelection(\n    direction: SelectionDirection,\n    event: React.KeyboardEvent<any>\n  ) {\n    const lastSelection =\n      this.props.selectedRows.length > 0\n        ? this.props.selectedRows[this.props.selectedRows.length - 1]\n        : -1\n\n    const newRow = findNextSelectableRow(\n      this.props.rowCount,\n      { direction, row: lastSelection },\n      this.canSelectRow\n    )\n\n    if (newRow != null) {\n      if (this.props.onSelectionChanged) {\n        this.props.onSelectionChanged([newRow], { kind: 'keyboard', event })\n      }\n\n      if (this.props.onSelectedRowChanged) {\n        this.props.onSelectedRowChanged(newRow, {\n          kind: 'keyboard',\n          event,\n        })\n      }\n\n      this.scrollRowToVisible(newRow)\n    }\n  }\n\n  private scrollRowToVisible(row: number) {\n    this.scrollToRow = row\n\n    if (this.props.focusOnHover !== false) {\n      this.focusRow = row\n    }\n\n    this.forceUpdate()\n  }\n\n  public componentDidUpdate(prevProps: IListProps, prevState: IListState) {\n    // If this state is set it means that someone just used arrow keys (or pgup/down)\n    // to change the selected row. When this happens we need to explicitly shift\n    // keyboard focus to the newly selected item. If focusItem is null then\n    // we're probably just loading more items and we'll catch it on the next\n    // render pass.\n    if (this.focusRow >= 0 && this.focusItem) {\n      this.focusItem.focus()\n      this.focusRow = -1\n      this.forceUpdate()\n    } else if (this.grid) {\n      // A non-exhaustive set of checks to see if our current update has already\n      // triggered a re-render of the Grid. In order to do this perfectly we'd\n      // have to do a shallow compare on all the props we pass to Grid but\n      // this should cover the majority of cases.\n      const gridHasUpdatedAlready =\n        this.props.rowCount !== prevProps.rowCount ||\n        this.state.width !== prevState.width ||\n        this.state.height !== prevState.height\n\n      if (!gridHasUpdatedAlready) {\n        const selectedRowChanged = !arrayEquals(\n          prevProps.selectedRows,\n          this.props.selectedRows\n        )\n\n        const invalidationPropsChanged = !shallowEquals(\n          prevProps.invalidationProps,\n          this.props.invalidationProps\n        )\n\n        // Now we need to figure out whether anything changed in such a way that\n        // the Grid has to update regardless of its props. Previously we passed\n        // our selectedRow and invalidationProps down to Grid and figured that\n        // it, being a pure component, would do the right thing but that's not\n        // quite the case since invalidationProps is a complex object.\n        if (selectedRowChanged || invalidationPropsChanged) {\n          this.grid.forceUpdate()\n        }\n      }\n    }\n  }\n\n  public componentWillMount() {\n    this.setState({ rowIdPrefix: createUniqueId('ListRow') })\n  }\n\n  public componentWillUnmount() {\n    if (this.updateSizeTimeoutId !== null) {\n      clearImmediate(this.updateSizeTimeoutId)\n      this.updateSizeTimeoutId = null\n    }\n\n    if (this.resizeObserver) {\n      this.resizeObserver.disconnect()\n    }\n\n    if (this.state.rowIdPrefix) {\n      releaseUniqueId(this.state.rowIdPrefix)\n    }\n  }\n\n  private onFocusedItemRef = (element: HTMLDivElement | null) => {\n    this.focusItem = element\n  }\n\n  private renderRow = (params: IRowRendererParams) => {\n    const rowIndex = params.rowIndex\n    const selectable = this.canSelectRow(rowIndex)\n    const selected = this.props.selectedRows.indexOf(rowIndex) !== -1\n    const focused = rowIndex === this.focusRow\n\n    // An unselectable row shouldn't be focusable\n    let tabIndex: number | undefined = undefined\n    if (selectable) {\n      tabIndex = selected && this.props.selectedRows[0] === rowIndex ? 0 : -1\n    }\n\n    // We only need to keep a reference to the focused element\n    const ref = focused ? this.onFocusedItemRef : undefined\n\n    const element = this.props.rowRenderer(params.rowIndex)\n\n    const id = this.state.rowIdPrefix\n      ? `${this.state.rowIdPrefix}-${rowIndex}`\n      : undefined\n\n    return (\n      <ListRow\n        key={params.key}\n        id={id}\n        onRef={ref}\n        rowCount={this.props.rowCount}\n        rowIndex={rowIndex}\n        selected={selected}\n        ariaMode={this.props.ariaMode}\n        onRowClick={this.onRowClick}\n        onRowKeyDown={this.onRowKeyDown}\n        onRowMouseDown={this.onRowMouseDown}\n        onRowMouseOver={this.onRowMouseOver}\n        style={params.style}\n        tabIndex={tabIndex}\n        children={element}\n      />\n    )\n  }\n\n  public render() {\n    let content: JSX.Element[] | JSX.Element | null\n\n    if (this.resizeObserver) {\n      content =\n        this.state.width && this.state.height\n          ? this.renderContents(this.state.width, this.state.height)\n          : null\n    } else {\n      // Legacy in the event that we don't have ResizeObserver\n      content = (\n        <AutoSizer disableWidth={true} disableHeight={true}>\n          {({ width, height }: { width: number; height: number }) =>\n            this.renderContents(width, height)\n          }\n        </AutoSizer>\n      )\n    }\n\n    // we select the last item from the selection array for this prop\n    const activeDescendant =\n      this.props.selectedRows.length && this.state.rowIdPrefix\n        ? `${this.state.rowIdPrefix}-${\n            this.props.selectedRows[this.props.selectedRows.length - 1]\n          }`\n        : undefined\n\n    const role = this.props.ariaMode === 'menu' ? 'menu' : 'listbox'\n\n    return (\n      <div\n        ref={this.onRef}\n        id={this.props.id}\n        className=\"list\"\n        onKeyDown={this.handleKeyDown}\n        role={role}\n        aria-activedescendant={activeDescendant}\n      >\n        {content}\n      </div>\n    )\n  }\n\n  /**\n   * Renders the react-virtualized Grid component and optionally\n   * a fake scroll bar component if running on Windows.\n   *\n   * @param width - The width of the Grid as given by AutoSizer\n   * @param height - The height of the Grid as given by AutoSizer\n   *\n   */\n  private renderContents(width: number, height: number) {\n    if (__WIN32__) {\n      return (\n        <>\n          {this.renderGrid(width, height)}\n          {this.renderFakeScroll(height)}\n        </>\n      )\n    }\n\n    return this.renderGrid(width, height)\n  }\n\n  private onGridRef = (ref: React.Component<any, any> | null) => {\n    this.grid = ref\n  }\n\n  private onFakeScrollRef = (ref: HTMLDivElement | null) => {\n    this.fakeScroll = ref\n  }\n\n  /**\n   * Renders the react-virtualized Grid component\n   *\n   * @param width - The width of the Grid as given by AutoSizer\n   * @param height - The height of the Grid as given by AutoSizer\n   */\n  private renderGrid(width: number, height: number) {\n    let scrollToRow = this.props.scrollToRow\n    if (scrollToRow === undefined) {\n      scrollToRow = this.scrollToRow\n    }\n    this.scrollToRow = -1\n\n    // The currently selected list item is focusable but if\n    // there's no focused item (and there's items to switch between)\n    // the list itself needs to be focusable so that you can reach\n    // it with keyboard navigation and select an item.\n    const tabIndex =\n      this.props.selectedRows.length < 1 && this.props.rowCount > 0 ? 0 : -1\n\n    return (\n      <FocusContainer\n        className=\"list-focus-container\"\n        onKeyDown={this.onKeyDown}\n      >\n        <Grid\n          aria-label={''}\n          role={''}\n          ref={this.onGridRef}\n          autoContainerWidth={true}\n          width={width}\n          height={height}\n          columnWidth={width}\n          columnCount={1}\n          rowCount={this.props.rowCount}\n          rowHeight={this.props.rowHeight}\n          cellRenderer={this.renderRow}\n          onScroll={this.onScroll}\n          scrollToRow={scrollToRow}\n          overscanRowCount={4}\n          style={this.gridStyle}\n          tabIndex={tabIndex}\n        />\n      </FocusContainer>\n    )\n  }\n\n  /**\n   * Renders a fake scroll container which sits on top of the\n   * react-virtualized Grid component in order for us to be\n   * able to have nice looking scrollbars on Windows.\n   *\n   * The fake scroll bar synchronizes its position\n   *\n   * NB: Should only be used on win32 platforms and needs to\n   * be coupled with styling that hides scroll bars on Grid\n   * and accurately positions the fake scroll bar.\n   *\n   * @param height The height of the Grid as given by AutoSizer\n   *\n   */\n  private renderFakeScroll(height: number) {\n    let totalHeight: number = 0\n\n    if (typeof this.props.rowHeight === 'number') {\n      totalHeight = this.props.rowHeight * this.props.rowCount\n    } else {\n      for (let i = 0; i < this.props.rowCount; i++) {\n        totalHeight += this.props.rowHeight({ index: i })\n      }\n    }\n\n    return (\n      <div\n        className=\"fake-scroll\"\n        ref={this.onFakeScrollRef}\n        style={{ height }}\n        onScroll={this.onFakeScroll}\n      >\n        <div style={{ height: totalHeight, pointerEvents: 'none' }} />\n      </div>\n    )\n  }\n\n  // Set the scroll position of the actual Grid to that\n  // of the fake scroll bar. This is for mousewheel/touchpad\n  // scrolling on top of the fake Grid or actual dragging of\n  // the scroll thumb.\n  private onFakeScroll = (e: React.UIEvent<HTMLDivElement>) => {\n    // We're getting this event in reaction to the Grid\n    // having been scrolled and subsequently updating the\n    // fake scrollTop, ignore it\n    if (this.lastScroll === 'grid') {\n      this.lastScroll = null\n      return\n    }\n\n    this.lastScroll = 'fake'\n\n    if (this.grid) {\n      const element = ReactDOM.findDOMNode(this.grid)\n      if (element instanceof Element) {\n        element.scrollTop = e.currentTarget.scrollTop\n      }\n    }\n  }\n\n  private onRowMouseDown = (row: number, event: React.MouseEvent<any>) => {\n    if (this.canSelectRow(row)) {\n      if (this.props.onRowMouseDown) {\n        this.props.onRowMouseDown(row, event)\n      }\n\n      // macOS allow emulating a right click by holding down the ctrl key while\n      // performing a \"normal\" click.\n      const isRightClick =\n        event.button === 2 ||\n        (__DARWIN__ && event.button === 0 && event.ctrlKey)\n\n      // prevent the right-click event from changing the selection if not necessary\n      if (isRightClick && this.props.selectedRows.includes(row)) {\n        return\n      }\n\n      const multiSelectKey = __DARWIN__ ? event.metaKey : event.ctrlKey\n\n      if (\n        event.shiftKey &&\n        this.props.selectedRows.length &&\n        this.props.selectionMode &&\n        this.props.selectionMode !== 'single'\n      ) {\n        /*\n         * if [shift] is pressed and selectionMode is different than 'single',\n         * select all in-between first selection and current row\n         */\n        const selectionOrigin = this.props.selectedRows[0]\n\n        if (this.props.onSelectionChanged) {\n          const newSelection = createSelectionBetween(selectionOrigin, row)\n          this.props.onSelectionChanged(newSelection, {\n            kind: 'mouseclick',\n            event,\n          })\n        }\n        if (\n          this.props.selectionMode === 'range' &&\n          this.props.onSelectedRangeChanged\n        ) {\n          this.props.onSelectedRangeChanged(selectionOrigin, row, {\n            kind: 'mouseclick',\n            event,\n          })\n        }\n      } else if (multiSelectKey && this.props.selectionMode === 'multi') {\n        /*\n         * if [ctrl] is pressed and selectionMode is 'multi',\n         * toggle selection of the targeted row\n         */\n        if (this.props.onSelectionChanged) {\n          let newSelection: ReadonlyArray<number>\n          if (this.props.selectedRows.includes(row)) {\n            // remove the ability to deselect the last item\n            if (this.props.selectedRows.length === 1) {\n              return\n            }\n            newSelection = this.props.selectedRows.filter(ix => ix !== row)\n          } else {\n            newSelection = [...this.props.selectedRows, row]\n          }\n\n          this.props.onSelectionChanged(newSelection, {\n            kind: 'mouseclick',\n            event,\n          })\n        }\n      } else if (\n        this.props.selectedRows.length !== 1 ||\n        (this.props.selectedRows.length === 1 &&\n          row !== this.props.selectedRows[0])\n      ) {\n        /*\n         * if no special key is pressed, and that the selection is different,\n         * single selection occurs\n         */\n        if (this.props.onSelectionChanged) {\n          this.props.onSelectionChanged([row], { kind: 'mouseclick', event })\n        }\n        if (this.props.onSelectedRangeChanged) {\n          this.props.onSelectedRangeChanged(row, row, {\n            kind: 'mouseclick',\n            event,\n          })\n        }\n        if (this.props.onSelectedRowChanged) {\n          this.props.onSelectedRowChanged(row, { kind: 'mouseclick', event })\n        }\n      }\n    }\n  }\n\n  private onRowClick = (row: number, event: React.MouseEvent<any>) => {\n    if (this.canSelectRow(row) && this.props.onRowClick) {\n      this.props.onRowClick(row, { kind: 'mouseclick', event })\n    }\n  }\n\n  private onScroll = ({\n    scrollTop,\n    clientHeight,\n  }: {\n    scrollTop: number\n    clientHeight: number\n  }) => {\n    if (this.props.onScroll) {\n      this.props.onScroll(scrollTop, clientHeight)\n    }\n\n    // Set the scroll position of the fake scroll bar to that\n    // of the actual Grid. This is for mousewheel/touchpad scrolling\n    // on top of the Grid.\n    if (__WIN32__ && this.fakeScroll) {\n      // We're getting this event in reaction to the fake scroll\n      // having been scrolled and subsequently updating the\n      // Grid scrollTop, ignore it.\n      if (this.lastScroll === 'fake') {\n        this.lastScroll = null\n        return\n      }\n\n      this.lastScroll = 'grid'\n\n      this.fakeScroll.scrollTop = scrollTop\n    }\n  }\n\n  /**\n   * Explicitly put keyboard focus on the list or the selected item in the list.\n   *\n   * If the list a selected item it will be scrolled (if it's not already\n   * visible) and it will receive keyboard focus. If the list has no selected\n   * item the list itself will receive focus. From there keyboard navigation\n   * can be used to select the first or last items in the list.\n   *\n   * This method is a noop if the list has not yet been mounted.\n   */\n  public focus() {\n    if (\n      this.props.selectedRows.length > 0 &&\n      this.props.selectedRows[this.props.selectedRows.length - 1] <\n        this.props.rowCount\n    ) {\n      this.scrollRowToVisible(\n        this.props.selectedRows[this.props.selectedRows.length - 1]\n      )\n    } else {\n      if (this.grid) {\n        const element = ReactDOM.findDOMNode(this.grid) as HTMLDivElement\n        if (element) {\n          element.focus()\n        }\n      }\n    }\n  }\n\n  public forceUpdate(callback?: () => any) {\n    super.forceUpdate(callback)\n\n    const grid = this.grid\n    if (grid) {\n      grid.forceUpdate()\n    }\n  }\n}\n","import { Repository, ILocalRepositoryState } from '../../models/repository'\nimport { CloningRepository } from '../../models/cloning-repository'\nimport { getDotComAPIEndpoint } from '../../lib/api'\nimport { caseInsensitiveCompare } from '../../lib/compare'\nimport { IFilterListGroup, IFilterListItem } from '../lib/filter-list'\nimport { IAheadBehind } from '../../models/branch'\n\nexport type RepositoryGroupIdentifier = 'github' | 'enterprise' | 'other'\n\nexport type Repositoryish = Repository | CloningRepository\n\nexport interface IRepositoryListItem extends IFilterListItem {\n  readonly text: ReadonlyArray<string>\n  readonly id: string\n  readonly repository: Repositoryish\n  readonly needsDisambiguation: boolean\n  readonly aheadBehind: IAheadBehind | null\n  readonly changedFilesCount: number\n}\n\nconst fallbackValue = {\n  changedFilesCount: 0,\n  aheadBehind: null,\n}\n\nexport function groupRepositories(\n  repositories: ReadonlyArray<Repositoryish>,\n  localRepositoryStateLookup: Map<number, ILocalRepositoryState>\n): ReadonlyArray<IFilterListGroup<IRepositoryListItem>> {\n  const grouped = new Map<RepositoryGroupIdentifier, Repositoryish[]>()\n  for (const repository of repositories) {\n    const gitHubRepository =\n      repository instanceof Repository ? repository.gitHubRepository : null\n    let group: RepositoryGroupIdentifier = 'other'\n    if (gitHubRepository) {\n      if (gitHubRepository.endpoint === getDotComAPIEndpoint()) {\n        group = 'github'\n      } else {\n        group = 'enterprise'\n      }\n    } else {\n      group = 'other'\n    }\n\n    let repositories = grouped.get(group)\n    if (!repositories) {\n      repositories = new Array<Repository>()\n      grouped.set(group, repositories)\n    }\n\n    repositories.push(repository)\n  }\n\n  const groups = new Array<IFilterListGroup<IRepositoryListItem>>()\n\n  const addGroup = (identifier: RepositoryGroupIdentifier) => {\n    const repositories = grouped.get(identifier)\n    if (!repositories || repositories.length === 0) {\n      return\n    }\n\n    const names = new Map<string, number>()\n    for (const repository of repositories) {\n      const existingCount = names.get(repository.name) || 0\n      names.set(repository.name, existingCount + 1)\n    }\n\n    repositories.sort((x, y) => caseInsensitiveCompare(x.name, y.name))\n    const items: ReadonlyArray<IRepositoryListItem> = repositories.map(r => {\n      const nameCount = names.get(r.name) || 0\n      const { aheadBehind, changedFilesCount } =\n        localRepositoryStateLookup.get(r.id) || fallbackValue\n      return {\n        text: [r.name],\n        id: r.id.toString(),\n        repository: r,\n        needsDisambiguation: nameCount > 1,\n        aheadBehind,\n        changedFilesCount,\n      }\n    })\n\n    groups.push({ identifier, items })\n  }\n\n  // NB: This ordering reflects the order in the repositories sidebar.\n  addGroup('github')\n  addGroup('enterprise')\n  addGroup('other')\n\n  return groups\n}\n","import * as React from 'react'\nimport { Repository } from '../../models/repository'\nimport { Octicon, iconForRepository, OcticonSymbol } from '../octicons'\nimport { showContextualMenu } from '../main-process-proxy'\nimport { Repositoryish } from './group-repositories'\nimport { IMenuItem } from '../../lib/menu-item'\nimport { HighlightText } from '../lib/highlight-text'\nimport { IMatches } from '../../lib/fuzzy-find'\nimport { IAheadBehind } from '../../models/branch'\n\nconst defaultEditorLabel = __DARWIN__\n  ? 'Open in External Editor'\n  : 'Open in external editor'\n\ninterface IRepositoryListItemProps {\n  readonly repository: Repositoryish\n\n  /** Whether the user has enabled the setting to confirm removing a repository from the app */\n  readonly askForConfirmationOnRemoveRepository: boolean\n\n  /** Called when the repository should be removed. */\n  readonly onRemoveRepository: (repository: Repositoryish) => void\n\n  /** Called when the repository should be shown in Finder/Explorer/File Manager. */\n  readonly onShowRepository: (repository: Repositoryish) => void\n\n  /** Called when the repository should be shown in the shell. */\n  readonly onOpenInShell: (repository: Repositoryish) => void\n\n  /** Called when the repository should be opened in an external editor */\n  readonly onOpenInExternalEditor: (repository: Repositoryish) => void\n\n  /** The current external editor selected by the user */\n  readonly externalEditorLabel?: string\n\n  /** Does the repository need to be disambiguated in the list? */\n  readonly needsDisambiguation: boolean\n\n  /** The label for the user's preferred shell. */\n  readonly shellLabel: string\n\n  /** The characters in the repository name to highlight */\n  readonly matches: IMatches\n\n  /** Number of commits this local repo branch is behind or ahead of its remote brance */\n  readonly aheadBehind: IAheadBehind | null\n\n  /** Number of uncommitted changes */\n  readonly changedFilesCount: number\n}\n\n/** A repository item. */\nexport class RepositoryListItem extends React.Component<\n  IRepositoryListItemProps,\n  {}\n> {\n  public render() {\n    const repository = this.props.repository\n    const path = repository.path\n    const gitHubRepo =\n      repository instanceof Repository ? repository.gitHubRepository : null\n    const hasChanges = this.props.changedFilesCount > 0\n    const renderAheadBehindIndicator = () => {\n      if (\n        !(repository instanceof Repository) ||\n        this.props.aheadBehind === null\n      ) {\n        return null\n      }\n      const { ahead, behind } = this.props.aheadBehind\n      if (ahead === 0 && behind === 0) {\n        return null\n      }\n      const commitGrammar = (commitNum: number) =>\n        `${commitNum} commit${commitNum > 1 ? 's' : ''}` // english is hard\n      const aheadBehindTooltip =\n        'The currently checked out branch is' +\n        (behind ? ` ${commitGrammar(behind)} behind ` : '') +\n        (behind && ahead ? 'and' : '') +\n        (ahead ? ` ${commitGrammar(ahead)} ahead of ` : '') +\n        'its tracked branch.'\n\n      return (\n        <div className=\"ahead-behind\" title={aheadBehindTooltip}>\n          {ahead > 0 ? <Octicon symbol={OcticonSymbol.arrowSmallUp} /> : null}\n          {behind > 0 ? (\n            <Octicon symbol={OcticonSymbol.arrowSmallDown} />\n          ) : null}\n        </div>\n      )\n    }\n    const repoTooltip = gitHubRepo\n      ? gitHubRepo.fullName + '\\n' + gitHubRepo.htmlURL + '\\n' + path\n      : path\n\n    let prefix: string | null = null\n    if (this.props.needsDisambiguation && gitHubRepo) {\n      prefix = `${gitHubRepo.owner.login}/`\n    }\n\n    return (\n      <div onContextMenu={this.onContextMenu} className=\"repository-list-item\">\n        <div\n          className=\"change-indicator-wrapper\"\n          title={\n            hasChanges ? 'There are uncommitted changes in this repository' : ''\n          }\n        >\n          {hasChanges ? (\n            <Octicon\n              className=\"change-indicator\"\n              symbol={OcticonSymbol.primitiveDot}\n            />\n          ) : null}\n        </div>\n        <Octicon symbol={iconForRepository(repository)} />\n        <div className=\"name\" title={repoTooltip}>\n          {prefix ? <span className=\"prefix\">{prefix}</span> : null}\n          <HighlightText\n            text={repository.name}\n            highlight={this.props.matches.title}\n          />\n        </div>\n\n        {renderAheadBehindIndicator()}\n      </div>\n    )\n  }\n\n  public shouldComponentUpdate(nextProps: IRepositoryListItemProps): boolean {\n    if (\n      nextProps.repository instanceof Repository &&\n      this.props.repository instanceof Repository\n    ) {\n      return (\n        nextProps.repository.id !== this.props.repository.id ||\n        nextProps.matches !== this.props.matches\n      )\n    } else {\n      return true\n    }\n  }\n\n  private onContextMenu = (event: React.MouseEvent<any>) => {\n    event.preventDefault()\n\n    const repository = this.props.repository\n    const missing = repository instanceof Repository && repository.missing\n    const openInExternalEditor = this.props.externalEditorLabel\n      ? `Open in ${this.props.externalEditorLabel}`\n      : defaultEditorLabel\n\n    const showRepositoryLabel = __DARWIN__\n      ? 'Show in Finder'\n      : __WIN32__\n        ? 'Show in Explorer'\n        : 'Show in your File Manager'\n\n    const items: ReadonlyArray<IMenuItem> = [\n      {\n        label: `Open in ${this.props.shellLabel}`,\n        action: this.openInShell,\n        enabled: !missing,\n      },\n      {\n        label: showRepositoryLabel,\n        action: this.showRepository,\n        enabled: !missing,\n      },\n      {\n        label: openInExternalEditor,\n        action: this.openInExternalEditor,\n        enabled: !missing,\n      },\n      { type: 'separator' },\n      {\n        label: this.props.askForConfirmationOnRemoveRepository\n          ? 'Remove'\n          : 'Remove',\n        action: this.removeRepository,\n      },\n    ]\n    showContextualMenu(items)\n  }\n\n  private removeRepository = () => {\n    this.props.onRemoveRepository(this.props.repository)\n  }\n\n  private showRepository = () => {\n    this.props.onShowRepository(this.props.repository)\n  }\n\n  private openInShell = () => {\n    this.props.onOpenInShell(this.props.repository)\n  }\n\n  private openInExternalEditor = () => {\n    this.props.onOpenInExternalEditor(this.props.repository)\n  }\n}\n","import * as React from 'react'\n\nimport { RepositoryListItem } from './repository-list-item'\nimport {\n  groupRepositories,\n  IRepositoryListItem,\n  Repositoryish,\n  RepositoryGroupIdentifier,\n} from './group-repositories'\nimport { FilterList } from '../lib/filter-list'\nimport { IMatches } from '../../lib/fuzzy-find'\nimport { assertNever } from '../../lib/fatal-error'\nimport { ILocalRepositoryState } from '../../models/repository'\nimport { enableRepoInfoIndicators } from '../../lib/feature-flag'\nimport { Dispatcher } from '../../lib/dispatcher'\n\ninterface IRepositoriesListProps {\n  readonly selectedRepository: Repositoryish | null\n  readonly repositories: ReadonlyArray<Repositoryish>\n\n  /** A cache of the latest repository state values, keyed by the repository id */\n  readonly localRepositoryStateLookup: Map<number, ILocalRepositoryState>\n\n  /** Called when a repository has been selected. */\n  readonly onSelectionChanged: (repository: Repositoryish) => void\n\n  /** Whether the user has enabled the setting to confirm removing a repository from the app */\n  readonly askForConfirmationOnRemoveRepository: boolean\n\n  /** Called when the repository should be removed. */\n  readonly onRemoveRepository: (repository: Repositoryish) => void\n\n  /** Called when the repository should be shown in Finder/Explorer/File Manager. */\n  readonly onShowRepository: (repository: Repositoryish) => void\n\n  /** Called when the repository should be shown in the shell. */\n  readonly onOpenInShell: (repository: Repositoryish) => void\n\n  /** Called when the repository should be opened in an external editor */\n  readonly onOpenInExternalEditor: (repository: Repositoryish) => void\n\n  /** The current external editor selected by the user */\n  readonly externalEditorLabel?: string\n\n  /** The label for the user's preferred shell. */\n  readonly shellLabel: string\n\n  /** The callback to fire when the filter text has changed */\n  readonly onFilterTextChanged: (text: string) => void\n\n  /** The text entered by the user to filter their repository list */\n  readonly filterText: string\n\n  readonly dispatcher: Dispatcher\n}\n\nconst RowHeight = 29\n\n/** The list of user-added repositories. */\nexport class RepositoriesList extends React.Component<\n  IRepositoriesListProps,\n  {}\n> {\n  private renderItem = (item: IRepositoryListItem, matches: IMatches) => {\n    const repository = item.repository\n    return (\n      <RepositoryListItem\n        key={repository.id}\n        repository={repository}\n        needsDisambiguation={item.needsDisambiguation}\n        askForConfirmationOnRemoveRepository={\n          this.props.askForConfirmationOnRemoveRepository\n        }\n        onRemoveRepository={this.props.onRemoveRepository}\n        onShowRepository={this.props.onShowRepository}\n        onOpenInShell={this.props.onOpenInShell}\n        onOpenInExternalEditor={this.props.onOpenInExternalEditor}\n        externalEditorLabel={this.props.externalEditorLabel}\n        shellLabel={this.props.shellLabel}\n        matches={matches}\n        aheadBehind={item.aheadBehind}\n        changedFilesCount={item.changedFilesCount}\n      />\n    )\n  }\n\n  private getGroupLabel(identifier: RepositoryGroupIdentifier) {\n    if (identifier === 'github') {\n      return 'GitHub.com'\n    } else if (identifier === 'enterprise') {\n      return 'Enterprise'\n    } else if (identifier === 'other') {\n      return 'Other'\n    } else {\n      return assertNever(identifier, `Unknown identifier: ${identifier}`)\n    }\n  }\n\n  private renderGroupHeader = (id: string) => {\n    const identifier = id as RepositoryGroupIdentifier\n    const label = this.getGroupLabel(identifier)\n    return (\n      <div key={identifier} className=\"filter-list-group-header\">\n        {label}\n      </div>\n    )\n  }\n\n  private onItemClick = (item: IRepositoryListItem) => {\n    if (enableRepoInfoIndicators()) {\n      const hasIndicator =\n        item.changedFilesCount > 0 ||\n        (item.aheadBehind !== null\n          ? item.aheadBehind.ahead > 0 || item.aheadBehind.behind > 0\n          : false)\n      this.props.dispatcher.recordRepoClicked(hasIndicator)\n    }\n    this.props.onSelectionChanged(item.repository)\n  }\n\n  public render() {\n    if (this.props.repositories.length < 1) {\n      return this.noRepositories()\n    }\n\n    const groups = groupRepositories(\n      this.props.repositories,\n      this.props.localRepositoryStateLookup\n    )\n\n    let selectedItem: IRepositoryListItem | null = null\n    const selectedRepository = this.props.selectedRepository\n    if (selectedRepository) {\n      for (const group of groups) {\n        selectedItem =\n          group.items.find(i => {\n            const repository = i.repository\n            return repository.id === selectedRepository.id\n          }) || null\n\n        if (selectedItem) {\n          break\n        }\n      }\n    }\n\n    return (\n      <div className=\"repository-list\">\n        <FilterList<IRepositoryListItem>\n          rowHeight={RowHeight}\n          selectedItem={selectedItem}\n          filterText={this.props.filterText}\n          onFilterTextChanged={this.props.onFilterTextChanged}\n          renderItem={this.renderItem}\n          renderGroupHeader={this.renderGroupHeader}\n          onItemClick={this.onItemClick}\n          groups={groups}\n          invalidationProps={{\n            repositories: this.props.repositories,\n            filterText: this.props.filterText,\n          }}\n        />\n      </div>\n    )\n  }\n\n  private noRepositories() {\n    return (\n      <div className=\"repository-list\">\n        <div className=\"filter-list\">\n          <div className=\"sidebar-message\">No repositories</div>\n        </div>\n      </div>\n    )\n  }\n}\n","export { RepositoriesList } from './repositories-list'\n","import * as React from 'react'\nimport { CSSTransitionGroup } from 'react-transition-group'\nimport { WindowState } from '../../lib/window-state'\n\ninterface IFullScreenInfoProps {\n  readonly windowState: WindowState\n}\n\ninterface IFullScreenInfoState {\n  readonly renderInfo: boolean\n  readonly renderTransitionGroup: boolean\n}\n\nconst transitionAppearDuration = 100\nconst transitionLeaveDuration = 250\nconst holdDuration = 3000\n\n/**\n * A component which displays the status and fullscreen keyboard shortcut\n * when the window becomes fullscreen. This component is rendered on top of all\n * other content (except for dialogs, we can't put ourselves on top of dialogs\n * easily at the moment).\n */\nexport class FullScreenInfo extends React.Component<\n  IFullScreenInfoProps,\n  IFullScreenInfoState\n> {\n  private infoDisappearTimeoutId: number | null = null\n  private transitionGroupDisappearTimeoutId: number | null = null\n\n  public constructor(props: IFullScreenInfoProps) {\n    super(props)\n\n    this.state = {\n      renderInfo: false,\n      renderTransitionGroup: false,\n    }\n  }\n\n  public componentWillReceiveProps(nextProps: IFullScreenInfoProps) {\n    // If the window state hasn't change we don't have to do anything\n    if (nextProps.windowState === this.props.windowState) {\n      return\n    }\n\n    // Clean up any stray timeout\n    if (this.infoDisappearTimeoutId !== null) {\n      window.clearTimeout(this.infoDisappearTimeoutId)\n    }\n\n    if (this.transitionGroupDisappearTimeoutId !== null) {\n      window.clearTimeout(this.transitionGroupDisappearTimeoutId)\n    }\n\n    if (nextProps.windowState === 'full-screen') {\n      this.infoDisappearTimeoutId = window.setTimeout(\n        this.onInfoDisappearTimeout,\n        holdDuration\n      )\n\n      this.transitionGroupDisappearTimeoutId = window.setTimeout(\n        this.onTransitionGroupDisappearTimeout,\n        transitionAppearDuration + holdDuration + transitionLeaveDuration\n      )\n\n      this.setState({\n        renderTransitionGroup: true,\n        renderInfo: true,\n      })\n    } else if (this.state.renderInfo || this.state.renderTransitionGroup) {\n      // We're no longer in full-screen, let's get rid of the notification\n      // immediately without any transitions.\n      this.setState({\n        renderTransitionGroup: false,\n        renderInfo: false,\n      })\n    }\n  }\n\n  private onInfoDisappearTimeout = () => {\n    this.setState({ renderInfo: false })\n  }\n\n  private onTransitionGroupDisappearTimeout = () => {\n    this.setState({ renderTransitionGroup: false })\n  }\n\n  private renderFullScreenNotification() {\n    if (!this.state.renderInfo) {\n      return null\n    }\n\n    const kbdShortcut = __DARWIN__ ? 'F' : 'F11'\n\n    return (\n      <div key=\"notification\" className=\"toast-notification\">\n        Press <kbd>{kbdShortcut}</kbd> to exit fullscreen\n      </div>\n    )\n  }\n\n  public render() {\n    if (!this.state.renderTransitionGroup) {\n      return null\n    }\n\n    return (\n      <CSSTransitionGroup\n        className=\"toast-notification-container\"\n        transitionName=\"toast-animation\"\n        component=\"div\"\n        transitionAppear={true}\n        transitionEnter={false}\n        transitionLeave={true}\n        transitionAppearTimeout={transitionAppearDuration}\n        transitionLeaveTimeout={transitionLeaveDuration}\n      >\n        {this.renderFullScreenNotification()}\n      </CSSTransitionGroup>\n    )\n  }\n}\n","import * as React from 'react'\nimport { CSSTransitionGroup } from 'react-transition-group'\n\ninterface IZoomInfoProps {\n  readonly windowZoomFactor: number\n}\n\ninterface IZoomInfoState {\n  readonly windowZoomFactor: number\n  readonly renderTransitionGroup: boolean\n  readonly renderInfo: boolean\n  readonly transitionName: 'zoom-in' | 'zoom-out'\n}\n\nconst transitionDuration = 100\nconst holdDuration = 750\n\n/**\n * A component which displays the current zoom factor of the window\n * when it changes. This component is rendered on top of all other\n * content (except for dialogs, which we can't put ourselves on top of easily at\n * the moment, and the fullscreen notification.)\n */\nexport class ZoomInfo extends React.Component<IZoomInfoProps, IZoomInfoState> {\n  private infoDisappearTimeoutId: number | null = null\n  private transitionGroupDisappearTimeoutId: number | null = null\n\n  public constructor(props: IZoomInfoProps) {\n    super(props)\n\n    this.state = {\n      windowZoomFactor: props.windowZoomFactor,\n      renderTransitionGroup: false,\n      renderInfo: false,\n      transitionName: 'zoom-in',\n    }\n  }\n\n  public componentWillReceiveProps(nextProps: IZoomInfoProps) {\n    const hasChanged =\n      this.state.windowZoomFactor !== nextProps.windowZoomFactor\n\n    if (!hasChanged) {\n      return\n    }\n\n    if (this.infoDisappearTimeoutId !== null) {\n      window.clearTimeout(this.infoDisappearTimeoutId)\n    }\n\n    if (this.transitionGroupDisappearTimeoutId !== null) {\n      window.clearTimeout(this.transitionGroupDisappearTimeoutId)\n    }\n\n    this.infoDisappearTimeoutId = window.setTimeout(\n      this.onInfoDisappearTimeout,\n      holdDuration\n    )\n\n    this.transitionGroupDisappearTimeoutId = window.setTimeout(\n      this.onTransitionGroupDisappearTimeout,\n      transitionDuration + holdDuration + transitionDuration\n    )\n\n    const transitionName =\n      nextProps.windowZoomFactor > this.state.windowZoomFactor\n        ? 'zoom-in'\n        : 'zoom-out'\n\n    this.setState({\n      windowZoomFactor: nextProps.windowZoomFactor,\n      renderTransitionGroup: hasChanged,\n      renderInfo: hasChanged,\n      transitionName,\n    })\n  }\n\n  private onInfoDisappearTimeout = () => {\n    this.setState({ renderInfo: false })\n  }\n\n  private onTransitionGroupDisappearTimeout = () => {\n    this.setState({ renderTransitionGroup: false })\n  }\n\n  private renderZoomInfo() {\n    if (!this.state.renderInfo) {\n      return null\n    }\n\n    const zoomPercent = `${(this.state.windowZoomFactor * 100).toFixed(0)} %`\n\n    return (\n      <div>\n        <span>{zoomPercent}</span>\n      </div>\n    )\n  }\n\n  public render() {\n    if (!this.state.renderTransitionGroup) {\n      return null\n    }\n\n    return (\n      <CSSTransitionGroup\n        id=\"window-zoom-info\"\n        transitionName={this.state.transitionName}\n        component=\"div\"\n        transitionAppear={true}\n        transitionEnter={false}\n        transitionLeave={true}\n        transitionAppearTimeout={transitionDuration}\n        transitionLeaveTimeout={transitionDuration}\n      >\n        {this.renderZoomInfo()}\n      </CSSTransitionGroup>\n    )\n  }\n}\n","import * as React from 'react'\nimport { ipcRenderer, remote } from 'electron'\nimport {\n  WindowState,\n  getWindowState,\n  windowStateChannelName,\n} from '../../lib/window-state'\nimport * as classNames from 'classnames'\n\n// These paths are all drawn to a 10x10 view box and replicate the symbols\n// seen on Windows 10 window controls.\nconst closePath =\n  'M 0,0 0,0.7 4.3,5 0,9.3 0,10 0.7,10 5,5.7 9.3,10 10,10 10,9.3 5.7,5 10,0.7 10,0 9.3,0 5,4.3 0.7,0 Z'\nconst restorePath =\n  'm 2,1e-5 0,2 -2,0 0,8 8,0 0,-2 2,0 0,-8 z m 1,1 6,0 0,6 -1,0 0,-5 -5,0 z m -2,2 6,0 0,6 -6,0 z'\nconst maximizePath = 'M 0,0 0,10 10,10 10,0 Z M 1,1 9,1 9,9 1,9 Z'\nconst minimizePath = 'M 0,5 10,5 10,6 0,6 Z'\n\ninterface IWindowControlState {\n  readonly windowState: WindowState\n}\n\n/**\n * A component replicating typical win32 window controls in frameless windows\n *\n * Note that the component only supports the Windows platform at the moment\n * and will render nothing when used on other platforms.\n *\n * Uses the electron remote module to perform window state actions on the\n * current window. Relies on the custom ipc channel 'window-state-changed' to\n * be configured in the main process. The channel should emit an event at least\n * every time there's a change in the window state but _may_ send duplicate\n * or out-of-bound events communicating the _current_ state as well.\n */\nexport class WindowControls extends React.Component<{}, IWindowControlState> {\n  public componentWillMount() {\n    this.setState({ windowState: getWindowState(remote.getCurrentWindow()) })\n\n    ipcRenderer.on(windowStateChannelName, this.onWindowStateChanged)\n  }\n\n  public componentWillUnmount() {\n    ipcRenderer.removeListener(\n      windowStateChannelName,\n      this.onWindowStateChanged\n    )\n  }\n\n  public shouldComponentUpdate(nextProps: {}, nextState: IWindowControlState) {\n    return nextState.windowState !== this.state.windowState\n  }\n\n  private onWindowStateChanged = (\n    event: Electron.IpcMessageEvent,\n    args: any\n  ) => {\n    this.setState({ windowState: args as WindowState })\n  }\n\n  private onMinimize = () => {\n    remote.getCurrentWindow().minimize()\n  }\n\n  private onMaximize = () => {\n    remote.getCurrentWindow().maximize()\n  }\n\n  private onRestore = () => {\n    remote.getCurrentWindow().unmaximize()\n  }\n\n  private onClose = () => {\n    remote.getCurrentWindow().close()\n  }\n\n  private renderButton(\n    name: string,\n    onClick: React.EventHandler<React.MouseEvent<any>>,\n    path: string\n  ) {\n    const className = classNames('window-control', name)\n    const title = name[0].toUpperCase() + name.substring(1)\n\n    return (\n      <button\n        aria-label={name}\n        title={title}\n        tabIndex={-1}\n        className={className}\n        onClick={onClick}\n      >\n        <svg aria-hidden=\"true\" version=\"1.1\" width=\"10\" height=\"10\">\n          <path d={path} />\n        </svg>\n      </button>\n    )\n  }\n\n  public render() {\n    // We only know how to render fake Windows-y controls\n    if (!__WIN32__) {\n      return <span />\n    }\n\n    const min = this.renderButton('minimize', this.onMinimize, minimizePath)\n    const maximizeOrRestore =\n      this.state.windowState === 'maximized'\n        ? this.renderButton('restore', this.onRestore, restorePath)\n        : this.renderButton('maximize', this.onMaximize, maximizePath)\n    const close = this.renderButton('close', this.onClose, closePath)\n\n    return (\n      <div className=\"window-controls\">\n        {min}\n        {maximizeOrRestore}\n        {close}\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\n\nimport { remote } from 'electron'\nimport { WindowState } from '../../lib/window-state'\nimport { WindowControls } from './window-controls'\nimport { Octicon, OcticonSymbol } from '../octicons'\n\ninterface ITitleBarProps {\n  /**\n   * The current state of the Window, ie maximized, minimized full-screen etc.\n   */\n  readonly windowState: WindowState\n\n  /** Whether we should hide the toolbar (and show inverted window controls) */\n  readonly titleBarStyle: 'light' | 'dark'\n\n  /** Whether or not to render the app icon */\n  readonly showAppIcon: boolean\n\n  /**\n   * The current zoom factor of the Window represented as a fractional number\n   * where 1 equals 100% (ie actual size) and 2 represents 200%.\n   *\n   * This is used on macOS to scale back the title bar to its original size\n   * regardless of the zoom factor.\n   */\n  readonly windowZoomFactor?: number\n}\n\ninterface ITitleBarState {\n  readonly style?: React.CSSProperties\n}\n\nfunction getState(props: ITitleBarProps): ITitleBarState {\n  // See windowZoomFactor in ITitleBarProps, this is only\n  // applicable on macOS.\n  if (!__DARWIN__) {\n    return { style: undefined }\n  }\n\n  return {\n    style: props.windowZoomFactor\n      ? { zoom: 1 / props.windowZoomFactor }\n      : undefined,\n  }\n}\n\nexport class TitleBar extends React.Component<ITitleBarProps, ITitleBarState> {\n  public constructor(props: ITitleBarProps) {\n    super(props)\n    this.state = getState(props)\n  }\n\n  private onTitlebarDoubleClickDarwin = () => {\n    const actionOnDoubleClick = remote.systemPreferences.getUserDefault(\n      'AppleActionOnDoubleClick',\n      'string'\n    )\n    const mainWindow = remote.getCurrentWindow()\n\n    switch (actionOnDoubleClick) {\n      case 'Maximize':\n        if (mainWindow.isMaximized()) {\n          mainWindow.unmaximize()\n        } else {\n          mainWindow.maximize()\n        }\n        break\n      case 'Minimize':\n        mainWindow.minimize()\n        break\n    }\n  }\n\n  public componentWillReceiveProps(nextProps: ITitleBarProps) {\n    if (__DARWIN__) {\n      if (this.props.windowZoomFactor !== nextProps.windowZoomFactor) {\n        this.setState(getState(nextProps))\n      }\n    }\n  }\n\n  public render() {\n    const inFullScreen = this.props.windowState === 'full-screen'\n    const isMaximized = this.props.windowState === 'maximized'\n\n    // No Windows controls when we're in full-screen mode.\n    const winControls = __WIN32__ && !inFullScreen ? <WindowControls /> : null\n\n    // On Windows it's not possible to resize a frameless window if the\n    // element that sits flush along the window edge has -webkit-app-region: drag.\n    // The menu bar buttons all have no-drag but the area between menu buttons and\n    // window controls need to disable dragging so we add a 3px tall element which\n    // disables drag while still letting users drag the app by the titlebar below\n    // those 3px.\n    const topResizeHandle =\n      __WIN32__ && !isMaximized ? <div className=\"resize-handle top\" /> : null\n\n    // And a 3px wide element on the left hand side.\n    const leftResizeHandle =\n      __WIN32__ && !isMaximized ? <div className=\"resize-handle left\" /> : null\n\n    const titleBarClass =\n      this.props.titleBarStyle === 'light' ? 'light-title-bar' : ''\n\n    const appIcon = this.props.showAppIcon ? (\n      <Octicon className=\"app-icon\" symbol={OcticonSymbol.markGithub} />\n    ) : null\n\n    const onTitlebarDoubleClick = __DARWIN__\n      ? this.onTitlebarDoubleClickDarwin\n      : undefined\n\n    return (\n      <div\n        className={titleBarClass}\n        id=\"desktop-app-title-bar\"\n        onDoubleClick={onTitlebarDoubleClick}\n        style={this.state.style}\n      >\n        {topResizeHandle}\n        {leftResizeHandle}\n        {appIcon}\n        {this.props.children}\n        {winControls}\n      </div>\n    )\n  }\n}\n","export { TitleBar } from './title-bar'\nexport { ZoomInfo } from './zoom-info'\nexport { FullScreenInfo } from './full-screen-info'\n","import * as Path from 'path'\nimport * as FS from 'fs'\nimport { Repository } from '../../models/repository'\nimport { getConfigValue } from './config'\n\n/**\n * Read the contents of the repository .gitignore.\n *\n * Returns a promise which will either be rejected or resolved\n * with the contents of the file. If there's no .gitignore file\n * in the repository root the promise will resolve with null.\n */\nexport async function readGitIgnoreAtRoot(\n  repository: Repository\n): Promise<string | null> {\n  const ignorePath = Path.join(repository.path, '.gitignore')\n\n  return new Promise<string | null>((resolve, reject) => {\n    FS.readFile(ignorePath, 'utf8', (err, data) => {\n      if (err) {\n        if (err.code === 'ENOENT') {\n          resolve(null)\n        } else {\n          reject(err)\n        }\n      } else {\n        resolve(data)\n      }\n    })\n  })\n}\n\n/**\n * Persist the given content to the repository root .gitignore.\n *\n * If the repository root doesn't contain a .gitignore file one\n * will be created, otherwise the current file will be overwritten.\n */\nexport async function saveGitIgnore(\n  repository: Repository,\n  text: string\n): Promise<void> {\n  const ignorePath = Path.join(repository.path, '.gitignore')\n\n  if (text === '') {\n    return new Promise<void>((resolve, reject) => {\n      FS.unlink(ignorePath, err => {\n        if (err) {\n          reject(err)\n        } else {\n          resolve()\n        }\n      })\n    })\n  }\n\n  const fileContents = await formatGitIgnoreContents(text, repository)\n  return new Promise<void>((resolve, reject) => {\n    FS.writeFile(ignorePath, fileContents, err => {\n      if (err) {\n        reject(err)\n      } else {\n        resolve()\n      }\n    })\n  })\n}\n\n/** Add the given pattern or patterns to the root gitignore file */\nexport async function appendIgnoreRule(\n  repository: Repository,\n  patterns: string | string[]\n): Promise<void> {\n  const text = (await readGitIgnoreAtRoot(repository)) || ''\n\n  const currentContents = await formatGitIgnoreContents(text, repository)\n\n  const newPatternText =\n    patterns instanceof Array ? patterns.join('\\n') : patterns\n  const newText = await formatGitIgnoreContents(\n    `${currentContents}${newPatternText}`,\n    repository\n  )\n\n  await saveGitIgnore(repository, newText)\n}\n\n/**\n * Format the gitignore text based on the current config settings.\n *\n * This setting looks at core.autocrlf to decide which line endings to use\n * when updating the .gitignore file.\n *\n * If core.safecrlf is also set, adding this file to the index may cause\n * Git to return a non-zero exit code, leaving the working directory in a\n * confusing state for the user. So we should reformat the file in that\n * case.\n *\n * @param text The text to format.\n * @param repository The repository associated with the gitignore file.\n */\nasync function formatGitIgnoreContents(\n  text: string,\n  repository: Repository\n): Promise<string> {\n  const autocrlf = await getConfigValue(repository, 'core.autocrlf')\n  const safecrlf = await getConfigValue(repository, 'core.safecrlf')\n\n  return new Promise<string>((resolve, reject) => {\n    if (autocrlf === 'true' && safecrlf === 'true') {\n      // based off https://stackoverflow.com/a/141069/1363815\n      const normalizedText = text.replace(/\\r\\n|\\n\\r|\\n|\\r/g, '\\r\\n')\n      resolve(normalizedText)\n      return\n    }\n\n    if (text.endsWith('\\n')) {\n      resolve(text)\n      return\n    }\n\n    if (autocrlf == null) {\n      // fallback to Git default behaviour\n      resolve(`${text}\\n`)\n    } else {\n      const linesEndInCRLF = autocrlf === 'true'\n      if (linesEndInCRLF) {\n        resolve(`${text}\\n`)\n      } else {\n        resolve(`${text}\\r\\n`)\n      }\n    }\n  })\n}\n","export class SubmoduleEntry {\n  public constructor(\n    public readonly sha: string,\n    public readonly path: string,\n    public readonly describe: string\n  ) {}\n}\n","import * as Path from 'path'\nimport { pathExists } from 'fs-extra'\n\nimport { git } from './core'\nimport { Repository } from '../../models/repository'\nimport { SubmoduleEntry } from '../../models/submodule'\n\nexport async function listSubmodules(\n  repository: Repository\n): Promise<ReadonlyArray<SubmoduleEntry>> {\n  const [submodulesFile, submodulesDir] = await Promise.all([\n    pathExists(Path.join(repository.path, '.gitmodules')),\n    pathExists(Path.join(repository.path, '.git', 'modules')),\n  ])\n\n  if (!submodulesFile && !submodulesDir) {\n    log.info('No submodules found. Skipping \"git submodule status\"')\n    return []\n  }\n\n  // We don't recurse when listing submodules here because we don't have a good\n  // story about managing these currently. So for now we're only listing\n  // changes to the top-level submodules to be consistent with `git status`\n  const result = await git(\n    ['submodule', 'status', '--'],\n    repository.path,\n    'listSubmodules',\n    {\n      successExitCodes: new Set([0, 128]),\n    }\n  )\n\n  if (result.exitCode === 128) {\n    // unable to parse submodules in repository, giving up\n    return []\n  }\n\n  const submodules = new Array<SubmoduleEntry>()\n\n  for (const entry of result.stdout.split('\\n')) {\n    if (entry.length === 0) {\n      continue\n    }\n\n    // entries are of the format:\n    //  1eaabe34fc6f486367a176207420378f587d3b48 git (v2.16.0-rc0)\n    //\n    // first character:\n    //   - \" \" if no change\n    //   - \"-\" if the submodule is not initialized\n    //   - \"+\" if the currently checked out submodule commit does not match the SHA-1 found in the index of the containing repository\n    //   - \"U\" if the submodule has merge conflicts\n    //\n    // then the 40-character SHA represents the current commit\n    const sha = entry.substr(1, 40)\n\n    //\n    // then the path to the submodule\n    //\n    // then the output of `git describe` for the submodule in braces\n    // we're not leveraging this in the app, so go and read the docs\n    // about it if you want to learn more:\n    //\n    // https://git-scm.com/docs/git-describe\n\n    const [path, describeOutput] = entry.substr(42).split(/\\s+/)\n\n    // if the submodule has not been initialized, no describe output is set\n    // this means we don't have a submodule to work with\n    if (describeOutput != null) {\n      const describe = describeOutput.substr(1, describeOutput.length - 2)\n      submodules.push(new SubmoduleEntry(sha, path, describe))\n    }\n  }\n\n  return submodules\n}\n\nexport async function resetSubmodulePaths(\n  repository: Repository,\n  paths: ReadonlyArray<string>\n): Promise<void> {\n  for (const path of paths) {\n    await git(\n      ['submodule', 'update', '--recursive', '--', path],\n      repository.path,\n      'updateSubmodule'\n    )\n  }\n}\n","import { git } from './core'\nimport { Repository } from '../../models/repository'\n\n/** Open the merge tool for the given file. */\nexport async function openMergeTool(\n  repository: Repository,\n  path: string\n): Promise<void> {\n  await git(['mergetool', path], repository.path, 'openMergeTool')\n}\n","import { git } from './core'\nimport { Repository } from '../../models/repository'\n\n/**\n * Remove all files from the index\n *\n * @param repository the repository to update\n */\nexport async function unstageAllFiles(repository: Repository): Promise<void> {\n  await git(\n    // these flags are important:\n    // --cached to only remove files from the index\n    // -r       to recursively remove files, in case files are in folders\n    // -f       to ignore differences between working directory and index\n    //          which will block this\n    ['rm', '--cached', '-r', '-f', '.'],\n    repository.path,\n    'unstageAllFiles'\n  )\n}\n","import { GitProgressParser, IProgressStep } from './git'\n\nconst steps: ReadonlyArray<IProgressStep> = [{ title: '', weight: 0 }]\n\n/**\n * A class that parses output from `git revert` and provides structured progress\n * events.\n */\nexport class RevertProgressParser extends GitProgressParser {\n  public constructor() {\n    super(steps)\n  }\n}\n","import { git, gitNetworkArguments, IGitExecutionOptions } from './core'\nimport { Repository } from '../../models/repository'\nimport { Commit } from '../../models/commit'\nimport { envForAuthentication, IGitAccount } from './authentication'\nimport { IRevertProgress } from '../app-state'\nimport { executionOptionsWithProgress } from '../progress/from-process'\nimport { RevertProgressParser } from '../progress/revert'\n\n/**\n * Creates a new commit that reverts the changes of a previous commit\n *\n * @param repository  - The repository to update\n *\n * @param commit         - The SHA of the commit to be reverted\n *\n */\nexport async function revertCommit(\n  repository: Repository,\n  commit: Commit,\n  account: IGitAccount | null,\n  progressCallback?: (progress: IRevertProgress) => void\n) {\n  const args = [...gitNetworkArguments, 'revert']\n  if (commit.parentSHAs.length > 1) {\n    args.push('-m', '1')\n  }\n\n  args.push(commit.sha)\n\n  let opts: IGitExecutionOptions = {}\n  if (progressCallback) {\n    const env = envForAuthentication(account)\n    opts = await executionOptionsWithProgress(\n      { env, trackLFSProgress: true },\n      new RevertProgressParser(),\n      progress => {\n        const description =\n          progress.kind === 'progress' ? progress.details.text : progress.text\n        const title = progress.kind === 'progress' ? progress.details.title : ''\n        const value = progress.percent\n\n        progressCallback({ kind: 'revert', description, value, title })\n      }\n    )\n  }\n\n  await git(args, repository.path, 'revert', opts)\n}\n","import { git } from './core'\nimport { Repository } from '../../models/repository'\n\n/**\n * Forcefully updates the working directory with information from the index\n * for a given set of files.\n *\n * This method is essentially the same as running `git checkout -- files`\n * except by using `checkout-index` we can pass the files we want updated\n * on stdin, avoiding all issues with too long arguments.\n *\n * Note that this function will not yield errors for paths that don't\n * exist in the index (-q).\n *\n * @param repository The repository in which to update the working directory\n *                   with information from the index\n *\n * @param paths      The relative paths in the working directory to update\n *                   with information from the index.\n */\nexport async function checkoutIndex(\n  repository: Repository,\n  paths: ReadonlyArray<string>\n) {\n  if (!paths.length) {\n    return\n  }\n\n  await git(\n    ['checkout-index', '-f', '-u', '-q', '--stdin', '-z'],\n    repository.path,\n    'checkoutIndex',\n    {\n      stdin: paths.join('\\0'),\n    }\n  )\n}\n","import { git } from './core'\nimport { Repository } from '../../models/repository'\n\n/**\n * Possible statuses of an entry in Git, see the git diff-index\n * man page for additional details.\n */\nexport enum IndexStatus {\n  Unknown = 0,\n  Added,\n  Copied,\n  Deleted,\n  Modified,\n  Renamed,\n  TypeChanged,\n  Unmerged,\n}\n\n/**\n * Index statuses excluding renames and copies.\n *\n * Used when invoking diff-index with rename detection explicitly turned\n * off.\n */\nexport type NoRenameIndexStatus =\n  | IndexStatus.Added\n  | IndexStatus.Deleted\n  | IndexStatus.Modified\n  | IndexStatus.TypeChanged\n  | IndexStatus.Unmerged\n  | IndexStatus.Unknown\n\nfunction getIndexStatus(status: string) {\n  switch (status[0]) {\n    case 'A':\n      return IndexStatus.Added\n    case 'C':\n      return IndexStatus.Copied\n    case 'D':\n      return IndexStatus.Deleted\n    case 'M':\n      return IndexStatus.Modified\n    case 'R':\n      return IndexStatus.Renamed\n    case 'T':\n      return IndexStatus.TypeChanged\n    case 'U':\n      return IndexStatus.Unmerged\n    case 'X':\n      return IndexStatus.Unknown\n    default:\n      throw new Error(`Unknown index status: ${status}`)\n  }\n}\n\nfunction getNoRenameIndexStatus(status: string): NoRenameIndexStatus {\n  const parsed = getIndexStatus(status)\n\n  switch (parsed) {\n    case IndexStatus.Copied:\n    case IndexStatus.Renamed:\n      throw new Error(\n        `Invalid index status for no-rename index status: ${parsed}`\n      )\n  }\n\n  return parsed\n}\n\n/** The SHA for the null tree. */\nconst NullTreeSHA = '4b825dc642cb6eb9a060e54bf8d69288fbee4904'\n\n/**\n * Get a list of files which have recorded changes in the index as compared to\n * HEAD along with the type of change.\n *\n * @param repository The repository for which to retrieve the index changes.\n */\nexport async function getIndexChanges(\n  repository: Repository\n): Promise<Map<string, NoRenameIndexStatus>> {\n  const args = ['diff-index', '--cached', '--name-status', '--no-renames', '-z']\n\n  let result = await git(\n    [...args, 'HEAD', '--'],\n    repository.path,\n    'getIndexChanges',\n    {\n      successExitCodes: new Set([0, 128]),\n    }\n  )\n\n  // 128 from diff-index either means that the path isn't a repository or (more\n  // likely) that the repository HEAD is unborn. If HEAD is unborn we'll diff\n  // the index against the null tree instead.\n  if (result.exitCode === 128) {\n    result = await git(\n      [...args, NullTreeSHA],\n      repository.path,\n      'getIndexChanges'\n    )\n  }\n\n  const map = new Map<string, NoRenameIndexStatus>()\n\n  const pieces = result.stdout.split('\\0')\n\n  for (let i = 0; i < pieces.length - 1; i += 2) {\n    const status = getNoRenameIndexStatus(pieces[i])\n    const path = pieces[i + 1]\n\n    map.set(path, status)\n  }\n\n  return map\n}\n","import { IMergeEntry, MergeResult, MergeResultKind } from '../models/merge'\n\ninterface IBlobSource {\n  readonly type: string\n  readonly path: string\n  readonly sha: string\n  readonly mode: string\n}\n\nfunction updateCurrentMergeEntry(\n  entry: IMergeEntry | undefined,\n  context: string,\n  blobSource: IBlobSource\n): IMergeEntry {\n  const currentMergeEntry = entry || {\n    context,\n    diff: '',\n  }\n\n  const blob = {\n    sha: blobSource.sha,\n    mode: blobSource.mode,\n    path: blobSource.path,\n  }\n\n  switch (blobSource.type) {\n    case 'base':\n      return {\n        ...currentMergeEntry,\n        base: blob,\n      }\n    case 'result':\n      return {\n        ...currentMergeEntry,\n        result: blob,\n      }\n    case 'our':\n      return {\n        ...currentMergeEntry,\n        our: blob,\n      }\n    case 'their':\n      return {\n        ...currentMergeEntry,\n        their: blob,\n      }\n    default:\n      return currentMergeEntry\n  }\n}\n\n// the merge-tree output is a collection of entries like this\n//\n// changed in both\n//  base   100644 f69fbc5c40409a1db7a3f8353bfffe46a21d6054 atom/browser/resources/mac/Info.plist\n//  our    100644 9094f0f7335edf833d51f688851e6a105de60433 atom/browser/resources/mac/Info.plist\n//  their  100644 2dd8bc646cff3869557549a39477e30022e6cfdd atom/browser/resources/mac/Info.plist\n// @@ -17,9 +17,15 @@\n// <key>CFBundleIconFile</key>\n// <string>electron.icns</string>\n// <key>CFBundleVersion</key>\n// +<<<<<<< .our\n// <string>4.0.0</string>\n// <key>CFBundleShortVersionString</key>\n// <string>4.0.0</string>\n// +=======\n// +  <string>1.4.16</string>\n// +  <key>CFBundleShortVersionString</key>\n// +  <string>1.4.16</string>\n// +>>>>>>> .their\n// <key>LSApplicationCategoryType</key>\n//<string>public.app-category.developer-tools</string>\n// <key>LSMinimumSystemVersion</key>\n\n// The first line for each entry is what I'm referring to as the the header\n// This regex filters on the known entries that can appear\nconst contextHeaderRe = /^(merged|added in remote|removed in remote|changed in both|removed in local|added in both)$/\n\n// the rest of the header is made up of a number of entries formatted like this\n//\n//  base   100644 f69fbc5c40409a1db7a3f8353bfffe46a21d6054 atom/browser/resources/mac/Info.plist\n//\n// this regex let's us extract the blob details - the filename may also change\n// as part of the merge if files are moved or renamed\nconst blobEntryRe = /^\\s{2}(result|our|their|base)\\s+(\\d{6})\\s([0-9a-f]{40})\\s(.+)$/\n\n/**\n * Parse the Git output of a merge-tree command to identify whether it\n * has detected any conflicts between the branches to be merged\n *\n * @param text the stdout from a `git merge-tree` command\n *\n */\nexport function parseMergeResult(text: string): MergeResult {\n  const entries = new Array<IMergeEntry>()\n\n  const lines = text.split('\\n')\n\n  let mergeEntryHeader: string | undefined\n  let currentMergeEntry: IMergeEntry | undefined\n\n  for (const line of lines) {\n    const headerMatch = contextHeaderRe.exec(line)\n    if (headerMatch != null) {\n      mergeEntryHeader = headerMatch[1]\n\n      // push the previous entry, if defined, into the array\n      if (currentMergeEntry != null) {\n        entries.push(currentMergeEntry)\n        currentMergeEntry = undefined\n      }\n\n      continue\n    }\n\n    // the next lines are a number of merge result entries\n    // pointing to blobs representing the source blob\n    // and the resulting blob generated by the merge\n    const blobMatch = blobEntryRe.exec(line)\n    if (blobMatch != null) {\n      const type = blobMatch[1]\n      const mode = blobMatch[2]\n      const sha = blobMatch[3]\n      const path = blobMatch[4]\n\n      const blob = {\n        type,\n        mode,\n        sha,\n        path,\n      }\n\n      if (mergeEntryHeader == null) {\n        log.warn(\n          `An unknown header was set while trying to parse the blob ${line}`\n        )\n        continue\n      }\n\n      switch (type) {\n        case 'base':\n        case 'result':\n        case 'our':\n        case 'their':\n          currentMergeEntry = updateCurrentMergeEntry(\n            currentMergeEntry,\n            mergeEntryHeader,\n            blob\n          )\n          break\n\n        default:\n          throw new Error(\n            `invalid state - unexpected entry ${type} found when parsing rows`\n          )\n      }\n      continue\n    }\n\n    if (currentMergeEntry == null) {\n      throw new Error(\n        `invalid state - trying to append the diff to a merge entry that isn't defined. line: '${line}'`\n      )\n    } else {\n      const currentDiff = currentMergeEntry.diff\n      const newDiff = currentDiff + line + '\\n'\n      currentMergeEntry = {\n        ...currentMergeEntry,\n        diff: newDiff,\n      }\n\n      const lineHasConflictMarker =\n        line.startsWith('+<<<<<<<') ||\n        line.startsWith('+=======') ||\n        line.startsWith('+>>>>>>>')\n\n      if (lineHasConflictMarker) {\n        currentMergeEntry = {\n          ...currentMergeEntry,\n          hasConflicts: true,\n        }\n      }\n    }\n  }\n\n  // ensure the last entry is pushed onto the array\n  if (currentMergeEntry != null) {\n    entries.push(currentMergeEntry)\n    currentMergeEntry = undefined\n  }\n\n  const entriesWithConflicts = entries.filter(e => e.hasConflicts || false)\n\n  if (entriesWithConflicts.length > 0) {\n    return {\n      kind: MergeResultKind.Conflicts,\n      conflictedFiles: entriesWithConflicts.length,\n    }\n  } else {\n    return { kind: MergeResultKind.Clean, entries }\n  }\n}\n","import { git } from './core'\nimport { Repository } from '../../models/repository'\nimport { Branch } from '../../models/branch'\nimport { MergeResult, MergeResultKind } from '../../models/merge'\nimport { parseMergeResult } from '../merge-tree-parser'\nimport { spawnAndComplete } from './spawn'\n\n/** Merge the named branch into the current branch. */\nexport async function merge(\n  repository: Repository,\n  branch: string\n): Promise<void> {\n  await git(['merge', branch], repository.path, 'merge')\n}\n\n/**\n * Find the base commit between two commit-ish identifiers\n *\n * @returns the commit id of the merge base, or null if the two commit-ish\n *          identifiers do not have a common base\n */\nexport async function getMergeBase(\n  repository: Repository,\n  firstCommitish: string,\n  secondCommitish: string\n): Promise<string | null> {\n  const process = await git(\n    ['merge-base', firstCommitish, secondCommitish],\n    repository.path,\n    'merge-base',\n    {\n      // - 1 is returned if a common ancestor cannot be resolved\n      // - 128 is returned if a ref cannot be found\n      //   \"warning: ignoring broken ref refs/remotes/origin/master.\"\n      successExitCodes: new Set([0, 1, 128]),\n    }\n  )\n\n  if (process.exitCode === 1 || process.exitCode === 128) {\n    return null\n  }\n\n  return process.stdout.trim()\n}\n\n/**\n * Generate the merge result from two branches in a repository\n *\n * @param repository The repository containing the branches to merge\n * @param ours The current branch\n * @param theirs Another branch to merge into the current branch\n */\nexport async function mergeTree(\n  repository: Repository,\n  ours: Branch,\n  theirs: Branch\n): Promise<MergeResult | null> {\n  const mergeBase = await getMergeBase(repository, ours.tip.sha, theirs.tip.sha)\n\n  if (mergeBase === null) {\n    return { kind: MergeResultKind.Invalid }\n  }\n\n  if (mergeBase === ours.tip.sha || mergeBase === theirs.tip.sha) {\n    return { kind: MergeResultKind.Clean, entries: [] }\n  }\n\n  const result = await spawnAndComplete(\n    ['merge-tree', mergeBase, ours.tip.sha, theirs.tip.sha],\n    repository.path,\n    'mergeTree'\n  )\n\n  const output = result.output.toString()\n\n  if (output.length === 0) {\n    // the merge commit will be empty - this is fine!\n    return { kind: MergeResultKind.Clean, entries: [] }\n  }\n\n  return parseMergeResult(output)\n}\n\n/**\n * Abort a mid-flight (conflicted) merge\n *\n * @param repository where to abort the merge\n */\nexport async function abortMerge(repository: Repository): Promise<void> {\n  await git(['merge', '--abort'], repository.path, 'abortMerge')\n}\n","import { git } from './core'\nimport { Repository } from '../../models/repository'\nimport { CommitIdentity } from '../../models/commit-identity'\n\n/**\n * Gets the author identity, ie the name and email which would\n * have been used should a commit have been performed in this\n * instance. This differs from what's stored in the user.name\n * and user.email config variables in that it will match what\n * Git itself will use in a commit even if there's no name or\n * email configured. If no email or name is configured Git will\n * attempt to come up with a suitable replacement using the\n * signed-in system user and hostname.\n *\n * A null return value means that no name/and or email was set\n * and the user.useconfigonly setting prevented Git from making\n * up a user ident string. If this returns null any subsequent\n * commits can be expected to fail as well.\n */\nexport async function getAuthorIdentity(\n  repository: Repository\n): Promise<CommitIdentity | null> {\n  const result = await git(\n    ['var', 'GIT_AUTHOR_IDENT'],\n    repository.path,\n    'getAuthorIdentity',\n    {\n      successExitCodes: new Set([0, 128]),\n    }\n  )\n\n  // If user.user.useconfigonly is set and no user.name or user.email\n  if (result.exitCode === 128) {\n    return null\n  }\n\n  return CommitIdentity.parseIdentity(result.stdout)\n}\n","import { git } from './core'\nimport { Repository } from '../../models/repository'\n\n/**\n * Update the ref to a new value.\n *\n * @param repository - The repository in which the ref exists.\n * @param ref        - The ref to update. Must be fully qualified\n *                     (e.g., `refs/heads/NAME`).\n * @param oldValue   - The value we expect the ref to have currently. If it\n *                     doesn't match, the update will be aborted.\n * @param newValue   - The new value for the ref.\n * @param reason     - The reflog entry.\n */\nexport async function updateRef(\n  repository: Repository,\n  ref: string,\n  oldValue: string,\n  newValue: string,\n  reason: string\n): Promise<void> {\n  await git(\n    ['update-ref', ref, newValue, oldValue, '-m', reason],\n    repository.path,\n    'updateRef'\n  )\n}\n\n/**\n * Remove a ref.\n *\n * @param repository - The repository in which the ref exists.\n * @param ref        - The ref to remove. Should be fully qualified, but may also be 'HEAD'.\n * @param reason     - The reflog entry.\n */\nexport async function deleteRef(\n  repository: Repository,\n  ref: string,\n  reason: string\n): Promise<true | undefined> {\n  const result = await git(\n    ['update-ref', '-m', reason, '-d', ref],\n    repository.path,\n    'deleteRef'\n  )\n\n  if (result.exitCode === 0) {\n    return true\n  }\n\n  return undefined\n}\n","/**\n * Copyright (c) 2013 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\"use strict\";\nfunction Deque(capacity) {\n    this._capacity = getCapacity(capacity);\n    this._length = 0;\n    this._front = 0;\n    if (isArray(capacity)) {\n        var len = capacity.length;\n        for (var i = 0; i < len; ++i) {\n            this[i] = capacity[i];\n        }\n        this._length = len;\n    }\n}\n\nDeque.prototype.toArray = function Deque$toArray() {\n    var len = this._length;\n    var ret = new Array(len);\n    var front = this._front;\n    var capacity = this._capacity;\n    for (var j = 0; j < len; ++j) {\n        ret[j] = this[(front + j) & (capacity - 1)];\n    }\n    return ret;\n};\n\nDeque.prototype.push = function Deque$push(item) {\n    var argsLength = arguments.length;\n    var length = this._length;\n    if (argsLength > 1) {\n        var capacity = this._capacity;\n        if (length + argsLength > capacity) {\n            for (var i = 0; i < argsLength; ++i) {\n                this._checkCapacity(length + 1);\n                var j = (this._front + length) & (this._capacity - 1);\n                this[j] = arguments[i];\n                length++;\n                this._length = length;\n            }\n            return length;\n        }\n        else {\n            var j = this._front;\n            for (var i = 0; i < argsLength; ++i) {\n                this[(j + length) & (capacity - 1)] = arguments[i];\n                j++;\n            }\n            this._length = length + argsLength;\n            return length + argsLength;\n        }\n\n    }\n\n    if (argsLength === 0) return length;\n\n    this._checkCapacity(length + 1);\n    var i = (this._front + length) & (this._capacity - 1);\n    this[i] = item;\n    this._length = length + 1;\n    return length + 1;\n};\n\nDeque.prototype.pop = function Deque$pop() {\n    var length = this._length;\n    if (length === 0) {\n        return void 0;\n    }\n    var i = (this._front + length - 1) & (this._capacity - 1);\n    var ret = this[i];\n    this[i] = void 0;\n    this._length = length - 1;\n    return ret;\n};\n\nDeque.prototype.shift = function Deque$shift() {\n    var length = this._length;\n    if (length === 0) {\n        return void 0;\n    }\n    var front = this._front;\n    var ret = this[front];\n    this[front] = void 0;\n    this._front = (front + 1) & (this._capacity - 1);\n    this._length = length - 1;\n    return ret;\n};\n\nDeque.prototype.unshift = function Deque$unshift(item) {\n    var length = this._length;\n    var argsLength = arguments.length;\n\n\n    if (argsLength > 1) {\n        var capacity = this._capacity;\n        if (length + argsLength > capacity) {\n            for (var i = argsLength - 1; i >= 0; i--) {\n                this._checkCapacity(length + 1);\n                var capacity = this._capacity;\n                var j = (((( this._front - 1 ) &\n                    ( capacity - 1) ) ^ capacity ) - capacity );\n                this[j] = arguments[i];\n                length++;\n                this._length = length;\n                this._front = j;\n            }\n            return length;\n        }\n        else {\n            var front = this._front;\n            for (var i = argsLength - 1; i >= 0; i--) {\n                var j = (((( front - 1 ) &\n                    ( capacity - 1) ) ^ capacity ) - capacity );\n                this[j] = arguments[i];\n                front = j;\n            }\n            this._front = front;\n            this._length = length + argsLength;\n            return length + argsLength;\n        }\n    }\n\n    if (argsLength === 0) return length;\n\n    this._checkCapacity(length + 1);\n    var capacity = this._capacity;\n    var i = (((( this._front - 1 ) &\n        ( capacity - 1) ) ^ capacity ) - capacity );\n    this[i] = item;\n    this._length = length + 1;\n    this._front = i;\n    return length + 1;\n};\n\nDeque.prototype.peekBack = function Deque$peekBack() {\n    var length = this._length;\n    if (length === 0) {\n        return void 0;\n    }\n    var index = (this._front + length - 1) & (this._capacity - 1);\n    return this[index];\n};\n\nDeque.prototype.peekFront = function Deque$peekFront() {\n    if (this._length === 0) {\n        return void 0;\n    }\n    return this[this._front];\n};\n\nDeque.prototype.get = function Deque$get(index) {\n    var i = index;\n    if ((i !== (i | 0))) {\n        return void 0;\n    }\n    var len = this._length;\n    if (i < 0) {\n        i = i + len;\n    }\n    if (i < 0 || i >= len) {\n        return void 0;\n    }\n    return this[(this._front + i) & (this._capacity - 1)];\n};\n\nDeque.prototype.isEmpty = function Deque$isEmpty() {\n    return this._length === 0;\n};\n\nDeque.prototype.clear = function Deque$clear() {\n    var len = this._length;\n    var front = this._front;\n    var capacity = this._capacity;\n    for (var j = 0; j < len; ++j) {\n        this[(front + j) & (capacity - 1)] = void 0;\n    }\n    this._length = 0;\n    this._front = 0;\n};\n\nDeque.prototype.toString = function Deque$toString() {\n    return this.toArray().toString();\n};\n\nDeque.prototype.valueOf = Deque.prototype.toString;\nDeque.prototype.removeFront = Deque.prototype.shift;\nDeque.prototype.removeBack = Deque.prototype.pop;\nDeque.prototype.insertFront = Deque.prototype.unshift;\nDeque.prototype.insertBack = Deque.prototype.push;\nDeque.prototype.enqueue = Deque.prototype.push;\nDeque.prototype.dequeue = Deque.prototype.shift;\nDeque.prototype.toJSON = Deque.prototype.toArray;\n\nObject.defineProperty(Deque.prototype, \"length\", {\n    get: function() {\n        return this._length;\n    },\n    set: function() {\n        throw new RangeError(\"\");\n    }\n});\n\nDeque.prototype._checkCapacity = function Deque$_checkCapacity(size) {\n    if (this._capacity < size) {\n        this._resizeTo(getCapacity(this._capacity * 1.5 + 16));\n    }\n};\n\nDeque.prototype._resizeTo = function Deque$_resizeTo(capacity) {\n    var oldCapacity = this._capacity;\n    this._capacity = capacity;\n    var front = this._front;\n    var length = this._length;\n    if (front + length > oldCapacity) {\n        var moveItemsCount = (front + length) & (oldCapacity - 1);\n        arrayMove(this, 0, this, oldCapacity, moveItemsCount);\n    }\n};\n\n\nvar isArray = Array.isArray;\n\nfunction arrayMove(src, srcIndex, dst, dstIndex, len) {\n    for (var j = 0; j < len; ++j) {\n        dst[j + dstIndex] = src[j + srcIndex];\n        src[j + srcIndex] = void 0;\n    }\n}\n\nfunction pow2AtLeast(n) {\n    n = n >>> 0;\n    n = n - 1;\n    n = n | (n >> 1);\n    n = n | (n >> 2);\n    n = n | (n >> 4);\n    n = n | (n >> 8);\n    n = n | (n >> 16);\n    return n + 1;\n}\n\nfunction getCapacity(capacity) {\n    if (typeof capacity !== \"number\") {\n        if (isArray(capacity)) {\n            capacity = capacity.length;\n        }\n        else {\n            return 16;\n        }\n    }\n    return pow2AtLeast(\n        Math.min(\n            Math.max(16, capacity), 1073741824)\n    );\n}\n\nmodule.exports = Deque;\n","import * as Deque from 'double-ended-queue'\n\nimport { FileEntry, GitStatusEntry } from '../models/status'\n\ntype StatusItem = IStatusHeader | IStatusEntry\n\nexport interface IStatusHeader {\n  readonly kind: 'header'\n  readonly value: string\n}\n\n/** A representation of a parsed status entry from git status */\nexport interface IStatusEntry {\n  readonly kind: 'entry'\n\n  /** The path to the file relative to the repository root */\n  readonly path: string\n\n  /** The two character long status code */\n  readonly statusCode: string\n\n  /** The original path in the case of a renamed file */\n  readonly oldPath?: string\n}\n\nexport function isStatusHeader(\n  statusItem: StatusItem\n): statusItem is IStatusHeader {\n  return statusItem.kind === 'header'\n}\n\nexport function isStatusEntry(\n  statusItem: StatusItem\n): statusItem is IStatusEntry {\n  return statusItem.kind === 'entry'\n}\n\nconst ChangedEntryType = '1'\nconst RenamedOrCopiedEntryType = '2'\nconst UnmergedEntryType = 'u'\nconst UntrackedEntryType = '?'\nconst IgnoredEntryType = '!'\n\n/** Parses output from git status --porcelain -z into file status entries */\nexport function parsePorcelainStatus(\n  output: string\n): ReadonlyArray<StatusItem> {\n  const entries = new Array<StatusItem>()\n\n  // See https://git-scm.com/docs/git-status\n  //\n  // In the short-format, the status of each path is shown as\n  // XY PATH1 -> PATH2\n  //\n  // There is also an alternate -z format recommended for machine parsing. In that\n  // format, the status field is the same, but some other things change. First,\n  // the -> is omitted from rename entries and the field order is reversed (e.g\n  // from -> to becomes to from). Second, a NUL (ASCII 0) follows each filename,\n  // replacing space as a field separator and the terminating newline (but a space\n  // still separates the status field from the first filename). Third, filenames\n  // containing special characters are not specially formatted; no quoting or\n  // backslash-escaping is performed.\n\n  const tokens = output.split('\\0')\n  const queue = new Deque(tokens)\n\n  let field: string | undefined\n\n  while ((field = queue.shift())) {\n    if (field.startsWith('# ') && field.length > 2) {\n      entries.push({ kind: 'header', value: field.substr(2) })\n      continue\n    }\n\n    const entryKind = field.substr(0, 1)\n\n    if (entryKind === ChangedEntryType) {\n      entries.push(parseChangedEntry(field))\n    } else if (entryKind === RenamedOrCopiedEntryType) {\n      entries.push(parsedRenamedOrCopiedEntry(field, queue.shift()))\n    } else if (entryKind === UnmergedEntryType) {\n      entries.push(parseUnmergedEntry(field))\n    } else if (entryKind === UntrackedEntryType) {\n      entries.push(parseUntrackedEntry(field))\n    } else if (entryKind === IgnoredEntryType) {\n      // Ignored, we don't care about these for now\n    }\n  }\n\n  return entries\n}\n\n// 1 <XY> <sub> <mH> <mI> <mW> <hH> <hI> <path>\nconst changedEntryRe = /^1 ([MADRCUTX?!.]{2}) (N\\.\\.\\.|S[C.][M.][U.]) (\\d+) (\\d+) (\\d+) ([a-f0-9]+) ([a-f0-9]+) ([\\s\\S]*?)$/\n\nfunction parseChangedEntry(field: string): IStatusEntry {\n  const match = changedEntryRe.exec(field)\n\n  if (!match) {\n    throw new Error(`Failed to parse status line for changed entry: ${field}`)\n  }\n\n  return {\n    kind: 'entry',\n    statusCode: match[1],\n    path: match[8],\n  }\n}\n\n// 2 <XY> <sub> <mH> <mI> <mW> <hH> <hI> <X><score> <path><sep><origPath>\nconst renamedOrCopiedEntryRe = /^2 ([MADRCUTX?!.]{2}) (N\\.\\.\\.|S[C.][M.][U.]) (\\d+) (\\d+) (\\d+) ([a-f0-9]+) ([a-f0-9]+) ([RC]\\d+) ([\\s\\S]*?)$/\n\nfunction parsedRenamedOrCopiedEntry(\n  field: string,\n  oldPath: string | undefined\n): IStatusEntry {\n  const match = renamedOrCopiedEntryRe.exec(field)\n\n  if (!match) {\n    throw new Error(\n      `Failed to parse status line for renamed or copied entry: ${field}`\n    )\n  }\n\n  if (!oldPath) {\n    throw new Error(\n      'Failed to parse renamed or copied entry, could not parse old path'\n    )\n  }\n\n  return {\n    kind: 'entry',\n    statusCode: match[1],\n    oldPath,\n    path: match[9],\n  }\n}\n\n// u <xy> <sub> <m1> <m2> <m3> <mW> <h1> <h2> <h3> <path>\nconst unmergedEntryRe = /^u ([DAU]{2}) (N\\.\\.\\.|S[C.][M.][U.]) (\\d+) (\\d+) (\\d+) (\\d+) ([a-f0-9]+) ([a-f0-9]+) ([a-f0-9]+) ([\\s\\S]*?)$/\n\nfunction parseUnmergedEntry(field: string): IStatusEntry {\n  const match = unmergedEntryRe.exec(field)\n\n  if (!match) {\n    throw new Error(`Failed to parse status line for unmerged entry: ${field}`)\n  }\n\n  return {\n    kind: 'entry',\n    statusCode: match[1],\n    path: match[10],\n  }\n}\n\nfunction parseUntrackedEntry(field: string): IStatusEntry {\n  const path = field.substr(2)\n  return {\n    kind: 'entry',\n    // NOTE: We return ?? instead of ? here to play nice with mapStatus,\n    // might want to consider changing this (and mapStatus) in the future.\n    statusCode: '??',\n    path,\n  }\n}\n\n/**\n * Map the raw status text from Git to a structure we can work with in the app.\n */\nexport function mapStatus(status: string): FileEntry {\n  if (status === '??') {\n    return {\n      kind: 'untracked',\n    }\n  }\n\n  if (status === '.M') {\n    return {\n      kind: 'ordinary',\n      type: 'modified',\n      index: GitStatusEntry.Unchanged,\n      workingTree: GitStatusEntry.Modified,\n    }\n  }\n\n  if (status === 'M.') {\n    return {\n      kind: 'ordinary',\n      type: 'modified',\n      index: GitStatusEntry.Modified,\n      workingTree: GitStatusEntry.Unchanged,\n    }\n  }\n\n  if (status === '.A') {\n    return {\n      kind: 'ordinary',\n      type: 'added',\n      index: GitStatusEntry.Unchanged,\n      workingTree: GitStatusEntry.Added,\n    }\n  }\n\n  if (status === 'A.') {\n    return {\n      kind: 'ordinary',\n      type: 'added',\n      index: GitStatusEntry.Added,\n      workingTree: GitStatusEntry.Unchanged,\n    }\n  }\n\n  if (status === '.D') {\n    return {\n      kind: 'ordinary',\n      type: 'deleted',\n      index: GitStatusEntry.Unchanged,\n      workingTree: GitStatusEntry.Deleted,\n    }\n  }\n\n  if (status === 'D.') {\n    return {\n      kind: 'ordinary',\n      type: 'deleted',\n      index: GitStatusEntry.Deleted,\n      workingTree: GitStatusEntry.Unchanged,\n    }\n  }\n\n  if (status === 'R.') {\n    return {\n      kind: 'renamed',\n      index: GitStatusEntry.Renamed,\n      workingTree: GitStatusEntry.Unchanged,\n    }\n  }\n\n  if (status === '.R') {\n    return {\n      kind: 'renamed',\n      index: GitStatusEntry.Unchanged,\n      workingTree: GitStatusEntry.Renamed,\n    }\n  }\n\n  if (status === 'C.') {\n    return {\n      kind: 'copied',\n      index: GitStatusEntry.Copied,\n      workingTree: GitStatusEntry.Unchanged,\n    }\n  }\n\n  if (status === '.C') {\n    return {\n      kind: 'copied',\n      index: GitStatusEntry.Unchanged,\n      workingTree: GitStatusEntry.Copied,\n    }\n  }\n\n  if (status === 'AD') {\n    return {\n      kind: 'ordinary',\n      type: 'added',\n      index: GitStatusEntry.Added,\n      workingTree: GitStatusEntry.Deleted,\n    }\n  }\n\n  if (status === 'AM') {\n    return {\n      kind: 'ordinary',\n      type: 'added',\n      index: GitStatusEntry.Added,\n      workingTree: GitStatusEntry.Modified,\n    }\n  }\n\n  if (status === 'RM') {\n    return {\n      kind: 'renamed',\n      index: GitStatusEntry.Renamed,\n      workingTree: GitStatusEntry.Modified,\n    }\n  }\n\n  if (status === 'RD') {\n    return {\n      kind: 'renamed',\n      index: GitStatusEntry.Renamed,\n      workingTree: GitStatusEntry.Deleted,\n    }\n  }\n\n  if (status === 'DD') {\n    return {\n      kind: 'conflicted',\n      us: GitStatusEntry.Deleted,\n      them: GitStatusEntry.Deleted,\n    }\n  }\n\n  if (status === 'AU') {\n    return {\n      kind: 'conflicted',\n      us: GitStatusEntry.Added,\n      them: GitStatusEntry.Modified,\n    }\n  }\n\n  if (status === 'UD') {\n    return {\n      kind: 'conflicted',\n      us: GitStatusEntry.Modified,\n      them: GitStatusEntry.Deleted,\n    }\n  }\n\n  if (status === 'UA') {\n    return {\n      kind: 'conflicted',\n      us: GitStatusEntry.Modified,\n      them: GitStatusEntry.Added,\n    }\n  }\n\n  if (status === 'DU') {\n    return {\n      kind: 'conflicted',\n      us: GitStatusEntry.Deleted,\n      them: GitStatusEntry.Modified,\n    }\n  }\n\n  if (status === 'AA') {\n    return {\n      kind: 'conflicted',\n      us: GitStatusEntry.Added,\n      them: GitStatusEntry.Added,\n    }\n  }\n\n  if (status === 'UU') {\n    return {\n      kind: 'conflicted',\n      us: GitStatusEntry.Modified,\n      them: GitStatusEntry.Modified,\n    }\n  }\n\n  // as a fallback, we assume the file is modified in some way\n  return {\n    kind: 'ordinary',\n    type: 'modified',\n  }\n}\n","/**\n * get all regex captures within a body of text\n * @param text string to search\n * @param re regex to search with. must have global option and one capture\n * @returns ararys of strings captured by supplied regex\n */\nexport async function getCaptures(\n  text: string,\n  re: RegExp\n): Promise<ReadonlyArray<Array<string>>> {\n  const matches = await getMatches(text, re)\n  const captures = matches.reduce(\n    (acc, match) => acc.concat([match.slice(1)]),\n    new Array<Array<string>>()\n  )\n  return captures\n}\n\n/**\n * get all regex matches within a body of text\n * @param text string to search\n * @param re regex to search with. must have global option\n * @returns set of strings captured by supplied regex\n */\nexport async function getMatches(\n  text: string,\n  re: RegExp\n): Promise<Array<RegExpExecArray>> {\n  const matches = new Array<RegExpExecArray>()\n  const getNextMatch = () =>\n    new Promise(resolve => {\n      const match = re.exec(text)\n      if (match !== null) {\n        matches.push(match)\n        resolve(getNextMatch())\n      }\n      resolve(matches)\n    })\n  await getNextMatch()\n  return matches\n}\n","import { spawnAndComplete } from './spawn'\nimport { getCaptures } from '../helpers/regex'\n\n/**\n * returns a list of files with conflict markers present\n * @param repositoryPath filepath to repository\n * @returns filepaths with their number of conflicted markers\n */\nexport async function getFilesWithConflictMarkers(\n  repositoryPath: string\n): Promise<Map<string, number>> {\n  // git operation\n  const args = ['diff', '--check']\n  const { output } = await spawnAndComplete(\n    args,\n    repositoryPath,\n    'getFilesWithConflictMarkers',\n    new Set([0, 2])\n  )\n\n  // result parsing\n  const outputStr = output.toString('utf8')\n  const captures = await getCaptures(outputStr, fileNameCaptureRe)\n  if (captures.length === 0) {\n    return new Map<string, number>()\n  }\n  // flatten the list (only does one level deep)\n  const flatCaptures = captures.reduce((acc, val) => acc.concat(val))\n  // count number of occurences\n  const counted = flatCaptures.reduce(\n    (acc, val) => acc.set(val, (acc.get(val) || 0) + 1),\n    new Map<string, number>()\n  )\n  return counted\n}\n\n/**\n * matches a line reporting a leftover conflict marker\n * and captures the name of the file\n */\nconst fileNameCaptureRe = /(.+):\\d+: leftover conflict marker/gi\n","import { spawnAndComplete } from './spawn'\nimport { getFilesWithConflictMarkers } from './diff-check'\nimport {\n  WorkingDirectoryStatus,\n  WorkingDirectoryFileChange,\n  AppFileStatus,\n  FileEntry,\n  GitStatusEntry,\n} from '../../models/status'\nimport {\n  parsePorcelainStatus,\n  mapStatus,\n  IStatusEntry,\n  IStatusHeader,\n  isStatusHeader,\n  isStatusEntry,\n} from '../status-parser'\nimport { DiffSelectionType, DiffSelection } from '../../models/diff'\nimport { Repository } from '../../models/repository'\nimport { IAheadBehind } from '../../models/branch'\nimport { fatalError } from '../../lib/fatal-error'\nimport { enableStatusWithoutOptionalLocks } from '../feature-flag'\n\n/**\n * V8 has a limit on the size of string it can create (~256MB), and unless we want to\n * trigger an unhandled exception we need to do the encoding conversion by hand.\n *\n * As we may be executing status often, we should keep this to a reasonable threshold.\n */\nconst MaxStatusBufferSize = 20e6 // 20MB in decimal\n\n/** The encapsulation of the result from 'git status' */\nexport interface IStatusResult {\n  /** The name of the current branch */\n  readonly currentBranch?: string\n\n  /** The name of the current upstream branch */\n  readonly currentUpstreamBranch?: string\n\n  /** The SHA of the tip commit of the current branch */\n  readonly currentTip?: string\n\n  /** How many commits ahead and behind\n   *  the `currentBranch` is compared to the `currentUpstreamBranch`\n   */\n  readonly branchAheadBehind?: IAheadBehind\n\n  /** true if the repository exists at the given location */\n  readonly exists: boolean\n\n  /** the absolute path to the repository's working directory */\n  readonly workingDirectory: WorkingDirectoryStatus\n}\n\ninterface IStatusHeadersData {\n  currentBranch?: string\n  currentUpstreamBranch?: string\n  currentTip?: string\n  branchAheadBehind?: IAheadBehind\n  match: RegExpMatchArray | null\n}\n\nfunction convertToAppStatus(\n  status: FileEntry,\n  hasConflictMarkers: boolean\n): AppFileStatus {\n  if (status.kind === 'ordinary') {\n    switch (status.type) {\n      case 'added':\n        return AppFileStatus.New\n      case 'modified':\n        return AppFileStatus.Modified\n      case 'deleted':\n        return AppFileStatus.Deleted\n    }\n  } else if (status.kind === 'copied') {\n    return AppFileStatus.Copied\n  } else if (status.kind === 'renamed') {\n    return AppFileStatus.Renamed\n  } else if (status.kind === 'conflicted') {\n    return hasConflictMarkers\n      ? AppFileStatus.Conflicted\n      : AppFileStatus.Resolved\n  } else if (status.kind === 'untracked') {\n    return AppFileStatus.New\n  }\n\n  return fatalError(`Unknown file status ${status}`)\n}\n\n/**\n *  Retrieve the status for a given repository,\n *  and fail gracefully if the location is not a Git repository\n */\nexport async function getStatus(\n  repository: Repository\n): Promise<IStatusResult | null> {\n  const baseArgs = [\n    'status',\n    '--untracked-files=all',\n    '--branch',\n    '--porcelain=2',\n    '-z',\n  ]\n\n  const args = enableStatusWithoutOptionalLocks()\n    ? ['--no-optional-locks', ...baseArgs]\n    : baseArgs\n\n  const result = await spawnAndComplete(\n    args,\n    repository.path,\n    'getStatus',\n    new Set([0, 128])\n  )\n\n  if (result.exitCode === 128) {\n    log.debug(\n      `'git status' returned 128 for '${\n        repository.path\n      }' and is likely missing its .git directory`\n    )\n    return null\n  }\n\n  if (result.output.length > MaxStatusBufferSize) {\n    log.error(\n      `'git status' emitted ${\n        result.output.length\n      } bytes, which is beyond the supported threshold of ${MaxStatusBufferSize} bytes`\n    )\n    return null\n  }\n\n  const stdout = result.output.toString('utf8')\n  const parsed = parsePorcelainStatus(stdout)\n  const headers = parsed.filter(isStatusHeader)\n  const entries = parsed.filter(isStatusEntry)\n\n  // run git diff check if anything is conflicted\n  const filesWithConflictMarkers = entries.some(\n    es => mapStatus(es.statusCode).kind === 'conflicted'\n  )\n    ? await getFilesWithConflictMarkers(repository.path)\n    : new Map<string, number>()\n\n  // Map of files keyed on their paths.\n  const files = entries.reduce(\n    (files, entry) => buildStatusMap(files, entry, filesWithConflictMarkers),\n    new Map<string, WorkingDirectoryFileChange>()\n  )\n\n  const {\n    currentBranch,\n    currentUpstreamBranch,\n    currentTip,\n    branchAheadBehind,\n  } = headers.reduce(parseStatusHeader, {\n    currentBranch: undefined,\n    currentUpstreamBranch: undefined,\n    currentTip: undefined,\n    branchAheadBehind: undefined,\n    match: null,\n  })\n\n  const workingDirectory = WorkingDirectoryStatus.fromFiles([...files.values()])\n\n  return {\n    currentBranch,\n    currentTip,\n    currentUpstreamBranch,\n    branchAheadBehind,\n    exists: true,\n    workingDirectory,\n  }\n}\n\n/**\n *\n * Update map of working directory changes with a file status entry.\n * Reducer(ish).\n *\n * (Map is used here to maintain insertion order.)\n */\nfunction buildStatusMap(\n  files: Map<string, WorkingDirectoryFileChange>,\n  entry: IStatusEntry,\n  filesWithConflictMarkers: Map<string, number>\n): Map<string, WorkingDirectoryFileChange> {\n  const status = mapStatus(entry.statusCode)\n\n  if (status.kind === 'ordinary') {\n    // when a file is added in the index but then removed in the working\n    // directory, the file won't be part of the commit, so we can skip\n    // displaying this entry in the changes list\n    if (\n      status.index === GitStatusEntry.Added &&\n      status.workingTree === GitStatusEntry.Deleted\n    ) {\n      return files\n    }\n  }\n\n  if (status.kind === 'untracked') {\n    // when a delete has been staged, but an untracked file exists with the\n    // same path, we should ensure that we only draw one entry in the\n    // changes list - see if an entry already exists for this path and\n    // remove it if found\n    files.delete(entry.path)\n  }\n\n  // for now we just poke at the existing summary\n  const summary = convertToAppStatus(\n    status,\n    filesWithConflictMarkers.has(entry.path)\n  )\n  const selection = DiffSelection.fromInitialSelection(DiffSelectionType.All)\n\n  files.set(\n    entry.path,\n    new WorkingDirectoryFileChange(\n      entry.path,\n      summary,\n      selection,\n      entry.oldPath,\n      filesWithConflictMarkers.get(entry.path)\n    )\n  )\n  return files\n}\n\n/**\n * Update status header based on the current header entry.\n * Reducer.\n */\nfunction parseStatusHeader(results: IStatusHeadersData, header: IStatusHeader) {\n  let {\n    currentBranch,\n    currentUpstreamBranch,\n    currentTip,\n    branchAheadBehind,\n    match,\n  } = results\n  const value = header.value\n\n  // This intentionally does not match branch.oid initial\n  if ((match = value.match(/^branch\\.oid ([a-f0-9]+)$/))) {\n    currentTip = match[1]\n  } else if ((match = value.match(/^branch.head (.*)/))) {\n    if (match[1] !== '(detached)') {\n      currentBranch = match[1]\n    }\n  } else if ((match = value.match(/^branch.upstream (.*)/))) {\n    currentUpstreamBranch = match[1]\n  } else if ((match = value.match(/^branch.ab \\+(\\d+) -(\\d+)$/))) {\n    const ahead = parseInt(match[1], 10)\n    const behind = parseInt(match[2], 10)\n\n    if (!isNaN(ahead) && !isNaN(behind)) {\n      branchAheadBehind = { ahead, behind }\n    }\n  }\n  return {\n    currentBranch,\n    currentUpstreamBranch,\n    currentTip,\n    branchAheadBehind,\n    match,\n  }\n}\n","import * as Path from 'path'\n\nimport { git } from './core'\nimport { RepositoryDoesNotExistErrorCode } from 'dugite'\n\n/**\n * Get the absolute path to the top level working directory.\n *\n * @param path The path to a presumptive Git repository, either the root\n *             of the repository or any path within that repository.\n *\n * @returns null if the path provided doesn't reside within a Git repository.\n */\nexport async function getTopLevelWorkingDirectory(\n  path: string\n): Promise<string | null> {\n  let result\n\n  try {\n    // Note, we use --show-cdup here instead of --show-toplevel because show-toplevel\n    // dereferences symlinks and we want to resolve a path as closely as possible to\n    // what the user gave us.\n    result = await git(\n      ['rev-parse', '--show-cdup'],\n      path,\n      'getTopLevelWorkingDirectory',\n      {\n        successExitCodes: new Set([0, 128]),\n      }\n    )\n  } catch (err) {\n    if (err.code === RepositoryDoesNotExistErrorCode) {\n      return null\n    }\n\n    throw err\n  }\n\n  // Exit code 128 means it was run in a directory that's not a git\n  // repository.\n  if (result.exitCode === 128) {\n    return null\n  }\n\n  const relativePath = result.stdout.trim()\n\n  // No output means we're already at the root\n  if (!relativePath) {\n    return path\n  }\n\n  return Path.resolve(path, relativePath)\n}\n\n/**\n * Checks if the repository at a path is bare.\n *\n * @param path The path to the repository to check. An error will be thrown if the path does not exist on disk.\n *\n * @returns true if the path contains a bare Git repository. Returns false if it is not bare or is not a Git repository.\n */\nexport async function isBareRepository(path: string): Promise<boolean> {\n  try {\n    const result = await git(\n      ['rev-parse', '--is-bare-repository'],\n      path,\n      'isBareRepository'\n    )\n    return result.stdout.trim() === 'true'\n  } catch (e) {\n    if (e.message.includes('not a git repository')) {\n      return false\n    }\n\n    throw e\n  }\n}\n\n/** Is the path a git repository? */\nexport async function isGitRepository(path: string): Promise<boolean> {\n  return (await getTopLevelWorkingDirectory(path)) !== null\n}\n","import { GitError } from 'dugite'\nimport { git } from './core'\nimport { Repository } from '../../models/repository'\nimport { Branch, BranchType, IAheadBehind } from '../../models/branch'\n\n/**\n * Convert two refs into the Git range syntax representing the set of commits\n * that are reachable from `to` but excluding those that are reachable from\n * `from`.\n *\n * Each parameter can be the commit SHA or a ref name, or specify an empty\n * string to represent HEAD.\n *\n * @param from The start of the range\n * @param to The end of the range\n */\nexport function revRange(from: string, to: string) {\n  return `${from}..${to}`\n}\n\n/**\n * Convert two refs into the Git symmetric difference syntax, which represents\n * the set of commits that are reachable from either `from` or `to` but not\n * from both.\n *\n * Each parameter can be the commit SHA or a ref name, or you can use an empty\n * string to represent HEAD.\n *\n * @param from The start of the range\n * @param to The end of the range\n */\nexport function revSymmetricDifference(from: string, to: string) {\n  return `${from}...${to}`\n}\n\n/** Calculate the number of commits the range is ahead and behind. */\nexport async function getAheadBehind(\n  repository: Repository,\n  range: string\n): Promise<IAheadBehind | null> {\n  // `--left-right` annotates the list of commits in the range with which side\n  // they're coming from. When used with `--count`, it tells us how many\n  // commits we have from the two different sides of the range.\n  const args = ['rev-list', '--left-right', '--count', range, '--']\n  const result = await git(args, repository.path, 'getAheadBehind', {\n    expectedErrors: new Set([GitError.BadRevision]),\n  })\n\n  // This means one of the refs (most likely the upstream branch) no longer\n  // exists. In that case we can't be ahead/behind at all.\n  if (result.gitError === GitError.BadRevision) {\n    return null\n  }\n\n  const stdout = result.stdout\n  const pieces = stdout.split('\\t')\n  if (pieces.length !== 2) {\n    return null\n  }\n\n  const ahead = parseInt(pieces[0], 10)\n  if (isNaN(ahead)) {\n    return null\n  }\n\n  const behind = parseInt(pieces[1], 10)\n  if (isNaN(behind)) {\n    return null\n  }\n\n  return { ahead, behind }\n}\n\n/** Calculate the number of commits `branch` is ahead/behind its upstream. */\nexport async function getBranchAheadBehind(\n  repository: Repository,\n  branch: Branch\n): Promise<IAheadBehind | null> {\n  if (branch.type === BranchType.Remote) {\n    return null\n  }\n\n  const upstream = branch.upstream\n  if (!upstream) {\n    return null\n  }\n\n  // NB: The three dot form means we'll go all the way back to the merge base\n  // of the branch and its upstream. Practically this is important for seeing\n  // \"through\" merges.\n  const range = revSymmetricDifference(branch.name, upstream)\n  return getAheadBehind(repository, range)\n}\n","import { git } from './core'\nimport { GitError } from 'dugite'\n\nimport { Repository } from '../../models/repository'\nimport { IRemote } from '../../models/remote'\n\n/** Get the remote names. */\nexport async function getRemotes(\n  repository: Repository\n): Promise<ReadonlyArray<IRemote>> {\n  // TODO: use expectedErrors here to handle a specific error\n  // see https://github.com/desktop/desktop/pull/5299#discussion_r206603442 for\n  // discussion about what needs to change\n  const result = await git(['remote', '-v'], repository.path, 'getRemotes', {\n    expectedErrors: new Set([GitError.NotAGitRepository]),\n  })\n\n  if (result.gitError === GitError.NotAGitRepository) {\n    return []\n  }\n\n  const output = result.stdout\n  const lines = output.split('\\n')\n  const remotes = lines\n    .filter(x => x.endsWith('(fetch)'))\n    .map(x => x.split(/\\s+/))\n    .map(x => ({ name: x[0], url: x[1] }))\n\n  return remotes\n}\n\n/** Add a new remote with the given URL. */\nexport async function addRemote(\n  repository: Repository,\n  name: string,\n  url: string\n): Promise<IRemote> {\n  await git(['remote', 'add', name, url], repository.path, 'addRemote')\n\n  return { url, name }\n}\n\n/** Removes an existing remote, or silently errors if it doesn't exist */\nexport async function removeRemote(\n  repository: Repository,\n  name: string\n): Promise<void> {\n  const options = {\n    successExitCodes: new Set([0, 128]),\n  }\n\n  await git(\n    ['remote', 'remove', name],\n    repository.path,\n    'removeRemote',\n    options\n  )\n}\n\n/** Changes the URL for the remote that matches the given name  */\nexport async function setRemoteURL(\n  repository: Repository,\n  name: string,\n  url: string\n): Promise<void> {\n  await git(['remote', 'set-url', name, url], repository.path, 'setRemoteURL')\n}\n","import { git } from './core'\nimport { Repository } from '../../models/repository'\n\n/**\n * Format a local branch in the ref syntax, ensuring situations when the branch\n * is ambiguous are handled.\n *\n * Examples:\n *  - master -> refs/heads/master\n *  - heads/Microsoft/master -> refs/heads/Microsoft/master\n *\n * @param branch The local branch name\n */\nexport function formatAsLocalRef(name: string): string {\n  if (name.startsWith('heads/')) {\n    // In some cases, Git will report this name explicitly to distingush from\n    // a remote ref with the same name - this ensures we format it correctly.\n    return `refs/${name}`\n  } else {\n    // By default Git will drop the heads prefix unless absolutely necessary\n    // - include this to ensure the ref is fully qualified.\n    return `refs/heads/${name}`\n  }\n}\n\n/**\n * Read a symbolic ref from the repository.\n *\n * Symbolic refs are used to point to other refs, similar to how symlinks work\n * for files. Because refs can be removed easily from a Git repository,\n * symbolic refs should only be used when absolutely necessary.\n *\n * @param repository The repository to lookup\n * @param ref The symbolic ref to resolve\n *\n * @returns the canonical ref, if found, or `null` if `ref` cannot be found or\n *          is not a symbolic ref\n */\nexport async function getSymbolicRef(\n  repository: Repository,\n  ref: string\n): Promise<string | null> {\n  const result = await git(\n    ['symbolic-ref', '-q', ref],\n    repository.path,\n    'getSymbolicRef',\n    {\n      successExitCodes: new Set([0, 128]),\n    }\n  )\n\n  if (result.exitCode === 128) {\n    // ref was not a symbolic ref or ref does not exist\n    return null\n  }\n\n  return result.stdout.trim()\n}\n","import { git } from './core'\nimport { Repository } from '../../models/repository'\n\n/** Get the `limit` most recently checked out branches. */\nexport async function getRecentBranches(\n  repository: Repository,\n  limit: number\n): Promise<ReadonlyArray<string>> {\n  // \"git reflog show\" is just an alias for \"git log -g --abbrev-commit --pretty=oneline\"\n  // but by using log we can give it a max number which should prevent us from balling out\n  // of control when there's ginormous reflogs around (as in e.g. github/github).\n  const regex = new RegExp(/.*? checkout: moving from .*? to (.*?)$/i)\n  const result = await git(\n    [\n      'log',\n      '-g',\n      '--no-abbrev-commit',\n      '--pretty=oneline',\n      'HEAD',\n      '-n',\n      '2500',\n      '--',\n    ],\n    repository.path,\n    'getRecentBranches',\n    { successExitCodes: new Set([0, 128]) }\n  )\n\n  if (result.exitCode === 128) {\n    // error code 128 is returned if the branch is unborn\n    return []\n  }\n\n  const output = result.stdout\n  const lines = output.split('\\n')\n  const names = new Set<string>()\n  for (const line of lines) {\n    const result = regex.exec(line)\n    if (result && result.length === 2) {\n      const branchName = result[1]\n      names.add(branchName)\n    }\n\n    if (names.size === limit) {\n      break\n    }\n  }\n\n  return [...names]\n}\n","import {\n  git,\n  IGitExecutionOptions,\n  gitNetworkArguments,\n  GitError,\n} from './core'\nimport { Repository } from '../../models/repository'\nimport { PushProgressParser, executionOptionsWithProgress } from '../progress'\nimport { IPushProgress } from '../app-state'\nimport {\n  IGitAccount,\n  envForAuthentication,\n  AuthenticationErrors,\n} from './authentication'\n\n/**\n * Push from the remote to the branch, optionally setting the upstream.\n *\n * @param repository - The repository from which to push\n *\n * @param account - The account to use when authenticating with the remote\n *\n * @param remote - The remote to push the specified branch to\n *\n * @param localBranch - The local branch to push\n *\n * @param remoteBranch - The remote branch to push to\n *\n * @param setUpstream - Whether or not to update the tracking information\n *                      of the specified branch to point to the remote.\n *\n * @param progressCallback - An optional function which will be invoked\n *                           with information about the current progress\n *                           of the push operation. When provided this enables\n *                           the '--progress' command line flag for\n *                           'git push'.\n */\nexport async function push(\n  repository: Repository,\n  account: IGitAccount | null,\n  remote: string,\n  localBranch: string,\n  remoteBranch: string | null,\n  progressCallback?: (progress: IPushProgress) => void\n): Promise<void> {\n  const args = [\n    ...gitNetworkArguments,\n    'push',\n    remote,\n    remoteBranch ? `${localBranch}:${remoteBranch}` : localBranch,\n  ]\n\n  if (!remoteBranch) {\n    args.push('--set-upstream')\n  }\n\n  let opts: IGitExecutionOptions = {\n    env: envForAuthentication(account),\n    expectedErrors: AuthenticationErrors,\n  }\n\n  if (progressCallback) {\n    args.push('--progress')\n    const title = `Pushing to ${remote}`\n    const kind = 'push'\n\n    opts = await executionOptionsWithProgress(\n      { ...opts, trackLFSProgress: true },\n      new PushProgressParser(),\n      progress => {\n        const description =\n          progress.kind === 'progress' ? progress.details.text : progress.text\n        const value = progress.percent\n\n        progressCallback({\n          kind,\n          title,\n          description,\n          value,\n          remote,\n          branch: localBranch,\n        })\n      }\n    )\n\n    // Initial progress\n    progressCallback({\n      kind: 'push',\n      title,\n      value: 0,\n      remote,\n      branch: localBranch,\n    })\n  }\n\n  const result = await git(args, repository.path, 'push', opts)\n\n  if (result.gitErrorDescription) {\n    throw new GitError(result, args)\n  }\n}\n","import {\n  git,\n  GitError,\n  IGitExecutionOptions,\n  gitNetworkArguments,\n} from './core'\nimport { Repository } from '../../models/repository'\nimport { PullProgressParser, executionOptionsWithProgress } from '../progress'\nimport { IPullProgress } from '../app-state'\nimport {\n  IGitAccount,\n  envForAuthentication,\n  AuthenticationErrors,\n} from './authentication'\n\n/**\n * Pull from the specified remote.\n *\n * @param repository - The repository in which the pull should take place\n *\n * @param remote     - The name of the remote that should be pulled from\n *\n * @param progressCallback - An optional function which will be invoked\n *                           with information about the current progress\n *                           of the pull operation. When provided this enables\n *                           the '--progress' command line flag for\n *                           'git pull'.\n */\nexport async function pull(\n  repository: Repository,\n  account: IGitAccount | null,\n  remote: string,\n  progressCallback?: (progress: IPullProgress) => void\n): Promise<void> {\n  let opts: IGitExecutionOptions = {\n    env: envForAuthentication(account),\n    expectedErrors: AuthenticationErrors,\n  }\n\n  if (progressCallback) {\n    const title = `Pulling ${remote}`\n    const kind = 'pull'\n\n    opts = await executionOptionsWithProgress(\n      { ...opts, trackLFSProgress: true },\n      new PullProgressParser(),\n      progress => {\n        // In addition to progress output from the remote end and from\n        // git itself, the stderr output from pull contains information\n        // about ref updates. We don't need to bring those into the progress\n        // stream so we'll just punt on anything we don't know about for now.\n        if (progress.kind === 'context') {\n          if (!progress.text.startsWith('remote: Counting objects')) {\n            return\n          }\n        }\n\n        const description =\n          progress.kind === 'progress' ? progress.details.text : progress.text\n\n        const value = progress.percent\n\n        progressCallback({ kind, title, description, value, remote })\n      }\n    )\n\n    // Initial progress\n    progressCallback({ kind, title, value: 0, remote })\n  }\n\n  const args = progressCallback\n    ? [...gitNetworkArguments, 'pull', '--no-rebase', '--progress', remote]\n    : [...gitNetworkArguments, 'pull', '--no-rebase', remote]\n\n  const result = await git(args, repository.path, 'pull', opts)\n\n  if (result.gitErrorDescription) {\n    throw new GitError(result, args)\n  }\n}\n","import { git } from './core'\nimport { AppFileStatus, CommittedFileChange } from '../../models/status'\nimport { Repository } from '../../models/repository'\nimport { Commit } from '../../models/commit'\nimport { CommitIdentity } from '../../models/commit-identity'\nimport {\n  getTrailerSeparatorCharacters,\n  parseRawUnfoldedTrailers,\n} from './interpret-trailers'\n\n/**\n * Map the raw status text from Git to an app-friendly value\n * shamelessly borrowed from GitHub Desktop (Windows)\n */\nfunction mapStatus(rawStatus: string): AppFileStatus {\n  const status = rawStatus.trim()\n\n  if (status === 'M') {\n    return AppFileStatus.Modified\n  } // modified\n  if (status === 'A') {\n    return AppFileStatus.New\n  } // added\n  if (status === 'D') {\n    return AppFileStatus.Deleted\n  } // deleted\n  if (status === 'R') {\n    return AppFileStatus.Renamed\n  } // renamed\n  if (status === 'C') {\n    return AppFileStatus.Copied\n  } // copied\n\n  // git log -M --name-status will return a RXXX - where XXX is a percentage\n  if (status.match(/R[0-9]+/)) {\n    return AppFileStatus.Renamed\n  }\n\n  // git log -C --name-status will return a CXXX - where XXX is a percentage\n  if (status.match(/C[0-9]+/)) {\n    return AppFileStatus.Copied\n  }\n\n  return AppFileStatus.Modified\n}\n\n/**\n * Get the repository's commits using `revisionRange` and limited to `limit`\n */\nexport async function getCommits(\n  repository: Repository,\n  revisionRange: string,\n  limit: number,\n  additionalArgs: ReadonlyArray<string> = []\n): Promise<ReadonlyArray<Commit>> {\n  const delimiter = '1F'\n  const delimiterString = String.fromCharCode(parseInt(delimiter, 16))\n  const prettyFormat = [\n    '%H', // SHA\n    '%s', // summary\n    '%b', // body\n    // author identity string, matching format of GIT_AUTHOR_IDENT.\n    //   author name <author email> <author date>\n    // author date format dependent on --date arg, should be raw\n    '%an <%ae> %ad',\n    '%cn <%ce> %cd',\n    '%P', // parent SHAs,\n    '%(trailers:unfold,only)',\n  ].join(`%x${delimiter}`)\n\n  const result = await git(\n    [\n      'log',\n      revisionRange,\n      `--date=raw`,\n      `--max-count=${limit}`,\n      `--pretty=${prettyFormat}`,\n      '-z',\n      '--no-show-signature',\n      '--no-color',\n      ...additionalArgs,\n      '--',\n    ],\n    repository.path,\n    'getCommits',\n    { successExitCodes: new Set([0, 128]) }\n  )\n\n  // if the repository has an unborn HEAD, return an empty history of commits\n  if (result.exitCode === 128) {\n    return new Array<Commit>()\n  }\n\n  const out = result.stdout\n  const lines = out.split('\\0')\n  // Remove the trailing empty line\n  lines.splice(-1, 1)\n\n  if (lines.length === 0) {\n    return []\n  }\n\n  const trailerSeparators = await getTrailerSeparatorCharacters(repository)\n\n  const commits = lines.map(line => {\n    const pieces = line.split(delimiterString)\n    const sha = pieces[0]\n    const summary = pieces[1]\n    const body = pieces[2]\n    const authorIdentity = pieces[3]\n    const committerIdentity = pieces[4]\n    const shaList = pieces[5]\n\n    const parentSHAs = shaList.length ? shaList.split(' ') : []\n    const trailers = parseRawUnfoldedTrailers(pieces[6], trailerSeparators)\n\n    const author = CommitIdentity.parseIdentity(authorIdentity)\n\n    if (!author) {\n      throw new Error(`Couldn't parse author identity ${authorIdentity}`)\n    }\n\n    const committer = CommitIdentity.parseIdentity(committerIdentity)\n\n    if (!committer) {\n      throw new Error(`Couldn't parse committer identity ${committerIdentity}`)\n    }\n\n    return new Commit(\n      sha,\n      summary,\n      body,\n      author,\n      committer,\n      parentSHAs,\n      trailers\n    )\n  })\n\n  return commits\n}\n\n/** Get the files that were changed in the given commit. */\nexport async function getChangedFiles(\n  repository: Repository,\n  sha: string\n): Promise<ReadonlyArray<CommittedFileChange>> {\n  // opt-in for rename detection (-M) and copies detection (-C)\n  // this is equivalent to the user configuring 'diff.renames' to 'copies'\n  // NOTE: order here matters - doing -M before -C means copies aren't detected\n  const args = [\n    'log',\n    sha,\n    '-C',\n    '-M',\n    '-m',\n    '-1',\n    '--no-show-signature',\n    '--first-parent',\n    '--name-status',\n    '--format=format:',\n    '-z',\n    '--',\n  ]\n  const result = await git(args, repository.path, 'getChangedFiles')\n\n  const out = result.stdout\n  const lines = out.split('\\0')\n  // Remove the trailing empty line\n  lines.splice(-1, 1)\n\n  const files: CommittedFileChange[] = []\n  for (let i = 0; i < lines.length; i++) {\n    const statusText = lines[i]\n\n    const status = mapStatus(statusText)\n\n    let oldPath: string | undefined = undefined\n\n    if (status === AppFileStatus.Renamed || status === AppFileStatus.Copied) {\n      oldPath = lines[++i]\n    }\n\n    const path = lines[++i]\n\n    files.push(new CommittedFileChange(path, status, sha, oldPath))\n  }\n\n  return files\n}\n\n/** Get the commit for the given ref. */\nexport async function getCommit(\n  repository: Repository,\n  ref: string\n): Promise<Commit | null> {\n  const commits = await getCommits(repository, ref, 1)\n  if (commits.length < 1) {\n    return null\n  }\n\n  return commits[0]\n}\n","import { git } from './core'\n\n/** Init a new git repository in the given path. */\nexport async function initGitRepository(path: string): Promise<void> {\n  await git(['init'], path, 'initGitRepository')\n}\n","import { git, IGitExecutionOptions, gitNetworkArguments } from './core'\nimport { Repository } from '../../models/repository'\nimport { FetchProgressParser, executionOptionsWithProgress } from '../progress'\nimport { IFetchProgress } from '../app-state'\nimport { IGitAccount, envForAuthentication } from './authentication'\n\n/**\n * Fetch from the given remote.\n *\n * @param repository - The repository to fetch into\n *\n * @param account    - The account to use when authenticating with the remote\n *\n * @param remote     - The remote to fetch from\n *\n * @param progressCallback - An optional function which will be invoked\n *                           with information about the current progress\n *                           of the fetch operation. When provided this enables\n *                           the '--progress' command line flag for\n *                           'git fetch'.\n */\nexport async function fetch(\n  repository: Repository,\n  account: IGitAccount | null,\n  remote: string,\n  progressCallback?: (progress: IFetchProgress) => void\n): Promise<void> {\n  let opts: IGitExecutionOptions = {\n    successExitCodes: new Set([0]),\n    env: envForAuthentication(account),\n  }\n\n  if (progressCallback) {\n    const title = `Fetching ${remote}`\n    const kind = 'fetch'\n\n    opts = await executionOptionsWithProgress(\n      { ...opts, trackLFSProgress: true },\n      new FetchProgressParser(),\n      progress => {\n        // In addition to progress output from the remote end and from\n        // git itself, the stderr output from pull contains information\n        // about ref updates. We don't need to bring those into the progress\n        // stream so we'll just punt on anything we don't know about for now.\n        if (progress.kind === 'context') {\n          if (!progress.text.startsWith('remote: Counting objects')) {\n            return\n          }\n        }\n\n        const description =\n          progress.kind === 'progress' ? progress.details.text : progress.text\n        const value = progress.percent\n\n        progressCallback({ kind, title, description, value, remote })\n      }\n    )\n\n    // Initial progress\n    progressCallback({ kind, title, value: 0, remote })\n  }\n\n  const args = progressCallback\n    ? [...gitNetworkArguments, 'fetch', '--progress', '--prune', remote]\n    : [...gitNetworkArguments, 'fetch', '--prune', remote]\n\n  await git(args, repository.path, 'fetch', opts)\n}\n\n/** Fetch a given refspec from the given remote. */\nexport async function fetchRefspec(\n  repository: Repository,\n  account: IGitAccount | null,\n  remote: string,\n  refspec: string\n): Promise<void> {\n  const options = {\n    successExitCodes: new Set([0, 128]),\n    env: envForAuthentication(account),\n  }\n\n  const args = [...gitNetworkArguments, 'fetch', remote, refspec]\n\n  await git(args, repository.path, 'fetchRefspec', options)\n}\n","import { git } from './core'\nimport { Repository } from '../../models/repository'\nimport { DiffSelectionType } from '../../models/diff'\nimport { applyPatchToIndex } from './apply'\nimport { AppFileStatus, WorkingDirectoryFileChange } from '../../models/status'\n\ninterface IUpdateIndexOptions {\n  /**\n   * Whether or not to add a file when it exists in the working directory\n   * but not in the index. Defaults to true (note that this differs from the\n   * default behavior of Git which is to ignore new files).\n   *\n   * @default true\n   */\n  add?: boolean\n\n  /**\n   * Whether or not to remove a file when it exists in the index but not\n   * in the working directory. Defaults to true (note that this differs from\n   * the default behavior of Git which is to ignore removed files).\n   *\n   * @default true\n   */\n  remove?: boolean\n\n  /**\n   * Whether or not to forcefully remove a file from the index even though it\n   * exists in the working directory. This implies remove.\n   *\n   * @default false\n   */\n  forceRemove?: boolean\n\n  /**\n   * Whether or not to replace conflicting entries in the index with that of\n   * the working directory. Imagine the following scenario\n   *\n   * $ touch foo && git update-index --add foo && git commit -m 'foo'\n   * $ rm foo && mkdir foo && echo \"bar\" > foo/bar\n   * $ git update-index --add foo/bar\n   * error: 'foo/bar' appears as both a file and as a directory\n   * error: foo/bar: cannot add to the index - missing --add option?\n   * fatal: Unable to process path foo/bar\n   *\n   * Replace ignores this conflict and overwrites the index with the\n   * newly created directory, causing the original foo file to be deleted\n   * in the index. This behavior matches what `git add` would do in a similar\n   * scenario.\n   *\n   * @default true\n   */\n  replace?: boolean\n}\n\n/**\n * Updates the index with file contents from the working tree.\n *\n * @param paths   A list of paths which are to be updated with file contents and\n *                status from the working directory.\n *\n * @param options See the IUpdateIndexOptions interface for more details.\n */\nasync function updateIndex(\n  repository: Repository,\n  paths: ReadonlyArray<string>,\n  options: IUpdateIndexOptions = {}\n) {\n  if (!paths.length) {\n    return\n  }\n\n  const args = ['update-index']\n\n  if (options.add !== false) {\n    args.push('--add')\n  }\n\n  if (options.remove !== false || options.forceRemove === true) {\n    args.push('--remove')\n  }\n\n  if (options.forceRemove) {\n    args.push('--force-remove')\n  }\n\n  if (options.replace !== false) {\n    args.push('--replace')\n  }\n\n  args.push('-z', '--stdin')\n\n  await git(args, repository.path, 'updateIndex', {\n    stdin: paths.join('\\0'),\n  })\n}\n\n/**\n * Stage all the given files by either staging the entire path or by applying\n * a patch.\n *\n * Note that prior to stageFiles the index has been completely reset,\n * the job of this function is to set up the index in such a way that it\n * reflects what the user has selected in the app.\n */\nexport async function stageFiles(\n  repository: Repository,\n  files: ReadonlyArray<WorkingDirectoryFileChange>\n): Promise<void> {\n  const normal = []\n  const oldRenamed = []\n  const partial = []\n\n  for (const file of files) {\n    if (file.selection.getSelectionType() === DiffSelectionType.All) {\n      normal.push(file.path)\n      if (file.status === AppFileStatus.Renamed && file.oldPath) {\n        oldRenamed.push(file.oldPath)\n      }\n    } else {\n      partial.push(file)\n    }\n  }\n\n  // Staging files happens in three steps.\n  //\n  // In the first step we run through all of the renamed files, or\n  // more specifically the source files (old) that were renamed and\n  // forcefully remove them from the index. We do this in order to handle\n  // the scenario where a file has been renamed and a new file has been\n  // created in its original position. Think of it like this\n  //\n  // $ touch foo && git add foo && git commit -m 'foo'\n  // $ git mv foo bar\n  // $ echo \"I'm a new foo\" > foo\n  //\n  // Now we have a file which is of type Renamed that has its path set\n  // to 'bar' and its oldPath set to 'foo'. But there's a new file called\n  // foo in the repository. So if the user selects the 'foo -> bar' change\n  // but not the new 'foo' file for inclusion in this commit we don't\n  // want to add the new 'foo', we just want to recreate the move in the\n  // index. We do this by forcefully removing the old path from the index\n  // and then later (in step 2) stage the new file.\n  await updateIndex(repository, oldRenamed, { forceRemove: true })\n\n  // In the second step we update the index to match\n  // the working directory in the case of new, modified, deleted,\n  // and copied files as well as the destination paths for renamed\n  // paths.\n  await updateIndex(repository, normal)\n\n  // Finally we run through all files that have partial selections.\n  // We don't care about renamed or not here since applyPatchToIndex\n  // has logic to support that scenario.\n  if (partial.length) {\n    for (const file of partial) {\n      await applyPatchToIndex(repository, file)\n    }\n  }\n}\n","import { git, GitError } from './core'\nimport { stageFiles } from './update-index'\nimport { Repository } from '../../models/repository'\nimport { WorkingDirectoryFileChange } from '../../models/status'\nimport { unstageAll } from './reset'\n\nexport async function createCommit(\n  repository: Repository,\n  message: string,\n  files: ReadonlyArray<WorkingDirectoryFileChange>\n): Promise<boolean> {\n  // Clear the staging area, our diffs reflect the difference between the\n  // working directory and the last commit (if any) so our commits should\n  // do the same thing.\n  await unstageAll(repository)\n\n  await stageFiles(repository, files)\n\n  try {\n    await git(['commit', '-F', '-'], repository.path, 'createCommit', {\n      stdin: message,\n    })\n    return true\n  } catch (e) {\n    // Commit failures could come from a pre-commit hook rejection. So display\n    // a bit more context than we otherwise would.\n    if (e instanceof GitError) {\n      const output = e.result.stderr.trim()\n\n      let standardError = ''\n      if (output.length > 0) {\n        standardError = `, with output: '${output}'`\n      }\n      const exitCode = e.result.exitCode\n      const error = new Error(\n        `Commit failed - exit code ${exitCode} received${standardError}`\n      )\n      error.name = 'commit-failed'\n      throw error\n    } else {\n      throw e\n    }\n  }\n}\n","import { git, IGitExecutionOptions, gitNetworkArguments } from './core'\nimport { ICloneProgress } from '../app-state'\nimport { CloneProgressParser, executionOptionsWithProgress } from '../progress'\nimport { envForAuthentication, IGitAccount } from './authentication'\n\n/** Additional arguments to provide when cloning a repository */\nexport type CloneOptions = {\n  /** The optional identity to provide when cloning. */\n  readonly account: IGitAccount | null\n  /** The branch to checkout after the clone has completed. */\n  readonly branch?: string\n}\n\n/**\n * Clones a repository from a given url into to the specified path.\n *\n * @param url     - The remote repository URL to clone from\n *\n * @param path    - The destination path for the cloned repository. If the\n *                  path does not exist it will be created. Cloning into an\n *                  existing directory is only allowed if the directory is\n *                  empty.\n *\n * @param options  - Options specific to the clone operation, see the\n *                   documentation for CloneOptions for more details.\n *\n * @param progressCallback - An optional function which will be invoked\n *                           with information about the current progress\n *                           of the clone operation. When provided this enables\n *                           the '--progress' command line flag for\n *                           'git clone'.\n *\n */\nexport async function clone(\n  url: string,\n  path: string,\n  options: CloneOptions,\n  progressCallback?: (progress: ICloneProgress) => void\n): Promise<void> {\n  const env = envForAuthentication(options.account)\n\n  const args = [...gitNetworkArguments, 'clone', '--recursive']\n\n  let opts: IGitExecutionOptions = { env }\n\n  if (progressCallback) {\n    args.push('--progress')\n\n    const title = `Cloning into ${path}`\n    const kind = 'clone'\n\n    opts = await executionOptionsWithProgress(\n      { ...opts, trackLFSProgress: true },\n      new CloneProgressParser(),\n      progress => {\n        const description =\n          progress.kind === 'progress' ? progress.details.text : progress.text\n        const value = progress.percent\n\n        progressCallback({ kind, title, description, value })\n      }\n    )\n\n    // Initial progress\n    progressCallback({ kind, title, value: 0 })\n  }\n\n  if (options.branch) {\n    args.push('-b', options.branch)\n  }\n\n  args.push('--', url, path)\n\n  await git(args, __dirname, 'clone', opts)\n}\n","import * as FSE from 'fs-extra'\nimport { getTempFilePath } from '../file-system'\nimport { IGitProgress, IGitProgressInfo, IGitOutput } from './git'\n\n/** Create the Git LFS progress reporting file and return the path. */\nexport async function createLFSProgressFile(): Promise<string> {\n  const path = await getTempFilePath('GitHubDesktop-lfs-progress')\n  await FSE.ensureFile(path)\n  return path\n}\n\n// The regex for parsing LFS progress lines. See\n// https://github.com/git-lfs/git-lfs/blob/dce20b0d18213d720ff2897267e68960d296eb5e/docs/man/git-lfs-config.5.ronn\n// for more info. At a high level:\n//\n// `<direction> <current>/<total files> <downloaded>/<total> <name>`\nconst LFSProgressLineRe = /^(.+?)\\s{1}(\\d+)\\/(\\d+)\\s{1}(\\d+)\\/(\\d+)\\s{1}(.+)$/\n\n/** The progress parser for Git LFS. */\nexport class GitLFSProgressParser {\n  /** Parse the progress line. */\n  public parse(line: string): IGitProgress | IGitOutput {\n    const cannotParseResult: IGitOutput = {\n      kind: 'context',\n      text: 'Downloading Git LFS file',\n      percent: 0,\n    }\n\n    const matches = line.match(LFSProgressLineRe)\n    if (!matches || matches.length !== 7) {\n      return cannotParseResult\n    }\n\n    const direction = matches[1]\n    const current = parseInt(matches[2], 10)\n    const totalFiles = parseInt(matches[3], 10)\n    const downloadedBytes = parseInt(matches[4], 10)\n    const totalBytes = parseInt(matches[5], 10)\n    const name = matches[6]\n\n    if (\n      !direction ||\n      !current ||\n      !totalFiles ||\n      !downloadedBytes ||\n      !totalBytes ||\n      !name\n    ) {\n      return cannotParseResult\n    }\n\n    if (\n      isNaN(current) ||\n      isNaN(totalFiles) ||\n      isNaN(downloadedBytes) ||\n      isNaN(totalBytes)\n    ) {\n      return cannotParseResult\n    }\n\n    const verb = this.directionToHumanFacingVerb(direction)\n    const info: IGitProgressInfo = {\n      title: `${verb} \"${name}\" (${downloadedBytes} of ${totalBytes})`,\n      value: downloadedBytes,\n      total: totalBytes,\n      percent: 0,\n      done: false,\n      text: line,\n    }\n\n    return {\n      kind: 'progress',\n      percent: 0,\n      details: info,\n    }\n  }\n\n  private directionToHumanFacingVerb(direction: string): string {\n    switch (direction) {\n      case 'download':\n        return 'Downloading'\n      case 'upload':\n        return 'Uploading'\n      case 'checkout':\n        return 'Checking out'\n      default:\n        return 'Downloading'\n    }\n  }\n}\n","import { GitProgressParser } from './git'\n\n/**\n * Highly approximate (some would say outright inaccurate) division\n * of the individual progress reporting steps in a pull operation.\n *\n * Note: A pull is essentially the same as a fetch except we might\n * have to check out some files at the end. We assume that these\n * delta updates are fairly quick though.\n */\nconst steps = [\n  { title: 'remote: Compressing objects', weight: 0.1 },\n  { title: 'Receiving objects', weight: 0.7 },\n  { title: 'Resolving deltas', weight: 0.15 },\n  { title: 'Checking out files', weight: 0.15 },\n]\n\n/**\n * A utility class for interpreting the output from `git pull --progress`\n * and turning that into a percentage value estimating the overall progress\n * of the pull.\n */\nexport class PullProgressParser extends GitProgressParser {\n  public constructor() {\n    super(steps)\n  }\n}\n","import { GitProgressParser } from './git'\n\n/**\n * Highly approximate (some would say outright inaccurate) division\n * of the individual progress reporting steps in a fetch operation\n */\nconst steps = [\n  { title: 'remote: Compressing objects', weight: 0.1 },\n  { title: 'Receiving objects', weight: 0.7 },\n  { title: 'Resolving deltas', weight: 0.2 },\n]\n\n/**\n * A utility class for interpreting the output from `git fetch --progress`\n * and turning that into a percentage value estimating the overall progress\n * of the fetch.\n */\nexport class FetchProgressParser extends GitProgressParser {\n  public constructor() {\n    super(steps)\n  }\n}\n","import { GitProgressParser } from './git'\n\n/**\n * Highly approximate (some would say outright inaccurate) division\n * of the individual progress reporting steps in a push operation\n */\nconst steps = [\n  { title: 'Compressing objects', weight: 0.2 },\n  { title: 'Writing objects', weight: 0.7 },\n  { title: 'remote: Resolving deltas', weight: 0.1 },\n]\n\n/**\n * A utility class for interpreting the output from `git push --progress`\n * and turning that into a percentage value estimating the overall progress\n * of the clone.\n */\nexport class PushProgressParser extends GitProgressParser {\n  public constructor() {\n    super(steps)\n  }\n}\n","import { GitProgressParser } from './git'\n\n/**\n * Highly approximate (some would say outright inaccurate) division\n * of the individual progress reporting steps in a clone operation\n */\nconst steps = [\n  { title: 'remote: Compressing objects', weight: 0.1 },\n  { title: 'Receiving objects', weight: 0.6 },\n  { title: 'Resolving deltas', weight: 0.1 },\n  { title: 'Checking out files', weight: 0.2 },\n]\n\n/**\n * A utility class for interpreting the output from `git clone --progress`\n * and turning that into a percentage value estimating the overall progress\n * of the clone.\n */\nexport class CloneProgressParser extends GitProgressParser {\n  public constructor() {\n    super(steps)\n  }\n}\n","import { GitProgressParser } from './git'\n\nconst steps = [{ title: 'Checking out files', weight: 1 }]\n\n/**\n * A class that parses output from `git checkout --progress` and provides\n * structured progress events.\n */\nexport class CheckoutProgressParser extends GitProgressParser {\n  public constructor() {\n    super(steps)\n  }\n}\n","import { git, IGitExecutionOptions, gitNetworkArguments } from './core'\nimport { Repository } from '../../models/repository'\nimport { Branch, BranchType } from '../../models/branch'\nimport {\n  CheckoutProgressParser,\n  executionOptionsWithProgress,\n} from '../progress'\nimport { ICheckoutProgress } from '../app-state'\n\nimport {\n  IGitAccount,\n  envForAuthentication,\n  AuthenticationErrors,\n} from './authentication'\n\nexport type ProgressCallback = (progress: ICheckoutProgress) => void\n\n/**\n * Check out the given branch.\n *\n * @param repository - The repository in which the branch checkout should\n *                     take place\n *\n * @param branch     - The branch name that should be checked out\n *\n * @param progressCallback - An optional function which will be invoked\n *                           with information about the current progress\n *                           of the checkout operation. When provided this\n *                           enables the '--progress' command line flag for\n *                           'git checkout'.\n */\nexport async function checkoutBranch(\n  repository: Repository,\n  account: IGitAccount | null,\n  branch: Branch,\n  progressCallback?: ProgressCallback\n): Promise<void> {\n  let opts: IGitExecutionOptions = {\n    env: envForAuthentication(account),\n    expectedErrors: AuthenticationErrors,\n  }\n\n  if (progressCallback) {\n    const title = `Checking out branch ${branch.name}`\n    const kind = 'checkout'\n    const targetBranch = branch.name\n\n    opts = await executionOptionsWithProgress(\n      { ...opts, trackLFSProgress: true },\n      new CheckoutProgressParser(),\n      progress => {\n        if (progress.kind === 'progress') {\n          const description = progress.details.text\n          const value = progress.percent\n\n          progressCallback({ kind, title, description, value, targetBranch })\n        }\n      }\n    )\n\n    // Initial progress\n    progressCallback({ kind, title, value: 0, targetBranch })\n  }\n\n  const baseArgs =\n    progressCallback != null\n      ? [...gitNetworkArguments, 'checkout', '--progress']\n      : [...gitNetworkArguments, 'checkout']\n\n  const args =\n    branch.type === BranchType.Remote\n      ? baseArgs.concat(branch.name, '-b', branch.nameWithoutRemote, '--')\n      : baseArgs.concat(branch.name, '--')\n\n  await git(args, repository.path, 'checkoutBranch', opts)\n}\n\n/** Check out the paths at HEAD. */\nexport async function checkoutPaths(\n  repository: Repository,\n  paths: ReadonlyArray<string>\n): Promise<void> {\n  await git(\n    ['checkout', 'HEAD', '--', ...paths],\n    repository.path,\n    'checkoutPaths'\n  )\n}\n","/**\n * Remove the remote prefix from the string. If there is no prefix, returns\n * null. E.g.:\n *\n * origin/my-branch       -> my-branch\n * origin/thing/my-branch -> thing/my-branch\n * my-branch              -> null\n */\nexport function removeRemotePrefix(name: string): string | null {\n  const pieces = name.match(/.*?\\/(.*)/)\n  if (!pieces || pieces.length < 2) {\n    return null\n  }\n\n  return pieces[1]\n}\n","import { git, gitNetworkArguments } from './core'\nimport { getBranches } from './for-each-ref'\nimport { Repository } from '../../models/repository'\nimport { Branch, BranchType } from '../../models/branch'\nimport { IGitAccount, envForAuthentication } from './authentication'\n\n/**\n * Create a new branch from the given start point.\n *\n * @param repository - The repository in which to create the new branch\n * @param name       - The name of the new branch\n * @param startPoint - A committish string that the new branch should be based\n *                     on, or undefined if the branch should be created based\n *                     off of the current state of HEAD\n */\nexport async function createBranch(\n  repository: Repository,\n  name: string,\n  startPoint?: string\n): Promise<Branch | null> {\n  const args = startPoint ? ['branch', name, startPoint] : ['branch', name]\n\n  try {\n    await git(args, repository.path, 'createBranch')\n    const branches = await getBranches(repository, `refs/heads/${name}`)\n    if (branches.length > 0) {\n      return branches[0]\n    }\n  } catch (err) {\n    log.error('createBranch failed', err)\n  }\n  return null\n}\n\n/** Rename the given branch to a new name. */\nexport async function renameBranch(\n  repository: Repository,\n  branch: Branch,\n  newName: string\n): Promise<void> {\n  await git(\n    ['branch', '-m', branch.nameWithoutRemote, newName],\n    repository.path,\n    'renameBranch'\n  )\n}\n\n/**\n * Delete the branch. If the branch has a remote branch and `includeRemote` is true, it too will be\n * deleted. Silently deletes local branch if remote one is already deleted.\n */\nexport async function deleteBranch(\n  repository: Repository,\n  branch: Branch,\n  account: IGitAccount | null,\n  includeRemote: boolean\n): Promise<true> {\n  if (branch.type === BranchType.Local) {\n    await git(\n      ['branch', '-D', branch.name],\n      repository.path,\n      'deleteLocalBranch'\n    )\n  }\n\n  const remote = branch.remote\n\n  if (!includeRemote || !remote) {\n    return true\n  }\n\n  const branchExistsOnRemote = await checkIfBranchExistsOnRemote(\n    repository,\n    branch,\n    account,\n    remote\n  )\n\n  if (branchExistsOnRemote) {\n    const args = [\n      ...gitNetworkArguments,\n      'push',\n      remote,\n      `:${branch.nameWithoutRemote}`,\n    ]\n\n    const opts = { env: envForAuthentication(account) }\n\n    // If the user is not authenticated, the push is going to fail\n    // Let this propagate and leave it to the caller to handle\n    await git(args, repository.path, 'deleteRemoteBranch', opts)\n  }\n\n  return true\n}\n\nasync function checkIfBranchExistsOnRemote(\n  repository: Repository,\n  branch: Branch,\n  account: IGitAccount | null,\n  remote: string\n): Promise<boolean> {\n  const args = [\n    ...gitNetworkArguments,\n    'ls-remote',\n    '--heads',\n    remote,\n    branch.nameWithoutRemote,\n  ]\n  const opts = { env: envForAuthentication(account) }\n  const result = await git(\n    args,\n    repository.path,\n    'checkRemoteBranchExistence',\n    opts\n  )\n  return result.stdout.length > 0\n}\n","import { assertNever } from '../lib/fatal-error'\nimport { WorkingDirectoryFileChange, AppFileStatus } from '../models/status'\nimport { DiffLineType, ITextDiff } from '../models/diff'\n\n/**\n * Generates a string matching the format of a GNU unified diff header excluding\n * the (optional) timestamp fields\n *\n * Note that this multi-line string includes a trailing newline.\n *\n * @param from  The relative path to the original version of the file or\n *              null if the file is newly created.\n *\n * @param to    The relative path to the new version of the file or\n *              null if the file is the file is newly created.\n */\nfunction formatPatchHeader(from: string | null, to: string | null): string {\n  // https://en.wikipedia.org/wiki/Diff_utility\n  //\n  // > At the beginning of the patch is the file information, including the full\n  // > path and a time stamp delimited by a tab character.\n  // >\n  // > [...] the original file is preceded by \"---\" and the new file is preceded\n  // > by \"+++\".\n  //\n  // We skip the time stamp to match git\n  const fromPath = from ? `a/${from}` : '/dev/null'\n  const toPath = to ? `b/${to}` : '/dev/null'\n\n  return `--- ${fromPath}\\n+++ ${toPath}\\n`\n}\n\n/**\n * Generates a string matching the format of a GNU unified diff header excluding\n * the (optional) timestamp fields with the appropriate from/to file names based\n * on the file state of the given WorkingDirectoryFileChange\n */\nfunction formatPatchHeaderForFile(file: WorkingDirectoryFileChange) {\n  switch (file.status) {\n    case AppFileStatus.New:\n      return formatPatchHeader(null, file.path)\n\n    case AppFileStatus.Conflicted:\n    case AppFileStatus.Resolved:\n    // One might initially believe that renamed files should diff\n    // against their old path. This is, after all, how git diff\n    // does it right after a rename. But if we're creating a patch\n    // to be applied along with a rename we must target the renamed\n    // file.\n    case AppFileStatus.Renamed:\n    case AppFileStatus.Deleted:\n    case AppFileStatus.Modified:\n    case AppFileStatus.Copied:\n      return formatPatchHeader(file.path, file.path)\n  }\n\n  return assertNever(file.status, `Unknown file status ${file.status}`)\n}\n\n/**\n * Generates a string matching the format of a GNU unified diff hunk header.\n * Note that this single line string includes a single trailing newline.\n *\n * @param oldStartLine The line in the old (or original) file where this diff\n *                     hunk starts.\n *\n * @param oldLineCount The number of lines in the old (or original) file that\n *                     this diff hunk covers.\n *\n * @param newStartLine The line in the new file where this diff hunk starts\n *\n * @param newLineCount The number of lines in the new file that this diff hunk\n *                     covers\n */\nfunction formatHunkHeader(\n  oldStartLine: number,\n  oldLineCount: number,\n  newStartLine: number,\n  newLineCount: number,\n  sectionHeading?: string | null\n) {\n  // > @@ -l,s +l,s @@ optional section heading\n  // >\n  // > The hunk range information contains two hunk ranges. The range for the hunk of the original\n  // > file is preceded by a minus symbol, and the range for the new file is preceded by a plus\n  // > symbol. Each hunk range is of the format l,s where l is the starting line number and s is\n  // > the number of lines the change hunk applies to for each respective file.\n  // >\n  // > In many versions of GNU diff, each range can omit the comma and trailing value s,\n  // > in which case s defaults to 1\n  const lineInfoBefore =\n    oldLineCount === 1 ? `${oldStartLine}` : `${oldStartLine},${oldLineCount}`\n\n  const lineInfoAfter =\n    newLineCount === 1 ? `${newStartLine}` : `${newStartLine},${newLineCount}`\n\n  sectionHeading = sectionHeading ? ` ${sectionHeading}` : ''\n\n  return `@@ -${lineInfoBefore} +${lineInfoAfter} @@${sectionHeading}\\n`\n}\n\n/**\n * Creates a GNU unified diff based on the original diff and a number\n * of selected or unselected lines (from file.selection). The patch is\n * formatted with the intention of being used for applying against an index\n * with git apply.\n *\n * Note that the file must have at least one selected addition or deletion,\n * ie it's not supported to use this method as a general purpose diff\n * formatter.\n *\n * @param file  The file that the resulting patch will be applied to.\n *              This is used to determine the from and to paths for the\n *              patch header as well as retrieving the line selection state\n *\n * @param diff  The source diff\n */\nexport function formatPatch(\n  file: WorkingDirectoryFileChange,\n  diff: ITextDiff\n): string {\n  let patch = ''\n\n  diff.hunks.forEach((hunk, hunkIndex) => {\n    let hunkBuf = ''\n\n    let oldCount = 0\n    let newCount = 0\n\n    let anyAdditionsOrDeletions = false\n\n    hunk.lines.forEach((line, lineIndex) => {\n      const absoluteIndex = hunk.unifiedDiffStart + lineIndex\n\n      // We write our own hunk headers\n      if (line.type === DiffLineType.Hunk) {\n        return\n      }\n\n      // Context lines can always be let through, they will\n      // never appear for new files.\n      if (line.type === DiffLineType.Context) {\n        hunkBuf += `${line.text}\\n`\n        oldCount++\n        newCount++\n      } else if (file.selection.isSelected(absoluteIndex)) {\n        // A line selected for inclusion.\n\n        // Use the line as-is\n        hunkBuf += `${line.text}\\n`\n\n        if (line.type === DiffLineType.Add) {\n          newCount++\n        }\n        if (line.type === DiffLineType.Delete) {\n          oldCount++\n        }\n\n        anyAdditionsOrDeletions = true\n      } else {\n        // Unselected lines in new files needs to be ignored. A new file by\n        // definition only consists of additions and therefore so will the\n        // partial patch. If the user has elected not to commit a particular\n        // addition we need to generate a patch that pretends that the line\n        // never existed.\n        if (file.status === AppFileStatus.New) {\n          return\n        }\n\n        // An unselected added line has no impact on this patch, pretend\n        // it was never added to the old file by dropping it.\n        if (line.type === DiffLineType.Add) {\n          return\n        }\n\n        // An unselected deleted line has never happened as far as this patch\n        // is concerned which means that we should treat it as if it's still\n        // in the old file so we'll convert it to a context line.\n        if (line.type === DiffLineType.Delete) {\n          hunkBuf += ` ${line.text.substr(1)}\\n`\n          oldCount++\n          newCount++\n        } else {\n          // Guarantee that we've covered all the line types\n          assertNever(line.type, `Unsupported line type ${line.type}`)\n        }\n      }\n\n      if (line.noTrailingNewLine) {\n        hunkBuf += '\\\\ No newline at end of file\\n'\n      }\n    })\n\n    // Skip writing this hunk if all there is is context lines.\n    if (!anyAdditionsOrDeletions) {\n      return\n    }\n\n    patch += formatHunkHeader(\n      hunk.header.oldStartLine,\n      oldCount,\n      hunk.header.newStartLine,\n      newCount\n    )\n    patch += hunkBuf\n  })\n\n  // If we get into this state we should never have been called in the first\n  // place. Someone gave us a faulty diff and/or faulty selection state.\n  if (!patch.length) {\n    throw new Error(\n      `Could not generate a patch for file ${file.path}, patch empty`\n    )\n  }\n\n  patch = formatPatchHeaderForFile(file) + patch\n\n  return patch\n}\n","import {\n  IRawDiff,\n  DiffHunk,\n  DiffHunkHeader,\n  DiffLine,\n  DiffLineType,\n} from '../models/diff'\nimport { assertNever } from '../lib/fatal-error'\n\n// https://en.wikipedia.org/wiki/Diff_utility\n//\n// @@ -l,s +l,s @@ optional section heading\n//\n// The hunk range information contains two hunk ranges. The range for the hunk of the original\n// file is preceded by a minus symbol, and the range for the new file is preceded by a plus\n// symbol. Each hunk range is of the format l,s where l is the starting line number and s is\n// the number of lines the change hunk applies to for each respective file.\n//\n// In many versions of GNU diff, each range can omit the comma and trailing value s,\n// in which case s defaults to 1\nconst diffHeaderRe = /^@@ -(\\d+)(?:,(\\d+))? \\+(\\d+)(?:,(\\d+))? @@/\n\nconst DiffPrefixAdd: '+' = '+'\nconst DiffPrefixDelete: '-' = '-'\nconst DiffPrefixContext: ' ' = ' '\nconst DiffPrefixNoNewline: '\\\\' = '\\\\'\n\ntype DiffLinePrefix =\n  | typeof DiffPrefixAdd\n  | typeof DiffPrefixDelete\n  | typeof DiffPrefixContext\n  | typeof DiffPrefixNoNewline\nconst DiffLinePrefixChars: Set<DiffLinePrefix> = new Set([\n  DiffPrefixAdd,\n  DiffPrefixDelete,\n  DiffPrefixContext,\n  DiffPrefixNoNewline,\n])\n\ninterface IDiffHeaderInfo {\n  /**\n   * Whether or not the diff header contained a marker indicating\n   * that a diff couldn't be produced due to the contents of the\n   * new and/or old file was binary.\n   */\n  readonly isBinary: boolean\n}\n\n/**\n * A parser for the GNU unified diff format\n *\n * See https://www.gnu.org/software/diffutils/manual/html_node/Detailed-Unified.html\n */\nexport class DiffParser {\n  /**\n   * Line start pointer.\n   *\n   * The offset into the text property where the current line starts (ie either zero\n   * or one character ahead of the last newline character).\n   */\n  private ls!: number\n\n  /**\n   * Line end pointer.\n   *\n   * The offset into the text property where the current line ends (ie it points to\n   * the newline character) or -1 if the line boundary hasn't been determined yet\n   */\n  private le!: number\n\n  /**\n   * The text buffer containing the raw, unified diff output to be parsed\n   */\n  private text!: string\n\n  public constructor() {\n    this.reset()\n  }\n\n  /**\n   * Resets the internal parser state so that it can be reused.\n   *\n   * This is done automatically at the end of each parse run.\n   */\n  private reset() {\n    this.ls = 0\n    this.le = -1\n    this.text = ''\n  }\n\n  /**\n   * Aligns the internal character pointers at the boundaries of\n   * the next line.\n   *\n   * Returns true if successful or false if the end of the diff\n   * has been reached.\n   */\n  private nextLine(): boolean {\n    this.ls = this.le + 1\n\n    // We've reached the end of the diff\n    if (this.ls >= this.text.length) {\n      return false\n    }\n\n    this.le = this.text.indexOf('\\n', this.ls)\n\n    // If we can't find the next newline character we'll put our\n    // end pointer at the end of the diff string\n    if (this.le === -1) {\n      this.le = this.text.length\n    }\n\n    // We've succeeded if there's anything to read in between the\n    // start and the end\n    return this.ls !== this.le\n  }\n\n  /**\n   * Advances to the next line and returns it as a substring\n   * of the raw diff text. Returns null if end of diff was\n   * reached.\n   */\n  private readLine(): string | null {\n    return this.nextLine() ? this.text.substring(this.ls, this.le) : null\n  }\n\n  /** Tests if the current line starts with the given search text */\n  private lineStartsWith(searchString: string): boolean {\n    return this.text.startsWith(searchString, this.ls)\n  }\n\n  /** Tests if the current line ends with the given search text */\n  private lineEndsWith(searchString: string): boolean {\n    return this.text.endsWith(searchString, this.le)\n  }\n\n  /**\n   * Returns the starting character of the next line without\n   * advancing the internal state. Returns null if advancing\n   * would mean reaching the end of the diff.\n   */\n  private peek(): string | null {\n    const p = this.le + 1\n    return p < this.text.length ? this.text[p] : null\n  }\n\n  /**\n   * Parse the diff header, meaning everything from the\n   * start of the diff output to the end of the line beginning\n   * with +++\n   *\n   * Example diff header:\n   *\n   *   diff --git a/app/src/lib/diff-parser.ts b/app/src/lib/diff-parser.ts\n   *   index e1d4871..3bd3ee0 100644\n   *   --- a/app/src/lib/diff-parser.ts\n   *   +++ b/app/src/lib/diff-parser.ts\n   *\n   * Returns an object with information extracted from the diff\n   * header (currently whether it's a binary patch) or null if\n   * the end of the diff was reached before the +++ line could be\n   * found (which is a valid state).\n   */\n  private parseDiffHeader(): IDiffHeaderInfo | null {\n    // TODO: There's information in here that we might want to\n    // capture, such as mode changes\n    while (this.nextLine()) {\n      if (this.lineStartsWith('Binary files ') && this.lineEndsWith('differ')) {\n        return { isBinary: true }\n      }\n\n      if (this.lineStartsWith('+++')) {\n        return { isBinary: false }\n      }\n    }\n\n    // It's not an error to not find the +++ line, see the\n    // 'parses diff of empty file' test in diff-parser-tests.ts\n    return null\n  }\n\n  /**\n   * Attempts to convert a RegExp capture group into a number.\n   * If the group doesn't exist or wasn't captured the function\n   * will return the value of the defaultValue parameter or throw\n   * an error if no default value was provided. If the captured\n   * string can't be converted to a number an error will be thrown.\n   */\n  private numberFromGroup(\n    m: RegExpMatchArray,\n    group: number,\n    defaultValue: number | null = null\n  ): number {\n    const str = m[group]\n    if (!str) {\n      if (!defaultValue) {\n        throw new Error(\n          `Group ${group} missing from regexp match and no defaultValue was provided`\n        )\n      }\n\n      return defaultValue\n    }\n\n    const num = parseInt(str, 10)\n\n    if (isNaN(num)) {\n      throw new Error(\n        `Could not parse capture group ${group} into number: ${str}`\n      )\n    }\n\n    return num\n  }\n\n  /**\n   * Parses a hunk header or throws an error if the given line isn't\n   * a well-formed hunk header.\n   *\n   * We currently only extract the line number information and\n   * ignore any hunk headings.\n   *\n   * Example hunk header:\n   *\n   * @@ -84,10 +82,8 @@ export function parseRawDiff(lines: ReadonlyArray<string>): Diff {\n   *\n   * Where everything after the last @@ is what's known as the hunk, or section, heading\n   */\n  private parseHunkHeader(line: string): DiffHunkHeader {\n    const m = diffHeaderRe.exec(line)\n    if (!m) {\n      throw new Error(`Invalid hunk header format: '${line}'`)\n    }\n\n    // If endLines are missing default to 1, see diffHeaderRe docs\n    const oldStartLine = this.numberFromGroup(m, 1)\n    const oldLineCount = this.numberFromGroup(m, 2, 1)\n    const newStartLine = this.numberFromGroup(m, 3)\n    const newLineCount = this.numberFromGroup(m, 4, 1)\n\n    return new DiffHunkHeader(\n      oldStartLine,\n      oldLineCount,\n      newStartLine,\n      newLineCount\n    )\n  }\n\n  /**\n   * Convenience function which lets us leverage the type system to\n   * prove exhaustive checks in parseHunk.\n   *\n   * Takes an arbitrary string and checks to see if the first character\n   * of that string is one of the allowed prefix characters for diff\n   * lines (ie lines in between hunk headers).\n   */\n  private parseLinePrefix(c: string | null): DiffLinePrefix | null {\n    // Since we know that DiffLinePrefixChars and the DiffLinePrefix type\n    // include the same characters we can tell the type system that we\n    // now know that c[0] is one of the characters in the DifflinePrefix set\n    if (c && c.length && (DiffLinePrefixChars as Set<string>).has(c[0])) {\n      return c[0] as DiffLinePrefix\n    }\n\n    return null\n  }\n\n  /**\n   * Parses a hunk, including its header or throws an error if the diff doesn't\n   * contain a well-formed diff hunk at the current position.\n   *\n   * Expects that the position has been advanced to the beginning of a presumed\n   * diff hunk header.\n   *\n   * @param linesConsumed The number of unified diff lines consumed up until\n   *                      this point by the diff parser. Used to give the\n   *                      position and length (in lines) of the parsed hunk\n   *                      relative to the overall parsed diff. These numbers\n   *                      have no real meaning in the context of a diff and\n   *                      are only used to aid the app in line-selections.\n   */\n  private parseHunk(linesConsumed: number): DiffHunk {\n    const headerLine = this.readLine()\n    if (!headerLine) {\n      throw new Error('Expected hunk header but reached end of diff')\n    }\n\n    const header = this.parseHunkHeader(headerLine)\n    const lines = new Array<DiffLine>()\n    lines.push(new DiffLine(headerLine, DiffLineType.Hunk, null, null))\n\n    let c: DiffLinePrefix | null\n\n    let rollingDiffBeforeCounter = header.oldStartLine\n    let rollingDiffAfterCounter = header.newStartLine\n\n    while ((c = this.parseLinePrefix(this.peek()))) {\n      const line = this.readLine()\n\n      if (!line) {\n        throw new Error('Expected unified diff line but reached end of diff')\n      }\n\n      // A marker indicating that the last line in the original or the new file\n      // is missing a trailing newline. In other words, the presence of this marker\n      // means that the new and/or original file lacks a trailing newline.\n      //\n      // When we find it we have to look up the previous line and set the\n      // noTrailingNewLine flag\n      if (c === DiffPrefixNoNewline) {\n        // See https://github.com/git/git/blob/21f862b498925194f8f1ebe8203b7a7df756555b/apply.c#L1725-L1732\n        if (line.length < 12) {\n          throw new Error(\n            `Expected no newline at end of file marker but got ${line}`\n          )\n        }\n\n        const previousLineIndex = lines.length - 1\n        const previousLine = lines[previousLineIndex]\n        lines[previousLineIndex] = previousLine.withNoTrailingNewLine(true)\n\n        continue\n      }\n\n      let diffLine: DiffLine\n\n      if (c === DiffPrefixAdd) {\n        diffLine = new DiffLine(\n          line,\n          DiffLineType.Add,\n          null,\n          rollingDiffAfterCounter++\n        )\n      } else if (c === DiffPrefixDelete) {\n        diffLine = new DiffLine(\n          line,\n          DiffLineType.Delete,\n          rollingDiffBeforeCounter++,\n          null\n        )\n      } else if (c === DiffPrefixContext) {\n        diffLine = new DiffLine(\n          line,\n          DiffLineType.Context,\n          rollingDiffBeforeCounter++,\n          rollingDiffAfterCounter++\n        )\n      } else {\n        return assertNever(c, `Unknown DiffLinePrefix: ${c}`)\n      }\n\n      lines.push(diffLine)\n    }\n\n    if (lines.length === 1) {\n      throw new Error('Malformed diff, empty hunk')\n    }\n\n    return new DiffHunk(\n      header,\n      lines,\n      linesConsumed,\n      linesConsumed + lines.length - 1\n    )\n  }\n\n  /**\n   * Parse a well-formed unified diff into hunks and lines.\n   *\n   * @param text A unified diff produced by git diff, git log --patch\n   *             or any other git plumbing command that produces unified\n   *             diffs.\n   */\n  public parse(text: string): IRawDiff {\n    this.text = text\n\n    try {\n      const headerInfo = this.parseDiffHeader()\n\n      const headerEnd = this.le\n      const header = this.text.substring(0, headerEnd)\n\n      // empty diff\n      if (!headerInfo) {\n        return { header, contents: '', hunks: [], isBinary: false }\n      }\n\n      if (headerInfo.isBinary) {\n        return { header, contents: '', hunks: [], isBinary: true }\n      }\n\n      const hunks = new Array<DiffHunk>()\n      let linesConsumed = 0\n\n      do {\n        const hunk = this.parseHunk(linesConsumed)\n        hunks.push(hunk)\n        linesConsumed += hunk.lines.length\n      } while (this.peek())\n\n      const contents = this.text\n        .substring(headerEnd + 1, this.le)\n        // Note that this simply returns a reference to the\n        // substring if no match is found, it does not create\n        // a new string instance.\n        .replace(/\\n\\\\ No newline at end of file/g, '')\n\n      return { header, contents, hunks, isBinary: headerInfo.isBinary }\n    } finally {\n      this.reset()\n    }\n  }\n}\n","module.exports = require(\"timers\");","import * as Fs from 'fs'\nimport { Emitter, Disposable } from 'event-kit'\n\ninterface ICurrentFileTailState {\n  /** The current read position in the file. */\n  readonly position: number\n\n  /** The currently active watcher instance. */\n  readonly watcher: Fs.FSWatcher\n}\n\n/** Tail a file and read changes as they happen. */\nexport class Tailer {\n  public readonly path: string\n\n  private readonly emitter = new Emitter()\n\n  private state: ICurrentFileTailState | null = null\n\n  /** Create a new instance for tailing the given file. */\n  public constructor(path: string) {\n    this.path = path\n  }\n\n  /**\n   * Register a function to be called whenever new data is available to be read.\n   * The function will be given a read stream which has been created to read the\n   * new data.\n   */\n  public onDataAvailable(fn: (stream: Fs.ReadStream) => void): Disposable {\n    return this.emitter.on('data', fn)\n  }\n\n  /**\n   * Register a function to be called whenever an error is reported by the underlying\n   * filesystem watcher.\n   */\n  public onError(fn: (error: Error) => void): Disposable {\n    return this.emitter.on('error', fn)\n  }\n\n  private handleError(error: Error) {\n    this.state = null\n    this.emitter.emit('error', error)\n  }\n\n  /**\n   * Start tailing the file. This can only be called again after calling `stop`.\n   */\n  public start() {\n    if (this.state) {\n      throw new Error(\n        `Cannot start an already started Tailer for \"${this.path}\"!`\n      )\n    }\n\n    try {\n      const watcher = Fs.watch(this.path, this.onWatchEvent)\n      watcher.on('error', error => {\n        this.handleError(error)\n      })\n      this.state = { watcher, position: 0 }\n    } catch (error) {\n      this.handleError(error)\n    }\n  }\n\n  private onWatchEvent = (event: string) => {\n    if (event !== 'change') {\n      return\n    }\n\n    if (!this.state) {\n      return\n    }\n\n    Fs.stat(this.path, (err, stats) => {\n      if (err) {\n        return\n      }\n\n      const state = this.state\n      if (!state) {\n        return\n      }\n\n      if (stats.size <= state.position) {\n        return\n      }\n\n      this.state = { ...state, position: stats.size }\n\n      this.readChunk(stats, state.position)\n    })\n  }\n\n  private readChunk(stats: Fs.Stats, position: number) {\n    const stream = Fs.createReadStream(this.path, {\n      start: position,\n      end: stats.size,\n    })\n\n    this.emitter.emit('data', stream)\n  }\n\n  /** Stop tailing the file. */\n  public stop() {\n    const state = this.state\n    if (state) {\n      state.watcher.close()\n      this.state = null\n    }\n  }\n}\n","'use strict'\n\nconst u = require('universalify').fromCallback\nconst fs = require('graceful-fs')\nconst path = require('path')\nconst mkdir = require('../mkdirs')\nconst pathExists = require('../path-exists').pathExists\n\nfunction outputFile (file, data, encoding, callback) {\n  if (typeof encoding === 'function') {\n    callback = encoding\n    encoding = 'utf8'\n  }\n\n  const dir = path.dirname(file)\n  pathExists(dir, (err, itDoes) => {\n    if (err) return callback(err)\n    if (itDoes) return fs.writeFile(file, data, encoding, callback)\n\n    mkdir.mkdirs(dir, err => {\n      if (err) return callback(err)\n\n      fs.writeFile(file, data, encoding, callback)\n    })\n  })\n}\n\nfunction outputFileSync (file, ...args) {\n  const dir = path.dirname(file)\n  if (fs.existsSync(dir)) {\n    return fs.writeFileSync(file, ...args)\n  }\n  mkdir.mkdirsSync(dir)\n  fs.writeFileSync(file, ...args)\n}\n\nmodule.exports = {\n  outputFile: u(outputFile),\n  outputFileSync\n}\n","'use strict'\n\nconst u = require('universalify').fromCallback\nconst fs = require('graceful-fs')\nconst path = require('path')\nconst copy = require('../copy').copy\nconst remove = require('../remove').remove\nconst mkdirp = require('../mkdirs').mkdirp\nconst pathExists = require('../path-exists').pathExists\n\nfunction move (src, dest, opts, cb) {\n  if (typeof opts === 'function') {\n    cb = opts\n    opts = {}\n  }\n\n  const overwrite = opts.overwrite || opts.clobber || false\n\n  src = path.resolve(src)\n  dest = path.resolve(dest)\n\n  if (src === dest) return fs.access(src, cb)\n\n  fs.stat(src, (err, st) => {\n    if (err) return cb(err)\n\n    if (st.isDirectory() && isSrcSubdir(src, dest)) {\n      return cb(new Error(`Cannot move '${src}' to a subdirectory of itself, '${dest}'.`))\n    }\n    mkdirp(path.dirname(dest), err => {\n      if (err) return cb(err)\n      return doRename(src, dest, overwrite, cb)\n    })\n  })\n}\n\nfunction doRename (src, dest, overwrite, cb) {\n  if (overwrite) {\n    return remove(dest, err => {\n      if (err) return cb(err)\n      return rename(src, dest, overwrite, cb)\n    })\n  }\n  pathExists(dest, (err, destExists) => {\n    if (err) return cb(err)\n    if (destExists) return cb(new Error('dest already exists.'))\n    return rename(src, dest, overwrite, cb)\n  })\n}\n\nfunction rename (src, dest, overwrite, cb) {\n  fs.rename(src, dest, err => {\n    if (!err) return cb()\n    if (err.code !== 'EXDEV') return cb(err)\n    return moveAcrossDevice(src, dest, overwrite, cb)\n  })\n}\n\nfunction moveAcrossDevice (src, dest, overwrite, cb) {\n  const opts = {\n    overwrite,\n    errorOnExist: true\n  }\n\n  copy(src, dest, opts, err => {\n    if (err) return cb(err)\n    return remove(src, cb)\n  })\n}\n\nfunction isSrcSubdir (src, dest) {\n  const srcArray = src.split(path.sep)\n  const destArray = dest.split(path.sep)\n\n  return srcArray.reduce((acc, current, i) => {\n    return acc && destArray[i] === current\n  }, true)\n}\n\nmodule.exports = {\n  move: u(move)\n}\n","'use strict'\n\nconst fs = require('graceful-fs')\nconst path = require('path')\nconst copySync = require('../copy-sync').copySync\nconst removeSync = require('../remove').removeSync\nconst mkdirpSync = require('../mkdirs').mkdirsSync\nconst buffer = require('../util/buffer')\n\nfunction moveSync (src, dest, options) {\n  options = options || {}\n  const overwrite = options.overwrite || options.clobber || false\n\n  src = path.resolve(src)\n  dest = path.resolve(dest)\n\n  if (src === dest) return fs.accessSync(src)\n\n  if (isSrcSubdir(src, dest)) throw new Error(`Cannot move '${src}' into itself '${dest}'.`)\n\n  mkdirpSync(path.dirname(dest))\n  tryRenameSync()\n\n  function tryRenameSync () {\n    if (overwrite) {\n      try {\n        return fs.renameSync(src, dest)\n      } catch (err) {\n        if (err.code === 'ENOTEMPTY' || err.code === 'EEXIST' || err.code === 'EPERM') {\n          removeSync(dest)\n          options.overwrite = false // just overwriteed it, no need to do it again\n          return moveSync(src, dest, options)\n        }\n\n        if (err.code !== 'EXDEV') throw err\n        return moveSyncAcrossDevice(src, dest, overwrite)\n      }\n    } else {\n      try {\n        fs.linkSync(src, dest)\n        return fs.unlinkSync(src)\n      } catch (err) {\n        if (err.code === 'EXDEV' || err.code === 'EISDIR' || err.code === 'EPERM' || err.code === 'ENOTSUP') {\n          return moveSyncAcrossDevice(src, dest, overwrite)\n        }\n        throw err\n      }\n    }\n  }\n}\n\nfunction moveSyncAcrossDevice (src, dest, overwrite) {\n  const stat = fs.statSync(src)\n\n  if (stat.isDirectory()) {\n    return moveDirSyncAcrossDevice(src, dest, overwrite)\n  } else {\n    return moveFileSyncAcrossDevice(src, dest, overwrite)\n  }\n}\n\nfunction moveFileSyncAcrossDevice (src, dest, overwrite) {\n  const BUF_LENGTH = 64 * 1024\n  const _buff = buffer(BUF_LENGTH)\n\n  const flags = overwrite ? 'w' : 'wx'\n\n  const fdr = fs.openSync(src, 'r')\n  const stat = fs.fstatSync(fdr)\n  const fdw = fs.openSync(dest, flags, stat.mode)\n  let pos = 0\n\n  while (pos < stat.size) {\n    const bytesRead = fs.readSync(fdr, _buff, 0, BUF_LENGTH, pos)\n    fs.writeSync(fdw, _buff, 0, bytesRead)\n    pos += bytesRead\n  }\n\n  fs.closeSync(fdr)\n  fs.closeSync(fdw)\n  return fs.unlinkSync(src)\n}\n\nfunction moveDirSyncAcrossDevice (src, dest, overwrite) {\n  const options = {\n    overwrite: false\n  }\n\n  if (overwrite) {\n    removeSync(dest)\n    tryCopySync()\n  } else {\n    tryCopySync()\n  }\n\n  function tryCopySync () {\n    copySync(src, dest, options)\n    return removeSync(src)\n  }\n}\n\n// return true if dest is a subdir of src, otherwise false.\n// extract dest base dir and check if that is the same as src basename\nfunction isSrcSubdir (src, dest) {\n  try {\n    return fs.statSync(src).isDirectory() &&\n           src !== dest &&\n           dest.indexOf(src) > -1 &&\n           dest.split(path.dirname(src) + path.sep)[1].split(path.sep)[0] === path.basename(src)\n  } catch (e) {\n    return false\n  }\n}\n\nmodule.exports = {\n  moveSync\n}\n","'use strict'\n\nconst fs = require('graceful-fs')\nconst path = require('path')\nconst mkdir = require('../mkdirs')\nconst jsonFile = require('./jsonfile')\n\nfunction outputJsonSync (file, data, options) {\n  const dir = path.dirname(file)\n\n  if (!fs.existsSync(dir)) {\n    mkdir.mkdirsSync(dir)\n  }\n\n  jsonFile.writeJsonSync(file, data, options)\n}\n\nmodule.exports = outputJsonSync\n","'use strict'\n\nconst path = require('path')\nconst mkdir = require('../mkdirs')\nconst pathExists = require('../path-exists').pathExists\nconst jsonFile = require('./jsonfile')\n\nfunction outputJson (file, data, options, callback) {\n  if (typeof options === 'function') {\n    callback = options\n    options = {}\n  }\n\n  const dir = path.dirname(file)\n\n  pathExists(dir, (err, itDoes) => {\n    if (err) return callback(err)\n    if (itDoes) return jsonFile.writeJson(file, data, options, callback)\n\n    mkdir.mkdirs(dir, err => {\n      if (err) return callback(err)\n      jsonFile.writeJson(file, data, options, callback)\n    })\n  })\n}\n\nmodule.exports = outputJson\n","var _fs\ntry {\n  _fs = require('graceful-fs')\n} catch (_) {\n  _fs = require('fs')\n}\n\nfunction readFile (file, options, callback) {\n  if (callback == null) {\n    callback = options\n    options = {}\n  }\n\n  if (typeof options === 'string') {\n    options = {encoding: options}\n  }\n\n  options = options || {}\n  var fs = options.fs || _fs\n\n  var shouldThrow = true\n  // DO NOT USE 'passParsingErrors' THE NAME WILL CHANGE!!!, use 'throws' instead\n  if ('passParsingErrors' in options) {\n    shouldThrow = options.passParsingErrors\n  } else if ('throws' in options) {\n    shouldThrow = options.throws\n  }\n\n  fs.readFile(file, options, function (err, data) {\n    if (err) return callback(err)\n\n    data = stripBom(data)\n\n    var obj\n    try {\n      obj = JSON.parse(data, options ? options.reviver : null)\n    } catch (err2) {\n      if (shouldThrow) {\n        err2.message = file + ': ' + err2.message\n        return callback(err2)\n      } else {\n        return callback(null, null)\n      }\n    }\n\n    callback(null, obj)\n  })\n}\n\nfunction readFileSync (file, options) {\n  options = options || {}\n  if (typeof options === 'string') {\n    options = {encoding: options}\n  }\n\n  var fs = options.fs || _fs\n\n  var shouldThrow = true\n  // DO NOT USE 'passParsingErrors' THE NAME WILL CHANGE!!!, use 'throws' instead\n  if ('passParsingErrors' in options) {\n    shouldThrow = options.passParsingErrors\n  } else if ('throws' in options) {\n    shouldThrow = options.throws\n  }\n\n  var content = fs.readFileSync(file, options)\n  content = stripBom(content)\n\n  try {\n    return JSON.parse(content, options.reviver)\n  } catch (err) {\n    if (shouldThrow) {\n      err.message = file + ': ' + err.message\n      throw err\n    } else {\n      return null\n    }\n  }\n}\n\nfunction writeFile (file, obj, options, callback) {\n  if (callback == null) {\n    callback = options\n    options = {}\n  }\n  options = options || {}\n  var fs = options.fs || _fs\n\n  var spaces = typeof options === 'object' && options !== null\n    ? 'spaces' in options\n    ? options.spaces : this.spaces\n    : this.spaces\n\n  var str = ''\n  try {\n    str = JSON.stringify(obj, options ? options.replacer : null, spaces) + '\\n'\n  } catch (err) {\n    if (callback) return callback(err, null)\n  }\n\n  fs.writeFile(file, str, options, callback)\n}\n\nfunction writeFileSync (file, obj, options) {\n  options = options || {}\n  var fs = options.fs || _fs\n\n  var spaces = typeof options === 'object' && options !== null\n    ? 'spaces' in options\n    ? options.spaces : this.spaces\n    : this.spaces\n\n  var str = JSON.stringify(obj, options.replacer, spaces) + '\\n'\n  // not sure if fs.writeFileSync returns anything, but just in case\n  return fs.writeFileSync(file, str, options)\n}\n\nfunction stripBom (content) {\n  // we do this because JSON.parse would convert it to a utf8 string if encoding wasn't specified\n  if (Buffer.isBuffer(content)) content = content.toString('utf8')\n  content = content.replace(/^\\uFEFF/, '')\n  return content\n}\n\nvar jsonfile = {\n  spaces: null,\n  readFile: readFile,\n  readFileSync: readFileSync,\n  writeFile: writeFile,\n  writeFileSync: writeFileSync\n}\n\nmodule.exports = jsonfile\n","'use strict'\n\nconst u = require('universalify').fromCallback\nconst jsonFile = require('./jsonfile')\n\njsonFile.outputJson = u(require('./output-json'))\njsonFile.outputJsonSync = require('./output-json-sync')\n// aliases\njsonFile.outputJSON = jsonFile.outputJson\njsonFile.outputJSONSync = jsonFile.outputJsonSync\njsonFile.writeJSON = jsonFile.writeJson\njsonFile.writeJSONSync = jsonFile.writeJsonSync\njsonFile.readJSON = jsonFile.readJson\njsonFile.readJSONSync = jsonFile.readJsonSync\n\nmodule.exports = jsonFile\n","'use strict'\n\nconst fs = require('graceful-fs')\n\nfunction symlinkType (srcpath, type, callback) {\n  callback = (typeof type === 'function') ? type : callback\n  type = (typeof type === 'function') ? false : type\n  if (type) return callback(null, type)\n  fs.lstat(srcpath, (err, stats) => {\n    if (err) return callback(null, 'file')\n    type = (stats && stats.isDirectory()) ? 'dir' : 'file'\n    callback(null, type)\n  })\n}\n\nfunction symlinkTypeSync (srcpath, type) {\n  let stats\n\n  if (type) return type\n  try {\n    stats = fs.lstatSync(srcpath)\n  } catch (e) {\n    return 'file'\n  }\n  return (stats && stats.isDirectory()) ? 'dir' : 'file'\n}\n\nmodule.exports = {\n  symlinkType,\n  symlinkTypeSync\n}\n","'use strict'\n\nconst path = require('path')\nconst fs = require('graceful-fs')\nconst pathExists = require('../path-exists').pathExists\n\n/**\n * Function that returns two types of paths, one relative to symlink, and one\n * relative to the current working directory. Checks if path is absolute or\n * relative. If the path is relative, this function checks if the path is\n * relative to symlink or relative to current working directory. This is an\n * initiative to find a smarter `srcpath` to supply when building symlinks.\n * This allows you to determine which path to use out of one of three possible\n * types of source paths. The first is an absolute path. This is detected by\n * `path.isAbsolute()`. When an absolute path is provided, it is checked to\n * see if it exists. If it does it's used, if not an error is returned\n * (callback)/ thrown (sync). The other two options for `srcpath` are a\n * relative url. By default Node's `fs.symlink` works by creating a symlink\n * using `dstpath` and expects the `srcpath` to be relative to the newly\n * created symlink. If you provide a `srcpath` that does not exist on the file\n * system it results in a broken symlink. To minimize this, the function\n * checks to see if the 'relative to symlink' source file exists, and if it\n * does it will use it. If it does not, it checks if there's a file that\n * exists that is relative to the current working directory, if does its used.\n * This preserves the expectations of the original fs.symlink spec and adds\n * the ability to pass in `relative to current working direcotry` paths.\n */\n\nfunction symlinkPaths (srcpath, dstpath, callback) {\n  if (path.isAbsolute(srcpath)) {\n    return fs.lstat(srcpath, (err) => {\n      if (err) {\n        err.message = err.message.replace('lstat', 'ensureSymlink')\n        return callback(err)\n      }\n      return callback(null, {\n        'toCwd': srcpath,\n        'toDst': srcpath\n      })\n    })\n  } else {\n    const dstdir = path.dirname(dstpath)\n    const relativeToDst = path.join(dstdir, srcpath)\n    return pathExists(relativeToDst, (err, exists) => {\n      if (err) return callback(err)\n      if (exists) {\n        return callback(null, {\n          'toCwd': relativeToDst,\n          'toDst': srcpath\n        })\n      } else {\n        return fs.lstat(srcpath, (err) => {\n          if (err) {\n            err.message = err.message.replace('lstat', 'ensureSymlink')\n            return callback(err)\n          }\n          return callback(null, {\n            'toCwd': srcpath,\n            'toDst': path.relative(dstdir, srcpath)\n          })\n        })\n      }\n    })\n  }\n}\n\nfunction symlinkPathsSync (srcpath, dstpath) {\n  let exists\n  if (path.isAbsolute(srcpath)) {\n    exists = fs.existsSync(srcpath)\n    if (!exists) throw new Error('absolute srcpath does not exist')\n    return {\n      'toCwd': srcpath,\n      'toDst': srcpath\n    }\n  } else {\n    const dstdir = path.dirname(dstpath)\n    const relativeToDst = path.join(dstdir, srcpath)\n    exists = fs.existsSync(relativeToDst)\n    if (exists) {\n      return {\n        'toCwd': relativeToDst,\n        'toDst': srcpath\n      }\n    } else {\n      exists = fs.existsSync(srcpath)\n      if (!exists) throw new Error('relative srcpath does not exist')\n      return {\n        'toCwd': srcpath,\n        'toDst': path.relative(dstdir, srcpath)\n      }\n    }\n  }\n}\n\nmodule.exports = {\n  symlinkPaths,\n  symlinkPathsSync\n}\n","'use strict'\n\nconst u = require('universalify').fromCallback\nconst path = require('path')\nconst fs = require('graceful-fs')\nconst _mkdirs = require('../mkdirs')\nconst mkdirs = _mkdirs.mkdirs\nconst mkdirsSync = _mkdirs.mkdirsSync\n\nconst _symlinkPaths = require('./symlink-paths')\nconst symlinkPaths = _symlinkPaths.symlinkPaths\nconst symlinkPathsSync = _symlinkPaths.symlinkPathsSync\n\nconst _symlinkType = require('./symlink-type')\nconst symlinkType = _symlinkType.symlinkType\nconst symlinkTypeSync = _symlinkType.symlinkTypeSync\n\nconst pathExists = require('../path-exists').pathExists\n\nfunction createSymlink (srcpath, dstpath, type, callback) {\n  callback = (typeof type === 'function') ? type : callback\n  type = (typeof type === 'function') ? false : type\n\n  pathExists(dstpath, (err, destinationExists) => {\n    if (err) return callback(err)\n    if (destinationExists) return callback(null)\n    symlinkPaths(srcpath, dstpath, (err, relative) => {\n      if (err) return callback(err)\n      srcpath = relative.toDst\n      symlinkType(relative.toCwd, type, (err, type) => {\n        if (err) return callback(err)\n        const dir = path.dirname(dstpath)\n        pathExists(dir, (err, dirExists) => {\n          if (err) return callback(err)\n          if (dirExists) return fs.symlink(srcpath, dstpath, type, callback)\n          mkdirs(dir, err => {\n            if (err) return callback(err)\n            fs.symlink(srcpath, dstpath, type, callback)\n          })\n        })\n      })\n    })\n  })\n}\n\nfunction createSymlinkSync (srcpath, dstpath, type) {\n  const destinationExists = fs.existsSync(dstpath)\n  if (destinationExists) return undefined\n\n  const relative = symlinkPathsSync(srcpath, dstpath)\n  srcpath = relative.toDst\n  type = symlinkTypeSync(relative.toCwd, type)\n  const dir = path.dirname(dstpath)\n  const exists = fs.existsSync(dir)\n  if (exists) return fs.symlinkSync(srcpath, dstpath, type)\n  mkdirsSync(dir)\n  return fs.symlinkSync(srcpath, dstpath, type)\n}\n\nmodule.exports = {\n  createSymlink: u(createSymlink),\n  createSymlinkSync\n}\n","'use strict'\n\nconst u = require('universalify').fromCallback\nconst path = require('path')\nconst fs = require('graceful-fs')\nconst mkdir = require('../mkdirs')\nconst pathExists = require('../path-exists').pathExists\n\nfunction createLink (srcpath, dstpath, callback) {\n  function makeLink (srcpath, dstpath) {\n    fs.link(srcpath, dstpath, err => {\n      if (err) return callback(err)\n      callback(null)\n    })\n  }\n\n  pathExists(dstpath, (err, destinationExists) => {\n    if (err) return callback(err)\n    if (destinationExists) return callback(null)\n    fs.lstat(srcpath, (err) => {\n      if (err) {\n        err.message = err.message.replace('lstat', 'ensureLink')\n        return callback(err)\n      }\n\n      const dir = path.dirname(dstpath)\n      pathExists(dir, (err, dirExists) => {\n        if (err) return callback(err)\n        if (dirExists) return makeLink(srcpath, dstpath)\n        mkdir.mkdirs(dir, err => {\n          if (err) return callback(err)\n          makeLink(srcpath, dstpath)\n        })\n      })\n    })\n  })\n}\n\nfunction createLinkSync (srcpath, dstpath) {\n  const destinationExists = fs.existsSync(dstpath)\n  if (destinationExists) return undefined\n\n  try {\n    fs.lstatSync(srcpath)\n  } catch (err) {\n    err.message = err.message.replace('lstat', 'ensureLink')\n    throw err\n  }\n\n  const dir = path.dirname(dstpath)\n  const dirExists = fs.existsSync(dir)\n  if (dirExists) return fs.linkSync(srcpath, dstpath)\n  mkdir.mkdirsSync(dir)\n\n  return fs.linkSync(srcpath, dstpath)\n}\n\nmodule.exports = {\n  createLink: u(createLink),\n  createLinkSync\n}\n","'use strict'\n\nconst u = require('universalify').fromCallback\nconst path = require('path')\nconst fs = require('graceful-fs')\nconst mkdir = require('../mkdirs')\nconst pathExists = require('../path-exists').pathExists\n\nfunction createFile (file, callback) {\n  function makeFile () {\n    fs.writeFile(file, '', err => {\n      if (err) return callback(err)\n      callback()\n    })\n  }\n\n  fs.stat(file, (err, stats) => { // eslint-disable-line handle-callback-err\n    if (!err && stats.isFile()) return callback()\n    const dir = path.dirname(file)\n    pathExists(dir, (err, dirExists) => {\n      if (err) return callback(err)\n      if (dirExists) return makeFile()\n      mkdir.mkdirs(dir, err => {\n        if (err) return callback(err)\n        makeFile()\n      })\n    })\n  })\n}\n\nfunction createFileSync (file) {\n  let stats\n  try {\n    stats = fs.statSync(file)\n  } catch (e) {}\n  if (stats && stats.isFile()) return\n\n  const dir = path.dirname(file)\n  if (!fs.existsSync(dir)) {\n    mkdir.mkdirsSync(dir)\n  }\n\n  fs.writeFileSync(file, '')\n}\n\nmodule.exports = {\n  createFile: u(createFile),\n  createFileSync\n}\n","'use strict'\n\nconst file = require('./file')\nconst link = require('./link')\nconst symlink = require('./symlink')\n\nmodule.exports = {\n  // file\n  createFile: file.createFile,\n  createFileSync: file.createFileSync,\n  ensureFile: file.createFile,\n  ensureFileSync: file.createFileSync,\n  // link\n  createLink: link.createLink,\n  createLinkSync: link.createLinkSync,\n  ensureLink: link.createLink,\n  ensureLinkSync: link.createLinkSync,\n  // symlink\n  createSymlink: symlink.createSymlink,\n  createSymlinkSync: symlink.createSymlinkSync,\n  ensureSymlink: symlink.createSymlink,\n  ensureSymlinkSync: symlink.createSymlinkSync\n}\n","'use strict'\n\nconst fs = require('graceful-fs')\nconst path = require('path')\nconst assert = require('assert')\n\nconst isWindows = (process.platform === 'win32')\n\nfunction defaults (options) {\n  const methods = [\n    'unlink',\n    'chmod',\n    'stat',\n    'lstat',\n    'rmdir',\n    'readdir'\n  ]\n  methods.forEach(m => {\n    options[m] = options[m] || fs[m]\n    m = m + 'Sync'\n    options[m] = options[m] || fs[m]\n  })\n\n  options.maxBusyTries = options.maxBusyTries || 3\n}\n\nfunction rimraf (p, options, cb) {\n  let busyTries = 0\n\n  if (typeof options === 'function') {\n    cb = options\n    options = {}\n  }\n\n  assert(p, 'rimraf: missing path')\n  assert.strictEqual(typeof p, 'string', 'rimraf: path should be a string')\n  assert.strictEqual(typeof cb, 'function', 'rimraf: callback function required')\n  assert(options, 'rimraf: invalid options argument provided')\n  assert.strictEqual(typeof options, 'object', 'rimraf: options should be object')\n\n  defaults(options)\n\n  rimraf_(p, options, function CB (er) {\n    if (er) {\n      if ((er.code === 'EBUSY' || er.code === 'ENOTEMPTY' || er.code === 'EPERM') &&\n          busyTries < options.maxBusyTries) {\n        busyTries++\n        const time = busyTries * 100\n        // try again, with the same exact callback as this one.\n        return setTimeout(() => rimraf_(p, options, CB), time)\n      }\n\n      // already gone\n      if (er.code === 'ENOENT') er = null\n    }\n\n    cb(er)\n  })\n}\n\n// Two possible strategies.\n// 1. Assume it's a file.  unlink it, then do the dir stuff on EPERM or EISDIR\n// 2. Assume it's a directory.  readdir, then do the file stuff on ENOTDIR\n//\n// Both result in an extra syscall when you guess wrong.  However, there\n// are likely far more normal files in the world than directories.  This\n// is based on the assumption that a the average number of files per\n// directory is >= 1.\n//\n// If anyone ever complains about this, then I guess the strategy could\n// be made configurable somehow.  But until then, YAGNI.\nfunction rimraf_ (p, options, cb) {\n  assert(p)\n  assert(options)\n  assert(typeof cb === 'function')\n\n  // sunos lets the root user unlink directories, which is... weird.\n  // so we have to lstat here and make sure it's not a dir.\n  options.lstat(p, (er, st) => {\n    if (er && er.code === 'ENOENT') {\n      return cb(null)\n    }\n\n    // Windows can EPERM on stat.  Life is suffering.\n    if (er && er.code === 'EPERM' && isWindows) {\n      return fixWinEPERM(p, options, er, cb)\n    }\n\n    if (st && st.isDirectory()) {\n      return rmdir(p, options, er, cb)\n    }\n\n    options.unlink(p, er => {\n      if (er) {\n        if (er.code === 'ENOENT') {\n          return cb(null)\n        }\n        if (er.code === 'EPERM') {\n          return (isWindows)\n            ? fixWinEPERM(p, options, er, cb)\n            : rmdir(p, options, er, cb)\n        }\n        if (er.code === 'EISDIR') {\n          return rmdir(p, options, er, cb)\n        }\n      }\n      return cb(er)\n    })\n  })\n}\n\nfunction fixWinEPERM (p, options, er, cb) {\n  assert(p)\n  assert(options)\n  assert(typeof cb === 'function')\n  if (er) {\n    assert(er instanceof Error)\n  }\n\n  options.chmod(p, 0o666, er2 => {\n    if (er2) {\n      cb(er2.code === 'ENOENT' ? null : er)\n    } else {\n      options.stat(p, (er3, stats) => {\n        if (er3) {\n          cb(er3.code === 'ENOENT' ? null : er)\n        } else if (stats.isDirectory()) {\n          rmdir(p, options, er, cb)\n        } else {\n          options.unlink(p, cb)\n        }\n      })\n    }\n  })\n}\n\nfunction fixWinEPERMSync (p, options, er) {\n  let stats\n\n  assert(p)\n  assert(options)\n  if (er) {\n    assert(er instanceof Error)\n  }\n\n  try {\n    options.chmodSync(p, 0o666)\n  } catch (er2) {\n    if (er2.code === 'ENOENT') {\n      return\n    } else {\n      throw er\n    }\n  }\n\n  try {\n    stats = options.statSync(p)\n  } catch (er3) {\n    if (er3.code === 'ENOENT') {\n      return\n    } else {\n      throw er\n    }\n  }\n\n  if (stats.isDirectory()) {\n    rmdirSync(p, options, er)\n  } else {\n    options.unlinkSync(p)\n  }\n}\n\nfunction rmdir (p, options, originalEr, cb) {\n  assert(p)\n  assert(options)\n  if (originalEr) {\n    assert(originalEr instanceof Error)\n  }\n  assert(typeof cb === 'function')\n\n  // try to rmdir first, and only readdir on ENOTEMPTY or EEXIST (SunOS)\n  // if we guessed wrong, and it's not a directory, then\n  // raise the original error.\n  options.rmdir(p, er => {\n    if (er && (er.code === 'ENOTEMPTY' || er.code === 'EEXIST' || er.code === 'EPERM')) {\n      rmkids(p, options, cb)\n    } else if (er && er.code === 'ENOTDIR') {\n      cb(originalEr)\n    } else {\n      cb(er)\n    }\n  })\n}\n\nfunction rmkids (p, options, cb) {\n  assert(p)\n  assert(options)\n  assert(typeof cb === 'function')\n\n  options.readdir(p, (er, files) => {\n    if (er) return cb(er)\n\n    let n = files.length\n    let errState\n\n    if (n === 0) return options.rmdir(p, cb)\n\n    files.forEach(f => {\n      rimraf(path.join(p, f), options, er => {\n        if (errState) {\n          return\n        }\n        if (er) return cb(errState = er)\n        if (--n === 0) {\n          options.rmdir(p, cb)\n        }\n      })\n    })\n  })\n}\n\n// this looks simpler, and is strictly *faster*, but will\n// tie up the JavaScript thread and fail on excessively\n// deep directory trees.\nfunction rimrafSync (p, options) {\n  let st\n\n  options = options || {}\n  defaults(options)\n\n  assert(p, 'rimraf: missing path')\n  assert.strictEqual(typeof p, 'string', 'rimraf: path should be a string')\n  assert(options, 'rimraf: missing options')\n  assert.strictEqual(typeof options, 'object', 'rimraf: options should be object')\n\n  try {\n    st = options.lstatSync(p)\n  } catch (er) {\n    if (er.code === 'ENOENT') {\n      return\n    }\n\n    // Windows can EPERM on stat.  Life is suffering.\n    if (er.code === 'EPERM' && isWindows) {\n      fixWinEPERMSync(p, options, er)\n    }\n  }\n\n  try {\n    // sunos lets the root user unlink directories, which is... weird.\n    if (st && st.isDirectory()) {\n      rmdirSync(p, options, null)\n    } else {\n      options.unlinkSync(p)\n    }\n  } catch (er) {\n    if (er.code === 'ENOENT') {\n      return\n    } else if (er.code === 'EPERM') {\n      return isWindows ? fixWinEPERMSync(p, options, er) : rmdirSync(p, options, er)\n    } else if (er.code !== 'EISDIR') {\n      throw er\n    }\n    rmdirSync(p, options, er)\n  }\n}\n\nfunction rmdirSync (p, options, originalEr) {\n  assert(p)\n  assert(options)\n  if (originalEr) {\n    assert(originalEr instanceof Error)\n  }\n\n  try {\n    options.rmdirSync(p)\n  } catch (er) {\n    if (er.code === 'ENOTDIR') {\n      throw originalEr\n    } else if (er.code === 'ENOTEMPTY' || er.code === 'EEXIST' || er.code === 'EPERM') {\n      rmkidsSync(p, options)\n    } else if (er.code !== 'ENOENT') {\n      throw er\n    }\n  }\n}\n\nfunction rmkidsSync (p, options) {\n  assert(p)\n  assert(options)\n  options.readdirSync(p).forEach(f => rimrafSync(path.join(p, f), options))\n\n  // We only end up here once we got ENOTEMPTY at least once, and\n  // at this point, we are guaranteed to have removed all the kids.\n  // So, we know that it won't be ENOENT or ENOTDIR or anything else.\n  // try really hard to delete stuff on windows, because it has a\n  // PROFOUNDLY annoying habit of not closing handles promptly when\n  // files are deleted, resulting in spurious ENOTEMPTY errors.\n  const retries = isWindows ? 100 : 1\n  let i = 0\n  do {\n    let threw = true\n    try {\n      const ret = options.rmdirSync(p, options)\n      threw = false\n      return ret\n    } finally {\n      if (++i < retries && threw) continue // eslint-disable-line\n    }\n  } while (true)\n}\n\nmodule.exports = rimraf\nrimraf.sync = rimrafSync\n","'use strict'\n\nconst u = require('universalify').fromCallback\nconst fs = require('fs')\nconst path = require('path')\nconst mkdir = require('../mkdirs')\nconst remove = require('../remove')\n\nconst emptyDir = u(function emptyDir (dir, callback) {\n  callback = callback || function () {}\n  fs.readdir(dir, (err, items) => {\n    if (err) return mkdir.mkdirs(dir, callback)\n\n    items = items.map(item => path.join(dir, item))\n\n    deleteItem()\n\n    function deleteItem () {\n      const item = items.pop()\n      if (!item) return callback()\n      remove.remove(item, err => {\n        if (err) return callback(err)\n        deleteItem()\n      })\n    }\n  })\n})\n\nfunction emptyDirSync (dir) {\n  let items\n  try {\n    items = fs.readdirSync(dir)\n  } catch (err) {\n    return mkdir.mkdirsSync(dir)\n  }\n\n  items.forEach(item => {\n    item = path.join(dir, item)\n    remove.removeSync(item)\n  })\n}\n\nmodule.exports = {\n  emptyDirSync,\n  emptydirSync: emptyDirSync,\n  emptyDir,\n  emptydir: emptyDir\n}\n","'use strict'\n\nconst fs = require('graceful-fs')\nconst path = require('path')\nconst mkdirp = require('../mkdirs').mkdirs\nconst pathExists = require('../path-exists').pathExists\nconst utimes = require('../util/utimes').utimesMillis\n\nconst notExist = Symbol('notExist')\nconst existsReg = Symbol('existsReg')\n\nfunction copy (src, dest, opts, cb) {\n  if (typeof opts === 'function' && !cb) {\n    cb = opts\n    opts = {}\n  } else if (typeof opts === 'function') {\n    opts = {filter: opts}\n  }\n\n  cb = cb || function () {}\n  opts = opts || {}\n\n  opts.clobber = 'clobber' in opts ? !!opts.clobber : true // default to true for now\n  opts.overwrite = 'overwrite' in opts ? !!opts.overwrite : opts.clobber // overwrite falls back to clobber\n\n  // Warn about using preserveTimestamps on 32-bit node\n  if (opts.preserveTimestamps && process.arch === 'ia32') {\n    console.warn(`fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;\\n\n    see https://github.com/jprichardson/node-fs-extra/issues/269`)\n  }\n\n  checkPaths(src, dest, (err, resolvedDest) => {\n    if (err) return cb(err)\n    if (opts.filter) return handleFilter(checkParentDir, resolvedDest, src, dest, opts, cb)\n    return checkParentDir(resolvedDest, src, dest, opts, cb)\n  })\n}\n\nfunction checkParentDir (resolvedDest, src, dest, opts, cb) {\n  const destParent = path.dirname(dest)\n  pathExists(destParent, (err, dirExists) => {\n    if (err) return cb(err)\n    if (dirExists) return startCopy(resolvedDest, src, dest, opts, cb)\n    mkdirp(destParent, err => {\n      if (err) return cb(err)\n      return startCopy(resolvedDest, src, dest, opts, cb)\n    })\n  })\n}\n\nfunction startCopy (resolvedDest, src, dest, opts, cb) {\n  if (opts.filter) return handleFilter(getStats, resolvedDest, src, dest, opts, cb)\n  return getStats(resolvedDest, src, dest, opts, cb)\n}\n\nfunction handleFilter (onInclude, resolvedDest, src, dest, opts, cb) {\n  Promise.resolve(opts.filter(src, dest)).then(include => {\n    if (include) {\n      if (resolvedDest) return onInclude(resolvedDest, src, dest, opts, cb)\n      return onInclude(src, dest, opts, cb)\n    }\n    return cb()\n  }, error => cb(error))\n}\n\nfunction getStats (resolvedDest, src, dest, opts, cb) {\n  const stat = opts.dereference ? fs.stat : fs.lstat\n  stat(src, (err, st) => {\n    if (err) return cb(err)\n\n    if (st.isDirectory()) return onDir(st, resolvedDest, src, dest, opts, cb)\n    else if (st.isFile() ||\n             st.isCharacterDevice() ||\n             st.isBlockDevice()) return onFile(st, resolvedDest, src, dest, opts, cb)\n    else if (st.isSymbolicLink()) return onLink(resolvedDest, src, dest, opts, cb)\n  })\n}\n\nfunction onFile (srcStat, resolvedDest, src, dest, opts, cb) {\n  if (resolvedDest === notExist) return copyFile(srcStat, src, dest, opts, cb)\n  else if (resolvedDest === existsReg) return mayCopyFile(srcStat, src, dest, opts, cb)\n  return mayCopyFile(srcStat, src, dest, opts, cb)\n}\n\nfunction mayCopyFile (srcStat, src, dest, opts, cb) {\n  if (opts.overwrite) {\n    fs.unlink(dest, err => {\n      if (err) return cb(err)\n      return copyFile(srcStat, src, dest, opts, cb)\n    })\n  } else if (opts.errorOnExist) {\n    return cb(new Error(`'${dest}' already exists`))\n  } else return cb()\n}\n\nfunction copyFile (srcStat, src, dest, opts, cb) {\n  if (typeof fs.copyFile === 'function') {\n    return fs.copyFile(src, dest, err => {\n      if (err) return cb(err)\n      return setDestModeAndTimestamps(srcStat, dest, opts, cb)\n    })\n  }\n  return copyFileFallback(srcStat, src, dest, opts, cb)\n}\n\nfunction copyFileFallback (srcStat, src, dest, opts, cb) {\n  const rs = fs.createReadStream(src)\n  rs.on('error', err => cb(err)).once('open', () => {\n    const ws = fs.createWriteStream(dest, { mode: srcStat.mode })\n    ws.on('error', err => cb(err))\n      .on('open', () => rs.pipe(ws))\n      .once('close', () => setDestModeAndTimestamps(srcStat, dest, opts, cb))\n  })\n}\n\nfunction setDestModeAndTimestamps (srcStat, dest, opts, cb) {\n  fs.chmod(dest, srcStat.mode, err => {\n    if (err) return cb(err)\n    if (opts.preserveTimestamps) {\n      return utimes(dest, srcStat.atime, srcStat.mtime, cb)\n    }\n    return cb()\n  })\n}\n\nfunction onDir (srcStat, resolvedDest, src, dest, opts, cb) {\n  if (resolvedDest === notExist) {\n    if (isSrcSubdir(src, dest)) {\n      return cb(new Error(`Cannot copy '${src}' to a subdirectory of itself, '${dest}'.`))\n    }\n    return mkDirAndCopy(srcStat, src, dest, opts, cb)\n  } else if (resolvedDest === existsReg) {\n    if (isSrcSubdir(src, dest)) {\n      return cb(new Error(`Cannot copy '${src}' to a subdirectory of itself, '${dest}'.`))\n    }\n    return mayCopyDir(src, dest, opts, cb)\n  }\n  return copyDir(src, dest, opts, cb)\n}\n\nfunction mayCopyDir (src, dest, opts, cb) {\n  fs.stat(dest, (err, st) => {\n    if (err) return cb(err)\n    if (!st.isDirectory()) {\n      return cb(new Error(`Cannot overwrite non-directory '${dest}' with directory '${src}'.`))\n    }\n    return copyDir(src, dest, opts, cb)\n  })\n}\n\nfunction mkDirAndCopy (srcStat, src, dest, opts, cb) {\n  fs.mkdir(dest, srcStat.mode, err => {\n    if (err) return cb(err)\n    fs.chmod(dest, srcStat.mode, err => {\n      if (err) return cb(err)\n      return copyDir(src, dest, opts, cb)\n    })\n  })\n}\n\nfunction copyDir (src, dest, opts, cb) {\n  fs.readdir(src, (err, items) => {\n    if (err) return cb(err)\n    return copyDirItems(items, src, dest, opts, cb)\n  })\n}\n\nfunction copyDirItems (items, src, dest, opts, cb) {\n  const item = items.pop()\n  if (!item) return cb()\n  return copyDirItem(items, item, src, dest, opts, cb)\n}\n\nfunction copyDirItem (items, item, src, dest, opts, cb) {\n  const srcItem = path.join(src, item)\n  const destItem = path.join(dest, item)\n  checkPaths(srcItem, destItem, (err, resolvedDest) => {\n    if (err) return cb(err)\n    startCopy(resolvedDest, srcItem, destItem, opts, err => {\n      if (err) return cb(err)\n      return copyDirItems(items, src, dest, opts, cb)\n    })\n  })\n}\n\nfunction onLink (resolvedDest, src, dest, opts, cb) {\n  fs.readlink(src, (err, resolvedSrc) => {\n    if (err) return cb(err)\n\n    if (opts.dereference) {\n      resolvedSrc = path.resolve(process.cwd(), resolvedSrc)\n    }\n\n    if (resolvedDest === notExist || resolvedDest === existsReg) {\n      // if dest already exists, fs throws error anyway,\n      // so no need to guard against it here.\n      return fs.symlink(resolvedSrc, dest, cb)\n    } else {\n      if (opts.dereference) {\n        resolvedDest = path.resolve(process.cwd(), resolvedDest)\n      }\n      if (pathsAreIdentical(resolvedSrc, resolvedDest)) return cb()\n\n      // prevent copy if src is a subdir of dest since unlinking\n      // dest in this case would result in removing src contents\n      // and therefore a broken symlink would be created.\n      fs.stat(dest, (err, st) => {\n        if (err) return cb(err)\n        if (st.isDirectory() && isSrcSubdir(resolvedDest, resolvedSrc)) {\n          return cb(new Error(`Cannot overwrite '${resolvedDest}' with '${resolvedSrc}'.`))\n        }\n        return copyLink(resolvedSrc, dest, cb)\n      })\n    }\n  })\n}\n\nfunction copyLink (resolvedSrc, dest, cb) {\n  fs.unlink(dest, err => {\n    if (err) return cb(err)\n    return fs.symlink(resolvedSrc, dest, cb)\n  })\n}\n\n// return true if dest is a subdir of src, otherwise false.\n// extract dest base dir and check if that is the same as src basename.\nfunction isSrcSubdir (src, dest) {\n  const srcArray = path.resolve(src).split(path.sep)\n  const destArray = path.resolve(dest).split(path.sep)\n\n  return srcArray.reduce((acc, current, i) => {\n    return acc && destArray[i] === current\n  }, true)\n}\n\n// check if dest exists and is a symlink.\nfunction checkDest (dest, cb) {\n  fs.readlink(dest, (err, resolvedPath) => {\n    if (err) {\n      if (err.code === 'ENOENT') return cb(null, notExist)\n\n      // dest exists and is a regular file or directory, Windows may throw UNKNOWN error.\n      if (err.code === 'EINVAL' || err.code === 'UNKNOWN') return cb(null, existsReg)\n\n      return cb(err)\n    }\n    return cb(null, resolvedPath) // dest exists and is a symlink\n  })\n}\n\nfunction pathsAreIdentical (src, dest) {\n  const os = process.platform\n  const resolvedSrc = path.resolve(src)\n  const resolvedDest = path.resolve(dest)\n  // case-insensitive paths\n  if (os === 'darwin' || os === 'win32') {\n    return resolvedSrc.toLowerCase() === resolvedDest.toLowerCase()\n  }\n  return resolvedSrc === resolvedDest\n}\n\nfunction checkPaths (src, dest, cb) {\n  checkDest(dest, (err, resolvedDest) => {\n    if (err) return cb(err)\n    if (resolvedDest === notExist || resolvedDest === existsReg) {\n      if (pathsAreIdentical(src, dest)) return cb(new Error('Source and destination must not be the same.'))\n      return cb(null, resolvedDest)\n    } else {\n      // check resolved dest path if dest is a symlink\n      if (pathsAreIdentical(src, resolvedDest)) return cb(new Error('Source and destination must not be the same.'))\n      return cb(null, resolvedDest)\n    }\n  })\n}\n\nmodule.exports = copy\n","'use strict'\n\nconst fs = require('graceful-fs')\nconst path = require('path')\nconst invalidWin32Path = require('./win32').invalidWin32Path\n\nconst o777 = parseInt('0777', 8)\n\nfunction mkdirsSync (p, opts, made) {\n  if (!opts || typeof opts !== 'object') {\n    opts = { mode: opts }\n  }\n\n  let mode = opts.mode\n  const xfs = opts.fs || fs\n\n  if (process.platform === 'win32' && invalidWin32Path(p)) {\n    const errInval = new Error(p + ' contains invalid WIN32 path characters.')\n    errInval.code = 'EINVAL'\n    throw errInval\n  }\n\n  if (mode === undefined) {\n    mode = o777 & (~process.umask())\n  }\n  if (!made) made = null\n\n  p = path.resolve(p)\n\n  try {\n    xfs.mkdirSync(p, mode)\n    made = made || p\n  } catch (err0) {\n    if (err0.code === 'ENOENT') {\n      if (path.dirname(p) === p) throw err0\n      made = mkdirsSync(path.dirname(p), opts, made)\n      mkdirsSync(p, opts, made)\n    } else {\n      // In the case of any other error, just see if there's a dir there\n      // already. If so, then hooray!  If not, then something is borked.\n      let stat\n      try {\n        stat = xfs.statSync(p)\n      } catch (err1) {\n        throw err0\n      }\n      if (!stat.isDirectory()) throw err0\n    }\n  }\n\n  return made\n}\n\nmodule.exports = mkdirsSync\n","'use strict'\n\nconst fs = require('graceful-fs')\nconst path = require('path')\nconst invalidWin32Path = require('./win32').invalidWin32Path\n\nconst o777 = parseInt('0777', 8)\n\nfunction mkdirs (p, opts, callback, made) {\n  if (typeof opts === 'function') {\n    callback = opts\n    opts = {}\n  } else if (!opts || typeof opts !== 'object') {\n    opts = { mode: opts }\n  }\n\n  if (process.platform === 'win32' && invalidWin32Path(p)) {\n    const errInval = new Error(p + ' contains invalid WIN32 path characters.')\n    errInval.code = 'EINVAL'\n    return callback(errInval)\n  }\n\n  let mode = opts.mode\n  const xfs = opts.fs || fs\n\n  if (mode === undefined) {\n    mode = o777 & (~process.umask())\n  }\n  if (!made) made = null\n\n  callback = callback || function () {}\n  p = path.resolve(p)\n\n  xfs.mkdir(p, mode, er => {\n    if (!er) {\n      made = made || p\n      return callback(null, made)\n    }\n    switch (er.code) {\n      case 'ENOENT':\n        if (path.dirname(p) === p) return callback(er)\n        mkdirs(path.dirname(p), opts, (er, made) => {\n          if (er) callback(er, made)\n          else mkdirs(p, opts, callback, made)\n        })\n        break\n\n      // In the case of any other error, just see if there's a dir\n      // there already.  If so, then hooray!  If not, then something\n      // is borked.\n      default:\n        xfs.stat(p, (er2, stat) => {\n          // if the stat fails, then that's super weird.\n          // let the original error be the failure reason.\n          if (er2 || !stat.isDirectory()) callback(er, made)\n          else callback(null, made)\n        })\n        break\n    }\n  })\n}\n\nmodule.exports = mkdirs\n","'use strict'\n\nconst fs = require('graceful-fs')\nconst path = require('path')\nconst mkdirpSync = require('../mkdirs').mkdirsSync\nconst utimesSync = require('../util/utimes.js').utimesMillisSync\n\nconst notExist = Symbol('notExist')\nconst existsReg = Symbol('existsReg')\n\nfunction copySync (src, dest, opts) {\n  if (typeof opts === 'function') {\n    opts = {filter: opts}\n  }\n\n  opts = opts || {}\n  opts.clobber = 'clobber' in opts ? !!opts.clobber : true // default to true for now\n  opts.overwrite = 'overwrite' in opts ? !!opts.overwrite : opts.clobber // overwrite falls back to clobber\n\n  // Warn about using preserveTimestamps on 32-bit node\n  if (opts.preserveTimestamps && process.arch === 'ia32') {\n    console.warn(`fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;\\n\n    see https://github.com/jprichardson/node-fs-extra/issues/269`)\n  }\n\n  const resolvedDest = checkPaths(src, dest)\n\n  if (opts.filter && !opts.filter(src, dest)) return\n\n  const destParent = path.dirname(dest)\n  if (!fs.existsSync(destParent)) mkdirpSync(destParent)\n  return startCopy(resolvedDest, src, dest, opts)\n}\n\nfunction startCopy (resolvedDest, src, dest, opts) {\n  if (opts.filter && !opts.filter(src, dest)) return\n  return getStats(resolvedDest, src, dest, opts)\n}\n\nfunction getStats (resolvedDest, src, dest, opts) {\n  const statSync = opts.dereference ? fs.statSync : fs.lstatSync\n  const st = statSync(src)\n\n  if (st.isDirectory()) return onDir(st, resolvedDest, src, dest, opts)\n  else if (st.isFile() ||\n           st.isCharacterDevice() ||\n           st.isBlockDevice()) return onFile(st, resolvedDest, src, dest, opts)\n  else if (st.isSymbolicLink()) return onLink(resolvedDest, src, dest, opts)\n}\n\nfunction onFile (srcStat, resolvedDest, src, dest, opts) {\n  if (resolvedDest === notExist) return copyFile(srcStat, src, dest, opts)\n  else if (resolvedDest === existsReg) return mayCopyFile(srcStat, src, dest, opts)\n  return mayCopyFile(srcStat, src, dest, opts)\n}\n\nfunction mayCopyFile (srcStat, src, dest, opts) {\n  if (opts.overwrite) {\n    fs.unlinkSync(dest)\n    return copyFile(srcStat, src, dest, opts)\n  } else if (opts.errorOnExist) {\n    throw new Error(`'${dest}' already exists`)\n  }\n}\n\nfunction copyFile (srcStat, src, dest, opts) {\n  if (typeof fs.copyFileSync === 'function') {\n    fs.copyFileSync(src, dest)\n    fs.chmodSync(dest, srcStat.mode)\n    if (opts.preserveTimestamps) {\n      return utimesSync(dest, srcStat.atime, srcStat.mtime)\n    }\n    return\n  }\n  return copyFileFallback(srcStat, src, dest, opts)\n}\n\nfunction copyFileFallback (srcStat, src, dest, opts) {\n  const BUF_LENGTH = 64 * 1024\n  const _buff = require('../util/buffer')(BUF_LENGTH)\n\n  const fdr = fs.openSync(src, 'r')\n  const fdw = fs.openSync(dest, 'w', srcStat.mode)\n  let pos = 0\n\n  while (pos < srcStat.size) {\n    const bytesRead = fs.readSync(fdr, _buff, 0, BUF_LENGTH, pos)\n    fs.writeSync(fdw, _buff, 0, bytesRead)\n    pos += bytesRead\n  }\n\n  if (opts.preserveTimestamps) fs.futimesSync(fdw, srcStat.atime, srcStat.mtime)\n\n  fs.closeSync(fdr)\n  fs.closeSync(fdw)\n}\n\nfunction onDir (srcStat, resolvedDest, src, dest, opts) {\n  if (resolvedDest === notExist) {\n    if (isSrcSubdir(src, dest)) {\n      throw new Error(`Cannot copy '${src}' to a subdirectory of itself, '${dest}'.`)\n    }\n    return mkDirAndCopy(srcStat, src, dest, opts)\n  } else if (resolvedDest === existsReg) {\n    if (isSrcSubdir(src, dest)) {\n      throw new Error(`Cannot copy '${src}' to a subdirectory of itself, '${dest}'.`)\n    }\n    return mayCopyDir(src, dest, opts)\n  }\n  return copyDir(src, dest, opts)\n}\n\nfunction mayCopyDir (src, dest, opts) {\n  if (!fs.statSync(dest).isDirectory()) {\n    throw new Error(`Cannot overwrite non-directory '${dest}' with directory '${src}'.`)\n  }\n  return copyDir(src, dest, opts)\n}\n\nfunction mkDirAndCopy (srcStat, src, dest, opts) {\n  fs.mkdirSync(dest, srcStat.mode)\n  fs.chmodSync(dest, srcStat.mode)\n  return copyDir(src, dest, opts)\n}\n\nfunction copyDir (src, dest, opts) {\n  fs.readdirSync(src).forEach(item => copyDirItem(item, src, dest, opts))\n}\n\nfunction copyDirItem (item, src, dest, opts) {\n  const srcItem = path.join(src, item)\n  const destItem = path.join(dest, item)\n  const resolvedDest = checkPaths(srcItem, destItem)\n  return startCopy(resolvedDest, srcItem, destItem, opts)\n}\n\nfunction onLink (resolvedDest, src, dest, opts) {\n  let resolvedSrc = fs.readlinkSync(src)\n\n  if (opts.dereference) {\n    resolvedSrc = path.resolve(process.cwd(), resolvedSrc)\n  }\n\n  if (resolvedDest === notExist || resolvedDest === existsReg) {\n    // if dest already exists, fs throws error anyway,\n    // so no need to guard against it here.\n    return fs.symlinkSync(resolvedSrc, dest)\n  } else {\n    if (opts.dereference) {\n      resolvedDest = path.resolve(process.cwd(), resolvedDest)\n    }\n    if (pathsAreIdentical(resolvedSrc, resolvedDest)) return\n\n    // prevent copy if src is a subdir of dest since unlinking\n    // dest in this case would result in removing src contents\n    // and therefore a broken symlink would be created.\n    if (fs.statSync(dest).isDirectory() && isSrcSubdir(resolvedDest, resolvedSrc)) {\n      throw new Error(`Cannot overwrite '${resolvedDest}' with '${resolvedSrc}'.`)\n    }\n    return copyLink(resolvedSrc, dest)\n  }\n}\n\nfunction copyLink (resolvedSrc, dest) {\n  fs.unlinkSync(dest)\n  return fs.symlinkSync(resolvedSrc, dest)\n}\n\n// return true if dest is a subdir of src, otherwise false.\n// extract dest base dir and check if that is the same as src basename.\nfunction isSrcSubdir (src, dest) {\n  const srcArray = path.resolve(src).split(path.sep)\n  const destArray = path.resolve(dest).split(path.sep)\n\n  return srcArray.reduce((acc, current, i) => {\n    return acc && destArray[i] === current\n  }, true)\n}\n\n// check if dest exists and is a symlink.\nfunction checkDest (dest) {\n  let resolvedPath\n  try {\n    resolvedPath = fs.readlinkSync(dest)\n  } catch (err) {\n    if (err.code === 'ENOENT') return notExist\n\n    // dest exists and is a regular file or directory, Windows may throw UNKNOWN error.\n    if (err.code === 'EINVAL' || err.code === 'UNKNOWN') return existsReg\n\n    throw err\n  }\n  return resolvedPath // dest exists and is a symlink\n}\n\nfunction pathsAreIdentical (src, dest) {\n  const os = process.platform\n  const resolvedSrc = path.resolve(src)\n  const resolvedDest = path.resolve(dest)\n  // case-insensitive paths\n  if (os === 'darwin' || os === 'win32') {\n    return resolvedSrc.toLowerCase() === resolvedDest.toLowerCase()\n  }\n  return resolvedSrc === resolvedDest\n}\n\nfunction checkPaths (src, dest) {\n  const resolvedDest = checkDest(dest)\n  if (resolvedDest === notExist || resolvedDest === existsReg) {\n    if (pathsAreIdentical(src, dest)) throw new Error('Source and destination must not be the same.')\n    return resolvedDest\n  } else {\n    // check resolved dest path if dest is a symlink\n    if (pathsAreIdentical(src, resolvedDest)) throw new Error('Source and destination must not be the same.')\n    return resolvedDest\n  }\n}\n\nmodule.exports = copySync\n","var Stream = require('stream').Stream\n\nmodule.exports = legacy\n\nfunction legacy (fs) {\n  return {\n    ReadStream: ReadStream,\n    WriteStream: WriteStream\n  }\n\n  function ReadStream (path, options) {\n    if (!(this instanceof ReadStream)) return new ReadStream(path, options);\n\n    Stream.call(this);\n\n    var self = this;\n\n    this.path = path;\n    this.fd = null;\n    this.readable = true;\n    this.paused = false;\n\n    this.flags = 'r';\n    this.mode = 438; /*=0666*/\n    this.bufferSize = 64 * 1024;\n\n    options = options || {};\n\n    // Mixin options into this\n    var keys = Object.keys(options);\n    for (var index = 0, length = keys.length; index < length; index++) {\n      var key = keys[index];\n      this[key] = options[key];\n    }\n\n    if (this.encoding) this.setEncoding(this.encoding);\n\n    if (this.start !== undefined) {\n      if ('number' !== typeof this.start) {\n        throw TypeError('start must be a Number');\n      }\n      if (this.end === undefined) {\n        this.end = Infinity;\n      } else if ('number' !== typeof this.end) {\n        throw TypeError('end must be a Number');\n      }\n\n      if (this.start > this.end) {\n        throw new Error('start must be <= end');\n      }\n\n      this.pos = this.start;\n    }\n\n    if (this.fd !== null) {\n      process.nextTick(function() {\n        self._read();\n      });\n      return;\n    }\n\n    fs.open(this.path, this.flags, this.mode, function (err, fd) {\n      if (err) {\n        self.emit('error', err);\n        self.readable = false;\n        return;\n      }\n\n      self.fd = fd;\n      self.emit('open', fd);\n      self._read();\n    })\n  }\n\n  function WriteStream (path, options) {\n    if (!(this instanceof WriteStream)) return new WriteStream(path, options);\n\n    Stream.call(this);\n\n    this.path = path;\n    this.fd = null;\n    this.writable = true;\n\n    this.flags = 'w';\n    this.encoding = 'binary';\n    this.mode = 438; /*=0666*/\n    this.bytesWritten = 0;\n\n    options = options || {};\n\n    // Mixin options into this\n    var keys = Object.keys(options);\n    for (var index = 0, length = keys.length; index < length; index++) {\n      var key = keys[index];\n      this[key] = options[key];\n    }\n\n    if (this.start !== undefined) {\n      if ('number' !== typeof this.start) {\n        throw TypeError('start must be a Number');\n      }\n      if (this.start < 0) {\n        throw new Error('start must be >= zero');\n      }\n\n      this.pos = this.start;\n    }\n\n    this.busy = false;\n    this._queue = [];\n\n    if (this.fd === null) {\n      this._open = fs.open;\n      this._queue.push([this._open, this.path, this.flags, this.mode, undefined]);\n      this.flush();\n    }\n  }\n}\n","module.exports = require(\"constants\");","var fs = require('./fs.js')\nvar constants = require('constants')\n\nvar origCwd = process.cwd\nvar cwd = null\n\nvar platform = process.env.GRACEFUL_FS_PLATFORM || process.platform\n\nprocess.cwd = function() {\n  if (!cwd)\n    cwd = origCwd.call(process)\n  return cwd\n}\ntry {\n  process.cwd()\n} catch (er) {}\n\nvar chdir = process.chdir\nprocess.chdir = function(d) {\n  cwd = null\n  chdir.call(process, d)\n}\n\nmodule.exports = patch\n\nfunction patch (fs) {\n  // (re-)implement some things that are known busted or missing.\n\n  // lchmod, broken prior to 0.6.2\n  // back-port the fix here.\n  if (constants.hasOwnProperty('O_SYMLINK') &&\n      process.version.match(/^v0\\.6\\.[0-2]|^v0\\.5\\./)) {\n    patchLchmod(fs)\n  }\n\n  // lutimes implementation, or no-op\n  if (!fs.lutimes) {\n    patchLutimes(fs)\n  }\n\n  // https://github.com/isaacs/node-graceful-fs/issues/4\n  // Chown should not fail on einval or eperm if non-root.\n  // It should not fail on enosys ever, as this just indicates\n  // that a fs doesn't support the intended operation.\n\n  fs.chown = chownFix(fs.chown)\n  fs.fchown = chownFix(fs.fchown)\n  fs.lchown = chownFix(fs.lchown)\n\n  fs.chmod = chmodFix(fs.chmod)\n  fs.fchmod = chmodFix(fs.fchmod)\n  fs.lchmod = chmodFix(fs.lchmod)\n\n  fs.chownSync = chownFixSync(fs.chownSync)\n  fs.fchownSync = chownFixSync(fs.fchownSync)\n  fs.lchownSync = chownFixSync(fs.lchownSync)\n\n  fs.chmodSync = chmodFixSync(fs.chmodSync)\n  fs.fchmodSync = chmodFixSync(fs.fchmodSync)\n  fs.lchmodSync = chmodFixSync(fs.lchmodSync)\n\n  fs.stat = statFix(fs.stat)\n  fs.fstat = statFix(fs.fstat)\n  fs.lstat = statFix(fs.lstat)\n\n  fs.statSync = statFixSync(fs.statSync)\n  fs.fstatSync = statFixSync(fs.fstatSync)\n  fs.lstatSync = statFixSync(fs.lstatSync)\n\n  // if lchmod/lchown do not exist, then make them no-ops\n  if (!fs.lchmod) {\n    fs.lchmod = function (path, mode, cb) {\n      if (cb) process.nextTick(cb)\n    }\n    fs.lchmodSync = function () {}\n  }\n  if (!fs.lchown) {\n    fs.lchown = function (path, uid, gid, cb) {\n      if (cb) process.nextTick(cb)\n    }\n    fs.lchownSync = function () {}\n  }\n\n  // on Windows, A/V software can lock the directory, causing this\n  // to fail with an EACCES or EPERM if the directory contains newly\n  // created files.  Try again on failure, for up to 60 seconds.\n\n  // Set the timeout this long because some Windows Anti-Virus, such as Parity\n  // bit9, may lock files for up to a minute, causing npm package install\n  // failures. Also, take care to yield the scheduler. Windows scheduling gives\n  // CPU to a busy looping process, which can cause the program causing the lock\n  // contention to be starved of CPU by node, so the contention doesn't resolve.\n  if (platform === \"win32\") {\n    fs.rename = (function (fs$rename) { return function (from, to, cb) {\n      var start = Date.now()\n      var backoff = 0;\n      fs$rename(from, to, function CB (er) {\n        if (er\n            && (er.code === \"EACCES\" || er.code === \"EPERM\")\n            && Date.now() - start < 60000) {\n          setTimeout(function() {\n            fs.stat(to, function (stater, st) {\n              if (stater && stater.code === \"ENOENT\")\n                fs$rename(from, to, CB);\n              else\n                cb(er)\n            })\n          }, backoff)\n          if (backoff < 100)\n            backoff += 10;\n          return;\n        }\n        if (cb) cb(er)\n      })\n    }})(fs.rename)\n  }\n\n  // if read() returns EAGAIN, then just try it again.\n  fs.read = (function (fs$read) { return function (fd, buffer, offset, length, position, callback_) {\n    var callback\n    if (callback_ && typeof callback_ === 'function') {\n      var eagCounter = 0\n      callback = function (er, _, __) {\n        if (er && er.code === 'EAGAIN' && eagCounter < 10) {\n          eagCounter ++\n          return fs$read.call(fs, fd, buffer, offset, length, position, callback)\n        }\n        callback_.apply(this, arguments)\n      }\n    }\n    return fs$read.call(fs, fd, buffer, offset, length, position, callback)\n  }})(fs.read)\n\n  fs.readSync = (function (fs$readSync) { return function (fd, buffer, offset, length, position) {\n    var eagCounter = 0\n    while (true) {\n      try {\n        return fs$readSync.call(fs, fd, buffer, offset, length, position)\n      } catch (er) {\n        if (er.code === 'EAGAIN' && eagCounter < 10) {\n          eagCounter ++\n          continue\n        }\n        throw er\n      }\n    }\n  }})(fs.readSync)\n}\n\nfunction patchLchmod (fs) {\n  fs.lchmod = function (path, mode, callback) {\n    fs.open( path\n           , constants.O_WRONLY | constants.O_SYMLINK\n           , mode\n           , function (err, fd) {\n      if (err) {\n        if (callback) callback(err)\n        return\n      }\n      // prefer to return the chmod error, if one occurs,\n      // but still try to close, and report closing errors if they occur.\n      fs.fchmod(fd, mode, function (err) {\n        fs.close(fd, function(err2) {\n          if (callback) callback(err || err2)\n        })\n      })\n    })\n  }\n\n  fs.lchmodSync = function (path, mode) {\n    var fd = fs.openSync(path, constants.O_WRONLY | constants.O_SYMLINK, mode)\n\n    // prefer to return the chmod error, if one occurs,\n    // but still try to close, and report closing errors if they occur.\n    var threw = true\n    var ret\n    try {\n      ret = fs.fchmodSync(fd, mode)\n      threw = false\n    } finally {\n      if (threw) {\n        try {\n          fs.closeSync(fd)\n        } catch (er) {}\n      } else {\n        fs.closeSync(fd)\n      }\n    }\n    return ret\n  }\n}\n\nfunction patchLutimes (fs) {\n  if (constants.hasOwnProperty(\"O_SYMLINK\")) {\n    fs.lutimes = function (path, at, mt, cb) {\n      fs.open(path, constants.O_SYMLINK, function (er, fd) {\n        if (er) {\n          if (cb) cb(er)\n          return\n        }\n        fs.futimes(fd, at, mt, function (er) {\n          fs.close(fd, function (er2) {\n            if (cb) cb(er || er2)\n          })\n        })\n      })\n    }\n\n    fs.lutimesSync = function (path, at, mt) {\n      var fd = fs.openSync(path, constants.O_SYMLINK)\n      var ret\n      var threw = true\n      try {\n        ret = fs.futimesSync(fd, at, mt)\n        threw = false\n      } finally {\n        if (threw) {\n          try {\n            fs.closeSync(fd)\n          } catch (er) {}\n        } else {\n          fs.closeSync(fd)\n        }\n      }\n      return ret\n    }\n\n  } else {\n    fs.lutimes = function (_a, _b, _c, cb) { if (cb) process.nextTick(cb) }\n    fs.lutimesSync = function () {}\n  }\n}\n\nfunction chmodFix (orig) {\n  if (!orig) return orig\n  return function (target, mode, cb) {\n    return orig.call(fs, target, mode, function (er) {\n      if (chownErOk(er)) er = null\n      if (cb) cb.apply(this, arguments)\n    })\n  }\n}\n\nfunction chmodFixSync (orig) {\n  if (!orig) return orig\n  return function (target, mode) {\n    try {\n      return orig.call(fs, target, mode)\n    } catch (er) {\n      if (!chownErOk(er)) throw er\n    }\n  }\n}\n\n\nfunction chownFix (orig) {\n  if (!orig) return orig\n  return function (target, uid, gid, cb) {\n    return orig.call(fs, target, uid, gid, function (er) {\n      if (chownErOk(er)) er = null\n      if (cb) cb.apply(this, arguments)\n    })\n  }\n}\n\nfunction chownFixSync (orig) {\n  if (!orig) return orig\n  return function (target, uid, gid) {\n    try {\n      return orig.call(fs, target, uid, gid)\n    } catch (er) {\n      if (!chownErOk(er)) throw er\n    }\n  }\n}\n\n\nfunction statFix (orig) {\n  if (!orig) return orig\n  // Older versions of Node erroneously returned signed integers for\n  // uid + gid.\n  return function (target, cb) {\n    return orig.call(fs, target, function (er, stats) {\n      if (!stats) return cb.apply(this, arguments)\n      if (stats.uid < 0) stats.uid += 0x100000000\n      if (stats.gid < 0) stats.gid += 0x100000000\n      if (cb) cb.apply(this, arguments)\n    })\n  }\n}\n\nfunction statFixSync (orig) {\n  if (!orig) return orig\n  // Older versions of Node erroneously returned signed integers for\n  // uid + gid.\n  return function (target) {\n    var stats = orig.call(fs, target)\n    if (stats.uid < 0) stats.uid += 0x100000000\n    if (stats.gid < 0) stats.gid += 0x100000000\n    return stats;\n  }\n}\n\n// ENOSYS means that the fs doesn't support the op. Just ignore\n// that, because it doesn't matter.\n//\n// if there's no getuid, or if getuid() is something other\n// than 0, and the error is EINVAL or EPERM, then just ignore\n// it.\n//\n// This specific case is a silent failure in cp, install, tar,\n// and most other unix tools that manage permissions.\n//\n// When running as root, or if other types of errors are\n// encountered, then it's strict.\nfunction chownErOk (er) {\n  if (!er)\n    return true\n\n  if (er.code === \"ENOSYS\")\n    return true\n\n  var nonroot = !process.getuid || process.getuid() !== 0\n  if (nonroot) {\n    if (er.code === \"EINVAL\" || er.code === \"EPERM\")\n      return true\n  }\n\n  return false\n}\n","import { OcticonSymbol } from '../octicons'\nimport { Repository } from '../../models/repository'\nimport { CloningRepository } from '../../models/cloning-repository'\n\n/**\n * Determine the octicon to display for a given repository.\n */\nexport function iconForRepository(repository: Repository | CloningRepository) {\n  if (repository instanceof CloningRepository) {\n    return OcticonSymbol.desktopDownload\n  }\n\n  if (repository.missing) {\n    return OcticonSymbol.alert\n  }\n\n  const gitHubRepo = repository.gitHubRepository\n  if (!gitHubRepo) {\n    return OcticonSymbol.deviceDesktop\n  }\n\n  if (gitHubRepo.private) {\n    return OcticonSymbol.lock\n  }\n  if (gitHubRepo.fork) {\n    return OcticonSymbol.repoForked\n  }\n\n  return OcticonSymbol.repo\n}\n","import * as React from 'react'\nimport { OcticonSymbol } from './octicons.generated'\nimport * as classNames from 'classnames'\n\ninterface IOcticonProps {\n  /**\n   * An instance of an object conforming to the OcticonSymbol\n   * type. Supports custom paths as well as those provided\n   * through the static properties of the OcticonSymbol class.\n   */\n  readonly symbol: OcticonSymbol\n\n  /**\n   * An optional classname that will be appended to the default\n   * class name 'octicon'\n   */\n  readonly className?: string\n\n  /**\n   * An optional string to use as a tooltip for the icon\n   */\n  readonly title?: string\n}\n\n/**\n * A React component for displaying octicon symbols in SVG format.\n *\n * Note that the aspect ratios of the octicons will always be preserved\n * which is why the width and height properties specify the maximum and\n * not the minimum size.\n *\n * Usage: `<Octicon symbol={OcticonSymbol.mark_github} />`\n *\n * @see OcticonProps\n * @extends React.Component<OcticonProps, void>\n */\nexport class Octicon extends React.Component<IOcticonProps, {}> {\n  public static defaultProps: IOcticonProps = {\n    symbol: OcticonSymbol.markGithub,\n  }\n\n  public shouldComponentUpdate(nextProps: IOcticonProps) {\n    if (\n      nextProps.symbol.w !== this.props.symbol.w ||\n      nextProps.symbol.h !== this.props.symbol.h ||\n      nextProps.symbol.d !== this.props.symbol.d ||\n      nextProps.className !== this.props.className\n    ) {\n      return true\n    }\n\n    return false\n  }\n\n  private renderTitle() {\n    const title = this.props.title\n\n    if (!title) {\n      return null\n    }\n\n    return <title>{title}</title>\n  }\n\n  public render() {\n    const symbol = this.props.symbol\n    const viewBox = `0 0 ${symbol.w} ${symbol.h}`\n    const className = classNames('octicon', this.props.className)\n\n    return (\n      <svg\n        aria-hidden=\"true\"\n        className={className}\n        version=\"1.1\"\n        viewBox={viewBox}\n      >\n        <path d={symbol.d}>{this.renderTitle()}</path>\n      </svg>\n    )\n  }\n}\n","import { DiffLine } from './diff-line'\n\n/** each diff is made up of a number of hunks */\nexport class DiffHunk {\n  /**\n   * @param header The details from the diff hunk header about the line start and patch length.\n   * @param lines The contents - context and changes - of the diff section.\n   * @param unifiedDiffStart The diff hunk's start position in the overall file diff.\n   * @param unifiedDiffEnd The diff hunk's end position in the overall file diff.\n   */\n  public constructor(\n    public readonly header: DiffHunkHeader,\n    public readonly lines: ReadonlyArray<DiffLine>,\n    public readonly unifiedDiffStart: number,\n    public readonly unifiedDiffEnd: number\n  ) {}\n}\n\n/** details about the start and end of a diff hunk */\nexport class DiffHunkHeader {\n  /**\n   * @param oldStartLine The line in the old (or original) file where this diff hunk starts.\n   * @param oldLineCount The number of lines in the old (or original) file that this diff hunk covers\n   * @param newStartLine The line in the new file where this diff hunk starts.\n   * @param newLineCount The number of lines in the new file that this diff hunk covers.\n   */\n  public constructor(\n    public readonly oldStartLine: number,\n    public readonly oldLineCount: number,\n    public readonly newStartLine: number,\n    public readonly newLineCount: number\n  ) {}\n}\n\n/** the contents of a diff generated by Git */\nexport interface IRawDiff {\n  /**\n   * The plain text contents of the diff header. This contains\n   * everything from the start of the diff up until the first\n   * hunk header starts. Note that this does not include a trailing\n   * newline.\n   */\n  readonly header: string\n\n  /**\n   * The plain text contents of the diff. This contains everything\n   * after the diff header until the last character in the diff.\n   *\n   * Note that this does not include a trailing newline nor does\n   * it include diff 'no newline at end of file' comments. For\n   * no-newline information, consult the DiffLine noTrailingNewLine\n   * property.\n   */\n  readonly contents: string\n\n  /**\n   * Each hunk in the diff with information about start, and end\n   * positions, lines and line statuses.\n   */\n  readonly hunks: ReadonlyArray<DiffHunk>\n\n  /**\n   * Whether or not the unified diff indicates that the contents\n   * could not be diffed due to one of the versions being binary.\n   */\n  readonly isBinary: boolean\n}\n","/**\n * A container for holding an image for display in the application\n */\nexport class Image {\n  /**\n   * @param contents The base64 encoded contents of the image.\n   * @param mediaType The data URI media type, so the browser can render the image correctly.\n   * @param bytes Size of the file in bytes.\n   */\n  public constructor(\n    public readonly contents: string,\n    public readonly mediaType: string,\n    public readonly bytes: number\n  ) {}\n}\n","import { assertNever } from '../../lib/fatal-error'\n\n/**\n * The state of a file's diff selection\n */\nexport enum DiffSelectionType {\n  /** The entire file should be committed */\n  All,\n  /** A subset of lines in the file have been selected for committing */\n  Partial,\n  /** The file should be excluded from committing */\n  None,\n}\n\n/**\n * Utility function which determines whether a boolean selection state\n * matches the given DiffSelectionType. A true selection state matches\n * DiffSelectionType.All, a false selection state matches\n * DiffSelectionType.None and if the selection type is partial there's\n * never a match.\n */\nfunction typeMatchesSelection(\n  selectionType: DiffSelectionType,\n  selected: boolean\n): boolean {\n  switch (selectionType) {\n    case DiffSelectionType.All:\n      return selected\n    case DiffSelectionType.None:\n      return !selected\n    case DiffSelectionType.Partial:\n      return false\n    default:\n      return assertNever(\n        selectionType,\n        `Unknown selection type ${selectionType}`\n      )\n  }\n}\n\n/**\n * An immutable, efficient, storage object for tracking selections of indexable\n * lines. While general purpose by design this is currently used exclusively for\n * tracking selected lines in modified files in the working directory.\n *\n * This class starts out with an initial (or default) selection state, ie\n * either all lines are selected by default or no lines are selected by default.\n *\n * The selection can then be transformed by marking a line or a range of lines\n * as selected or not selected. Internally the class maintains a list of lines\n * whose selection state has diverged from the default selection state.\n */\nexport class DiffSelection {\n  /**\n   * Initialize a new selection instance where either all lines are selected by default\n   * or not lines are selected by default.\n   */\n  public static fromInitialSelection(\n    initialSelection: DiffSelectionType.All | DiffSelectionType.None\n  ): DiffSelection {\n    if (\n      initialSelection !== DiffSelectionType.All &&\n      initialSelection !== DiffSelectionType.None\n    ) {\n      return assertNever(\n        initialSelection,\n        'Can only instantiate a DiffSelection with All or None as the initial selection'\n      )\n    }\n\n    return new DiffSelection(initialSelection, null, null)\n  }\n\n  /**\n   * @param divergingLines Any line numbers where the selection differs from the default state.\n   * @param selectableLines Optional set of line numbers which can be selected.\n   */\n  private constructor(\n    private readonly defaultSelectionType:\n      | DiffSelectionType.All\n      | DiffSelectionType.None,\n    private readonly divergingLines: Set<number> | null = null,\n    private readonly selectableLines: Set<number> | null = null\n  ) {}\n\n  /** Returns a value indicating the computed overall state of the selection */\n  public getSelectionType(): DiffSelectionType {\n    const divergingLines = this.divergingLines\n    const selectableLines = this.selectableLines\n\n    // No diverging lines, happy path. Either all lines are selected or none are.\n    if (!divergingLines) {\n      return this.defaultSelectionType\n    }\n    if (divergingLines.size === 0) {\n      return this.defaultSelectionType\n    }\n\n    // If we know which lines are selectable we need to check that\n    // all lines are divergent and return the inverse of default selection.\n    // To avoid loopting through the set that often our happy path is\n    // if there's a size mismatch.\n    if (selectableLines && selectableLines.size === divergingLines.size) {\n      const allSelectableLinesAreDivergent = [...selectableLines].every(i =>\n        divergingLines.has(i)\n      )\n\n      if (allSelectableLinesAreDivergent) {\n        return this.defaultSelectionType === DiffSelectionType.All\n          ? DiffSelectionType.None\n          : DiffSelectionType.All\n      }\n    }\n\n    // Note that without any selectable lines we'll report partial selection\n    // as long as we have any diverging lines since we have no way of knowing\n    // if _all_ lines are divergent or not\n    return DiffSelectionType.Partial\n  }\n\n  /** Returns a value indicating wether the given line number is selected or not */\n  public isSelected(lineIndex: number): boolean {\n    const lineIsDivergent =\n      !!this.divergingLines && this.divergingLines.has(lineIndex)\n\n    if (this.defaultSelectionType === DiffSelectionType.All) {\n      return !lineIsDivergent\n    } else if (this.defaultSelectionType === DiffSelectionType.None) {\n      return lineIsDivergent\n    } else {\n      return assertNever(\n        this.defaultSelectionType,\n        `Unknown base selection type ${this.defaultSelectionType}`\n      )\n    }\n  }\n\n  /**\n   * Returns a value indicating wether the given line number is selectable.\n   * A line not being selectable usually means it's a hunk header or a context\n   * line.\n   */\n  public isSelectable(lineIndex: number): boolean {\n    return this.selectableLines ? this.selectableLines.has(lineIndex) : true\n  }\n\n  /**\n   * Returns a copy of this selection instance with the provided\n   * line selection update.\n   *\n   * @param lineIndex The index (line number) of the line which should\n   *                 be selected or unselected.\n   *\n   * @param selected Whether the given line number should be marked\n   *                 as selected or not.\n   */\n  public withLineSelection(\n    lineIndex: number,\n    selected: boolean\n  ): DiffSelection {\n    return this.withRangeSelection(lineIndex, 1, selected)\n  }\n\n  /**\n   * Returns a copy of this selection instance with the provided\n   * line selection update. This is similar to the withLineSelection\n   * method except that it allows updating the selection state of\n   * a range of lines at once. Use this if you ever need to modify\n   * the selection state of more than one line at a time as it's\n   * more efficient.\n   *\n   * @param from     The line index (inclusive) from where to start\n   *                 updating the line selection state.\n   *\n   * @param to       The number of lines for which to update the\n   *                 selection state. A value of zero means no lines\n   *                 are updated and a value of 1 means only the\n   *                 line given by lineIndex will be updated.\n   *\n   * @param selected Whether the lines should be marked as selected\n   *                 or not.\n   */\n  // Lower inclusive, upper exclusive. Same as substring\n  public withRangeSelection(\n    from: number,\n    length: number,\n    selected: boolean\n  ): DiffSelection {\n    const computedSelectionType = this.getSelectionType()\n    const to = from + length\n\n    // Nothing for us to do here. This state is when all lines are already\n    // selected and we're being asked to select more or when no lines are\n    // selected and we're being asked to unselect something.\n    if (typeMatchesSelection(computedSelectionType, selected)) {\n      return this\n    }\n\n    if (computedSelectionType === DiffSelectionType.Partial) {\n      const newDivergingLines = new Set<number>(this.divergingLines!)\n\n      if (typeMatchesSelection(this.defaultSelectionType, selected)) {\n        for (let i = from; i < to; i++) {\n          newDivergingLines.delete(i)\n        }\n      } else {\n        for (let i = from; i < to; i++) {\n          // Ensure it's selectable\n          if (this.isSelectable(i)) {\n            newDivergingLines.add(i)\n          }\n        }\n      }\n\n      return new DiffSelection(\n        this.defaultSelectionType,\n        newDivergingLines.size === 0 ? null : newDivergingLines,\n        this.selectableLines\n      )\n    } else {\n      const newDivergingLines = new Set<number>()\n      for (let i = from; i < to; i++) {\n        if (this.isSelectable(i)) {\n          newDivergingLines.add(i)\n        }\n      }\n\n      return new DiffSelection(\n        computedSelectionType,\n        newDivergingLines,\n        this.selectableLines\n      )\n    }\n  }\n\n  /**\n   * Returns a copy of this selection instance where the selection state\n   * of the specified line has been toggled (inverted).\n   *\n   * @param lineIndex The index (line number) of the line which should\n   *                 be selected or unselected.\n   */\n  public withToggleLineSelection(lineIndex: number): DiffSelection {\n    return this.withLineSelection(lineIndex, !this.isSelected(lineIndex))\n  }\n\n  /**\n   * Returns a copy of this selection instance with all lines selected.\n   */\n  public withSelectAll(): DiffSelection {\n    return new DiffSelection(DiffSelectionType.All, null, this.selectableLines)\n  }\n\n  /**\n   * Returns a copy of this selection instance with no lines selected.\n   */\n  public withSelectNone(): DiffSelection {\n    return new DiffSelection(DiffSelectionType.None, null, this.selectableLines)\n  }\n\n  /**\n   * Returns a copy of this selection instance with a specified set of\n   * selecable lines. By default a DiffSelection instance allows selecting\n   * all lines (in fact, it has no notion of how many lines exists or what\n   * it is that is being selected).\n   *\n   * If the selection instance lacks a set of selectable lines it can not\n   * supply an accurate value from getSelectionType when the selection of\n   * all lines have diverged from the default state (since it doesn't know\n   * what all lines mean).\n   */\n  public withSelectableLines(selectableLines: Set<number>) {\n    const divergingLines = this.divergingLines\n      ? new Set([...this.divergingLines].filter(x => selectableLines.has(x)))\n      : null\n\n    return new DiffSelection(\n      this.defaultSelectionType,\n      divergingLines,\n      selectableLines\n    )\n  }\n}\n","/** indicate what a line in the diff represents */\nexport enum DiffLineType {\n  Context,\n  Add,\n  Delete,\n  Hunk,\n}\n\n/** track details related to each line in the diff */\nexport class DiffLine {\n  public constructor(\n    public readonly text: string,\n    public readonly type: DiffLineType,\n    public readonly oldLineNumber: number | null,\n    public readonly newLineNumber: number | null,\n    public readonly noTrailingNewLine: boolean = false\n  ) {}\n\n  public withNoTrailingNewLine(noTrailingNewLine: boolean): DiffLine {\n    return new DiffLine(\n      this.text,\n      this.type,\n      this.oldLineNumber,\n      this.newLineNumber,\n      noTrailingNewLine\n    )\n  }\n\n  public isIncludeableLine() {\n    return this.type === DiffLineType.Add || this.type === DiffLineType.Delete\n  }\n\n  /** The content of the line, i.e., without the line type marker. */\n  public get content(): string {\n    return this.text.substr(1)\n  }\n}\n","import { DiffHunk } from './raw-diff'\nimport { Image } from './image'\n/**\n * V8 has a limit on the size of string it can create, and unless we want to\n * trigger an unhandled exception we need to do the encoding conversion by hand\n */\nexport const maximumDiffStringSize = 268435441\n\nexport enum DiffType {\n  /** Changes to a text file, which may be partially selected for commit */\n  Text,\n  /** Changes to a file with a known extension, which can be viewed in the app */\n  Image,\n  /** Changes to an unknown file format, which Git is unable to present in a human-friendly format */\n  Binary,\n  /** Change to a repository which is included as a submodule of this repository */\n  Submodule,\n  /** Diff is large enough to degrade ux if rendered */\n  LargeText,\n  /** Diff that will not be rendered */\n  Unrenderable,\n}\n\ntype LineEnding = 'CR' | 'LF' | 'CRLF'\n\nexport type LineEndingsChange = {\n  from: LineEnding\n  to: LineEnding\n}\n\n/** Parse the line ending string into an enum value (or `null` if unknown) */\nexport function parseLineEndingText(text: string): LineEnding | null {\n  const input = text.trim()\n  switch (input) {\n    case 'CR':\n      return 'CR'\n    case 'LF':\n      return 'LF'\n    case 'CRLF':\n      return 'CRLF'\n    default:\n      return null\n  }\n}\n\n/**\n * Data returned as part of a textual diff from Desktop\n */\ninterface ITextDiffData {\n  /** The unified text diff - including headers and context */\n  readonly text: string\n  /** The diff contents organized by hunk - how the git CLI outputs to the caller */\n  readonly hunks: ReadonlyArray<DiffHunk>\n  /** A warning from Git that the line endings have changed in this file and will affect the commit */\n  readonly lineEndingsChange?: LineEndingsChange\n}\n\nexport interface ITextDiff extends ITextDiffData {\n  readonly kind: DiffType.Text\n}\n\n/**\n * Data returned as part of an image diff in Desktop\n */\nexport interface IImageDiff {\n  readonly kind: DiffType.Image\n\n  /**\n   * The previous image, if the file was modified or deleted\n   *\n   * Will be undefined for an added image\n   */\n  readonly previous?: Image\n  /**\n   * The current image, if the file was added or modified\n   *\n   * Will be undefined for a deleted image\n   */\n  readonly current?: Image\n}\n\nexport interface IBinaryDiff {\n  readonly kind: DiffType.Binary\n}\n\nexport interface ILargeTextDiff extends ITextDiffData {\n  readonly kind: DiffType.LargeText\n}\n\nexport interface IUnrenderableDiff {\n  readonly kind: DiffType.Unrenderable\n}\n\n/** The union of diff types that can be rendered in Desktop */\nexport type IDiff =\n  | ITextDiff\n  | IImageDiff\n  | IBinaryDiff\n  | ILargeTextDiff\n  | IUnrenderableDiff\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst path = require(\"path\");\nfunction resolveEmbeddedGitDir() {\n    if (process.platform === 'darwin' ||\n        process.platform === 'linux' ||\n        process.platform === 'android' ||\n        process.platform === 'win32') {\n        const s = path.sep;\n        return path\n            .resolve(__dirname, '..', '..', 'git')\n            .replace(/[\\\\\\/]app.asar[\\\\\\/]/, `${s}app.asar.unpacked${s}`);\n    }\n    throw new Error('Git not supported on platform: ' + process.platform);\n}\n/**\n *  Find the path to the embedded Git environment.\n *\n *  If a custom Git directory path is defined as the `LOCAL_GIT_DIRECTORY` environment variable, then\n *  returns with it after resolving it as a path.\n */\nfunction resolveGitDir() {\n    if (process.env.LOCAL_GIT_DIRECTORY != null) {\n        return path.resolve(process.env.LOCAL_GIT_DIRECTORY);\n    }\n    else {\n        return resolveEmbeddedGitDir();\n    }\n}\n/**\n *  Find the path to the embedded Git binary.\n */\nfunction resolveGitBinary() {\n    const gitDir = resolveGitDir();\n    if (process.platform === 'win32') {\n        return path.join(gitDir, 'cmd', 'git.exe');\n    }\n    else {\n        return path.join(gitDir, 'bin', 'git');\n    }\n}\n/**\n * Find the path to the embedded git exec path.\n *\n * If a custom git exec path is given as the `GIT_EXEC_PATH` environment variable,\n * then it returns with it after resolving it as a path.\n */\nfunction resolveGitExecPath() {\n    if (process.env.GIT_EXEC_PATH != null) {\n        return path.resolve(process.env.GIT_EXEC_PATH);\n    }\n    const gitDir = resolveGitDir();\n    if (process.platform === 'win32') {\n        if (process.arch === 'x64') {\n            return path.join(gitDir, 'mingw64', 'libexec', 'git-core');\n        }\n        return path.join(gitDir, 'mingw32', 'libexec', 'git-core');\n    }\n    else {\n        return path.join(gitDir, 'libexec', 'git-core');\n    }\n}\n/**\n * Setup the process environment before invoking Git.\n *\n * This method resolves the Git executable and creates the array of key-value\n * pairs which should be used as environment variables.\n *\n * @param additional options to include with the process\n */\nfunction setupEnvironment(environmentVariables) {\n    const gitLocation = resolveGitBinary();\n    let envPath = process.env.PATH || '';\n    const gitDir = resolveGitDir();\n    if (process.platform === 'win32') {\n        if (process.arch === 'x64') {\n            envPath = `${gitDir}\\\\mingw64\\\\bin;${gitDir}\\\\mingw64\\\\usr\\\\bin;${envPath}`;\n        }\n        else {\n            envPath = `${gitDir}\\\\mingw32\\\\bin;${gitDir}\\\\mingw32\\\\usr\\\\bin;${envPath}`;\n        }\n    }\n    const env = Object.assign({}, process.env, {\n        GIT_EXEC_PATH: resolveGitExecPath(),\n        PATH: envPath\n    }, environmentVariables);\n    if (process.platform === 'win32') {\n        // while reading the environment variable is case-insensitive\n        // you can create a hash with multiple values, which means the\n        // wrong value might be used when spawning the child process\n        //\n        // this ensures we only ever supply one value for PATH\n        if (env.Path) {\n            delete env.Path;\n        }\n    }\n    if (process.platform === 'darwin' || process.platform === 'linux') {\n        // templates are used to populate your .git folder\n        // when a repository is initialized locally\n        const templateDir = `${gitDir}/share/git-core/templates`;\n        env.GIT_TEMPLATE_DIR = templateDir;\n    }\n    if (process.platform === 'linux') {\n        // when building Git for Linux and then running it from\n        // an arbitrary location, you should set PREFIX for the\n        // process to ensure that it knows how to resolve things\n        env.PREFIX = gitDir;\n        if (!env.GIT_SSL_CAINFO && !env.LOCAL_GIT_DIRECTORY) {\n            // use the SSL certificate bundle included in the distribution only\n            // when using embedded Git and not providing your own bundle\n            const distDir = resolveEmbeddedGitDir();\n            const sslCABundle = `${distDir}/ssl/cacert.pem`;\n            env.GIT_SSL_CAINFO = sslCABundle;\n        }\n    }\n    return { env, gitLocation };\n}\nexports.setupEnvironment = setupEnvironment;\n//# sourceMappingURL=git-environment.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst fs = require(\"fs\");\nconst child_process_1 = require(\"child_process\");\nconst errors_1 = require(\"./errors\");\nconst git_environment_1 = require(\"./git-environment\");\nclass GitProcess {\n    static pathExists(path) {\n        try {\n            fs.accessSync(path, fs.F_OK);\n            return true;\n        }\n        catch (_a) {\n            return false;\n        }\n    }\n    /**\n     * Execute a command and interact with the process outputs directly.\n     *\n     * The returned promise will reject when the git executable fails to launch,\n     * in which case the thrown Error will have a string `code` property. See\n     * `errors.ts` for some of the known error codes.\n     */\n    static spawn(args, path, options) {\n        let customEnv = {};\n        if (options && options.env) {\n            customEnv = options.env;\n        }\n        const { env, gitLocation } = git_environment_1.setupEnvironment(customEnv);\n        const spawnArgs = {\n            env,\n            cwd: path\n        };\n        const spawnedProcess = child_process_1.spawn(gitLocation, args, spawnArgs);\n        ignoreClosedInputStream(spawnedProcess);\n        return spawnedProcess;\n    }\n    /**\n     * Execute a command and read the output using the embedded Git environment.\n     *\n     * The returned promise will reject when the git executable fails to launch,\n     * in which case the thrown Error will have a string `code` property. See\n     * `errors.ts` for some of the known error codes.\n     *\n     * See the result's `stderr` and `exitCode` for any potential git error\n     * information.\n     */\n    static exec(args, path, options) {\n        return new Promise(function (resolve, reject) {\n            let customEnv = {};\n            if (options && options.env) {\n                customEnv = options.env;\n            }\n            const { env, gitLocation } = git_environment_1.setupEnvironment(customEnv);\n            // Explicitly annotate opts since typescript is unable to infer the correct\n            // signature for execFile when options is passed as an opaque hash. The type\n            // definition for execFile currently infers based on the encoding parameter\n            // which could change between declaration time and being passed to execFile.\n            // See https://git.io/vixyQ\n            const execOptions = {\n                cwd: path,\n                encoding: 'utf8',\n                maxBuffer: options ? options.maxBuffer : 10 * 1024 * 1024,\n                env\n            };\n            const spawnedProcess = child_process_1.execFile(gitLocation, args, execOptions, function (err, stdout, stderr) {\n                if (!err) {\n                    resolve({ stdout, stderr, exitCode: 0 });\n                    return;\n                }\n                const errWithCode = err;\n                let code = errWithCode.code;\n                // If the error's code is a string then it means the code isn't the\n                // process's exit code but rather an error coming from Node's bowels,\n                // e.g., ENOENT.\n                if (typeof code === 'string') {\n                    if (code === 'ENOENT') {\n                        let message = err.message;\n                        if (GitProcess.pathExists(path) === false) {\n                            message = 'Unable to find path to repository on disk.';\n                            code = errors_1.RepositoryDoesNotExistErrorCode;\n                        }\n                        else {\n                            message = `Git could not be found at the expected path: '${gitLocation}'. This might be a problem with how the application is packaged, so confirm this folder hasn't been removed when packaging.`;\n                            code = errors_1.GitNotFoundErrorCode;\n                        }\n                        const error = new Error(message);\n                        error.name = err.name;\n                        error.code = code;\n                        reject(error);\n                    }\n                    else {\n                        reject(err);\n                    }\n                    return;\n                }\n                if (typeof code === 'number') {\n                    resolve({ stdout, stderr, exitCode: code });\n                    return;\n                }\n                // Git has returned an output that couldn't fit in the specified buffer\n                // as we don't know how many bytes it requires, rethrow the error with\n                // details about what it was previously set to...\n                if (err.message === 'stdout maxBuffer exceeded') {\n                    reject(new Error(`The output from the command could not fit into the allocated stdout buffer. Set options.maxBuffer to a larger value than ${execOptions.maxBuffer} bytes`));\n                }\n                else {\n                    reject(err);\n                }\n            });\n            ignoreClosedInputStream(spawnedProcess);\n            if (options && options.stdin !== undefined) {\n                // See https://github.com/nodejs/node/blob/7b5ffa46fe4d2868c1662694da06eb55ec744bde/test/parallel/test-stdin-pipe-large.js\n                spawnedProcess.stdin.end(options.stdin, options.stdinEncoding);\n            }\n            if (options && options.processCallback) {\n                options.processCallback(spawnedProcess);\n            }\n        });\n    }\n    /** Try to parse an error type from stderr. */\n    static parseError(stderr) {\n        for (const regex in errors_1.GitErrorRegexes) {\n            if (stderr.match(regex)) {\n                const error = errors_1.GitErrorRegexes[regex];\n                return error;\n            }\n        }\n        return null;\n    }\n}\nexports.GitProcess = GitProcess;\n/**\n * Prevent errors originating from the stdin stream related\n * to the child process closing the pipe from bubbling up and\n * causing an unhandled exception when no error handler is\n * attached to the input stream.\n *\n * The common scenario where this happens is if the consumer\n * is writing data to the stdin stream of a child process and\n * the child process for one reason or another decides to either\n * terminate or simply close its standard input. Imagine this\n * scenario\n *\n *  cat /dev/zero | head -c 1\n *\n * The 'head' command would close its standard input (by terminating)\n * the moment it has read one byte. In the case of Git this could\n * happen if you for example pass badly formed input to apply-patch.\n *\n * Since consumers of dugite using the `exec` api are unable to get\n * a hold of the stream until after we've written data to it they're\n * unable to fix it themselves so we'll just go ahead and ignore the\n * error for them. By supressing the stream error we can pick up on\n * the real error when the process exits when we parse the exit code\n * and the standard error.\n *\n * See https://github.com/desktop/desktop/pull/4027#issuecomment-366213276\n */\nfunction ignoreClosedInputStream(process) {\n    process.stdin.on('error', err => {\n        const code = err.code;\n        // Is the error one that we'd expect from the input stream being\n        // closed, i.e. EPIPE on macOS and EOF on Windows. We've also\n        // seen ECONNRESET failures on Linux hosts so let's throw that in\n        // there for good measure.\n        if (code === 'EPIPE' || code === 'EOF' || code === 'ECONNRESET') {\n            return;\n        }\n        // Nope, this is something else. Are there any other error listeners\n        // attached than us? If not we'll have to mimic the behavior of\n        // EventEmitter.\n        //\n        // See https://nodejs.org/api/errors.html#errors_error_propagation_and_interception\n        //\n        // \"For all EventEmitter objects, if an 'error' event handler is not\n        //  provided, the error will be thrown\"\n        if (process.stdin.listeners('error').length <= 1) {\n            throw err;\n        }\n    });\n}\n//# sourceMappingURL=git-process.js.map","/* globals __webpack_amd_options__ */\r\nmodule.exports = __webpack_amd_options__;\r\n","/**\n * UAParser.js v0.7.14\n * Lightweight JavaScript-based User-Agent string parser\n * https://github.com/faisalman/ua-parser-js\n *\n * Copyright  2012-2016 Faisal Salman <fyzlman@gmail.com>\n * Dual licensed under GPLv2 & MIT\n */\n\n(function (window, undefined) {\n\n    'use strict';\n\n    //////////////\n    // Constants\n    /////////////\n\n\n    var LIBVERSION  = '0.7.14',\n        EMPTY       = '',\n        UNKNOWN     = '?',\n        FUNC_TYPE   = 'function',\n        UNDEF_TYPE  = 'undefined',\n        OBJ_TYPE    = 'object',\n        STR_TYPE    = 'string',\n        MAJOR       = 'major', // deprecated\n        MODEL       = 'model',\n        NAME        = 'name',\n        TYPE        = 'type',\n        VENDOR      = 'vendor',\n        VERSION     = 'version',\n        ARCHITECTURE= 'architecture',\n        CONSOLE     = 'console',\n        MOBILE      = 'mobile',\n        TABLET      = 'tablet',\n        SMARTTV     = 'smarttv',\n        WEARABLE    = 'wearable',\n        EMBEDDED    = 'embedded';\n\n\n    ///////////\n    // Helper\n    //////////\n\n\n    var util = {\n        extend : function (regexes, extensions) {\n            var margedRegexes = {};\n            for (var i in regexes) {\n                if (extensions[i] && extensions[i].length % 2 === 0) {\n                    margedRegexes[i] = extensions[i].concat(regexes[i]);\n                } else {\n                    margedRegexes[i] = regexes[i];\n                }\n            }\n            return margedRegexes;\n        },\n        has : function (str1, str2) {\n          if (typeof str1 === \"string\") {\n            return str2.toLowerCase().indexOf(str1.toLowerCase()) !== -1;\n          } else {\n            return false;\n          }\n        },\n        lowerize : function (str) {\n            return str.toLowerCase();\n        },\n        major : function (version) {\n            return typeof(version) === STR_TYPE ? version.replace(/[^\\d\\.]/g,'').split(\".\")[0] : undefined;\n        },\n        trim : function (str) {\n          return str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n        }\n    };\n\n\n    ///////////////\n    // Map helper\n    //////////////\n\n\n    var mapper = {\n\n        rgx : function (ua, arrays) {\n\n            //var result = {},\n            var i = 0, j, k, p, q, matches, match;//, args = arguments;\n\n            /*// construct object barebones\n            for (p = 0; p < args[1].length; p++) {\n                q = args[1][p];\n                result[typeof q === OBJ_TYPE ? q[0] : q] = undefined;\n            }*/\n\n            // loop through all regexes maps\n            while (i < arrays.length && !matches) {\n\n                var regex = arrays[i],       // even sequence (0,2,4,..)\n                    props = arrays[i + 1];   // odd sequence (1,3,5,..)\n                j = k = 0;\n\n                // try matching uastring with regexes\n                while (j < regex.length && !matches) {\n\n                    matches = regex[j++].exec(ua);\n\n                    if (!!matches) {\n                        for (p = 0; p < props.length; p++) {\n                            match = matches[++k];\n                            q = props[p];\n                            // check if given property is actually array\n                            if (typeof q === OBJ_TYPE && q.length > 0) {\n                                if (q.length == 2) {\n                                    if (typeof q[1] == FUNC_TYPE) {\n                                        // assign modified match\n                                        this[q[0]] = q[1].call(this, match);\n                                    } else {\n                                        // assign given value, ignore regex match\n                                        this[q[0]] = q[1];\n                                    }\n                                } else if (q.length == 3) {\n                                    // check whether function or regex\n                                    if (typeof q[1] === FUNC_TYPE && !(q[1].exec && q[1].test)) {\n                                        // call function (usually string mapper)\n                                        this[q[0]] = match ? q[1].call(this, match, q[2]) : undefined;\n                                    } else {\n                                        // sanitize match using given regex\n                                        this[q[0]] = match ? match.replace(q[1], q[2]) : undefined;\n                                    }\n                                } else if (q.length == 4) {\n                                        this[q[0]] = match ? q[3].call(this, match.replace(q[1], q[2])) : undefined;\n                                }\n                            } else {\n                                this[q] = match ? match : undefined;\n                            }\n                        }\n                    }\n                }\n                i += 2;\n            }\n            //console.log(this);\n            //return this;\n        },\n\n        str : function (str, map) {\n\n            for (var i in map) {\n                // check if array\n                if (typeof map[i] === OBJ_TYPE && map[i].length > 0) {\n                    for (var j = 0; j < map[i].length; j++) {\n                        if (util.has(map[i][j], str)) {\n                            return (i === UNKNOWN) ? undefined : i;\n                        }\n                    }\n                } else if (util.has(map[i], str)) {\n                    return (i === UNKNOWN) ? undefined : i;\n                }\n            }\n            return str;\n        }\n    };\n\n\n    ///////////////\n    // String map\n    //////////////\n\n\n    var maps = {\n\n        browser : {\n            oldsafari : {\n                version : {\n                    '1.0'   : '/8',\n                    '1.2'   : '/1',\n                    '1.3'   : '/3',\n                    '2.0'   : '/412',\n                    '2.0.2' : '/416',\n                    '2.0.3' : '/417',\n                    '2.0.4' : '/419',\n                    '?'     : '/'\n                }\n            }\n        },\n\n        device : {\n            amazon : {\n                model : {\n                    'Fire Phone' : ['SD', 'KF']\n                }\n            },\n            sprint : {\n                model : {\n                    'Evo Shift 4G' : '7373KT'\n                },\n                vendor : {\n                    'HTC'       : 'APA',\n                    'Sprint'    : 'Sprint'\n                }\n            }\n        },\n\n        os : {\n            windows : {\n                version : {\n                    'ME'        : '4.90',\n                    'NT 3.11'   : 'NT3.51',\n                    'NT 4.0'    : 'NT4.0',\n                    '2000'      : 'NT 5.0',\n                    'XP'        : ['NT 5.1', 'NT 5.2'],\n                    'Vista'     : 'NT 6.0',\n                    '7'         : 'NT 6.1',\n                    '8'         : 'NT 6.2',\n                    '8.1'       : 'NT 6.3',\n                    '10'        : ['NT 6.4', 'NT 10.0'],\n                    'RT'        : 'ARM'\n                }\n            }\n        }\n    };\n\n\n    //////////////\n    // Regex map\n    /////////////\n\n\n    var regexes = {\n\n        browser : [[\n\n            // Presto based\n            /(opera\\smini)\\/([\\w\\.-]+)/i,                                       // Opera Mini\n            /(opera\\s[mobiletab]+).+version\\/([\\w\\.-]+)/i,                      // Opera Mobi/Tablet\n            /(opera).+version\\/([\\w\\.]+)/i,                                     // Opera > 9.80\n            /(opera)[\\/\\s]+([\\w\\.]+)/i                                          // Opera < 9.80\n            ], [NAME, VERSION], [\n\n            /(opios)[\\/\\s]+([\\w\\.]+)/i                                          // Opera mini on iphone >= 8.0\n            ], [[NAME, 'Opera Mini'], VERSION], [\n\n            /\\s(opr)\\/([\\w\\.]+)/i                                               // Opera Webkit\n            ], [[NAME, 'Opera'], VERSION], [\n\n            // Mixed\n            /(kindle)\\/([\\w\\.]+)/i,                                             // Kindle\n            /(lunascape|maxthon|netfront|jasmine|blazer)[\\/\\s]?([\\w\\.]+)*/i,\n                                                                                // Lunascape/Maxthon/Netfront/Jasmine/Blazer\n\n            // Trident based\n            /(avant\\s|iemobile|slim|baidu)(?:browser)?[\\/\\s]?([\\w\\.]*)/i,\n                                                                                // Avant/IEMobile/SlimBrowser/Baidu\n            /(?:ms|\\()(ie)\\s([\\w\\.]+)/i,                                        // Internet Explorer\n\n            // Webkit/KHTML based\n            /(rekonq)\\/([\\w\\.]+)*/i,                                            // Rekonq\n            /(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser)\\/([\\w\\.-]+)/i\n                                                                                // Chromium/Flock/RockMelt/Midori/Epiphany/Silk/Skyfire/Bolt/Iron/Iridium/PhantomJS/Bowser\n            ], [NAME, VERSION], [\n\n            /(trident).+rv[:\\s]([\\w\\.]+).+like\\sgecko/i                         // IE11\n            ], [[NAME, 'IE'], VERSION], [\n\n            /(edge)\\/((\\d+)?[\\w\\.]+)/i                                          // Microsoft Edge\n            ], [NAME, VERSION], [\n\n            /(yabrowser)\\/([\\w\\.]+)/i                                           // Yandex\n            ], [[NAME, 'Yandex'], VERSION], [\n\n            /(puffin)\\/([\\w\\.]+)/i                                              // Puffin\n            ], [[NAME, 'Puffin'], VERSION], [\n\n            /((?:[\\s\\/])uc?\\s?browser|(?:juc.+)ucweb)[\\/\\s]?([\\w\\.]+)/i\n                                                                                // UCBrowser\n            ], [[NAME, 'UCBrowser'], VERSION], [\n\n            /(comodo_dragon)\\/([\\w\\.]+)/i                                       // Comodo Dragon\n            ], [[NAME, /_/g, ' '], VERSION], [\n\n            /(micromessenger)\\/([\\w\\.]+)/i                                      // WeChat\n            ], [[NAME, 'WeChat'], VERSION], [\n\n            /(QQ)\\/([\\d\\.]+)/i                                                  // QQ, aka ShouQ\n            ], [NAME, VERSION], [\n\n            /m?(qqbrowser)[\\/\\s]?([\\w\\.]+)/i                                    // QQBrowser\n            ], [NAME, VERSION], [\n\n            /xiaomi\\/miuibrowser\\/([\\w\\.]+)/i                                   // MIUI Browser\n            ], [VERSION, [NAME, 'MIUI Browser']], [\n\n            /;fbav\\/([\\w\\.]+);/i                                                // Facebook App for iOS & Android\n            ], [VERSION, [NAME, 'Facebook']], [\n\n            /(headlesschrome) ([\\w\\.]+)/i                                       // Chrome Headless\n            ], [VERSION, [NAME, 'Chrome Headless']], [\n\n            /\\swv\\).+(chrome)\\/([\\w\\.]+)/i                                      // Chrome WebView\n            ], [[NAME, /(.+)/, '$1 WebView'], VERSION], [\n\n            /((?:oculus|samsung)browser)\\/([\\w\\.]+)/i\n            ], [[NAME, /(.+(?:g|us))(.+)/, '$1 $2'], VERSION], [                // Oculus / Samsung Browser\n\n            /android.+version\\/([\\w\\.]+)\\s+(?:mobile\\s?safari|safari)*/i        // Android Browser\n            ], [VERSION, [NAME, 'Android Browser']], [\n\n            /(chrome|omniweb|arora|[tizenoka]{5}\\s?browser)\\/v?([\\w\\.]+)/i\n                                                                                // Chrome/OmniWeb/Arora/Tizen/Nokia\n            ], [NAME, VERSION], [\n\n            /(dolfin)\\/([\\w\\.]+)/i                                              // Dolphin\n            ], [[NAME, 'Dolphin'], VERSION], [\n\n            /((?:android.+)crmo|crios)\\/([\\w\\.]+)/i                             // Chrome for Android/iOS\n            ], [[NAME, 'Chrome'], VERSION], [\n\n            /(coast)\\/([\\w\\.]+)/i                                               // Opera Coast\n            ], [[NAME, 'Opera Coast'], VERSION], [\n\n            /fxios\\/([\\w\\.-]+)/i                                                // Firefox for iOS\n            ], [VERSION, [NAME, 'Firefox']], [\n\n            /version\\/([\\w\\.]+).+?mobile\\/\\w+\\s(safari)/i                       // Mobile Safari\n            ], [VERSION, [NAME, 'Mobile Safari']], [\n\n            /version\\/([\\w\\.]+).+?(mobile\\s?safari|safari)/i                    // Safari & Safari Mobile\n            ], [VERSION, NAME], [\n\n            /webkit.+?(mobile\\s?safari|safari)(\\/[\\w\\.]+)/i                     // Safari < 3.0\n            ], [NAME, [VERSION, mapper.str, maps.browser.oldsafari.version]], [\n\n            /(konqueror)\\/([\\w\\.]+)/i,                                          // Konqueror\n            /(webkit|khtml)\\/([\\w\\.]+)/i\n            ], [NAME, VERSION], [\n\n            // Gecko based\n            /(navigator|netscape)\\/([\\w\\.-]+)/i                                 // Netscape\n            ], [[NAME, 'Netscape'], VERSION], [\n            /(swiftfox)/i,                                                      // Swiftfox\n            /(icedragon|iceweasel|camino|chimera|fennec|maemo\\sbrowser|minimo|conkeror)[\\/\\s]?([\\w\\.\\+]+)/i,\n                                                                                // IceDragon/Iceweasel/Camino/Chimera/Fennec/Maemo/Minimo/Conkeror\n            /(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\\/([\\w\\.-]+)/i,\n                                                                                // Firefox/SeaMonkey/K-Meleon/IceCat/IceApe/Firebird/Phoenix\n            /(mozilla)\\/([\\w\\.]+).+rv\\:.+gecko\\/\\d+/i,                          // Mozilla\n\n            // Other\n            /(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\\/\\s]?([\\w\\.]+)/i,\n                                                                                // Polaris/Lynx/Dillo/iCab/Doris/Amaya/w3m/NetSurf/Sleipnir\n            /(links)\\s\\(([\\w\\.]+)/i,                                            // Links\n            /(gobrowser)\\/?([\\w\\.]+)*/i,                                        // GoBrowser\n            /(ice\\s?browser)\\/v?([\\w\\._]+)/i,                                   // ICE Browser\n            /(mosaic)[\\/\\s]([\\w\\.]+)/i                                          // Mosaic\n            ], [NAME, VERSION]\n\n            /* /////////////////////\n            // Media players BEGIN\n            ////////////////////////\n\n            , [\n\n            /(apple(?:coremedia|))\\/((\\d+)[\\w\\._]+)/i,                          // Generic Apple CoreMedia\n            /(coremedia) v((\\d+)[\\w\\._]+)/i\n            ], [NAME, VERSION], [\n\n            /(aqualung|lyssna|bsplayer)\\/((\\d+)?[\\w\\.-]+)/i                     // Aqualung/Lyssna/BSPlayer\n            ], [NAME, VERSION], [\n\n            /(ares|ossproxy)\\s((\\d+)[\\w\\.-]+)/i                                 // Ares/OSSProxy\n            ], [NAME, VERSION], [\n\n            /(audacious|audimusicstream|amarok|bass|core|dalvik|gnomemplayer|music on console|nsplayer|psp-internetradioplayer|videos)\\/((\\d+)[\\w\\.-]+)/i,\n                                                                                // Audacious/AudiMusicStream/Amarok/BASS/OpenCORE/Dalvik/GnomeMplayer/MoC\n                                                                                // NSPlayer/PSP-InternetRadioPlayer/Videos\n            /(clementine|music player daemon)\\s((\\d+)[\\w\\.-]+)/i,               // Clementine/MPD\n            /(lg player|nexplayer)\\s((\\d+)[\\d\\.]+)/i,\n            /player\\/(nexplayer|lg player)\\s((\\d+)[\\w\\.-]+)/i                   // NexPlayer/LG Player\n            ], [NAME, VERSION], [\n            /(nexplayer)\\s((\\d+)[\\w\\.-]+)/i                                     // Nexplayer\n            ], [NAME, VERSION], [\n\n            /(flrp)\\/((\\d+)[\\w\\.-]+)/i                                          // Flip Player\n            ], [[NAME, 'Flip Player'], VERSION], [\n\n            /(fstream|nativehost|queryseekspider|ia-archiver|facebookexternalhit)/i\n                                                                                // FStream/NativeHost/QuerySeekSpider/IA Archiver/facebookexternalhit\n            ], [NAME], [\n\n            /(gstreamer) souphttpsrc (?:\\([^\\)]+\\)){0,1} libsoup\\/((\\d+)[\\w\\.-]+)/i\n                                                                                // Gstreamer\n            ], [NAME, VERSION], [\n\n            /(htc streaming player)\\s[\\w_]+\\s\\/\\s((\\d+)[\\d\\.]+)/i,              // HTC Streaming Player\n            /(java|python-urllib|python-requests|wget|libcurl)\\/((\\d+)[\\w\\.-_]+)/i,\n                                                                                // Java/urllib/requests/wget/cURL\n            /(lavf)((\\d+)[\\d\\.]+)/i                                             // Lavf (FFMPEG)\n            ], [NAME, VERSION], [\n\n            /(htc_one_s)\\/((\\d+)[\\d\\.]+)/i                                      // HTC One S\n            ], [[NAME, /_/g, ' '], VERSION], [\n\n            /(mplayer)(?:\\s|\\/)(?:(?:sherpya-){0,1}svn)(?:-|\\s)(r\\d+(?:-\\d+[\\w\\.-]+){0,1})/i\n                                                                                // MPlayer SVN\n            ], [NAME, VERSION], [\n\n            /(mplayer)(?:\\s|\\/|[unkow-]+)((\\d+)[\\w\\.-]+)/i                      // MPlayer\n            ], [NAME, VERSION], [\n\n            /(mplayer)/i,                                                       // MPlayer (no other info)\n            /(yourmuze)/i,                                                      // YourMuze\n            /(media player classic|nero showtime)/i                             // Media Player Classic/Nero ShowTime\n            ], [NAME], [\n\n            /(nero (?:home|scout))\\/((\\d+)[\\w\\.-]+)/i                           // Nero Home/Nero Scout\n            ], [NAME, VERSION], [\n\n            /(nokia\\d+)\\/((\\d+)[\\w\\.-]+)/i                                      // Nokia\n            ], [NAME, VERSION], [\n\n            /\\s(songbird)\\/((\\d+)[\\w\\.-]+)/i                                    // Songbird/Philips-Songbird\n            ], [NAME, VERSION], [\n\n            /(winamp)3 version ((\\d+)[\\w\\.-]+)/i,                               // Winamp\n            /(winamp)\\s((\\d+)[\\w\\.-]+)/i,\n            /(winamp)mpeg\\/((\\d+)[\\w\\.-]+)/i\n            ], [NAME, VERSION], [\n\n            /(ocms-bot|tapinradio|tunein radio|unknown|winamp|inlight radio)/i  // OCMS-bot/tap in radio/tunein/unknown/winamp (no other info)\n                                                                                // inlight radio\n            ], [NAME], [\n\n            /(quicktime|rma|radioapp|radioclientapplication|soundtap|totem|stagefright|streamium)\\/((\\d+)[\\w\\.-]+)/i\n                                                                                // QuickTime/RealMedia/RadioApp/RadioClientApplication/\n                                                                                // SoundTap/Totem/Stagefright/Streamium\n            ], [NAME, VERSION], [\n\n            /(smp)((\\d+)[\\d\\.]+)/i                                              // SMP\n            ], [NAME, VERSION], [\n\n            /(vlc) media player - version ((\\d+)[\\w\\.]+)/i,                     // VLC Videolan\n            /(vlc)\\/((\\d+)[\\w\\.-]+)/i,\n            /(xbmc|gvfs|xine|xmms|irapp)\\/((\\d+)[\\w\\.-]+)/i,                    // XBMC/gvfs/Xine/XMMS/irapp\n            /(foobar2000)\\/((\\d+)[\\d\\.]+)/i,                                    // Foobar2000\n            /(itunes)\\/((\\d+)[\\d\\.]+)/i                                         // iTunes\n            ], [NAME, VERSION], [\n\n            /(wmplayer)\\/((\\d+)[\\w\\.-]+)/i,                                     // Windows Media Player\n            /(windows-media-player)\\/((\\d+)[\\w\\.-]+)/i\n            ], [[NAME, /-/g, ' '], VERSION], [\n\n            /windows\\/((\\d+)[\\w\\.-]+) upnp\\/[\\d\\.]+ dlnadoc\\/[\\d\\.]+ (home media server)/i\n                                                                                // Windows Media Server\n            ], [VERSION, [NAME, 'Windows']], [\n\n            /(com\\.riseupradioalarm)\\/((\\d+)[\\d\\.]*)/i                          // RiseUP Radio Alarm\n            ], [NAME, VERSION], [\n\n            /(rad.io)\\s((\\d+)[\\d\\.]+)/i,                                        // Rad.io\n            /(radio.(?:de|at|fr))\\s((\\d+)[\\d\\.]+)/i\n            ], [[NAME, 'rad.io'], VERSION]\n\n            //////////////////////\n            // Media players END\n            ////////////////////*/\n\n        ],\n\n        cpu : [[\n\n            /(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\\)]/i                     // AMD64\n            ], [[ARCHITECTURE, 'amd64']], [\n\n            /(ia32(?=;))/i                                                      // IA32 (quicktime)\n            ], [[ARCHITECTURE, util.lowerize]], [\n\n            /((?:i[346]|x)86)[;\\)]/i                                            // IA32\n            ], [[ARCHITECTURE, 'ia32']], [\n\n            // PocketPC mistakenly identified as PowerPC\n            /windows\\s(ce|mobile);\\sppc;/i\n            ], [[ARCHITECTURE, 'arm']], [\n\n            /((?:ppc|powerpc)(?:64)?)(?:\\smac|;|\\))/i                           // PowerPC\n            ], [[ARCHITECTURE, /ower/, '', util.lowerize]], [\n\n            /(sun4\\w)[;\\)]/i                                                    // SPARC\n            ], [[ARCHITECTURE, 'sparc']], [\n\n            /((?:avr32|ia64(?=;))|68k(?=\\))|arm(?:64|(?=v\\d+;))|(?=atmel\\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i\n                                                                                // IA64, 68K, ARM/64, AVR/32, IRIX/64, MIPS/64, SPARC/64, PA-RISC\n            ], [[ARCHITECTURE, util.lowerize]]\n        ],\n\n        device : [[\n\n            /\\((ipad|playbook);[\\w\\s\\);-]+(rim|apple)/i                         // iPad/PlayBook\n            ], [MODEL, VENDOR, [TYPE, TABLET]], [\n\n            /applecoremedia\\/[\\w\\.]+ \\((ipad)/                                  // iPad\n            ], [MODEL, [VENDOR, 'Apple'], [TYPE, TABLET]], [\n\n            /(apple\\s{0,1}tv)/i                                                 // Apple TV\n            ], [[MODEL, 'Apple TV'], [VENDOR, 'Apple']], [\n\n            /(archos)\\s(gamepad2?)/i,                                           // Archos\n            /(hp).+(touchpad)/i,                                                // HP TouchPad\n            /(hp).+(tablet)/i,                                                  // HP Tablet\n            /(kindle)\\/([\\w\\.]+)/i,                                             // Kindle\n            /\\s(nook)[\\w\\s]+build\\/(\\w+)/i,                                     // Nook\n            /(dell)\\s(strea[kpr\\s\\d]*[\\dko])/i                                  // Dell Streak\n            ], [VENDOR, MODEL, [TYPE, TABLET]], [\n\n            /(kf[A-z]+)\\sbuild\\/[\\w\\.]+.*silk\\//i                               // Kindle Fire HD\n            ], [MODEL, [VENDOR, 'Amazon'], [TYPE, TABLET]], [\n            /(sd|kf)[0349hijorstuw]+\\sbuild\\/[\\w\\.]+.*silk\\//i                  // Fire Phone\n            ], [[MODEL, mapper.str, maps.device.amazon.model], [VENDOR, 'Amazon'], [TYPE, MOBILE]], [\n\n            /\\((ip[honed|\\s\\w*]+);.+(apple)/i                                   // iPod/iPhone\n            ], [MODEL, VENDOR, [TYPE, MOBILE]], [\n            /\\((ip[honed|\\s\\w*]+);/i                                            // iPod/iPhone\n            ], [MODEL, [VENDOR, 'Apple'], [TYPE, MOBILE]], [\n\n            /(blackberry)[\\s-]?(\\w+)/i,                                         // BlackBerry\n            /(blackberry|benq|palm(?=\\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\\s_-]?([\\w-]+)*/i,\n                                                                                // BenQ/Palm/Sony-Ericsson/Acer/Asus/Dell/Meizu/Motorola/Polytron\n            /(hp)\\s([\\w\\s]+\\w)/i,                                               // HP iPAQ\n            /(asus)-?(\\w+)/i                                                    // Asus\n            ], [VENDOR, MODEL, [TYPE, MOBILE]], [\n            /\\(bb10;\\s(\\w+)/i                                                   // BlackBerry 10\n            ], [MODEL, [VENDOR, 'BlackBerry'], [TYPE, MOBILE]], [\n                                                                                // Asus Tablets\n            /android.+(transfo[prime\\s]{4,10}\\s\\w+|eeepc|slider\\s\\w+|nexus 7|padfone)/i\n            ], [MODEL, [VENDOR, 'Asus'], [TYPE, TABLET]], [\n\n            /(sony)\\s(tablet\\s[ps])\\sbuild\\//i,                                  // Sony\n            /(sony)?(?:sgp.+)\\sbuild\\//i\n            ], [[VENDOR, 'Sony'], [MODEL, 'Xperia Tablet'], [TYPE, TABLET]], [\n            /android.+\\s([c-g]\\d{4}|so[-l]\\w+)\\sbuild\\//i\n            ], [MODEL, [VENDOR, 'Sony'], [TYPE, MOBILE]], [\n\n            /\\s(ouya)\\s/i,                                                      // Ouya\n            /(nintendo)\\s([wids3u]+)/i                                          // Nintendo\n            ], [VENDOR, MODEL, [TYPE, CONSOLE]], [\n\n            /android.+;\\s(shield)\\sbuild/i                                      // Nvidia\n            ], [MODEL, [VENDOR, 'Nvidia'], [TYPE, CONSOLE]], [\n\n            /(playstation\\s[34portablevi]+)/i                                   // Playstation\n            ], [MODEL, [VENDOR, 'Sony'], [TYPE, CONSOLE]], [\n\n            /(sprint\\s(\\w+))/i                                                  // Sprint Phones\n            ], [[VENDOR, mapper.str, maps.device.sprint.vendor], [MODEL, mapper.str, maps.device.sprint.model], [TYPE, MOBILE]], [\n\n            /(lenovo)\\s?(S(?:5000|6000)+(?:[-][\\w+]))/i                         // Lenovo tablets\n            ], [VENDOR, MODEL, [TYPE, TABLET]], [\n\n            /(htc)[;_\\s-]+([\\w\\s]+(?=\\))|\\w+)*/i,                               // HTC\n            /(zte)-(\\w+)*/i,                                                    // ZTE\n            /(alcatel|geeksphone|lenovo|nexian|panasonic|(?=;\\s)sony)[_\\s-]?([\\w-]+)*/i\n                                                                                // Alcatel/GeeksPhone/Lenovo/Nexian/Panasonic/Sony\n            ], [VENDOR, [MODEL, /_/g, ' '], [TYPE, MOBILE]], [\n\n            /(nexus\\s9)/i                                                       // HTC Nexus 9\n            ], [MODEL, [VENDOR, 'HTC'], [TYPE, TABLET]], [\n\n            /d\\/huawei([\\w\\s-]+)[;\\)]/i,\n            /(nexus\\s6p)/i                                                      // Huawei\n            ], [MODEL, [VENDOR, 'Huawei'], [TYPE, MOBILE]], [\n\n            /(microsoft);\\s(lumia[\\s\\w]+)/i                                     // Microsoft Lumia\n            ], [VENDOR, MODEL, [TYPE, MOBILE]], [\n\n            /[\\s\\(;](xbox(?:\\sone)?)[\\s\\);]/i                                   // Microsoft Xbox\n            ], [MODEL, [VENDOR, 'Microsoft'], [TYPE, CONSOLE]], [\n            /(kin\\.[onetw]{3})/i                                                // Microsoft Kin\n            ], [[MODEL, /\\./g, ' '], [VENDOR, 'Microsoft'], [TYPE, MOBILE]], [\n\n                                                                                // Motorola\n            /\\s(milestone|droid(?:[2-4x]|\\s(?:bionic|x2|pro|razr))?(:?\\s4g)?)[\\w\\s]+build\\//i,\n            /mot[\\s-]?(\\w+)*/i,\n            /(XT\\d{3,4}) build\\//i,\n            /(nexus\\s6)/i\n            ], [MODEL, [VENDOR, 'Motorola'], [TYPE, MOBILE]], [\n            /android.+\\s(mz60\\d|xoom[\\s2]{0,2})\\sbuild\\//i\n            ], [MODEL, [VENDOR, 'Motorola'], [TYPE, TABLET]], [\n\n            /hbbtv\\/\\d+\\.\\d+\\.\\d+\\s+\\([\\w\\s]*;\\s*(\\w[^;]*);([^;]*)/i            // HbbTV devices\n            ], [[VENDOR, util.trim], [MODEL, util.trim], [TYPE, SMARTTV]], [\n\n            /hbbtv.+maple;(\\d+)/i\n            ], [[MODEL, /^/, 'SmartTV'], [VENDOR, 'Samsung'], [TYPE, SMARTTV]], [\n\n            /\\(dtv[\\);].+(aquos)/i                                              // Sharp\n            ], [MODEL, [VENDOR, 'Sharp'], [TYPE, SMARTTV]], [\n\n            /android.+((sch-i[89]0\\d|shw-m380s|gt-p\\d{4}|gt-n\\d+|sgh-t8[56]9|nexus 10))/i,\n            /((SM-T\\w+))/i\n            ], [[VENDOR, 'Samsung'], MODEL, [TYPE, TABLET]], [                  // Samsung\n            /smart-tv.+(samsung)/i\n            ], [VENDOR, [TYPE, SMARTTV], MODEL], [\n            /((s[cgp]h-\\w+|gt-\\w+|galaxy\\snexus|sm-\\w[\\w\\d]+))/i,\n            /(sam[sung]*)[\\s-]*(\\w+-?[\\w-]*)*/i,\n            /sec-((sgh\\w+))/i\n            ], [[VENDOR, 'Samsung'], MODEL, [TYPE, MOBILE]], [\n\n            /sie-(\\w+)*/i                                                       // Siemens\n            ], [MODEL, [VENDOR, 'Siemens'], [TYPE, MOBILE]], [\n\n            /(maemo|nokia).*(n900|lumia\\s\\d+)/i,                                // Nokia\n            /(nokia)[\\s_-]?([\\w-]+)*/i\n            ], [[VENDOR, 'Nokia'], MODEL, [TYPE, MOBILE]], [\n\n            /android\\s3\\.[\\s\\w;-]{10}(a\\d{3})/i                                 // Acer\n            ], [MODEL, [VENDOR, 'Acer'], [TYPE, TABLET]], [\n\n            /android.+([vl]k\\-?\\d{3})\\s+build/i                                 // LG Tablet\n            ], [MODEL, [VENDOR, 'LG'], [TYPE, TABLET]], [\n            /android\\s3\\.[\\s\\w;-]{10}(lg?)-([06cv9]{3,4})/i                     // LG Tablet\n            ], [[VENDOR, 'LG'], MODEL, [TYPE, TABLET]], [\n            /(lg) netcast\\.tv/i                                                 // LG SmartTV\n            ], [VENDOR, MODEL, [TYPE, SMARTTV]], [\n            /(nexus\\s[45])/i,                                                   // LG\n            /lg[e;\\s\\/-]+(\\w+)*/i,\n            /android.+lg(\\-?[\\d\\w]+)\\s+build/i\n            ], [MODEL, [VENDOR, 'LG'], [TYPE, MOBILE]], [\n\n            /android.+(ideatab[a-z0-9\\-\\s]+)/i                                  // Lenovo\n            ], [MODEL, [VENDOR, 'Lenovo'], [TYPE, TABLET]], [\n\n            /linux;.+((jolla));/i                                               // Jolla\n            ], [VENDOR, MODEL, [TYPE, MOBILE]], [\n\n            /((pebble))app\\/[\\d\\.]+\\s/i                                         // Pebble\n            ], [VENDOR, MODEL, [TYPE, WEARABLE]], [\n\n            /android.+;\\s(oppo)\\s?([\\w\\s]+)\\sbuild/i                            // OPPO\n            ], [VENDOR, MODEL, [TYPE, MOBILE]], [\n\n            /crkey/i                                                            // Google Chromecast\n            ], [[MODEL, 'Chromecast'], [VENDOR, 'Google']], [\n\n            /android.+;\\s(glass)\\s\\d/i                                          // Google Glass\n            ], [MODEL, [VENDOR, 'Google'], [TYPE, WEARABLE]], [\n\n            /android.+;\\s(pixel c)\\s/i                                          // Google Pixel C\n            ], [MODEL, [VENDOR, 'Google'], [TYPE, TABLET]], [\n\n            /android.+;\\s(pixel xl|pixel)\\s/i                                   // Google Pixel\n            ], [MODEL, [VENDOR, 'Google'], [TYPE, MOBILE]], [\n\n            /android.+(\\w+)\\s+build\\/hm\\1/i,                                    // Xiaomi Hongmi 'numeric' models\n            /android.+(hm[\\s\\-_]*note?[\\s_]*(?:\\d\\w)?)\\s+build/i,               // Xiaomi Hongmi\n            /android.+(mi[\\s\\-_]*(?:one|one[\\s_]plus|note lte)?[\\s_]*(?:\\d\\w)?)\\s+build/i    // Xiaomi Mi\n            ], [[MODEL, /_/g, ' '], [VENDOR, 'Xiaomi'], [TYPE, MOBILE]], [\n\n            /android.+;\\s(m[1-5]\\snote)\\sbuild/i                                // Meizu Tablet\n            ], [MODEL, [VENDOR, 'Meizu'], [TYPE, TABLET]], [\n\n            /android.+a000(1)\\s+build/i                                         // OnePlus\n            ], [MODEL, [VENDOR, 'OnePlus'], [TYPE, MOBILE]], [\n\n            /android.+[;\\/]\\s*(RCT[\\d\\w]+)\\s+build/i                            // RCA Tablets\n            ], [MODEL, [VENDOR, 'RCA'], [TYPE, TABLET]], [\n\n            /android.+[;\\/]\\s*(Venue[\\d\\s]*)\\s+build/i                          // Dell Venue Tablets\n            ], [MODEL, [VENDOR, 'Dell'], [TYPE, TABLET]], [\n\n            /android.+[;\\/]\\s*(Q[T|M][\\d\\w]+)\\s+build/i                         // Verizon Tablet\n            ], [MODEL, [VENDOR, 'Verizon'], [TYPE, TABLET]], [\n\n            /android.+[;\\/]\\s+(Barnes[&\\s]+Noble\\s+|BN[RT])(V?.*)\\s+build/i     // Barnes & Noble Tablet\n            ], [[VENDOR, 'Barnes & Noble'], MODEL, [TYPE, TABLET]], [\n\n            /android.+[;\\/]\\s+(TM\\d{3}.*\\b)\\s+build/i                           // Barnes & Noble Tablet\n            ], [MODEL, [VENDOR, 'NuVision'], [TYPE, TABLET]], [\n\n            /android.+[;\\/]\\s*(zte)?.+(k\\d{2})\\s+build/i                        // ZTE K Series Tablet\n            ], [[VENDOR, 'ZTE'], MODEL, [TYPE, TABLET]], [\n\n            /android.+[;\\/]\\s*(gen\\d{3})\\s+build.*49h/i                         // Swiss GEN Mobile\n            ], [MODEL, [VENDOR, 'Swiss'], [TYPE, MOBILE]], [\n\n            /android.+[;\\/]\\s*(zur\\d{3})\\s+build/i                              // Swiss ZUR Tablet\n            ], [MODEL, [VENDOR, 'Swiss'], [TYPE, TABLET]], [\n\n            /android.+[;\\/]\\s*((Zeki)?TB.*\\b)\\s+build/i                         // Zeki Tablets\n            ], [MODEL, [VENDOR, 'Zeki'], [TYPE, TABLET]], [\n\n            /(android).+[;\\/]\\s+([YR]\\d{2}x?.*)\\s+build/i,\n            /android.+[;\\/]\\s+(Dragon[\\-\\s]+Touch\\s+|DT)(.+)\\s+build/i          // Dragon Touch Tablet\n            ], [[VENDOR, 'Dragon Touch'], MODEL, [TYPE, TABLET]], [\n\n            /android.+[;\\/]\\s*(NS-?.+)\\s+build/i                                // Insignia Tablets\n            ], [MODEL, [VENDOR, 'Insignia'], [TYPE, TABLET]], [\n\n            /android.+[;\\/]\\s*((NX|Next)-?.+)\\s+build/i                         // NextBook Tablets\n            ], [MODEL, [VENDOR, 'NextBook'], [TYPE, TABLET]], [\n\n            /android.+[;\\/]\\s*(Xtreme\\_?)?(V(1[045]|2[015]|30|40|60|7[05]|90))\\s+build/i\n            ], [[VENDOR, 'Voice'], MODEL, [TYPE, MOBILE]], [                    // Voice Xtreme Phones\n\n            /android.+[;\\/]\\s*(LVTEL\\-?)?(V1[12])\\s+build/i                     // LvTel Phones\n            ], [[VENDOR, 'LvTel'], MODEL, [TYPE, MOBILE]], [\n\n            /android.+[;\\/]\\s*(V(100MD|700NA|7011|917G).*\\b)\\s+build/i          // Envizen Tablets\n            ], [MODEL, [VENDOR, 'Envizen'], [TYPE, TABLET]], [\n\n            /android.+[;\\/]\\s*(Le[\\s\\-]+Pan)[\\s\\-]+(.*\\b)\\s+build/i             // Le Pan Tablets\n            ], [VENDOR, MODEL, [TYPE, TABLET]], [\n\n            /android.+[;\\/]\\s*(Trio[\\s\\-]*.*)\\s+build/i                         // MachSpeed Tablets\n            ], [MODEL, [VENDOR, 'MachSpeed'], [TYPE, TABLET]], [\n\n            /android.+[;\\/]\\s*(Trinity)[\\-\\s]*(T\\d{3})\\s+build/i                // Trinity Tablets\n            ], [VENDOR, MODEL, [TYPE, TABLET]], [\n\n            /android.+[;\\/]\\s*TU_(1491)\\s+build/i                               // Rotor Tablets\n            ], [MODEL, [VENDOR, 'Rotor'], [TYPE, TABLET]], [\n\n            /android.+(KS(.+))\\s+build/i                                        // Amazon Kindle Tablets\n            ], [MODEL, [VENDOR, 'Amazon'], [TYPE, TABLET]], [\n\n            /android.+(Gigaset)[\\s\\-]+(Q.+)\\s+build/i                           // Gigaset Tablets\n            ], [VENDOR, MODEL, [TYPE, TABLET]], [\n\n            /\\s(tablet|tab)[;\\/]/i,                                             // Unidentifiable Tablet\n            /\\s(mobile)(?:[;\\/]|\\ssafari)/i                                     // Unidentifiable Mobile\n            ], [[TYPE, util.lowerize], VENDOR, MODEL], [\n\n            /(android.+)[;\\/].+build/i                                          // Generic Android Device\n            ], [MODEL, [VENDOR, 'Generic']]\n\n\n        /*//////////////////////////\n            // TODO: move to string map\n            ////////////////////////////\n\n            /(C6603)/i                                                          // Sony Xperia Z C6603\n            ], [[MODEL, 'Xperia Z C6603'], [VENDOR, 'Sony'], [TYPE, MOBILE]], [\n            /(C6903)/i                                                          // Sony Xperia Z 1\n            ], [[MODEL, 'Xperia Z 1'], [VENDOR, 'Sony'], [TYPE, MOBILE]], [\n\n            /(SM-G900[F|H])/i                                                   // Samsung Galaxy S5\n            ], [[MODEL, 'Galaxy S5'], [VENDOR, 'Samsung'], [TYPE, MOBILE]], [\n            /(SM-G7102)/i                                                       // Samsung Galaxy Grand 2\n            ], [[MODEL, 'Galaxy Grand 2'], [VENDOR, 'Samsung'], [TYPE, MOBILE]], [\n            /(SM-G530H)/i                                                       // Samsung Galaxy Grand Prime\n            ], [[MODEL, 'Galaxy Grand Prime'], [VENDOR, 'Samsung'], [TYPE, MOBILE]], [\n            /(SM-G313HZ)/i                                                      // Samsung Galaxy V\n            ], [[MODEL, 'Galaxy V'], [VENDOR, 'Samsung'], [TYPE, MOBILE]], [\n            /(SM-T805)/i                                                        // Samsung Galaxy Tab S 10.5\n            ], [[MODEL, 'Galaxy Tab S 10.5'], [VENDOR, 'Samsung'], [TYPE, TABLET]], [\n            /(SM-G800F)/i                                                       // Samsung Galaxy S5 Mini\n            ], [[MODEL, 'Galaxy S5 Mini'], [VENDOR, 'Samsung'], [TYPE, MOBILE]], [\n            /(SM-T311)/i                                                        // Samsung Galaxy Tab 3 8.0\n            ], [[MODEL, 'Galaxy Tab 3 8.0'], [VENDOR, 'Samsung'], [TYPE, TABLET]], [\n\n            /(T3C)/i                                                            // Advan Vandroid T3C\n            ], [MODEL, [VENDOR, 'Advan'], [TYPE, TABLET]], [\n            /(ADVAN T1J\\+)/i                                                    // Advan Vandroid T1J+\n            ], [[MODEL, 'Vandroid T1J+'], [VENDOR, 'Advan'], [TYPE, TABLET]], [\n            /(ADVAN S4A)/i                                                      // Advan Vandroid S4A\n            ], [[MODEL, 'Vandroid S4A'], [VENDOR, 'Advan'], [TYPE, MOBILE]], [\n\n            /(V972M)/i                                                          // ZTE V972M\n            ], [MODEL, [VENDOR, 'ZTE'], [TYPE, MOBILE]], [\n\n            /(i-mobile)\\s(IQ\\s[\\d\\.]+)/i                                        // i-mobile IQ\n            ], [VENDOR, MODEL, [TYPE, MOBILE]], [\n            /(IQ6.3)/i                                                          // i-mobile IQ IQ 6.3\n            ], [[MODEL, 'IQ 6.3'], [VENDOR, 'i-mobile'], [TYPE, MOBILE]], [\n            /(i-mobile)\\s(i-style\\s[\\d\\.]+)/i                                   // i-mobile i-STYLE\n            ], [VENDOR, MODEL, [TYPE, MOBILE]], [\n            /(i-STYLE2.1)/i                                                     // i-mobile i-STYLE 2.1\n            ], [[MODEL, 'i-STYLE 2.1'], [VENDOR, 'i-mobile'], [TYPE, MOBILE]], [\n\n            /(mobiistar touch LAI 512)/i                                        // mobiistar touch LAI 512\n            ], [[MODEL, 'Touch LAI 512'], [VENDOR, 'mobiistar'], [TYPE, MOBILE]], [\n\n            /////////////\n            // END TODO\n            ///////////*/\n\n        ],\n\n        engine : [[\n\n            /windows.+\\sedge\\/([\\w\\.]+)/i                                       // EdgeHTML\n            ], [VERSION, [NAME, 'EdgeHTML']], [\n\n            /(presto)\\/([\\w\\.]+)/i,                                             // Presto\n            /(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\\/([\\w\\.]+)/i,     // WebKit/Trident/NetFront/NetSurf/Amaya/Lynx/w3m\n            /(khtml|tasman|links)[\\/\\s]\\(?([\\w\\.]+)/i,                          // KHTML/Tasman/Links\n            /(icab)[\\/\\s]([23]\\.[\\d\\.]+)/i                                      // iCab\n            ], [NAME, VERSION], [\n\n            /rv\\:([\\w\\.]+).*(gecko)/i                                           // Gecko\n            ], [VERSION, NAME]\n        ],\n\n        os : [[\n\n            // Windows based\n            /microsoft\\s(windows)\\s(vista|xp)/i                                 // Windows (iTunes)\n            ], [NAME, VERSION], [\n            /(windows)\\snt\\s6\\.2;\\s(arm)/i,                                     // Windows RT\n            /(windows\\sphone(?:\\sos)*)[\\s\\/]?([\\d\\.\\s]+\\w)*/i,                  // Windows Phone\n            /(windows\\smobile|windows)[\\s\\/]?([ntce\\d\\.\\s]+\\w)/i\n            ], [NAME, [VERSION, mapper.str, maps.os.windows.version]], [\n            /(win(?=3|9|n)|win\\s9x\\s)([nt\\d\\.]+)/i\n            ], [[NAME, 'Windows'], [VERSION, mapper.str, maps.os.windows.version]], [\n\n            // Mobile/Embedded OS\n            /\\((bb)(10);/i                                                      // BlackBerry 10\n            ], [[NAME, 'BlackBerry'], VERSION], [\n            /(blackberry)\\w*\\/?([\\w\\.]+)*/i,                                    // Blackberry\n            /(tizen)[\\/\\s]([\\w\\.]+)/i,                                          // Tizen\n            /(android|webos|palm\\sos|qnx|bada|rim\\stablet\\sos|meego|contiki)[\\/\\s-]?([\\w\\.]+)*/i,\n                                                                                // Android/WebOS/Palm/QNX/Bada/RIM/MeeGo/Contiki\n            /linux;.+(sailfish);/i                                              // Sailfish OS\n            ], [NAME, VERSION], [\n            /(symbian\\s?os|symbos|s60(?=;))[\\/\\s-]?([\\w\\.]+)*/i                 // Symbian\n            ], [[NAME, 'Symbian'], VERSION], [\n            /\\((series40);/i                                                    // Series 40\n            ], [NAME], [\n            /mozilla.+\\(mobile;.+gecko.+firefox/i                               // Firefox OS\n            ], [[NAME, 'Firefox OS'], VERSION], [\n\n            // Console\n            /(nintendo|playstation)\\s([wids34portablevu]+)/i,                   // Nintendo/Playstation\n\n            // GNU/Linux based\n            /(mint)[\\/\\s\\(]?(\\w+)*/i,                                           // Mint\n            /(mageia|vectorlinux)[;\\s]/i,                                       // Mageia/VectorLinux\n            /(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\\/\\s-]?(?!chrom)([\\w\\.-]+)*/i,\n                                                                                // Joli/Ubuntu/Debian/SUSE/Gentoo/Arch/Slackware\n                                                                                // Fedora/Mandriva/CentOS/PCLinuxOS/RedHat/Zenwalk/Linpus\n            /(hurd|linux)\\s?([\\w\\.]+)*/i,                                       // Hurd/Linux\n            /(gnu)\\s?([\\w\\.]+)*/i                                               // GNU\n            ], [NAME, VERSION], [\n\n            /(cros)\\s[\\w]+\\s([\\w\\.]+\\w)/i                                       // Chromium OS\n            ], [[NAME, 'Chromium OS'], VERSION],[\n\n            // Solaris\n            /(sunos)\\s?([\\w\\.]+\\d)*/i                                           // Solaris\n            ], [[NAME, 'Solaris'], VERSION], [\n\n            // BSD based\n            /\\s([frentopc-]{0,4}bsd|dragonfly)\\s?([\\w\\.]+)*/i                   // FreeBSD/NetBSD/OpenBSD/PC-BSD/DragonFly\n            ], [NAME, VERSION],[\n\n            /(haiku)\\s(\\w+)/i                                                  // Haiku\n            ], [NAME, VERSION],[\n\n            /cfnetwork\\/.+darwin/i,\n            /ip[honead]+(?:.*os\\s([\\w]+)*\\slike\\smac|;\\sopera)/i                // iOS\n            ], [[VERSION, /_/g, '.'], [NAME, 'iOS']], [\n\n            /(mac\\sos\\sx)\\s?([\\w\\s\\.]+\\w)*/i,\n            /(macintosh|mac(?=_powerpc)\\s)/i                                    // Mac OS\n            ], [[NAME, 'Mac OS'], [VERSION, /_/g, '.']], [\n\n            // Other\n            /((?:open)?solaris)[\\/\\s-]?([\\w\\.]+)*/i,                            // Solaris\n            /(aix)\\s((\\d)(?=\\.|\\)|\\s)[\\w\\.]*)*/i,                               // AIX\n            /(plan\\s9|minix|beos|os\\/2|amigaos|morphos|risc\\sos|openvms)/i,\n                                                                                // Plan9/Minix/BeOS/OS2/AmigaOS/MorphOS/RISCOS/OpenVMS\n            /(unix)\\s?([\\w\\.]+)*/i                                              // UNIX\n            ], [NAME, VERSION]\n        ]\n    };\n\n\n    /////////////////\n    // Constructor\n    ////////////////\n\n    var Browser = function (name, version) {\n        this[NAME] = name;\n        this[VERSION] = version;\n    };\n    var CPU = function (arch) {\n        this[ARCHITECTURE] = arch;\n    };\n    var Device = function (vendor, model, type) {\n        this[VENDOR] = vendor;\n        this[MODEL] = model;\n        this[TYPE] = type;\n    };\n    var Engine = Browser;\n    var OS = Browser;\n\n    var UAParser = function (uastring, extensions) {\n\n        if (typeof uastring === 'object') {\n            extensions = uastring;\n            uastring = undefined;\n        }\n\n        if (!(this instanceof UAParser)) {\n            return new UAParser(uastring, extensions).getResult();\n        }\n\n        var ua = uastring || ((window && window.navigator && window.navigator.userAgent) ? window.navigator.userAgent : EMPTY);\n        var rgxmap = extensions ? util.extend(regexes, extensions) : regexes;\n        var browser = new Browser();\n        var cpu = new CPU();\n        var device = new Device();\n        var engine = new Engine();\n        var os = new OS();\n\n        this.getBrowser = function () {\n            mapper.rgx.call(browser, ua, rgxmap.browser);\n            browser.major = util.major(browser.version); // deprecated\n            return browser;\n        };\n        this.getCPU = function () {\n            mapper.rgx.call(cpu, ua, rgxmap.cpu);\n            return cpu;\n        };\n        this.getDevice = function () {\n            mapper.rgx.call(device, ua, rgxmap.device);\n            return device;\n        };\n        this.getEngine = function () {\n            mapper.rgx.call(engine, ua, rgxmap.engine);\n            return engine;\n        };\n        this.getOS = function () {\n            mapper.rgx.call(os, ua, rgxmap.os);\n            return os;\n        };\n        this.getResult = function () {\n            return {\n                ua      : this.getUA(),\n                browser : this.getBrowser(),\n                engine  : this.getEngine(),\n                os      : this.getOS(),\n                device  : this.getDevice(),\n                cpu     : this.getCPU()\n            };\n        };\n        this.getUA = function () {\n            return ua;\n        };\n        this.setUA = function (uastring) {\n            ua = uastring;\n            browser = new Browser();\n            cpu = new CPU();\n            device = new Device();\n            engine = new Engine();\n            os = new OS();\n            return this;\n        };\n        return this;\n    };\n\n    UAParser.VERSION = LIBVERSION;\n    UAParser.BROWSER = {\n        NAME    : NAME,\n        MAJOR   : MAJOR, // deprecated\n        VERSION : VERSION\n    };\n    UAParser.CPU = {\n        ARCHITECTURE : ARCHITECTURE\n    };\n    UAParser.DEVICE = {\n        MODEL   : MODEL,\n        VENDOR  : VENDOR,\n        TYPE    : TYPE,\n        CONSOLE : CONSOLE,\n        MOBILE  : MOBILE,\n        SMARTTV : SMARTTV,\n        TABLET  : TABLET,\n        WEARABLE: WEARABLE,\n        EMBEDDED: EMBEDDED\n    };\n    UAParser.ENGINE = {\n        NAME    : NAME,\n        VERSION : VERSION\n    };\n    UAParser.OS = {\n        NAME    : NAME,\n        VERSION : VERSION\n    };\n    //UAParser.Utils = util;\n\n    ///////////\n    // Export\n    //////////\n\n\n    // check js environment\n    if (typeof(exports) !== UNDEF_TYPE) {\n        // nodejs env\n        if (typeof module !== UNDEF_TYPE && module.exports) {\n            exports = module.exports = UAParser;\n        }\n        exports.UAParser = UAParser;\n    } else {\n        // requirejs env (optional)\n        if (typeof(define) === FUNC_TYPE && define.amd) {\n            define(function () {\n                return UAParser;\n            });\n        } else if (window) {\n            // browser env\n            window.UAParser = UAParser;\n        }\n    }\n\n    // jQuery/Zepto specific (optional)\n    // Note:\n    //   In AMD env the global scope should be kept clean, but jQuery is an exception.\n    //   jQuery always exports to global scope, unless jQuery.noConflict(true) is used,\n    //   and we should catch that.\n    var $ = window && (window.jQuery || window.Zepto);\n    if (typeof $ !== UNDEF_TYPE) {\n        var parser = new UAParser();\n        $.ua = parser.getResult();\n        $.ua.get = function () {\n            return parser.getUA();\n        };\n        $.ua.set = function (uastring) {\n            parser.setUA(uastring);\n            var result = parser.getResult();\n            for (var prop in result) {\n                $.ua[prop] = result[prop];\n            }\n        };\n    }\n\n})(typeof window === 'object' ? window : this);\n","'use strict';\nmodule.exports = function (fn, opts) {\n\topts = opts || {};\n\n\tvar cacheKey = opts.cacheKey || function (x) {\n\t\tif (arguments.length === 1 && (x === null || x === undefined || (typeof x !== 'function' && typeof x !== 'object'))) {\n\t\t\treturn x;\n\t\t}\n\n\t\treturn JSON.stringify(arguments);\n\t};\n\n\tvar memoized = function () {\n\t\tvar cache = memoized.__cache__;\n\t\tvar key = cacheKey.apply(null, arguments);\n\n\t\tif (cache.has(key)) {\n\t\t\tvar c = cache.get(key);\n\n\t\t\tif (typeof opts.maxAge !== 'number' || Date.now() < c.maxAge) {\n\t\t\t\treturn c.data;\n\t\t\t}\n\t\t}\n\n\t\tvar ret = fn.apply(null, arguments);\n\n\t\tcache.set(key, {\n\t\t\tdata: ret,\n\t\t\tmaxAge: Date.now() + (opts.maxAge || 0)\n\t\t});\n\n\t\treturn ret;\n\t};\n\n\tmemoized.displayName = fn.displayName || fn.name;\n\tmemoized.__cache__ = opts.cache || new Map();\n\n\treturn memoized;\n};\n","'use strict';\n\nvar isStream = module.exports = function (stream) {\n\treturn stream !== null && typeof stream === 'object' && typeof stream.pipe === 'function';\n};\n\nisStream.writable = function (stream) {\n\treturn isStream(stream) && stream.writable !== false && typeof stream._write === 'function' && typeof stream._writableState === 'object';\n};\n\nisStream.readable = function (stream) {\n\treturn isStream(stream) && stream.readable !== false && typeof stream._read === 'function' && typeof stream._readableState === 'object';\n};\n\nisStream.duplex = function (stream) {\n\treturn isStream.writable(stream) && isStream.readable(stream);\n};\n\nisStream.transform = function (stream) {\n\treturn isStream.duplex(stream) && typeof stream._transform === 'function' && typeof stream._transformState === 'object';\n};\n","'use strict';\nvar path = require('path');\nvar pathKey = require('path-key');\n\nmodule.exports = function (opts) {\n\topts = opts || {};\n\n\tvar prev;\n\tvar pth = path.resolve(opts.cwd || '.');\n\n\tvar ret = [];\n\n\twhile (prev !== pth) {\n\t\tret.push(path.join(pth, 'node_modules/.bin'));\n\t\tprev = pth;\n\t\tpth = path.resolve(pth, '..');\n\t}\n\n\t// ensure the running `node` binary is used\n\tret.push(path.dirname(process.execPath));\n\n\treturn ret.concat(opts.path || process.env[pathKey()]).join(path.delimiter);\n};\n","'use strict';\nmodule.exports = function (x) {\n\tvar lf = typeof x === 'string' ? '\\n' : '\\n'.charCodeAt();\n\tvar cr = typeof x === 'string' ? '\\r' : '\\r'.charCodeAt();\n\n\tif (x[x.length - 1] === lf) {\n\t\tx = x.slice(0, x.length - 1);\n\t}\n\n\tif (x[x.length - 1] === cr) {\n\t\tx = x.slice(0, x.length - 1);\n\t}\n\n\treturn x;\n};\n","'use strict';\n\nvar isWin = process.platform === 'win32';\n\nfunction notFoundError(command, syscall) {\n    var err;\n\n    err = new Error(syscall + ' ' + command + ' ENOENT');\n    err.code = err.errno = 'ENOENT';\n    err.syscall = syscall + ' ' + command;\n\n    return err;\n}\n\nfunction hookChildProcess(cp, parsed) {\n    var originalEmit;\n\n    if (!isWin) {\n        return;\n    }\n\n    originalEmit = cp.emit;\n    cp.emit = function (name, arg1) {\n        var err;\n\n        // If emitting \"exit\" event and exit code is 1, we need to check if\n        // the command exists and emit an \"error\" instead\n        // See: https://github.com/IndigoUnited/node-cross-spawn/issues/16\n        if (name === 'exit') {\n            err = verifyENOENT(arg1, parsed, 'spawn');\n\n            if (err) {\n                return originalEmit.call(cp, 'error', err);\n            }\n        }\n\n        return originalEmit.apply(cp, arguments);\n    };\n}\n\nfunction verifyENOENT(status, parsed, syscall) {\n    if (isWin && status === 1 && !parsed.file) {\n        return notFoundError(parsed.original, syscall);\n    }\n\n    return null;\n}\n\nmodule.exports.hookChildProcess = hookChildProcess;\nmodule.exports.verifyENOENT = verifyENOENT;\nmodule.exports.notFoundError = notFoundError;\n","module.exports = isexe\nisexe.sync = sync\n\nvar fs = require('fs')\n\nfunction isexe (path, options, cb) {\n  fs.stat(path, function (er, stat) {\n    cb(er, er ? false : checkStat(stat, options))\n  })\n}\n\nfunction sync (path, options) {\n  return checkStat(fs.statSync(path), options)\n}\n\nfunction checkStat (stat, options) {\n  return stat.isFile() && checkMode(stat, options)\n}\n\nfunction checkMode (stat, options) {\n  var mod = stat.mode\n  var uid = stat.uid\n  var gid = stat.gid\n\n  var myUid = options.uid !== undefined ?\n    options.uid : process.getuid && process.getuid()\n  var myGid = options.gid !== undefined ?\n    options.gid : process.getgid && process.getgid()\n\n  var u = parseInt('100', 8)\n  var g = parseInt('010', 8)\n  var o = parseInt('001', 8)\n  var ug = u | g\n\n  var ret = (mod & o) ||\n    (mod & g) && gid === myGid ||\n    (mod & u) && uid === myUid ||\n    (mod & ug) && myUid === 0\n\n  return ret\n}\n","module.exports = isexe\nisexe.sync = sync\n\nvar fs = require('fs')\n\nfunction checkPathExt (path, options) {\n  var pathext = options.pathExt !== undefined ?\n    options.pathExt : process.env.PATHEXT\n\n  if (!pathext) {\n    return true\n  }\n\n  pathext = pathext.split(';')\n  if (pathext.indexOf('') !== -1) {\n    return true\n  }\n  for (var i = 0; i < pathext.length; i++) {\n    var p = pathext[i].toLowerCase()\n    if (p && path.substr(-p.length).toLowerCase() === p) {\n      return true\n    }\n  }\n  return false\n}\n\nfunction checkStat (stat, path, options) {\n  if (!stat.isSymbolicLink() && !stat.isFile()) {\n    return false\n  }\n  return checkPathExt(path, options)\n}\n\nfunction isexe (path, options, cb) {\n  fs.stat(path, function (er, stat) {\n    cb(er, er ? false : checkStat(stat, path, options))\n  })\n}\n\nfunction sync (path, options) {\n  return checkStat(fs.statSync(path), path, options)\n}\n","var fs = require('fs')\nvar core\nif (process.platform === 'win32' || global.TESTING_WINDOWS) {\n  core = require('./windows.js')\n} else {\n  core = require('./mode.js')\n}\n\nmodule.exports = isexe\nisexe.sync = sync\n\nfunction isexe (path, options, cb) {\n  if (typeof options === 'function') {\n    cb = options\n    options = {}\n  }\n\n  if (!cb) {\n    if (typeof Promise !== 'function') {\n      throw new TypeError('callback not provided')\n    }\n\n    return new Promise(function (resolve, reject) {\n      isexe(path, options || {}, function (er, is) {\n        if (er) {\n          reject(er)\n        } else {\n          resolve(is)\n        }\n      })\n    })\n  }\n\n  core(path, options || {}, function (er, is) {\n    // ignore EACCES because that just means we aren't allowed to run it\n    if (er) {\n      if (er.code === 'EACCES' || options && options.ignoreErrors) {\n        er = null\n        is = false\n      }\n    }\n    cb(er, is)\n  })\n}\n\nfunction sync (path, options) {\n  // my kingdom for a filtered catch\n  try {\n    return core.sync(path, options || {})\n  } catch (er) {\n    if (options && options.ignoreErrors || er.code === 'EACCES') {\n      return false\n    } else {\n      throw er\n    }\n  }\n}\n","module.exports = which\nwhich.sync = whichSync\n\nvar isWindows = process.platform === 'win32' ||\n    process.env.OSTYPE === 'cygwin' ||\n    process.env.OSTYPE === 'msys'\n\nvar path = require('path')\nvar COLON = isWindows ? ';' : ':'\nvar isexe = require('isexe')\n\nfunction getNotFoundError (cmd) {\n  var er = new Error('not found: ' + cmd)\n  er.code = 'ENOENT'\n\n  return er\n}\n\nfunction getPathInfo (cmd, opt) {\n  var colon = opt.colon || COLON\n  var pathEnv = opt.path || process.env.PATH || ''\n  var pathExt = ['']\n\n  pathEnv = pathEnv.split(colon)\n\n  var pathExtExe = ''\n  if (isWindows) {\n    pathEnv.unshift(process.cwd())\n    pathExtExe = (opt.pathExt || process.env.PATHEXT || '.EXE;.CMD;.BAT;.COM')\n    pathExt = pathExtExe.split(colon)\n\n\n    // Always test the cmd itself first.  isexe will check to make sure\n    // it's found in the pathExt set.\n    if (cmd.indexOf('.') !== -1 && pathExt[0] !== '')\n      pathExt.unshift('')\n  }\n\n  // If it has a slash, then we don't bother searching the pathenv.\n  // just check the file itself, and that's it.\n  if (cmd.match(/\\//) || isWindows && cmd.match(/\\\\/))\n    pathEnv = ['']\n\n  return {\n    env: pathEnv,\n    ext: pathExt,\n    extExe: pathExtExe\n  }\n}\n\nfunction which (cmd, opt, cb) {\n  if (typeof opt === 'function') {\n    cb = opt\n    opt = {}\n  }\n\n  var info = getPathInfo(cmd, opt)\n  var pathEnv = info.env\n  var pathExt = info.ext\n  var pathExtExe = info.extExe\n  var found = []\n\n  ;(function F (i, l) {\n    if (i === l) {\n      if (opt.all && found.length)\n        return cb(null, found)\n      else\n        return cb(getNotFoundError(cmd))\n    }\n\n    var pathPart = pathEnv[i]\n    if (pathPart.charAt(0) === '\"' && pathPart.slice(-1) === '\"')\n      pathPart = pathPart.slice(1, -1)\n\n    var p = path.join(pathPart, cmd)\n    if (!pathPart && (/^\\.[\\\\\\/]/).test(cmd)) {\n      p = cmd.slice(0, 2) + p\n    }\n    ;(function E (ii, ll) {\n      if (ii === ll) return F(i + 1, l)\n      var ext = pathExt[ii]\n      isexe(p + ext, { pathExt: pathExtExe }, function (er, is) {\n        if (!er && is) {\n          if (opt.all)\n            found.push(p + ext)\n          else\n            return cb(null, p + ext)\n        }\n        return E(ii + 1, ll)\n      })\n    })(0, pathExt.length)\n  })(0, pathEnv.length)\n}\n\nfunction whichSync (cmd, opt) {\n  opt = opt || {}\n\n  var info = getPathInfo(cmd, opt)\n  var pathEnv = info.env\n  var pathExt = info.ext\n  var pathExtExe = info.extExe\n  var found = []\n\n  for (var i = 0, l = pathEnv.length; i < l; i ++) {\n    var pathPart = pathEnv[i]\n    if (pathPart.charAt(0) === '\"' && pathPart.slice(-1) === '\"')\n      pathPart = pathPart.slice(1, -1)\n\n    var p = path.join(pathPart, cmd)\n    if (!pathPart && /^\\.[\\\\\\/]/.test(cmd)) {\n      p = cmd.slice(0, 2) + p\n    }\n    for (var j = 0, ll = pathExt.length; j < ll; j ++) {\n      var cur = p + pathExt[j]\n      var is\n      try {\n        is = isexe.sync(cur, { pathExt: pathExtExe })\n        if (is) {\n          if (opt.all)\n            found.push(cur)\n          else\n            return cur\n        }\n      } catch (ex) {}\n    }\n  }\n\n  if (opt.all && found.length)\n    return found\n\n  if (opt.nothrow)\n    return null\n\n  throw getNotFoundError(cmd)\n}\n","'use strict';\n\nvar path = require('path');\nvar which = require('which');\nvar LRU = require('lru-cache');\n\nvar commandCache = new LRU({ max: 50, maxAge: 30 * 1000 });  // Cache just for 30sec\nvar hasSepInPathRegExp = new RegExp(process.platform === 'win32' ? /[\\/\\\\]/ : /\\//);\n\nfunction resolveCommand(command, noExtension) {\n    var resolved;\n\n    // If command looks like a file path, make it absolute to make it canonical\n    // and also to circuvent a bug in which, see: https://github.com/npm/node-which/issues/33\n    if (hasSepInPathRegExp.test(command)) {\n        command = path.resolve(command);\n    }\n\n    noExtension = !!noExtension;\n    resolved = commandCache.get(command + '!' + noExtension);\n\n    // Check if its resolved in the cache\n    if (commandCache.has(command)) {\n        return commandCache.get(command);\n    }\n\n    try {\n        resolved = !noExtension ?\n            which.sync(command) :\n            which.sync(command, { pathExt: path.delimiter + (process.env.PATHEXT || '') });\n    } catch (e) { /* empty */ }\n\n    commandCache.set(command + '!' + noExtension, resolved);\n\n    return resolved;\n}\n\nmodule.exports = resolveCommand;\n","'use strict'\nvar Yallist = require('./yallist.js')\n\nYallist.prototype[Symbol.iterator] = function* () {\n  for (let walker = this.head; walker; walker = walker.next) {\n    yield walker.value\n  }\n}\n","var hasOwnProperty = Object.prototype.hasOwnProperty\n\nmodule.exports = PseudoMap\n\nfunction PseudoMap (set) {\n  if (!(this instanceof PseudoMap)) // whyyyyyyy\n    throw new TypeError(\"Constructor PseudoMap requires 'new'\")\n\n  this.clear()\n\n  if (set) {\n    if ((set instanceof PseudoMap) ||\n        (typeof Map === 'function' && set instanceof Map))\n      set.forEach(function (value, key) {\n        this.set(key, value)\n      }, this)\n    else if (Array.isArray(set))\n      set.forEach(function (kv) {\n        this.set(kv[0], kv[1])\n      }, this)\n    else\n      throw new TypeError('invalid argument')\n  }\n}\n\nPseudoMap.prototype.forEach = function (fn, thisp) {\n  thisp = thisp || this\n  Object.keys(this._data).forEach(function (k) {\n    if (k !== 'size')\n      fn.call(thisp, this._data[k].value, this._data[k].key)\n  }, this)\n}\n\nPseudoMap.prototype.has = function (k) {\n  return !!find(this._data, k)\n}\n\nPseudoMap.prototype.get = function (k) {\n  var res = find(this._data, k)\n  return res && res.value\n}\n\nPseudoMap.prototype.set = function (k, v) {\n  set(this._data, k, v)\n}\n\nPseudoMap.prototype.delete = function (k) {\n  var res = find(this._data, k)\n  if (res) {\n    delete this._data[res._index]\n    this._data.size--\n  }\n}\n\nPseudoMap.prototype.clear = function () {\n  var data = Object.create(null)\n  data.size = 0\n\n  Object.defineProperty(this, '_data', {\n    value: data,\n    enumerable: false,\n    configurable: true,\n    writable: false\n  })\n}\n\nObject.defineProperty(PseudoMap.prototype, 'size', {\n  get: function () {\n    return this._data.size\n  },\n  set: function (n) {},\n  enumerable: true,\n  configurable: true\n})\n\nPseudoMap.prototype.values =\nPseudoMap.prototype.keys =\nPseudoMap.prototype.entries = function () {\n  throw new Error('iterators are not implemented in this version')\n}\n\n// Either identical, or both NaN\nfunction same (a, b) {\n  return a === b || a !== a && b !== b\n}\n\nfunction Entry (k, v, i) {\n  this.key = k\n  this.value = v\n  this._index = i\n}\n\nfunction find (data, k) {\n  for (var i = 0, s = '_' + k, key = s;\n       hasOwnProperty.call(data, key);\n       key = s + i++) {\n    if (same(data[key].key, k))\n      return data[key]\n  }\n}\n\nfunction set (data, k, v) {\n  for (var i = 0, s = '_' + k, key = s;\n       hasOwnProperty.call(data, key);\n       key = s + i++) {\n    if (same(data[key].key, k)) {\n      data[key].value = v\n      return\n    }\n  }\n  data.size++\n  data[key] = new Entry(k, v, key)\n}\n","if (process.env.npm_package_name === 'pseudomap' &&\n    process.env.npm_lifecycle_script === 'test')\n  process.env.TEST_PSEUDOMAP = 'true'\n\nif (typeof Map === 'function' && !process.env.TEST_PSEUDOMAP) {\n  module.exports = Map\n} else {\n  module.exports = require('./pseudomap')\n}\n","'use strict';\n\nvar fs = require('fs');\nvar LRU = require('lru-cache');\nvar resolveCommand = require('./resolveCommand');\n\nvar isWin = process.platform === 'win32';\nvar shebangCache = new LRU({ max: 50, maxAge: 30 * 1000 });  // Cache just for 30sec\n\nfunction readShebang(command) {\n    var buffer;\n    var fd;\n    var match;\n    var shebang;\n\n    // Check if it is in the cache first\n    if (shebangCache.has(command)) {\n        return shebangCache.get(command);\n    }\n\n    // Read the first 150 bytes from the file\n    buffer = new Buffer(150);\n\n    try {\n        fd = fs.openSync(command, 'r');\n        fs.readSync(fd, buffer, 0, 150, 0);\n        fs.closeSync(fd);\n    } catch (e) { /* empty */ }\n\n    // Check if it is a shebang\n    match = buffer.toString().trim().match(/#!(.+)/i);\n\n    if (match) {\n        shebang = match[1].replace(/\\/usr\\/bin\\/env\\s+/i, '');   // Remove /usr/bin/env\n    }\n\n    // Store the shebang in the cache\n    shebangCache.set(command, shebang);\n\n    return shebang;\n}\n\nfunction escapeArg(arg, quote) {\n    // Convert to string\n    arg = '' + arg;\n\n    // If we are not going to quote the argument,\n    // escape shell metacharacters, including double and single quotes:\n    if (!quote) {\n        arg = arg.replace(/([\\(\\)%!\\^<>&|;,\"'\\s])/g, '^$1');\n    } else {\n        // Sequence of backslashes followed by a double quote:\n        // double up all the backslashes and escape the double quote\n        arg = arg.replace(/(\\\\*)\"/g, '$1$1\\\\\"');\n\n        // Sequence of backslashes followed by the end of the string\n        // (which will become a double quote later):\n        // double up all the backslashes\n        arg = arg.replace(/(\\\\*)$/, '$1$1');\n\n        // All other backslashes occur literally\n\n        // Quote the whole thing:\n        arg = '\"' + arg + '\"';\n    }\n\n    return arg;\n}\n\nfunction escapeCommand(command) {\n    // Do not escape if this command is not dangerous..\n    // We do this so that commands like \"echo\" or \"ifconfig\" work\n    // Quoting them, will make them unaccessible\n    return /^[a-z0-9_-]+$/i.test(command) ? command : escapeArg(command, true);\n}\n\nfunction parse(command, args, options) {\n    var shebang;\n    var applyQuotes;\n    var file;\n    var original;\n\n    // Normalize arguments, similar to nodejs\n    if (args && !Array.isArray(args)) {\n        options = args;\n        args = null;\n    }\n\n    args = args ? args.slice(0) : [];  // Clone array to avoid changing the original\n    options = options || {};\n    original = command;\n\n    if (isWin) {\n        // Detect & add support for shebangs\n        file = resolveCommand(command);\n        file = file || resolveCommand(command, true);\n        shebang = file && readShebang(file);\n\n        if (shebang) {\n            args.unshift(file);\n            command = shebang;\n        }\n\n        // Escape command & arguments\n        applyQuotes = command !== 'echo';  // Do not quote arguments for the special \"echo\" command\n        command = escapeCommand(command);\n        args = args.map(function (arg) {\n            return escapeArg(arg, applyQuotes);\n        });\n\n        // Use cmd.exe\n        args = ['/s', '/c', '\"' + command + (args.length ? ' ' + args.join(' ') : '') + '\"'];\n        command = process.env.comspec || 'cmd.exe';\n\n        // Tell node's spawn that the arguments are already escaped\n        options.windowsVerbatimArguments = true;\n    }\n\n    return {\n        command: command,\n        args: args,\n        options: options,\n        file: file,\n        original: original,\n    };\n}\n\nmodule.exports = parse;\n","'use strict';\n\nvar cp = require('child_process');\nvar parse = require('./lib/parse');\nvar enoent = require('./lib/enoent');\n\nfunction spawn(command, args, options) {\n    var parsed;\n    var spawned;\n\n    // Parse the arguments\n    parsed = parse(command, args, options);\n\n    // Spawn the child process\n    spawned = cp.spawn(parsed.command, parsed.args, parsed.options);\n\n    // Hook into child process \"exit\" event to emit an error if the command\n    // does not exists, see: https://github.com/IndigoUnited/node-cross-spawn/issues/16\n    enoent.hookChildProcess(spawned, parsed);\n\n    return spawned;\n}\n\nmodule.exports = spawn;\nmodule.exports.spawn = spawn;\nmodule.exports._parse = parse;\nmodule.exports._enoent = enoent;\n","'use strict';\nconst os = require('os');\nconst execa = require('execa');\nconst mem = require('mem');\n\nfunction getEnvVar() {\n\tconst env = process.env;\n\n\treturn env.SUDO_USER ||\n\t\tenv.C9_USER /* Cloud9 */ ||\n\t\tenv.LOGNAME ||\n\t\tenv.USER ||\n\t\tenv.LNAME ||\n\t\tenv.USERNAME;\n}\n\nfunction cleanWinCmd(x) {\n\treturn x.replace(/^.*\\\\/, '');\n}\n\nfunction noop() {}\n\nmodule.exports = mem(() => {\n\tif (os.userInfo) {\n\t\treturn Promise.resolve(os.userInfo().username);\n\t}\n\n\tconst envVar = getEnvVar();\n\n\tif (envVar) {\n\t\treturn Promise.resolve(envVar);\n\t}\n\n\tif (process.platform === 'darwin' || process.platform === 'linux') {\n\t\treturn execa('id', ['-un']).then(x => x.stdout).catch(noop);\n\t} else if (process.platform === 'win32') {\n\t\treturn execa('whoami').then(x => cleanWinCmd(x.stdout)).catch(noop);\n\t}\n\n\treturn Promise.resolve();\n});\n\nmodule.exports.sync = mem(() => {\n\tif (os.userInfo) {\n\t\treturn os.userInfo().username;\n\t}\n\n\tconst envVar = getEnvVar();\n\n\tif (envVar) {\n\t\treturn envVar;\n\t}\n\n\ttry {\n\t\tif (process.platform === 'darwin' || process.platform === 'linux') {\n\t\t\treturn execa.sync('id', ['-un']).stdout;\n\t\t} else if (process.platform === 'win32') {\n\t\t\treturn cleanWinCmd(execa.sync('whoami').stdout);\n\t\t}\n\t} catch (err) {}\n});\n","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex;\n  return bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]];\n}\n\nmodule.exports = bytesToUuid;\n","// Unique ID creation requires a high quality random # generator.  In node.js\n// this is pretty straight-forward - we use the crypto API.\n\nvar rb = require('crypto').randomBytes;\n\nfunction rng() {\n  return rb(16);\n}\n\nmodule.exports = rng;\n","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof(options) == 'string') {\n    buf = options == 'binary' ? new Array(16) : null;\n    options = null;\n  }\n  options = options || {};\n\n  var rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = (rnds[6] & 0x0f) | 0x40;\n  rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nmodule.exports = v4;\n","import * as appProxy from '../ui/lib/app-proxy'\n\n/** The HTTP methods available. */\nexport type HTTPMethod = 'GET' | 'POST' | 'PUT' | 'HEAD'\n\n/**\n * The structure of error messages returned from the GitHub API.\n *\n * Details: https://developer.github.com/v3/#client-errors\n */\nexport interface IError {\n  readonly message: string\n  readonly resource: string\n  readonly field: string\n}\n\n/**\n * The partial server response when an error has been returned.\n *\n * Details: https://developer.github.com/v3/#client-errors\n */\nexport interface IAPIError {\n  readonly errors?: IError[]\n  readonly message?: string\n}\n\n/** An error from getting an unexpected response to an API call. */\nexport class APIError extends Error {\n  /** The error as sent from the API, if one could be parsed. */\n  public readonly apiError: IAPIError | null\n\n  public constructor(response: Response, apiError: IAPIError | null) {\n    let message\n    if (apiError && apiError.message) {\n      message = apiError.message\n\n      const errors = apiError.errors\n      const additionalMessages = errors && errors.map(e => e.message).join(', ')\n      if (additionalMessages) {\n        message = `${message} (${additionalMessages})`\n      }\n    } else {\n      message = `API error ${response.url}: ${response.statusText} (${\n        response.status\n      })`\n    }\n\n    super(message)\n\n    this.apiError = apiError\n  }\n}\n\n/**\n * Deserialize the HTTP response body into an expected object shape\n *\n * Note: this doesn't validate the expected shape, and will only fail if it\n * encounters invalid JSON.\n */\nasync function deserialize<T>(response: Response): Promise<T> {\n  try {\n    const json = await response.json()\n    return json as T\n  } catch (e) {\n    const contentLength = response.headers.get('Content-Length') || '(missing)'\n    const requestId = response.headers.get('X-GitHub-Request-Id') || '(missing)'\n    log.warn(\n      `deserialize: invalid JSON found at '${response.url}' - status: ${\n        response.status\n      }, length: '${contentLength}' id: '${requestId}'`,\n      e\n    )\n    throw e\n  }\n}\n\n/**\n * Convert the endpoint and resource path into an absolute URL. As the app bakes\n * the `/api/v3/` path into the endpoint, we need to prevent duplicating this when\n * the API returns pagination headers that also include the `/api/v3/` fragment.\n *\n * @param endpoint The API endpoint\n * @param path The resource path (should be relative to the root of the server)\n */\nexport function getAbsoluteUrl(endpoint: string, path: string): string {\n  let relativePath = path[0] === '/' ? path.substr(1) : path\n  if (relativePath.startsWith('api/v3/')) {\n    relativePath = relativePath.substr(7)\n  }\n  return encodeURI(`${endpoint}/${relativePath}`)\n}\n\n/**\n * Make an API request.\n *\n * @param endpoint      - The API endpoint.\n * @param token         - The token to use for authentication.\n * @param method        - The HTTP method.\n * @param path          - The path, including any query string parameters.\n * @param jsonBody      - The JSON body to send.\n * @param customHeaders - Any optional additional headers to send.\n */\nexport function request(\n  endpoint: string,\n  token: string | null,\n  method: HTTPMethod,\n  path: string,\n  jsonBody?: Object,\n  customHeaders?: Object\n): Promise<Response> {\n  const url = getAbsoluteUrl(endpoint, path)\n\n  let headers: any = {\n    Accept: 'application/vnd.github.v3+json, application/json',\n    'Content-Type': 'application/json',\n    'User-Agent': getUserAgent(),\n  }\n\n  if (token) {\n    headers['Authorization'] = `token ${token}`\n  }\n\n  headers = {\n    ...headers,\n    ...customHeaders,\n  }\n\n  const options = {\n    headers,\n    method,\n    body: JSON.stringify(jsonBody),\n  }\n\n  return fetch(url, options)\n}\n\n/** Get the user agent to use for all requests. */\nfunction getUserAgent() {\n  const platform = __DARWIN__ ? 'Macintosh' : 'Windows'\n  return `GitHubDesktop/${appProxy.getVersion()} (${platform})`\n}\n\n/**\n * If the response was OK, parse it as JSON and return the result. If not, parse\n * the API error and throw it.\n */\nexport async function parsedResponse<T>(response: Response): Promise<T> {\n  if (response.ok) {\n    return deserialize<T>(response)\n  } else {\n    let apiError: IAPIError | null\n    // Deserializing the API error could throw. If it does, we'll throw a more\n    // general API error.\n    try {\n      apiError = await deserialize<IAPIError>(response)\n    } catch (e) {\n      throw new APIError(response, null)\n    }\n\n    throw new APIError(response, apiError)\n  }\n}\n\n/**\n * Appends the parameters provided to the url as query string parameters.\n *\n * If the url already has a query the new parameters will be appended.\n */\nexport function urlWithQueryString(\n  url: string,\n  params: { [key: string]: string }\n): string {\n  const qs = Object.keys(params)\n    .map(key => `${key}=${encodeURIComponent(params[key])}`)\n    .join('&')\n\n  if (!qs.length) {\n    return url\n  }\n\n  if (url.indexOf('?') === -1) {\n    return `${url}?${qs}`\n  } else {\n    return `${url}&${qs}`\n  }\n}\n","function getFeatureOverride(\n  featureName: string,\n  defaultValue: boolean\n): boolean {\n  const override = localStorage.getItem(`features/${featureName}`)\n\n  if (override) {\n    if (override === '1' || override === 'true') {\n      return true\n    } else if (override === '0' || override === 'false') {\n      return false\n    }\n  }\n\n  return defaultValue\n}\n\nfunction featureFlag(\n  featureName: string,\n  defaultValue: boolean,\n  memoize: boolean\n): () => boolean {\n  const getter = () => getFeatureOverride(featureName, defaultValue)\n\n  if (memoize) {\n    const value = getter()\n    return () => value\n  } else {\n    return getter\n  }\n}\n\n/**\n * Gets a value indicating whether the renderer should be responsible for\n * rendering an application menu.\n *\n * Can be overriden with the localStorage variable\n *\n *  features/should-render-application-menu\n *\n * Default: false on macOS, true on other platforms.\n */\nexport const shouldRenderApplicationMenu = featureFlag(\n  'should-render-application-menu',\n  __DARWIN__ ? false : true,\n  true\n)\n","import * as moment from 'moment'\n\nimport {\n  ReleaseMetadata,\n  ReleaseNote,\n  ReleaseSummary,\n} from '../models/release-notes'\n\n// expects a release note entry to contain a header and then some text\n// example:\n//    [New] Fallback to Gravatar for loading avatars - #821\nconst itemEntryRe = /^\\[([a-z]{1,})\\]\\s(.*)/i\n\nfunction parseEntry(note: string): ReleaseNote | null {\n  const text = note.trim()\n  const match = itemEntryRe.exec(text)\n  if (match === null) {\n    log.debug(`[ReleaseNotes] unable to convert text into entry: ${note}`)\n    return null\n  }\n\n  const kind = match[1].toLowerCase()\n  const message = match[2]\n  if (\n    kind === 'new' ||\n    kind === 'fixed' ||\n    kind === 'improved' ||\n    kind === 'added' ||\n    kind === 'pretext' ||\n    kind === 'removed'\n  ) {\n    return { kind, message }\n  }\n\n  log.debug(`[ReleaseNotes] kind ${kind} was found but is not a valid entry`)\n\n  return {\n    kind: 'other',\n    message,\n  }\n}\n\n/**\n * A filter function with type predicate to return non-null and non-undefined\n * entries while also satisfying the TS compiler\n *\n * Source: https://stackoverflow.com/a/46700791/1363815\n */\nfunction notEmpty<TValue>(value: TValue | null | undefined): value is TValue {\n  return value !== null && value !== undefined\n}\n\nexport function parseReleaseEntries(\n  notes: ReadonlyArray<string>\n): ReadonlyArray<ReleaseNote> {\n  return notes.map(n => parseEntry(n)).filter(notEmpty)\n}\n\nexport function getReleaseSummary(\n  latestRelease: ReleaseMetadata\n): ReleaseSummary {\n  const entries = parseReleaseEntries(latestRelease.notes)\n\n  const enhancements = entries.filter(\n    e => e.kind === 'new' || e.kind === 'added' || e.kind === 'improved'\n  )\n  const bugfixes = entries.filter(e => e.kind === 'fixed')\n  const other = entries.filter(e => e.kind === 'removed' || e.kind === 'other')\n\n  const datePublished = moment(latestRelease.pub_date).format('MMMM Do YYYY')\n\n  return {\n    latestVersion: latestRelease.version,\n    datePublished,\n    // TODO: find pretext entry\n    pretext: undefined,\n    enhancements,\n    bugfixes,\n    other,\n  }\n}\n\nasync function getChangeLog(): Promise<ReadonlyArray<ReleaseMetadata>> {\n  const changelog =\n    'https://central.github.com/deployments/desktop/desktop/changelog.json'\n  const query = __RELEASE_CHANNEL__ === 'beta' ? '?env=beta' : ''\n\n  const response = await fetch(`${changelog}${query}`)\n  if (response.ok) {\n    const releases: ReadonlyArray<ReleaseMetadata> = await response.json()\n    return releases\n  } else {\n    return []\n  }\n}\n\nexport async function generateReleaseSummary(): Promise<ReleaseSummary> {\n  const releases = await getChangeLog()\n  const latestRelease = releases[0]\n  return getReleaseSummary(latestRelease)\n}\n","// an error that Electron raises when it can't find the installation for the running app\nconst squirrelMissingRegex = /^Can not find Squirrel$/\n\n// an error that occurs when Squirrel isn't able to reach the update server\nconst squirrelDNSRegex = /System\\.Net\\.WebException: The remote name could not be resolved: 'central\\.github\\.com'/\n\n// an error that occurs when the connection times out during updating\nconst squirrelTimeoutRegex = /A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond/\n\n/**\n * This method parses known error messages from Squirrel.Windows and returns a\n * friendier message to the user.\n *\n * @param error The underlying error from Squirrel.\n *\n */\nexport function parseError(error: Error): Error | null {\n  if (squirrelMissingRegex.test(error.message)) {\n    return new Error(\n      'The application is missing a dependency it needs to check and install updates. This is very, very bad.'\n    )\n  }\n  if (squirrelDNSRegex.test(error.message)) {\n    return new Error(\n      'GitHub Desktop was not able to contact the update server. Ensure you have internet connectivity and try again.'\n    )\n  }\n  if (squirrelTimeoutRegex.test(error.message)) {\n    return new Error(\n      'GitHub Desktop was not able to check for updates due to a timeout. Ensure you have internet connectivity and try again.'\n    )\n  }\n\n  return null\n}\n","(function() {\n  var CompositeDisposable, Disposable, assertDisposable;\n\n  Disposable = null;\n\n  module.exports = CompositeDisposable = (function() {\n    CompositeDisposable.prototype.disposed = false;\n\n\n    /*\n    Section: Construction and Destruction\n     */\n\n    function CompositeDisposable() {\n      var disposable, _i, _len;\n      this.disposables = new Set;\n      for (_i = 0, _len = arguments.length; _i < _len; _i++) {\n        disposable = arguments[_i];\n        this.add(disposable);\n      }\n    }\n\n    CompositeDisposable.prototype.dispose = function() {\n      if (!this.disposed) {\n        this.disposed = true;\n        this.disposables.forEach(function(disposable) {\n          return disposable.dispose();\n        });\n        this.disposables = null;\n      }\n    };\n\n\n    /*\n    Section: Managing Disposables\n     */\n\n    CompositeDisposable.prototype.add = function() {\n      var disposable, _i, _len;\n      if (!this.disposed) {\n        for (_i = 0, _len = arguments.length; _i < _len; _i += 1) {\n          disposable = arguments[_i];\n          assertDisposable(disposable);\n          this.disposables.add(disposable);\n        }\n      }\n    };\n\n    CompositeDisposable.prototype.remove = function(disposable) {\n      if (!this.disposed) {\n        this.disposables[\"delete\"](disposable);\n      }\n    };\n\n    CompositeDisposable.prototype[\"delete\"] = function(disposable) {\n      this.remove(disposable);\n    };\n\n    CompositeDisposable.prototype.clear = function() {\n      if (!this.disposed) {\n        this.disposables.clear();\n      }\n    };\n\n    return CompositeDisposable;\n\n  })();\n\n  assertDisposable = function(disposable) {\n    if (Disposable == null) {\n      Disposable = require('./disposable');\n    }\n    if (!Disposable.isDisposable(disposable)) {\n      throw new TypeError('Arguments to CompositeDisposable.add must have a .dispose() method');\n    }\n  };\n\n}).call(this);\n","(function() {\n  var Disposable, Emitter;\n\n  Disposable = require('./disposable');\n\n  module.exports = Emitter = (function() {\n    Emitter.exceptionHandlers = [];\n\n    Emitter.onEventHandlerException = function(exceptionHandler) {\n      if (this.exceptionHandlers.length === 0) {\n        this.dispatch = this.exceptionHandlingDispatch;\n      }\n      this.exceptionHandlers.push(exceptionHandler);\n      return new Disposable((function(_this) {\n        return function() {\n          _this.exceptionHandlers.splice(_this.exceptionHandlers.indexOf(exceptionHandler), 1);\n          if (_this.exceptionHandlers.length === 0) {\n            return _this.dispatch = _this.simpleDispatch;\n          }\n        };\n      })(this));\n    };\n\n    Emitter.simpleDispatch = function(handler, value) {\n      return handler(value);\n    };\n\n    Emitter.exceptionHandlingDispatch = function(handler, value) {\n      var exception, exceptionHandler, _i, _len, _ref, _results;\n      try {\n        return handler(value);\n      } catch (_error) {\n        exception = _error;\n        _ref = this.exceptionHandlers;\n        _results = [];\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n          exceptionHandler = _ref[_i];\n          _results.push(exceptionHandler(exception));\n        }\n        return _results;\n      }\n    };\n\n    Emitter.dispatch = Emitter.simpleDispatch;\n\n    Emitter.prototype.disposed = false;\n\n\n    /*\n    Section: Construction and Destruction\n     */\n\n    function Emitter() {\n      this.clear();\n    }\n\n    Emitter.prototype.clear = function() {\n      return this.handlersByEventName = {};\n    };\n\n    Emitter.prototype.dispose = function() {\n      this.handlersByEventName = null;\n      return this.disposed = true;\n    };\n\n\n    /*\n    Section: Event Subscription\n     */\n\n    Emitter.prototype.on = function(eventName, handler, unshift) {\n      var currentHandlers;\n      if (unshift == null) {\n        unshift = false;\n      }\n      if (this.disposed) {\n        throw new Error(\"Emitter has been disposed\");\n      }\n      if (typeof handler !== 'function') {\n        throw new Error(\"Handler must be a function\");\n      }\n      if (currentHandlers = this.handlersByEventName[eventName]) {\n        if (unshift) {\n          this.handlersByEventName[eventName] = [handler].concat(currentHandlers);\n        } else {\n          this.handlersByEventName[eventName] = currentHandlers.concat(handler);\n        }\n      } else {\n        this.handlersByEventName[eventName] = [handler];\n      }\n      return new Disposable(this.off.bind(this, eventName, handler));\n    };\n\n    Emitter.prototype.once = function(eventName, handler, unshift) {\n      var disposable, wrapped;\n      if (unshift == null) {\n        unshift = false;\n      }\n      wrapped = function(value) {\n        disposable.dispose();\n        return handler(value);\n      };\n      return disposable = this.on(eventName, wrapped, unshift);\n    };\n\n    Emitter.prototype.preempt = function(eventName, handler) {\n      return this.on(eventName, handler, true);\n    };\n\n    Emitter.prototype.off = function(eventName, handlerToRemove) {\n      var handler, newHandlers, oldHandlers, _i, _len;\n      if (this.disposed) {\n        return;\n      }\n      if (oldHandlers = this.handlersByEventName[eventName]) {\n        newHandlers = [];\n        for (_i = 0, _len = oldHandlers.length; _i < _len; _i++) {\n          handler = oldHandlers[_i];\n          if (handler !== handlerToRemove) {\n            newHandlers.push(handler);\n          }\n        }\n        if (newHandlers.length > 0) {\n          this.handlersByEventName[eventName] = newHandlers;\n        } else {\n          delete this.handlersByEventName[eventName];\n        }\n      }\n    };\n\n\n    /*\n    Section: Event Emission\n     */\n\n    Emitter.prototype.emit = function(eventName, value) {\n      var handler, handlers, _i, _len, _ref;\n      if (handlers = (_ref = this.handlersByEventName) != null ? _ref[eventName] : void 0) {\n        for (_i = 0, _len = handlers.length; _i < _len; _i++) {\n          handler = handlers[_i];\n          this.constructor.dispatch(handler, value);\n        }\n      }\n    };\n\n    Emitter.prototype.emitAsync = function(eventName, value) {\n      var handler, handlers, promises, _ref;\n      if (handlers = (_ref = this.handlersByEventName) != null ? _ref[eventName] : void 0) {\n        promises = (function() {\n          var _i, _len, _results;\n          _results = [];\n          for (_i = 0, _len = handlers.length; _i < _len; _i++) {\n            handler = handlers[_i];\n            _results.push(this.constructor.dispatch(handler, value));\n          }\n          return _results;\n        }).call(this);\n        return Promise.all(promises).then(function() {});\n      }\n      return Promise.resolve();\n    };\n\n    Emitter.prototype.getEventNames = function() {\n      return Object.keys(this.handlersByEventName);\n    };\n\n    Emitter.prototype.listenerCountForEventName = function(eventName) {\n      var _ref, _ref1;\n      return (_ref = (_ref1 = this.handlersByEventName[eventName]) != null ? _ref1.length : void 0) != null ? _ref : 0;\n    };\n\n    Emitter.prototype.getTotalListenerCount = function() {\n      var eventName, result, _i, _len, _ref;\n      result = 0;\n      _ref = Object.keys(this.handlersByEventName);\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        eventName = _ref[_i];\n        result += this.handlersByEventName[eventName].length;\n      }\n      return result;\n    };\n\n    return Emitter;\n\n  })();\n\n}).call(this);\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.animationEnd = exports.animationDelay = exports.animationTiming = exports.animationDuration = exports.animationName = exports.transitionEnd = exports.transitionDuration = exports.transitionDelay = exports.transitionTiming = exports.transitionProperty = exports.transform = undefined;\n\nvar _inDOM = require('../util/inDOM');\n\nvar _inDOM2 = _interopRequireDefault(_inDOM);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar transform = 'transform';\nvar prefix = void 0,\n    transitionEnd = void 0,\n    animationEnd = void 0;\nvar transitionProperty = void 0,\n    transitionDuration = void 0,\n    transitionTiming = void 0,\n    transitionDelay = void 0;\nvar animationName = void 0,\n    animationDuration = void 0,\n    animationTiming = void 0,\n    animationDelay = void 0;\n\nif (_inDOM2.default) {\n  var _getTransitionPropert = getTransitionProperties();\n\n  prefix = _getTransitionPropert.prefix;\n  exports.transitionEnd = transitionEnd = _getTransitionPropert.transitionEnd;\n  exports.animationEnd = animationEnd = _getTransitionPropert.animationEnd;\n\n\n  exports.transform = transform = prefix + '-' + transform;\n  exports.transitionProperty = transitionProperty = prefix + '-transition-property';\n  exports.transitionDuration = transitionDuration = prefix + '-transition-duration';\n  exports.transitionDelay = transitionDelay = prefix + '-transition-delay';\n  exports.transitionTiming = transitionTiming = prefix + '-transition-timing-function';\n\n  exports.animationName = animationName = prefix + '-animation-name';\n  exports.animationDuration = animationDuration = prefix + '-animation-duration';\n  exports.animationTiming = animationTiming = prefix + '-animation-delay';\n  exports.animationDelay = animationDelay = prefix + '-animation-timing-function';\n}\n\nexports.transform = transform;\nexports.transitionProperty = transitionProperty;\nexports.transitionTiming = transitionTiming;\nexports.transitionDelay = transitionDelay;\nexports.transitionDuration = transitionDuration;\nexports.transitionEnd = transitionEnd;\nexports.animationName = animationName;\nexports.animationDuration = animationDuration;\nexports.animationTiming = animationTiming;\nexports.animationDelay = animationDelay;\nexports.animationEnd = animationEnd;\nexports.default = {\n  transform: transform,\n  end: transitionEnd,\n  property: transitionProperty,\n  timing: transitionTiming,\n  delay: transitionDelay,\n  duration: transitionDuration\n};\n\n\nfunction getTransitionProperties() {\n  var style = document.createElement('div').style;\n\n  var vendorMap = {\n    O: function O(e) {\n      return 'o' + e.toLowerCase();\n    },\n    Moz: function Moz(e) {\n      return e.toLowerCase();\n    },\n    Webkit: function Webkit(e) {\n      return 'webkit' + e;\n    },\n    ms: function ms(e) {\n      return 'MS' + e;\n    }\n  };\n\n  var vendors = Object.keys(vendorMap);\n\n  var transitionEnd = void 0,\n      animationEnd = void 0;\n  var prefix = '';\n\n  for (var i = 0; i < vendors.length; i++) {\n    var vendor = vendors[i];\n\n    if (vendor + 'TransitionProperty' in style) {\n      prefix = '-' + vendor.toLowerCase();\n      transitionEnd = vendorMap[vendor]('TransitionEnd');\n      animationEnd = vendorMap[vendor]('AnimationEnd');\n      break;\n    }\n  }\n\n  if (!transitionEnd && 'transitionProperty' in style) transitionEnd = 'transitionend';\n\n  if (!animationEnd && 'animationName' in style) animationEnd = 'animationend';\n\n  style = null;\n\n  return { animationEnd: animationEnd, transitionEnd: transitionEnd, prefix: prefix };\n}","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _inDOM = require('./inDOM');\n\nvar _inDOM2 = _interopRequireDefault(_inDOM);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar vendors = ['', 'webkit', 'moz', 'o', 'ms'];\nvar cancel = 'clearTimeout';\nvar raf = fallback;\nvar compatRaf = void 0;\n\nvar getKey = function getKey(vendor, k) {\n  return vendor + (!vendor ? k : k[0].toUpperCase() + k.substr(1)) + 'AnimationFrame';\n};\n\nif (_inDOM2.default) {\n  vendors.some(function (vendor) {\n    var rafKey = getKey(vendor, 'request');\n\n    if (rafKey in window) {\n      cancel = getKey(vendor, 'cancel');\n      return raf = function raf(cb) {\n        return window[rafKey](cb);\n      };\n    }\n  });\n}\n\n/* https://github.com/component/raf */\nvar prev = new Date().getTime();\nfunction fallback(fn) {\n  var curr = new Date().getTime(),\n      ms = Math.max(0, 16 - (curr - prev)),\n      req = setTimeout(fn, ms);\n\n  prev = curr;\n  return req;\n}\n\ncompatRaf = function compatRaf(cb) {\n  return raf(cb);\n};\ncompatRaf.cancel = function (id) {\n  window[cancel] && typeof window[cancel] === 'function' && window[cancel](id);\n};\nexports.default = compatRaf;\nmodule.exports = exports['default'];","'use strict';\n\nmodule.exports = function removeClass(element, className) {\n  if (element.classList) element.classList.remove(className);else element.className = element.className.replace(new RegExp('(^|\\\\s)' + className + '(?:\\\\s|$)', 'g'), '$1').replace(/\\s+/g, ' ').replace(/^\\s*|\\s*$/g, '');\n};","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = hasClass;\nfunction hasClass(element, className) {\n  if (element.classList) return !!className && element.classList.contains(className);else return (\" \" + element.className + \" \").indexOf(\" \" + className + \" \") !== -1;\n}\nmodule.exports = exports[\"default\"];","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = addClass;\n\nvar _hasClass = require('./hasClass');\n\nvar _hasClass2 = _interopRequireDefault(_hasClass);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction addClass(element, className) {\n  if (element.classList) element.classList.add(className);else if (!(0, _hasClass2.default)(element)) element.className = element.className + ' ' + className;\n}\nmodule.exports = exports['default'];","'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _addClass = require('dom-helpers/class/addClass');\n\nvar _addClass2 = _interopRequireDefault(_addClass);\n\nvar _removeClass = require('dom-helpers/class/removeClass');\n\nvar _removeClass2 = _interopRequireDefault(_removeClass);\n\nvar _requestAnimationFrame = require('dom-helpers/util/requestAnimationFrame');\n\nvar _requestAnimationFrame2 = _interopRequireDefault(_requestAnimationFrame);\n\nvar _properties = require('dom-helpers/transition/properties');\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _reactDom = require('react-dom');\n\nvar _PropTypes = require('./utils/PropTypes');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar events = [];\nif (_properties.transitionEnd) events.push(_properties.transitionEnd);\nif (_properties.animationEnd) events.push(_properties.animationEnd);\n\nfunction addEndListener(node, listener) {\n  if (events.length) {\n    events.forEach(function (e) {\n      return node.addEventListener(e, listener, false);\n    });\n  } else {\n    setTimeout(listener, 0);\n  }\n\n  return function () {\n    if (!events.length) return;\n    events.forEach(function (e) {\n      return node.removeEventListener(e, listener, false);\n    });\n  };\n}\n\nvar propTypes = {\n  children: _propTypes2.default.node,\n  name: _PropTypes.nameShape.isRequired,\n\n  // Once we require timeouts to be specified, we can remove the\n  // boolean flags (appear etc.) and just accept a number\n  // or a bool for the timeout flags (appearTimeout etc.)\n  appear: _propTypes2.default.bool,\n  enter: _propTypes2.default.bool,\n  leave: _propTypes2.default.bool,\n  appearTimeout: _propTypes2.default.number,\n  enterTimeout: _propTypes2.default.number,\n  leaveTimeout: _propTypes2.default.number\n};\n\nvar CSSTransitionGroupChild = function (_React$Component) {\n  _inherits(CSSTransitionGroupChild, _React$Component);\n\n  function CSSTransitionGroupChild() {\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, CSSTransitionGroupChild);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, _React$Component.call.apply(_React$Component, [this].concat(args))), _this), _this.componentWillAppear = function (done) {\n      if (_this.props.appear) {\n        _this.transition('appear', done, _this.props.appearTimeout);\n      } else {\n        done();\n      }\n    }, _this.componentWillEnter = function (done) {\n      if (_this.props.enter) {\n        _this.transition('enter', done, _this.props.enterTimeout);\n      } else {\n        done();\n      }\n    }, _this.componentWillLeave = function (done) {\n      if (_this.props.leave) {\n        _this.transition('leave', done, _this.props.leaveTimeout);\n      } else {\n        done();\n      }\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  CSSTransitionGroupChild.prototype.componentWillMount = function componentWillMount() {\n    this.classNameAndNodeQueue = [];\n    this.transitionTimeouts = [];\n  };\n\n  CSSTransitionGroupChild.prototype.componentWillUnmount = function componentWillUnmount() {\n    this.unmounted = true;\n\n    if (this.timeout) {\n      clearTimeout(this.timeout);\n    }\n    this.transitionTimeouts.forEach(function (timeout) {\n      clearTimeout(timeout);\n    });\n\n    this.classNameAndNodeQueue.length = 0;\n  };\n\n  CSSTransitionGroupChild.prototype.transition = function transition(animationType, finishCallback, timeout) {\n    var node = (0, _reactDom.findDOMNode)(this);\n\n    if (!node) {\n      if (finishCallback) {\n        finishCallback();\n      }\n      return;\n    }\n\n    var className = this.props.name[animationType] || this.props.name + '-' + animationType;\n    var activeClassName = this.props.name[animationType + 'Active'] || className + '-active';\n    var timer = null;\n    var removeListeners = void 0;\n\n    (0, _addClass2.default)(node, className);\n\n    // Need to do this to actually trigger a transition.\n    this.queueClassAndNode(activeClassName, node);\n\n    // Clean-up the animation after the specified delay\n    var finish = function finish(e) {\n      if (e && e.target !== node) {\n        return;\n      }\n\n      clearTimeout(timer);\n      if (removeListeners) removeListeners();\n\n      (0, _removeClass2.default)(node, className);\n      (0, _removeClass2.default)(node, activeClassName);\n\n      if (removeListeners) removeListeners();\n\n      // Usually this optional callback is used for informing an owner of\n      // a leave animation and telling it to remove the child.\n      if (finishCallback) {\n        finishCallback();\n      }\n    };\n\n    if (timeout) {\n      timer = setTimeout(finish, timeout);\n      this.transitionTimeouts.push(timer);\n    } else if (_properties.transitionEnd) {\n      removeListeners = addEndListener(node, finish);\n    }\n  };\n\n  CSSTransitionGroupChild.prototype.queueClassAndNode = function queueClassAndNode(className, node) {\n    var _this2 = this;\n\n    this.classNameAndNodeQueue.push({\n      className: className,\n      node: node\n    });\n\n    if (!this.rafHandle) {\n      this.rafHandle = (0, _requestAnimationFrame2.default)(function () {\n        return _this2.flushClassNameAndNodeQueue();\n      });\n    }\n  };\n\n  CSSTransitionGroupChild.prototype.flushClassNameAndNodeQueue = function flushClassNameAndNodeQueue() {\n    if (!this.unmounted) {\n      this.classNameAndNodeQueue.forEach(function (obj) {\n        // This is for to force a repaint,\n        // which is necessary in order to transition styles when adding a class name.\n        /* eslint-disable no-unused-expressions */\n        obj.node.scrollTop;\n        /* eslint-enable no-unused-expressions */\n        (0, _addClass2.default)(obj.node, obj.className);\n      });\n    }\n    this.classNameAndNodeQueue.length = 0;\n    this.rafHandle = null;\n  };\n\n  CSSTransitionGroupChild.prototype.render = function render() {\n    var props = _extends({}, this.props);\n    delete props.name;\n    delete props.appear;\n    delete props.enter;\n    delete props.leave;\n    delete props.appearTimeout;\n    delete props.enterTimeout;\n    delete props.leaveTimeout;\n    delete props.children;\n    return _react2.default.cloneElement(_react2.default.Children.only(this.props.children), props);\n  };\n\n  return CSSTransitionGroupChild;\n}(_react2.default.Component);\n\nCSSTransitionGroupChild.displayName = 'CSSTransitionGroupChild';\n\n\nCSSTransitionGroupChild.propTypes = process.env.NODE_ENV !== \"production\" ? propTypes : {};\n\nexports.default = CSSTransitionGroupChild;\nmodule.exports = exports['default'];","'use strict';\n\nexports.__esModule = true;\nexports.getChildMapping = getChildMapping;\nexports.mergeChildMappings = mergeChildMappings;\n\nvar _react = require('react');\n\n/**\n * Given `this.props.children`, return an object mapping key to child.\n *\n * @param {*} children `this.props.children`\n * @return {object} Mapping of key to child\n */\nfunction getChildMapping(children) {\n  if (!children) {\n    return children;\n  }\n  var result = {};\n  _react.Children.map(children, function (child) {\n    return child;\n  }).forEach(function (child) {\n    result[child.key] = child;\n  });\n  return result;\n}\n\n/**\n * When you're adding or removing children some may be added or removed in the\n * same render pass. We want to show *both* since we want to simultaneously\n * animate elements in and out. This function takes a previous set of keys\n * and a new set of keys and merges them with its best guess of the correct\n * ordering. In the future we may expose some of the utilities in\n * ReactMultiChild to make this easy, but for now React itself does not\n * directly have this concept of the union of prevChildren and nextChildren\n * so we implement it here.\n *\n * @param {object} prev prev children as returned from\n * `ReactTransitionChildMapping.getChildMapping()`.\n * @param {object} next next children as returned from\n * `ReactTransitionChildMapping.getChildMapping()`.\n * @return {object} a key set that contains all keys in `prev` and all keys\n * in `next` in a reasonable order.\n */\nfunction mergeChildMappings(prev, next) {\n  prev = prev || {};\n  next = next || {};\n\n  function getValueForKey(key) {\n    if (next.hasOwnProperty(key)) {\n      return next[key];\n    }\n\n    return prev[key];\n  }\n\n  // For each key of `next`, the list of keys to insert before that key in\n  // the combined list\n  var nextKeysPending = {};\n\n  var pendingKeys = [];\n  for (var prevKey in prev) {\n    if (next.hasOwnProperty(prevKey)) {\n      if (pendingKeys.length) {\n        nextKeysPending[prevKey] = pendingKeys;\n        pendingKeys = [];\n      }\n    } else {\n      pendingKeys.push(prevKey);\n    }\n  }\n\n  var i = void 0;\n  var childMapping = {};\n  for (var nextKey in next) {\n    if (nextKeysPending.hasOwnProperty(nextKey)) {\n      for (i = 0; i < nextKeysPending[nextKey].length; i++) {\n        var pendingNextKey = nextKeysPending[nextKey][i];\n        childMapping[nextKeysPending[nextKey][i]] = getValueForKey(pendingNextKey);\n      }\n    }\n    childMapping[nextKey] = getValueForKey(nextKey);\n  }\n\n  // Finally, add the keys which didn't appear before any key in `next`\n  for (i = 0; i < pendingKeys.length; i++) {\n    childMapping[pendingKeys[i]] = getValueForKey(pendingKeys[i]);\n  }\n\n  return childMapping;\n}","/**\n * Copyright 2014-2015, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n */\n\n'use strict';\n\n/**\n * Similar to invariant but only logs a warning if the condition is not met.\n * This can be used to log issues in development environments in critical\n * paths. Removing the logging code for production environments will keep the\n * same logic and follow the same code paths.\n */\n\nvar warning = function() {};\n\nif (process.env.NODE_ENV !== 'production') {\n  warning = function(condition, format, args) {\n    var len = arguments.length;\n    args = new Array(len > 2 ? len - 2 : 0);\n    for (var key = 2; key < len; key++) {\n      args[key - 2] = arguments[key];\n    }\n    if (format === undefined) {\n      throw new Error(\n        '`warning(condition, format, ...args)` requires a warning ' +\n        'message argument'\n      );\n    }\n\n    if (format.length < 10 || (/^[s\\W]*$/).test(format)) {\n      throw new Error(\n        'The warning format should be able to uniquely identify this ' +\n        'warning. Please, use a more descriptive format than: ' + format\n      );\n    }\n\n    if (!condition) {\n      var argIndex = 0;\n      var message = 'Warning: ' +\n        format.replace(/%s/g, function() {\n          return args[argIndex++];\n        });\n      if (typeof console !== 'undefined') {\n        console.error(message);\n      }\n      try {\n        // This error was thrown as a convenience so that you can use this stack\n        // to find the callsite that caused this warning to fire.\n        throw new Error(message);\n      } catch(x) {}\n    }\n  };\n}\n\nmodule.exports = warning;\n","\r\nmodule.exports = function chain(){\r\n  var len = arguments.length\r\n  var args = [];\r\n\r\n  for (var i = 0; i < len; i++)\r\n    args[i] = arguments[i]\r\n\r\n  args = args.filter(function(fn){ return fn != null })\r\n\r\n  if (args.length === 0) return undefined\r\n  if (args.length === 1) return args[0]\r\n\r\n  return args.reduce(function(current, next){\r\n    return function chainedFunction() {\r\n      current.apply(this, arguments);\r\n      next.apply(this, arguments);\r\n    };\r\n  })\r\n}\r\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nmodule.exports = ReactPropTypesSecret;\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar emptyFunction = require('fbjs/lib/emptyFunction');\nvar invariant = require('fbjs/lib/invariant');\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n\nmodule.exports = function() {\n  function shim(props, propName, componentName, location, propFullName, secret) {\n    if (secret === ReactPropTypesSecret) {\n      // It is still safe when called from React.\n      return;\n    }\n    invariant(\n      false,\n      'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n      'Use PropTypes.checkPropTypes() to call them. ' +\n      'Read more at http://fb.me/use-check-prop-types'\n    );\n  };\n  shim.isRequired = shim;\n  function getShim() {\n    return shim;\n  };\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n  var ReactPropTypes = {\n    array: shim,\n    bool: shim,\n    func: shim,\n    number: shim,\n    object: shim,\n    string: shim,\n    symbol: shim,\n\n    any: shim,\n    arrayOf: getShim,\n    element: shim,\n    instanceOf: getShim,\n    node: shim,\n    objectOf: getShim,\n    oneOf: getShim,\n    oneOfType: getShim,\n    shape: getShim,\n    exact: getShim\n  };\n\n  ReactPropTypes.checkPropTypes = emptyFunction;\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n","'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _TransitionGroup = require('./TransitionGroup');\n\nvar _TransitionGroup2 = _interopRequireDefault(_TransitionGroup);\n\nvar _CSSTransitionGroupChild = require('./CSSTransitionGroupChild');\n\nvar _CSSTransitionGroupChild2 = _interopRequireDefault(_CSSTransitionGroupChild);\n\nvar _PropTypes = require('./utils/PropTypes');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar propTypes = {\n  transitionName: _PropTypes.nameShape.isRequired,\n\n  transitionAppear: _propTypes2.default.bool,\n  transitionEnter: _propTypes2.default.bool,\n  transitionLeave: _propTypes2.default.bool,\n  transitionAppearTimeout: (0, _PropTypes.transitionTimeout)('Appear'),\n  transitionEnterTimeout: (0, _PropTypes.transitionTimeout)('Enter'),\n  transitionLeaveTimeout: (0, _PropTypes.transitionTimeout)('Leave')\n};\n\nvar defaultProps = {\n  transitionAppear: false,\n  transitionEnter: true,\n  transitionLeave: true\n};\n\nvar CSSTransitionGroup = function (_React$Component) {\n  _inherits(CSSTransitionGroup, _React$Component);\n\n  function CSSTransitionGroup() {\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, CSSTransitionGroup);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, _React$Component.call.apply(_React$Component, [this].concat(args))), _this), _this._wrapChild = function (child) {\n      return _react2.default.createElement(_CSSTransitionGroupChild2.default, {\n        name: _this.props.transitionName,\n        appear: _this.props.transitionAppear,\n        enter: _this.props.transitionEnter,\n        leave: _this.props.transitionLeave,\n        appearTimeout: _this.props.transitionAppearTimeout,\n        enterTimeout: _this.props.transitionEnterTimeout,\n        leaveTimeout: _this.props.transitionLeaveTimeout\n      }, child);\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  // We need to provide this childFactory so that\n  // ReactCSSTransitionGroupChild can receive updates to name, enter, and\n  // leave while it is leaving.\n\n\n  CSSTransitionGroup.prototype.render = function render() {\n    return _react2.default.createElement(_TransitionGroup2.default, _extends({}, this.props, { childFactory: this._wrapChild }));\n  };\n\n  return CSSTransitionGroup;\n}(_react2.default.Component);\n\nCSSTransitionGroup.displayName = 'CSSTransitionGroup';\n\n\nCSSTransitionGroup.propTypes = process.env.NODE_ENV !== \"production\" ? propTypes : {};\nCSSTransitionGroup.defaultProps = defaultProps;\n\nexports.default = CSSTransitionGroup;\nmodule.exports = exports['default'];","'use strict';\n\n/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @typechecks\n */\n\n/**\n * @param {*} object The object to check.\n * @return {boolean} Whether or not the object is a DOM node.\n */\nfunction isNode(object) {\n  var doc = object ? object.ownerDocument || object : document;\n  var defaultView = doc.defaultView || window;\n  return !!(object && (typeof defaultView.Node === 'function' ? object instanceof defaultView.Node : typeof object === 'object' && typeof object.nodeType === 'number' && typeof object.nodeName === 'string'));\n}\n\nmodule.exports = isNode;","'use strict';\n\n/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @typechecks\n */\n\nvar isNode = require('./isNode');\n\n/**\n * @param {*} object The object to check.\n * @return {boolean} Whether or not the object is a DOM text node.\n */\nfunction isTextNode(object) {\n  return isNode(object) && object.nodeType == 3;\n}\n\nmodule.exports = isTextNode;","'use strict';\n\n/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n */\n\nvar isTextNode = require('./isTextNode');\n\n/*eslint-disable no-bitwise */\n\n/**\n * Checks if a given DOM node contains or is another DOM node.\n */\nfunction containsNode(outerNode, innerNode) {\n  if (!outerNode || !innerNode) {\n    return false;\n  } else if (outerNode === innerNode) {\n    return true;\n  } else if (isTextNode(outerNode)) {\n    return false;\n  } else if (isTextNode(innerNode)) {\n    return containsNode(outerNode, innerNode.parentNode);\n  } else if ('contains' in outerNode) {\n    return outerNode.contains(innerNode);\n  } else if (outerNode.compareDocumentPosition) {\n    return !!(outerNode.compareDocumentPosition(innerNode) & 16);\n  } else {\n    return false;\n  }\n}\n\nmodule.exports = containsNode;","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @typechecks\n * \n */\n\n/*eslint-disable no-self-compare */\n\n'use strict';\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\n/**\n * inlined Object.is polyfill to avoid requiring consumers ship their own\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is\n */\nfunction is(x, y) {\n  // SameValue algorithm\n  if (x === y) {\n    // Steps 1-5, 7-10\n    // Steps 6.b-6.e: +0 != -0\n    // Added the nonzero y check to make Flow happy, but it is redundant\n    return x !== 0 || y !== 0 || 1 / x === 1 / y;\n  } else {\n    // Step 6.a: NaN == NaN\n    return x !== x && y !== y;\n  }\n}\n\n/**\n * Performs equality by iterating through keys on an object and returning false\n * when any key has values which are not strictly equal between the arguments.\n * Returns true when the values of all keys are strictly equal.\n */\nfunction shallowEqual(objA, objB) {\n  if (is(objA, objB)) {\n    return true;\n  }\n\n  if (typeof objA !== 'object' || objA === null || typeof objB !== 'object' || objB === null) {\n    return false;\n  }\n\n  var keysA = Object.keys(objA);\n  var keysB = Object.keys(objB);\n\n  if (keysA.length !== keysB.length) {\n    return false;\n  }\n\n  // Test for A's keys different from B.\n  for (var i = 0; i < keysA.length; i++) {\n    if (!hasOwnProperty.call(objB, keysA[i]) || !is(objA[keysA[i]], objB[keysA[i]])) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nmodule.exports = shallowEqual;","'use strict';\n\n/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @typechecks\n */\n\n/* eslint-disable fb-www/typeof-undefined */\n\n/**\n * Same as document.activeElement but wraps in a try-catch block. In IE it is\n * not safe to call document.activeElement if there is nothing focused.\n *\n * The activeElement will be null only if the document or document body is not\n * yet defined.\n *\n * @param {?DOMDocument} doc Defaults to current document.\n * @return {?DOMElement}\n */\nfunction getActiveElement(doc) /*?DOMElement*/{\n  doc = doc || (typeof document !== 'undefined' ? document : undefined);\n  if (typeof doc === 'undefined') {\n    return null;\n  }\n  try {\n    return doc.activeElement || doc.body;\n  } catch (e) {\n    return doc.body;\n  }\n}\n\nmodule.exports = getActiveElement;","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\n'use strict';\n\nvar canUseDOM = !!(typeof window !== 'undefined' && window.document && window.document.createElement);\n\n/**\n * Simple, lightweight module assisting with the detection and context of\n * Worker. Helps avoid circular dependencies and allows code to reason about\n * whether or not they are in a Worker, even if they never include the main\n * `ReactWorker` dependency.\n */\nvar ExecutionEnvironment = {\n\n  canUseDOM: canUseDOM,\n\n  canUseWorkers: typeof Worker !== 'undefined',\n\n  canUseEventListeners: canUseDOM && !!(window.addEventListener || window.attachEvent),\n\n  canUseViewport: canUseDOM && !!window.screen,\n\n  isInWorker: !canUseDOM // For now, this is true - might change in the future.\n\n};\n\nmodule.exports = ExecutionEnvironment;","/** @license React v16.3.2\n * react-dom.production.min.js\n *\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n/*\n Modernizr 3.0.0pre (Custom Build) | MIT\n*/\n'use strict';var ba=require(\"fbjs/lib/invariant\"),ea=require(\"react\"),m=require(\"fbjs/lib/ExecutionEnvironment\"),A=require(\"object-assign\"),C=require(\"fbjs/lib/emptyFunction\"),fa=require(\"fbjs/lib/getActiveElement\"),ha=require(\"fbjs/lib/shallowEqual\"),ja=require(\"fbjs/lib/containsNode\"),ka=require(\"fbjs/lib/emptyObject\");\nfunction D(a){for(var b=arguments.length-1,c=\"http://reactjs.org/docs/error-decoder.html?invariant\\x3d\"+a,d=0;d<b;d++)c+=\"\\x26args[]\\x3d\"+encodeURIComponent(arguments[d+1]);ba(!1,\"Minified React error #\"+a+\"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. \",c)}ea?void 0:D(\"227\");\nfunction ma(a,b,c,d,e,f,h,g,k){this._hasCaughtError=!1;this._caughtError=null;var v=Array.prototype.slice.call(arguments,3);try{b.apply(c,v)}catch(l){this._caughtError=l,this._hasCaughtError=!0}}\nvar E={_caughtError:null,_hasCaughtError:!1,_rethrowError:null,_hasRethrowError:!1,invokeGuardedCallback:function(a,b,c,d,e,f,h,g,k){ma.apply(E,arguments)},invokeGuardedCallbackAndCatchFirstError:function(a,b,c,d,e,f,h,g,k){E.invokeGuardedCallback.apply(this,arguments);if(E.hasCaughtError()){var v=E.clearCaughtError();E._hasRethrowError||(E._hasRethrowError=!0,E._rethrowError=v)}},rethrowCaughtError:function(){return na.apply(E,arguments)},hasCaughtError:function(){return E._hasCaughtError},clearCaughtError:function(){if(E._hasCaughtError){var a=\nE._caughtError;E._caughtError=null;E._hasCaughtError=!1;return a}D(\"198\")}};function na(){if(E._hasRethrowError){var a=E._rethrowError;E._rethrowError=null;E._hasRethrowError=!1;throw a;}}var oa=null,pa={};\nfunction qa(){if(oa)for(var a in pa){var b=pa[a],c=oa.indexOf(a);-1<c?void 0:D(\"96\",a);if(!ra[c]){b.extractEvents?void 0:D(\"97\",a);ra[c]=b;c=b.eventTypes;for(var d in c){var e=void 0;var f=c[d],h=b,g=d;sa.hasOwnProperty(g)?D(\"99\",g):void 0;sa[g]=f;var k=f.phasedRegistrationNames;if(k){for(e in k)k.hasOwnProperty(e)&&ta(k[e],h,g);e=!0}else f.registrationName?(ta(f.registrationName,h,g),e=!0):e=!1;e?void 0:D(\"98\",d,a)}}}}\nfunction ta(a,b,c){ua[a]?D(\"100\",a):void 0;ua[a]=b;va[a]=b.eventTypes[c].dependencies}var ra=[],sa={},ua={},va={};function wa(a){oa?D(\"101\"):void 0;oa=Array.prototype.slice.call(a);qa()}function xa(a){var b=!1,c;for(c in a)if(a.hasOwnProperty(c)){var d=a[c];pa.hasOwnProperty(c)&&pa[c]===d||(pa[c]?D(\"102\",c):void 0,pa[c]=d,b=!0)}b&&qa()}\nvar Ca=Object.freeze({plugins:ra,eventNameDispatchConfigs:sa,registrationNameModules:ua,registrationNameDependencies:va,possibleRegistrationNames:null,injectEventPluginOrder:wa,injectEventPluginsByName:xa}),Da=null,Ea=null,Fa=null;function Ga(a,b,c,d){b=a.type||\"unknown-event\";a.currentTarget=Fa(d);E.invokeGuardedCallbackAndCatchFirstError(b,c,void 0,a);a.currentTarget=null}\nfunction Ha(a,b){null==b?D(\"30\"):void 0;if(null==a)return b;if(Array.isArray(a)){if(Array.isArray(b))return a.push.apply(a,b),a;a.push(b);return a}return Array.isArray(b)?[a].concat(b):[a,b]}function Ia(a,b,c){Array.isArray(a)?a.forEach(b,c):a&&b.call(c,a)}var Ja=null;\nfunction Ka(a,b){if(a){var c=a._dispatchListeners,d=a._dispatchInstances;if(Array.isArray(c))for(var e=0;e<c.length&&!a.isPropagationStopped();e++)Ga(a,b,c[e],d[e]);else c&&Ga(a,b,c,d);a._dispatchListeners=null;a._dispatchInstances=null;a.isPersistent()||a.constructor.release(a)}}function La(a){return Ka(a,!0)}function Ma(a){return Ka(a,!1)}var Na={injectEventPluginOrder:wa,injectEventPluginsByName:xa};\nfunction Oa(a,b){var c=a.stateNode;if(!c)return null;var d=Da(c);if(!d)return null;c=d[b];a:switch(b){case \"onClick\":case \"onClickCapture\":case \"onDoubleClick\":case \"onDoubleClickCapture\":case \"onMouseDown\":case \"onMouseDownCapture\":case \"onMouseMove\":case \"onMouseMoveCapture\":case \"onMouseUp\":case \"onMouseUpCapture\":(d=!d.disabled)||(a=a.type,d=!(\"button\"===a||\"input\"===a||\"select\"===a||\"textarea\"===a));a=!d;break a;default:a=!1}if(a)return null;c&&\"function\"!==typeof c?D(\"231\",b,typeof c):void 0;\nreturn c}function Pa(a,b){null!==a&&(Ja=Ha(Ja,a));a=Ja;Ja=null;a&&(b?Ia(a,La):Ia(a,Ma),Ja?D(\"95\"):void 0,E.rethrowCaughtError())}function Qa(a,b,c,d){for(var e=null,f=0;f<ra.length;f++){var h=ra[f];h&&(h=h.extractEvents(a,b,c,d))&&(e=Ha(e,h))}Pa(e,!1)}var Ra=Object.freeze({injection:Na,getListener:Oa,runEventsInBatch:Pa,runExtractedEventsInBatch:Qa}),Sa=Math.random().toString(36).slice(2),F=\"__reactInternalInstance$\"+Sa,Ta=\"__reactEventHandlers$\"+Sa;\nfunction Ua(a){if(a[F])return a[F];for(;!a[F];)if(a.parentNode)a=a.parentNode;else return null;a=a[F];return 5===a.tag||6===a.tag?a:null}function Va(a){if(5===a.tag||6===a.tag)return a.stateNode;D(\"33\")}function Xa(a){return a[Ta]||null}var bb=Object.freeze({precacheFiberNode:function(a,b){b[F]=a},getClosestInstanceFromNode:Ua,getInstanceFromNode:function(a){a=a[F];return!a||5!==a.tag&&6!==a.tag?null:a},getNodeFromInstance:Va,getFiberCurrentPropsFromNode:Xa,updateFiberProps:function(a,b){a[Ta]=b}});\nfunction L(a){do a=a[\"return\"];while(a&&5!==a.tag);return a?a:null}function cb(a,b,c){for(var d=[];a;)d.push(a),a=L(a);for(a=d.length;0<a--;)b(d[a],\"captured\",c);for(a=0;a<d.length;a++)b(d[a],\"bubbled\",c)}function db(a,b,c){if(b=Oa(a,c.dispatchConfig.phasedRegistrationNames[b]))c._dispatchListeners=Ha(c._dispatchListeners,b),c._dispatchInstances=Ha(c._dispatchInstances,a)}function eb(a){a&&a.dispatchConfig.phasedRegistrationNames&&cb(a._targetInst,db,a)}\nfunction fb(a){if(a&&a.dispatchConfig.phasedRegistrationNames){var b=a._targetInst;b=b?L(b):null;cb(b,db,a)}}function gb(a,b,c){a&&c&&c.dispatchConfig.registrationName&&(b=Oa(a,c.dispatchConfig.registrationName))&&(c._dispatchListeners=Ha(c._dispatchListeners,b),c._dispatchInstances=Ha(c._dispatchInstances,a))}function hb(a){a&&a.dispatchConfig.registrationName&&gb(a._targetInst,null,a)}function ib(a){Ia(a,eb)}\nfunction jb(a,b,c,d){if(c&&d)a:{var e=c;for(var f=d,h=0,g=e;g;g=L(g))h++;g=0;for(var k=f;k;k=L(k))g++;for(;0<h-g;)e=L(e),h--;for(;0<g-h;)f=L(f),g--;for(;h--;){if(e===f||e===f.alternate)break a;e=L(e);f=L(f)}e=null}else e=null;f=e;for(e=[];c&&c!==f;){h=c.alternate;if(null!==h&&h===f)break;e.push(c);c=L(c)}for(c=[];d&&d!==f;){h=d.alternate;if(null!==h&&h===f)break;c.push(d);d=L(d)}for(d=0;d<e.length;d++)gb(e[d],\"bubbled\",a);for(a=c.length;0<a--;)gb(c[a],\"captured\",b)}\nvar kb=Object.freeze({accumulateTwoPhaseDispatches:ib,accumulateTwoPhaseDispatchesSkipTarget:function(a){Ia(a,fb)},accumulateEnterLeaveDispatches:jb,accumulateDirectDispatches:function(a){Ia(a,hb)}}),lb=null;function mb(){!lb&&m.canUseDOM&&(lb=\"textContent\"in document.documentElement?\"textContent\":\"innerText\");return lb}var M={_root:null,_startText:null,_fallbackText:null};\nfunction nb(){if(M._fallbackText)return M._fallbackText;var a,b=M._startText,c=b.length,d,e=ob(),f=e.length;for(a=0;a<c&&b[a]===e[a];a++);var h=c-a;for(d=1;d<=h&&b[c-d]===e[f-d];d++);M._fallbackText=e.slice(a,1<d?1-d:void 0);return M._fallbackText}function ob(){return\"value\"in M._root?M._root.value:M._root[mb()]}\nvar pb=\"dispatchConfig _targetInst nativeEvent isDefaultPrevented isPropagationStopped _dispatchListeners _dispatchInstances\".split(\" \"),qb={type:null,target:null,currentTarget:C.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};\nfunction N(a,b,c,d){this.dispatchConfig=a;this._targetInst=b;this.nativeEvent=c;a=this.constructor.Interface;for(var e in a)a.hasOwnProperty(e)&&((b=a[e])?this[e]=b(c):\"target\"===e?this.target=d:this[e]=c[e]);this.isDefaultPrevented=(null!=c.defaultPrevented?c.defaultPrevented:!1===c.returnValue)?C.thatReturnsTrue:C.thatReturnsFalse;this.isPropagationStopped=C.thatReturnsFalse;return this}\nA(N.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():\"unknown\"!==typeof a.returnValue&&(a.returnValue=!1),this.isDefaultPrevented=C.thatReturnsTrue)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():\"unknown\"!==typeof a.cancelBubble&&(a.cancelBubble=!0),this.isPropagationStopped=C.thatReturnsTrue)},persist:function(){this.isPersistent=C.thatReturnsTrue},isPersistent:C.thatReturnsFalse,\ndestructor:function(){var a=this.constructor.Interface,b;for(b in a)this[b]=null;for(a=0;a<pb.length;a++)this[pb[a]]=null}});N.Interface=qb;N.extend=function(a){function b(){}function c(){return d.apply(this,arguments)}var d=this;b.prototype=d.prototype;var e=new b;A(e,c.prototype);c.prototype=e;c.prototype.constructor=c;c.Interface=A({},d.Interface,a);c.extend=d.extend;rb(c);return c};rb(N);\nfunction sb(a,b,c,d){if(this.eventPool.length){var e=this.eventPool.pop();this.call(e,a,b,c,d);return e}return new this(a,b,c,d)}function tb(a){a instanceof this?void 0:D(\"223\");a.destructor();10>this.eventPool.length&&this.eventPool.push(a)}function rb(a){a.eventPool=[];a.getPooled=sb;a.release=tb}var ub=N.extend({data:null}),vb=N.extend({data:null}),wb=[9,13,27,32],xb=m.canUseDOM&&\"CompositionEvent\"in window,yb=null;m.canUseDOM&&\"documentMode\"in document&&(yb=document.documentMode);\nvar zb=m.canUseDOM&&\"TextEvent\"in window&&!yb,Ab=m.canUseDOM&&(!xb||yb&&8<yb&&11>=yb),Bb=String.fromCharCode(32),Kb={beforeInput:{phasedRegistrationNames:{bubbled:\"onBeforeInput\",captured:\"onBeforeInputCapture\"},dependencies:[\"topCompositionEnd\",\"topKeyPress\",\"topTextInput\",\"topPaste\"]},compositionEnd:{phasedRegistrationNames:{bubbled:\"onCompositionEnd\",captured:\"onCompositionEndCapture\"},dependencies:\"topBlur topCompositionEnd topKeyDown topKeyPress topKeyUp topMouseDown\".split(\" \")},compositionStart:{phasedRegistrationNames:{bubbled:\"onCompositionStart\",\ncaptured:\"onCompositionStartCapture\"},dependencies:\"topBlur topCompositionStart topKeyDown topKeyPress topKeyUp topMouseDown\".split(\" \")},compositionUpdate:{phasedRegistrationNames:{bubbled:\"onCompositionUpdate\",captured:\"onCompositionUpdateCapture\"},dependencies:\"topBlur topCompositionUpdate topKeyDown topKeyPress topKeyUp topMouseDown\".split(\" \")}},Lb=!1;\nfunction Mb(a,b){switch(a){case \"topKeyUp\":return-1!==wb.indexOf(b.keyCode);case \"topKeyDown\":return 229!==b.keyCode;case \"topKeyPress\":case \"topMouseDown\":case \"topBlur\":return!0;default:return!1}}function Nb(a){a=a.detail;return\"object\"===typeof a&&\"data\"in a?a.data:null}var Ob=!1;function Pb(a,b){switch(a){case \"topCompositionEnd\":return Nb(b);case \"topKeyPress\":if(32!==b.which)return null;Lb=!0;return Bb;case \"topTextInput\":return a=b.data,a===Bb&&Lb?null:a;default:return null}}\nfunction Qb(a,b){if(Ob)return\"topCompositionEnd\"===a||!xb&&Mb(a,b)?(a=nb(),M._root=null,M._startText=null,M._fallbackText=null,Ob=!1,a):null;switch(a){case \"topPaste\":return null;case \"topKeyPress\":if(!(b.ctrlKey||b.altKey||b.metaKey)||b.ctrlKey&&b.altKey){if(b.char&&1<b.char.length)return b.char;if(b.which)return String.fromCharCode(b.which)}return null;case \"topCompositionEnd\":return Ab?null:b.data;default:return null}}\nvar Rb={eventTypes:Kb,extractEvents:function(a,b,c,d){var e=void 0;var f=void 0;if(xb)b:{switch(a){case \"topCompositionStart\":e=Kb.compositionStart;break b;case \"topCompositionEnd\":e=Kb.compositionEnd;break b;case \"topCompositionUpdate\":e=Kb.compositionUpdate;break b}e=void 0}else Ob?Mb(a,c)&&(e=Kb.compositionEnd):\"topKeyDown\"===a&&229===c.keyCode&&(e=Kb.compositionStart);e?(Ab&&(Ob||e!==Kb.compositionStart?e===Kb.compositionEnd&&Ob&&(f=nb()):(M._root=d,M._startText=ob(),Ob=!0)),e=ub.getPooled(e,\nb,c,d),f?e.data=f:(f=Nb(c),null!==f&&(e.data=f)),ib(e),f=e):f=null;(a=zb?Pb(a,c):Qb(a,c))?(b=vb.getPooled(Kb.beforeInput,b,c,d),b.data=a,ib(b)):b=null;return null===f?b:null===b?f:[f,b]}},Sb=null,Tb={injectFiberControlledHostComponent:function(a){Sb=a}},Ub=null,Vb=null;function Wb(a){if(a=Ea(a)){Sb&&\"function\"===typeof Sb.restoreControlledState?void 0:D(\"194\");var b=Da(a.stateNode);Sb.restoreControlledState(a.stateNode,a.type,b)}}function Xb(a){Ub?Vb?Vb.push(a):Vb=[a]:Ub=a}\nfunction Yb(){return null!==Ub||null!==Vb}function Zb(){if(Ub){var a=Ub,b=Vb;Vb=Ub=null;Wb(a);if(b)for(a=0;a<b.length;a++)Wb(b[a])}}var $b=Object.freeze({injection:Tb,enqueueStateRestore:Xb,needsStateRestore:Yb,restoreStateIfNeeded:Zb});function ac(a,b){return a(b)}function bc(a,b,c){return a(b,c)}function cc(){}var dc=!1;function ec(a,b){if(dc)return a(b);dc=!0;try{return ac(a,b)}finally{dc=!1,Yb()&&(cc(),Zb())}}\nvar fc={color:!0,date:!0,datetime:!0,\"datetime-local\":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gc(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return\"input\"===b?!!fc[a.type]:\"textarea\"===b?!0:!1}function hc(a){a=a.target||window;a.correspondingUseElement&&(a=a.correspondingUseElement);return 3===a.nodeType?a.parentNode:a}\nfunction ic(a,b){if(!m.canUseDOM||b&&!(\"addEventListener\"in document))return!1;a=\"on\"+a;b=a in document;b||(b=document.createElement(\"div\"),b.setAttribute(a,\"return;\"),b=\"function\"===typeof b[a]);return b}function jc(a){var b=a.type;return(a=a.nodeName)&&\"input\"===a.toLowerCase()&&(\"checkbox\"===b||\"radio\"===b)}\nfunction kc(a){var b=jc(a)?\"checked\":\"value\",c=Object.getOwnPropertyDescriptor(a.constructor.prototype,b),d=\"\"+a[b];if(!a.hasOwnProperty(b)&&\"function\"===typeof c.get&&\"function\"===typeof c.set)return Object.defineProperty(a,b,{configurable:!0,get:function(){return c.get.call(this)},set:function(a){d=\"\"+a;c.set.call(this,a)}}),Object.defineProperty(a,b,{enumerable:c.enumerable}),{getValue:function(){return d},setValue:function(a){d=\"\"+a},stopTracking:function(){a._valueTracker=null;delete a[b]}}}\nfunction lc(a){a._valueTracker||(a._valueTracker=kc(a))}function mc(a){if(!a)return!1;var b=a._valueTracker;if(!b)return!0;var c=b.getValue();var d=\"\";a&&(d=jc(a)?a.checked?\"true\":\"false\":a.value);a=d;return a!==c?(b.setValue(a),!0):!1}\nvar nc=ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,O=\"function\"===typeof Symbol&&Symbol[\"for\"],oc=O?Symbol[\"for\"](\"react.element\"):60103,pc=O?Symbol[\"for\"](\"react.call\"):60104,qc=O?Symbol[\"for\"](\"react.return\"):60105,rc=O?Symbol[\"for\"](\"react.portal\"):60106,sc=O?Symbol[\"for\"](\"react.fragment\"):60107,tc=O?Symbol[\"for\"](\"react.strict_mode\"):60108,uc=O?Symbol[\"for\"](\"react.provider\"):60109,vc=O?Symbol[\"for\"](\"react.context\"):60110,wc=O?Symbol[\"for\"](\"react.async_mode\"):60111,\nxc=O?Symbol[\"for\"](\"react.forward_ref\"):60112,yc=\"function\"===typeof Symbol&&Symbol.iterator;function zc(a){if(null===a||\"undefined\"===typeof a)return null;a=yc&&a[yc]||a[\"@@iterator\"];return\"function\"===typeof a?a:null}\nfunction Ac(a){a=a.type;if(\"function\"===typeof a)return a.displayName||a.name;if(\"string\"===typeof a)return a;switch(a){case sc:return\"ReactFragment\";case rc:return\"ReactPortal\";case pc:return\"ReactCall\";case qc:return\"ReactReturn\"}if(\"object\"===typeof a&&null!==a)switch(a.$$typeof){case xc:return a=a.render.displayName||a.render.name||\"\",\"\"!==a?\"ForwardRef(\"+a+\")\":\"ForwardRef\"}return null}\nfunction Bc(a){var b=\"\";do{a:switch(a.tag){case 0:case 1:case 2:case 5:var c=a._debugOwner,d=a._debugSource;var e=Ac(a);var f=null;c&&(f=Ac(c));c=d;e=\"\\n    in \"+(e||\"Unknown\")+(c?\" (at \"+c.fileName.replace(/^.*[\\\\\\/]/,\"\")+\":\"+c.lineNumber+\")\":f?\" (created by \"+f+\")\":\"\");break a;default:e=\"\"}b+=e;a=a[\"return\"]}while(a);return b}\nvar Cc=/^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$/,Dc={},Ec={};function Fc(a){if(Ec.hasOwnProperty(a))return!0;if(Dc.hasOwnProperty(a))return!1;if(Cc.test(a))return Ec[a]=!0;Dc[a]=!0;return!1}\nfunction Gc(a,b,c,d){if(null!==c&&0===c.type)return!1;switch(typeof b){case \"function\":case \"symbol\":return!0;case \"boolean\":if(d)return!1;if(null!==c)return!c.acceptsBooleans;a=a.toLowerCase().slice(0,5);return\"data-\"!==a&&\"aria-\"!==a;default:return!1}}function Hc(a,b,c,d){if(null===b||\"undefined\"===typeof b||Gc(a,b,c,d))return!0;if(null!==c)switch(c.type){case 3:return!b;case 4:return!1===b;case 5:return isNaN(b);case 6:return isNaN(b)||1>b}return!1}\nfunction U(a,b,c,d,e){this.acceptsBooleans=2===b||3===b||4===b;this.attributeName=d;this.attributeNamespace=e;this.mustUseProperty=c;this.propertyName=a;this.type=b}var V={};\"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style\".split(\" \").forEach(function(a){V[a]=new U(a,0,!1,a,null)});\n[[\"acceptCharset\",\"accept-charset\"],[\"className\",\"class\"],[\"htmlFor\",\"for\"],[\"httpEquiv\",\"http-equiv\"]].forEach(function(a){var b=a[0];V[b]=new U(b,1,!1,a[1],null)});[\"contentEditable\",\"draggable\",\"spellCheck\",\"value\"].forEach(function(a){V[a]=new U(a,2,!1,a.toLowerCase(),null)});[\"autoReverse\",\"externalResourcesRequired\",\"preserveAlpha\"].forEach(function(a){V[a]=new U(a,2,!1,a,null)});\n\"allowFullScreen async autoFocus autoPlay controls default defer disabled formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope\".split(\" \").forEach(function(a){V[a]=new U(a,3,!1,a.toLowerCase(),null)});[\"checked\",\"multiple\",\"muted\",\"selected\"].forEach(function(a){V[a]=new U(a,3,!0,a.toLowerCase(),null)});[\"capture\",\"download\"].forEach(function(a){V[a]=new U(a,4,!1,a.toLowerCase(),null)});\n[\"cols\",\"rows\",\"size\",\"span\"].forEach(function(a){V[a]=new U(a,6,!1,a.toLowerCase(),null)});[\"rowSpan\",\"start\"].forEach(function(a){V[a]=new U(a,5,!1,a.toLowerCase(),null)});var Sc=/[\\-:]([a-z])/g;function Tc(a){return a[1].toUpperCase()}\n\"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height\".split(\" \").forEach(function(a){var b=a.replace(Sc,\nTc);V[b]=new U(b,1,!1,a,null)});\"xlink:actuate xlink:arcrole xlink:href xlink:role xlink:show xlink:title xlink:type\".split(\" \").forEach(function(a){var b=a.replace(Sc,Tc);V[b]=new U(b,1,!1,a,\"http://www.w3.org/1999/xlink\")});[\"xml:base\",\"xml:lang\",\"xml:space\"].forEach(function(a){var b=a.replace(Sc,Tc);V[b]=new U(b,1,!1,a,\"http://www.w3.org/XML/1998/namespace\")});V.tabIndex=new U(\"tabIndex\",1,!1,\"tabindex\",null);\nfunction Uc(a,b,c,d){var e=V.hasOwnProperty(b)?V[b]:null;var f=null!==e?0===e.type:d?!1:!(2<b.length)||\"o\"!==b[0]&&\"O\"!==b[0]||\"n\"!==b[1]&&\"N\"!==b[1]?!1:!0;f||(Hc(b,c,e,d)&&(c=null),d||null===e?Fc(b)&&(null===c?a.removeAttribute(b):a.setAttribute(b,\"\"+c)):e.mustUseProperty?a[e.propertyName]=null===c?3===e.type?!1:\"\":c:(b=e.attributeName,d=e.attributeNamespace,null===c?a.removeAttribute(b):(e=e.type,c=3===e||4===e&&!0===c?\"\":\"\"+c,d?a.setAttributeNS(d,b,c):a.setAttribute(b,c))))}\nfunction Vc(a,b){var c=b.checked;return A({},b,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=c?c:a._wrapperState.initialChecked})}function Wc(a,b){var c=null==b.defaultValue?\"\":b.defaultValue,d=null!=b.checked?b.checked:b.defaultChecked;c=Xc(null!=b.value?b.value:c);a._wrapperState={initialChecked:d,initialValue:c,controlled:\"checkbox\"===b.type||\"radio\"===b.type?null!=b.checked:null!=b.value}}function Yc(a,b){b=b.checked;null!=b&&Uc(a,\"checked\",b,!1)}\nfunction Zc(a,b){Yc(a,b);var c=Xc(b.value);if(null!=c)if(\"number\"===b.type){if(0===c&&\"\"===a.value||a.value!=c)a.value=\"\"+c}else a.value!==\"\"+c&&(a.value=\"\"+c);b.hasOwnProperty(\"value\")?$c(a,b.type,c):b.hasOwnProperty(\"defaultValue\")&&$c(a,b.type,Xc(b.defaultValue));null==b.checked&&null!=b.defaultChecked&&(a.defaultChecked=!!b.defaultChecked)}\nfunction ad(a,b){if(b.hasOwnProperty(\"value\")||b.hasOwnProperty(\"defaultValue\"))\"\"===a.value&&(a.value=\"\"+a._wrapperState.initialValue),a.defaultValue=\"\"+a._wrapperState.initialValue;b=a.name;\"\"!==b&&(a.name=\"\");a.defaultChecked=!a.defaultChecked;a.defaultChecked=!a.defaultChecked;\"\"!==b&&(a.name=b)}function $c(a,b,c){if(\"number\"!==b||a.ownerDocument.activeElement!==a)null==c?a.defaultValue=\"\"+a._wrapperState.initialValue:a.defaultValue!==\"\"+c&&(a.defaultValue=\"\"+c)}\nfunction Xc(a){switch(typeof a){case \"boolean\":case \"number\":case \"object\":case \"string\":case \"undefined\":return a;default:return\"\"}}var bd={change:{phasedRegistrationNames:{bubbled:\"onChange\",captured:\"onChangeCapture\"},dependencies:\"topBlur topChange topClick topFocus topInput topKeyDown topKeyUp topSelectionChange\".split(\" \")}};function cd(a,b,c){a=N.getPooled(bd.change,a,b,c);a.type=\"change\";Xb(c);ib(a);return a}var dd=null,ed=null;function fd(a){Pa(a,!1)}\nfunction gd(a){var b=Va(a);if(mc(b))return a}function hd(a,b){if(\"topChange\"===a)return b}var id=!1;m.canUseDOM&&(id=ic(\"input\")&&(!document.documentMode||9<document.documentMode));function jd(){dd&&(dd.detachEvent(\"onpropertychange\",kd),ed=dd=null)}function kd(a){\"value\"===a.propertyName&&gd(ed)&&(a=cd(ed,a,hc(a)),ec(fd,a))}function ld(a,b,c){\"topFocus\"===a?(jd(),dd=b,ed=c,dd.attachEvent(\"onpropertychange\",kd)):\"topBlur\"===a&&jd()}\nfunction md(a){if(\"topSelectionChange\"===a||\"topKeyUp\"===a||\"topKeyDown\"===a)return gd(ed)}function nd(a,b){if(\"topClick\"===a)return gd(b)}function od(a,b){if(\"topInput\"===a||\"topChange\"===a)return gd(b)}\nvar pd={eventTypes:bd,_isInputEventSupported:id,extractEvents:function(a,b,c,d){var e=b?Va(b):window,f=void 0,h=void 0,g=e.nodeName&&e.nodeName.toLowerCase();\"select\"===g||\"input\"===g&&\"file\"===e.type?f=hd:gc(e)?id?f=od:(f=md,h=ld):(g=e.nodeName)&&\"input\"===g.toLowerCase()&&(\"checkbox\"===e.type||\"radio\"===e.type)&&(f=nd);if(f&&(f=f(a,b)))return cd(f,c,d);h&&h(a,e,b);\"topBlur\"===a&&null!=b&&(a=b._wrapperState||e._wrapperState)&&a.controlled&&\"number\"===e.type&&$c(e,\"number\",e.value)}},qd=N.extend({view:null,\ndetail:null}),rd={Alt:\"altKey\",Control:\"ctrlKey\",Meta:\"metaKey\",Shift:\"shiftKey\"};function sd(a){var b=this.nativeEvent;return b.getModifierState?b.getModifierState(a):(a=rd[a])?!!b[a]:!1}function td(){return sd}\nvar ud=qd.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:td,button:null,buttons:null,relatedTarget:function(a){return a.relatedTarget||(a.fromElement===a.srcElement?a.toElement:a.fromElement)}}),vd={mouseEnter:{registrationName:\"onMouseEnter\",dependencies:[\"topMouseOut\",\"topMouseOver\"]},mouseLeave:{registrationName:\"onMouseLeave\",dependencies:[\"topMouseOut\",\"topMouseOver\"]}},wd={eventTypes:vd,extractEvents:function(a,\nb,c,d){if(\"topMouseOver\"===a&&(c.relatedTarget||c.fromElement)||\"topMouseOut\"!==a&&\"topMouseOver\"!==a)return null;var e=d.window===d?d:(e=d.ownerDocument)?e.defaultView||e.parentWindow:window;\"topMouseOut\"===a?(a=b,b=(b=c.relatedTarget||c.toElement)?Ua(b):null):a=null;if(a===b)return null;var f=null==a?e:Va(a);e=null==b?e:Va(b);var h=ud.getPooled(vd.mouseLeave,a,c,d);h.type=\"mouseleave\";h.target=f;h.relatedTarget=e;c=ud.getPooled(vd.mouseEnter,b,c,d);c.type=\"mouseenter\";c.target=e;c.relatedTarget=\nf;jb(h,c,a,b);return[h,c]}};function xd(a){var b=a;if(a.alternate)for(;b[\"return\"];)b=b[\"return\"];else{if(0!==(b.effectTag&2))return 1;for(;b[\"return\"];)if(b=b[\"return\"],0!==(b.effectTag&2))return 1}return 3===b.tag?2:3}function yd(a){return(a=a._reactInternalFiber)?2===xd(a):!1}function zd(a){2!==xd(a)?D(\"188\"):void 0}\nfunction Ad(a){var b=a.alternate;if(!b)return b=xd(a),3===b?D(\"188\"):void 0,1===b?null:a;for(var c=a,d=b;;){var e=c[\"return\"],f=e?e.alternate:null;if(!e||!f)break;if(e.child===f.child){for(var h=e.child;h;){if(h===c)return zd(e),a;if(h===d)return zd(e),b;h=h.sibling}D(\"188\")}if(c[\"return\"]!==d[\"return\"])c=e,d=f;else{h=!1;for(var g=e.child;g;){if(g===c){h=!0;c=e;d=f;break}if(g===d){h=!0;d=e;c=f;break}g=g.sibling}if(!h){for(g=f.child;g;){if(g===c){h=!0;c=f;d=e;break}if(g===d){h=!0;d=f;c=e;break}g=g.sibling}h?\nvoid 0:D(\"189\")}}c.alternate!==d?D(\"190\"):void 0}3!==c.tag?D(\"188\"):void 0;return c.stateNode.current===c?a:b}function Bd(a){a=Ad(a);if(!a)return null;for(var b=a;;){if(5===b.tag||6===b.tag)return b;if(b.child)b.child[\"return\"]=b,b=b.child;else{if(b===a)break;for(;!b.sibling;){if(!b[\"return\"]||b[\"return\"]===a)return null;b=b[\"return\"]}b.sibling[\"return\"]=b[\"return\"];b=b.sibling}}return null}\nfunction Cd(a){a=Ad(a);if(!a)return null;for(var b=a;;){if(5===b.tag||6===b.tag)return b;if(b.child&&4!==b.tag)b.child[\"return\"]=b,b=b.child;else{if(b===a)break;for(;!b.sibling;){if(!b[\"return\"]||b[\"return\"]===a)return null;b=b[\"return\"]}b.sibling[\"return\"]=b[\"return\"];b=b.sibling}}return null}var Dd=N.extend({animationName:null,elapsedTime:null,pseudoElement:null}),Ed=N.extend({clipboardData:function(a){return\"clipboardData\"in a?a.clipboardData:window.clipboardData}}),Fd=qd.extend({relatedTarget:null});\nfunction Gd(a){var b=a.keyCode;\"charCode\"in a?(a=a.charCode,0===a&&13===b&&(a=13)):a=b;10===a&&(a=13);return 32<=a||13===a?a:0}\nvar Hd={Esc:\"Escape\",Spacebar:\" \",Left:\"ArrowLeft\",Up:\"ArrowUp\",Right:\"ArrowRight\",Down:\"ArrowDown\",Del:\"Delete\",Win:\"OS\",Menu:\"ContextMenu\",Apps:\"ContextMenu\",Scroll:\"ScrollLock\",MozPrintableKey:\"Unidentified\"},Id={8:\"Backspace\",9:\"Tab\",12:\"Clear\",13:\"Enter\",16:\"Shift\",17:\"Control\",18:\"Alt\",19:\"Pause\",20:\"CapsLock\",27:\"Escape\",32:\" \",33:\"PageUp\",34:\"PageDown\",35:\"End\",36:\"Home\",37:\"ArrowLeft\",38:\"ArrowUp\",39:\"ArrowRight\",40:\"ArrowDown\",45:\"Insert\",46:\"Delete\",112:\"F1\",113:\"F2\",114:\"F3\",115:\"F4\",\n116:\"F5\",117:\"F6\",118:\"F7\",119:\"F8\",120:\"F9\",121:\"F10\",122:\"F11\",123:\"F12\",144:\"NumLock\",145:\"ScrollLock\",224:\"Meta\"},Jd=qd.extend({key:function(a){if(a.key){var b=Hd[a.key]||a.key;if(\"Unidentified\"!==b)return b}return\"keypress\"===a.type?(a=Gd(a),13===a?\"Enter\":String.fromCharCode(a)):\"keydown\"===a.type||\"keyup\"===a.type?Id[a.keyCode]||\"Unidentified\":\"\"},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:td,charCode:function(a){return\"keypress\"===\na.type?Gd(a):0},keyCode:function(a){return\"keydown\"===a.type||\"keyup\"===a.type?a.keyCode:0},which:function(a){return\"keypress\"===a.type?Gd(a):\"keydown\"===a.type||\"keyup\"===a.type?a.keyCode:0}}),Kd=ud.extend({dataTransfer:null}),Ld=qd.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:td}),Md=N.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),Nd=ud.extend({deltaX:function(a){return\"deltaX\"in a?a.deltaX:\"wheelDeltaX\"in\na?-a.wheelDeltaX:0},deltaY:function(a){return\"deltaY\"in a?a.deltaY:\"wheelDeltaY\"in a?-a.wheelDeltaY:\"wheelDelta\"in a?-a.wheelDelta:0},deltaZ:null,deltaMode:null}),Od={},Pd={};function Qd(a,b){var c=a[0].toUpperCase()+a.slice(1),d=\"on\"+c;c=\"top\"+c;b={phasedRegistrationNames:{bubbled:d,captured:d+\"Capture\"},dependencies:[c],isInteractive:b};Od[a]=b;Pd[c]=b}\n\"blur cancel click close contextMenu copy cut doubleClick dragEnd dragStart drop focus input invalid keyDown keyPress keyUp mouseDown mouseUp paste pause play rateChange reset seeked submit touchCancel touchEnd touchStart volumeChange\".split(\" \").forEach(function(a){Qd(a,!0)});\n\"abort animationEnd animationIteration animationStart canPlay canPlayThrough drag dragEnter dragExit dragLeave dragOver durationChange emptied encrypted ended error load loadedData loadedMetadata loadStart mouseMove mouseOut mouseOver playing progress scroll seeking stalled suspend timeUpdate toggle touchMove transitionEnd waiting wheel\".split(\" \").forEach(function(a){Qd(a,!1)});\nvar Rd={eventTypes:Od,isInteractiveTopLevelEventType:function(a){a=Pd[a];return void 0!==a&&!0===a.isInteractive},extractEvents:function(a,b,c,d){var e=Pd[a];if(!e)return null;switch(a){case \"topKeyPress\":if(0===Gd(c))return null;case \"topKeyDown\":case \"topKeyUp\":a=Jd;break;case \"topBlur\":case \"topFocus\":a=Fd;break;case \"topClick\":if(2===c.button)return null;case \"topDoubleClick\":case \"topMouseDown\":case \"topMouseMove\":case \"topMouseUp\":case \"topMouseOut\":case \"topMouseOver\":case \"topContextMenu\":a=\nud;break;case \"topDrag\":case \"topDragEnd\":case \"topDragEnter\":case \"topDragExit\":case \"topDragLeave\":case \"topDragOver\":case \"topDragStart\":case \"topDrop\":a=Kd;break;case \"topTouchCancel\":case \"topTouchEnd\":case \"topTouchMove\":case \"topTouchStart\":a=Ld;break;case \"topAnimationEnd\":case \"topAnimationIteration\":case \"topAnimationStart\":a=Dd;break;case \"topTransitionEnd\":a=Md;break;case \"topScroll\":a=qd;break;case \"topWheel\":a=Nd;break;case \"topCopy\":case \"topCut\":case \"topPaste\":a=Ed;break;default:a=\nN}b=a.getPooled(e,b,c,d);ib(b);return b}},Sd=Rd.isInteractiveTopLevelEventType,Td=[];function Ud(a){var b=a.targetInst;do{if(!b){a.ancestors.push(b);break}var c;for(c=b;c[\"return\"];)c=c[\"return\"];c=3!==c.tag?null:c.stateNode.containerInfo;if(!c)break;a.ancestors.push(b);b=Ua(c)}while(b);for(c=0;c<a.ancestors.length;c++)b=a.ancestors[c],Qa(a.topLevelType,b,a.nativeEvent,hc(a.nativeEvent))}var Vd=!0;function Wd(a){Vd=!!a}\nfunction W(a,b,c){if(!c)return null;a=(Sd(a)?Xd:Yd).bind(null,a);c.addEventListener(b,a,!1)}function Zd(a,b,c){if(!c)return null;a=(Sd(a)?Xd:Yd).bind(null,a);c.addEventListener(b,a,!0)}function Xd(a,b){bc(Yd,a,b)}\nfunction Yd(a,b){if(Vd){var c=hc(b);c=Ua(c);null!==c&&\"number\"===typeof c.tag&&2!==xd(c)&&(c=null);if(Td.length){var d=Td.pop();d.topLevelType=a;d.nativeEvent=b;d.targetInst=c;a=d}else a={topLevelType:a,nativeEvent:b,targetInst:c,ancestors:[]};try{ec(Ud,a)}finally{a.topLevelType=null,a.nativeEvent=null,a.targetInst=null,a.ancestors.length=0,10>Td.length&&Td.push(a)}}}\nvar $d=Object.freeze({get _enabled(){return Vd},setEnabled:Wd,isEnabled:function(){return Vd},trapBubbledEvent:W,trapCapturedEvent:Zd,dispatchEvent:Yd});function ae(a,b){var c={};c[a.toLowerCase()]=b.toLowerCase();c[\"Webkit\"+a]=\"webkit\"+b;c[\"Moz\"+a]=\"moz\"+b;c[\"ms\"+a]=\"MS\"+b;c[\"O\"+a]=\"o\"+b.toLowerCase();return c}\nvar be={animationend:ae(\"Animation\",\"AnimationEnd\"),animationiteration:ae(\"Animation\",\"AnimationIteration\"),animationstart:ae(\"Animation\",\"AnimationStart\"),transitionend:ae(\"Transition\",\"TransitionEnd\")},ce={},de={};m.canUseDOM&&(de=document.createElement(\"div\").style,\"AnimationEvent\"in window||(delete be.animationend.animation,delete be.animationiteration.animation,delete be.animationstart.animation),\"TransitionEvent\"in window||delete be.transitionend.transition);\nfunction ee(a){if(ce[a])return ce[a];if(!be[a])return a;var b=be[a],c;for(c in b)if(b.hasOwnProperty(c)&&c in de)return ce[a]=b[c];return a}\nvar fe={topAnimationEnd:ee(\"animationend\"),topAnimationIteration:ee(\"animationiteration\"),topAnimationStart:ee(\"animationstart\"),topBlur:\"blur\",topCancel:\"cancel\",topChange:\"change\",topClick:\"click\",topClose:\"close\",topCompositionEnd:\"compositionend\",topCompositionStart:\"compositionstart\",topCompositionUpdate:\"compositionupdate\",topContextMenu:\"contextmenu\",topCopy:\"copy\",topCut:\"cut\",topDoubleClick:\"dblclick\",topDrag:\"drag\",topDragEnd:\"dragend\",topDragEnter:\"dragenter\",topDragExit:\"dragexit\",topDragLeave:\"dragleave\",\ntopDragOver:\"dragover\",topDragStart:\"dragstart\",topDrop:\"drop\",topFocus:\"focus\",topInput:\"input\",topKeyDown:\"keydown\",topKeyPress:\"keypress\",topKeyUp:\"keyup\",topLoad:\"load\",topLoadStart:\"loadstart\",topMouseDown:\"mousedown\",topMouseMove:\"mousemove\",topMouseOut:\"mouseout\",topMouseOver:\"mouseover\",topMouseUp:\"mouseup\",topPaste:\"paste\",topScroll:\"scroll\",topSelectionChange:\"selectionchange\",topTextInput:\"textInput\",topToggle:\"toggle\",topTouchCancel:\"touchcancel\",topTouchEnd:\"touchend\",topTouchMove:\"touchmove\",\ntopTouchStart:\"touchstart\",topTransitionEnd:ee(\"transitionend\"),topWheel:\"wheel\"},ge={topAbort:\"abort\",topCanPlay:\"canplay\",topCanPlayThrough:\"canplaythrough\",topDurationChange:\"durationchange\",topEmptied:\"emptied\",topEncrypted:\"encrypted\",topEnded:\"ended\",topError:\"error\",topLoadedData:\"loadeddata\",topLoadedMetadata:\"loadedmetadata\",topLoadStart:\"loadstart\",topPause:\"pause\",topPlay:\"play\",topPlaying:\"playing\",topProgress:\"progress\",topRateChange:\"ratechange\",topSeeked:\"seeked\",topSeeking:\"seeking\",\ntopStalled:\"stalled\",topSuspend:\"suspend\",topTimeUpdate:\"timeupdate\",topVolumeChange:\"volumechange\",topWaiting:\"waiting\"},he={},ie=0,je=\"_reactListenersID\"+(\"\"+Math.random()).slice(2);function ke(a){Object.prototype.hasOwnProperty.call(a,je)||(a[je]=ie++,he[a[je]]={});return he[a[je]]}function le(a){for(;a&&a.firstChild;)a=a.firstChild;return a}\nfunction me(a,b){var c=le(a);a=0;for(var d;c;){if(3===c.nodeType){d=a+c.textContent.length;if(a<=b&&d>=b)return{node:c,offset:b-a};a=d}a:{for(;c;){if(c.nextSibling){c=c.nextSibling;break a}c=c.parentNode}c=void 0}c=le(c)}}function ne(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return b&&(\"input\"===b&&\"text\"===a.type||\"textarea\"===b||\"true\"===a.contentEditable)}\nvar oe=m.canUseDOM&&\"documentMode\"in document&&11>=document.documentMode,pe={select:{phasedRegistrationNames:{bubbled:\"onSelect\",captured:\"onSelectCapture\"},dependencies:\"topBlur topContextMenu topFocus topKeyDown topKeyUp topMouseDown topMouseUp topSelectionChange\".split(\" \")}},qe=null,re=null,se=null,te=!1;\nfunction ue(a,b){if(te||null==qe||qe!==fa())return null;var c=qe;\"selectionStart\"in c&&ne(c)?c={start:c.selectionStart,end:c.selectionEnd}:window.getSelection?(c=window.getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}):c=void 0;return se&&ha(se,c)?null:(se=c,a=N.getPooled(pe.select,re,a,b),a.type=\"select\",a.target=qe,ib(a),a)}\nvar ve={eventTypes:pe,extractEvents:function(a,b,c,d){var e=d.window===d?d.document:9===d.nodeType?d:d.ownerDocument,f;if(!(f=!e)){a:{e=ke(e);f=va.onSelect;for(var h=0;h<f.length;h++){var g=f[h];if(!e.hasOwnProperty(g)||!e[g]){e=!1;break a}}e=!0}f=!e}if(f)return null;e=b?Va(b):window;switch(a){case \"topFocus\":if(gc(e)||\"true\"===e.contentEditable)qe=e,re=b,se=null;break;case \"topBlur\":se=re=qe=null;break;case \"topMouseDown\":te=!0;break;case \"topContextMenu\":case \"topMouseUp\":return te=!1,ue(c,d);case \"topSelectionChange\":if(oe)break;\ncase \"topKeyDown\":case \"topKeyUp\":return ue(c,d)}return null}};Na.injectEventPluginOrder(\"ResponderEventPlugin SimpleEventPlugin TapEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin\".split(\" \"));Da=bb.getFiberCurrentPropsFromNode;Ea=bb.getInstanceFromNode;Fa=bb.getNodeFromInstance;Na.injectEventPluginsByName({SimpleEventPlugin:Rd,EnterLeaveEventPlugin:wd,ChangeEventPlugin:pd,SelectEventPlugin:ve,BeforeInputEventPlugin:Rb});\nfunction xe(a,b,c,d){this.tag=a;this.key=c;this.stateNode=this.type=null;this.sibling=this.child=this[\"return\"]=null;this.index=0;this.ref=null;this.pendingProps=b;this.memoizedState=this.updateQueue=this.memoizedProps=null;this.mode=d;this.effectTag=0;this.lastEffect=this.firstEffect=this.nextEffect=null;this.expirationTime=0;this.alternate=null}\nfunction ze(a,b,c){var d=a.alternate;null===d?(d=new xe(a.tag,b,a.key,a.mode),d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=b,d.effectTag=0,d.nextEffect=null,d.firstEffect=null,d.lastEffect=null);d.expirationTime=c;d.child=a.child;d.memoizedProps=a.memoizedProps;d.memoizedState=a.memoizedState;d.updateQueue=a.updateQueue;d.sibling=a.sibling;d.index=a.index;d.ref=a.ref;return d}\nfunction Ae(a,b,c){var d=a.type,e=a.key;a=a.props;var f=void 0;if(\"function\"===typeof d)f=d.prototype&&d.prototype.isReactComponent?2:0;else if(\"string\"===typeof d)f=5;else switch(d){case sc:return Be(a.children,b,c,e);case wc:f=11;b|=3;break;case tc:f=11;b|=2;break;case pc:f=7;break;case qc:f=9;break;default:if(\"object\"===typeof d&&null!==d)switch(d.$$typeof){case uc:f=13;break;case vc:f=12;break;case xc:f=14;break;default:if(\"number\"===typeof d.tag)return b=d,b.pendingProps=a,b.expirationTime=c,\nb;D(\"130\",null==d?d:typeof d,\"\")}else D(\"130\",null==d?d:typeof d,\"\")}b=new xe(f,a,e,b);b.type=d;b.expirationTime=c;return b}function Be(a,b,c,d){a=new xe(10,a,d,b);a.expirationTime=c;return a}function Ce(a,b,c){a=new xe(6,a,null,b);a.expirationTime=c;return a}function De(a,b,c){b=new xe(4,null!==a.children?a.children:[],a.key,b);b.expirationTime=c;b.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation};return b}var Ee=null,Fe=null;\nfunction Ge(a){return function(b){try{return a(b)}catch(c){}}}function He(a){if(\"undefined\"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var b=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(b.isDisabled||!b.supportsFiber)return!0;try{var c=b.inject(a);Ee=Ge(function(a){return b.onCommitFiberRoot(c,a)});Fe=Ge(function(a){return b.onCommitFiberUnmount(c,a)})}catch(d){}return!0}function Ie(a){\"function\"===typeof Ee&&Ee(a)}function Je(a){\"function\"===typeof Fe&&Fe(a)}new Set;\nfunction Ke(a){return{baseState:a,expirationTime:0,first:null,last:null,callbackList:null,hasForceUpdate:!1,isInitialized:!1,capturedValues:null}}function Le(a,b){null===a.last?a.first=a.last=b:(a.last.next=b,a.last=b);if(0===a.expirationTime||a.expirationTime>b.expirationTime)a.expirationTime=b.expirationTime}var Me=void 0,Ne=void 0;\nfunction Oe(a){Me=Ne=null;var b=a.alternate,c=a.updateQueue;null===c&&(c=a.updateQueue=Ke(null));null!==b?(a=b.updateQueue,null===a&&(a=b.updateQueue=Ke(null))):a=null;Me=c;Ne=a!==c?a:null}function Pe(a,b){Oe(a);a=Me;var c=Ne;null===c?Le(a,b):null===a.last||null===c.last?(Le(a,b),Le(c,b)):(Le(a,b),c.last=b)}function Qe(a,b,c,d){a=a.partialState;return\"function\"===typeof a?a.call(b,c,d):a}\nfunction Re(a,b,c,d,e,f){null!==a&&a.updateQueue===c&&(c=b.updateQueue={baseState:c.baseState,expirationTime:c.expirationTime,first:c.first,last:c.last,isInitialized:c.isInitialized,capturedValues:c.capturedValues,callbackList:null,hasForceUpdate:!1});c.expirationTime=0;c.isInitialized?a=c.baseState:(a=c.baseState=b.memoizedState,c.isInitialized=!0);for(var h=!0,g=c.first,k=!1;null!==g;){var v=g.expirationTime;if(v>f){var l=c.expirationTime;if(0===l||l>v)c.expirationTime=v;k||(k=!0,c.baseState=a)}else{k||\n(c.first=g.next,null===c.first&&(c.last=null));if(g.isReplace)a=Qe(g,d,a,e),h=!0;else if(v=Qe(g,d,a,e))a=h?A({},a,v):A(a,v),h=!1;g.isForced&&(c.hasForceUpdate=!0);null!==g.callback&&(v=c.callbackList,null===v&&(v=c.callbackList=[]),v.push(g));null!==g.capturedValue&&(v=c.capturedValues,null===v?c.capturedValues=[g.capturedValue]:v.push(g.capturedValue))}g=g.next}null!==c.callbackList?b.effectTag|=32:null!==c.first||c.hasForceUpdate||null!==c.capturedValues||(b.updateQueue=null);k||(c.baseState=a);\nreturn a}function Se(a,b){var c=a.callbackList;if(null!==c)for(a.callbackList=null,a=0;a<c.length;a++){var d=c[a],e=d.callback;d.callback=null;\"function\"!==typeof e?D(\"191\",e):void 0;e.call(b)}}\nfunction Te(a,b,c,d,e){function f(a,b,c,d,e,f){if(null===b||null!==a.updateQueue&&a.updateQueue.hasForceUpdate)return!0;var n=a.stateNode;a=a.type;return\"function\"===typeof n.shouldComponentUpdate?n.shouldComponentUpdate(c,e,f):a.prototype&&a.prototype.isPureReactComponent?!ha(b,c)||!ha(d,e):!0}function h(a,b){b.updater=r;a.stateNode=b;b._reactInternalFiber=a}function g(a,b,c,d){a=b.state;\"function\"===typeof b.componentWillReceiveProps&&b.componentWillReceiveProps(c,d);\"function\"===typeof b.UNSAFE_componentWillReceiveProps&&\nb.UNSAFE_componentWillReceiveProps(c,d);b.state!==a&&r.enqueueReplaceState(b,b.state,null)}function k(a,b,c,d){a=a.type;if(\"function\"===typeof a.getDerivedStateFromProps)return a.getDerivedStateFromProps.call(null,c,d)}var v=a.cacheContext,l=a.getMaskedContext,p=a.getUnmaskedContext,z=a.isContextConsumer,B=a.hasContextChanged,r={isMounted:yd,enqueueSetState:function(a,d,e){a=a._reactInternalFiber;e=void 0===e?null:e;var f=c(a);Pe(a,{expirationTime:f,partialState:d,callback:e,isReplace:!1,isForced:!1,\ncapturedValue:null,next:null});b(a,f)},enqueueReplaceState:function(a,d,e){a=a._reactInternalFiber;e=void 0===e?null:e;var f=c(a);Pe(a,{expirationTime:f,partialState:d,callback:e,isReplace:!0,isForced:!1,capturedValue:null,next:null});b(a,f)},enqueueForceUpdate:function(a,d){a=a._reactInternalFiber;d=void 0===d?null:d;var e=c(a);Pe(a,{expirationTime:e,partialState:null,callback:d,isReplace:!1,isForced:!0,capturedValue:null,next:null});b(a,e)}};return{adoptClassInstance:h,callGetDerivedStateFromProps:k,\nconstructClassInstance:function(a,b){var c=a.type,d=p(a),e=z(a),f=e?l(a,d):ka;c=new c(b,f);var n=null!==c.state&&void 0!==c.state?c.state:null;h(a,c);a.memoizedState=n;b=k(a,c,b,n);null!==b&&void 0!==b&&(a.memoizedState=A({},a.memoizedState,b));e&&v(a,d,f);return c},mountClassInstance:function(a,b){var c=a.type,d=a.alternate,e=a.stateNode,f=a.pendingProps,n=p(a);e.props=f;e.state=a.memoizedState;e.refs=ka;e.context=l(a,n);\"function\"===typeof c.getDerivedStateFromProps||\"function\"===typeof e.getSnapshotBeforeUpdate||\n\"function\"!==typeof e.UNSAFE_componentWillMount&&\"function\"!==typeof e.componentWillMount||(c=e.state,\"function\"===typeof e.componentWillMount&&e.componentWillMount(),\"function\"===typeof e.UNSAFE_componentWillMount&&e.UNSAFE_componentWillMount(),c!==e.state&&r.enqueueReplaceState(e,e.state,null),c=a.updateQueue,null!==c&&(e.state=Re(d,a,c,e,f,b)));\"function\"===typeof e.componentDidMount&&(a.effectTag|=4)},resumeMountClassInstance:function(a,b){var c=a.type,n=a.stateNode;n.props=a.memoizedProps;n.state=\na.memoizedState;var h=a.memoizedProps,r=a.pendingProps,z=n.context,q=p(a);q=l(a,q);(c=\"function\"===typeof c.getDerivedStateFromProps||\"function\"===typeof n.getSnapshotBeforeUpdate)||\"function\"!==typeof n.UNSAFE_componentWillReceiveProps&&\"function\"!==typeof n.componentWillReceiveProps||(h!==r||z!==q)&&g(a,n,r,q);z=a.memoizedState;b=null!==a.updateQueue?Re(null,a,a.updateQueue,n,r,b):z;var u=void 0;h!==r&&(u=k(a,n,r,b));if(null!==u&&void 0!==u){b=null===b||void 0===b?u:A({},b,u);var t=a.updateQueue;\nnull!==t&&(t.baseState=A({},t.baseState,u))}if(!(h!==r||z!==b||B()||null!==a.updateQueue&&a.updateQueue.hasForceUpdate))return\"function\"===typeof n.componentDidMount&&(a.effectTag|=4),!1;(h=f(a,h,r,z,b,q))?(c||\"function\"!==typeof n.UNSAFE_componentWillMount&&\"function\"!==typeof n.componentWillMount||(\"function\"===typeof n.componentWillMount&&n.componentWillMount(),\"function\"===typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount()),\"function\"===typeof n.componentDidMount&&(a.effectTag|=\n4)):(\"function\"===typeof n.componentDidMount&&(a.effectTag|=4),d(a,r),e(a,b));n.props=r;n.state=b;n.context=q;return h},updateClassInstance:function(a,b,c){var n=b.type,x=b.stateNode;x.props=b.memoizedProps;x.state=b.memoizedState;var h=b.memoizedProps,r=b.pendingProps,q=x.context,u=p(b);u=l(b,u);(n=\"function\"===typeof n.getDerivedStateFromProps||\"function\"===typeof x.getSnapshotBeforeUpdate)||\"function\"!==typeof x.UNSAFE_componentWillReceiveProps&&\"function\"!==typeof x.componentWillReceiveProps||\n(h!==r||q!==u)&&g(b,x,r,u);q=b.memoizedState;c=null!==b.updateQueue?Re(a,b,b.updateQueue,x,r,c):q;var t=void 0;h!==r&&(t=k(b,x,r,c));if(null!==t&&void 0!==t){c=null===c||void 0===c?t:A({},c,t);var y=b.updateQueue;null!==y&&(y.baseState=A({},y.baseState,t))}if(!(h!==r||q!==c||B()||null!==b.updateQueue&&b.updateQueue.hasForceUpdate))return\"function\"!==typeof x.componentDidUpdate||h===a.memoizedProps&&q===a.memoizedState||(b.effectTag|=4),\"function\"!==typeof x.getSnapshotBeforeUpdate||h===a.memoizedProps&&\nq===a.memoizedState||(b.effectTag|=2048),!1;(t=f(b,h,r,q,c,u))?(n||\"function\"!==typeof x.UNSAFE_componentWillUpdate&&\"function\"!==typeof x.componentWillUpdate||(\"function\"===typeof x.componentWillUpdate&&x.componentWillUpdate(r,c,u),\"function\"===typeof x.UNSAFE_componentWillUpdate&&x.UNSAFE_componentWillUpdate(r,c,u)),\"function\"===typeof x.componentDidUpdate&&(b.effectTag|=4),\"function\"===typeof x.getSnapshotBeforeUpdate&&(b.effectTag|=2048)):(\"function\"!==typeof x.componentDidUpdate||h===a.memoizedProps&&\nq===a.memoizedState||(b.effectTag|=4),\"function\"!==typeof x.getSnapshotBeforeUpdate||h===a.memoizedProps&&q===a.memoizedState||(b.effectTag|=2048),d(b,r),e(b,c));x.props=r;x.state=c;x.context=u;return t}}}var Ue=Array.isArray;\nfunction Ve(a,b,c){a=c.ref;if(null!==a&&\"function\"!==typeof a&&\"object\"!==typeof a){if(c._owner){c=c._owner;var d=void 0;c&&(2!==c.tag?D(\"110\"):void 0,d=c.stateNode);d?void 0:D(\"147\",a);var e=\"\"+a;if(null!==b&&null!==b.ref&&b.ref._stringRef===e)return b.ref;b=function(a){var b=d.refs===ka?d.refs={}:d.refs;null===a?delete b[e]:b[e]=a};b._stringRef=e;return b}\"string\"!==typeof a?D(\"148\"):void 0;c._owner?void 0:D(\"254\",a)}return a}\nfunction We(a,b){\"textarea\"!==a.type&&D(\"31\",\"[object Object]\"===Object.prototype.toString.call(b)?\"object with keys {\"+Object.keys(b).join(\", \")+\"}\":b,\"\")}\nfunction Xe(a){function b(b,c){if(a){var d=b.lastEffect;null!==d?(d.nextEffect=c,b.lastEffect=c):b.firstEffect=b.lastEffect=c;c.nextEffect=null;c.effectTag=8}}function c(c,d){if(!a)return null;for(;null!==d;)b(c,d),d=d.sibling;return null}function d(a,b){for(a=new Map;null!==b;)null!==b.key?a.set(b.key,b):a.set(b.index,b),b=b.sibling;return a}function e(a,b,c){a=ze(a,b,c);a.index=0;a.sibling=null;return a}function f(b,c,d){b.index=d;if(!a)return c;d=b.alternate;if(null!==d)return d=d.index,d<c?(b.effectTag=\n2,c):d;b.effectTag=2;return c}function h(b){a&&null===b.alternate&&(b.effectTag=2);return b}function g(a,b,c,d){if(null===b||6!==b.tag)return b=Ce(c,a.mode,d),b[\"return\"]=a,b;b=e(b,c,d);b[\"return\"]=a;return b}function k(a,b,c,d){if(null!==b&&b.type===c.type)return d=e(b,c.props,d),d.ref=Ve(a,b,c),d[\"return\"]=a,d;d=Ae(c,a.mode,d);d.ref=Ve(a,b,c);d[\"return\"]=a;return d}function v(a,b,c,d){if(null===b||4!==b.tag||b.stateNode.containerInfo!==c.containerInfo||b.stateNode.implementation!==c.implementation)return b=\nDe(c,a.mode,d),b[\"return\"]=a,b;b=e(b,c.children||[],d);b[\"return\"]=a;return b}function l(a,b,c,d,f){if(null===b||10!==b.tag)return b=Be(c,a.mode,d,f),b[\"return\"]=a,b;b=e(b,c,d);b[\"return\"]=a;return b}function p(a,b,c){if(\"string\"===typeof b||\"number\"===typeof b)return b=Ce(\"\"+b,a.mode,c),b[\"return\"]=a,b;if(\"object\"===typeof b&&null!==b){switch(b.$$typeof){case oc:return c=Ae(b,a.mode,c),c.ref=Ve(a,null,b),c[\"return\"]=a,c;case rc:return b=De(b,a.mode,c),b[\"return\"]=a,b}if(Ue(b)||zc(b))return b=Be(b,\na.mode,c,null),b[\"return\"]=a,b;We(a,b)}return null}function z(a,b,c,d){var e=null!==b?b.key:null;if(\"string\"===typeof c||\"number\"===typeof c)return null!==e?null:g(a,b,\"\"+c,d);if(\"object\"===typeof c&&null!==c){switch(c.$$typeof){case oc:return c.key===e?c.type===sc?l(a,b,c.props.children,d,e):k(a,b,c,d):null;case rc:return c.key===e?v(a,b,c,d):null}if(Ue(c)||zc(c))return null!==e?null:l(a,b,c,d,null);We(a,c)}return null}function B(a,b,c,d,e){if(\"string\"===typeof d||\"number\"===typeof d)return a=a.get(c)||\nnull,g(b,a,\"\"+d,e);if(\"object\"===typeof d&&null!==d){switch(d.$$typeof){case oc:return a=a.get(null===d.key?c:d.key)||null,d.type===sc?l(b,a,d.props.children,e,d.key):k(b,a,d,e);case rc:return a=a.get(null===d.key?c:d.key)||null,v(b,a,d,e)}if(Ue(d)||zc(d))return a=a.get(c)||null,l(b,a,d,e,null);We(b,d)}return null}function r(e,l,g,h){for(var r=null,k=null,q=l,u=l=0,t=null;null!==q&&u<g.length;u++){q.index>u?(t=q,q=null):t=q.sibling;var n=z(e,q,g[u],h);if(null===n){null===q&&(q=t);break}a&&q&&null===\nn.alternate&&b(e,q);l=f(n,l,u);null===k?r=n:k.sibling=n;k=n;q=t}if(u===g.length)return c(e,q),r;if(null===q){for(;u<g.length;u++)if(q=p(e,g[u],h))l=f(q,l,u),null===k?r=q:k.sibling=q,k=q;return r}for(q=d(e,q);u<g.length;u++)if(t=B(q,e,u,g[u],h)){if(a&&null!==t.alternate)q[\"delete\"](null===t.key?u:t.key);l=f(t,l,u);null===k?r=t:k.sibling=t;k=t}a&&q.forEach(function(a){return b(e,a)});return r}function Q(e,l,g,h){var r=zc(g);\"function\"!==typeof r?D(\"150\"):void 0;g=r.call(g);null==g?D(\"151\"):void 0;for(var k=\nr=null,q=l,u=l=0,t=null,n=g.next();null!==q&&!n.done;u++,n=g.next()){q.index>u?(t=q,q=null):t=q.sibling;var H=z(e,q,n.value,h);if(null===H){q||(q=t);break}a&&q&&null===H.alternate&&b(e,q);l=f(H,l,u);null===k?r=H:k.sibling=H;k=H;q=t}if(n.done)return c(e,q),r;if(null===q){for(;!n.done;u++,n=g.next())n=p(e,n.value,h),null!==n&&(l=f(n,l,u),null===k?r=n:k.sibling=n,k=n);return r}for(q=d(e,q);!n.done;u++,n=g.next())if(n=B(q,e,u,n.value,h),null!==n){if(a&&null!==n.alternate)q[\"delete\"](null===n.key?u:n.key);\nl=f(n,l,u);null===k?r=n:k.sibling=n;k=n}a&&q.forEach(function(a){return b(e,a)});return r}return function(a,d,f,l){\"object\"===typeof f&&null!==f&&f.type===sc&&null===f.key&&(f=f.props.children);var g=\"object\"===typeof f&&null!==f;if(g)switch(f.$$typeof){case oc:a:{var k=f.key;for(g=d;null!==g;){if(g.key===k)if(10===g.tag?f.type===sc:g.type===f.type){c(a,g.sibling);d=e(g,f.type===sc?f.props.children:f.props,l);d.ref=Ve(a,g,f);d[\"return\"]=a;a=d;break a}else{c(a,g);break}else b(a,g);g=g.sibling}f.type===\nsc?(d=Be(f.props.children,a.mode,l,f.key),d[\"return\"]=a,a=d):(l=Ae(f,a.mode,l),l.ref=Ve(a,d,f),l[\"return\"]=a,a=l)}return h(a);case rc:a:{for(g=f.key;null!==d;){if(d.key===g)if(4===d.tag&&d.stateNode.containerInfo===f.containerInfo&&d.stateNode.implementation===f.implementation){c(a,d.sibling);d=e(d,f.children||[],l);d[\"return\"]=a;a=d;break a}else{c(a,d);break}else b(a,d);d=d.sibling}d=De(f,a.mode,l);d[\"return\"]=a;a=d}return h(a)}if(\"string\"===typeof f||\"number\"===typeof f)return f=\"\"+f,null!==d&&\n6===d.tag?(c(a,d.sibling),d=e(d,f,l),d[\"return\"]=a,a=d):(c(a,d),d=Ce(f,a.mode,l),d[\"return\"]=a,a=d),h(a);if(Ue(f))return r(a,d,f,l);if(zc(f))return Q(a,d,f,l);g&&We(a,f);if(\"undefined\"===typeof f)switch(a.tag){case 2:case 1:l=a.type,D(\"152\",l.displayName||l.name||\"Component\")}return c(a,d)}}var Ye=Xe(!0),Ze=Xe(!1);\nfunction $e(a,b,c,d,e,f,h){function g(a,b,c){k(a,b,c,b.expirationTime)}function k(a,b,c,d){b.child=null===a?Ze(b,null,c,d):Ye(b,a.child,c,d)}function v(a,b){var c=b.ref;if(null===a&&null!==c||null!==a&&a.ref!==c)b.effectTag|=128}function l(a,b,c,d,e,f){v(a,b);if(!c&&!e)return d&&y(b,!1),r(a,b);c=b.stateNode;nc.current=b;var l=e?null:c.render();b.effectTag|=1;e&&(k(a,b,null,f),b.child=null);k(a,b,l,f);b.memoizedState=c.state;b.memoizedProps=c.props;d&&y(b,!0);return b.child}function p(a){var b=a.stateNode;\nb.pendingContext?t(a,b.pendingContext,b.pendingContext!==b.context):b.context&&t(a,b.context,!1);Y(a,b.containerInfo)}function z(a,b,c,d){var e=a.child;for(null!==e&&(e[\"return\"]=a);null!==e;){switch(e.tag){case 12:var f=e.stateNode|0;if(e.type===b&&0!==(f&c)){for(f=e;null!==f;){var l=f.alternate;if(0===f.expirationTime||f.expirationTime>d)f.expirationTime=d,null!==l&&(0===l.expirationTime||l.expirationTime>d)&&(l.expirationTime=d);else if(null!==l&&(0===l.expirationTime||l.expirationTime>d))l.expirationTime=\nd;else break;f=f[\"return\"]}f=null}else f=e.child;break;case 13:f=e.type===a.type?null:e.child;break;default:f=e.child}if(null!==f)f[\"return\"]=e;else for(f=e;null!==f;){if(f===a){f=null;break}e=f.sibling;if(null!==e){f=e;break}f=f[\"return\"]}e=f}}function B(a,b,c){var d=b.type._context,e=b.pendingProps,f=b.memoizedProps;if(!q()&&f===e)return b.stateNode=0,G(b),r(a,b);var l=e.value;b.memoizedProps=e;if(null===f)l=1073741823;else if(f.value===e.value){if(f.children===e.children)return b.stateNode=0,G(b),\nr(a,b);l=0}else{var h=f.value;if(h===l&&(0!==h||1/h===1/l)||h!==h&&l!==l){if(f.children===e.children)return b.stateNode=0,G(b),r(a,b);l=0}else if(l=\"function\"===typeof d._calculateChangedBits?d._calculateChangedBits(h,l):1073741823,l|=0,0===l){if(f.children===e.children)return b.stateNode=0,G(b),r(a,b)}else z(b,d,l,c)}b.stateNode=l;G(b);g(a,b,e.children);return b.child}function r(a,b){null!==a&&b.child!==a.child?D(\"153\"):void 0;if(null!==b.child){a=b.child;var c=ze(a,a.pendingProps,a.expirationTime);\nb.child=c;for(c[\"return\"]=b;null!==a.sibling;)a=a.sibling,c=c.sibling=ze(a,a.pendingProps,a.expirationTime),c[\"return\"]=b;c.sibling=null}return b.child}var Q=a.shouldSetTextContent,n=a.shouldDeprioritizeSubtree,x=b.pushHostContext,Y=b.pushHostContainer,G=d.pushProvider,R=c.getMaskedContext,S=c.getUnmaskedContext,q=c.hasContextChanged,u=c.pushContextProvider,t=c.pushTopLevelContextObject,y=c.invalidateContextProvider,H=e.enterHydrationState,Wa=e.resetHydrationState,Cb=e.tryToClaimNextHydratableInstance;\na=Te(c,f,h,function(a,b){a.memoizedProps=b},function(a,b){a.memoizedState=b});var Jc=a.adoptClassInstance,Kc=a.callGetDerivedStateFromProps,Lc=a.constructClassInstance,Db=a.mountClassInstance,Mc=a.resumeMountClassInstance,Eb=a.updateClassInstance;return{beginWork:function(a,b,c){if(0===b.expirationTime||b.expirationTime>c){switch(b.tag){case 3:p(b);break;case 2:u(b);break;case 4:Y(b,b.stateNode.containerInfo);break;case 13:G(b)}return null}switch(b.tag){case 0:null!==a?D(\"155\"):void 0;var d=b.type,\ne=b.pendingProps,f=S(b);f=R(b,f);d=d(e,f);b.effectTag|=1;\"object\"===typeof d&&null!==d&&\"function\"===typeof d.render&&void 0===d.$$typeof?(f=b.type,b.tag=2,b.memoizedState=null!==d.state&&void 0!==d.state?d.state:null,\"function\"===typeof f.getDerivedStateFromProps&&(e=Kc(b,d,e,b.memoizedState),null!==e&&void 0!==e&&(b.memoizedState=A({},b.memoizedState,e))),e=u(b),Jc(b,d),Db(b,c),a=l(a,b,!0,e,!1,c)):(b.tag=1,g(a,b,d),b.memoizedProps=e,a=b.child);return a;case 1:return e=b.type,c=b.pendingProps,q()||\nb.memoizedProps!==c?(d=S(b),d=R(b,d),e=e(c,d),b.effectTag|=1,g(a,b,e),b.memoizedProps=c,a=b.child):a=r(a,b),a;case 2:e=u(b);null===a?null===b.stateNode?(Lc(b,b.pendingProps),Db(b,c),d=!0):d=Mc(b,c):d=Eb(a,b,c);f=!1;var h=b.updateQueue;null!==h&&null!==h.capturedValues&&(f=d=!0);return l(a,b,d,e,f,c);case 3:a:if(p(b),d=b.updateQueue,null!==d){f=b.memoizedState;e=Re(a,b,d,null,null,c);b.memoizedState=e;d=b.updateQueue;if(null!==d&&null!==d.capturedValues)d=null;else if(f===e){Wa();a=r(a,b);break a}else d=\ne.element;f=b.stateNode;(null===a||null===a.child)&&f.hydrate&&H(b)?(b.effectTag|=2,b.child=Ze(b,null,d,c)):(Wa(),g(a,b,d));b.memoizedState=e;a=b.child}else Wa(),a=r(a,b);return a;case 5:a:{x(b);null===a&&Cb(b);e=b.type;h=b.memoizedProps;d=b.pendingProps;f=null!==a?a.memoizedProps:null;if(!q()&&h===d){if(h=b.mode&1&&n(e,d))b.expirationTime=1073741823;if(!h||1073741823!==c){a=r(a,b);break a}}h=d.children;Q(e,d)?h=null:f&&Q(e,f)&&(b.effectTag|=16);v(a,b);1073741823!==c&&b.mode&1&&n(e,d)?(b.expirationTime=\n1073741823,b.memoizedProps=d,a=null):(g(a,b,h),b.memoizedProps=d,a=b.child)}return a;case 6:return null===a&&Cb(b),b.memoizedProps=b.pendingProps,null;case 8:b.tag=7;case 7:return e=b.pendingProps,q()||b.memoizedProps!==e||(e=b.memoizedProps),d=e.children,b.stateNode=null===a?Ze(b,b.stateNode,d,c):Ye(b,a.stateNode,d,c),b.memoizedProps=e,b.stateNode;case 9:return null;case 4:return Y(b,b.stateNode.containerInfo),e=b.pendingProps,q()||b.memoizedProps!==e?(null===a?b.child=Ye(b,null,e,c):g(a,b,e),b.memoizedProps=\ne,a=b.child):a=r(a,b),a;case 14:return c=b.type.render,c=c(b.pendingProps,b.ref),g(a,b,c),b.memoizedProps=c,b.child;case 10:return c=b.pendingProps,q()||b.memoizedProps!==c?(g(a,b,c),b.memoizedProps=c,a=b.child):a=r(a,b),a;case 11:return c=b.pendingProps.children,q()||null!==c&&b.memoizedProps!==c?(g(a,b,c),b.memoizedProps=c,a=b.child):a=r(a,b),a;case 13:return B(a,b,c);case 12:a:{d=b.type;f=b.pendingProps;h=b.memoizedProps;e=d._currentValue;var t=d._changedBits;if(q()||0!==t||h!==f){b.memoizedProps=\nf;var k=f.unstable_observedBits;if(void 0===k||null===k)k=1073741823;b.stateNode=k;if(0!==(t&k))z(b,d,t,c);else if(h===f){a=r(a,b);break a}c=f.children;c=c(e);g(a,b,c);a=b.child}else a=r(a,b)}return a;default:D(\"156\")}}}}\nfunction af(a,b,c,d,e){function f(a){a.effectTag|=4}var h=a.createInstance,g=a.createTextInstance,k=a.appendInitialChild,v=a.finalizeInitialChildren,l=a.prepareUpdate,p=a.persistence,z=b.getRootHostContainer,B=b.popHostContext,r=b.getHostContext,Q=b.popHostContainer,n=c.popContextProvider,x=c.popTopLevelContextObject,Y=d.popProvider,G=e.prepareToHydrateHostInstance,R=e.prepareToHydrateHostTextInstance,S=e.popHydrationState,q=void 0,u=void 0,t=void 0;a.mutation?(q=function(){},u=function(a,b,c){(b.updateQueue=\nc)&&f(b)},t=function(a,b,c,d){c!==d&&f(b)}):p?D(\"235\"):D(\"236\");return{completeWork:function(a,b,c){var d=b.pendingProps;switch(b.tag){case 1:return null;case 2:return n(b),a=b.stateNode,d=b.updateQueue,null!==d&&null!==d.capturedValues&&(b.effectTag&=-65,\"function\"===typeof a.componentDidCatch?b.effectTag|=256:d.capturedValues=null),null;case 3:Q(b);x(b);d=b.stateNode;d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null);if(null===a||null===a.child)S(b),b.effectTag&=-3;q(b);a=b.updateQueue;\nnull!==a&&null!==a.capturedValues&&(b.effectTag|=256);return null;case 5:B(b);c=z();var e=b.type;if(null!==a&&null!=b.stateNode){var p=a.memoizedProps,H=b.stateNode,y=r();H=l(H,e,p,d,c,y);u(a,b,H,e,p,d,c,y);a.ref!==b.ref&&(b.effectTag|=128)}else{if(!d)return null===b.stateNode?D(\"166\"):void 0,null;a=r();if(S(b))G(b,c,a)&&f(b);else{p=h(e,d,c,a,b);a:for(y=b.child;null!==y;){if(5===y.tag||6===y.tag)k(p,y.stateNode);else if(4!==y.tag&&null!==y.child){y.child[\"return\"]=y;y=y.child;continue}if(y===b)break;\nfor(;null===y.sibling;){if(null===y[\"return\"]||y[\"return\"]===b)break a;y=y[\"return\"]}y.sibling[\"return\"]=y[\"return\"];y=y.sibling}v(p,e,d,c,a)&&f(b);b.stateNode=p}null!==b.ref&&(b.effectTag|=128)}return null;case 6:if(a&&null!=b.stateNode)t(a,b,a.memoizedProps,d);else{if(\"string\"!==typeof d)return null===b.stateNode?D(\"166\"):void 0,null;a=z();c=r();S(b)?R(b)&&f(b):b.stateNode=g(d,a,c,b)}return null;case 7:(d=b.memoizedProps)?void 0:D(\"165\");b.tag=8;e=[];a:for((p=b.stateNode)&&(p[\"return\"]=b);null!==\np;){if(5===p.tag||6===p.tag||4===p.tag)D(\"247\");else if(9===p.tag)e.push(p.pendingProps.value);else if(null!==p.child){p.child[\"return\"]=p;p=p.child;continue}for(;null===p.sibling;){if(null===p[\"return\"]||p[\"return\"]===b)break a;p=p[\"return\"]}p.sibling[\"return\"]=p[\"return\"];p=p.sibling}p=d.handler;d=p(d.props,e);b.child=Ye(b,null!==a?a.child:null,d,c);return b.child;case 8:return b.tag=7,null;case 9:return null;case 14:return null;case 10:return null;case 11:return null;case 4:return Q(b),q(b),null;\ncase 13:return Y(b),null;case 12:return null;case 0:D(\"167\");default:D(\"156\")}}}}\nfunction bf(a,b,c,d,e){var f=a.popHostContainer,h=a.popHostContext,g=b.popContextProvider,k=b.popTopLevelContextObject,v=c.popProvider;return{throwException:function(a,b,c){b.effectTag|=512;b.firstEffect=b.lastEffect=null;b={value:c,source:b,stack:Bc(b)};do{switch(a.tag){case 3:Oe(a);a.updateQueue.capturedValues=[b];a.effectTag|=1024;return;case 2:if(c=a.stateNode,0===(a.effectTag&64)&&null!==c&&\"function\"===typeof c.componentDidCatch&&!e(c)){Oe(a);c=a.updateQueue;var d=c.capturedValues;null===d?\nc.capturedValues=[b]:d.push(b);a.effectTag|=1024;return}}a=a[\"return\"]}while(null!==a)},unwindWork:function(a){switch(a.tag){case 2:g(a);var b=a.effectTag;return b&1024?(a.effectTag=b&-1025|64,a):null;case 3:return f(a),k(a),b=a.effectTag,b&1024?(a.effectTag=b&-1025|64,a):null;case 5:return h(a),null;case 4:return f(a),null;case 13:return v(a),null;default:return null}},unwindInterruptedWork:function(a){switch(a.tag){case 2:g(a);break;case 3:f(a);k(a);break;case 5:h(a);break;case 4:f(a);break;case 13:v(a)}}}}\nfunction cf(a,b){var c=b.source;null===b.stack&&Bc(c);null!==c&&Ac(c);b=b.value;null!==a&&2===a.tag&&Ac(a);try{b&&b.suppressReactErrorLogging||console.error(b)}catch(d){d&&d.suppressReactErrorLogging||console.error(d)}}\nfunction df(a,b,c,d,e){function f(a){var c=a.ref;if(null!==c)if(\"function\"===typeof c)try{c(null)}catch(t){b(a,t)}else c.current=null}function h(a){\"function\"===typeof Je&&Je(a);switch(a.tag){case 2:f(a);var c=a.stateNode;if(\"function\"===typeof c.componentWillUnmount)try{c.props=a.memoizedProps,c.state=a.memoizedState,c.componentWillUnmount()}catch(t){b(a,t)}break;case 5:f(a);break;case 7:g(a.stateNode);break;case 4:p&&v(a)}}function g(a){for(var b=a;;)if(h(b),null===b.child||p&&4===b.tag){if(b===\na)break;for(;null===b.sibling;){if(null===b[\"return\"]||b[\"return\"]===a)return;b=b[\"return\"]}b.sibling[\"return\"]=b[\"return\"];b=b.sibling}else b.child[\"return\"]=b,b=b.child}function k(a){return 5===a.tag||3===a.tag||4===a.tag}function v(a){for(var b=a,c=!1,d=void 0,e=void 0;;){if(!c){c=b[\"return\"];a:for(;;){null===c?D(\"160\"):void 0;switch(c.tag){case 5:d=c.stateNode;e=!1;break a;case 3:d=c.stateNode.containerInfo;e=!0;break a;case 4:d=c.stateNode.containerInfo;e=!0;break a}c=c[\"return\"]}c=!0}if(5===\nb.tag||6===b.tag)g(b),e?S(d,b.stateNode):R(d,b.stateNode);else if(4===b.tag?d=b.stateNode.containerInfo:h(b),null!==b.child){b.child[\"return\"]=b;b=b.child;continue}if(b===a)break;for(;null===b.sibling;){if(null===b[\"return\"]||b[\"return\"]===a)return;b=b[\"return\"];4===b.tag&&(c=!1)}b.sibling[\"return\"]=b[\"return\"];b=b.sibling}}var l=a.getPublicInstance,p=a.mutation;a=a.persistence;p||(a?D(\"235\"):D(\"236\"));var z=p.commitMount,B=p.commitUpdate,r=p.resetTextContent,Q=p.commitTextUpdate,n=p.appendChild,\nx=p.appendChildToContainer,Y=p.insertBefore,G=p.insertInContainerBefore,R=p.removeChild,S=p.removeChildFromContainer;return{commitBeforeMutationLifeCycles:function(a,b){switch(b.tag){case 2:if(b.effectTag&2048&&null!==a){var c=a.memoizedProps,d=a.memoizedState;a=b.stateNode;a.props=b.memoizedProps;a.state=b.memoizedState;b=a.getSnapshotBeforeUpdate(c,d);a.__reactInternalSnapshotBeforeUpdate=b}break;case 3:case 5:case 6:case 4:break;default:D(\"163\")}},commitResetTextContent:function(a){r(a.stateNode)},\ncommitPlacement:function(a){a:{for(var b=a[\"return\"];null!==b;){if(k(b)){var c=b;break a}b=b[\"return\"]}D(\"160\");c=void 0}var d=b=void 0;switch(c.tag){case 5:b=c.stateNode;d=!1;break;case 3:b=c.stateNode.containerInfo;d=!0;break;case 4:b=c.stateNode.containerInfo;d=!0;break;default:D(\"161\")}c.effectTag&16&&(r(b),c.effectTag&=-17);a:b:for(c=a;;){for(;null===c.sibling;){if(null===c[\"return\"]||k(c[\"return\"])){c=null;break a}c=c[\"return\"]}c.sibling[\"return\"]=c[\"return\"];for(c=c.sibling;5!==c.tag&&6!==\nc.tag;){if(c.effectTag&2)continue b;if(null===c.child||4===c.tag)continue b;else c.child[\"return\"]=c,c=c.child}if(!(c.effectTag&2)){c=c.stateNode;break a}}for(var e=a;;){if(5===e.tag||6===e.tag)c?d?G(b,e.stateNode,c):Y(b,e.stateNode,c):d?x(b,e.stateNode):n(b,e.stateNode);else if(4!==e.tag&&null!==e.child){e.child[\"return\"]=e;e=e.child;continue}if(e===a)break;for(;null===e.sibling;){if(null===e[\"return\"]||e[\"return\"]===a)return;e=e[\"return\"]}e.sibling[\"return\"]=e[\"return\"];e=e.sibling}},commitDeletion:function(a){v(a);\na[\"return\"]=null;a.child=null;a.alternate&&(a.alternate.child=null,a.alternate[\"return\"]=null)},commitWork:function(a,b){switch(b.tag){case 2:break;case 5:var c=b.stateNode;if(null!=c){var d=b.memoizedProps;a=null!==a?a.memoizedProps:d;var e=b.type,f=b.updateQueue;b.updateQueue=null;null!==f&&B(c,f,e,a,d,b)}break;case 6:null===b.stateNode?D(\"162\"):void 0;c=b.memoizedProps;Q(b.stateNode,null!==a?a.memoizedProps:c,c);break;case 3:break;default:D(\"163\")}},commitLifeCycles:function(a,b,c){switch(c.tag){case 2:a=\nc.stateNode;if(c.effectTag&4)if(null===b)a.props=c.memoizedProps,a.state=c.memoizedState,a.componentDidMount();else{var d=b.memoizedProps;b=b.memoizedState;a.props=c.memoizedProps;a.state=c.memoizedState;a.componentDidUpdate(d,b,a.__reactInternalSnapshotBeforeUpdate)}c=c.updateQueue;null!==c&&Se(c,a);break;case 3:b=c.updateQueue;if(null!==b){a=null;if(null!==c.child)switch(c.child.tag){case 5:a=l(c.child.stateNode);break;case 2:a=c.child.stateNode}Se(b,a)}break;case 5:a=c.stateNode;null===b&&c.effectTag&\n4&&z(a,c.type,c.memoizedProps,c);break;case 6:break;case 4:break;default:D(\"163\")}},commitErrorLogging:function(a,b){switch(a.tag){case 2:var c=a.type;b=a.stateNode;var d=a.updateQueue;null===d||null===d.capturedValues?D(\"264\"):void 0;var f=d.capturedValues;d.capturedValues=null;\"function\"!==typeof c.getDerivedStateFromCatch&&e(b);b.props=a.memoizedProps;b.state=a.memoizedState;for(c=0;c<f.length;c++){d=f[c];var l=d.value,g=d.stack;cf(a,d);b.componentDidCatch(l,{componentStack:null!==g?g:\"\"})}break;\ncase 3:c=a.updateQueue;null===c||null===c.capturedValues?D(\"264\"):void 0;f=c.capturedValues;c.capturedValues=null;for(c=0;c<f.length;c++)d=f[c],cf(a,d),b(d.value);break;default:D(\"265\")}},commitAttachRef:function(a){var b=a.ref;if(null!==b){var c=a.stateNode;switch(a.tag){case 5:a=l(c);break;default:a=c}\"function\"===typeof b?b(a):b.current=a}},commitDetachRef:function(a){a=a.ref;null!==a&&(\"function\"===typeof a?a(null):a.current=null)}}}var ef={};\nfunction ff(a,b){function c(a){a===ef?D(\"174\"):void 0;return a}var d=a.getChildHostContext,e=a.getRootHostContext;a=b.createCursor;var f=b.push,h=b.pop,g=a(ef),k=a(ef),v=a(ef);return{getHostContext:function(){return c(g.current)},getRootHostContainer:function(){return c(v.current)},popHostContainer:function(a){h(g,a);h(k,a);h(v,a)},popHostContext:function(a){k.current===a&&(h(g,a),h(k,a))},pushHostContainer:function(a,b){f(v,b,a);f(k,a,a);f(g,ef,a);b=e(b);h(g,a);f(g,b,a)},pushHostContext:function(a){var b=\nc(v.current),e=c(g.current);b=d(e,a.type,b);e!==b&&(f(k,a,a),f(g,b,a))}}}\nfunction gf(a){function b(a,b){var c=new xe(5,null,null,0);c.type=\"DELETED\";c.stateNode=b;c[\"return\"]=a;c.effectTag=8;null!==a.lastEffect?(a.lastEffect.nextEffect=c,a.lastEffect=c):a.firstEffect=a.lastEffect=c}function c(a,b){switch(a.tag){case 5:return b=f(b,a.type,a.pendingProps),null!==b?(a.stateNode=b,!0):!1;case 6:return b=h(b,a.pendingProps),null!==b?(a.stateNode=b,!0):!1;default:return!1}}function d(a){for(a=a[\"return\"];null!==a&&5!==a.tag&&3!==a.tag;)a=a[\"return\"];p=a}var e=a.shouldSetTextContent;\na=a.hydration;if(!a)return{enterHydrationState:function(){return!1},resetHydrationState:function(){},tryToClaimNextHydratableInstance:function(){},prepareToHydrateHostInstance:function(){D(\"175\")},prepareToHydrateHostTextInstance:function(){D(\"176\")},popHydrationState:function(){return!1}};var f=a.canHydrateInstance,h=a.canHydrateTextInstance,g=a.getNextHydratableSibling,k=a.getFirstHydratableChild,v=a.hydrateInstance,l=a.hydrateTextInstance,p=null,z=null,B=!1;return{enterHydrationState:function(a){z=\nk(a.stateNode.containerInfo);p=a;return B=!0},resetHydrationState:function(){z=p=null;B=!1},tryToClaimNextHydratableInstance:function(a){if(B){var d=z;if(d){if(!c(a,d)){d=g(d);if(!d||!c(a,d)){a.effectTag|=2;B=!1;p=a;return}b(p,z)}p=a;z=k(d)}else a.effectTag|=2,B=!1,p=a}},prepareToHydrateHostInstance:function(a,b,c){b=v(a.stateNode,a.type,a.memoizedProps,b,c,a);a.updateQueue=b;return null!==b?!0:!1},prepareToHydrateHostTextInstance:function(a){return l(a.stateNode,a.memoizedProps,a)},popHydrationState:function(a){if(a!==\np)return!1;if(!B)return d(a),B=!0,!1;var c=a.type;if(5!==a.tag||\"head\"!==c&&\"body\"!==c&&!e(c,a.memoizedProps))for(c=z;c;)b(a,c),c=g(c);d(a);z=p?g(a.stateNode):null;return!0}}}\nfunction hf(a){function b(a,b,c){a=a.stateNode;a.__reactInternalMemoizedUnmaskedChildContext=b;a.__reactInternalMemoizedMaskedChildContext=c}function c(a){return 2===a.tag&&null!=a.type.childContextTypes}function d(a,b){var c=a.stateNode,d=a.type.childContextTypes;if(\"function\"!==typeof c.getChildContext)return b;c=c.getChildContext();for(var e in c)e in d?void 0:D(\"108\",Ac(a)||\"Unknown\",e);return A({},b,c)}var e=a.createCursor,f=a.push,h=a.pop,g=e(ka),k=e(!1),v=ka;return{getUnmaskedContext:function(a){return c(a)?\nv:g.current},cacheContext:b,getMaskedContext:function(a,c){var d=a.type.contextTypes;if(!d)return ka;var e=a.stateNode;if(e&&e.__reactInternalMemoizedUnmaskedChildContext===c)return e.__reactInternalMemoizedMaskedChildContext;var f={},g;for(g in d)f[g]=c[g];e&&b(a,c,f);return f},hasContextChanged:function(){return k.current},isContextConsumer:function(a){return 2===a.tag&&null!=a.type.contextTypes},isContextProvider:c,popContextProvider:function(a){c(a)&&(h(k,a),h(g,a))},popTopLevelContextObject:function(a){h(k,\na);h(g,a)},pushTopLevelContextObject:function(a,b,c){null!=g.cursor?D(\"168\"):void 0;f(g,b,a);f(k,c,a)},processChildContext:d,pushContextProvider:function(a){if(!c(a))return!1;var b=a.stateNode;b=b&&b.__reactInternalMemoizedMergedChildContext||ka;v=g.current;f(g,b,a);f(k,k.current,a);return!0},invalidateContextProvider:function(a,b){var c=a.stateNode;c?void 0:D(\"169\");if(b){var e=d(a,v);c.__reactInternalMemoizedMergedChildContext=e;h(k,a);h(g,a);f(g,e,a)}else h(k,a);f(k,b,a)},findCurrentUnmaskedContext:function(a){for(2!==\nxd(a)||2!==a.tag?D(\"170\"):void 0;3!==a.tag;){if(c(a))return a.stateNode.__reactInternalMemoizedMergedChildContext;(a=a[\"return\"])?void 0:D(\"171\")}return a.stateNode.context}}}\nfunction jf(a){var b=a.createCursor,c=a.push,d=a.pop,e=b(null),f=b(null),h=b(0);return{pushProvider:function(a){var b=a.type._context;c(h,b._changedBits,a);c(f,b._currentValue,a);c(e,a,a);b._currentValue=a.pendingProps.value;b._changedBits=a.stateNode},popProvider:function(a){var b=h.current,c=f.current;d(e,a);d(f,a);d(h,a);a=a.type._context;a._currentValue=c;a._changedBits=b}}}\nfunction kf(){var a=[],b=-1;return{createCursor:function(a){return{current:a}},isEmpty:function(){return-1===b},pop:function(c){0>b||(c.current=a[b],a[b]=null,b--)},push:function(c,d){b++;a[b]=c.current;c.current=d},checkThatStackIsEmpty:function(){},resetStackAfterFatalErrorInDev:function(){}}}\nfunction lf(a){function b(){if(null!==I)for(var a=I[\"return\"];null!==a;)Lc(a),a=a[\"return\"];Ya=null;Z=0;I=null;Nc=!1}function c(a){return null!==ya&&ya.has(a)}function d(a){for(;;){var b=a.alternate,c=a[\"return\"],d=a.sibling;if(0===(a.effectTag&512)){b=Cb(b,a,Z);var e=a;if(1073741823===Z||1073741823!==e.expirationTime){b:switch(e.tag){case 3:case 2:var f=e.updateQueue;f=null===f?0:f.expirationTime;break b;default:f=0}for(var g=e.child;null!==g;)0!==g.expirationTime&&(0===f||f>g.expirationTime)&&(f=\ng.expirationTime),g=g.sibling;e.expirationTime=f}if(null!==b)return b;null!==c&&0===(c.effectTag&512)&&(null===c.firstEffect&&(c.firstEffect=a.firstEffect),null!==a.lastEffect&&(null!==c.lastEffect&&(c.lastEffect.nextEffect=a.firstEffect),c.lastEffect=a.lastEffect),1<a.effectTag&&(null!==c.lastEffect?c.lastEffect.nextEffect=a:c.firstEffect=a,c.lastEffect=a));if(null!==d)return d;if(null!==c)a=c;else{Nc=!0;break}}else{a=Kc(a);if(null!==a)return a.effectTag&=2559,a;null!==c&&(c.firstEffect=c.lastEffect=\nnull,c.effectTag|=512);if(null!==d)return d;if(null!==c)a=c;else break}}return null}function e(a){var b=Wa(a.alternate,a,Z);null===b&&(b=d(a));nc.current=null;return b}function f(a,c,f){ca?D(\"243\"):void 0;ca=!0;if(c!==Z||a!==Ya||null===I)b(),Ya=a,Z=c,I=ze(Ya.current,null,Z),a.pendingCommitExpirationTime=0;var g=!1;do{try{if(f)for(;null!==I&&!S();)I=e(I);else for(;null!==I;)I=e(I)}catch(Oc){if(null===I){g=!0;q(Oc);break}f=I;var h=f[\"return\"];if(null===h){g=!0;q(Oc);break}Jc(h,f,Oc);I=d(f)}break}while(1);\nca=!1;if(g||null!==I)return null;if(Nc)return a.pendingCommitExpirationTime=c,a.current.alternate;D(\"262\")}function h(a,b,c,d){a={value:c,source:a,stack:Bc(a)};Pe(b,{expirationTime:d,partialState:null,callback:null,isReplace:!1,isForced:!1,capturedValue:a,next:null});v(b,d)}function g(a,b){a:{ca&&!Za?D(\"263\"):void 0;for(var d=a[\"return\"];null!==d;){switch(d.tag){case 2:var e=d.stateNode;if(\"function\"===typeof d.type.getDerivedStateFromCatch||\"function\"===typeof e.componentDidCatch&&!c(e)){h(a,d,b,\n1);a=void 0;break a}break;case 3:h(a,d,b,1);a=void 0;break a}d=d[\"return\"]}3===a.tag&&h(a,a,b,1);a=void 0}return a}function k(a){a=0!==ia?ia:ca?Za?1:Z:a.mode&1?za?10*(((l()+15)/10|0)+1):25*(((l()+500)/25|0)+1):1;za&&(0===da||a>da)&&(da=a);return a}function v(a,c){a:{for(;null!==a;){if(0===a.expirationTime||a.expirationTime>c)a.expirationTime=c;null!==a.alternate&&(0===a.alternate.expirationTime||a.alternate.expirationTime>c)&&(a.alternate.expirationTime=c);if(null===a[\"return\"])if(3===a.tag){var d=\na.stateNode;!ca&&0!==Z&&c<Z&&b();ca&&!Za&&Ya===d||B(d,c);Fb>xg&&D(\"185\")}else{c=void 0;break a}a=a[\"return\"]}c=void 0}return c}function l(){ye=Ic()-Pc;return yg=(ye/10|0)+2}function p(a,b,c,d,e){var f=ia;ia=1;try{return a(b,c,d,e)}finally{ia=f}}function z(a){if(0!==Gb){if(a>Gb)return;mg(Qc)}var b=Ic()-Pc;Gb=a;Qc=lg(Q,{timeout:10*(a-2)-b})}function B(a,b){if(null===a.nextScheduledRoot)a.remainingExpirationTime=b,null===K?(la=K=a,a.nextScheduledRoot=a):(K=K.nextScheduledRoot=a,K.nextScheduledRoot=la);\nelse{var c=a.remainingExpirationTime;if(0===c||b<c)a.remainingExpirationTime=b}T||(J?Hb&&(aa=a,P=1,G(a,1,!1)):1===b?n():z(b))}function r(){var a=0,b=null;if(null!==K)for(var c=K,d=la;null!==d;){var e=d.remainingExpirationTime;if(0===e){null===c||null===K?D(\"244\"):void 0;if(d===d.nextScheduledRoot){la=K=d.nextScheduledRoot=null;break}else if(d===la)la=e=d.nextScheduledRoot,K.nextScheduledRoot=e,d.nextScheduledRoot=null;else if(d===K){K=c;K.nextScheduledRoot=la;d.nextScheduledRoot=null;break}else c.nextScheduledRoot=\nd.nextScheduledRoot,d.nextScheduledRoot=null;d=c.nextScheduledRoot}else{if(0===a||e<a)a=e,b=d;if(d===K)break;c=d;d=d.nextScheduledRoot}}c=aa;null!==c&&c===b&&1===a?Fb++:Fb=0;aa=b;P=a}function Q(a){x(0,!0,a)}function n(){x(1,!1,null)}function x(a,b,c){$a=c;r();if(b)for(;null!==aa&&0!==P&&(0===a||a>=P)&&(!Ib||l()>=P);)G(aa,P,!Ib),r();else for(;null!==aa&&0!==P&&(0===a||a>=P);)G(aa,P,!1),r();null!==$a&&(Gb=0,Qc=-1);0!==P&&z(P);$a=null;Ib=!1;Y()}function Y(){Fb=0;if(null!==Aa){var a=Aa;Aa=null;for(var b=\n0;b<a.length;b++){var c=a[b];try{c._onComplete()}catch(wg){Ba||(Ba=!0,Jb=wg)}}}if(Ba)throw a=Jb,Jb=null,Ba=!1,a;}function G(a,b,c){T?D(\"245\"):void 0;T=!0;c?(c=a.finishedWork,null!==c?R(a,c,b):(a.finishedWork=null,c=f(a,b,!0),null!==c&&(S()?a.finishedWork=c:R(a,c,b)))):(c=a.finishedWork,null!==c?R(a,c,b):(a.finishedWork=null,c=f(a,b,!1),null!==c&&R(a,c,b)));T=!1}function R(a,b,c){var d=a.firstBatch;if(null!==d&&d._expirationTime<=c&&(null===Aa?Aa=[d]:Aa.push(d),d._defer)){a.finishedWork=b;a.remainingExpirationTime=\n0;return}a.finishedWork=null;Za=ca=!0;c=b.stateNode;c.current===b?D(\"177\"):void 0;d=c.pendingCommitExpirationTime;0===d?D(\"261\"):void 0;c.pendingCommitExpirationTime=0;var e=l();nc.current=null;if(1<b.effectTag)if(null!==b.lastEffect){b.lastEffect.nextEffect=b;var f=b.firstEffect}else f=b;else f=b.firstEffect;zg(c.containerInfo);for(w=f;null!==w;){var h=!1,k=void 0;try{for(;null!==w;)w.effectTag&2048&&Db(w.alternate,w),w=w.nextEffect}catch(ab){h=!0,k=ab}h&&(null===w?D(\"178\"):void 0,g(w,k),null!==\nw&&(w=w.nextEffect))}for(w=f;null!==w;){h=!1;k=void 0;try{for(;null!==w;){var p=w.effectTag;p&16&&Mc(w);if(p&128){var n=w.alternate;null!==n&&kg(n)}switch(p&14){case 2:Eb(w);w.effectTag&=-3;break;case 6:Eb(w);w.effectTag&=-3;we(w.alternate,w);break;case 4:we(w.alternate,w);break;case 8:gg(w)}w=w.nextEffect}}catch(ab){h=!0,k=ab}h&&(null===w?D(\"178\"):void 0,g(w,k),null!==w&&(w=w.nextEffect))}Ag(c.containerInfo);c.current=b;for(w=f;null!==w;){p=!1;n=void 0;try{for(f=c,h=e,k=d;null!==w;){var r=w.effectTag;\nr&36&&hg(f,w.alternate,w,h,k);r&256&&ig(w,q);r&128&&jg(w);var t=w.nextEffect;w.nextEffect=null;w=t}}catch(ab){p=!0,n=ab}p&&(null===w?D(\"178\"):void 0,g(w,n),null!==w&&(w=w.nextEffect))}ca=Za=!1;\"function\"===typeof Ie&&Ie(b.stateNode);b=c.current.expirationTime;0===b&&(ya=null);a.remainingExpirationTime=b}function S(){return null===$a||$a.timeRemaining()>Bg?!1:Ib=!0}function q(a){null===aa?D(\"246\"):void 0;aa.remainingExpirationTime=0;Ba||(Ba=!0,Jb=a)}var u=kf(),t=ff(a,u),y=hf(u);u=jf(u);var H=gf(a),\nWa=$e(a,t,y,u,H,v,k).beginWork,Cb=af(a,t,y,u,H).completeWork;t=bf(t,y,u,v,c);var Jc=t.throwException,Kc=t.unwindWork,Lc=t.unwindInterruptedWork;t=df(a,g,v,k,function(a){null===ya?ya=new Set([a]):ya.add(a)},l);var Db=t.commitBeforeMutationLifeCycles,Mc=t.commitResetTextContent,Eb=t.commitPlacement,gg=t.commitDeletion,we=t.commitWork,hg=t.commitLifeCycles,ig=t.commitErrorLogging,jg=t.commitAttachRef,kg=t.commitDetachRef,Ic=a.now,lg=a.scheduleDeferredCallback,mg=a.cancelDeferredCallback,zg=a.prepareForCommit,\nAg=a.resetAfterCommit,Pc=Ic(),yg=2,ye=Pc,Rc=0,ia=0,ca=!1,I=null,Ya=null,Z=0,w=null,Za=!1,Nc=!1,ya=null,la=null,K=null,Gb=0,Qc=-1,T=!1,aa=null,P=0,da=0,Ib=!1,Ba=!1,Jb=null,$a=null,J=!1,Hb=!1,za=!1,Aa=null,xg=1E3,Fb=0,Bg=1;return{recalculateCurrentTime:l,computeExpirationForFiber:k,scheduleWork:v,requestWork:B,flushRoot:function(a,b){T?D(\"253\"):void 0;aa=a;P=b;G(a,b,!1);n();Y()},batchedUpdates:function(a,b){var c=J;J=!0;try{return a(b)}finally{(J=c)||T||n()}},unbatchedUpdates:function(a,b){if(J&&!Hb){Hb=\n!0;try{return a(b)}finally{Hb=!1}}return a(b)},flushSync:function(a,b){T?D(\"187\"):void 0;var c=J;J=!0;try{return p(a,b)}finally{J=c,n()}},flushControlled:function(a){var b=J;J=!0;try{p(a)}finally{(J=b)||T||x(1,!1,null)}},deferredUpdates:function(a){var b=ia;ia=25*(((l()+500)/25|0)+1);try{return a()}finally{ia=b}},syncUpdates:p,interactiveUpdates:function(a,b,c){if(za)return a(b,c);J||T||0===da||(x(da,!1,null),da=0);var d=za,e=J;J=za=!0;try{return a(b,c)}finally{za=d,(J=e)||T||n()}},flushInteractiveUpdates:function(){T||\n0===da||(x(da,!1,null),da=0)},computeUniqueAsyncExpiration:function(){var a=25*(((l()+500)/25|0)+1);a<=Rc&&(a=Rc+1);return Rc=a},legacyContext:y}}\nfunction mf(a){function b(a,b,c,d,e,h){d=b.current;if(c){c=c._reactInternalFiber;var l=g(c);c=k(c)?v(c,l):l}else c=ka;null===b.context?b.context=c:b.pendingContext=c;b=h;Pe(d,{expirationTime:e,partialState:{element:a},callback:void 0===b?null:b,isReplace:!1,isForced:!1,capturedValue:null,next:null});f(d,e);return e}var c=a.getPublicInstance;a=lf(a);var d=a.recalculateCurrentTime,e=a.computeExpirationForFiber,f=a.scheduleWork,h=a.legacyContext,g=h.findCurrentUnmaskedContext,k=h.isContextProvider,v=\nh.processChildContext;return{createContainer:function(a,b,c){b=new xe(3,null,null,b?3:0);a={current:b,containerInfo:a,pendingChildren:null,pendingCommitExpirationTime:0,finishedWork:null,context:null,pendingContext:null,hydrate:c,remainingExpirationTime:0,firstBatch:null,nextScheduledRoot:null};return b.stateNode=a},updateContainer:function(a,c,f,h){var g=c.current,k=d();g=e(g);return b(a,c,f,k,g,h)},updateContainerAtExpirationTime:function(a,c,e,f,g){var h=d();return b(a,c,e,h,f,g)},flushRoot:a.flushRoot,\nrequestWork:a.requestWork,computeUniqueAsyncExpiration:a.computeUniqueAsyncExpiration,batchedUpdates:a.batchedUpdates,unbatchedUpdates:a.unbatchedUpdates,deferredUpdates:a.deferredUpdates,syncUpdates:a.syncUpdates,interactiveUpdates:a.interactiveUpdates,flushInteractiveUpdates:a.flushInteractiveUpdates,flushControlled:a.flushControlled,flushSync:a.flushSync,getPublicRootInstance:function(a){a=a.current;if(!a.child)return null;switch(a.child.tag){case 5:return c(a.child.stateNode);default:return a.child.stateNode}},\nfindHostInstance:function(a){var b=a._reactInternalFiber;void 0===b&&(\"function\"===typeof a.render?D(\"188\"):D(\"268\",Object.keys(a)));a=Bd(b);return null===a?null:a.stateNode},findHostInstanceWithNoPortals:function(a){a=Cd(a);return null===a?null:a.stateNode},injectIntoDevTools:function(a){var b=a.findFiberByHostInstance;return He(A({},a,{findHostInstanceByFiber:function(a){a=Bd(a);return null===a?null:a.stateNode},findFiberByHostInstance:function(a){return b?b(a):null}}))}}}\nvar nf=Object.freeze({default:mf}),of=nf&&mf||nf,pf=of[\"default\"]?of[\"default\"]:of;function qf(a,b,c){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:rc,key:null==d?null:\"\"+d,children:a,containerInfo:b,implementation:c}}var rf=\"object\"===typeof performance&&\"function\"===typeof performance.now,sf=void 0;sf=rf?function(){return performance.now()}:function(){return Date.now()};var tf=void 0,uf=void 0;\nif(m.canUseDOM)if(\"function\"!==typeof requestIdleCallback||\"function\"!==typeof cancelIdleCallback){var vf=null,wf=!1,xf=-1,yf=!1,zf=0,Af=33,Bf=33,Cf=void 0;Cf=rf?{didTimeout:!1,timeRemaining:function(){var a=zf-performance.now();return 0<a?a:0}}:{didTimeout:!1,timeRemaining:function(){var a=zf-Date.now();return 0<a?a:0}};var Df=\"__reactIdleCallback$\"+Math.random().toString(36).slice(2);window.addEventListener(\"message\",function(a){if(a.source===window&&a.data===Df){wf=!1;a=sf();if(0>=zf-a)if(-1!==\nxf&&xf<=a)Cf.didTimeout=!0;else{yf||(yf=!0,requestAnimationFrame(Ef));return}else Cf.didTimeout=!1;xf=-1;a=vf;vf=null;null!==a&&a(Cf)}},!1);var Ef=function(a){yf=!1;var b=a-zf+Bf;b<Bf&&Af<Bf?(8>b&&(b=8),Bf=b<Af?Af:b):Af=b;zf=a+Bf;wf||(wf=!0,window.postMessage(Df,\"*\"))};tf=function(a,b){vf=a;null!=b&&\"number\"===typeof b.timeout&&(xf=sf()+b.timeout);yf||(yf=!0,requestAnimationFrame(Ef));return 0};uf=function(){vf=null;wf=!1;xf=-1}}else tf=window.requestIdleCallback,uf=window.cancelIdleCallback;else tf=\nfunction(a){return setTimeout(function(){a({timeRemaining:function(){return Infinity},didTimeout:!1})})},uf=function(a){clearTimeout(a)};function Ff(a){var b=\"\";ea.Children.forEach(a,function(a){null==a||\"string\"!==typeof a&&\"number\"!==typeof a||(b+=a)});return b}function Gf(a,b){a=A({children:void 0},b);if(b=Ff(b.children))a.children=b;return a}\nfunction Hf(a,b,c,d){a=a.options;if(b){b={};for(var e=0;e<c.length;e++)b[\"$\"+c[e]]=!0;for(c=0;c<a.length;c++)e=b.hasOwnProperty(\"$\"+a[c].value),a[c].selected!==e&&(a[c].selected=e),e&&d&&(a[c].defaultSelected=!0)}else{c=\"\"+c;b=null;for(e=0;e<a.length;e++){if(a[e].value===c){a[e].selected=!0;d&&(a[e].defaultSelected=!0);return}null!==b||a[e].disabled||(b=a[e])}null!==b&&(b.selected=!0)}}\nfunction If(a,b){var c=b.value;a._wrapperState={initialValue:null!=c?c:b.defaultValue,wasMultiple:!!b.multiple}}function Jf(a,b){null!=b.dangerouslySetInnerHTML?D(\"91\"):void 0;return A({},b,{value:void 0,defaultValue:void 0,children:\"\"+a._wrapperState.initialValue})}function Kf(a,b){var c=b.value;null==c&&(c=b.defaultValue,b=b.children,null!=b&&(null!=c?D(\"92\"):void 0,Array.isArray(b)&&(1>=b.length?void 0:D(\"93\"),b=b[0]),c=\"\"+b),null==c&&(c=\"\"));a._wrapperState={initialValue:\"\"+c}}\nfunction Lf(a,b){var c=b.value;null!=c&&(c=\"\"+c,c!==a.value&&(a.value=c),null==b.defaultValue&&(a.defaultValue=c));null!=b.defaultValue&&(a.defaultValue=b.defaultValue)}function Mf(a){var b=a.textContent;b===a._wrapperState.initialValue&&(a.value=b)}var Nf={html:\"http://www.w3.org/1999/xhtml\",mathml:\"http://www.w3.org/1998/Math/MathML\",svg:\"http://www.w3.org/2000/svg\"};\nfunction Of(a){switch(a){case \"svg\":return\"http://www.w3.org/2000/svg\";case \"math\":return\"http://www.w3.org/1998/Math/MathML\";default:return\"http://www.w3.org/1999/xhtml\"}}function Pf(a,b){return null==a||\"http://www.w3.org/1999/xhtml\"===a?Of(b):\"http://www.w3.org/2000/svg\"===a&&\"foreignObject\"===b?\"http://www.w3.org/1999/xhtml\":a}\nvar Qf=void 0,Rf=function(a){return\"undefined\"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(b,c,d,e){MSApp.execUnsafeLocalFunction(function(){return a(b,c,d,e)})}:a}(function(a,b){if(a.namespaceURI!==Nf.svg||\"innerHTML\"in a)a.innerHTML=b;else{Qf=Qf||document.createElement(\"div\");Qf.innerHTML=\"\\x3csvg\\x3e\"+b+\"\\x3c/svg\\x3e\";for(b=Qf.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;b.firstChild;)a.appendChild(b.firstChild)}});\nfunction Sf(a,b){if(b){var c=a.firstChild;if(c&&c===a.lastChild&&3===c.nodeType){c.nodeValue=b;return}}a.textContent=b}\nvar Tf={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,\nstopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Uf=[\"Webkit\",\"ms\",\"Moz\",\"O\"];Object.keys(Tf).forEach(function(a){Uf.forEach(function(b){b=b+a.charAt(0).toUpperCase()+a.substring(1);Tf[b]=Tf[a]})});\nfunction Vf(a,b){a=a.style;for(var c in b)if(b.hasOwnProperty(c)){var d=0===c.indexOf(\"--\");var e=c;var f=b[c];e=null==f||\"boolean\"===typeof f||\"\"===f?\"\":d||\"number\"!==typeof f||0===f||Tf.hasOwnProperty(e)&&Tf[e]?(\"\"+f).trim():f+\"px\";\"float\"===c&&(c=\"cssFloat\");d?a.setProperty(c,e):a[c]=e}}var Wf=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});\nfunction Xf(a,b,c){b&&(Wf[a]&&(null!=b.children||null!=b.dangerouslySetInnerHTML?D(\"137\",a,c()):void 0),null!=b.dangerouslySetInnerHTML&&(null!=b.children?D(\"60\"):void 0,\"object\"===typeof b.dangerouslySetInnerHTML&&\"__html\"in b.dangerouslySetInnerHTML?void 0:D(\"61\")),null!=b.style&&\"object\"!==typeof b.style?D(\"62\",c()):void 0)}\nfunction Yf(a,b){if(-1===a.indexOf(\"-\"))return\"string\"===typeof b.is;switch(a){case \"annotation-xml\":case \"color-profile\":case \"font-face\":case \"font-face-src\":case \"font-face-uri\":case \"font-face-format\":case \"font-face-name\":case \"missing-glyph\":return!1;default:return!0}}var Zf=C.thatReturns(\"\");\nfunction $f(a,b){a=9===a.nodeType||11===a.nodeType?a:a.ownerDocument;var c=ke(a);b=va[b];for(var d=0;d<b.length;d++){var e=b[d];c.hasOwnProperty(e)&&c[e]||(\"topScroll\"===e?Zd(\"topScroll\",\"scroll\",a):\"topFocus\"===e||\"topBlur\"===e?(Zd(\"topFocus\",\"focus\",a),Zd(\"topBlur\",\"blur\",a),c.topBlur=!0,c.topFocus=!0):\"topCancel\"===e?(ic(\"cancel\",!0)&&Zd(\"topCancel\",\"cancel\",a),c.topCancel=!0):\"topClose\"===e?(ic(\"close\",!0)&&Zd(\"topClose\",\"close\",a),c.topClose=!0):fe.hasOwnProperty(e)&&W(e,fe[e],a),c[e]=!0)}}\nfunction ag(a,b,c,d){c=9===c.nodeType?c:c.ownerDocument;d===Nf.html&&(d=Of(a));d===Nf.html?\"script\"===a?(a=c.createElement(\"div\"),a.innerHTML=\"\\x3cscript\\x3e\\x3c/script\\x3e\",a=a.removeChild(a.firstChild)):a=\"string\"===typeof b.is?c.createElement(a,{is:b.is}):c.createElement(a):a=c.createElementNS(d,a);return a}function bg(a,b){return(9===b.nodeType?b:b.ownerDocument).createTextNode(a)}\nfunction cg(a,b,c,d){var e=Yf(b,c);switch(b){case \"iframe\":case \"object\":W(\"topLoad\",\"load\",a);var f=c;break;case \"video\":case \"audio\":for(f in ge)ge.hasOwnProperty(f)&&W(f,ge[f],a);f=c;break;case \"source\":W(\"topError\",\"error\",a);f=c;break;case \"img\":case \"image\":case \"link\":W(\"topError\",\"error\",a);W(\"topLoad\",\"load\",a);f=c;break;case \"form\":W(\"topReset\",\"reset\",a);W(\"topSubmit\",\"submit\",a);f=c;break;case \"details\":W(\"topToggle\",\"toggle\",a);f=c;break;case \"input\":Wc(a,c);f=Vc(a,c);W(\"topInvalid\",\n\"invalid\",a);$f(d,\"onChange\");break;case \"option\":f=Gf(a,c);break;case \"select\":If(a,c);f=A({},c,{value:void 0});W(\"topInvalid\",\"invalid\",a);$f(d,\"onChange\");break;case \"textarea\":Kf(a,c);f=Jf(a,c);W(\"topInvalid\",\"invalid\",a);$f(d,\"onChange\");break;default:f=c}Xf(b,f,Zf);var h=f,g;for(g in h)if(h.hasOwnProperty(g)){var k=h[g];\"style\"===g?Vf(a,k,Zf):\"dangerouslySetInnerHTML\"===g?(k=k?k.__html:void 0,null!=k&&Rf(a,k)):\"children\"===g?\"string\"===typeof k?(\"textarea\"!==b||\"\"!==k)&&Sf(a,k):\"number\"===typeof k&&\nSf(a,\"\"+k):\"suppressContentEditableWarning\"!==g&&\"suppressHydrationWarning\"!==g&&\"autoFocus\"!==g&&(ua.hasOwnProperty(g)?null!=k&&$f(d,g):null!=k&&Uc(a,g,k,e))}switch(b){case \"input\":lc(a);ad(a,c);break;case \"textarea\":lc(a);Mf(a,c);break;case \"option\":null!=c.value&&a.setAttribute(\"value\",c.value);break;case \"select\":a.multiple=!!c.multiple;b=c.value;null!=b?Hf(a,!!c.multiple,b,!1):null!=c.defaultValue&&Hf(a,!!c.multiple,c.defaultValue,!0);break;default:\"function\"===typeof f.onClick&&(a.onclick=C)}}\nfunction dg(a,b,c,d,e){var f=null;switch(b){case \"input\":c=Vc(a,c);d=Vc(a,d);f=[];break;case \"option\":c=Gf(a,c);d=Gf(a,d);f=[];break;case \"select\":c=A({},c,{value:void 0});d=A({},d,{value:void 0});f=[];break;case \"textarea\":c=Jf(a,c);d=Jf(a,d);f=[];break;default:\"function\"!==typeof c.onClick&&\"function\"===typeof d.onClick&&(a.onclick=C)}Xf(b,d,Zf);b=a=void 0;var h=null;for(a in c)if(!d.hasOwnProperty(a)&&c.hasOwnProperty(a)&&null!=c[a])if(\"style\"===a){var g=c[a];for(b in g)g.hasOwnProperty(b)&&(h||\n(h={}),h[b]=\"\")}else\"dangerouslySetInnerHTML\"!==a&&\"children\"!==a&&\"suppressContentEditableWarning\"!==a&&\"suppressHydrationWarning\"!==a&&\"autoFocus\"!==a&&(ua.hasOwnProperty(a)?f||(f=[]):(f=f||[]).push(a,null));for(a in d){var k=d[a];g=null!=c?c[a]:void 0;if(d.hasOwnProperty(a)&&k!==g&&(null!=k||null!=g))if(\"style\"===a)if(g){for(b in g)!g.hasOwnProperty(b)||k&&k.hasOwnProperty(b)||(h||(h={}),h[b]=\"\");for(b in k)k.hasOwnProperty(b)&&g[b]!==k[b]&&(h||(h={}),h[b]=k[b])}else h||(f||(f=[]),f.push(a,h)),\nh=k;else\"dangerouslySetInnerHTML\"===a?(k=k?k.__html:void 0,g=g?g.__html:void 0,null!=k&&g!==k&&(f=f||[]).push(a,\"\"+k)):\"children\"===a?g===k||\"string\"!==typeof k&&\"number\"!==typeof k||(f=f||[]).push(a,\"\"+k):\"suppressContentEditableWarning\"!==a&&\"suppressHydrationWarning\"!==a&&(ua.hasOwnProperty(a)?(null!=k&&$f(e,a),f||g===k||(f=[])):(f=f||[]).push(a,k))}h&&(f=f||[]).push(\"style\",h);return f}\nfunction eg(a,b,c,d,e){\"input\"===c&&\"radio\"===e.type&&null!=e.name&&Yc(a,e);Yf(c,d);d=Yf(c,e);for(var f=0;f<b.length;f+=2){var h=b[f],g=b[f+1];\"style\"===h?Vf(a,g,Zf):\"dangerouslySetInnerHTML\"===h?Rf(a,g):\"children\"===h?Sf(a,g):Uc(a,h,g,d)}switch(c){case \"input\":Zc(a,e);break;case \"textarea\":Lf(a,e);break;case \"select\":a._wrapperState.initialValue=void 0,b=a._wrapperState.wasMultiple,a._wrapperState.wasMultiple=!!e.multiple,c=e.value,null!=c?Hf(a,!!e.multiple,c,!1):b!==!!e.multiple&&(null!=e.defaultValue?\nHf(a,!!e.multiple,e.defaultValue,!0):Hf(a,!!e.multiple,e.multiple?[]:\"\",!1))}}\nfunction fg(a,b,c,d,e){switch(b){case \"iframe\":case \"object\":W(\"topLoad\",\"load\",a);break;case \"video\":case \"audio\":for(var f in ge)ge.hasOwnProperty(f)&&W(f,ge[f],a);break;case \"source\":W(\"topError\",\"error\",a);break;case \"img\":case \"image\":case \"link\":W(\"topError\",\"error\",a);W(\"topLoad\",\"load\",a);break;case \"form\":W(\"topReset\",\"reset\",a);W(\"topSubmit\",\"submit\",a);break;case \"details\":W(\"topToggle\",\"toggle\",a);break;case \"input\":Wc(a,c);W(\"topInvalid\",\"invalid\",a);$f(e,\"onChange\");break;case \"select\":If(a,\nc);W(\"topInvalid\",\"invalid\",a);$f(e,\"onChange\");break;case \"textarea\":Kf(a,c),W(\"topInvalid\",\"invalid\",a),$f(e,\"onChange\")}Xf(b,c,Zf);d=null;for(var h in c)c.hasOwnProperty(h)&&(f=c[h],\"children\"===h?\"string\"===typeof f?a.textContent!==f&&(d=[\"children\",f]):\"number\"===typeof f&&a.textContent!==\"\"+f&&(d=[\"children\",\"\"+f]):ua.hasOwnProperty(h)&&null!=f&&$f(e,h));switch(b){case \"input\":lc(a);ad(a,c);break;case \"textarea\":lc(a);Mf(a,c);break;case \"select\":case \"option\":break;default:\"function\"===typeof c.onClick&&\n(a.onclick=C)}return d}function ng(a,b){return a.nodeValue!==b}\nvar og=Object.freeze({createElement:ag,createTextNode:bg,setInitialProperties:cg,diffProperties:dg,updateProperties:eg,diffHydratedProperties:fg,diffHydratedText:ng,warnForUnmatchedText:function(){},warnForDeletedHydratableElement:function(){},warnForDeletedHydratableText:function(){},warnForInsertedHydratedElement:function(){},warnForInsertedHydratedText:function(){},restoreControlledState:function(a,b,c){switch(b){case \"input\":Zc(a,c);b=c.name;if(\"radio\"===c.type&&null!=b){for(c=a;c.parentNode;)c=\nc.parentNode;c=c.querySelectorAll(\"input[name\\x3d\"+JSON.stringify(\"\"+b)+'][type\\x3d\"radio\"]');for(b=0;b<c.length;b++){var d=c[b];if(d!==a&&d.form===a.form){var e=Xa(d);e?void 0:D(\"90\");mc(d);Zc(d,e)}}}break;case \"textarea\":Lf(a,c);break;case \"select\":b=c.value,null!=b&&Hf(a,!!c.multiple,b,!1)}}});Tb.injectFiberControlledHostComponent(og);var pg=null,qg=null;\nfunction rg(a){this._expirationTime=X.computeUniqueAsyncExpiration();this._root=a;this._callbacks=this._next=null;this._hasChildren=this._didComplete=!1;this._children=null;this._defer=!0}rg.prototype.render=function(a){this._defer?void 0:D(\"250\");this._hasChildren=!0;this._children=a;var b=this._root._internalRoot,c=this._expirationTime,d=new sg;X.updateContainerAtExpirationTime(a,b,null,c,d._onCommit);return d};\nrg.prototype.then=function(a){if(this._didComplete)a();else{var b=this._callbacks;null===b&&(b=this._callbacks=[]);b.push(a)}};\nrg.prototype.commit=function(){var a=this._root._internalRoot,b=a.firstBatch;this._defer&&null!==b?void 0:D(\"251\");if(this._hasChildren){var c=this._expirationTime;if(b!==this){this._hasChildren&&(c=this._expirationTime=b._expirationTime,this.render(this._children));for(var d=null,e=b;e!==this;)d=e,e=e._next;null===d?D(\"251\"):void 0;d._next=e._next;this._next=b;a.firstBatch=this}this._defer=!1;X.flushRoot(a,c);b=this._next;this._next=null;b=a.firstBatch=b;null!==b&&b._hasChildren&&b.render(b._children)}else this._next=\nnull,this._defer=!1};rg.prototype._onComplete=function(){if(!this._didComplete){this._didComplete=!0;var a=this._callbacks;if(null!==a)for(var b=0;b<a.length;b++)(0,a[b])()}};function sg(){this._callbacks=null;this._didCommit=!1;this._onCommit=this._onCommit.bind(this)}sg.prototype.then=function(a){if(this._didCommit)a();else{var b=this._callbacks;null===b&&(b=this._callbacks=[]);b.push(a)}};\nsg.prototype._onCommit=function(){if(!this._didCommit){this._didCommit=!0;var a=this._callbacks;if(null!==a)for(var b=0;b<a.length;b++){var c=a[b];\"function\"!==typeof c?D(\"191\",c):void 0;c()}}};function tg(a,b,c){this._internalRoot=X.createContainer(a,b,c)}tg.prototype.render=function(a,b){var c=this._internalRoot,d=new sg;b=void 0===b?null:b;null!==b&&d.then(b);X.updateContainer(a,c,null,d._onCommit);return d};\ntg.prototype.unmount=function(a){var b=this._internalRoot,c=new sg;a=void 0===a?null:a;null!==a&&c.then(a);X.updateContainer(null,b,null,c._onCommit);return c};tg.prototype.legacy_renderSubtreeIntoContainer=function(a,b,c){var d=this._internalRoot,e=new sg;c=void 0===c?null:c;null!==c&&e.then(c);X.updateContainer(b,d,a,e._onCommit);return e};\ntg.prototype.createBatch=function(){var a=new rg(this),b=a._expirationTime,c=this._internalRoot,d=c.firstBatch;if(null===d)c.firstBatch=a,a._next=null;else{for(c=null;null!==d&&d._expirationTime<=b;)c=d,d=d._next;a._next=d;null!==c&&(c._next=a)}return a};function ug(a){return!(!a||1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType&&(8!==a.nodeType||\" react-mount-point-unstable \"!==a.nodeValue))}\nfunction vg(a,b){switch(a){case \"button\":case \"input\":case \"select\":case \"textarea\":return!!b.autoFocus}return!1}\nvar X=pf({getRootHostContext:function(a){var b=a.nodeType;switch(b){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:Pf(null,\"\");break;default:b=8===b?a.parentNode:a,a=b.namespaceURI||null,b=b.tagName,a=Pf(a,b)}return a},getChildHostContext:function(a,b){return Pf(a,b)},getPublicInstance:function(a){return a},prepareForCommit:function(){pg=Vd;var a=fa();if(ne(a)){if(\"selectionStart\"in a)var b={start:a.selectionStart,end:a.selectionEnd};else a:{var c=window.getSelection&&window.getSelection();\nif(c&&0!==c.rangeCount){b=c.anchorNode;var d=c.anchorOffset,e=c.focusNode;c=c.focusOffset;try{b.nodeType,e.nodeType}catch(B){b=null;break a}var f=0,h=-1,g=-1,k=0,v=0,l=a,p=null;b:for(;;){for(var z;;){l!==b||0!==d&&3!==l.nodeType||(h=f+d);l!==e||0!==c&&3!==l.nodeType||(g=f+c);3===l.nodeType&&(f+=l.nodeValue.length);if(null===(z=l.firstChild))break;p=l;l=z}for(;;){if(l===a)break b;p===b&&++k===d&&(h=f);p===e&&++v===c&&(g=f);if(null!==(z=l.nextSibling))break;l=p;p=l.parentNode}l=z}b=-1===h||-1===g?null:\n{start:h,end:g}}else b=null}b=b||{start:0,end:0}}else b=null;qg={focusedElem:a,selectionRange:b};Wd(!1)},resetAfterCommit:function(){var a=qg,b=fa(),c=a.focusedElem,d=a.selectionRange;if(b!==c&&ja(document.documentElement,c)){if(ne(c))if(b=d.start,a=d.end,void 0===a&&(a=b),\"selectionStart\"in c)c.selectionStart=b,c.selectionEnd=Math.min(a,c.value.length);else if(window.getSelection){b=window.getSelection();var e=c[mb()].length;a=Math.min(d.start,e);d=void 0===d.end?a:Math.min(d.end,e);!b.extend&&a>\nd&&(e=d,d=a,a=e);e=me(c,a);var f=me(c,d);if(e&&f&&(1!==b.rangeCount||b.anchorNode!==e.node||b.anchorOffset!==e.offset||b.focusNode!==f.node||b.focusOffset!==f.offset)){var h=document.createRange();h.setStart(e.node,e.offset);b.removeAllRanges();a>d?(b.addRange(h),b.extend(f.node,f.offset)):(h.setEnd(f.node,f.offset),b.addRange(h))}}b=[];for(a=c;a=a.parentNode;)1===a.nodeType&&b.push({element:a,left:a.scrollLeft,top:a.scrollTop});c.focus();for(c=0;c<b.length;c++)a=b[c],a.element.scrollLeft=a.left,\na.element.scrollTop=a.top}qg=null;Wd(pg);pg=null},createInstance:function(a,b,c,d,e){a=ag(a,b,c,d);a[F]=e;a[Ta]=b;return a},appendInitialChild:function(a,b){a.appendChild(b)},finalizeInitialChildren:function(a,b,c,d){cg(a,b,c,d);return vg(b,c)},prepareUpdate:function(a,b,c,d,e){return dg(a,b,c,d,e)},shouldSetTextContent:function(a,b){return\"textarea\"===a||\"string\"===typeof b.children||\"number\"===typeof b.children||\"object\"===typeof b.dangerouslySetInnerHTML&&null!==b.dangerouslySetInnerHTML&&\"string\"===\ntypeof b.dangerouslySetInnerHTML.__html},shouldDeprioritizeSubtree:function(a,b){return!!b.hidden},createTextInstance:function(a,b,c,d){a=bg(a,b);a[F]=d;return a},now:sf,mutation:{commitMount:function(a,b,c){vg(b,c)&&a.focus()},commitUpdate:function(a,b,c,d,e){a[Ta]=e;eg(a,b,c,d,e)},resetTextContent:function(a){Sf(a,\"\")},commitTextUpdate:function(a,b,c){a.nodeValue=c},appendChild:function(a,b){a.appendChild(b)},appendChildToContainer:function(a,b){8===a.nodeType?a.parentNode.insertBefore(b,a):a.appendChild(b)},\ninsertBefore:function(a,b,c){a.insertBefore(b,c)},insertInContainerBefore:function(a,b,c){8===a.nodeType?a.parentNode.insertBefore(b,c):a.insertBefore(b,c)},removeChild:function(a,b){a.removeChild(b)},removeChildFromContainer:function(a,b){8===a.nodeType?a.parentNode.removeChild(b):a.removeChild(b)}},hydration:{canHydrateInstance:function(a,b){return 1!==a.nodeType||b.toLowerCase()!==a.nodeName.toLowerCase()?null:a},canHydrateTextInstance:function(a,b){return\"\"===b||3!==a.nodeType?null:a},getNextHydratableSibling:function(a){for(a=\na.nextSibling;a&&1!==a.nodeType&&3!==a.nodeType;)a=a.nextSibling;return a},getFirstHydratableChild:function(a){for(a=a.firstChild;a&&1!==a.nodeType&&3!==a.nodeType;)a=a.nextSibling;return a},hydrateInstance:function(a,b,c,d,e,f){a[F]=f;a[Ta]=c;return fg(a,b,c,e,d)},hydrateTextInstance:function(a,b,c){a[F]=c;return ng(a,b)},didNotMatchHydratedContainerTextInstance:function(){},didNotMatchHydratedTextInstance:function(){},didNotHydrateContainerInstance:function(){},didNotHydrateInstance:function(){},\ndidNotFindHydratableContainerInstance:function(){},didNotFindHydratableContainerTextInstance:function(){},didNotFindHydratableInstance:function(){},didNotFindHydratableTextInstance:function(){}},scheduleDeferredCallback:tf,cancelDeferredCallback:uf}),Cg=X;ac=Cg.batchedUpdates;bc=Cg.interactiveUpdates;cc=Cg.flushInteractiveUpdates;\nfunction Dg(a,b){b||(b=a?9===a.nodeType?a.documentElement:a.firstChild:null,b=!(!b||1!==b.nodeType||!b.hasAttribute(\"data-reactroot\")));if(!b)for(var c;c=a.lastChild;)a.removeChild(c);return new tg(a,!1,b)}\nfunction Eg(a,b,c,d,e){ug(c)?void 0:D(\"200\");var f=c._reactRootContainer;if(f){if(\"function\"===typeof e){var h=e;e=function(){var a=X.getPublicRootInstance(f._internalRoot);h.call(a)}}null!=a?f.legacy_renderSubtreeIntoContainer(a,b,e):f.render(b,e)}else{f=c._reactRootContainer=Dg(c,d);if(\"function\"===typeof e){var g=e;e=function(){var a=X.getPublicRootInstance(f._internalRoot);g.call(a)}}X.unbatchedUpdates(function(){null!=a?f.legacy_renderSubtreeIntoContainer(a,b,e):f.render(b,e)})}return X.getPublicRootInstance(f._internalRoot)}\nfunction Fg(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;ug(b)?void 0:D(\"200\");return qf(a,b,null,c)}\nvar Gg={createPortal:Fg,findDOMNode:function(a){return null==a?null:1===a.nodeType?a:X.findHostInstance(a)},hydrate:function(a,b,c){return Eg(null,a,b,!0,c)},render:function(a,b,c){return Eg(null,a,b,!1,c)},unstable_renderSubtreeIntoContainer:function(a,b,c,d){null==a||void 0===a._reactInternalFiber?D(\"38\"):void 0;return Eg(a,b,c,!1,d)},unmountComponentAtNode:function(a){ug(a)?void 0:D(\"40\");return a._reactRootContainer?(X.unbatchedUpdates(function(){Eg(null,null,a,!1,function(){a._reactRootContainer=\nnull})}),!0):!1},unstable_createPortal:function(){return Fg.apply(void 0,arguments)},unstable_batchedUpdates:X.batchedUpdates,unstable_deferredUpdates:X.deferredUpdates,flushSync:X.flushSync,unstable_flushControlled:X.flushControlled,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{EventPluginHub:Ra,EventPluginRegistry:Ca,EventPropagators:kb,ReactControlledComponent:$b,ReactDOMComponentTree:bb,ReactDOMEventListener:$d},unstable_createRoot:function(a,b){return new tg(a,!0,null!=b&&!0===b.hydrate)}};\nX.injectIntoDevTools({findFiberByHostInstance:Ua,bundleType:0,version:\"16.3.2\",rendererPackageName:\"react-dom\"});var Hg=Object.freeze({default:Gg}),Ig=Hg&&Gg||Hg;module.exports=Ig[\"default\"]?Ig[\"default\"]:Ig;\n","/** @license React v16.3.2\n * react.production.min.js\n *\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';var m=require(\"object-assign\"),n=require(\"fbjs/lib/invariant\"),p=require(\"fbjs/lib/emptyObject\"),q=require(\"fbjs/lib/emptyFunction\"),r=\"function\"===typeof Symbol&&Symbol[\"for\"],t=r?Symbol[\"for\"](\"react.element\"):60103,u=r?Symbol[\"for\"](\"react.portal\"):60106,v=r?Symbol[\"for\"](\"react.fragment\"):60107,w=r?Symbol[\"for\"](\"react.strict_mode\"):60108,x=r?Symbol[\"for\"](\"react.provider\"):60109,y=r?Symbol[\"for\"](\"react.context\"):60110,z=r?Symbol[\"for\"](\"react.async_mode\"):60111,A=r?Symbol[\"for\"](\"react.forward_ref\"):\n60112,B=\"function\"===typeof Symbol&&Symbol.iterator;function C(a){for(var b=arguments.length-1,e=\"http://reactjs.org/docs/error-decoder.html?invariant\\x3d\"+a,c=0;c<b;c++)e+=\"\\x26args[]\\x3d\"+encodeURIComponent(arguments[c+1]);n(!1,\"Minified React error #\"+a+\"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. \",e)}var D={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}};\nfunction E(a,b,e){this.props=a;this.context=b;this.refs=p;this.updater=e||D}E.prototype.isReactComponent={};E.prototype.setState=function(a,b){\"object\"!==typeof a&&\"function\"!==typeof a&&null!=a?C(\"85\"):void 0;this.updater.enqueueSetState(this,a,b,\"setState\")};E.prototype.forceUpdate=function(a){this.updater.enqueueForceUpdate(this,a,\"forceUpdate\")};function F(){}F.prototype=E.prototype;function G(a,b,e){this.props=a;this.context=b;this.refs=p;this.updater=e||D}var H=G.prototype=new F;\nH.constructor=G;m(H,E.prototype);H.isPureReactComponent=!0;var I={current:null},J=Object.prototype.hasOwnProperty,K={key:!0,ref:!0,__self:!0,__source:!0};\nfunction L(a,b,e){var c=void 0,d={},g=null,h=null;if(null!=b)for(c in void 0!==b.ref&&(h=b.ref),void 0!==b.key&&(g=\"\"+b.key),b)J.call(b,c)&&!K.hasOwnProperty(c)&&(d[c]=b[c]);var f=arguments.length-2;if(1===f)d.children=e;else if(1<f){for(var k=Array(f),l=0;l<f;l++)k[l]=arguments[l+2];d.children=k}if(a&&a.defaultProps)for(c in f=a.defaultProps,f)void 0===d[c]&&(d[c]=f[c]);return{$$typeof:t,type:a,key:g,ref:h,props:d,_owner:I.current}}\nfunction M(a){return\"object\"===typeof a&&null!==a&&a.$$typeof===t}function escape(a){var b={\"\\x3d\":\"\\x3d0\",\":\":\"\\x3d2\"};return\"$\"+(\"\"+a).replace(/[=:]/g,function(a){return b[a]})}var N=/\\/+/g,O=[];function P(a,b,e,c){if(O.length){var d=O.pop();d.result=a;d.keyPrefix=b;d.func=e;d.context=c;d.count=0;return d}return{result:a,keyPrefix:b,func:e,context:c,count:0}}function Q(a){a.result=null;a.keyPrefix=null;a.func=null;a.context=null;a.count=0;10>O.length&&O.push(a)}\nfunction R(a,b,e,c){var d=typeof a;if(\"undefined\"===d||\"boolean\"===d)a=null;var g=!1;if(null===a)g=!0;else switch(d){case \"string\":case \"number\":g=!0;break;case \"object\":switch(a.$$typeof){case t:case u:g=!0}}if(g)return e(c,a,\"\"===b?\".\"+S(a,0):b),1;g=0;b=\"\"===b?\".\":b+\":\";if(Array.isArray(a))for(var h=0;h<a.length;h++){d=a[h];var f=b+S(d,h);g+=R(d,f,e,c)}else if(null===a||\"undefined\"===typeof a?f=null:(f=B&&a[B]||a[\"@@iterator\"],f=\"function\"===typeof f?f:null),\"function\"===typeof f)for(a=f.call(a),\nh=0;!(d=a.next()).done;)d=d.value,f=b+S(d,h++),g+=R(d,f,e,c);else\"object\"===d&&(e=\"\"+a,C(\"31\",\"[object Object]\"===e?\"object with keys {\"+Object.keys(a).join(\", \")+\"}\":e,\"\"));return g}function S(a,b){return\"object\"===typeof a&&null!==a&&null!=a.key?escape(a.key):b.toString(36)}function T(a,b){a.func.call(a.context,b,a.count++)}\nfunction U(a,b,e){var c=a.result,d=a.keyPrefix;a=a.func.call(a.context,b,a.count++);Array.isArray(a)?V(a,c,e,q.thatReturnsArgument):null!=a&&(M(a)&&(b=d+(!a.key||b&&b.key===a.key?\"\":(\"\"+a.key).replace(N,\"$\\x26/\")+\"/\")+e,a={$$typeof:t,type:a.type,key:b,ref:a.ref,props:a.props,_owner:a._owner}),c.push(a))}function V(a,b,e,c,d){var g=\"\";null!=e&&(g=(\"\"+e).replace(N,\"$\\x26/\")+\"/\");b=P(b,g,c,d);null==a||R(a,\"\",U,b);Q(b)}\nvar W={Children:{map:function(a,b,e){if(null==a)return a;var c=[];V(a,c,null,b,e);return c},forEach:function(a,b,e){if(null==a)return a;b=P(null,null,b,e);null==a||R(a,\"\",T,b);Q(b)},count:function(a){return null==a?0:R(a,\"\",q.thatReturnsNull,null)},toArray:function(a){var b=[];V(a,b,null,q.thatReturnsArgument);return b},only:function(a){M(a)?void 0:C(\"143\");return a}},createRef:function(){return{current:null}},Component:E,PureComponent:G,createContext:function(a,b){void 0===b&&(b=null);a={$$typeof:y,\n_calculateChangedBits:b,_defaultValue:a,_currentValue:a,_changedBits:0,Provider:null,Consumer:null};a.Provider={$$typeof:x,_context:a};return a.Consumer=a},forwardRef:function(a){return{$$typeof:A,render:a}},Fragment:v,StrictMode:w,unstable_AsyncMode:z,createElement:L,cloneElement:function(a,b,e){null===a||void 0===a?C(\"267\",a):void 0;var c=void 0,d=m({},a.props),g=a.key,h=a.ref,f=a._owner;if(null!=b){void 0!==b.ref&&(h=b.ref,f=I.current);void 0!==b.key&&(g=\"\"+b.key);var k=void 0;a.type&&a.type.defaultProps&&\n(k=a.type.defaultProps);for(c in b)J.call(b,c)&&!K.hasOwnProperty(c)&&(d[c]=void 0===b[c]&&void 0!==k?k[c]:b[c])}c=arguments.length-2;if(1===c)d.children=e;else if(1<c){k=Array(c);for(var l=0;l<c;l++)k[l]=arguments[l+2];d.children=k}return{$$typeof:t,type:a.type,key:g,ref:h,props:d,_owner:f}},createFactory:function(a){var b=L.bind(null,a);b.type=a;return b},isValidElement:M,version:\"16.3.2\",__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentOwner:I,assign:m}},X=Object.freeze({default:W}),\nY=X&&W||X;module.exports=Y[\"default\"]?Y[\"default\"]:Y;\n","module.exports = require(\"module\");","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nvar SourceMapGenerator = require('./source-map-generator').SourceMapGenerator;\nvar util = require('./util');\n\n// Matches a Windows-style `\\r\\n` newline or a `\\n` newline used by all other\n// operating systems these days (capturing the result).\nvar REGEX_NEWLINE = /(\\r?\\n)/;\n\n// Newline character code for charCodeAt() comparisons\nvar NEWLINE_CODE = 10;\n\n// Private symbol for identifying `SourceNode`s when multiple versions of\n// the source-map library are loaded. This MUST NOT CHANGE across\n// versions!\nvar isSourceNode = \"$$$isSourceNode$$$\";\n\n/**\n * SourceNodes provide a way to abstract over interpolating/concatenating\n * snippets of generated JavaScript source code while maintaining the line and\n * column information associated with the original source code.\n *\n * @param aLine The original line number.\n * @param aColumn The original column number.\n * @param aSource The original source's filename.\n * @param aChunks Optional. An array of strings which are snippets of\n *        generated JS, or other SourceNodes.\n * @param aName The original identifier.\n */\nfunction SourceNode(aLine, aColumn, aSource, aChunks, aName) {\n  this.children = [];\n  this.sourceContents = {};\n  this.line = aLine == null ? null : aLine;\n  this.column = aColumn == null ? null : aColumn;\n  this.source = aSource == null ? null : aSource;\n  this.name = aName == null ? null : aName;\n  this[isSourceNode] = true;\n  if (aChunks != null) this.add(aChunks);\n}\n\n/**\n * Creates a SourceNode from generated code and a SourceMapConsumer.\n *\n * @param aGeneratedCode The generated code\n * @param aSourceMapConsumer The SourceMap for the generated code\n * @param aRelativePath Optional. The path that relative sources in the\n *        SourceMapConsumer should be relative to.\n */\nSourceNode.fromStringWithSourceMap =\n  function SourceNode_fromStringWithSourceMap(aGeneratedCode, aSourceMapConsumer, aRelativePath) {\n    // The SourceNode we want to fill with the generated code\n    // and the SourceMap\n    var node = new SourceNode();\n\n    // All even indices of this array are one line of the generated code,\n    // while all odd indices are the newlines between two adjacent lines\n    // (since `REGEX_NEWLINE` captures its match).\n    // Processed fragments are accessed by calling `shiftNextLine`.\n    var remainingLines = aGeneratedCode.split(REGEX_NEWLINE);\n    var remainingLinesIndex = 0;\n    var shiftNextLine = function() {\n      var lineContents = getNextLine();\n      // The last line of a file might not have a newline.\n      var newLine = getNextLine() || \"\";\n      return lineContents + newLine;\n\n      function getNextLine() {\n        return remainingLinesIndex < remainingLines.length ?\n            remainingLines[remainingLinesIndex++] : undefined;\n      }\n    };\n\n    // We need to remember the position of \"remainingLines\"\n    var lastGeneratedLine = 1, lastGeneratedColumn = 0;\n\n    // The generate SourceNodes we need a code range.\n    // To extract it current and last mapping is used.\n    // Here we store the last mapping.\n    var lastMapping = null;\n\n    aSourceMapConsumer.eachMapping(function (mapping) {\n      if (lastMapping !== null) {\n        // We add the code from \"lastMapping\" to \"mapping\":\n        // First check if there is a new line in between.\n        if (lastGeneratedLine < mapping.generatedLine) {\n          // Associate first line with \"lastMapping\"\n          addMappingWithCode(lastMapping, shiftNextLine());\n          lastGeneratedLine++;\n          lastGeneratedColumn = 0;\n          // The remaining code is added without mapping\n        } else {\n          // There is no new line in between.\n          // Associate the code between \"lastGeneratedColumn\" and\n          // \"mapping.generatedColumn\" with \"lastMapping\"\n          var nextLine = remainingLines[remainingLinesIndex];\n          var code = nextLine.substr(0, mapping.generatedColumn -\n                                        lastGeneratedColumn);\n          remainingLines[remainingLinesIndex] = nextLine.substr(mapping.generatedColumn -\n                                              lastGeneratedColumn);\n          lastGeneratedColumn = mapping.generatedColumn;\n          addMappingWithCode(lastMapping, code);\n          // No more remaining code, continue\n          lastMapping = mapping;\n          return;\n        }\n      }\n      // We add the generated code until the first mapping\n      // to the SourceNode without any mapping.\n      // Each line is added as separate string.\n      while (lastGeneratedLine < mapping.generatedLine) {\n        node.add(shiftNextLine());\n        lastGeneratedLine++;\n      }\n      if (lastGeneratedColumn < mapping.generatedColumn) {\n        var nextLine = remainingLines[remainingLinesIndex];\n        node.add(nextLine.substr(0, mapping.generatedColumn));\n        remainingLines[remainingLinesIndex] = nextLine.substr(mapping.generatedColumn);\n        lastGeneratedColumn = mapping.generatedColumn;\n      }\n      lastMapping = mapping;\n    }, this);\n    // We have processed all mappings.\n    if (remainingLinesIndex < remainingLines.length) {\n      if (lastMapping) {\n        // Associate the remaining code in the current line with \"lastMapping\"\n        addMappingWithCode(lastMapping, shiftNextLine());\n      }\n      // and add the remaining lines without any mapping\n      node.add(remainingLines.splice(remainingLinesIndex).join(\"\"));\n    }\n\n    // Copy sourcesContent into SourceNode\n    aSourceMapConsumer.sources.forEach(function (sourceFile) {\n      var content = aSourceMapConsumer.sourceContentFor(sourceFile);\n      if (content != null) {\n        if (aRelativePath != null) {\n          sourceFile = util.join(aRelativePath, sourceFile);\n        }\n        node.setSourceContent(sourceFile, content);\n      }\n    });\n\n    return node;\n\n    function addMappingWithCode(mapping, code) {\n      if (mapping === null || mapping.source === undefined) {\n        node.add(code);\n      } else {\n        var source = aRelativePath\n          ? util.join(aRelativePath, mapping.source)\n          : mapping.source;\n        node.add(new SourceNode(mapping.originalLine,\n                                mapping.originalColumn,\n                                source,\n                                code,\n                                mapping.name));\n      }\n    }\n  };\n\n/**\n * Add a chunk of generated JS to this source node.\n *\n * @param aChunk A string snippet of generated JS code, another instance of\n *        SourceNode, or an array where each member is one of those things.\n */\nSourceNode.prototype.add = function SourceNode_add(aChunk) {\n  if (Array.isArray(aChunk)) {\n    aChunk.forEach(function (chunk) {\n      this.add(chunk);\n    }, this);\n  }\n  else if (aChunk[isSourceNode] || typeof aChunk === \"string\") {\n    if (aChunk) {\n      this.children.push(aChunk);\n    }\n  }\n  else {\n    throw new TypeError(\n      \"Expected a SourceNode, string, or an array of SourceNodes and strings. Got \" + aChunk\n    );\n  }\n  return this;\n};\n\n/**\n * Add a chunk of generated JS to the beginning of this source node.\n *\n * @param aChunk A string snippet of generated JS code, another instance of\n *        SourceNode, or an array where each member is one of those things.\n */\nSourceNode.prototype.prepend = function SourceNode_prepend(aChunk) {\n  if (Array.isArray(aChunk)) {\n    for (var i = aChunk.length-1; i >= 0; i--) {\n      this.prepend(aChunk[i]);\n    }\n  }\n  else if (aChunk[isSourceNode] || typeof aChunk === \"string\") {\n    this.children.unshift(aChunk);\n  }\n  else {\n    throw new TypeError(\n      \"Expected a SourceNode, string, or an array of SourceNodes and strings. Got \" + aChunk\n    );\n  }\n  return this;\n};\n\n/**\n * Walk over the tree of JS snippets in this node and its children. The\n * walking function is called once for each snippet of JS and is passed that\n * snippet and the its original associated source's line/column location.\n *\n * @param aFn The traversal function.\n */\nSourceNode.prototype.walk = function SourceNode_walk(aFn) {\n  var chunk;\n  for (var i = 0, len = this.children.length; i < len; i++) {\n    chunk = this.children[i];\n    if (chunk[isSourceNode]) {\n      chunk.walk(aFn);\n    }\n    else {\n      if (chunk !== '') {\n        aFn(chunk, { source: this.source,\n                     line: this.line,\n                     column: this.column,\n                     name: this.name });\n      }\n    }\n  }\n};\n\n/**\n * Like `String.prototype.join` except for SourceNodes. Inserts `aStr` between\n * each of `this.children`.\n *\n * @param aSep The separator.\n */\nSourceNode.prototype.join = function SourceNode_join(aSep) {\n  var newChildren;\n  var i;\n  var len = this.children.length;\n  if (len > 0) {\n    newChildren = [];\n    for (i = 0; i < len-1; i++) {\n      newChildren.push(this.children[i]);\n      newChildren.push(aSep);\n    }\n    newChildren.push(this.children[i]);\n    this.children = newChildren;\n  }\n  return this;\n};\n\n/**\n * Call String.prototype.replace on the very right-most source snippet. Useful\n * for trimming whitespace from the end of a source node, etc.\n *\n * @param aPattern The pattern to replace.\n * @param aReplacement The thing to replace the pattern with.\n */\nSourceNode.prototype.replaceRight = function SourceNode_replaceRight(aPattern, aReplacement) {\n  var lastChild = this.children[this.children.length - 1];\n  if (lastChild[isSourceNode]) {\n    lastChild.replaceRight(aPattern, aReplacement);\n  }\n  else if (typeof lastChild === 'string') {\n    this.children[this.children.length - 1] = lastChild.replace(aPattern, aReplacement);\n  }\n  else {\n    this.children.push(''.replace(aPattern, aReplacement));\n  }\n  return this;\n};\n\n/**\n * Set the source content for a source file. This will be added to the SourceMapGenerator\n * in the sourcesContent field.\n *\n * @param aSourceFile The filename of the source file\n * @param aSourceContent The content of the source file\n */\nSourceNode.prototype.setSourceContent =\n  function SourceNode_setSourceContent(aSourceFile, aSourceContent) {\n    this.sourceContents[util.toSetString(aSourceFile)] = aSourceContent;\n  };\n\n/**\n * Walk over the tree of SourceNodes. The walking function is called for each\n * source file content and is passed the filename and source content.\n *\n * @param aFn The traversal function.\n */\nSourceNode.prototype.walkSourceContents =\n  function SourceNode_walkSourceContents(aFn) {\n    for (var i = 0, len = this.children.length; i < len; i++) {\n      if (this.children[i][isSourceNode]) {\n        this.children[i].walkSourceContents(aFn);\n      }\n    }\n\n    var sources = Object.keys(this.sourceContents);\n    for (var i = 0, len = sources.length; i < len; i++) {\n      aFn(util.fromSetString(sources[i]), this.sourceContents[sources[i]]);\n    }\n  };\n\n/**\n * Return the string representation of this source node. Walks over the tree\n * and concatenates all the various snippets together to one string.\n */\nSourceNode.prototype.toString = function SourceNode_toString() {\n  var str = \"\";\n  this.walk(function (chunk) {\n    str += chunk;\n  });\n  return str;\n};\n\n/**\n * Returns the string representation of this source node along with a source\n * map.\n */\nSourceNode.prototype.toStringWithSourceMap = function SourceNode_toStringWithSourceMap(aArgs) {\n  var generated = {\n    code: \"\",\n    line: 1,\n    column: 0\n  };\n  var map = new SourceMapGenerator(aArgs);\n  var sourceMappingActive = false;\n  var lastOriginalSource = null;\n  var lastOriginalLine = null;\n  var lastOriginalColumn = null;\n  var lastOriginalName = null;\n  this.walk(function (chunk, original) {\n    generated.code += chunk;\n    if (original.source !== null\n        && original.line !== null\n        && original.column !== null) {\n      if(lastOriginalSource !== original.source\n         || lastOriginalLine !== original.line\n         || lastOriginalColumn !== original.column\n         || lastOriginalName !== original.name) {\n        map.addMapping({\n          source: original.source,\n          original: {\n            line: original.line,\n            column: original.column\n          },\n          generated: {\n            line: generated.line,\n            column: generated.column\n          },\n          name: original.name\n        });\n      }\n      lastOriginalSource = original.source;\n      lastOriginalLine = original.line;\n      lastOriginalColumn = original.column;\n      lastOriginalName = original.name;\n      sourceMappingActive = true;\n    } else if (sourceMappingActive) {\n      map.addMapping({\n        generated: {\n          line: generated.line,\n          column: generated.column\n        }\n      });\n      lastOriginalSource = null;\n      sourceMappingActive = false;\n    }\n    for (var idx = 0, length = chunk.length; idx < length; idx++) {\n      if (chunk.charCodeAt(idx) === NEWLINE_CODE) {\n        generated.line++;\n        generated.column = 0;\n        // Mappings end at eol\n        if (idx + 1 === length) {\n          lastOriginalSource = null;\n          sourceMappingActive = false;\n        } else if (sourceMappingActive) {\n          map.addMapping({\n            source: original.source,\n            original: {\n              line: original.line,\n              column: original.column\n            },\n            generated: {\n              line: generated.line,\n              column: generated.column\n            },\n            name: original.name\n          });\n        }\n      } else {\n        generated.column++;\n      }\n    }\n  });\n  this.walkSourceContents(function (sourceFile, sourceContent) {\n    map.setSourceContent(sourceFile, sourceContent);\n  });\n\n  return { code: generated.code, map: map };\n};\n\nexports.SourceNode = SourceNode;\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\n// It turns out that some (most?) JavaScript engines don't self-host\n// `Array.prototype.sort`. This makes sense because C++ will likely remain\n// faster than JS when doing raw CPU-intensive sorting. However, when using a\n// custom comparator function, calling back and forth between the VM's C++ and\n// JIT'd JS is rather slow *and* loses JIT type information, resulting in\n// worse generated code for the comparator function than would be optimal. In\n// fact, when sorting with a comparator, these costs outweigh the benefits of\n// sorting in C++. By using our own JS-implemented Quick Sort (below), we get\n// a ~3500ms mean speed-up in `bench/bench.html`.\n\n/**\n * Swap the elements indexed by `x` and `y` in the array `ary`.\n *\n * @param {Array} ary\n *        The array.\n * @param {Number} x\n *        The index of the first item.\n * @param {Number} y\n *        The index of the second item.\n */\nfunction swap(ary, x, y) {\n  var temp = ary[x];\n  ary[x] = ary[y];\n  ary[y] = temp;\n}\n\n/**\n * Returns a random integer within the range `low .. high` inclusive.\n *\n * @param {Number} low\n *        The lower bound on the range.\n * @param {Number} high\n *        The upper bound on the range.\n */\nfunction randomIntInRange(low, high) {\n  return Math.round(low + (Math.random() * (high - low)));\n}\n\n/**\n * The Quick Sort algorithm.\n *\n * @param {Array} ary\n *        An array to sort.\n * @param {function} comparator\n *        Function to use to compare two items.\n * @param {Number} p\n *        Start index of the array\n * @param {Number} r\n *        End index of the array\n */\nfunction doQuickSort(ary, comparator, p, r) {\n  // If our lower bound is less than our upper bound, we (1) partition the\n  // array into two pieces and (2) recurse on each half. If it is not, this is\n  // the empty array and our base case.\n\n  if (p < r) {\n    // (1) Partitioning.\n    //\n    // The partitioning chooses a pivot between `p` and `r` and moves all\n    // elements that are less than or equal to the pivot to the before it, and\n    // all the elements that are greater than it after it. The effect is that\n    // once partition is done, the pivot is in the exact place it will be when\n    // the array is put in sorted order, and it will not need to be moved\n    // again. This runs in O(n) time.\n\n    // Always choose a random pivot so that an input array which is reverse\n    // sorted does not cause O(n^2) running time.\n    var pivotIndex = randomIntInRange(p, r);\n    var i = p - 1;\n\n    swap(ary, pivotIndex, r);\n    var pivot = ary[r];\n\n    // Immediately after `j` is incremented in this loop, the following hold\n    // true:\n    //\n    //   * Every element in `ary[p .. i]` is less than or equal to the pivot.\n    //\n    //   * Every element in `ary[i+1 .. j-1]` is greater than the pivot.\n    for (var j = p; j < r; j++) {\n      if (comparator(ary[j], pivot) <= 0) {\n        i += 1;\n        swap(ary, i, j);\n      }\n    }\n\n    swap(ary, i + 1, j);\n    var q = i + 1;\n\n    // (2) Recurse on each half.\n\n    doQuickSort(ary, comparator, p, q - 1);\n    doQuickSort(ary, comparator, q + 1, r);\n  }\n}\n\n/**\n * Sort the given array in-place with the given comparator function.\n *\n * @param {Array} ary\n *        An array to sort.\n * @param {function} comparator\n *        Function to use to compare two items.\n */\nexports.quickSort = function (ary, comparator) {\n  doQuickSort(ary, comparator, 0, ary.length - 1);\n};\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nexports.GREATEST_LOWER_BOUND = 1;\nexports.LEAST_UPPER_BOUND = 2;\n\n/**\n * Recursive implementation of binary search.\n *\n * @param aLow Indices here and lower do not contain the needle.\n * @param aHigh Indices here and higher do not contain the needle.\n * @param aNeedle The element being searched for.\n * @param aHaystack The non-empty array being searched.\n * @param aCompare Function which takes two elements and returns -1, 0, or 1.\n * @param aBias Either 'binarySearch.GREATEST_LOWER_BOUND' or\n *     'binarySearch.LEAST_UPPER_BOUND'. Specifies whether to return the\n *     closest element that is smaller than or greater than the one we are\n *     searching for, respectively, if the exact element cannot be found.\n */\nfunction recursiveSearch(aLow, aHigh, aNeedle, aHaystack, aCompare, aBias) {\n  // This function terminates when one of the following is true:\n  //\n  //   1. We find the exact element we are looking for.\n  //\n  //   2. We did not find the exact element, but we can return the index of\n  //      the next-closest element.\n  //\n  //   3. We did not find the exact element, and there is no next-closest\n  //      element than the one we are searching for, so we return -1.\n  var mid = Math.floor((aHigh - aLow) / 2) + aLow;\n  var cmp = aCompare(aNeedle, aHaystack[mid], true);\n  if (cmp === 0) {\n    // Found the element we are looking for.\n    return mid;\n  }\n  else if (cmp > 0) {\n    // Our needle is greater than aHaystack[mid].\n    if (aHigh - mid > 1) {\n      // The element is in the upper half.\n      return recursiveSearch(mid, aHigh, aNeedle, aHaystack, aCompare, aBias);\n    }\n\n    // The exact needle element was not found in this haystack. Determine if\n    // we are in termination case (3) or (2) and return the appropriate thing.\n    if (aBias == exports.LEAST_UPPER_BOUND) {\n      return aHigh < aHaystack.length ? aHigh : -1;\n    } else {\n      return mid;\n    }\n  }\n  else {\n    // Our needle is less than aHaystack[mid].\n    if (mid - aLow > 1) {\n      // The element is in the lower half.\n      return recursiveSearch(aLow, mid, aNeedle, aHaystack, aCompare, aBias);\n    }\n\n    // we are in termination case (3) or (2) and return the appropriate thing.\n    if (aBias == exports.LEAST_UPPER_BOUND) {\n      return mid;\n    } else {\n      return aLow < 0 ? -1 : aLow;\n    }\n  }\n}\n\n/**\n * This is an implementation of binary search which will always try and return\n * the index of the closest element if there is no exact hit. This is because\n * mappings between original and generated line/col pairs are single points,\n * and there is an implicit region between each of them, so a miss just means\n * that you aren't on the very start of a region.\n *\n * @param aNeedle The element you are looking for.\n * @param aHaystack The array that is being searched.\n * @param aCompare A function which takes the needle and an element in the\n *     array and returns -1, 0, or 1 depending on whether the needle is less\n *     than, equal to, or greater than the element, respectively.\n * @param aBias Either 'binarySearch.GREATEST_LOWER_BOUND' or\n *     'binarySearch.LEAST_UPPER_BOUND'. Specifies whether to return the\n *     closest element that is smaller than or greater than the one we are\n *     searching for, respectively, if the exact element cannot be found.\n *     Defaults to 'binarySearch.GREATEST_LOWER_BOUND'.\n */\nexports.search = function search(aNeedle, aHaystack, aCompare, aBias) {\n  if (aHaystack.length === 0) {\n    return -1;\n  }\n\n  var index = recursiveSearch(-1, aHaystack.length, aNeedle, aHaystack,\n                              aCompare, aBias || exports.GREATEST_LOWER_BOUND);\n  if (index < 0) {\n    return -1;\n  }\n\n  // We have found either the exact element, or the next-closest element than\n  // the one we are searching for. However, there may be more than one such\n  // element. Make sure we always return the smallest of these.\n  while (index - 1 >= 0) {\n    if (aCompare(aHaystack[index], aHaystack[index - 1], true) !== 0) {\n      break;\n    }\n    --index;\n  }\n\n  return index;\n};\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nvar util = require('./util');\nvar binarySearch = require('./binary-search');\nvar ArraySet = require('./array-set').ArraySet;\nvar base64VLQ = require('./base64-vlq');\nvar quickSort = require('./quick-sort').quickSort;\n\nfunction SourceMapConsumer(aSourceMap) {\n  var sourceMap = aSourceMap;\n  if (typeof aSourceMap === 'string') {\n    sourceMap = JSON.parse(aSourceMap.replace(/^\\)\\]\\}'/, ''));\n  }\n\n  return sourceMap.sections != null\n    ? new IndexedSourceMapConsumer(sourceMap)\n    : new BasicSourceMapConsumer(sourceMap);\n}\n\nSourceMapConsumer.fromSourceMap = function(aSourceMap) {\n  return BasicSourceMapConsumer.fromSourceMap(aSourceMap);\n}\n\n/**\n * The version of the source mapping spec that we are consuming.\n */\nSourceMapConsumer.prototype._version = 3;\n\n// `__generatedMappings` and `__originalMappings` are arrays that hold the\n// parsed mapping coordinates from the source map's \"mappings\" attribute. They\n// are lazily instantiated, accessed via the `_generatedMappings` and\n// `_originalMappings` getters respectively, and we only parse the mappings\n// and create these arrays once queried for a source location. We jump through\n// these hoops because there can be many thousands of mappings, and parsing\n// them is expensive, so we only want to do it if we must.\n//\n// Each object in the arrays is of the form:\n//\n//     {\n//       generatedLine: The line number in the generated code,\n//       generatedColumn: The column number in the generated code,\n//       source: The path to the original source file that generated this\n//               chunk of code,\n//       originalLine: The line number in the original source that\n//                     corresponds to this chunk of generated code,\n//       originalColumn: The column number in the original source that\n//                       corresponds to this chunk of generated code,\n//       name: The name of the original symbol which generated this chunk of\n//             code.\n//     }\n//\n// All properties except for `generatedLine` and `generatedColumn` can be\n// `null`.\n//\n// `_generatedMappings` is ordered by the generated positions.\n//\n// `_originalMappings` is ordered by the original positions.\n\nSourceMapConsumer.prototype.__generatedMappings = null;\nObject.defineProperty(SourceMapConsumer.prototype, '_generatedMappings', {\n  get: function () {\n    if (!this.__generatedMappings) {\n      this._parseMappings(this._mappings, this.sourceRoot);\n    }\n\n    return this.__generatedMappings;\n  }\n});\n\nSourceMapConsumer.prototype.__originalMappings = null;\nObject.defineProperty(SourceMapConsumer.prototype, '_originalMappings', {\n  get: function () {\n    if (!this.__originalMappings) {\n      this._parseMappings(this._mappings, this.sourceRoot);\n    }\n\n    return this.__originalMappings;\n  }\n});\n\nSourceMapConsumer.prototype._charIsMappingSeparator =\n  function SourceMapConsumer_charIsMappingSeparator(aStr, index) {\n    var c = aStr.charAt(index);\n    return c === \";\" || c === \",\";\n  };\n\n/**\n * Parse the mappings in a string in to a data structure which we can easily\n * query (the ordered arrays in the `this.__generatedMappings` and\n * `this.__originalMappings` properties).\n */\nSourceMapConsumer.prototype._parseMappings =\n  function SourceMapConsumer_parseMappings(aStr, aSourceRoot) {\n    throw new Error(\"Subclasses must implement _parseMappings\");\n  };\n\nSourceMapConsumer.GENERATED_ORDER = 1;\nSourceMapConsumer.ORIGINAL_ORDER = 2;\n\nSourceMapConsumer.GREATEST_LOWER_BOUND = 1;\nSourceMapConsumer.LEAST_UPPER_BOUND = 2;\n\n/**\n * Iterate over each mapping between an original source/line/column and a\n * generated line/column in this source map.\n *\n * @param Function aCallback\n *        The function that is called with each mapping.\n * @param Object aContext\n *        Optional. If specified, this object will be the value of `this` every\n *        time that `aCallback` is called.\n * @param aOrder\n *        Either `SourceMapConsumer.GENERATED_ORDER` or\n *        `SourceMapConsumer.ORIGINAL_ORDER`. Specifies whether you want to\n *        iterate over the mappings sorted by the generated file's line/column\n *        order or the original's source/line/column order, respectively. Defaults to\n *        `SourceMapConsumer.GENERATED_ORDER`.\n */\nSourceMapConsumer.prototype.eachMapping =\n  function SourceMapConsumer_eachMapping(aCallback, aContext, aOrder) {\n    var context = aContext || null;\n    var order = aOrder || SourceMapConsumer.GENERATED_ORDER;\n\n    var mappings;\n    switch (order) {\n    case SourceMapConsumer.GENERATED_ORDER:\n      mappings = this._generatedMappings;\n      break;\n    case SourceMapConsumer.ORIGINAL_ORDER:\n      mappings = this._originalMappings;\n      break;\n    default:\n      throw new Error(\"Unknown order of iteration.\");\n    }\n\n    var sourceRoot = this.sourceRoot;\n    mappings.map(function (mapping) {\n      var source = mapping.source === null ? null : this._sources.at(mapping.source);\n      if (source != null && sourceRoot != null) {\n        source = util.join(sourceRoot, source);\n      }\n      return {\n        source: source,\n        generatedLine: mapping.generatedLine,\n        generatedColumn: mapping.generatedColumn,\n        originalLine: mapping.originalLine,\n        originalColumn: mapping.originalColumn,\n        name: mapping.name === null ? null : this._names.at(mapping.name)\n      };\n    }, this).forEach(aCallback, context);\n  };\n\n/**\n * Returns all generated line and column information for the original source,\n * line, and column provided. If no column is provided, returns all mappings\n * corresponding to a either the line we are searching for or the next\n * closest line that has any mappings. Otherwise, returns all mappings\n * corresponding to the given line and either the column we are searching for\n * or the next closest column that has any offsets.\n *\n * The only argument is an object with the following properties:\n *\n *   - source: The filename of the original source.\n *   - line: The line number in the original source.\n *   - column: Optional. the column number in the original source.\n *\n * and an array of objects is returned, each with the following properties:\n *\n *   - line: The line number in the generated source, or null.\n *   - column: The column number in the generated source, or null.\n */\nSourceMapConsumer.prototype.allGeneratedPositionsFor =\n  function SourceMapConsumer_allGeneratedPositionsFor(aArgs) {\n    var line = util.getArg(aArgs, 'line');\n\n    // When there is no exact match, BasicSourceMapConsumer.prototype._findMapping\n    // returns the index of the closest mapping less than the needle. By\n    // setting needle.originalColumn to 0, we thus find the last mapping for\n    // the given line, provided such a mapping exists.\n    var needle = {\n      source: util.getArg(aArgs, 'source'),\n      originalLine: line,\n      originalColumn: util.getArg(aArgs, 'column', 0)\n    };\n\n    if (this.sourceRoot != null) {\n      needle.source = util.relative(this.sourceRoot, needle.source);\n    }\n    if (!this._sources.has(needle.source)) {\n      return [];\n    }\n    needle.source = this._sources.indexOf(needle.source);\n\n    var mappings = [];\n\n    var index = this._findMapping(needle,\n                                  this._originalMappings,\n                                  \"originalLine\",\n                                  \"originalColumn\",\n                                  util.compareByOriginalPositions,\n                                  binarySearch.LEAST_UPPER_BOUND);\n    if (index >= 0) {\n      var mapping = this._originalMappings[index];\n\n      if (aArgs.column === undefined) {\n        var originalLine = mapping.originalLine;\n\n        // Iterate until either we run out of mappings, or we run into\n        // a mapping for a different line than the one we found. Since\n        // mappings are sorted, this is guaranteed to find all mappings for\n        // the line we found.\n        while (mapping && mapping.originalLine === originalLine) {\n          mappings.push({\n            line: util.getArg(mapping, 'generatedLine', null),\n            column: util.getArg(mapping, 'generatedColumn', null),\n            lastColumn: util.getArg(mapping, 'lastGeneratedColumn', null)\n          });\n\n          mapping = this._originalMappings[++index];\n        }\n      } else {\n        var originalColumn = mapping.originalColumn;\n\n        // Iterate until either we run out of mappings, or we run into\n        // a mapping for a different line than the one we were searching for.\n        // Since mappings are sorted, this is guaranteed to find all mappings for\n        // the line we are searching for.\n        while (mapping &&\n               mapping.originalLine === line &&\n               mapping.originalColumn == originalColumn) {\n          mappings.push({\n            line: util.getArg(mapping, 'generatedLine', null),\n            column: util.getArg(mapping, 'generatedColumn', null),\n            lastColumn: util.getArg(mapping, 'lastGeneratedColumn', null)\n          });\n\n          mapping = this._originalMappings[++index];\n        }\n      }\n    }\n\n    return mappings;\n  };\n\nexports.SourceMapConsumer = SourceMapConsumer;\n\n/**\n * A BasicSourceMapConsumer instance represents a parsed source map which we can\n * query for information about the original file positions by giving it a file\n * position in the generated source.\n *\n * The only parameter is the raw source map (either as a JSON string, or\n * already parsed to an object). According to the spec, source maps have the\n * following attributes:\n *\n *   - version: Which version of the source map spec this map is following.\n *   - sources: An array of URLs to the original source files.\n *   - names: An array of identifiers which can be referrenced by individual mappings.\n *   - sourceRoot: Optional. The URL root from which all sources are relative.\n *   - sourcesContent: Optional. An array of contents of the original source files.\n *   - mappings: A string of base64 VLQs which contain the actual mappings.\n *   - file: Optional. The generated file this source map is associated with.\n *\n * Here is an example source map, taken from the source map spec[0]:\n *\n *     {\n *       version : 3,\n *       file: \"out.js\",\n *       sourceRoot : \"\",\n *       sources: [\"foo.js\", \"bar.js\"],\n *       names: [\"src\", \"maps\", \"are\", \"fun\"],\n *       mappings: \"AA,AB;;ABCDE;\"\n *     }\n *\n * [0]: https://docs.google.com/document/d/1U1RGAehQwRypUTovF1KRlpiOFze0b-_2gc6fAH0KY0k/edit?pli=1#\n */\nfunction BasicSourceMapConsumer(aSourceMap) {\n  var sourceMap = aSourceMap;\n  if (typeof aSourceMap === 'string') {\n    sourceMap = JSON.parse(aSourceMap.replace(/^\\)\\]\\}'/, ''));\n  }\n\n  var version = util.getArg(sourceMap, 'version');\n  var sources = util.getArg(sourceMap, 'sources');\n  // Sass 3.3 leaves out the 'names' array, so we deviate from the spec (which\n  // requires the array) to play nice here.\n  var names = util.getArg(sourceMap, 'names', []);\n  var sourceRoot = util.getArg(sourceMap, 'sourceRoot', null);\n  var sourcesContent = util.getArg(sourceMap, 'sourcesContent', null);\n  var mappings = util.getArg(sourceMap, 'mappings');\n  var file = util.getArg(sourceMap, 'file', null);\n\n  // Once again, Sass deviates from the spec and supplies the version as a\n  // string rather than a number, so we use loose equality checking here.\n  if (version != this._version) {\n    throw new Error('Unsupported version: ' + version);\n  }\n\n  sources = sources\n    .map(String)\n    // Some source maps produce relative source paths like \"./foo.js\" instead of\n    // \"foo.js\".  Normalize these first so that future comparisons will succeed.\n    // See bugzil.la/1090768.\n    .map(util.normalize)\n    // Always ensure that absolute sources are internally stored relative to\n    // the source root, if the source root is absolute. Not doing this would\n    // be particularly problematic when the source root is a prefix of the\n    // source (valid, but why??). See github issue #199 and bugzil.la/1188982.\n    .map(function (source) {\n      return sourceRoot && util.isAbsolute(sourceRoot) && util.isAbsolute(source)\n        ? util.relative(sourceRoot, source)\n        : source;\n    });\n\n  // Pass `true` below to allow duplicate names and sources. While source maps\n  // are intended to be compressed and deduplicated, the TypeScript compiler\n  // sometimes generates source maps with duplicates in them. See Github issue\n  // #72 and bugzil.la/889492.\n  this._names = ArraySet.fromArray(names.map(String), true);\n  this._sources = ArraySet.fromArray(sources, true);\n\n  this.sourceRoot = sourceRoot;\n  this.sourcesContent = sourcesContent;\n  this._mappings = mappings;\n  this.file = file;\n}\n\nBasicSourceMapConsumer.prototype = Object.create(SourceMapConsumer.prototype);\nBasicSourceMapConsumer.prototype.consumer = SourceMapConsumer;\n\n/**\n * Create a BasicSourceMapConsumer from a SourceMapGenerator.\n *\n * @param SourceMapGenerator aSourceMap\n *        The source map that will be consumed.\n * @returns BasicSourceMapConsumer\n */\nBasicSourceMapConsumer.fromSourceMap =\n  function SourceMapConsumer_fromSourceMap(aSourceMap) {\n    var smc = Object.create(BasicSourceMapConsumer.prototype);\n\n    var names = smc._names = ArraySet.fromArray(aSourceMap._names.toArray(), true);\n    var sources = smc._sources = ArraySet.fromArray(aSourceMap._sources.toArray(), true);\n    smc.sourceRoot = aSourceMap._sourceRoot;\n    smc.sourcesContent = aSourceMap._generateSourcesContent(smc._sources.toArray(),\n                                                            smc.sourceRoot);\n    smc.file = aSourceMap._file;\n\n    // Because we are modifying the entries (by converting string sources and\n    // names to indices into the sources and names ArraySets), we have to make\n    // a copy of the entry or else bad things happen. Shared mutable state\n    // strikes again! See github issue #191.\n\n    var generatedMappings = aSourceMap._mappings.toArray().slice();\n    var destGeneratedMappings = smc.__generatedMappings = [];\n    var destOriginalMappings = smc.__originalMappings = [];\n\n    for (var i = 0, length = generatedMappings.length; i < length; i++) {\n      var srcMapping = generatedMappings[i];\n      var destMapping = new Mapping;\n      destMapping.generatedLine = srcMapping.generatedLine;\n      destMapping.generatedColumn = srcMapping.generatedColumn;\n\n      if (srcMapping.source) {\n        destMapping.source = sources.indexOf(srcMapping.source);\n        destMapping.originalLine = srcMapping.originalLine;\n        destMapping.originalColumn = srcMapping.originalColumn;\n\n        if (srcMapping.name) {\n          destMapping.name = names.indexOf(srcMapping.name);\n        }\n\n        destOriginalMappings.push(destMapping);\n      }\n\n      destGeneratedMappings.push(destMapping);\n    }\n\n    quickSort(smc.__originalMappings, util.compareByOriginalPositions);\n\n    return smc;\n  };\n\n/**\n * The version of the source mapping spec that we are consuming.\n */\nBasicSourceMapConsumer.prototype._version = 3;\n\n/**\n * The list of original sources.\n */\nObject.defineProperty(BasicSourceMapConsumer.prototype, 'sources', {\n  get: function () {\n    return this._sources.toArray().map(function (s) {\n      return this.sourceRoot != null ? util.join(this.sourceRoot, s) : s;\n    }, this);\n  }\n});\n\n/**\n * Provide the JIT with a nice shape / hidden class.\n */\nfunction Mapping() {\n  this.generatedLine = 0;\n  this.generatedColumn = 0;\n  this.source = null;\n  this.originalLine = null;\n  this.originalColumn = null;\n  this.name = null;\n}\n\n/**\n * Parse the mappings in a string in to a data structure which we can easily\n * query (the ordered arrays in the `this.__generatedMappings` and\n * `this.__originalMappings` properties).\n */\nBasicSourceMapConsumer.prototype._parseMappings =\n  function SourceMapConsumer_parseMappings(aStr, aSourceRoot) {\n    var generatedLine = 1;\n    var previousGeneratedColumn = 0;\n    var previousOriginalLine = 0;\n    var previousOriginalColumn = 0;\n    var previousSource = 0;\n    var previousName = 0;\n    var length = aStr.length;\n    var index = 0;\n    var cachedSegments = {};\n    var temp = {};\n    var originalMappings = [];\n    var generatedMappings = [];\n    var mapping, str, segment, end, value;\n\n    while (index < length) {\n      if (aStr.charAt(index) === ';') {\n        generatedLine++;\n        index++;\n        previousGeneratedColumn = 0;\n      }\n      else if (aStr.charAt(index) === ',') {\n        index++;\n      }\n      else {\n        mapping = new Mapping();\n        mapping.generatedLine = generatedLine;\n\n        // Because each offset is encoded relative to the previous one,\n        // many segments often have the same encoding. We can exploit this\n        // fact by caching the parsed variable length fields of each segment,\n        // allowing us to avoid a second parse if we encounter the same\n        // segment again.\n        for (end = index; end < length; end++) {\n          if (this._charIsMappingSeparator(aStr, end)) {\n            break;\n          }\n        }\n        str = aStr.slice(index, end);\n\n        segment = cachedSegments[str];\n        if (segment) {\n          index += str.length;\n        } else {\n          segment = [];\n          while (index < end) {\n            base64VLQ.decode(aStr, index, temp);\n            value = temp.value;\n            index = temp.rest;\n            segment.push(value);\n          }\n\n          if (segment.length === 2) {\n            throw new Error('Found a source, but no line and column');\n          }\n\n          if (segment.length === 3) {\n            throw new Error('Found a source and line, but no column');\n          }\n\n          cachedSegments[str] = segment;\n        }\n\n        // Generated column.\n        mapping.generatedColumn = previousGeneratedColumn + segment[0];\n        previousGeneratedColumn = mapping.generatedColumn;\n\n        if (segment.length > 1) {\n          // Original source.\n          mapping.source = previousSource + segment[1];\n          previousSource += segment[1];\n\n          // Original line.\n          mapping.originalLine = previousOriginalLine + segment[2];\n          previousOriginalLine = mapping.originalLine;\n          // Lines are stored 0-based\n          mapping.originalLine += 1;\n\n          // Original column.\n          mapping.originalColumn = previousOriginalColumn + segment[3];\n          previousOriginalColumn = mapping.originalColumn;\n\n          if (segment.length > 4) {\n            // Original name.\n            mapping.name = previousName + segment[4];\n            previousName += segment[4];\n          }\n        }\n\n        generatedMappings.push(mapping);\n        if (typeof mapping.originalLine === 'number') {\n          originalMappings.push(mapping);\n        }\n      }\n    }\n\n    quickSort(generatedMappings, util.compareByGeneratedPositionsDeflated);\n    this.__generatedMappings = generatedMappings;\n\n    quickSort(originalMappings, util.compareByOriginalPositions);\n    this.__originalMappings = originalMappings;\n  };\n\n/**\n * Find the mapping that best matches the hypothetical \"needle\" mapping that\n * we are searching for in the given \"haystack\" of mappings.\n */\nBasicSourceMapConsumer.prototype._findMapping =\n  function SourceMapConsumer_findMapping(aNeedle, aMappings, aLineName,\n                                         aColumnName, aComparator, aBias) {\n    // To return the position we are searching for, we must first find the\n    // mapping for the given position and then return the opposite position it\n    // points to. Because the mappings are sorted, we can use binary search to\n    // find the best mapping.\n\n    if (aNeedle[aLineName] <= 0) {\n      throw new TypeError('Line must be greater than or equal to 1, got '\n                          + aNeedle[aLineName]);\n    }\n    if (aNeedle[aColumnName] < 0) {\n      throw new TypeError('Column must be greater than or equal to 0, got '\n                          + aNeedle[aColumnName]);\n    }\n\n    return binarySearch.search(aNeedle, aMappings, aComparator, aBias);\n  };\n\n/**\n * Compute the last column for each generated mapping. The last column is\n * inclusive.\n */\nBasicSourceMapConsumer.prototype.computeColumnSpans =\n  function SourceMapConsumer_computeColumnSpans() {\n    for (var index = 0; index < this._generatedMappings.length; ++index) {\n      var mapping = this._generatedMappings[index];\n\n      // Mappings do not contain a field for the last generated columnt. We\n      // can come up with an optimistic estimate, however, by assuming that\n      // mappings are contiguous (i.e. given two consecutive mappings, the\n      // first mapping ends where the second one starts).\n      if (index + 1 < this._generatedMappings.length) {\n        var nextMapping = this._generatedMappings[index + 1];\n\n        if (mapping.generatedLine === nextMapping.generatedLine) {\n          mapping.lastGeneratedColumn = nextMapping.generatedColumn - 1;\n          continue;\n        }\n      }\n\n      // The last mapping for each line spans the entire line.\n      mapping.lastGeneratedColumn = Infinity;\n    }\n  };\n\n/**\n * Returns the original source, line, and column information for the generated\n * source's line and column positions provided. The only argument is an object\n * with the following properties:\n *\n *   - line: The line number in the generated source.\n *   - column: The column number in the generated source.\n *   - bias: Either 'SourceMapConsumer.GREATEST_LOWER_BOUND' or\n *     'SourceMapConsumer.LEAST_UPPER_BOUND'. Specifies whether to return the\n *     closest element that is smaller than or greater than the one we are\n *     searching for, respectively, if the exact element cannot be found.\n *     Defaults to 'SourceMapConsumer.GREATEST_LOWER_BOUND'.\n *\n * and an object is returned with the following properties:\n *\n *   - source: The original source file, or null.\n *   - line: The line number in the original source, or null.\n *   - column: The column number in the original source, or null.\n *   - name: The original identifier, or null.\n */\nBasicSourceMapConsumer.prototype.originalPositionFor =\n  function SourceMapConsumer_originalPositionFor(aArgs) {\n    var needle = {\n      generatedLine: util.getArg(aArgs, 'line'),\n      generatedColumn: util.getArg(aArgs, 'column')\n    };\n\n    var index = this._findMapping(\n      needle,\n      this._generatedMappings,\n      \"generatedLine\",\n      \"generatedColumn\",\n      util.compareByGeneratedPositionsDeflated,\n      util.getArg(aArgs, 'bias', SourceMapConsumer.GREATEST_LOWER_BOUND)\n    );\n\n    if (index >= 0) {\n      var mapping = this._generatedMappings[index];\n\n      if (mapping.generatedLine === needle.generatedLine) {\n        var source = util.getArg(mapping, 'source', null);\n        if (source !== null) {\n          source = this._sources.at(source);\n          if (this.sourceRoot != null) {\n            source = util.join(this.sourceRoot, source);\n          }\n        }\n        var name = util.getArg(mapping, 'name', null);\n        if (name !== null) {\n          name = this._names.at(name);\n        }\n        return {\n          source: source,\n          line: util.getArg(mapping, 'originalLine', null),\n          column: util.getArg(mapping, 'originalColumn', null),\n          name: name\n        };\n      }\n    }\n\n    return {\n      source: null,\n      line: null,\n      column: null,\n      name: null\n    };\n  };\n\n/**\n * Return true if we have the source content for every source in the source\n * map, false otherwise.\n */\nBasicSourceMapConsumer.prototype.hasContentsOfAllSources =\n  function BasicSourceMapConsumer_hasContentsOfAllSources() {\n    if (!this.sourcesContent) {\n      return false;\n    }\n    return this.sourcesContent.length >= this._sources.size() &&\n      !this.sourcesContent.some(function (sc) { return sc == null; });\n  };\n\n/**\n * Returns the original source content. The only argument is the url of the\n * original source file. Returns null if no original source content is\n * available.\n */\nBasicSourceMapConsumer.prototype.sourceContentFor =\n  function SourceMapConsumer_sourceContentFor(aSource, nullOnMissing) {\n    if (!this.sourcesContent) {\n      return null;\n    }\n\n    if (this.sourceRoot != null) {\n      aSource = util.relative(this.sourceRoot, aSource);\n    }\n\n    if (this._sources.has(aSource)) {\n      return this.sourcesContent[this._sources.indexOf(aSource)];\n    }\n\n    var url;\n    if (this.sourceRoot != null\n        && (url = util.urlParse(this.sourceRoot))) {\n      // XXX: file:// URIs and absolute paths lead to unexpected behavior for\n      // many users. We can help them out when they expect file:// URIs to\n      // behave like it would if they were running a local HTTP server. See\n      // https://bugzilla.mozilla.org/show_bug.cgi?id=885597.\n      var fileUriAbsPath = aSource.replace(/^file:\\/\\//, \"\");\n      if (url.scheme == \"file\"\n          && this._sources.has(fileUriAbsPath)) {\n        return this.sourcesContent[this._sources.indexOf(fileUriAbsPath)]\n      }\n\n      if ((!url.path || url.path == \"/\")\n          && this._sources.has(\"/\" + aSource)) {\n        return this.sourcesContent[this._sources.indexOf(\"/\" + aSource)];\n      }\n    }\n\n    // This function is used recursively from\n    // IndexedSourceMapConsumer.prototype.sourceContentFor. In that case, we\n    // don't want to throw if we can't find the source - we just want to\n    // return null, so we provide a flag to exit gracefully.\n    if (nullOnMissing) {\n      return null;\n    }\n    else {\n      throw new Error('\"' + aSource + '\" is not in the SourceMap.');\n    }\n  };\n\n/**\n * Returns the generated line and column information for the original source,\n * line, and column positions provided. The only argument is an object with\n * the following properties:\n *\n *   - source: The filename of the original source.\n *   - line: The line number in the original source.\n *   - column: The column number in the original source.\n *   - bias: Either 'SourceMapConsumer.GREATEST_LOWER_BOUND' or\n *     'SourceMapConsumer.LEAST_UPPER_BOUND'. Specifies whether to return the\n *     closest element that is smaller than or greater than the one we are\n *     searching for, respectively, if the exact element cannot be found.\n *     Defaults to 'SourceMapConsumer.GREATEST_LOWER_BOUND'.\n *\n * and an object is returned with the following properties:\n *\n *   - line: The line number in the generated source, or null.\n *   - column: The column number in the generated source, or null.\n */\nBasicSourceMapConsumer.prototype.generatedPositionFor =\n  function SourceMapConsumer_generatedPositionFor(aArgs) {\n    var source = util.getArg(aArgs, 'source');\n    if (this.sourceRoot != null) {\n      source = util.relative(this.sourceRoot, source);\n    }\n    if (!this._sources.has(source)) {\n      return {\n        line: null,\n        column: null,\n        lastColumn: null\n      };\n    }\n    source = this._sources.indexOf(source);\n\n    var needle = {\n      source: source,\n      originalLine: util.getArg(aArgs, 'line'),\n      originalColumn: util.getArg(aArgs, 'column')\n    };\n\n    var index = this._findMapping(\n      needle,\n      this._originalMappings,\n      \"originalLine\",\n      \"originalColumn\",\n      util.compareByOriginalPositions,\n      util.getArg(aArgs, 'bias', SourceMapConsumer.GREATEST_LOWER_BOUND)\n    );\n\n    if (index >= 0) {\n      var mapping = this._originalMappings[index];\n\n      if (mapping.source === needle.source) {\n        return {\n          line: util.getArg(mapping, 'generatedLine', null),\n          column: util.getArg(mapping, 'generatedColumn', null),\n          lastColumn: util.getArg(mapping, 'lastGeneratedColumn', null)\n        };\n      }\n    }\n\n    return {\n      line: null,\n      column: null,\n      lastColumn: null\n    };\n  };\n\nexports.BasicSourceMapConsumer = BasicSourceMapConsumer;\n\n/**\n * An IndexedSourceMapConsumer instance represents a parsed source map which\n * we can query for information. It differs from BasicSourceMapConsumer in\n * that it takes \"indexed\" source maps (i.e. ones with a \"sections\" field) as\n * input.\n *\n * The only parameter is a raw source map (either as a JSON string, or already\n * parsed to an object). According to the spec for indexed source maps, they\n * have the following attributes:\n *\n *   - version: Which version of the source map spec this map is following.\n *   - file: Optional. The generated file this source map is associated with.\n *   - sections: A list of section definitions.\n *\n * Each value under the \"sections\" field has two fields:\n *   - offset: The offset into the original specified at which this section\n *       begins to apply, defined as an object with a \"line\" and \"column\"\n *       field.\n *   - map: A source map definition. This source map could also be indexed,\n *       but doesn't have to be.\n *\n * Instead of the \"map\" field, it's also possible to have a \"url\" field\n * specifying a URL to retrieve a source map from, but that's currently\n * unsupported.\n *\n * Here's an example source map, taken from the source map spec[0], but\n * modified to omit a section which uses the \"url\" field.\n *\n *  {\n *    version : 3,\n *    file: \"app.js\",\n *    sections: [{\n *      offset: {line:100, column:10},\n *      map: {\n *        version : 3,\n *        file: \"section.js\",\n *        sources: [\"foo.js\", \"bar.js\"],\n *        names: [\"src\", \"maps\", \"are\", \"fun\"],\n *        mappings: \"AAAA,E;;ABCDE;\"\n *      }\n *    }],\n *  }\n *\n * [0]: https://docs.google.com/document/d/1U1RGAehQwRypUTovF1KRlpiOFze0b-_2gc6fAH0KY0k/edit#heading=h.535es3xeprgt\n */\nfunction IndexedSourceMapConsumer(aSourceMap) {\n  var sourceMap = aSourceMap;\n  if (typeof aSourceMap === 'string') {\n    sourceMap = JSON.parse(aSourceMap.replace(/^\\)\\]\\}'/, ''));\n  }\n\n  var version = util.getArg(sourceMap, 'version');\n  var sections = util.getArg(sourceMap, 'sections');\n\n  if (version != this._version) {\n    throw new Error('Unsupported version: ' + version);\n  }\n\n  this._sources = new ArraySet();\n  this._names = new ArraySet();\n\n  var lastOffset = {\n    line: -1,\n    column: 0\n  };\n  this._sections = sections.map(function (s) {\n    if (s.url) {\n      // The url field will require support for asynchronicity.\n      // See https://github.com/mozilla/source-map/issues/16\n      throw new Error('Support for url field in sections not implemented.');\n    }\n    var offset = util.getArg(s, 'offset');\n    var offsetLine = util.getArg(offset, 'line');\n    var offsetColumn = util.getArg(offset, 'column');\n\n    if (offsetLine < lastOffset.line ||\n        (offsetLine === lastOffset.line && offsetColumn < lastOffset.column)) {\n      throw new Error('Section offsets must be ordered and non-overlapping.');\n    }\n    lastOffset = offset;\n\n    return {\n      generatedOffset: {\n        // The offset fields are 0-based, but we use 1-based indices when\n        // encoding/decoding from VLQ.\n        generatedLine: offsetLine + 1,\n        generatedColumn: offsetColumn + 1\n      },\n      consumer: new SourceMapConsumer(util.getArg(s, 'map'))\n    }\n  });\n}\n\nIndexedSourceMapConsumer.prototype = Object.create(SourceMapConsumer.prototype);\nIndexedSourceMapConsumer.prototype.constructor = SourceMapConsumer;\n\n/**\n * The version of the source mapping spec that we are consuming.\n */\nIndexedSourceMapConsumer.prototype._version = 3;\n\n/**\n * The list of original sources.\n */\nObject.defineProperty(IndexedSourceMapConsumer.prototype, 'sources', {\n  get: function () {\n    var sources = [];\n    for (var i = 0; i < this._sections.length; i++) {\n      for (var j = 0; j < this._sections[i].consumer.sources.length; j++) {\n        sources.push(this._sections[i].consumer.sources[j]);\n      }\n    }\n    return sources;\n  }\n});\n\n/**\n * Returns the original source, line, and column information for the generated\n * source's line and column positions provided. The only argument is an object\n * with the following properties:\n *\n *   - line: The line number in the generated source.\n *   - column: The column number in the generated source.\n *\n * and an object is returned with the following properties:\n *\n *   - source: The original source file, or null.\n *   - line: The line number in the original source, or null.\n *   - column: The column number in the original source, or null.\n *   - name: The original identifier, or null.\n */\nIndexedSourceMapConsumer.prototype.originalPositionFor =\n  function IndexedSourceMapConsumer_originalPositionFor(aArgs) {\n    var needle = {\n      generatedLine: util.getArg(aArgs, 'line'),\n      generatedColumn: util.getArg(aArgs, 'column')\n    };\n\n    // Find the section containing the generated position we're trying to map\n    // to an original position.\n    var sectionIndex = binarySearch.search(needle, this._sections,\n      function(needle, section) {\n        var cmp = needle.generatedLine - section.generatedOffset.generatedLine;\n        if (cmp) {\n          return cmp;\n        }\n\n        return (needle.generatedColumn -\n                section.generatedOffset.generatedColumn);\n      });\n    var section = this._sections[sectionIndex];\n\n    if (!section) {\n      return {\n        source: null,\n        line: null,\n        column: null,\n        name: null\n      };\n    }\n\n    return section.consumer.originalPositionFor({\n      line: needle.generatedLine -\n        (section.generatedOffset.generatedLine - 1),\n      column: needle.generatedColumn -\n        (section.generatedOffset.generatedLine === needle.generatedLine\n         ? section.generatedOffset.generatedColumn - 1\n         : 0),\n      bias: aArgs.bias\n    });\n  };\n\n/**\n * Return true if we have the source content for every source in the source\n * map, false otherwise.\n */\nIndexedSourceMapConsumer.prototype.hasContentsOfAllSources =\n  function IndexedSourceMapConsumer_hasContentsOfAllSources() {\n    return this._sections.every(function (s) {\n      return s.consumer.hasContentsOfAllSources();\n    });\n  };\n\n/**\n * Returns the original source content. The only argument is the url of the\n * original source file. Returns null if no original source content is\n * available.\n */\nIndexedSourceMapConsumer.prototype.sourceContentFor =\n  function IndexedSourceMapConsumer_sourceContentFor(aSource, nullOnMissing) {\n    for (var i = 0; i < this._sections.length; i++) {\n      var section = this._sections[i];\n\n      var content = section.consumer.sourceContentFor(aSource, true);\n      if (content) {\n        return content;\n      }\n    }\n    if (nullOnMissing) {\n      return null;\n    }\n    else {\n      throw new Error('\"' + aSource + '\" is not in the SourceMap.');\n    }\n  };\n\n/**\n * Returns the generated line and column information for the original source,\n * line, and column positions provided. The only argument is an object with\n * the following properties:\n *\n *   - source: The filename of the original source.\n *   - line: The line number in the original source.\n *   - column: The column number in the original source.\n *\n * and an object is returned with the following properties:\n *\n *   - line: The line number in the generated source, or null.\n *   - column: The column number in the generated source, or null.\n */\nIndexedSourceMapConsumer.prototype.generatedPositionFor =\n  function IndexedSourceMapConsumer_generatedPositionFor(aArgs) {\n    for (var i = 0; i < this._sections.length; i++) {\n      var section = this._sections[i];\n\n      // Only consider this section if the requested source is in the list of\n      // sources of the consumer.\n      if (section.consumer.sources.indexOf(util.getArg(aArgs, 'source')) === -1) {\n        continue;\n      }\n      var generatedPosition = section.consumer.generatedPositionFor(aArgs);\n      if (generatedPosition) {\n        var ret = {\n          line: generatedPosition.line +\n            (section.generatedOffset.generatedLine - 1),\n          column: generatedPosition.column +\n            (section.generatedOffset.generatedLine === generatedPosition.line\n             ? section.generatedOffset.generatedColumn - 1\n             : 0)\n        };\n        return ret;\n      }\n    }\n\n    return {\n      line: null,\n      column: null\n    };\n  };\n\n/**\n * Parse the mappings in a string in to a data structure which we can easily\n * query (the ordered arrays in the `this.__generatedMappings` and\n * `this.__originalMappings` properties).\n */\nIndexedSourceMapConsumer.prototype._parseMappings =\n  function IndexedSourceMapConsumer_parseMappings(aStr, aSourceRoot) {\n    this.__generatedMappings = [];\n    this.__originalMappings = [];\n    for (var i = 0; i < this._sections.length; i++) {\n      var section = this._sections[i];\n      var sectionMappings = section.consumer._generatedMappings;\n      for (var j = 0; j < sectionMappings.length; j++) {\n        var mapping = sectionMappings[j];\n\n        var source = section.consumer._sources.at(mapping.source);\n        if (section.consumer.sourceRoot !== null) {\n          source = util.join(section.consumer.sourceRoot, source);\n        }\n        this._sources.add(source);\n        source = this._sources.indexOf(source);\n\n        var name = section.consumer._names.at(mapping.name);\n        this._names.add(name);\n        name = this._names.indexOf(name);\n\n        // The mappings coming from the consumer for the section have\n        // generated positions relative to the start of the section, so we\n        // need to offset them to be relative to the start of the concatenated\n        // generated file.\n        var adjustedMapping = {\n          source: source,\n          generatedLine: mapping.generatedLine +\n            (section.generatedOffset.generatedLine - 1),\n          generatedColumn: mapping.generatedColumn +\n            (section.generatedOffset.generatedLine === mapping.generatedLine\n            ? section.generatedOffset.generatedColumn - 1\n            : 0),\n          originalLine: mapping.originalLine,\n          originalColumn: mapping.originalColumn,\n          name: name\n        };\n\n        this.__generatedMappings.push(adjustedMapping);\n        if (typeof adjustedMapping.originalLine === 'number') {\n          this.__originalMappings.push(adjustedMapping);\n        }\n      }\n    }\n\n    quickSort(this.__generatedMappings, util.compareByGeneratedPositionsDeflated);\n    quickSort(this.__originalMappings, util.compareByOriginalPositions);\n  };\n\nexports.IndexedSourceMapConsumer = IndexedSourceMapConsumer;\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2014 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nvar util = require('./util');\n\n/**\n * Determine whether mappingB is after mappingA with respect to generated\n * position.\n */\nfunction generatedPositionAfter(mappingA, mappingB) {\n  // Optimized for most common case\n  var lineA = mappingA.generatedLine;\n  var lineB = mappingB.generatedLine;\n  var columnA = mappingA.generatedColumn;\n  var columnB = mappingB.generatedColumn;\n  return lineB > lineA || lineB == lineA && columnB >= columnA ||\n         util.compareByGeneratedPositionsInflated(mappingA, mappingB) <= 0;\n}\n\n/**\n * A data structure to provide a sorted view of accumulated mappings in a\n * performance conscious manner. It trades a neglibable overhead in general\n * case for a large speedup in case of mappings being added in order.\n */\nfunction MappingList() {\n  this._array = [];\n  this._sorted = true;\n  // Serves as infimum\n  this._last = {generatedLine: -1, generatedColumn: 0};\n}\n\n/**\n * Iterate through internal items. This method takes the same arguments that\n * `Array.prototype.forEach` takes.\n *\n * NOTE: The order of the mappings is NOT guaranteed.\n */\nMappingList.prototype.unsortedForEach =\n  function MappingList_forEach(aCallback, aThisArg) {\n    this._array.forEach(aCallback, aThisArg);\n  };\n\n/**\n * Add the given source mapping.\n *\n * @param Object aMapping\n */\nMappingList.prototype.add = function MappingList_add(aMapping) {\n  if (generatedPositionAfter(this._last, aMapping)) {\n    this._last = aMapping;\n    this._array.push(aMapping);\n  } else {\n    this._sorted = false;\n    this._array.push(aMapping);\n  }\n};\n\n/**\n * Returns the flat, sorted array of mappings. The mappings are sorted by\n * generated position.\n *\n * WARNING: This method returns internal data without copying, for\n * performance. The return value must NOT be mutated, and should be treated as\n * an immutable borrow. If you want to take ownership, you must make your own\n * copy.\n */\nMappingList.prototype.toArray = function MappingList_toArray() {\n  if (!this._sorted) {\n    this._array.sort(util.compareByGeneratedPositionsInflated);\n    this._sorted = true;\n  }\n  return this._array;\n};\n\nexports.MappingList = MappingList;\n","/* -*- Mode: js; js-indent-level: 2; -*- */\n/*\n * Copyright 2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\n\nvar intToCharMap = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'.split('');\n\n/**\n * Encode an integer in the range of 0 to 63 to a single base 64 digit.\n */\nexports.encode = function (number) {\n  if (0 <= number && number < intToCharMap.length) {\n    return intToCharMap[number];\n  }\n  throw new TypeError(\"Must be between 0 and 63: \" + number);\n};\n\n/**\n * Decode a single base 64 character code digit to an integer. Returns -1 on\n * failure.\n */\nexports.decode = function (charCode) {\n  var bigA = 65;     // 'A'\n  var bigZ = 90;     // 'Z'\n\n  var littleA = 97;  // 'a'\n  var littleZ = 122; // 'z'\n\n  var zero = 48;     // '0'\n  var nine = 57;     // '9'\n\n  var plus = 43;     // '+'\n  var slash = 47;    // '/'\n\n  var littleOffset = 26;\n  var numberOffset = 52;\n\n  // 0 - 25: ABCDEFGHIJKLMNOPQRSTUVWXYZ\n  if (bigA <= charCode && charCode <= bigZ) {\n    return (charCode - bigA);\n  }\n\n  // 26 - 51: abcdefghijklmnopqrstuvwxyz\n  if (littleA <= charCode && charCode <= littleZ) {\n    return (charCode - littleA + littleOffset);\n  }\n\n  // 52 - 61: 0123456789\n  if (zero <= charCode && charCode <= nine) {\n    return (charCode - zero + numberOffset);\n  }\n\n  // 62: +\n  if (charCode == plus) {\n    return 62;\n  }\n\n  // 63: /\n  if (charCode == slash) {\n    return 63;\n  }\n\n  // Invalid base64 digit.\n  return -1;\n};\n","/*\n * Copyright 2009-2011 Mozilla Foundation and contributors\n * Licensed under the New BSD license. See LICENSE.txt or:\n * http://opensource.org/licenses/BSD-3-Clause\n */\nexports.SourceMapGenerator = require('./lib/source-map-generator').SourceMapGenerator;\nexports.SourceMapConsumer = require('./lib/source-map-consumer').SourceMapConsumer;\nexports.SourceNode = require('./lib/source-node').SourceNode;\n","var SourceMapConsumer = require('source-map').SourceMapConsumer;\nvar path = require('path');\n\nvar fs;\ntry {\n  fs = require('fs');\n  if (!fs.existsSync || !fs.readFileSync) {\n    // fs doesn't have all methods we need\n    fs = null;\n  }\n} catch (err) {\n  /* nop */\n}\n\n// Only install once if called multiple times\nvar errorFormatterInstalled = false;\nvar uncaughtShimInstalled = false;\n\n// If true, the caches are reset before a stack trace formatting operation\nvar emptyCacheBetweenOperations = false;\n\n// Supports {browser, node, auto}\nvar environment = \"auto\";\n\n// Maps a file path to a string containing the file contents\nvar fileContentsCache = {};\n\n// Maps a file path to a source map for that file\nvar sourceMapCache = {};\n\n// Regex for detecting source maps\nvar reSourceMap = /^data:application\\/json[^,]+base64,/;\n\n// Priority list of retrieve handlers\nvar retrieveFileHandlers = [];\nvar retrieveMapHandlers = [];\n\nfunction isInBrowser() {\n  if (environment === \"browser\")\n    return true;\n  if (environment === \"node\")\n    return false;\n  return ((typeof window !== 'undefined') && (typeof XMLHttpRequest === 'function') && !(window.require && window.module && window.process && window.process.type === \"renderer\"));\n}\n\nfunction hasGlobalProcessEventEmitter() {\n  return ((typeof process === 'object') && (process !== null) && (typeof process.on === 'function'));\n}\n\nfunction handlerExec(list) {\n  return function(arg) {\n    for (var i = 0; i < list.length; i++) {\n      var ret = list[i](arg);\n      if (ret) {\n        return ret;\n      }\n    }\n    return null;\n  };\n}\n\nvar retrieveFile = handlerExec(retrieveFileHandlers);\n\nretrieveFileHandlers.push(function(path) {\n  // Trim the path to make sure there is no extra whitespace.\n  path = path.trim();\n  if (path in fileContentsCache) {\n    return fileContentsCache[path];\n  }\n\n  var contents = null;\n  if (!fs) {\n    // Use SJAX if we are in the browser\n    var xhr = new XMLHttpRequest();\n    xhr.open('GET', path, false);\n    xhr.send(null);\n    var contents = null\n    if (xhr.readyState === 4 && xhr.status === 200) {\n      contents = xhr.responseText\n    }\n  } else if (fs.existsSync(path)) {\n    // Otherwise, use the filesystem\n    try {\n      contents = fs.readFileSync(path, 'utf8');\n    } catch (er) {\n      contents = '';\n    }\n  }\n\n  return fileContentsCache[path] = contents;\n});\n\n// Support URLs relative to a directory, but be careful about a protocol prefix\n// in case we are in the browser (i.e. directories may start with \"http://\")\nfunction supportRelativeURL(file, url) {\n  if (!file) return url;\n  var dir = path.dirname(file);\n  var match = /^\\w+:\\/\\/[^\\/]*/.exec(dir);\n  var protocol = match ? match[0] : '';\n  return protocol + path.resolve(dir.slice(protocol.length), url);\n}\n\nfunction retrieveSourceMapURL(source) {\n  var fileData;\n\n  if (isInBrowser()) {\n     try {\n       var xhr = new XMLHttpRequest();\n       xhr.open('GET', source, false);\n       xhr.send(null);\n       fileData = xhr.readyState === 4 ? xhr.responseText : null;\n\n       // Support providing a sourceMappingURL via the SourceMap header\n       var sourceMapHeader = xhr.getResponseHeader(\"SourceMap\") ||\n                             xhr.getResponseHeader(\"X-SourceMap\");\n       if (sourceMapHeader) {\n         return sourceMapHeader;\n       }\n     } catch (e) {\n     }\n  }\n\n  // Get the URL of the source map\n  fileData = retrieveFile(source);\n  var re = /(?:\\/\\/[@#][ \\t]+sourceMappingURL=([^\\s'\"]+?)[ \\t]*$)|(?:\\/\\*[@#][ \\t]+sourceMappingURL=([^\\*]+?)[ \\t]*(?:\\*\\/)[ \\t]*$)/mg;\n  // Keep executing the search to find the *last* sourceMappingURL to avoid\n  // picking up sourceMappingURLs from comments, strings, etc.\n  var lastMatch, match;\n  while (match = re.exec(fileData)) lastMatch = match;\n  if (!lastMatch) return null;\n  return lastMatch[1];\n};\n\n// Can be overridden by the retrieveSourceMap option to install. Takes a\n// generated source filename; returns a {map, optional url} object, or null if\n// there is no source map.  The map field may be either a string or the parsed\n// JSON object (ie, it must be a valid argument to the SourceMapConsumer\n// constructor).\nvar retrieveSourceMap = handlerExec(retrieveMapHandlers);\nretrieveMapHandlers.push(function(source) {\n  var sourceMappingURL = retrieveSourceMapURL(source);\n  if (!sourceMappingURL) return null;\n\n  // Read the contents of the source map\n  var sourceMapData;\n  if (reSourceMap.test(sourceMappingURL)) {\n    // Support source map URL as a data url\n    var rawData = sourceMappingURL.slice(sourceMappingURL.indexOf(',') + 1);\n    sourceMapData = new Buffer(rawData, \"base64\").toString();\n    sourceMappingURL = source;\n  } else {\n    // Support source map URLs relative to the source URL\n    sourceMappingURL = supportRelativeURL(source, sourceMappingURL);\n    sourceMapData = retrieveFile(sourceMappingURL);\n  }\n\n  if (!sourceMapData) {\n    return null;\n  }\n\n  return {\n    url: sourceMappingURL,\n    map: sourceMapData\n  };\n});\n\nfunction mapSourcePosition(position) {\n  var sourceMap = sourceMapCache[position.source];\n  if (!sourceMap) {\n    // Call the (overrideable) retrieveSourceMap function to get the source map.\n    var urlAndMap = retrieveSourceMap(position.source);\n    if (urlAndMap) {\n      sourceMap = sourceMapCache[position.source] = {\n        url: urlAndMap.url,\n        map: new SourceMapConsumer(urlAndMap.map)\n      };\n\n      // Load all sources stored inline with the source map into the file cache\n      // to pretend like they are already loaded. They may not exist on disk.\n      if (sourceMap.map.sourcesContent) {\n        sourceMap.map.sources.forEach(function(source, i) {\n          var contents = sourceMap.map.sourcesContent[i];\n          if (contents) {\n            var url = supportRelativeURL(sourceMap.url, source);\n            fileContentsCache[url] = contents;\n          }\n        });\n      }\n    } else {\n      sourceMap = sourceMapCache[position.source] = {\n        url: null,\n        map: null\n      };\n    }\n  }\n\n  // Resolve the source URL relative to the URL of the source map\n  if (sourceMap && sourceMap.map) {\n    var originalPosition = sourceMap.map.originalPositionFor(position);\n\n    // Only return the original position if a matching line was found. If no\n    // matching line is found then we return position instead, which will cause\n    // the stack trace to print the path and line for the compiled file. It is\n    // better to give a precise location in the compiled file than a vague\n    // location in the original file.\n    if (originalPosition.source !== null) {\n      originalPosition.source = supportRelativeURL(\n        sourceMap.url, originalPosition.source);\n      return originalPosition;\n    }\n  }\n\n  return position;\n}\n\n// Parses code generated by FormatEvalOrigin(), a function inside V8:\n// https://code.google.com/p/v8/source/browse/trunk/src/messages.js\nfunction mapEvalOrigin(origin) {\n  // Most eval() calls are in this format\n  var match = /^eval at ([^(]+) \\((.+):(\\d+):(\\d+)\\)$/.exec(origin);\n  if (match) {\n    var position = mapSourcePosition({\n      source: match[2],\n      line: +match[3],\n      column: match[4] - 1\n    });\n    return 'eval at ' + match[1] + ' (' + position.source + ':' +\n      position.line + ':' + (position.column + 1) + ')';\n  }\n\n  // Parse nested eval() calls using recursion\n  match = /^eval at ([^(]+) \\((.+)\\)$/.exec(origin);\n  if (match) {\n    return 'eval at ' + match[1] + ' (' + mapEvalOrigin(match[2]) + ')';\n  }\n\n  // Make sure we still return useful information if we didn't find anything\n  return origin;\n}\n\n// This is copied almost verbatim from the V8 source code at\n// https://code.google.com/p/v8/source/browse/trunk/src/messages.js. The\n// implementation of wrapCallSite() used to just forward to the actual source\n// code of CallSite.prototype.toString but unfortunately a new release of V8\n// did something to the prototype chain and broke the shim. The only fix I\n// could find was copy/paste.\nfunction CallSiteToString() {\n  var fileName;\n  var fileLocation = \"\";\n  if (this.isNative()) {\n    fileLocation = \"native\";\n  } else {\n    fileName = this.getScriptNameOrSourceURL();\n    if (!fileName && this.isEval()) {\n      fileLocation = this.getEvalOrigin();\n      fileLocation += \", \";  // Expecting source position to follow.\n    }\n\n    if (fileName) {\n      fileLocation += fileName;\n    } else {\n      // Source code does not originate from a file and is not native, but we\n      // can still get the source position inside the source string, e.g. in\n      // an eval string.\n      fileLocation += \"<anonymous>\";\n    }\n    var lineNumber = this.getLineNumber();\n    if (lineNumber != null) {\n      fileLocation += \":\" + lineNumber;\n      var columnNumber = this.getColumnNumber();\n      if (columnNumber) {\n        fileLocation += \":\" + columnNumber;\n      }\n    }\n  }\n\n  var line = \"\";\n  var functionName = this.getFunctionName();\n  var addSuffix = true;\n  var isConstructor = this.isConstructor();\n  var isMethodCall = !(this.isToplevel() || isConstructor);\n  if (isMethodCall) {\n    var typeName = this.getTypeName();\n    // Fixes shim to be backward compatable with Node v0 to v4\n    if (typeName === \"[object Object]\") {\n      typeName = \"null\";\n    }\n    var methodName = this.getMethodName();\n    if (functionName) {\n      if (typeName && functionName.indexOf(typeName) != 0) {\n        line += typeName + \".\";\n      }\n      line += functionName;\n      if (methodName && functionName.indexOf(\".\" + methodName) != functionName.length - methodName.length - 1) {\n        line += \" [as \" + methodName + \"]\";\n      }\n    } else {\n      line += typeName + \".\" + (methodName || \"<anonymous>\");\n    }\n  } else if (isConstructor) {\n    line += \"new \" + (functionName || \"<anonymous>\");\n  } else if (functionName) {\n    line += functionName;\n  } else {\n    line += fileLocation;\n    addSuffix = false;\n  }\n  if (addSuffix) {\n    line += \" (\" + fileLocation + \")\";\n  }\n  return line;\n}\n\nfunction cloneCallSite(frame) {\n  var object = {};\n  Object.getOwnPropertyNames(Object.getPrototypeOf(frame)).forEach(function(name) {\n    object[name] = /^(?:is|get)/.test(name) ? function() { return frame[name].call(frame); } : frame[name];\n  });\n  object.toString = CallSiteToString;\n  return object;\n}\n\nfunction wrapCallSite(frame) {\n  if(frame.isNative()) {\n    return frame;\n  }\n\n  // Most call sites will return the source file from getFileName(), but code\n  // passed to eval() ending in \"//# sourceURL=...\" will return the source file\n  // from getScriptNameOrSourceURL() instead\n  var source = frame.getFileName() || frame.getScriptNameOrSourceURL();\n  if (source) {\n    var line = frame.getLineNumber();\n    var column = frame.getColumnNumber() - 1;\n\n    // Fix position in Node where some (internal) code is prepended.\n    // See https://github.com/evanw/node-source-map-support/issues/36\n    var headerLength = 62;\n    if (line === 1 && column > headerLength && !isInBrowser() && !frame.isEval()) {\n      column -= headerLength;\n    }\n\n    var position = mapSourcePosition({\n      source: source,\n      line: line,\n      column: column\n    });\n    frame = cloneCallSite(frame);\n    frame.getFileName = function() { return position.source; };\n    frame.getLineNumber = function() { return position.line; };\n    frame.getColumnNumber = function() { return position.column + 1; };\n    frame.getScriptNameOrSourceURL = function() { return position.source; };\n    return frame;\n  }\n\n  // Code called using eval() needs special handling\n  var origin = frame.isEval() && frame.getEvalOrigin();\n  if (origin) {\n    origin = mapEvalOrigin(origin);\n    frame = cloneCallSite(frame);\n    frame.getEvalOrigin = function() { return origin; };\n    return frame;\n  }\n\n  // If we get here then we were unable to change the source position\n  return frame;\n}\n\n// This function is part of the V8 stack trace API, for more info see:\n// http://code.google.com/p/v8/wiki/JavaScriptStackTraceApi\nfunction prepareStackTrace(error, stack) {\n  if (emptyCacheBetweenOperations) {\n    fileContentsCache = {};\n    sourceMapCache = {};\n  }\n\n  return error + stack.map(function(frame) {\n    return '\\n    at ' + wrapCallSite(frame);\n  }).join('');\n}\n\n// Generate position and snippet of original source with pointer\nfunction getErrorSource(error) {\n  var match = /\\n    at [^(]+ \\((.*):(\\d+):(\\d+)\\)/.exec(error.stack);\n  if (match) {\n    var source = match[1];\n    var line = +match[2];\n    var column = +match[3];\n\n    // Support the inline sourceContents inside the source map\n    var contents = fileContentsCache[source];\n\n    // Support files on disk\n    if (!contents && fs && fs.existsSync(source)) {\n      try {\n        contents = fs.readFileSync(source, 'utf8');\n      } catch (er) {\n        contents = '';\n      }\n    }\n\n    // Format the line from the original source code like node does\n    if (contents) {\n      var code = contents.split(/(?:\\r\\n|\\r|\\n)/)[line - 1];\n      if (code) {\n        return source + ':' + line + '\\n' + code + '\\n' +\n          new Array(column).join(' ') + '^';\n      }\n    }\n  }\n  return null;\n}\n\nfunction printErrorAndExit (error) {\n  var source = getErrorSource(error);\n\n  if (source) {\n    console.error();\n    console.error(source);\n  }\n\n  console.error(error.stack);\n  process.exit(1);\n}\n\nfunction shimEmitUncaughtException () {\n  var origEmit = process.emit;\n\n  process.emit = function (type) {\n    if (type === 'uncaughtException') {\n      var hasStack = (arguments[1] && arguments[1].stack);\n      var hasListeners = (this.listeners(type).length > 0);\n\n      if (hasStack && !hasListeners) {\n        return printErrorAndExit(arguments[1]);\n      }\n    }\n\n    return origEmit.apply(this, arguments);\n  };\n}\n\nexports.wrapCallSite = wrapCallSite;\nexports.getErrorSource = getErrorSource;\nexports.mapSourcePosition = mapSourcePosition;\nexports.retrieveSourceMap = retrieveSourceMap;\n\nexports.install = function(options) {\n  options = options || {};\n\n  if (options.environment) {\n    environment = options.environment;\n    if ([\"node\", \"browser\", \"auto\"].indexOf(environment) === -1) {\n      throw new Error(\"environment \" + environment + \" was unknown. Available options are {auto, browser, node}\")\n    }\n  }\n\n  // Allow sources to be found by methods other than reading the files\n  // directly from disk.\n  if (options.retrieveFile) {\n    if (options.overrideRetrieveFile) {\n      retrieveFileHandlers.length = 0;\n    }\n\n    retrieveFileHandlers.unshift(options.retrieveFile);\n  }\n\n  // Allow source maps to be found by methods other than reading the files\n  // directly from disk.\n  if (options.retrieveSourceMap) {\n    if (options.overrideRetrieveSourceMap) {\n      retrieveMapHandlers.length = 0;\n    }\n\n    retrieveMapHandlers.unshift(options.retrieveSourceMap);\n  }\n\n  // Support runtime transpilers that include inline source maps\n  if (options.hookRequire && !isInBrowser()) {\n    var Module;\n    try {\n      Module = require('module');\n    } catch (err) {\n      // NOP: Loading in catch block to convert webpack error to warning.\n    }\n    var $compile = Module.prototype._compile;\n\n    if (!$compile.__sourceMapSupport) {\n      Module.prototype._compile = function(content, filename) {\n        fileContentsCache[filename] = content;\n        sourceMapCache[filename] = undefined;\n        return $compile.call(this, content, filename);\n      };\n\n      Module.prototype._compile.__sourceMapSupport = true;\n    }\n  }\n\n  // Configure options\n  if (!emptyCacheBetweenOperations) {\n    emptyCacheBetweenOperations = 'emptyCacheBetweenOperations' in options ?\n      options.emptyCacheBetweenOperations : false;\n  }\n\n  // Install the error reformatter\n  if (!errorFormatterInstalled) {\n    errorFormatterInstalled = true;\n    Error.prepareStackTrace = prepareStackTrace;\n  }\n\n  if (!uncaughtShimInstalled) {\n    var installHandler = 'handleUncaughtExceptions' in options ?\n      options.handleUncaughtExceptions : true;\n\n    // Provide the option to not install the uncaught exception handler. This is\n    // to support other uncaught exception handlers (in test frameworks, for\n    // example). If this handler is not installed and there are no other uncaught\n    // exception handlers, uncaught exceptions will be caught by node's built-in\n    // exception handler and the process will still be terminated. However, the\n    // generated JavaScript code will be shown above the stack trace instead of\n    // the original source code.\n    if (installHandler && hasGlobalProcessEventEmitter()) {\n      uncaughtShimInstalled = true;\n      shimEmitUncaughtException();\n    }\n  }\n};\n","\n/**\n * Module dependencies.\n */\n\nvar sep = require('path').sep || '/';\n\n/**\n * Module exports.\n */\n\nmodule.exports = fileUriToPath;\n\n/**\n * File URI to Path function.\n *\n * @param {String} uri\n * @return {String} path\n * @api public\n */\n\nfunction fileUriToPath (uri) {\n  if ('string' != typeof uri ||\n      uri.length <= 7 ||\n      'file://' != uri.substring(0, 7)) {\n    throw new TypeError('must pass in a file:// URI to convert to a file path');\n  }\n\n  var rest = unescape(uri.substring(7));\n  var firstSlash = rest.indexOf('/');\n  var host = rest.substring(0, firstSlash);\n  var path = rest.substring(firstSlash + 1);\n\n  // 2.  Scheme Definition\n  // As a special case, <host> can be the string \"localhost\" or the empty\n  // string; this is interpreted as \"the machine from which the URL is\n  // being interpreted\".\n  if ('localhost' == host) host = '';\n\n  if (host) {\n    host = sep + sep + host;\n  }\n\n  // 3.2  Drives, drive letters, mount points, file system root\n  // Drive letters are mapped into the top of a file URI in various ways,\n  // depending on the implementation; some applications substitute\n  // vertical bar (\"|\") for the colon after the drive letter, yielding\n  // \"file:///c|/tmp/test.txt\".  In some cases, the colon is left\n  // unchanged, as in \"file:///c:/tmp/test.txt\".  In other cases, the\n  // colon is simply omitted, as in \"file:///c/tmp/test.txt\".\n  path = path.replace(/^(.+)\\|/, '$1:');\n\n  // for Windows, we need to invert the path separators from what a URI uses\n  if (sep == '\\\\') {\n    path = path.replace(/\\//g, '\\\\');\n  }\n\n  if (/^.+\\:/.test(path)) {\n    // has Windows drive at beginning of path\n  } else {\n    // unix path\n    path = sep + path;\n  }\n\n  return host + path;\n}\n","import { withSourceMappedStack } from '../source-map-support'\n\n/**\n * Formats an error for log file output. Use this instead of\n * multiple calls to log.error.\n */\nexport function formatError(error: Error, title?: string) {\n  error = withSourceMappedStack(error)\n\n  if (error.stack) {\n    return title ? `${title}\\n${error.stack}` : error.stack.trim()\n  } else {\n    return title\n      ? `${title}\\n${error.name}: ${error.message}`\n      : `${error.name}: ${error.message}`\n  }\n}\n","import { formatError } from './format-error'\n\nexport function formatLogMessage(message: string, error?: Error) {\n  return error ? formatError(error, message) : message\n}\n","import { ipcRenderer } from 'electron'\nimport { LogLevel } from '../log-level'\nimport { formatLogMessage } from '../format-log-message'\n\nconst g = global as any\n\n/**\n * Dispatches the given log entry to the main process where it will be picked\n * written to all log transports. See initializeWinston in logger.ts for more\n * details about what transports we set up.\n */\nfunction log(level: LogLevel, message: string, error?: Error) {\n  ipcRenderer.send(\n    'log',\n    level,\n    formatLogMessage(`[${__PROCESS_KIND__}] ${message}`, error)\n  )\n}\n\ng.log = {\n  error(message: string, error?: Error) {\n    log('error', message, error)\n    console.error(formatLogMessage(message, error))\n  },\n  warn(message: string, error?: Error) {\n    log('warn', message, error)\n    console.warn(formatLogMessage(message, error))\n  },\n  info(message: string, error?: Error) {\n    log('info', message, error)\n    console.info(formatLogMessage(message, error))\n  },\n  debug(message: string, error?: Error) {\n    log('debug', message, error)\n    console.debug(formatLogMessage(message, error))\n  },\n} as IDesktopLogger\n","import '../lib/logging/renderer/install'\n\nimport * as React from 'react'\nimport * as ReactDOM from 'react-dom'\nimport * as Path from 'path'\n\nimport { ipcRenderer, remote } from 'electron'\n\nimport { App } from './app'\nimport {\n  Dispatcher,\n  gitAuthenticationErrorHandler,\n  externalEditorErrorHandler,\n  openShellErrorHandler,\n  mergeConflictHandler,\n  lfsAttributeMismatchHandler,\n  defaultErrorHandler,\n  missingRepositoryHandler,\n  backgroundTaskHandler,\n  pushNeedsPullHandler,\n  upstreamAlreadyExistsHandler,\n} from '../lib/dispatcher'\nimport {\n  AppStore,\n  GitHubUserStore,\n  CloningRepositoriesStore,\n  IssuesStore,\n  SignInStore,\n  RepositoriesStore,\n  TokenStore,\n  AccountsStore,\n  PullRequestStore,\n} from '../lib/stores'\nimport { GitHubUserDatabase } from '../lib/databases'\nimport { URLActionType } from '../lib/parse-app-url'\nimport { SelectionType } from '../lib/app-state'\nimport { StatsDatabase, StatsStore } from '../lib/stats'\nimport {\n  IssuesDatabase,\n  RepositoriesDatabase,\n  PullRequestDatabase,\n} from '../lib/databases'\nimport { shellNeedsPatching, updateEnvironmentForProcess } from '../lib/shell'\nimport { installDevGlobals } from './install-globals'\nimport { reportUncaughtException, sendErrorReport } from './main-process-proxy'\nimport { getOS } from '../lib/get-os'\nimport { getGUID } from '../lib/stats'\nimport {\n  enableSourceMaps,\n  withSourceMappedStack,\n} from '../lib/source-map-support'\nimport { UiActivityMonitor } from './lib/ui-activity-monitor'\nimport { RepositoryStateCache } from '../lib/stores/repository-state-cache'\n\nif (__DEV__) {\n  installDevGlobals()\n}\n\nif (shellNeedsPatching(process)) {\n  updateEnvironmentForProcess()\n}\n\nenableSourceMaps()\n\n// Tell dugite where to find the git environment,\n// see https://github.com/desktop/dugite/pull/85\nprocess.env['LOCAL_GIT_DIRECTORY'] = Path.resolve(__dirname, 'git')\n\n// We're using a polyfill for the upcoming CSS4 `:focus-ring` pseudo-selector.\n// This allows us to not have to override default accessibility driven focus\n// styles for buttons in the case when a user clicks on a button. This also\n// gives better visiblity to individuals who navigate with the keyboard.\n//\n// See:\n//   https://github.com/WICG/focus-ring\n//   Focus Ring! -- A11ycasts #16: https://youtu.be/ilj2P5-5CjI\nrequire('wicg-focus-ring')\n\nconst startTime = performance.now()\n\nif (!process.env.TEST_ENV) {\n  /* This is the magic trigger for webpack to go compile\n  * our sass into css and inject it into the DOM. */\n  require('../../styles/desktop.scss')\n}\n\nprocess.once('uncaughtException', (error: Error) => {\n  error = withSourceMappedStack(error)\n\n  console.error('Uncaught exception', error)\n\n  if (__DEV__ || process.env.TEST_ENV) {\n    console.error(\n      `An uncaught exception was thrown. If this were a production build it would be reported to Central. Instead, maybe give it a lil lookyloo.`\n    )\n  } else {\n    sendErrorReport(error, {\n      osVersion: getOS(),\n      guid: getGUID(),\n    })\n  }\n\n  reportUncaughtException(error)\n})\n\nconst gitHubUserStore = new GitHubUserStore(\n  new GitHubUserDatabase('GitHubUserDatabase')\n)\nconst cloningRepositoriesStore = new CloningRepositoriesStore()\nconst issuesStore = new IssuesStore(new IssuesDatabase('IssuesDatabase'))\nconst statsStore = new StatsStore(\n  new StatsDatabase('StatsDatabase'),\n  new UiActivityMonitor()\n)\nconst signInStore = new SignInStore()\n\nconst accountsStore = new AccountsStore(localStorage, TokenStore)\nconst repositoriesStore = new RepositoriesStore(\n  new RepositoriesDatabase('Database')\n)\n\nconst pullRequestStore = new PullRequestStore(\n  new PullRequestDatabase('PullRequestDatabase'),\n  repositoriesStore\n)\n\nconst repositoryStateManager = new RepositoryStateCache(repo =>\n  gitHubUserStore.getUsersForRepository(repo)\n)\n\nconst appStore = new AppStore(\n  gitHubUserStore,\n  cloningRepositoriesStore,\n  issuesStore,\n  statsStore,\n  signInStore,\n  accountsStore,\n  repositoriesStore,\n  pullRequestStore,\n  repositoryStateManager\n)\n\nconst dispatcher = new Dispatcher(appStore, repositoryStateManager, statsStore)\n\ndispatcher.registerErrorHandler(defaultErrorHandler)\ndispatcher.registerErrorHandler(upstreamAlreadyExistsHandler)\ndispatcher.registerErrorHandler(externalEditorErrorHandler)\ndispatcher.registerErrorHandler(openShellErrorHandler)\ndispatcher.registerErrorHandler(mergeConflictHandler)\ndispatcher.registerErrorHandler(lfsAttributeMismatchHandler)\ndispatcher.registerErrorHandler(gitAuthenticationErrorHandler)\ndispatcher.registerErrorHandler(pushNeedsPullHandler)\ndispatcher.registerErrorHandler(backgroundTaskHandler)\ndispatcher.registerErrorHandler(missingRepositoryHandler)\n\ndocument.body.classList.add(`platform-${process.platform}`)\n\ndispatcher.setAppFocusState(remote.getCurrentWindow().isFocused())\n\nipcRenderer.on('focus', () => {\n  const { selectedState } = appStore.getState()\n\n  // Refresh the currently selected repository on focus (if\n  // we have a selected repository).\n  if (selectedState && selectedState.type === SelectionType.Repository) {\n    dispatcher.refreshRepository(selectedState.repository)\n  }\n\n  dispatcher.setAppFocusState(true)\n})\n\nipcRenderer.on('blur', () => {\n  // Make sure we stop highlighting the menu button (on non-macOS)\n  // when someone uses Alt+Tab to switch application since we won't\n  // get the onKeyUp event for the Alt key in that case.\n  dispatcher.setAccessKeyHighlightState(false)\n  dispatcher.setAppFocusState(false)\n})\n\nipcRenderer.on(\n  'url-action',\n  (event: Electron.IpcMessageEvent, { action }: { action: URLActionType }) => {\n    dispatcher.dispatchURLAction(action)\n  }\n)\n\nReactDOM.render(\n  <App\n    dispatcher={dispatcher}\n    appStore={appStore}\n    repositoryStateManager={repositoryStateManager}\n    issuesStore={issuesStore}\n    gitHubUserStore={gitHubUserStore}\n    startTime={startTime}\n  />,\n  document.getElementById('desktop-app-container')!\n)\n"],"sourceRoot":""}